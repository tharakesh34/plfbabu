<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	
	<changeSet id="1" author="Surekha">
		<createView viewName="BMTBankDetail_View" replaceIfExists="true">
			SELECT		BankCode, BankName, Active	
			, Version , LastMntBy, LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NextTaskId, 
			RecordType, WorkflowId,AccNoLength,Nach,Ecs,Dd,Dda,Cheque
				FROM    	BMTBankDetail_TEMP
				UNION ALL
				SELECT		BankCode, BankName, Active				
							, Version , LastMntBy, LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NextTaskId, 
							RecordType, WorkflowId,AccNoLength,Nach,Ecs,Dd,Dda,Cheque
				FROM    	BMTBankDetail
				WHERE     NOT EXISTS (SELECT 1 FROM BMTBankDetail_TEMP WHERE BankCode = BMTBankDetail.BankCode)
		</createView>
	</changeSet>
	<changeSet id="2" author="Surekha">
		<createView viewName="BMTBankDetail_AView" replaceIfExists="true">
			SELECT		BankCode, BankName, Active	
			, Version , LastMntBy, LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NextTaskId, 
			RecordType, WorkflowId,AccNoLength,Nach,Ecs,Dd,Dda,Cheque
				FROM    	BMTBankDetail
		</createView>
	</changeSet>
		<changeSet id="3" author="Madhubabu">
			<createView viewName="FinCovenantType_View" replaceIfExists="true">
			SELECT   T1.FinReference, T1.CovenantType, T1.Description, T1.MandRole, T1.AlwWaiver,
	         T1.AlwPostpone, T1.PostponeDays,T3.DocTypeDesc CovenantTypeDesc,T4.RoleDesc MandRoleDesc,
	         T1.ReceivableDate,T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode,
	         T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId		 
	         FROM  FinCovenantType_Temp T1 INNER JOIN   
			  BMTDocumentTypes T3 ON T3.DocTypeCode = T1.CovenantType  LEFT JOIN
			  SecRoles T4 ON T4.RoleCd = T1.MandRole
			
	UNION ALL
	SELECT   T1.FinReference, T1.CovenantType, T1.Description, T1.MandRole, T1.AlwWaiver,
	         T1.AlwPostpone, T1.PostponeDays,T3.DocTypeDesc CovenantTypeDesc,T4.RoleDesc MandRoleDesc,
	         T1.ReceivableDate,T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode,
	         T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId		 
	         FROM  FinCovenantType T1 INNER JOIN  
			  BMTDocumentTypes T3 ON T3.DocTypeCode = T1.CovenantType  LEFT JOIN
			  SecRoles T4 ON T4.RoleCd = T1.MandRole
			
	WHERE NOT EXISTS 
	                 (SELECT   1 
					  FROM        FinCovenantType_Temp 
					  WHERE       FinReference = T1.FinReference and CovenantType = T1.CovenantType)
	</createView>
	</changeSet>
	 <changeSet id="3.1" author="Surekha">
	<createTable tableName="SponsorBank">
		<column name="SponsorBankCode" type="varchar(8)">
			<constraints primaryKey="true" nullable="false" />
		</column>
		<column name="SponsorBankName" type="varchar(50)">
			<constraints nullable="false" />
		</column>
		<column name="BankCode" type="varchar(8)">
			<constraints nullable="false" />
		</column>
		<column name="BankBranchCode" type="varchar(8)">
			<constraints nullable="false" />
		</column>
		<column name="BranchMICRCode" type="varchar(20)" />
		<column name="BranchIFSCCode" type="varchar(20)" />
		<column name="BranchCity" type="varchar(50)" />
		<column name="UtilityCode" type="varchar(8)">
			<constraints nullable="false" />
		</column>
		<column name="AccountNo" type="varchar(50)">
			<constraints nullable="false" />
		</column>
		<column name="AccountType" type="char(1)">
			<constraints nullable="false" />
		</column>
		<column name="Active" type="boolean" />
		<column name="Version" type="int" defaultValue="0" />
		<column name="LastMntBy" type="bigint" />
		<column name="LastMntOn" type="datetime" />
		<column name="RecordStatus" type="varchar(50)" />
		<column name="RoleCode" type="varchar(100)" />
		<column name="NextRoleCode" type="varchar(200)" />
		<column name="TaskId" type="varchar(50)" />
		<column name="NextTaskId" type="varchar(200)" />
		<column name="RecordType" type="varchar(50)" />
		<column name="WorkflowId" type="bigint" />
	</createTable>
</changeSet> 
<changeSet id="4" author="Surekha">
	<createTable tableName="SponsorBank_Temp">
		<column name="SponsorBankCode" type="varchar(8)">
			<constraints primaryKey="true" nullable="false" />
		</column>
		<column name="SponsorBankName" type="varchar(50)">
			<constraints nullable="false" />
		</column>
		<column name="BankCode" type="varchar(8)">
			<constraints nullable="false" />
		</column>
		<column name="BankBranchCode" type="varchar(8)">
			<constraints nullable="false" />
		</column>
		<column name="BranchMICRCode" type="varchar(20)" />
		<column name="BranchIFSCCode" type="varchar(20)" />
		<column name="BranchCity" type="varchar(50)" />
		<column name="UtilityCode" type="varchar(8)">
			<constraints nullable="false" />
		</column>
		<column name="AccountNo" type="varchar(50)">
			<constraints nullable="false" />
		</column>
		<column name="AccountType" type="char(1)">
			<constraints nullable="false" />
		</column>
		<column name="Active" type="boolean" />
		<column name="Version" type="int" defaultValue="0" />
		<column name="LastMntBy" type="bigint" />
		<column name="LastMntOn" type="datetime" />
		<column name="RecordStatus" type="varchar(50)" />
		<column name="RoleCode" type="varchar(100)" />
		<column name="NextRoleCode" type="varchar(200)" />
		<column name="TaskId" type="varchar(50)" />
		<column name="NextTaskId" type="varchar(200)" />
		<column name="RecordType" type="varchar(50)" />
		<column name="WorkflowId" type="bigint" />
	</createTable>
</changeSet>
<changeSet id="5" author="Surekha">
	<createView viewName="SponsorBank_View" replaceIfExists="true">
		SELECT T1.SponsorBankCode, T1.SponsorBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, T1.AccountNo, T1.AccountType		
			, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, 
			T1.RecordType, T1.WorkflowId,T2.BankName,T3.BranchDesc
			FROM    	SponsorBank_Temp  T1 INNER JOIN
						BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode
			           
			UNION ALL
			
			SELECT		 T1.SponsorBankCode, T1.SponsorBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, T1.AccountNo, T1.AccountType		
						, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, 
						T1.RecordType, T1.WorkflowId,T2.BankName,T3.BranchDesc
			FROM    	SponsorBank T1 INNER JOIN
			           BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode
						
			WHERE     NOT EXISTS (SELECT 1 FROM SponsorBank_TEMP WHERE SponsorBankCode = T1.SponsorBankCode)
	</createView>
</changeSet>
<changeSet id="6" author="Surekha">
	<createView viewName="SponsorBank_AView" replaceIfExists="true">
		SELECT T1.SponsorBankCode, T1.SponsorBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, T1.AccountNo, T1.AccountType		
			, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, 
			T1.RecordType, T1.WorkflowId,T2.BankName,T3.BranchDesc
			FROM    	SponsorBank  T1 INNER JOIN
						BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode
	</createView>
</changeSet>
<changeSet id="7" author="Surekha">
	<sql>
			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			UPDATE SEQSECGROUPS SET SEQNO= (SELECT MAX(GRPID) FROM SECGROUPS);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS); 
			UPDATE SEQSECROLEGROUPS SET SEQNO= (SELECT MAX(ROLEGRPID) FROM SECROLEGROUPS);
			
			INSERT INTO SECGROUPS SELECT (SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SPONSORBANK_MAKER', 'SPONSOR BANK Maker', 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECGROUPS WHERE 0=0;
			INSERT INTO SECGROUPS SELECT (SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SPONSORBANK_APPROVER', 'SPONSOR BANK Approver', 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECGROUPS WHERE 0=0;
			
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menuItem_sponsorbank_SponsorBank','Menu',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SponsorBankDialog_btnNew','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SponsorBankDialog_btnEdit','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SponsorBankDialog_btnDelete','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SponsorBankDialog_btnSave','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			

			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_SponsorBankCode','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_SponsorBankName','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_BankCode','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_BankBranchCode','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_BranchMICRCode','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_BranchIFSCCode','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_BranchCity','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_UtilityCode','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_AccountNo','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_AccountType','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SponsorBankDialog_Active','SponsorBankDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 

			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menuItem_sponsorbank_SponsorBank'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_SponsorBankDialog_btnNew'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_SponsorBankDialog_btnEdit'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_SponsorBankDialog_btnDelete'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_SponsorBankDialog_btnSave'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_SponsorBankCode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_SponsorBankName'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_BankCode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_BankBranchCode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_BranchMICRCode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_BranchIFSCCode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_BranchCity'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_UtilityCode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_AccountNo'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_AccountType'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='SponsorBankDialog_Active'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_APPROVER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menuItem_sponsorbank_SponsorBank'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);																		
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='SPONSORBANK_APPROVER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_SponsorBankDialog_btnSave'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			
			INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='SPONSORBANK_MAKER'), (Select  RoleID  From SecRoles Where RoleCd='MSTGRP1_MAKER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
			INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='SPONSORBANK_APPROVER'), (Select  RoleID  From SecRoles Where RoleCd='MSTGRP1_APPROVER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
			
			INSERT INTO PTMenuDetails SELECT (select (SeqNo+1) from SeqPTMenuDetails),(SELECT AppID FROM PTApplicationDetails WHERE AppCode='PFF'),'SponsorBank','menuItem_sponsorbank_SponsorBank','/WEB-INF/pages/sponsorbank/SponsorBank/SponsorBankList.zul',0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0,'menuItem_sponsorbank_SponsorBank' FROM SeqPTMenuDetails WHERE 0=0;
			Update SeqPTMenuDetails set SeqNo = SeqNo+1 ;
			
			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			UPDATE SEQSECGROUPS SET SEQNO= (SELECT MAX(GRPID) FROM SECGROUPS);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS); 
			UPDATE SEQSECROLEGROUPS SET SEQNO= (SELECT MAX(ROLEGRPID) FROM SECROLEGROUPS);
	</sql>
</changeSet>
	<changeSet id="8" author="satish">
		<createView replaceIfExists="true" viewName="FinAdvancePayments_View">
SELECT   T1.FinReference, T1.PaymentSeq, T1.PaymentDetail, T1.AmtToBeReleased, T1.LiabilityHoldName,
         T1.BeneficiaryName, T1.BeneficiaryAccNo, T1.Description, T1.PaymentType, T1.LLReferenceNo,
         T1.LLDate, T1.CustContribution, T1.SellerContribution, T1.Remarks,T1.DisbDate,T1.DisbSeq,
         T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode,
         T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T1.BankCode,T1.PayableLoc,T1.PrintingLoc,
		 T1.ValueDate,T1.BankBranchID,T1.PhoneCountryCode,T1.PhoneAreaCode,T1.PhoneNumber,T1.ClearingDate,T1.Status,T1.Active,
		 T1.InputDate,T1.DisbCCy,T1.POIssued,
		 T3.BankCode BranchBankCode,T31.BankName BranchBankName,T3.BranchCode,T3.BranchDesc,T3.IFSC,T3.City, 
		 T4.BankName	     
		 FROM  FinAdvancePayments_Temp T1 LEFT OUTER JOIN
		 BankBranches T3 ON T1.BankBranchID = T3.BankBranchID  LEFT OUTER JOIN
		 BMTBankDetail T31 ON T31.BankCode=T3.BankCode LEFT OUTER JOIN		 
		BMTBankDetail T4  ON T1.BankCode=T4.BankCode
		
UNION ALL
SELECT   T1.FinReference, T1.PaymentSeq, T1.PaymentDetail, T1.AmtToBeReleased, T1.LiabilityHoldName,
         T1.BeneficiaryName, T1.BeneficiaryAccNo, T1.Description, T1.PaymentType, T1.LLReferenceNo,
         T1.LLDate, T1.CustContribution, T1.SellerContribution, T1.Remarks,T1.DisbDate,T1.DisbSeq,
         T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode,
         T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId ,T1.BankCode,T1.PayableLoc,T1.PrintingLoc,
		 T1.ValueDate,T1.BankBranchID,T1.PhoneCountryCode,T1.PhoneAreaCode,T1.PhoneNumber,T1.ClearingDate,T1.Status,T1.Active,
		 T1.InputDate,T1.DisbCCy,T1.POIssued,
		 T3.BankCode BranchBankCode,T31.BankName BranchBankName,T3.BranchCode,T3.BranchDesc,T3.IFSC,T3.City, 
		 T4.BankName	 	
		 FROM  FinAdvancePayments T1  LEFT OUTER JOIN
		 BankBranches T3 ON T1.BankBranchID = T3.BankBranchID  LEFT OUTER JOIN
		 BMTBankDetail T31 ON T31.BankCode=T3.BankCode LEFT OUTER JOIN		 
		BMTBankDetail T4  ON T1.BankCode=T4.BankCode
		
WHERE NOT EXISTS 
                 (SELECT 1 FROM  FinAdvancePayments_Temp WHERE FinReference = T1.FinReference and PaymentSeq = T1.PaymentSeq)
</createView>   </changeSet>
<changeSet id="9" author="Surekha">
	<createView viewName="SponsorBank_View" replaceIfExists="true">
		SELECT T1.SponsorBankCode, T1.SponsorBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, T1.AccountNo, T1.AccountType, T1.Active		
			, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, 
			T1.RecordType, T1.WorkflowId,T2.BankName,T3.BranchDesc
			FROM    	SponsorBank_Temp  T1 INNER JOIN
						BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode
			           
			UNION ALL
			
			SELECT		 T1.SponsorBankCode, T1.SponsorBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, T1.AccountNo, T1.AccountType, T1.Active	
						, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, 
						T1.RecordType, T1.WorkflowId,T2.BankName,T3.BranchDesc
			FROM    	SponsorBank T1 INNER JOIN
			           BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode
						
			WHERE     NOT EXISTS (SELECT 1 FROM SponsorBank_TEMP WHERE SponsorBankCode = T1.SponsorBankCode)
	</createView>
</changeSet>
<changeSet id="10" author="Surekha">
	<createView viewName="SponsorBank_AView" replaceIfExists="true">
		SELECT T1.SponsorBankCode, T1.SponsorBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, T1.AccountNo, T1.AccountType, T1.Active	
			, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, 
			T1.RecordType, T1.WorkflowId,T2.BankName,T3.BranchDesc
			FROM    	SponsorBank  T1 INNER JOIN
						BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode
	</createView>
</changeSet>
<changeSet id="11" author="Durga Prasad D">
		<sql>
			Delete from ErrorDetails where ErrorCode in('90250','90251','90252','90811','60315','90314','90315','90316','90317','90318','90319');
		
			INSERT INTO ErrorDetails VALUES('90250','EN','E','Applied customer {0} for this loan, cannot  be added as {1}.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90251','EN','E','Aadhar number is invalid, Allowed 12 digits only.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90252','EN','E','Invalid step policy code {0}.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90811','EN','E','Requested lines should matched with specified structure: {0}.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('60315','EN','E','{0} should not be less than any of its Limit line/group amount.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90314','EN','E','Overdue details are mandatory when applyODPenalty is enabled.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90315','EN','E','Overdue details are not applicable when applyODPenalty is disabled.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90316','EN','E','Invalid odChargeType {0},Possible values are:{1}.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90317','EN','E','Invalid odChargeCalOn {0},Possible values are:{1}.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90318','EN','E','{0} should between {1} and {2}.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90319','EN','E','{0} today or future Date is not allowed..','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
		</sql>
	</changeSet>
	<changeSet id="13" author="satish">
	<sql> 
update seqSecRights set seqno=(select MAX(RIGHTID) from SecRights);

INSERT INTO SecRights SELECT (select MAX(RIGHTID)+1 from SecRights),3,'FinFeeDetailListCtrl_AlwFeeMaintenance_QDP','FinFeeDetailListCtrl',0,1000,null,' ',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
INSERT INTO SecRights SELECT (select MAX(RIGHTID)+1 from SecRights),3,'FinanceMainDialog_finStartDate_QDP','FinanceMainDialog',0,1000,null,' ',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
INSERT INTO SecRights SELECT (select MAX(RIGHTID)+1 from SecRights),2,'button_FinanceMainDialog_btnBuildSchd_QDP','FinanceMainDialog',0,1000,null,' ',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
update seqSecRights set seqno=(select MAX(RIGHTID) from SecRights);

</sql>
	
	</changeSet>
	
	
	<changeSet id="14" author="Madhubabu">
	<createTable tableName="SeqFinReference">
			<column name="SeqNo" type="bigint"/>
	</createTable>
	</changeSet>
	
	<changeSet id="15" author="satish">
	<sql>
	
	update seqSecGroupRights set seqno=(select MAX(GrpRIGHTID) from SecGroupRights);

INSERT INTO SecGroupRights SELECT (select MAX(GrpRIGHTID)+1 from SecGroupRights),(select grpid from secgroups where GrpCode='CL_ORIGINATION_CHECKER'), (select RightID from SecRights where RightName='FinFeeDetailListCtrl_AlwFeeMaintenance_QDP'),1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
INSERT INTO SecGroupRights SELECT (select MAX(GrpRIGHTID)+1 from SecGroupRights),(select grpid from secgroups where GrpCode='CL_ORIGINATION_CHECKER'), (select RightID from SecRights where RightName='FinanceMainDialog_finStartDate_QDP'),1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
INSERT INTO SecGroupRights SELECT (select MAX(GrpRIGHTID)+1 from SecGroupRights),(select grpid from secgroups where GrpCode='CL_ORIGINATION_CHECKER'), (select RightID from SecRights where RightName='button_FinanceMainDialog_btnBuildSchd_QDP'),1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
update seqSecGroupRights set seqno=(select MAX(GrpRIGHTID) from SecGroupRights);
	
	</sql>
	
	
	</changeSet>
<changeSet id="16" author="satish">
<sql>

update LimitTransactionDetails set SchSeq=1 where SchSeq is null
</sql>

</changeSet>
<changeSet id="17" author="Surekha">
	<createView viewName="SponsorBank_View" replaceIfExists="true">
		SELECT T1.SponsorBankCode, T1.SponsorBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, T1.AccountNo, T1.AccountType, T1.Active		
			, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, 
			T1.RecordType, T1.WorkflowId,T2.BankName BankCodeName,T3.BranchDesc BankBranchCodeName
			FROM    	SponsorBank_Temp  T1 INNER JOIN
						BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode
			           
			UNION ALL
			
			SELECT		 T1.SponsorBankCode, T1.SponsorBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, T1.AccountNo, T1.AccountType, T1.Active	
						, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, 
						T1.RecordType, T1.WorkflowId,T2.BankName BankCodeName,T3.BranchDesc BankBranchCodeName
			FROM    	SponsorBank T1 INNER JOIN
			           BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode
						
			WHERE     NOT EXISTS (SELECT 1 FROM SponsorBank_TEMP WHERE SponsorBankCode = T1.SponsorBankCode)
	</createView>
</changeSet>
<changeSet id="18" author="Surekha">
	<createView viewName="SponsorBank_AView" replaceIfExists="true">
		SELECT T1.SponsorBankCode, T1.SponsorBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, T1.AccountNo, T1.AccountType, T1.Active	
			, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, 
			T1.RecordType, T1.WorkflowId,T2.BankName BankCodeName,T3.BranchDesc BankBranchCodeName
			FROM    	SponsorBank  T1 INNER JOIN
						BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode
	</createView>
</changeSet>
	<changeSet id="29" author="Siva">
		<sql>
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menuItem_CustomerMasters_CustomerGroup','MENU',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_CustomerGroupDialog_btnNew','CustomerGroupDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_CustomerGroupDialog_btnEdit','CustomerGroupDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_CustomerGroupDialog_btnDelete','CustomerGroupDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_CustomerGroupDialog_btnSave','CustomerGroupDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'CustomerGroupDialog_custGrpCode','CustomerGroupDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'CustomerGroupDialog_custGrpDesc','CustomerGroupDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'CustomerGroupDialog_custGrpLimit','CustomerGroupDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'CustomerGroupDialog_custGrpIsActive','CustomerGroupDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'CustomerGroupDialog_custGrpRO1','CustomerGroupDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 

			INSERT INTO SECGROUPS SELECT (SELECT MAX(GRPID)+1 FROM SECGROUPS), 'CustomerGroup_Maker', 'Customer Group Maker', 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECGROUPS WHERE 0=0;
			INSERT INTO SECGROUPS SELECT (SELECT MAX(GRPID)+1 FROM SECGROUPS), 'CustomerGroup_Approver', 'Customer Group Approver', 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECGROUPS WHERE 0=0;

			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Approver') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menuCat_CustomerMasters'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Approver') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menuItem_CustomerMasters_CustomerGroup'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Approver') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_CustomerGroupDialog_btnSave'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menuCat_CustomerMasters'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menuItem_CustomerMasters_CustomerGroup'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_CustomerGroupDialog_btnNew'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_CustomerGroupDialog_btnEdit'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_CustomerGroupDialog_btnDelete'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_CustomerGroupDialog_btnSave'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='CustomerGroupDialog_custGrpCode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='CustomerGroupDialog_custGrpDesc'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='CustomerGroupDialog_custGrpLimit'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='CustomerGroupDialog_custGrpIsActive'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CustomerGroup_Maker') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='CustomerGroupDialog_custGrpRO1'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);

			INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='CustomerGroup_Maker'), (Select  RoleID  From SecRoles Where RoleCd='MSTGRP1_MAKER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
			INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='CustomerGroup_Approver'), (Select  RoleID  From SecRoles Where RoleCd='MSTGRP1_APPROVER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
		</sql>
	</changeSet>
	<changeSet id="30" author="Durga Prasad D">
		<sql>
			INSERT INTO ErrorDetails VALUES('90812','EN','E','Invalid CIF {0}, Loan is already assigned to another customer.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			Update ErrorDetails set ErrorMessage ='No loans available or InActive with reference {0}.' where ErrorCode = '90201';
		</sql>
	</changeSet>
	<changeSet id="31" author="Satish">
	<dropPrimaryKey tableName="LimitGroupLines" constraintName="pk_LimitGroupLines"/>
	<dropPrimaryKey tableName="LimitGroupLines_Temp" constraintName="pk_LimitGroupLines_Temp"/>
	</changeSet>
	<changeSet id="32" author="Madhubabu">
	<sql>
	insert into SMTparameters values('CURRENT_RES_ADDRESS','Current Residential Address','String',1,'CURRES',6,0,null,null,'Current Residential Address',1,1000,CURRENT_TIMESTAMP,'Approved','','','','','',0)
	</sql>
	</changeSet>
	<changeSet id="33" author="Surekha">
	<createView viewName="BankBranches_View" replaceIfExists="true">
			SELECT T1.BankBranchID, T1.BankCode, T1.BranchCode, T1.BranchDesc, T1.City, T1.MICR, T1.IFSC,T2.BankName,T1.ECS,T1.DDA,T1.NACH,T1.DD,T1.AddOfBranch,T1.Cheque,T1.Active
						, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T2.AccNoLength
				FROM    	BankBranches_Temp T1 INNER JOIN
			            BMTBankDetail T2  ON T1.BankCode=T2.BankCode 
				UNION ALL
			
				SELECT		T1.BankBranchID, T1.BankCode, T1.BranchCode, T1.BranchDesc, T1.City, T1.MICR, T1.IFSC,T2.BankName, T1.ECS,t1.DDA,T1.NACH,T1.DD,T1.AddOfBranch,T1.Cheque,T1.Active
						, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T2.AccNoLength
				FROM    	BankBranches T1 INNER JOIN
			            BMTBankDetail T2  ON T1.BankCode=T2.BankCode 
				WHERE     NOT EXISTS (SELECT 1 FROM BankBranches_TEMP WHERE BankBranchID = T1.BankBranchID)
		</createView>
</changeSet>
	<changeSet id="34" author="Surekha">
		<createView viewName="BankBranches_AView" replaceIfExists="true">
			SELECT T1.BankBranchID, T1.BankCode, T1.BranchCode, T1.BranchDesc, T1.City, T1.MICR, T1.IFSC,T2.BankName,T1.ECS,T1.DDA,T1.NACH,T1.DD,T1.AddOfBranch,T1.Cheque,T1.Active
						, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T2.AccNoLength
				FROM    	BankBranches T1 INNER JOIN
			            BMTBankDetail T2  ON T1.BankCode=T2.BankCode 
		</createView>
	</changeSet>
	<changeSet id="35" author="Surekha">
		<createView viewName="BankBranches_TView" replaceIfExists="true">
			SELECT T1.BankBranchID, T1.BankCode, T1.BranchCode, T1.BranchDesc, T1.City, T1.MICR, T1.IFSC,T2.BankName,T1.ECS,T1.DDA,T1.NACH,T1.DD,T1.AddOfBranch,T1.Cheque,T1.Active
						, T1.Version , T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T2.AccNoLength
				FROM    	BankBranches_Temp T1 INNER JOIN
			            BMTBankDetail T2  ON T1.BankCode=T2.BankCode 
		</createView>
	</changeSet>
	<changeSet id="36" author="Durgaprasad G">
		<sql>		
				Delete 	from SecRights where RightName='menuCat_DataEngine';	
				Delete 	from SecRights where RightName='menuItem_DataEngine_DataImport';
				Delete 	from SecRights where RightName='menuItem_DataEngine_DataExport';
				
				Insert into SecRights values ((select MAX(RightID)+1 from SecRights),0,'menuCat_DataEngine','MENU',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 );
				Insert into SecRights values ((select MAX(RightID)+1 from SecRights),0,'menuItem_DataEngine_DataImport','MENU',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 );
				Insert into SecRights values ((select MAX(RightID)+1 from SecRights),0,'menuItem_DataEngine_DataExport','MENU',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 );
				update SeqSecRights set SeqNo=(select MAX(RightID)+1 from SecRights);
				
				
				delete from SecGroups where GrpCode = 'DATAENGINE_IMPORT';
				delete from SecGroups where GrpCode = 'DATAENGINE_EXPORT';
				Insert into SecGroups values ((select MAX(GrpID)+1 from SecGroups),'DATAENGINE_IMPORT','Allowed to import the data.',1,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 );
				Insert into SecGroups values ((select MAX(GrpID)+1 from SecGroups),'DATAENGINE_EXPORT','Allowed to export the data.',1,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 );
				update SeqSecGroups set SeqNo=(select MAX(GrpID)+1 from SecGroups);
				
				
				delete from SecGroupRights where grpId = (select grpId from SecGroups WHERE GrpCode='DATAENGINE_IMPORT') and RightID = (select RightID from SecRights where RightName='menuCat_DataEngine');
				delete from SecGroupRights where grpId = (select grpId from SecGroups WHERE GrpCode='DATAENGINE_IMPORT') and RightID = (select RightID from SecRights where RightName='menuItem_DataEngine_DataImport');
				delete from SecGroupRights where grpId = (select grpId from SecGroups WHERE GrpCode='DATAENGINE_EXPORT') and RightID = (select RightID from SecRights where RightName='menuCat_DataEngine');
				delete from SecGroupRights where grpId = (select grpId from SecGroups WHERE GrpCode='DATAENGINE_EXPORT') and RightID = (select RightID from SecRights where RightName='menuItem_DataEngine_DataExport');
						
																																																
				INSERT INTO SecGroupRights values ((select MAX(GrpRightID)+1 from SecGroupRights), (select grpId from SecGroups WHERE GrpCode='DATAENGINE_IMPORT' ), (select RightID from SecRights where RightName='menuCat_DataEngine'), 1,0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
				INSERT INTO SecGroupRights values ((select MAX(GrpRightID)+1 from SecGroupRights), (select grpId from SecGroups WHERE GrpCode='DATAENGINE_IMPORT' ), (select RightID from SecRights where RightName='menuItem_DataEngine_DataImport'), 1,0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
				INSERT INTO SecGroupRights values ((select MAX(GrpRightID)+1 from SecGroupRights), (select grpId from SecGroups WHERE GrpCode='DATAENGINE_EXPORT' ), (select RightID from SecRights where RightName='menuCat_DataEngine'),1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
				INSERT INTO SecGroupRights values ((select MAX(GrpRightID)+1 from SecGroupRights), (select grpId from SecGroups WHERE GrpCode='DATAENGINE_EXPORT' ), (select RightID from SecRights where RightName='menuItem_DataEngine_DataExport'),1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
				update SeqSecGroupRights set SeqNo=(select MAX(GrpRightID)+1 from SecGroupRights);
				
				delete from SecRoles where  RoleCd = 'DATAENGINE_IMPORT';
				delete from SecRoles where  RoleCd = 'DATAENGINE_EXPORT';
				INSERT INTO SecRoles values ((SELECT MAX(RoleId + 1) FROM  SecRoles),  1, 'DATAENGINE_IMPORT','Members of the role can import the data.','',1, 1000, CURRENT_TIMESTAMP, '', '', '', '', '', '', 0 );
				INSERT INTO SecRoles values ((SELECT MAX(RoleId + 1) FROM  SecRoles),  1, 'DATAENGINE_EXPORT','Members of the role can export the data.','',1, 1000, CURRENT_TIMESTAMP, '', '', '', '', '', '', 0);
				update SeqsecRoles set SeqNo = (SELECT MAX(RoleId)+1 from SecRoles );
				
				delete from SecRoleGroups where GrpID = (select grpId from SecGroups WHERE GrpCode='DATAENGINE_IMPORT') and RoleID = (select RoleID from SecRoles where RoleCd='DATAENGINE_IMPORT');
				delete from SecRoleGroups where GrpID = (select grpId from SecGroups WHERE GrpCode='DATAENGINE_EXPORT') and RoleID = (select RoleID from SecRoles where RoleCd='DATAENGINE_EXPORT');
				INSERT INTO SecRoleGroups values ((select MAX(RoleGrpID)+1 from SecRoleGroups), (select grpId from SecGroups WHERE GrpCode='DATAENGINE_IMPORT'), (select RoleID from SecRoles where RoleCd='DATAENGINE_IMPORT'), 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
				INSERT INTO SecRoleGroups values ((select MAX(RoleGrpID)+1 from SecRoleGroups), (select grpId from SecGroups WHERE GrpCode='DATAENGINE_EXPORT'), (select RoleID from SecRoles where RoleCd='DATAENGINE_EXPORT'), 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
				update SeqSecRoleGroups set SeqNo=(select MAX(RoleGrpID)+1 from SecRoleGroups);
				
				delete from SecOperations where OprCode = 'DATAENGINE_IMPORT';
				delete from SecOperations where OprCode = 'DATAENGINE_EXPORT';
				insert into SecOperations values ((select MAX(OprID)+1 from SecOperations),'DATAENGINE_IMPORT','Dataengine Import Operations',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 );
				insert into SecOperations values ((select MAX(OprID)+1 from SecOperations),'DATAENGINE_EXPORT','Dataengine Export Operations',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 );
				update SeqSecOperations set SeqNo=(select MAX(OprID)+1 from SecOperations);
				
				delete from SecOperationRoles where OprID = (select OprID from SecOperations WHERE OprCode='DATAENGINE_IMPORT') and RoleID = (select RoleID from SecRoles where RoleCd='DATAENGINE_IMPORT');
				delete from SecOperationRoles where OprID = (select OprID from SecOperations WHERE OprCode='DATAENGINE_EXPORT') and RoleID = (select RoleID from SecRoles where RoleCd='DATAENGINE_EXPORT');
				INSERT INTO SecOperationRoles values ((select MAX(OprRoleID)+1 from SecOperationRoles), (select OprID from SecOperations WHERE OprCode='DATAENGINE_IMPORT'), (select RoleID from SecRoles where RoleCd='DATAENGINE_IMPORT'),1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0);
				INSERT INTO SecOperationRoles values ((select MAX(OprRoleID)+1 from SecOperationRoles), (select OprID from SecOperations WHERE OprCode='DATAENGINE_EXPORT'), (select RoleID from SecRoles where RoleCd='DATAENGINE_EXPORT'),1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0);
				update SeqSecOperationRoles set SeqNo=(select MAX(OprRoleID)+1 from SecOperationRoles);
		</sql>
	</changeSet>
	<changeSet id="37" author="satish">
	<sql>
	update seqSecRights set seqno=(select MAX(RIGHTID) from SecRights);
update seqSecGroupRights set seqno=(select MAX(GrpRIGHTID) from SecGroupRights);
INSERT INTO SecRights SELECT (select MAX(RIGHTID)+1 from SecRights),3,'FinanceMainDialog_mandateId','FinanceMainDialog',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
INSERT INTO SecGroupRights SELECT (select MAX(GrpRIGHTID)+1 from SecGroupRights),(select grpid from secgroups where GrpCode='FIN_MAINTAINRPYBASIC_MAKER'), (select RightID from SecRights where RightName='FinanceMainDialog_mandateId'),1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
update seqSecRights set seqno=(select MAX(RIGHTID) from SecRights);
update seqSecGroupRights set seqno=(select MAX(GrpRIGHTID) from SecGroupRights);
	
	
	</sql>
	
	</changeSet>
	
</databaseChangeLog>
