<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value="" dbms="oracle" />
	<property name="add.schema" value="" dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PLFAVANSEQC.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="Gopal.p" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>

	<changeSet id="ST#713.1" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="ClosureThresholdLimit" type="decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.1.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES SET CLOSURETHRESHOLDLIMIT = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.1.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes" columnName="ClosureThresholdLimit"
			columnDataType="boolean" />
	</changeSet>

	<changeSet id="ST#713.1.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_FT_CLOSURETHRESHOLDLIMIT DEFAULT 0 FOR CLOSURETHRESHOLDLIMIT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.1.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes" columnName="ClosureThresholdLimit" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.2" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MaxFPPCalType" type="Varchar(8)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.3" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MaxFPPAmount" type="decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.3.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES SET MAXFPPAMOUNT = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.3.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes" columnName="MaxFPPAmount"
			columnDataType="decimal(18,0)" />
	</changeSet>

	<changeSet id="ST#713.3.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_FT_MAXFPPAMOUNT DEFAULT 0 FOR MAXFPPAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.3.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes" columnName="MaxFPPAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.4" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MaxFPPPer" type="decimal(5,2)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.4.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES SET MAXFPPPER = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.4.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes" columnName="MaxFPPPer"
			columnDataType="decimal(5,2)" />
	</changeSet>

	<changeSet id="ST#713.4.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_FT_MAXFPPPER DEFAULT 0 FOR MAXFPPPER;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.4.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes" columnName="MaxFPPAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.5" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MaxFPPCalOn" type="Varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.6" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="ClosureThresholdLimit" type="decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.6.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES_TEMP SET CLOSURETHRESHOLDLIMIT = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.6.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes_Temp" columnName="ClosureThresholdLimit"
			columnDataType="boolean" />
	</changeSet>

	<changeSet id="ST#713.6.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_T_CLOSURETHRESHOLDLIMIT DEFAULT 0 FOR CLOSURETHRESHOLDLIMIT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.6.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes_Temp" columnName="ClosureThresholdLimit" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.7" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MaxFPPCalType" type="Varchar(8)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.8" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MaxFPPAmount" type="decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.8.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES_TEMP SET MAXFPPAMOUNT = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.8.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes_Temp" columnName="MaxFPPAmount"
			columnDataType="decimal(18,0)" />
	</changeSet>

	<changeSet id="ST#713.8.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_T_MAXFPPAMOUNT DEFAULT 0 FOR MAXFPPAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.8.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes_Temp" columnName="MaxFPPAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.9" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MaxFPPPer" type="decimal(5,2)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.9.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES_TEMP SET MAXFPPPER = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.9.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes_Temp" columnName="MaxFPPPer"
			columnDataType="decimal(5,2)" />
	</changeSet>

	<changeSet id="ST#713.9.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_T_MAXFPPPER DEFAULT 0 FOR MAXFPPPER;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.9.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes_Temp" columnName="MaxFPPAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.10" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MaxFPPCalOn" type="Varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.11" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="PPLockinPeriod" type="int" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.11.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFinanceTypes_Temp SET PPLockinPeriod = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.12" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="ESLockinPeriod" type="int" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.12.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFinanceTypes_Temp SET ESLockinPeriod = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.13" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MinPPCalType" type="VARCHAR(8)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.14" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MinPPAmount" type="decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.14.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES_TEMP SET MINPPAMOUNT = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.14.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes_Temp" columnName="MinPPAmount"
			columnDataType="decimal(18,0)" />
	</changeSet>

	<changeSet id="ST#713.14.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_MINPPAMOUNT DEFAULT 0 FOR MINPPAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.14.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes_Temp" columnName="MinPPAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.15" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MinPPPercentage" type="decimal(5,2)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.15.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES_TEMP SET MINPPPERCENTAGE = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.15.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes_Temp" columnName="MinPPPercentage"
			columnDataType="decimal(5,2)" />
	</changeSet>

	<changeSet id="ST#713.15.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_MINPPPERCENTAGE DEFAULT 0 FOR MINPPPERCENTAGE;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.15.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes_Temp" columnName="MinPPPercentage" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.16" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MinPPCalOn" type="VARCHAR(8)" />
		</addColumn>
	</changeSet>
	<changeSet id="ST#713.17" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MaxPPCalType" type="VARCHAR(8)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.18" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MaxPPAmount" type="decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.18.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES_TEMP SET MAXPPAMOUNT = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.18.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes_Temp" columnName="MaxPPAmount"
			columnDataType="decimal(18,0)" />
	</changeSet>

	<changeSet id="ST#713.18.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_MAXPPAMOUNT DEFAULT 0 FOR MAXPPAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.18.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes_Temp" columnName="MaxPPAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.19" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MaxPPPercentage" type="decimal(5,2)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.19.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES_TEMP SET MAXPPPERCENTAGE = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.19.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes_Temp" columnName="MaxPPPercentage"
			columnDataType="decimal(5,2)" />
	</changeSet>

	<changeSet id="ST#713.19.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_MAXPPPERCENTAGE DEFAULT 0 FOR MAXPPPERCENTAGE;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.19.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes_Temp" columnName="MaxPPPercentage" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.20" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="MaxPPCalOn" type="VARCHAR(8)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.21" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="PPLockinPeriod" type="int" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.21.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFinanceTypes SET PPLockinPeriod = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.22" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="ESLockinPeriod" type="int" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.22.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFinanceTypes SET ESLockinPeriod = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.23" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MinPPCalType" type="VARCHAR(8)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.24" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MinPPAmount" type="decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.24.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES SET MINPPAMOUNT = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.24.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes" columnName="MinPPAmount"
			columnDataType="decimal(18,0)" />
	</changeSet>

	<changeSet id="ST#713.24.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_RFT_MINPPAMOUNT DEFAULT 0 FOR MINPPAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.24.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes" columnName="MinPPAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.25" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MinPPPercentage" type="decimal(5,2)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.25.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES SET MINPPPERCENTAGE = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.25.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes" columnName="MinPPPercentage"
			columnDataType="decimal(5,2)" />
	</changeSet>

	<changeSet id="ST#713.25.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_RFT_MINPPPERCENTAGE DEFAULT 0 FOR MINPPPERCENTAGE;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.25.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes" columnName="MinPPPercentage" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.26" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MinPPCalOn" type="VARCHAR(8)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.27" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MaxPPCalType" type="VARCHAR(8)" />
		</addColumn>
	</changeSet>


	<changeSet id="ST#713.28" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MaxPPAmount" type="decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.28.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES SET MAXPPAMOUNT = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.28.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes" columnName="MaxPPAmount"
			columnDataType="decimal(18,0)" />
	</changeSet>

	<changeSet id="ST#713.28.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_RFT_MAXPPAMOUNT DEFAULT 0 FOR MAXPPAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.28.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes" columnName="MaxPPAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.29" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MaxPPPercentage" type="decimal(5,2)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#713.29.1" author="Sravani.S">
		<sql>
			<![CDATA[	
				UPDATE RMTFINANCETYPES SET MAXPPPERCENTAGE = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.29.2" author="Sravani.S">
		<addNotNullConstraint tableName="RMTFinanceTypes" columnName="MaxPPPercentage"
			columnDataType="decimal(5,2)" />
	</changeSet>

	<changeSet id="ST#713.29.3" author="Sravani.S" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_RFT_MAXPPPERCENTAGE DEFAULT 0 FOR MAXPPPERCENTAGE;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.29.3" author="Sravani.S" dbms="postgresql, oracle">
		<addDefaultValue tableName="RMTFinanceTypes" columnName="MaxPPPercentage" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#713.30" author="Sravani.S">
		<addColumn tableName="RMTFinanceTypes">
			<column name="MaxPPCalOn" type="VARCHAR(8)" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.1" author="Anilkumar.G">
		<addColumn tableName="RMTFINANCETYPES">
			<column name="AllowAutoRefund" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.1.1" author="Anilkumar.G">
		<sql>
			<![CDATA[  
				UPDATE RMTFINANCETYPES SET ALLOWAUTOREFUND = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.1.2" author="Anilkumar.G" dbms="postgresql, oracle">
		<addDefaultValue columnName="AllowAutoRefund" tableName="RMTFINANCETYPES" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2509.1.2" author="Anilkumar.G" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_FT_ALWAUTOREF DEFAULT 0 FOR ALLOWAUTOREFUND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.2" author="Anilkumar.G">
		<addColumn tableName="RMTFINANCETYPES">
			<column name="MaxAutoRefund" type="Decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.2.1" author="Anilkumar.G">
		<sql>
			<![CDATA[  
				UPDATE RMTFINANCETYPES SET MAXAUTOREFUND = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.2.2" author="Anilkumar.G" dbms="postgresql, oracle">
		<addDefaultValue columnName="MaxAutoRefund" tableName="RMTFINANCETYPES" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2509.2.2" author="Anilkumar.G" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_FT_MAXAUTOREF DEFAULT 0 FOR MAXAUTOREFUND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.3" author="Anilkumar.G">
		<addColumn tableName="RMTFINANCETYPES">
			<column name="MinAutoRefund" type="Decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.3.1" author="Anilkumar.G">
		<sql>
			<![CDATA[  
				UPDATE RMTFINANCETYPES SET MINAUTOREFUND = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.3.2" author="Anilkumar.G" dbms="postgresql, oracle">
		<addDefaultValue columnName="minAutoRefund" tableName="RMTFINANCETYPES" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2509.3.3" author="Anilkumar.G" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_FT_MINAUTOREF DEFAULT 0 FOR MINAUTOREFUND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.4" author="Anilkumar.G">
		<addColumn tableName="RMTFINANCETYPES_TEMP">
			<column name="AllowAutoRefund" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.4.1" author="Anilkumar.G">
		<sql>
			<![CDATA[  
				UPDATE RMTFINANCETYPES_TEMP SET ALLOWAUTOREFUND = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.4.2" author="Anilkumar.G" dbms="postgresql, oracle">
		<addDefaultValue columnName="AllowAutoRefund" tableName="RMTFINANCETYPES_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2509.4.2" author="Anilkumar.G" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_T_ALWAUTOREF DEFAULT 0 FOR ALLOWAUTOREFUND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.5" author="Anilkumar.G">
		<addColumn tableName="RMTFINANCETYPES_TEMP">
			<column name="MaxAutoRefund" type="Decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.5.1" author="Anilkumar.G">
		<sql>
			<![CDATA[  
				UPDATE RMTFINANCETYPES_TEMP SET MAXAUTOREFUND = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.5.2" author="Anilkumar.G" dbms="postgresql, oracle">
		<addDefaultValue columnName="MaxAutoRefund" tableName="RMTFINANCETYPES_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2509.5.2" author="Anilkumar.G" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_T_MAXAUTOREF DEFAULT 0 FOR MAXAUTOREFUND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.6" author="Anilkumar.G">
		<addColumn tableName="RMTFINANCETYPES_TEMP">
			<column name="MinAutoRefund" type="Decimal(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.6.1" author="Anilkumar.G">
		<sql>
			<![CDATA[  
				UPDATE RMTFINANCETYPES_TEMP SET MINAUTOREFUND = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.6.2" author="Anilkumar.G" dbms="postgresql, oracle">
		<addDefaultValue columnName="minAutoRefund" tableName="RMTFINANCETYPES_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2509.6.3" author="Anilkumar.G" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_FT_T_MINAUTOREF DEFAULT 0 FOR MINAUTOREFUND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.35_pre" author="Sravani.S" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_aview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.35" author="Sravani.S">
		<createView viewName="RMTFINANCETYPES_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINTYPE,
				    T1.FINCATEGORY,
				    T1.FINTYPEDESC,
				    T1.FINCCY,
				    T1.FINDAYSCALTYPE,
				    T1.FINISGENREF,
				    T1.FINMAXAMOUNT,
				    T1.FINMINAMOUNT,
				    T1.FINDFTSTMTFRQ,
				    T1.FINISALWMD,
				    T1.FINSCHDMTHD,
				    T1.FINISALWGRACE,
				    T1.FINHISTRETENSION,
				    T1.EQUALREPAYMENT,
				    T1.FINRATETYPE,
				    T1.FINBASERATE,
				    T1.FINSPLRATE,
				    T1.FININTRATE,
				    T1.FINMINRATE,
				    T1.FINMAXRATE,
				    T1.FINDFTINTFRQ,
				    T1.FINISINTCPZ,
				    T1.FINCPZFRQ,
				    T1.FINISRVWALW,
				    T1.FINRVWFRQ,
				    T1.FINGRCRATETYPE,
				    T1.FINGRCBASERATE,
				    T1.FINGRCSPLRATE,
				    T1.FINGRCINTRATE,
				    T1.FINGRCMINRATE,
				    T1.FINGRCMAXRATE,
				    T1.FINGRCDFTINTFRQ,
				    T1.FINGRCISINTCPZ,
				    T1.FINGRCCPZFRQ,
				    T1.FINGRCISRVWALW,
				    T1.FINGRCRVWFRQ,
				    T1.FINMINTERM,
				    T1.FINMAXTERM,
				    T1.FINDFTTERMS,
				    T1.FINRPYFRQ,
				    T1.FINREPAYMETHOD,
				    T1.FINISALWPARTIALRPY,
				    T1.FINISALWDIFFERMENT,
				    T1.FINMAXDIFFERMENT,
				    T1.FINISALWEARLYRPY,
				    T1.FINISALWEARLYSETTLE,
				    T1.FINODRPYTRIES,
				    T1.FINEARLYPAYRULE,
				    T1.FINEARLYSETTLERULE,
				    T1.FINISACTIVE,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T1.STEPFINANCE,
				    T1.STEPPINGMANDATORY,
				    T1.ALWMANUALSTEPS,
				    T1.ALWDSTEPPOLICIES,
				    T1.DFTSTEPPOLICY,
				    T1.FINISDWPAYREQUIRED,
				    T1.FINRVWRATEAPPLFOR,
				    T1.FINALWRATECHANGEANYDATE,
				    T1.FINISINTCPZATGRCEND,
				    T1.FINELGRULECODE,
				    T1.LIMITELGRULECODE,
				    T1.FINSCHCALCODEONRVW,
				    T1.ALWPLANDEFERMENT,
				    T1.PLANDEFERCOUNT,
				    T1.FINASSETTYPE,
				    T1.FINISALWGRCREPAY,
				    T1.FINGRCSCHDMTHD,
				    T1.FINGRCMARGIN,
				    T1.FINMARGIN,
				    T1.FINSCHEDULEON,
				    T1.FINGRCSCHEDULEON,
				    T1.FINCOMMITMENTREQ,
				    T1.FINCOLLATERALREQ,
				    T1.OVERRIDELIMIT,
				    T1.LIMITREQUIRED,
				    T1.FINCOMMITMENTOVRRIDE,
				    T1.FINCOLLATERALOVRRIDE,
				    T1.FINPFTUNCHANGED,
				    T1.APPLYODPENALTY,
				    T1.ODINCGRCDAYS,
				    T1.ODCHARGETYPE,
				    T1.ODGRACEDAYS,
				    T1.ODCHARGECALON,
				    T1.ODCHARGEAMTORPERC,
				    T1.ODALLOWWAIVER,
				    T1.ODMAXWAIVERPERC,
				    T1.FINDIVISION,
				    T48.DIVISIONCODEDESC LOVDESCFINDIVISIONNAME,
				    T48.ENTITYCODE LOVDESCENTITYCODE,
				    T1.PRODUCT,
				    T1.STARTDATE,
				    T1.ENDDATE,
				    T1.REMARKS,
				    T1.ALWEARLYPAYMETHODS,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DOWNPAYRULE,
				    T59.RULECODE DOWNPAYRULECODE,
				    T59.RULECODEDESC DOWNPAYRULEDESC,
				    T1.FINSUSPTRIGGER,
				    T1.FINSUSPREMARKS,
				    T1.ALWMULTIPARTYDISB,
				    T1.COLLATERALTYPE,
				    T1.TDSAPPLICABLE,
				    T1.MANUALSCHEDULE,
				    T1.APPLYGRCPRICING,
				    T1.GRCPRICINGMETHOD,
				    T1.APPLYRPYPRICING,
				    T1.RPYPRICINGMETHOD,
				    T1.RPYHIERARCHY,
				    T67.RULECODE GRCPRICINGMETHODDESC,
				    T68.RULECODE RPYPRICINGMETHODDESC,
				    T1.DROPLINEOD,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.FINREPAYPFTONFRQ,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PFTDUESCHON,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.FDDLOCKPERIOD,
				    T1.ALWDRPYMETHODS,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.ROUNDINGMODE,
				    T1.ROUNDINGTARGET,
				    T1.FREQUENCYDAYS,
				    T1.QUICKDISB,
				    T1.ALWREAGE,
				    T1.ALWUNPLANEMIHOLIDAY,
				    T1.ALWMAXDISBCHECKREQ,
				    T1.FINTYPEDESC LOVDESCPROMOFINTYPEDESC,
				    T1.PROFITCENTERID,
				    T69.PROFITCENTERCODE,
				    T69.PROFITCENTERDESC,
				    T1.PRODUCTCATEGORY,
				    T2.PRODUCTDESC FINCATEGORYDESC,
				    T1.DEVELOPERFINANCE,
				    T1.COSTOFFUNDS,
				    T1.CHEQUECAPTUREREQ,
				    T1.FINLTVCHECK,
				    T1.PARTIALLYSECURED,
				    T1.ALWADVEMI,
				    T1.ADVEMIMINTERMS,
				    T1.ADVEMIMAXTERMS,
				    T1.ADVEMIDFTTERMS,
				    T1.ADVEMISCHDMTHD,
				    T1.BPIPFTDAYSBASIS,
				    T1.ELIGIBILITYMETHODS,
				    T1.ALWHYBRIDRATE,
				    T1.FIXEDRATETENOR,
				    T1.ODMINCAPAMOUNT,
				    T1.ODRULECODE,
				    T1.ALWZEROINTACC,
				    T1.AUTOREJECTIONDAYS,
				    T1.TAXNOMAND,
				    T1.PUTCALLREQUIRED,
				    T1.GRCADVINTERSETREQ,
				    T1.GRCADVTYPE,
				    T1.GRCADVMINTERMS,
				    T1.GRCADVMAXTERMS,
				    T1.GRCADVDEFAULTTERMS,
				    T1.ADVINTERSETREQ,
				    T1.ADVTYPE,
				    T1.ADVMINTERMS,
				    T1.ADVMAXTERMS,
				    T1.ADVDEFAULTTERMS,
				    T1.ADVSTAGE,
				    T1.DSFREQ,
				    T1.CASHCOLLATERALREQ,
				    T1.TDSALLOWTOMODIFY,
				    T1.TDSAPPLICABLETO,
				    T1.ALWVAN,
				    T1.VANALLOCATIONMETHOD,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.ALWSANCTIONAMT,
				    T1.ALWSANCTIONAMTOVERRIDE,
				    T1.SANBSDSCHDLE,
				    T1.FINISRATERVWATGRCEND,
				    T1.SCHDONPMTCAL,
				    T1.AUTOAPPROVE,
				    T1.ALWPLANNEDEMIINGRC,
				    T1.OCRREQUIRED,
				    T1.ALLOWEDOCRS,
				    T1.DEFAULTOCR,
				    T1.ALLOWEDLOANPURPOSES,
				    T1.SPECIFICLOANPURPOSES,
				    T1.GRCADJREQ,
				    T1.GRCPERIODAFTRFULLDISB,
				    T1.AUTOINCRGRCENDDATE,
				    T1.GRCAUTOINCRMONTHS,
				    T1.MAXAUTOINCRALLOWED,
				    T1.THRLDTOMAINTAINGRCPRD,
				    T1.ALWLOANSPLIT,
				    T1.SPLITLOANTYPE,
				    T1.INSTBASEDSCHD,
				    T1.TDSTYPE,
				    T1.CALCOFSTEPS,
				    T1.STEPSAPPLIEDFOR,
				    T1.SUBVENTIONREQ,
					T1.OVERDRAFTTXNCHRGREQ,
					T1.OVERDRAFTTXNCHRGFEETYPE,
					T1.OVERDRAFTEXTGRACEDAYS,
					T1.OVERDRAFTCOLCHRGFEETYPE,
					T1.OVERDRAFTCOLAMT,
					T1.REGPROVRULE,
					T1.INTPROVRULE,
					T1.CLOSURETHRESHOLDLIMIT,
					T1.MAXFPPCALTYPE,
					T1.MAXFPPAMOUNT,
					T1.MAXFPPPER,
					T1.MAXFPPCALON,
					T1.PPLOCKINPERIOD,
					T1.ESLOCKINPERIOD,
					T1.MINPPCALTYPE,
					T1.MINPPAMOUNT,
					T1.MINPPPERCENTAGE,
					T1.MINPPCALON,
					T1.MAXPPCALTYPE,
					T1.MAXPPAMOUNT,
					T1.MAXPPPERCENTAGE,
					T1.MAXPPCALON,
					T1.ALLOWAUTOREFUND, 
					T1.MAXAUTOREFUND, 
					T1.MINAUTOREFUND
				FROM RMTFINANCETYPES T1
			    LEFT JOIN BMTPRODUCT T2 ON T1.FINCATEGORY = T2.PRODUCTCODE
			    LEFT JOIN SMTDIVISIONDETAIL T48 ON T1.FINDIVISION = T48.DIVISIONCODE
			    LEFT JOIN RULES T59 ON T1.DOWNPAYRULE = T59.RULEID
			    LEFT JOIN RULES T67 ON T1.GRCPRICINGMETHOD = T67.RULEID
			    LEFT JOIN RULES T68 ON T1.RPYPRICINGMETHOD = T68.RULEID
			    LEFT JOIN PROFITCENTERS T69 ON T69.PROFITCENTERID = T1.PROFITCENTERID
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#713.35_post" author="Sravani.S" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rmtfinancetypes_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.36_pre" author="Sravani.S" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_view'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.36" author="Sravani.S">
		<createView viewName="RMTFINANCETYPES_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINTYPE,
				    T1.FINCATEGORY,
				    T1.FINTYPEDESC,
				    T1.FINCCY,
				    T1.FINDAYSCALTYPE,
				    T1.FINISGENREF,
				    T1.FINMAXAMOUNT,
				    T1.FINMINAMOUNT,
				    T1.FINDFTSTMTFRQ,
				    T1.FINISALWMD,
				    T1.FINSCHDMTHD,
				    T1.FINISALWGRACE,
				    T1.FINHISTRETENSION,
				    T1.EQUALREPAYMENT,
				    T1.FINRATETYPE,
				    T1.FINBASERATE,
				    T1.FINSPLRATE,
				    T1.FININTRATE,
				    T1.FINMINRATE,
				    T1.FINMAXRATE,
				    T1.FINDFTINTFRQ,
				    T1.FINISINTCPZ,
				    T1.FINCPZFRQ,
				    T1.FINISRVWALW,
				    T1.FINRVWFRQ,
				    T1.FINGRCRATETYPE,
				    T1.FINGRCBASERATE,
				    T1.FINGRCSPLRATE,
				    T1.FINGRCINTRATE,
				    T1.FINGRCMINRATE,
				    T1.FINGRCMAXRATE,
				    T1.FINGRCDFTINTFRQ,
				    T1.FINGRCISINTCPZ,
				    T1.FINGRCCPZFRQ,
				    T1.FINGRCISRVWALW,
				    T1.FINGRCRVWFRQ,
				    T1.FINMINTERM,
				    T1.FINMAXTERM,
				    T1.FINDFTTERMS,
				    T1.FINRPYFRQ,
				    T1.FINREPAYMETHOD,
				    T1.FINISALWPARTIALRPY,
				    T1.FINISALWDIFFERMENT,
				    T1.FINMAXDIFFERMENT,
				    T1.FINISALWEARLYRPY,
				    T1.FINISALWEARLYSETTLE,
				    T1.FINODRPYTRIES,
				    T1.FINEARLYPAYRULE,
				    T1.FINEARLYSETTLERULE,
				    T1.FINISACTIVE,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T1.STEPFINANCE,
				    T1.STEPPINGMANDATORY,
				    T1.ALWMANUALSTEPS,
				    T1.ALWDSTEPPOLICIES,
				    T1.DFTSTEPPOLICY,
				    T1.FINISDWPAYREQUIRED,
				    T1.FINRVWRATEAPPLFOR,
				    T1.FINALWRATECHANGEANYDATE,
				    T1.FINISINTCPZATGRCEND,
				    T1.FINELGRULECODE,
				    T1.LIMITELGRULECODE,
				    T1.FINSCHCALCODEONRVW,
				    T1.ALWPLANDEFERMENT,
				    T1.PLANDEFERCOUNT,
				    T1.FINASSETTYPE,
				    T1.FINISALWGRCREPAY,
				    T1.FINGRCSCHDMTHD,
				    T1.FINGRCMARGIN,
				    T1.FINMARGIN,
				    T1.FINSCHEDULEON,
				    T1.FINGRCSCHEDULEON,
				    T1.FINCOMMITMENTREQ,
				    T1.FINCOLLATERALREQ,
				    T1.OVERRIDELIMIT,
				    T1.LIMITREQUIRED,
				    T1.FINCOMMITMENTOVRRIDE,
				    T1.FINCOLLATERALOVRRIDE,
				    T1.FINPFTUNCHANGED,
				    T1.APPLYODPENALTY,
				    T1.ODINCGRCDAYS,
				    T1.ODCHARGETYPE,
				    T1.ODGRACEDAYS,
				    T1.ODCHARGECALON,
				    T1.ODCHARGEAMTORPERC,
				    T1.ODALLOWWAIVER,
				    T1.ODMAXWAIVERPERC,
				    T1.FINDIVISION,
				    T48.DIVISIONCODEDESC LOVDESCFINDIVISIONNAME,
				    T48.ENTITYCODE LOVDESCENTITYCODE,
				    T1.PRODUCT,
				    T1.STARTDATE,
				    T1.ENDDATE,
				    T1.FINTYPEDESC LOVDESCPROMOFINTYPEDESC,
				    T1.REMARKS,
				    T1.ALWEARLYPAYMETHODS,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DOWNPAYRULE,
				    T59.RULECODE DOWNPAYRULECODE,
				    T59.RULECODEDESC DOWNPAYRULEDESC,
				    T1.FINSUSPTRIGGER,
				    T1.FINSUSPREMARKS,
				    T1.ALWMULTIPARTYDISB,
				    T1.COLLATERALTYPE,
				    T1.TDSAPPLICABLE,
				    T1.MANUALSCHEDULE,
				    T1.APPLYGRCPRICING,
				    T1.GRCPRICINGMETHOD,
				    T1.APPLYRPYPRICING,
				    T1.RPYPRICINGMETHOD,
				    T1.RPYHIERARCHY,
				    T67.RULECODE GRCPRICINGMETHODDESC,
				    T68.RULECODE RPYPRICINGMETHODDESC,
				    T1.DROPLINEOD,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.FINREPAYPFTONFRQ,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PFTDUESCHON,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.FDDLOCKPERIOD,
				    T1.ALWDRPYMETHODS,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.ROUNDINGMODE,
				    T1.ROUNDINGTARGET,
				    T1.FREQUENCYDAYS,
				    T1.QUICKDISB,
				    T1.ALWMAXDISBCHECKREQ,
				    T1.ALWREAGE,
				    T1.ALWUNPLANEMIHOLIDAY,
				    T1.PROFITCENTERID,
				    T69.PROFITCENTERCODE,
				    T69.PROFITCENTERDESC,
				    T1.PRODUCTCATEGORY,
				    T2.PRODUCTDESC FINCATEGORYDESC,
				    T1.DEVELOPERFINANCE,
				    T1.COSTOFFUNDS,
				    T1.CHEQUECAPTUREREQ,
				    T1.FINLTVCHECK,
				    T1.PARTIALLYSECURED,
				    T1.ALWADVEMI,
				    T1.ADVEMIMINTERMS,
				    T1.ADVEMIMAXTERMS,
				    T1.ADVEMIDFTTERMS,
				    T1.ADVEMISCHDMTHD,
				    T1.BPIPFTDAYSBASIS,
				    T1.ELIGIBILITYMETHODS,
				    T1.ALWHYBRIDRATE,
				    T1.FIXEDRATETENOR,
				    T1.ODMINCAPAMOUNT,
				    T1.ODRULECODE,
				    T1.ALWZEROINTACC,
				    T1.AUTOREJECTIONDAYS,
				    T1.TAXNOMAND,
				    T1.PUTCALLREQUIRED,
				    T1.GRCADVINTERSETREQ,
				    T1.GRCADVTYPE,
				    T1.GRCADVMINTERMS,
				    T1.GRCADVMAXTERMS,
				    T1.GRCADVDEFAULTTERMS,
				    T1.ADVINTERSETREQ,
				    T1.ADVTYPE,
				    T1.ADVMINTERMS,
				    T1.ADVMAXTERMS,
				    T1.ADVDEFAULTTERMS,
				    T1.ADVSTAGE,
				    T1.DSFREQ,
				    T1.CASHCOLLATERALREQ,
				    T1.TDSALLOWTOMODIFY,
				    T1.TDSAPPLICABLETO,
				    T1.ALWVAN,
				    T1.VANALLOCATIONMETHOD,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.ALWSANCTIONAMT,
				    T1.ALWSANCTIONAMTOVERRIDE,
				    T1.SANBSDSCHDLE,
				    T1.FINISRATERVWATGRCEND,
				    T1.SCHDONPMTCAL,
				    T1.AUTOAPPROVE,
				    T1.OCRREQUIRED,
				    T1.ALLOWEDOCRS,
				    T1.DEFAULTOCR,
				    T1.ALLOWEDLOANPURPOSES,
				    T1.SPECIFICLOANPURPOSES,
				    T1.ALWPLANNEDEMIINGRC,
				    T1.GRCADJREQ,
				    T1.GRCPERIODAFTRFULLDISB,
				    T1.AUTOINCRGRCENDDATE,
				    T1.GRCAUTOINCRMONTHS,
				    T1.MAXAUTOINCRALLOWED,
				    T1.THRLDTOMAINTAINGRCPRD,
				    T1.ALWLOANSPLIT,
				    T1.SPLITLOANTYPE,
				    T1.INSTBASEDSCHD,
				    T1.TDSTYPE,
				    T1.CALCOFSTEPS,
				    T1.STEPSAPPLIEDFOR,
				    T1.SUBVENTIONREQ,
					T1.OVERDRAFTTXNCHRGREQ,
					T1.OVERDRAFTTXNCHRGFEETYPE,
					T1.OVERDRAFTEXTGRACEDAYS,
					T1.OVERDRAFTCOLCHRGFEETYPE,
					T1.OVERDRAFTCOLAMT,
					T1.REGPROVRULE,
					T1.INTPROVRULE,
					T1.CLOSURETHRESHOLDLIMIT,
					T1.MAXFPPCALTYPE,
					T1.MAXFPPAMOUNT,
					T1.MAXFPPPER,
					T1.MAXFPPCALON,
					T1.PPLOCKINPERIOD,
					T1.ESLOCKINPERIOD,
					T1.MINPPCALTYPE,
					T1.MINPPAMOUNT,
					T1.MINPPPERCENTAGE,
					T1.MINPPCALON,
					T1.MAXPPCALTYPE,
					T1.MAXPPAMOUNT,
					T1.MAXPPPERCENTAGE,
					T1.MAXPPCALON,
					T1.ALLOWAUTOREFUND, 
					T1.MAXAUTOREFUND, 
					T1.MINAUTOREFUND
				FROM RMTFINANCETYPES_TEMP T1
				LEFT JOIN BMTPRODUCT T2 ON T1.FINCATEGORY = T2.PRODUCTCODE
				LEFT JOIN SMTDIVISIONDETAIL T48 ON T1.FINDIVISION = T48.DIVISIONCODE
				LEFT JOIN RULES T59 ON T1.DOWNPAYRULE = T59.RULEID
				LEFT JOIN RULES T67 ON T1.GRCPRICINGMETHOD = T67.RULEID
				LEFT JOIN RULES T68 ON T1.RPYPRICINGMETHOD = T68.RULEID
				LEFT JOIN PROFITCENTERS T69 ON T69.PROFITCENTERID = T1.PROFITCENTERID
				UNION ALL
				SELECT T1.FINTYPE,
				    T1.FINCATEGORY,
				    T1.FINTYPEDESC,
				    T1.FINCCY,
				    T1.FINDAYSCALTYPE,
				    T1.FINISGENREF,
				    T1.FINMAXAMOUNT,
				    T1.FINMINAMOUNT,
				    T1.FINDFTSTMTFRQ,
				    T1.FINISALWMD,
				    T1.FINSCHDMTHD,
				    T1.FINISALWGRACE,
				    T1.FINHISTRETENSION,
				    T1.EQUALREPAYMENT,
				    T1.FINRATETYPE,
				    T1.FINBASERATE,
				    T1.FINSPLRATE,
				    T1.FININTRATE,
				    T1.FINMINRATE,
				    T1.FINMAXRATE,
				    T1.FINDFTINTFRQ,
				    T1.FINISINTCPZ,
				    T1.FINCPZFRQ,
				    T1.FINISRVWALW,
				    T1.FINRVWFRQ,
				    T1.FINGRCRATETYPE,
				    T1.FINGRCBASERATE,
				    T1.FINGRCSPLRATE,
				    T1.FINGRCINTRATE,
				    T1.FINGRCMINRATE,
				    T1.FINGRCMAXRATE,
				    T1.FINGRCDFTINTFRQ,
				    T1.FINGRCISINTCPZ,
				    T1.FINGRCCPZFRQ,
				    T1.FINGRCISRVWALW,
				    T1.FINGRCRVWFRQ,
				    T1.FINMINTERM,
				    T1.FINMAXTERM,
				    T1.FINDFTTERMS,
				    T1.FINRPYFRQ,
				    T1.FINREPAYMETHOD,
				    T1.FINISALWPARTIALRPY,
				    T1.FINISALWDIFFERMENT,
				    T1.FINMAXDIFFERMENT,
				    T1.FINISALWEARLYRPY,
				    T1.FINISALWEARLYSETTLE,
				    T1.FINODRPYTRIES,
				    T1.FINEARLYPAYRULE,
				    T1.FINEARLYSETTLERULE,
				    T1.FINISACTIVE,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T1.STEPFINANCE,
				    T1.STEPPINGMANDATORY,
				    T1.ALWMANUALSTEPS,
				    T1.ALWDSTEPPOLICIES,
				    T1.DFTSTEPPOLICY,
				    T1.FINISDWPAYREQUIRED,
				    T1.FINRVWRATEAPPLFOR,
				    T1.FINALWRATECHANGEANYDATE,
				    T1.FINISINTCPZATGRCEND,
				    T1.FINELGRULECODE,
				    T1.LIMITELGRULECODE,
				    T1.FINSCHCALCODEONRVW,
				    T1.ALWPLANDEFERMENT,
				    T1.PLANDEFERCOUNT,
				    T1.FINASSETTYPE,
				    T1.FINISALWGRCREPAY,
				    T1.FINGRCSCHDMTHD,
				    T1.FINGRCMARGIN,
				    T1.FINMARGIN,
				    T1.FINSCHEDULEON,
				    T1.FINGRCSCHEDULEON,
				    T1.FINCOMMITMENTREQ,
				    T1.FINCOLLATERALREQ,
				    T1.OVERRIDELIMIT,
				    T1.LIMITREQUIRED,
				    T1.FINCOMMITMENTOVRRIDE,
				    T1.FINCOLLATERALOVRRIDE,
				    T1.FINPFTUNCHANGED,
				    T1.APPLYODPENALTY,
				    T1.ODINCGRCDAYS,
				    T1.ODCHARGETYPE,
				    T1.ODGRACEDAYS,
				    T1.ODCHARGECALON,
				    T1.ODCHARGEAMTORPERC,
				    T1.ODALLOWWAIVER,
				    T1.ODMAXWAIVERPERC,
				    T1.FINDIVISION,
				    T48.DIVISIONCODEDESC LOVDESCFINDIVISIONNAME,
				    T48.ENTITYCODE LOVDESCENTITYCODE,
				    T1.PRODUCT,
				    T1.STARTDATE,
				    T1.ENDDATE,
				    T1.FINTYPEDESC LOVDESCPROMOFINTYPEDESC,
				    T1.REMARKS,
				    T1.ALWEARLYPAYMETHODS,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DOWNPAYRULE,
				    T59.RULECODE DOWNPAYRULECODE,
				    T59.RULECODEDESC DOWNPAYRULEDESC,
				    T1.FINSUSPTRIGGER,
				    T1.FINSUSPREMARKS,
				    T1.ALWMULTIPARTYDISB,
				    T1.COLLATERALTYPE,
				    T1.TDSAPPLICABLE,
				    T1.MANUALSCHEDULE,
				    T1.APPLYGRCPRICING,
				    T1.GRCPRICINGMETHOD,
				    T1.APPLYRPYPRICING,
				    T1.RPYPRICINGMETHOD,
				    T1.RPYHIERARCHY,
				    T67.RULECODE GRCPRICINGMETHODDESC,
				    T68.RULECODE RPYPRICINGMETHODDESC,
				    T1.DROPLINEOD,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.FINREPAYPFTONFRQ,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PFTDUESCHON,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.FDDLOCKPERIOD,
				    T1.ALWDRPYMETHODS,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.ROUNDINGMODE,
				    T1.ROUNDINGTARGET,
				    T1.FREQUENCYDAYS,
				    T1.QUICKDISB,
				    T1.ALWMAXDISBCHECKREQ,
				    T1.ALWREAGE,
				    T1.ALWUNPLANEMIHOLIDAY,
				    T1.PROFITCENTERID,
				    T69.PROFITCENTERCODE,
				    T69.PROFITCENTERDESC,
				    T1.PRODUCTCATEGORY,
				    T2.PRODUCTDESC FINCATEGORYDESC,
				    T1.DEVELOPERFINANCE,
				    T1.COSTOFFUNDS,
				    T1.CHEQUECAPTUREREQ,
				    T1.FINLTVCHECK,
				    T1.PARTIALLYSECURED,
				    T1.ALWADVEMI,
				    T1.ADVEMIMINTERMS,
				    T1.ADVEMIMAXTERMS,
				    T1.ADVEMIDFTTERMS,
				    T1.ADVEMISCHDMTHD,
				    T1.BPIPFTDAYSBASIS,
				    T1.ELIGIBILITYMETHODS,
				    T1.ALWHYBRIDRATE,
				    T1.FIXEDRATETENOR,
				    T1.ODMINCAPAMOUNT,
				    T1.ODRULECODE,
				    T1.ALWZEROINTACC,
				    T1.AUTOREJECTIONDAYS,
				    T1.TAXNOMAND,
				    T1.PUTCALLREQUIRED,
				    T1.GRCADVINTERSETREQ,
				    T1.GRCADVTYPE,
				    T1.GRCADVMINTERMS,
				    T1.GRCADVMAXTERMS,
				    T1.GRCADVDEFAULTTERMS,
				    T1.ADVINTERSETREQ,
				    T1.ADVTYPE,
				    T1.ADVMINTERMS,
				    T1.ADVMAXTERMS,
				    T1.ADVDEFAULTTERMS,
				    T1.ADVSTAGE,
				    T1.DSFREQ,
				    T1.CASHCOLLATERALREQ,
				    T1.TDSALLOWTOMODIFY,
				    T1.TDSAPPLICABLETO,
				    T1.ALWVAN,
				    T1.VANALLOCATIONMETHOD,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.ALWSANCTIONAMT,
				    T1.ALWSANCTIONAMTOVERRIDE,
				    T1.SANBSDSCHDLE,
				    T1.FINISRATERVWATGRCEND,
				    T1.SCHDONPMTCAL,
				    T1.AUTOAPPROVE,
				    T1.OCRREQUIRED,
				    T1.ALLOWEDOCRS,
				    T1.DEFAULTOCR,
				    T1.ALLOWEDLOANPURPOSES,
				    T1.SPECIFICLOANPURPOSES,
				    T1.ALWPLANNEDEMIINGRC,
				    T1.GRCADJREQ,
				    T1.GRCPERIODAFTRFULLDISB,
				    T1.AUTOINCRGRCENDDATE,
				    T1.GRCAUTOINCRMONTHS,
				    T1.MAXAUTOINCRALLOWED,
				    T1.THRLDTOMAINTAINGRCPRD,
				    T1.ALWLOANSPLIT,
				    T1.SPLITLOANTYPE,
				    T1.INSTBASEDSCHD,
				    T1.TDSTYPE,
				    T1.CALCOFSTEPS,
				    T1.STEPSAPPLIEDFOR,
				    T1.SUBVENTIONREQ,
					T1.OVERDRAFTTXNCHRGREQ,
					T1.OVERDRAFTTXNCHRGFEETYPE,
					T1.OVERDRAFTEXTGRACEDAYS,
					T1.OVERDRAFTCOLCHRGFEETYPE,
					T1.OVERDRAFTCOLAMT,
					T1.REGPROVRULE,
					T1.INTPROVRULE,
					T1.CLOSURETHRESHOLDLIMIT,
					T1.MAXFPPCALTYPE,
					T1.MAXFPPAMOUNT,
					T1.MAXFPPPER,
					T1.MAXFPPCALON,
					T1.PPLOCKINPERIOD,
					T1.ESLOCKINPERIOD,
					T1.MINPPCALTYPE,
					T1.MINPPAMOUNT,
					T1.MINPPPERCENTAGE,
					T1.MINPPCALON,
					T1.MAXPPCALTYPE,
					T1.MAXPPAMOUNT,
					T1.MAXPPPERCENTAGE,
					T1.MAXPPCALON,
					T1.ALLOWAUTOREFUND, 
					T1.MAXAUTOREFUND, 
					T1.MINAUTOREFUND
				FROM RMTFINANCETYPES T1
				LEFT JOIN BMTPRODUCT T2 ON T1.FINCATEGORY = T2.PRODUCTCODE
				LEFT JOIN SMTDIVISIONDETAIL T48 ON T1.FINDIVISION = T48.DIVISIONCODE
				LEFT JOIN RULES T59 ON T1.DOWNPAYRULE = T59.RULEID
				LEFT JOIN RULES T67 ON T1.GRCPRICINGMETHOD = T67.RULEID
				LEFT JOIN RULES T68 ON T1.RPYPRICINGMETHOD = T68.RULEID
				LEFT JOIN PROFITCENTERS T69 ON T69.PROFITCENTERID = T1.PROFITCENTERID
				WHERE NOT EXISTS (SELECT 1 FROM RMTFINANCETYPES_TEMP WHERE RMTFINANCETYPES_TEMP.FINTYPE = T1.FINTYPE)
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#713.36_post" author="Sravani.S" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rmtfinancetypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.37_pre" author="Sravani.S" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_orgview'); 	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.37" author="Sravani.S">
		<createView viewName="RMTFINANCETYPES_ORGVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINTYPE,
				    T1.FINCATEGORY,
				    T1.FINTYPEDESC,
				    T1.FINCCY,
				    T1.FINDAYSCALTYPE,
				    T1.FINISGENREF,
				    T1.FINMAXAMOUNT,
				    T1.FINMINAMOUNT,
				    T1.FINISALWMD,
				    T1.FINSCHDMTHD,
				    T1.FINISALWGRACE,
				    T1.EQUALREPAYMENT,
				    T1.FINRATETYPE,
				    T1.FINBASERATE,
				    T1.FINSPLRATE,
				    T1.FININTRATE,
				    T1.FINMINRATE,
				    T1.FINMAXRATE,
				    T1.FINDFTINTFRQ,
				    T1.FINISINTCPZ,
				    T1.FINCPZFRQ,
				    T1.FINISRVWALW,
				    T1.FINRVWFRQ,
				    T1.FINGRCRATETYPE,
				    T1.FINGRCBASERATE,
				    T1.FINGRCSPLRATE,
				    T1.FINGRCINTRATE,
				    T1.FINGRCMINRATE,
				    T1.FINGRCMAXRATE,
				    T1.FINGRCDFTINTFRQ,
				    T1.FINGRCISINTCPZ,
				    T1.FINGRCCPZFRQ,
				    T1.FINGRCISRVWALW,
				    T1.FINGRCRVWFRQ,
				    T1.FINMINTERM,
				    T1.FINMAXTERM,
				    T1.FINDFTTERMS,
				    T1.FINRPYFRQ,
				    T1.FINREPAYMETHOD,
				    T1.FINISALWDIFFERMENT,
				    T1.FINMAXDIFFERMENT,
				    T1.FINISACTIVE,
				    T1.STEPFINANCE,
				    T1.STEPPINGMANDATORY,
				    T1.ALWMANUALSTEPS,
				    T1.ALWDSTEPPOLICIES,
				    T1.DFTSTEPPOLICY,
				    T1.FINISDWPAYREQUIRED,
				    T1.FINRVWRATEAPPLFOR,
				    T1.FINALWRATECHANGEANYDATE,
				    T1.FINISINTCPZATGRCEND,
				    T1.FINSCHCALCODEONRVW,
				    T1.ALWPLANDEFERMENT,
				    T1.PLANDEFERCOUNT,
				    T1.FINISALWGRCREPAY,
				    T1.FINGRCSCHDMTHD,
				    T1.FINGRCMARGIN,
				    T1.FINMARGIN,
				    T1.FINCOMMITMENTREQ,
				    T1.FINCOLLATERALREQ,
				    T1.OVERRIDELIMIT,
				    T1.LIMITREQUIRED,
				    T1.FINCOMMITMENTOVRRIDE,
				    T1.FINCOLLATERALOVRRIDE,
				    T1.FINREPAYPFTONFRQ,
				    T1.FINPFTUNCHANGED,
				    T1.APPLYODPENALTY,
				    T1.ODINCGRCDAYS,
				    T1.ODCHARGETYPE,
				    T1.ODGRACEDAYS,
				    T1.ODCHARGECALON,
				    T1.ODCHARGEAMTORPERC,
				    T1.ODALLOWWAIVER,
				    T1.ODMAXWAIVERPERC,
				    T1.FINDIVISION,
				    T3.DIVISIONCODEDESC LOVDESCFINDIVISIONNAME,
				    T1.PRODUCT,
				    T1.STARTDATE,
				    T1.ENDDATE,
				    T1.FINTYPEDESC LOVDESCPROMOFINTYPEDESC,
				    T1.REMARKS,
				    T4.POLICYDESC LOVDESCDFTSTEPPOLICYNAME,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DOWNPAYRULE,
				    T1.ALWMULTIPARTYDISB,
				    T1.COLLATERALTYPE,
				    T1.TDSAPPLICABLE,
				    T5.RULECODE DOWNPAYRULECODE,
				    T5.RULECODEDESC DOWNPAYRULEDESC,
				    T1.APPLYGRCPRICING,
				    T1.APPLYRPYPRICING,
				    T6.RULECODE GRCPRICINGMETHODDESC,
				    T7.RULECODE RPYPRICINGMETHODDESC,
				    T1.DROPLINEOD,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T4.STEPTYPE DFTSTEPPOLICYTYPE,
				    T1.MANUALSCHEDULE,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PFTDUESCHON,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.FDDLOCKPERIOD,
				    T1.ALWDRPYMETHODS,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.ROUNDINGMODE,
				    T1.ROUNDINGTARGET,
				    T1.FREQUENCYDAYS,
				    T1.QUICKDISB,
				    T1.ALWREAGE,
				    T1.ALWUNPLANEMIHOLIDAY,
				    T1.ALWMAXDISBCHECKREQ,
				    T1.PRODUCTCATEGORY,
				    T1.RPYHIERARCHY,
				    T1.DEVELOPERFINANCE,
				    T3.ENTITYCODE LOVDESCENTITYCODE,
				    T8.ENTITYDESC LOVDESCENTITYDESC,
				    T1.COSTOFFUNDS,
				    T1.CHEQUECAPTUREREQ,
				    T1.FINLTVCHECK,
				    T1.PARTIALLYSECURED,
				    T1.ALWADVEMI,
				    T1.ADVEMIMINTERMS,
				    T1.ADVEMIMAXTERMS,
				    T1.ADVEMIDFTTERMS,
				    T1.ADVEMISCHDMTHD,
				    T1.BPIPFTDAYSBASIS,
				    T1.ELIGIBILITYMETHODS,
				    T1.ALWHYBRIDRATE,
				    T1.FIXEDRATETENOR,
				    T1.ODMINCAPAMOUNT,
				    T1.ODRULECODE,
				    T1.ALWZEROINTACC,
				    T1.FINISALWPARTIALRPY,
				    T1.AUTOREJECTIONDAYS,
				    T1.TAXNOMAND,
				    T1.PUTCALLREQUIRED,
				    T1.GRCADVINTERSETREQ,
				    T1.GRCADVTYPE,
				    T1.GRCADVMINTERMS,
				    T1.GRCADVMAXTERMS,
				    T1.GRCADVDEFAULTTERMS,
				    T1.ADVINTERSETREQ,
				    T1.ADVTYPE,
				    T1.ADVMINTERMS,
				    T1.ADVMAXTERMS,
				    T1.ADVDEFAULTTERMS,
				    T1.ADVSTAGE,
				    T1.DSFREQ,
				    T1.CASHCOLLATERALREQ,
				    T1.ALWEARLYPAYMETHODS,
				    T1.FINSCHEDULEON,
				    T1.TDSALLOWTOMODIFY,
				    T1.TDSAPPLICABLETO,
				    T1.ALWVAN,
				    T1.VANALLOCATIONMETHOD,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.ALWSANCTIONAMT,
				    T1.ALWSANCTIONAMTOVERRIDE,
				    T1.SANBSDSCHDLE,
				    T1.FINISRATERVWATGRCEND,
				    T1.SCHDONPMTCAL,
				    T1.AUTOAPPROVE,
				    T1.OCRREQUIRED,
				    T1.ALLOWEDOCRS,
				    T1.DEFAULTOCR,
				    T1.ALLOWEDLOANPURPOSES,
				    T1.SPECIFICLOANPURPOSES,
				    T1.ALWPLANNEDEMIINGRC,
				    T1.GRCADJREQ,
				    T1.GRCPERIODAFTRFULLDISB,
				    T1.AUTOINCRGRCENDDATE,
				    T1.GRCAUTOINCRMONTHS,
				    T1.MAXAUTOINCRALLOWED,
				    T1.THRLDTOMAINTAINGRCPRD,
				    T1.ALWLOANSPLIT,
				    T1.SPLITLOANTYPE,
				    T1.INSTBASEDSCHD,
				    T1.TDSTYPE,
				    T1.CALCOFSTEPS,
				    T1.STEPSAPPLIEDFOR,
				    T1.SUBVENTIONREQ,
					T1.OVERDRAFTTXNCHRGREQ,
					T1.OVERDRAFTTXNCHRGFEETYPE,
					T1.OVERDRAFTEXTGRACEDAYS,
					T1.OVERDRAFTCOLCHRGFEETYPE,
					T1.OVERDRAFTCOLAMT,
					T1.REGPROVRULE,
					T1.INTPROVRULE,
					T1.CLOSURETHRESHOLDLIMIT,
					T1.MAXFPPCALTYPE,
					T1.MAXFPPAMOUNT,
					T1.MAXFPPPER,
					T1.MAXFPPCALON,
					T1.PPLOCKINPERIOD,
					T1.ESLOCKINPERIOD,
					T1.MINPPCALTYPE,
					T1.MINPPAMOUNT,
					T1.MINPPPERCENTAGE,
					T1.MINPPCALON,
					T1.MAXPPCALTYPE,
					T1.MAXPPAMOUNT,
					T1.MAXPPPERCENTAGE,
					T1.MAXPPCALON,
					T1.ALLOWAUTOREFUND, 
					T1.MAXAUTOREFUND, 
					T1.MINAUTOREFUND
				FROM RMTFINANCETYPES T1
				INNER JOIN SMTDIVISIONDETAIL T3 ON T1.FINDIVISION = T3.DIVISIONCODE
				LEFT JOIN STEPPOLICYHEADER T4 ON T1.DFTSTEPPOLICY = T4.POLICYCODE
				LEFT JOIN RULES T5 ON T1.DOWNPAYRULE = T5.RULEID
				LEFT JOIN RULES T6 ON T1.GRCPRICINGMETHOD = T6.RULEID
				LEFT JOIN RULES T7 ON T1.RPYPRICINGMETHOD = T7.RULEID
				LEFT JOIN ENTITY T8 ON T3.ENTITYCODE = T8.ENTITYCODE
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#713.37_post" author="Sravani.S" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rmtfinancetypes_orgview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.38_pre" author="Sravani.S" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_aeview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#713.38" author="Sravani.S">
		<createView viewName="RMTFINANCETYPES_AEVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINTYPE,
				    '' FINDEFFREQ,
				    T1.FINCCY,
				    T1.FINCATEGORY,
				    T1.DEVELOPERFINANCE,
				    T1.PARTIALLYSECURED,
				    T1.INSTBASEDSCHD,
				    T1.TDSTYPE,
				    T1.SUBVENTIONREQ,
					T1.CLOSURETHRESHOLDLIMIT,
					T1.MAXFPPCALTYPE,
					T1.MAXFPPAMOUNT,
					T1.MAXFPPPER,
					T1.MAXFPPCALON,
					T1.PPLOCKINPERIOD,
					T1.ESLOCKINPERIOD,
					T1.MINPPCALTYPE,
					T1.MINPPAMOUNT,
					T1.MINPPPERCENTAGE,
					T1.MINPPCALON,
					T1.MAXPPCALTYPE,
					T1.MAXPPAMOUNT,
					T1.MAXPPPERCENTAGE,
					T1.MAXPPCALON,
					T1.ALLOWAUTOREFUND, 
					T1.MAXAUTOREFUND, 
					T1.MINAUTOREFUND
				FROM RMTFINANCETYPES T1	
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#713.38_post" author="Sravani.S" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rmtfinancetypes_aeview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.1" author="vijaya.a">
		<sql>
			<![CDATA[
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'FINTYPEPARTNERBANK_MAPPING_MAKER', 'Fin Type Parnerbank Mapping Maker Group', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'FINTYPEPARTNERBANK_MAPPING_APPROVER', 'Fin Type Parnerbank Mapping Approver Group', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_FinTypePartnerbankMapping', 'MENU', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_finType', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_Purpose', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_PaymentMode', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_PartnerBankID', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_branch', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'button_FinTypePartnerBankMappingDialog_btnNew', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'button_FinTypePartnerBankMappingDialog_btnEdit', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'button_FinTypePartnerBankMappingDialog_btnDelete', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'button_FinTypePartnerBankMappingDialog_btnSave', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
		
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_FinTypePartnerbankMapping'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_finType'), 1, 1, 1000, CURRENT_TIMESTAMP,NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_Purpose'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_PaymentMode'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_PartnerBankID'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_branch'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnNew'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_FinTypePartnerbankMapping'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.2" author="vijaya.a">
		<sql>
			<![CDATA[
				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'FINTYPEPARTNERBANK_MAPPING_MAKER', 'Maker role from FinType Partner Bank Mapping', '', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0); 
		  		INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'FINTYPEPARTNERBANK_MAPPING_APPROVER', 'Approver role from FinType Partner Bank Mapping',	'', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		    
		    	INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'),    (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'FINTYPEPARTNERBANK_MAPPING_MAKER'),    0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		    	INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_APPROVER'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'FINTYPEPARTNERBANK_MAPPING_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		    	
		    	UPDATE SECROLES SET ROLECD = 'FINTYPE_PARTNER_BANK_MAPPING_MAKER' WHERE ROLECD = 'FINTYPEPARTNERBANK_MAPPING_MAKER';
		    	UPDATE SECROLES SET ROLECD = 'FINTYPE_PARTNER_BANK_MAPPING_APPROVER' WHERE ROLECD = 'FINTYPEPARTNERBANK_MAPPING_APPROVER';
		    	
		    	UPDATE SECGROUPS SET GRPCODE = 'FINTYPE_PARTNER_BANK_MAPPING_MAKER' WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER';
		    	UPDATE SECGROUPS SET GRPCODE = 'FINTYPE_PARTNER_BANK_MAPPING_APPROVER' WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_APPROVER';
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.3" author="vijaya.a">
		<addColumn tableName="FINTYPEPARTNERBANKS_Temp">
			<column name="BRANCHCODE" type="VARCHAR(12)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#704.4" author="vijaya.a">
		<addColumn tableName="FINTYPEPARTNERBANKS">
			<column name="BRANCHCODE" type="VARCHAR(12)" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#704.5" author="vijaya.a">
		<addColumn tableName="FINTYPEPARTNERBANKS_Temp">
			<column name="CLUSTERID" type="bigint" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#704.6" author="vijaya.a">
		<addColumn tableName="FINTYPEPARTNERBANKS">
			<column name="CLUSTERID" type="bigint" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#704.7.1_pre" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fintypepartnerbanks_view');
		 	]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.7.1" author="vijaya.a">
		<createView viewName="FINTYPEPARTNERBANKS_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID,
					T1.FINTYPE,
					T5.FINTYPEDESC,
					T1.PURPOSE,
					T1.PAYMENTMODE,
					T1.PARTNERBANKID,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.PARTNERBANKCODE,
					T2.PARTNERBANKNAME,
					T1.VANAPPLICABLE,
					T1.BRANCHCODE,
					T3.BRANCHDESC,
					T1.CLUSTERID,
					T4.CODE CLUSTERCODE,
					T4.NAME,
					T4.CLUSTERTYPE,
					T2.ACCOUNTNO SUSPENSEAC
				FROM FINTYPEPARTNERBANKS_TEMP T1
				INNER JOIN PARTNERBANKS T2 ON T1.PARTNERBANKID = T2.PARTNERBANKID
				INNER JOIN RMTFINANCETYPES T5 ON T1.FINTYPE = T5.FINTYPE
				LEFT JOIN RMTBRANCHES T3 ON T1.BRANCHCODE = T3.BRANCHCODE
				LEFT JOIN CLUSTERS T4 ON T1.CLUSTERID = T4.ID
				UNION ALL
				SELECT T1.ID,
					T1.FINTYPE,
					T5.FINTYPEDESC,
					T1.PURPOSE,
					T1.PAYMENTMODE,
					T1.PARTNERBANKID,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.PARTNERBANKCODE,
					T2.PARTNERBANKNAME,
					T1.VANAPPLICABLE,
					T1.BRANCHCODE,
					T3.BRANCHDESC,
					T1.CLUSTERID,
					T4.CODE CLUSTERCODE,
					T4.NAME,
					T4.CLUSTERTYPE,
					T2.ACCOUNTNO SUSPENSEAC
				FROM FINTYPEPARTNERBANKS T1
				INNER JOIN RMTFINANCETYPES T5 ON T1.FINTYPE = T5.FINTYPE
				INNER JOIN PARTNERBANKS T2 ON T1.PARTNERBANKID = T2.PARTNERBANKID
				LEFT JOIN RMTBRANCHES T3 ON T1.BRANCHCODE = T3.BRANCHCODE
				LEFT JOIN CLUSTERS T4 ON T1.CLUSTERID = T4.ID
				WHERE NOT EXISTS (SELECT 1 FROM FINTYPEPARTNERBANKS_TEMP WHERE FINTYPEPARTNERBANKS_TEMP.ID = T1.ID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#704.7.1_post" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fintypepartnerbanks_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.8.1_pre" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fintypepartnerbanks_aview');
		 	]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.8.1" author="vijaya.a">
		<createView viewName="FINTYPEPARTNERBANKS_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID,
					T1.FINTYPE,
					T3.FINTYPEDESC,
					T1.PURPOSE,
					T1.PAYMENTMODE,
					T1.PARTNERBANKID,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.PARTNERBANKCODE,
					T2.PARTNERBANKNAME,
					T2.ACTIVE,
					T2.ACCOUNTNO,
					T2.ACTYPE AS ACCOUNTTYPE,
					T4.ENTITYCODE,
					T1.VANAPPLICABLE,
					T1.BRANCHCODE,
					T5.BRANCHDESC,
					T1.CLUSTERID,
					T6.CODE CLUSTERCODE,
					T6.NAME,
					T6.CLUSTERTYPE
				FROM FINTYPEPARTNERBANKS T1
				INNER JOIN PARTNERBANKS T2 ON T1.PARTNERBANKID = T2.PARTNERBANKID
				INNER JOIN RMTFINANCETYPES T3 ON T1.FINTYPE = T3.FINTYPE
				INNER JOIN SMTDIVISIONDETAIL T4 ON T3.FINDIVISION = T4.DIVISIONCODE
				LEFT JOIN RMTBRANCHES T5 ON T1.BRANCHCODE = T5.BRANCHCODE
				LEFT JOIN CLUSTERS T6 ON T1.CLUSTERID = T6.ID
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#704.8.1_post" author="vijaya.a" dbms="postgress">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fintypepartnerbanks_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.9_pre" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_fcview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.9" author="vijaya.a">
		<createView viewName="FINRECEIPTHEADER_FCVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					T2.FINID,
					T1.REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.SUBRECEIPTMODE,
					T1.RECEIPTCHANNEL,
					T1.RECEIVEDFROM,
					T1.PANNUMBER,
					T1.COLLECTIONAGENTID,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					T2.NEXTREPAYRVWDATE,
					T1.CASHIERBRANCH,
					T1.INITIATEDATE,
					T1.INSTRUCTIONUID,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T10.DIVISIONCODEDESC FINDIVISIONDESC,
					T11.BRANCHDESC POSTBRANCHDESC,
					T12.BRANCHDESC CASHIERBRANCHDESC,
					T10.ENTITYCODE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.MODULE,
					T1.EXTREFERENCE,
					T13.CUSTCIF CUSTOMERCIF,
					T13.CUSTSHRTNAME CUSTOMERNAME,
					T1.ACTFINRECEIPT,
					T1.REASONCODE,
					T1.CANCELREMARKS,
					T1.REFWAIVERAMT,        
					T1.SOURCE,             
					T1.VALUEDATE,           
					T1.TRANSACTIONREF,      
					T1.DEPOSITDATE,         
					T1.PARTNERBANKID,       
					T1.PRVRECEIPTPURPOSE,   
					T1.RECEIPTSOURCE,       
					T1.RECAPPDATE,          
					T1.RECEIVEDDATE,
					T1.KNOCKOFFTYPE,
					T1.SOURCEOFFUND,
					T1.TDSAMOUNT,
					T1.CLOSURETYPEID,
	      			T14.CODE CLOSURETYPEDESC,
					T1.RECADJAMT,
					T1.CUSTBANKID,
					CB.ACCOUNTNUMBER CUSTACCTNUMBER,
					CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME,
					T1.MODULETYPE,
					PB.PARTNERBANKCODE
				FROM FINRECEIPTHEADER_TEMP T1
				LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN CLOSURE_TYPES	T14 ON T14.ID = T1.CLOSURETYPEID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
				LEFT JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = T1.PARTNERBANKID
				UNION ALL
				SELECT
					T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					T2.FINID,
					T1.REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.SUBRECEIPTMODE,
					T1.RECEIPTCHANNEL,
					T1.RECEIVEDFROM,
					T1.PANNUMBER,
					T1.COLLECTIONAGENTID,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					T2.NEXTREPAYRVWDATE,
					T1.CASHIERBRANCH,
					T1.INITIATEDATE,
					T1.INSTRUCTIONUID,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T10.DIVISIONCODEDESC FINDIVISIONDESC,
					T11.BRANCHDESC POSTBRANCHDESC,
					T12.BRANCHDESC CASHIERBRANCHDESC,
					T10.ENTITYCODE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.MODULE,
					T1.EXTREFERENCE,
					T13.CUSTCIF CUSTOMERCIF,
					T13.CUSTSHRTNAME CUSTOMERNAME,
					T1.ACTFINRECEIPT,
					T1.REASONCODE,
					T1.CANCELREMARKS,
					T1.REFWAIVERAMT,        
					T1.SOURCE,             
					T1.VALUEDATE,           
					T1.TRANSACTIONREF,      
					T1.DEPOSITDATE,         
					T1.PARTNERBANKID,       
					T1.PRVRECEIPTPURPOSE,   
					T1.RECEIPTSOURCE,       
					T1.RECAPPDATE,          
					T1.RECEIVEDDATE,
					T1.KNOCKOFFTYPE,
					T1.SOURCEOFFUND,
					T1.TDSAMOUNT,
					T1.CLOSURETYPEID,
	      			T14.CODE CLOSURETYPEDESC,
					T1.RECADJAMT,
					T1.CUSTBANKID,
					CB.ACCOUNTNUMBER CUSTACCTNUMBER,
					CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME,
					T1.MODULETYPE,
					PB.PARTNERBANKCODE
				FROM FINRECEIPTHEADER T1
				LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN CLOSURE_TYPES	T14 ON T14.ID = T1.CLOSURETYPEID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
				LEFT JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = T1.PARTNERBANKID
				WHERE NOT EXISTS ( SELECT 1 FROM FINRECEIPTHEADER_TEMP WHERE RECEIPTID = T1.RECEIPTID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#704.9_post" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finreceiptheader_fcview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.10_pre" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_fview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.10" author="vijaya.a">
		<createView viewName="FINRECEIPTHEADER_FVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.ACTFINRECEIPT,
					T1.RECAGAINST,
					T2.FINID,
					T1.REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.SUBRECEIPTMODE,
					T1.RECEIPTCHANNEL,
					T1.RECEIVEDFROM,
					T1.PANNUMBER,
					T1.COLLECTIONAGENTID,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					COALESCE(T1.FINTYPE, T2.FINTYPE) FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					COALESCE(T2.FINCCY, T15.FINCCY) FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					COALESCE(T4.FINTYPEDESC, T15.FINTYPEDESC) FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					COALESCE(T5.CCYDESC, T14.CCYDESC) FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, T10.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					T1.CASHIERBRANCH,
					T2.NEXTREPAYRVWDATE,
					T1.INITIATEDATE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.MODULE,
					T1.INSTRUCTIONUID,
					T1.EXTREFERENCE,
					T10.CUSTCIF CUSTOMERCIF,
					T10.CUSTSHRTNAME CUSTOMERNAME,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T11.DIVISIONCODEDESC FINDIVISIONDESC,
					T12.BRANCHDESC POSTBRANCHDESC,
					T13.BRANCHDESC CASHIERBRANCHDESC,
					T11.ENTITYCODE,
					COALESCE(T3.CUSTBASECCY,T10.CUSTBASECCY)CUSTBASECCY,
					T1.REASONCODE,
					T1.CANCELREMARKS,
					T1.REFWAIVERAMT,        
					T1.SOURCE,             
					T1.VALUEDATE,           
					T1.TRANSACTIONREF,      
					T1.DEPOSITDATE,         
					T1.PARTNERBANKID,       
					T1.PRVRECEIPTPURPOSE,   
					T1.RECEIPTSOURCE,       
					T1.RECAPPDATE,          
					T1.RECEIVEDDATE,
					T1.KNOCKOFFTYPE,
					T2.TDSAPPLICABLE FINTDSAPPLICABLE,
					T1.SOURCEOFFUND,
					T1.TDSAMOUNT,
					T1.CLOSURETYPEID,
	      			T16.CODE CLOSURETYPEDESC,
				    T1.RECADJAMT,
				    T1.CUSTBANKID,
					CB.ACCOUNTNUMBER CUSTACCTNUMBER,
					CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME,
					T1.MODULETYPE,
					PB.PARTNERBANKCODE
				FROM FINRECEIPTHEADER_TEMP T1
				LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN Customers T10 ON CAST(T10.CustId AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN SMTDIVISIONDETAIL T11 ON T1.FINDIVISION = T11.DIVISIONCODE
				LEFT JOIN RMTBranches T12 ON T1.PostBranch = T12.BranchCode
				LEFT JOIN RMTBranches T13 ON T1.CASHIERBRANCH = T13.BranchCode
				LEFT JOIN RMTFINANCETYPES T15 ON T1.FINTYPE = T15.FINTYPE
				LEFT JOIN RMTCURRENCIES T14 ON T14.CCYCODE= T3.CUSTBASECCY
				LEFT JOIN CLOSURE_TYPES	T16 ON T16.ID = T1.CLOSURETYPEID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
				LEFT JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = T1.PARTNERBANKID
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#704.10_post" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finreceiptheader_fview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.11_pre" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_feview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#704.11" author="vijaya.a">
		<createView viewName="FINRECEIPTHEADER_FEVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					T2.FINID,
					T1.REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					T2.NEXTREPAYRVWDATE,
					T1.CASHIERBRANCH,
					T1.INITIATEDATE,
					T4.FINDIVISION LOVDESCFINDIVISION,
					T2.BUSINESSVERTICAL,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T10.DIVISIONCODEDESC FINDIVISIONDESC,
					T11.BRANCHDESC POSTBRANCHDESC,
					T12.BRANCHDESC CASHIERBRANCHDESC,
					T10.ENTITYCODE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.INSTRUCTIONUID,
					T1.MODULE,
					T1.EXTREFERENCE,
					T1.COLLECTIONAGENTID,
					T1.PANNUMBER,
					T1.RECEIVEDFROM,
					T1.RECEIPTCHANNEL,
					T1.SUBRECEIPTMODE,
					T13.CUSTCIF CUSTOMERCIF,
					T13.CUSTSHRTNAME CUSTOMERNAME,
					T1.ACTFINRECEIPT,
					T1.REASONCODE,
					T1.CANCELREMARKS,
					T1.REFWAIVERAMT,        
					T1.SOURCE,             
					T1.VALUEDATE,           
					T1.TRANSACTIONREF,      
					T1.DEPOSITDATE,         
					T1.PARTNERBANKID,       
					T1.PRVRECEIPTPURPOSE,   
					T1.RECEIPTSOURCE,       
					T1.RECAPPDATE,          
					T1.RECEIVEDDATE,
					T1.KNOCKOFFTYPE,
					T1.SOURCEOFFUND,
					T1.TDSAMOUNT,
					T1.CLOSURETYPEID,
	      			T14.CODE CLOSURETYPEDESC,
				    T1.RECADJAMT,
				    T1.CUSTBANKID,
					CB.ACCOUNTNUMBER CUSTACCTNUMBER,
					CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME,
					T1.MODULETYPE,
					PB.PARTNERBANKCODE
				FROM FINRECEIPTHEADER_TEMP T1
				LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN CLOSURE_TYPES	T14 ON T14.ID = T1.CLOSURETYPEID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
				LEFT JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = T1.PARTNERBANKID
				UNION ALL
				SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					T2.FINID,
					T1.REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					T2.NEXTREPAYRVWDATE,
					T1.CASHIERBRANCH,
					T1.INITIATEDATE,
					T4.FINDIVISION LOVDESCFINDIVISION,
					T2.BUSINESSVERTICAL,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T10.DIVISIONCODEDESC FINDIVISIONDESC,
					T11.BRANCHDESC POSTBRANCHDESC,
					T12.BRANCHDESC CASHIERBRANCHDESC,
					T10.ENTITYCODE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.INSTRUCTIONUID,
					T1.MODULE,
					T1.EXTREFERENCE,
					T1.COLLECTIONAGENTID,
					T1.PANNUMBER,
					T1.RECEIVEDFROM,
					T1.RECEIPTCHANNEL,
					T1.SUBRECEIPTMODE,
					T13.CUSTCIF CUSTOMERCIF,
					T13.CUSTSHRTNAME CUSTOMERNAME,
					T1.ACTFINRECEIPT,
					T1.REASONCODE,
					T1.CANCELREMARKS,
					T1.REFWAIVERAMT,        
					T1.SOURCE,             
					T1.VALUEDATE,           
					T1.TRANSACTIONREF,      
					T1.DEPOSITDATE,         
					T1.PARTNERBANKID,       
					T1.PRVRECEIPTPURPOSE,   
					T1.RECEIPTSOURCE,       
					T1.RECAPPDATE,          
					T1.RECEIVEDDATE,
					T1.KNOCKOFFTYPE,
					T1.SOURCEOFFUND,
					T1.TDSAMOUNT,
					T1.CLOSURETYPEID,
	      			T14.CODE CLOSURETYPEDESC,
				    T1.RECADJAMT,
				    T1.CUSTBANKID,
					CB.ACCOUNTNUMBER CUSTACCTNUMBER,
					CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME,
					T1.MODULETYPE,
					PB.PARTNERBANKCODE
				FROM FINRECEIPTHEADER T1
				LEFT JOIN (SELECT FINID, FINREFERENCE, FINBRANCH, FINTYPE
							, FINCCY, SCHEDULEMETHOD, PROFITDAYSBASIS, FINISACTIVE
							, CUSTID, PRODUCTCATEGORY, PROMOTIONCODE, NEXTREPAYRVWDATE
							, BUSINESSVERTICAL
						FROM FINANCEMAIN_TEMP
						UNION
						SELECT FINID, FINREFERENCE, FINBRANCH, FINTYPE, FINCCY
							, SCHEDULEMETHOD, PROFITDAYSBASIS, FINISACTIVE
							, CUSTID, PRODUCTCATEGORY, PROMOTIONCODE, NEXTREPAYRVWDATE
							, BUSINESSVERTICAL
						FROM FINANCEMAIN ) T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN CLOSURE_TYPES	T14 ON T14.ID = T1.CLOSURETYPEID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
				LEFT JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = T1.PARTNERBANKID
				WHERE NOT EXISTS (SELECT 1 FROM FINRECEIPTHEADER_TEMP WHERE RECEIPTID = T1.RECEIPTID )
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#704.11_post" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finreceiptheader_feview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#710.1" author="saikiran.n">
		<addColumn tableName="FinanceMain_temp">
			<column name="SecurityMandateID" type="bigint" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#710.2" author="saikiran.n">
		<addColumn tableName="FinanceMain">
			<column name="SecurityMandateID" type="bigint" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#710.3_pre" author="Kiran.p" dbms="oracle">
	<comment> Below index is creted for update records faster way </comment>
		<sql>
			<![CDATA[
					create index IX_MD_ORG_SCMD on MANDATES(NLSSORT("ORGREFERENCE",'nls_sort=''BINARY_CI'''),NLSSORT("SECURITYMANDATE",'nls_sort=''BINARY_CI'''));
				]]>
		</sql>
	</changeSet>
	
	<changeSet id="ST#710.3_pre" author="Kiran.p" dbms="postgresql">
	<comment> Below index is creted for update records faster way </comment>
		<sql>
			<![CDATA[
					create index IX_MD_ORG_SCMD on MANDATES(lower(ORGREFERENCE),SECURITYMANDATE);
				]]>
		</sql>
	</changeSet>

	<changeSet id="ST#710.3_pre" author="Kiran.p" dbms="mssql">
	<comment> Below index is creted for update records faster way </comment>
		<sql>
			<![CDATA[
					create index IX_MD_ORG_SCMD on MANDATES(ORGREFERENCE,SECURITYMANDATE);
				]]>
		</sql>
	</changeSet>
	<changeSet id="ST#710.3" author="saikiran.n">
		<sql>
			<![CDATA[
				 UPDATE FINANCEMAIN SET SECURITYMANDATEID = (SELECT M.MANDATEID FROM MANDATES M WHERE FINANCEMAIN.FINREFERENCE = M.ORGREFERENCE AND M.SECURITYMANDATE = 1);
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="ST#710.3_post" author="Kiran.p" dbms="oracle,postgresql">
	<comment> Index not used in applciation so we are dropIndex</comment>
		<sql>
			<![CDATA[
					drop index IX_MD_ORG_SCMD;
				]]>
		</sql>
	</changeSet>
	
	<changeSet id="ST#710.3_post" author="Kiran.p" dbms="mssql">
	<comment> Index not used in applciation so we are dropIndex</comment>
		<sql>
			<![CDATA[
					drop index IX_MD_ORG_SCMD on MANDATES;
				]]>
		</sql>
	</changeSet>

	<changeSet id="ST#710.4_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financeenquiry_view');
		 	]]>
		</sql>
	</changeSet>

	<changeSet id="ST#710.4" author="saikiran.n">
		<createView viewName="FINANCEENQUIRY_VIEW" replaceIfExists="true">
		  <![CDATA[
				SELECT FM.FINID,
					FM.FINREFERENCE,
					FM.FINBRANCH,
					FM.FINTYPE,
					FM.FINCCY,
					FM.SCHEDULEMETHOD,
					FM.PROFITDAYSBASIS,
					FM.FINSTARTDATE,
					FM.CALTERMS NUMBEROFTERMS,
					FM.CUSTID,
					FM.FINAMOUNT,
					FM.GRCPERIODENDDATE,
					FM.MATURITYDATE,
					FM.FINREPAYMENTAMOUNT,
					FM.FINISACTIVE,
					FM.ALLOWGRCPERIOD,
					FM.DOWNPAYMENT,
					FM.MIGRATEDFINANCE,
					FM.LASTREPAYDATE,
					FM.LASTREPAYPFTDATE,
					FM.FINCURRASSETVALUE,
					FM.BLACKLISTED,
					FM.FEECHARGEAMT,
					FM.CLOSINGSTATUS,
					FM.GRACETERMS,
					FM.ALWMULTIDISB,
					FM.DEFFERMENTS,
					FM.FINSTATUS ,
					FM.MANDATEID,
					FM.FINREPAYMETHOD,
					FM.FINASSETVALUE,
					FM.SANBSDSCHDLE,
					FM.PROMOTIONSEQID,
					FM.SVAMOUNT,
					FM.CBAMOUNT,
					(FM.FINCURRASSETVALUE+ FM.FEECHARGEAMT) FINANCINGAMOUNT,
					(FM.FINCURRASSETVALUE- FM.FINREPAYMENTAMOUNT+ FM.FEECHARGEAMT) CURFINAMOUNT,
					RF.FINTYPEDESC LOVDESCFINTYPENAME,
					RF.FINSCHEDULEON LOVDESCFINSCHEDULEON,
					RF.FINDIVISION LOVDESCFINDIVISION,
					RF.FINCATEGORY LOVDESCPRODUCTCODENAME,
					RF.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
					C.CUSTCIF LOVDESCCUSTCIF,
					C.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
					RB.BRANCHDESC LOVDESCFINBRANCHNAME,
					RC.CUSTTYPECTG,
					COALESCE(FP.NOINST,0) NOINST,
					FM.TOTALCPZ,
					FM.FINOCRREQUIRED,
					FM.ALWGRCADJ,
					FM.ENDGRCPERIODAFTRFULLDISB,
					FM.AUTOINCGRCENDDATE,
					FM.RECORDSTATUS,
					FM.WRITEOFFLOAN,
					FM.RESTRUCTURE,
					FM.SUBVENTIONFROM,
					FM.MANUFACTURERDEALERID,
					AV.DEALERNAME MANUFACTURERDEALERNAME,
					AV.CODE MANUFACTURERDEALERCODE,
					FM.ESCROW,
					FM.CUSTBANKID,
					CB.ACCOUNTNUMBER CUSTACCTNUMBER,
					CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME,
					FM.SECURITYMANDATEID
				FROM FINANCEMAIN FM
				INNER JOIN RMTFINANCETYPES RF ON RF.FINTYPE = FM.FINTYPE
				INNER JOIN CUSTOMERS C ON C.CUSTID = FM.CUSTID
				INNER JOIN RMTBRANCHES RB ON RB.BRANCHCODE = FM.FINBRANCH
				INNER JOIN RMTCUSTTYPES RC ON RC.CUSTTYPECODE = C.CUSTTYPECODE 
				LEFT JOIN FINPFTDETAILS FP ON FP.FINID = FM.FINID
				LEFT JOIN AMTVEHICLEDEALER AV ON AV.DEALERID = FM.MANUFACTURERDEALERID 
				LEFT JOIN CUSTOMERBANKINFO CB ON CB.BANKID = FM.CUSTBANKID
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#710.4_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financeenquiry_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#113_pre1" author="Gopal.p">
		<dropSequence sequenceName="SEQ_FILE_UPLOAD_HEADER" />
	</changeSet>

	<changeSet id="ST#113_pre2" author="Gopal.p">
		<dropView viewName="FILE_UPLOAD_HEADER_AVIEW" />
	</changeSet>

	<changeSet id="ST#113_pre3" author="Gopal.p">
		<dropView viewName="FILE_UPLOAD_HEADER_TVIEW" />
	</changeSet>

	<changeSet id="ST#113_pre4" author="Gopal.p">
		<dropView viewName="FILE_UPLOAD_HEADER_VIEW" />
	</changeSet>

	<changeSet id="ST#113_pre5" author="Gopal.p">
		<dropTable tableName="FILE_UPLOAD_HEADER_TEMP" />
	</changeSet>

	<changeSet id="ST#113_pre6" author="Gopal.p">
		<dropTable tableName="FILE_UPLOAD_HEADER" />
	</changeSet>

	<changeSet id="ST#113_pre7" author="Gopal.p">
		<dropTable tableName="REPRESENT_UPLOADS" />
	</changeSet>

	<changeSet id="ST#113.1" author="Gopal.p">
		<createTable tableName="FILE_UPLOAD_HEADER">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="EntityCode" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="Type" type="varchar(50)">
				<constraints nullable="false" />
			</column>
			<column name="FileName" type="varchar(100)">
				<constraints nullable="false" />
			</column>
			<column name="ExecutionID" type="bigint" />
			<column name="TotalRecords" type="int" />
			<column name="SuccessRecords" type="int" />
			<column name="FailureRecords" type="int" />
			<column name="Progress" type="int" />
			<column name="Remarks" type="varchar(2000)" />
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="ST#113.2" author="Gopal.p">
		<addPrimaryKey tableName="FILE_UPLOAD_HEADER" columnNames="Id" />
	</changeSet>

	<changeSet id="ST#113.3" author="Gireesh.G">
		<createTable tableName="REPRESENT_UPLOADS">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="HeaderId" type="bigint" />
			<column name="FinID" type="bigint" />
			<column name="FinReference" type="varchar(20)" />
			<column name="PresentmentID" type="bigint" />
			<column name="DueDate" type="datetime" />
			<column name="Progress" type="int" />
			<column name="Status" type="char(1)" />
			<column name="ErrorCode" type="varchar(20)" />
			<column name="ErrorDesc" type="varchar(2000)" />
		</createTable>
	</changeSet>

	<changeSet id="ST#113.4" author="Gireesh.G">
		<addPrimaryKey tableName="REPRESENT_UPLOADS" columnNames="Id" />
	</changeSet>

	<changeSet id="ST#113.5" author="Gopal.p">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='RE_PRESENTMENT_UPLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='RE_PRESENTMENT_UPLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='RE_PRESENTMENT_UPLOAD';
 				
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_UPLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_UPLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_UPLOAD';

				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'RE_PRESENTMENT_UPLOAD', 'Representment Upload File.', 12, 'Representment', null, null, ',', 0, 1, null, 'ROW:{LOAN_NO, DUE_DATE}', null, 'C', '/opt/pff/hdfc/representment/upload', 'Representment_', '.xls', 0, CURRENT_TIMESTAMP, '${ddmm},.${SEQ_DATE_FILE}', null, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_UPLOAD'), 'REPRESENT_UPLOADS', 1, 'HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 2, 0, 0);

				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_UPLOAD')), 'HEADERID',     0, 'N', NULL, NULL, '${HEADER_ID}', NULL, '0', NULL, NULL, NULL, NULL, 'M');								
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_UPLOAD')), 'FINREFERENCE',  0, 'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_UPLOAD')), 'DUEDATE',       0, 'N', NULL, NULL, NULL, NULL, '1', NULL, NULL, NULL, 'dd-MMM-yyyy', 'M');
 			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#113.6" author="gopal.p">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='RE_PRESENTMENT_TEMPLATE');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='RE_PRESENTMENT_TEMPLATE');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='RE_PRESENTMENT_TEMPLATE';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_TEMPLATE'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_TEMPLATE');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_TEMPLATE';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'RE_PRESENTMENT_TEMPLATE', 'Representement template download', 3, 'Representment', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{LOAN_NO, DUE_DATE}',  '', 'A', '/opt/pff/hdfc/representment/template', 'Representment_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_TEMPLATE'), 'REPRESENT_UPLOADS',  0, 'ID', 'HEADERID = 0', NULL, NULL, NULL, NULL, NULL, NULL, 2, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_TEMPLATE')), 'FINREFERENCE',  0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_TEMPLATE')), 'DUEDATE',	   0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, 'dd-MMM-yyyy', 'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#113.7" author="gopal.p">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='RE_PRESENTMENT_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='RE_PRESENTMENT_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='RE_PRESENTMENT_DOWNLOAD';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'RE_PRESENTMENT_DOWNLOAD', 'Representement download', 3, 'Representment', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{Loan No,Due Date,Presentment ID,Upload Date,Status,Error Code,ErrorDesc,Created By,Approved By}',  '', 'A', '/opt/pff/hdfc/representment/download', 'Representment_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD'), 'REPRESENT_UPLOADS',  0, 'ID', 'HEADERID = :HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, 9, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD')), 'FINREFERENCE',    0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD')), 'DUEDATE',	     0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, 'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD')), 'PRESENTMENTID',	 0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD')), 'CREATEDON',	     0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, 'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD')), 'STATUS',	         0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD')), 'ERRORCODE',	     0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD')), 'ERRORDESC',	     0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD')), 'CREATEDBY',	     0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'REPRESENT_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'RE_PRESENTMENT_DOWNLOAD')), 'APPROVEDBY',	     0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#707.1" author="HariTeja.B">
		<createTable tableName="MANDATES_UPLOAD">
			<column name="Id" type="bigint" autoIncrement="true" >
				<constraints nullable="false" />
			</column>
			<column name="HeaderID" type="bigint" />
			<column name="MandateID" type="bigint" />
			<column name="CustID" type="bigint" />
			<column name="CustCIF" type="varchar(20)" />
			<column name="MandateRef" type="varchar(50)" />
			<column name="MandateType" type="varchar(20)" />
			<column name="BankBranchID" type="bigint" />
			<column name="AccNumber" type="varchar(50)" />
			<column name="AccHolderName" type="varchar(100)" />
			<column name="JointAccHolderName" type="varchar(100)" />
			<column name="AccType" type="varchar(20)" />
			<column name="OpenMandate" type="boolean" />
			<column name="StartDate" type="datetime" />
			<column name="ExpiryDate" type="datetime" />
			<column name="MaxLimit" type="decimal(18,0)" />
			<column name="Periodicity" type="varchar(20)" />
			<column name="PhoneCountryCode" type="varchar(5)" />
			<column name="PhoneAreaCode" type="varchar(8)" />
			<column name="PhoneNumber" type="varchar(12)" />
			<column name="MandateStatus" type="varchar(20)" />
			<column name="ApprovalID" type="varchar(50)" />
			<column name="InputDate" type="datetime" />
			<column name="Active" type="boolean" />
			<column name="Reason" type="varchar(500)" />
			<column name="MandateCcy" type="varchar(10)" />
			<column name="OrgReference" type="varchar(25)" />
			<column name="ExternalRef" type="varchar(2000)" />
			<column name="DocumentName" type="varchar(200)" />
			<column name="DocumentRef" type="bigint" />
			<column name="BarCodeNumber" type="varchar(10)" />
			<column name="SwapIsActive" type="boolean" />
			<column name="PrimaryMandateID" type="bigint" />
			<column name="EntityCode" type="varchar(8)" />
			<column name="PartnerBankID" type="bigint" />
			<column name="DefaultMandate" type="boolean" />
			<column name="EmandateSource" type="varchar(50)" />
			<column name="EmandateReferenceNo" type="varchar(50)" />
			<column name="SwapEffectiveDate" type="datetime" />
			<column name="HoldReason" type="varchar(50)" />
			<column name="SecurityMandate" type="boolean" />
			<column name="EmployerID" type="bigint" />
			<column name="EmployeeNo" type="varchar(50)" />
			<column name="Ifsc" type="varchar(40)" />
			<column name="Micr" type="bigint" />
			<column name="ExternalMandate" type="boolean" />
			<column name="Progress" type="int" />
			<column name="Status" type="char(1)" />
			<column name="ErrorCode" type="varchar(20)" />
			<column name="ErrorDesc" type="varchar(2000)" />
		</createTable>
	</changeSet>

	<changeSet id="ST#707.2" author="HariTeja.B">
		<addPrimaryKey constraintName="PK_MANDATES_UPLOAD_ID" tableName="MANDATES_UPLOAD" columnNames="id" />
	</changeSet>

	<changeSet id="ST#707.3" author="HariTeja.B" dbms="postgresql, oracle">
		<addDefaultValue columnName="SwapIsActive" tableName="MANDATES_UPLOAD" defaultValue="0" />
		<addDefaultValue columnName="PartnerBankID" tableName="MANDATES_UPLOAD" defaultValue="0" />
		<addDefaultValue columnName="DefaultMandate" tableName="MANDATES_UPLOAD" defaultValue="0" />
		<addDefaultValue columnName="SecurityMandate" tableName="MANDATES_UPLOAD" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#707.3" author="HariTeja.B" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE MANDATES_UPLOAD ADD CONSTRAINT DF_MU_SWAPISACTIVE DEFAULT 0 FOR SWAPISACTIVE;
				ALTER TABLE MANDATES_UPLOAD ADD CONSTRAINT DF_MU_PARTNERBANKID DEFAULT 0 FOR PARTNERBANKID;
				ALTER TABLE MANDATES_UPLOAD ADD CONSTRAINT DF_MU_DEFAULTMANDATE DEFAULT 0 FOR DEFAULTMANDATE;
				ALTER TABLE MANDATES_UPLOAD ADD CONSTRAINT DF_MU_SECURITYMANDATE DEFAULT 0 FOR SECURITYMANDATE;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#707.4" author="HariTeja.B">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='MANDATES_UPLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='MANDATES_UPLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='MANDATES_UPLOAD';
 				
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD';

				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'MANDATES_UPLOAD', 'Mandates Upload File.', 12, 'MANDATE', null, null, ',', 1, 1, null, null, null, 'C', '/opt/pff/hdfc/mandate/upload', 'Mandate_', '.xls', 0, CURRENT_TIMESTAMP, '${ddmm},.${SEQ_DATE_FILE}', null, '0', NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD'), 'MANDATES_UPLOAD', 1, 'ID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 26, 0, 0);
								
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'ID',  					1, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'HEADERID',     		0, 'N', NULL, NULL, '${HEADER_ID}', NULL, '0', NULL, NULL, NULL, NULL, 'M');								
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'MANDATEID',      		1, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'CUSTCIF',       		0, 'N', NULL, NULL, NULL, NULL, '1',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'MANDATEREF',      		0, 'N', NULL, NULL, NULL, NULL, '16', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'MANDATETYPE',      	0, 'N', NULL, NULL, NULL, NULL, '3',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'BANKBRANCHID',    		1, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'ACCNUMBER',       		0, 'N', NULL, NULL, NULL, NULL, '6',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'ACCHOLDERNAME',    	0, 'N', NULL, NULL, NULL, NULL, '7',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'JOINTACCHOLDERNAME',   0, 'N', NULL, NULL, NULL, NULL, '8',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'ACCTYPE',      		0, 'N', NULL, NULL, NULL, NULL, '9',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'OPENMANDATE',       	0, 'N', NULL, NULL, NULL, NULL, '12', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'STARTDATE',      		0, 'N', NULL, NULL, NULL, NULL, '13', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'EXPIRYDATE',       	0, 'N', NULL, NULL, NULL, NULL, '14', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'MAXLIMIT',       		0, 'N', NULL, NULL, NULL, NULL, '10', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'PERIODICITY',       	0, 'N', NULL, NULL, NULL, NULL, '11', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'MANDATESTATUS',       	0, 'N', NULL, NULL, NULL, NULL, '24', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'REASON',       		0, 'N', NULL, NULL, NULL, NULL, '25', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'ORGREFERENCE',      	0, 'N', NULL, NULL, NULL, NULL, '2',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'SWAPISACTIVE',      	0, 'N', NULL, NULL, NULL, NULL, '18', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'ENTITYCODE',      		0, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'PARTNERBANKID',      	0, 'N', NULL, NULL, NULL, NULL, '15', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'EMANDATESOURCE',       0, 'N', NULL, NULL, NULL, NULL, '20', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'EMANDATEREFERENCENO',  0, 'N', NULL, NULL, NULL, NULL, '21', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'SWAPEFFECTIVEDATE',    0, 'N', NULL, NULL, NULL, NULL, '19', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'EMPLOYERID',      		0, 'N', NULL, NULL, NULL, NULL, '22', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'EMPLOYEENO',       	0, 'N', NULL, NULL, NULL, NULL, '23', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'IFSC',       			0, 'N', NULL, NULL, NULL, NULL, '5' , NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'MICR',       			0, 'N', NULL, NULL, NULL, NULL, '4' , NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_UPLOAD')), 'EXTERNALMANDATE',      0, 'N', NULL, NULL, NULL, NULL, '17', NULL, NULL, NULL, NULL, 'O');
 			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#707.5" author="HariTeja.B">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='MANDATES_TEMPLATE');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='MANDATES_TEMPLATE');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='MANDATES_TEMPLATE';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'MANDATES_TEMPLATE', 'Mandate template download', 3, 'MANDATE', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{Entity Code, Customer ID, Loan Reference, Mandate Type, MICR, IFSC Code, Account Number, Account Holder Name, Joint Account Holder Name, Account Type, Max Limit, Periodicity, Open Mandate, Start Date, Expiry Date, Partner Bank, UMRN number, External Mandate, Swap, Swap Effective Date,E-mandate Source, E-mandate Reference, EmployerID, Employee ID, Mandate Status, Rejection Reason}', NULL, 'A', '/opt/pff/hdfc/mandate/template', 'MANDATE_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE'), 'MANDATES_UPLOAD',  0, 'ID', 'HEADERID = :HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, 26, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'CUSTID',       			0, 'N', NULL, NULL, NULL, NULL, '1',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'MANDATEREF',      		0, 'N', NULL, NULL, NULL, NULL, '16', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'MANDATETYPE',      		0, 'N', NULL, NULL, NULL, NULL, '3',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'ACCNUMBER',       		0, 'N', NULL, NULL, NULL, NULL, '6',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'ACCHOLDERNAME',    		0, 'N', NULL, NULL, NULL, NULL, '7',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'JOINTACCHOLDERNAME',   	0, 'N', NULL, NULL, NULL, NULL, '8',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'ACCTYPE',      			0, 'N', NULL, NULL, NULL, NULL, '9',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'OPENMANDATE',       		0, 'N', NULL, NULL, NULL, NULL, '12', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'STARTDATE',      		0, 'N', NULL, NULL, NULL, NULL, '13', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'EXPIRYDATE',       		0, 'N', NULL, NULL, NULL, NULL, '14', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'MAXLIMIT',       		0, 'N', NULL, NULL, NULL, NULL, '10', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'PERIODICITY',       		0, 'N', NULL, NULL, NULL, NULL, '11', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'MANDATESTATUS',       	0, 'N', NULL, NULL, NULL, NULL, '24', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'REASON',       			0, 'N', NULL, NULL, NULL, NULL, '25', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'ORGREFERENCE',      		0, 'N', NULL, NULL, NULL, NULL, '2',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'SWAPISACTIVE',      		0, 'N', NULL, NULL, NULL, NULL, '18', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'ENTITYCODE',      		0, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'PARTNERBANKID',      	0, 'N', NULL, NULL, NULL, NULL, '15', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'EMANDATESOURCE',       	0, 'N', NULL, NULL, NULL, NULL, '20', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'EMANDATEREFERENCENO',  	0, 'N', NULL, NULL, NULL, NULL, '21', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'SWAPEFFECTIVEDATE',    	0, 'N', NULL, NULL, NULL, NULL, '19', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'EMPLOYERID',      		0, 'N', NULL, NULL, NULL, NULL, '22', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'EMPLOYEENO',       		0, 'N', NULL, NULL, NULL, NULL, '23', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'IFSC',       			0, 'N', NULL, NULL, NULL, NULL, '5' , NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'MICR',       			0, 'N', NULL, NULL, NULL, NULL, '4' , NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_TEMPLATE')), 'EXTERNALMANDATE',      	0, 'N', NULL, NULL, NULL, NULL, '17', NULL, NULL, NULL, NULL, 'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#707.6" author="HariTeja.B">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='MANDATES_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='MANDATES_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='MANDATES_DOWNLOAD';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'MANDATES_DOWNLOAD', 'Mandate download', 3, 'MANDATE', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{Entity Code, Customer ID, Loan Reference, Mandate Type, MICR, IFSC Code, Account Number, Account Holder Name, Joint Account Holder Name, Account Type, Max Limit, Periodicity, Open Mandate, Start Date, Expiry Date, Partner Bank, UMRN number, External Mandate, Swap, Swap Effective Date,E-mandate Source, E-mandate Reference, EmployerID, Employee ID, Mandate Status, Rejection Reason, UPLOADDATE, APPROVEDDATE, MAKER ID, CHECKERID, UPLOADSTATUS, ErrorCode, ErrorDesc}',  '', 'A', '/opt/pff/hdfc/mandate/download', 'Mandate_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD'), 'MANDATES_UPLOAD',  0, 'ID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 10, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'ENTITYCODE',      		0, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'CUSTCIF',       			0, 'N', NULL, NULL, NULL, NULL, '1',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'ORGREFERENCE',      		0, 'N', NULL, NULL, NULL, NULL, '2',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'MANDATETYPE',      		0, 'N', NULL, NULL, NULL, NULL, '3',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'MICR',       			0, 'N', NULL, NULL, NULL, NULL, '4' , NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'IFSC',       			0, 'N', NULL, NULL, NULL, NULL, '5' , NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'ACCNUMBER',       		0, 'N', NULL, NULL, NULL, NULL, '6',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'ACCHOLDERNAME',    		0, 'N', NULL, NULL, NULL, NULL, '7',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'JOINTACCHOLDERNAME',   	0, 'N', NULL, NULL, NULL, NULL, '8',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'ACCTYPE',      			0, 'N', NULL, NULL, NULL, NULL, '9',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'MAXLIMIT',       		0, 'N', NULL, NULL, NULL, NULL, '10', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'PERIODICITY',       		0, 'N', NULL, NULL, NULL, NULL, '11', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'OPENMANDATE',       		0, 'N', NULL, NULL, NULL, NULL, '12', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'STARTDATE',      		0, 'N', NULL, NULL, NULL, NULL, '13', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'EXPIRYDATE',       		0, 'N', NULL, NULL, NULL, NULL, '14', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'PARTNERBANKID',      	0, 'N', NULL, NULL, NULL, NULL, '15', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'MANDATEREF',      		0, 'N', NULL, NULL, NULL, NULL, '16', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'EXTERNALMANDATE',      	0, 'N', NULL, NULL, NULL, NULL, '17', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'SWAPISACTIVE',      		0, 'N', NULL, NULL, NULL, NULL, '18', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'SWAPEFFECTIVEDATE',    	0, 'N', NULL, NULL, NULL, NULL, '19', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'EMANDATESOURCE',       	0, 'N', NULL, NULL, NULL, NULL, '20', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'EMANDATEREFERENCENO',  	0, 'N', NULL, NULL, NULL, NULL, '21', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'EMPLOYERID',      		0, 'N', NULL, NULL, NULL, NULL, '22', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'EMPLOYEENO',       		0, 'N', NULL, NULL, NULL, NULL, '23', NULL, NULL, NULL, NULL, 'O');				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'MANDATESTATUS',       	0, 'N', NULL, NULL, NULL, NULL, '24', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'REASON',       			0, 'N', NULL, NULL, NULL, NULL, '25', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'CREATEDON',       		0, 'N', NULL, NULL, NULL, NULL, '26', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'APPROVEDON',     		0, 'N', NULL, NULL, NULL, NULL, '27', NULL, NULL, NULL,'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'CREATEDBY',    	 		0, 'N', NULL, NULL, NULL, NULL, '28', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'APPROVEDBY',	      		0, 'N', NULL, NULL, NULL, NULL, '29', NULL, NULL, NULL, NULL,'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'STATUS',	                0, 'N', NULL, NULL, NULL, NULL, '32', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'ERRORCODE',	            0, 'N', NULL, NULL, NULL, NULL, '33', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'MANDATES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'MANDATES_DOWNLOAD')), 'ERRORDESC',	            0, 'N', NULL, NULL, NULL, NULL, '34', NULL, NULL, NULL, NULL, 'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#707.7" author="HariTeja.B">
		<sql>
			<![CDATA[
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANDATE_UPLOAD_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANDATE_UPLOAD_APPROVER');

				DELETE FROM SECROLES WHERE ROLECD ='MANDATE_UPLOAD_MAKER';
				DELETE FROM SECROLES WHERE ROLECD ='MANDATE_UPLOAD_APPROVER';

				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANDATE_UPLOAD_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANDATE_UPLOAD_APPROVER');

				DELETE FROM SECGROUPS WHERE GRPCODE ='MANDATE_UPLOAD_MAKER';
				DELETE FROM SECGROUPS WHERE GRPCODE ='MANDATE_UPLOAD_APPROVER';

				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_MandateUpload_Maker';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_MandateUpload_Approver';

				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_MandateUpload_Maker', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_MandateUpload_Approver', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'MANDATE_UPLOAD_MAKER', 'WF Maker for Mandate Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'MANDATE_UPLOAD_APPROVER', 'WF Approver for Mandate Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);

				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANDATE_UPLOAD_MAKER'),    (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_MandateUpload_Maker'), 1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANDATE_UPLOAD_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_MandateUpload_Approver'), 1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'MANDATE_UPLOAD_MAKER', 'Maker role from Mandate Upload', '', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0); 
				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'MANDATE_UPLOAD_APPROVER', 'Approver role from Mandate Upload',	'', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANDATE_UPLOAD_MAKER'),    (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'MANDATE_UPLOAD_MAKER'),    0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANDATE_UPLOAD_APPROVER'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'MANDATE_UPLOAD_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#711.1" author="bhaskara.k">
		<createTable tableName="PRESENTMENT_RESP_UPLOAD">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="Header_Id" type="bigint" />
			<column name="Presentment_Reference" type="varchar(50)" />
			<column name="FinReference" type="varchar(20)" />
			<column name="Host_Reference" type="varchar(20)" />
			<column name="Instalment_No" type="char(10)" />
			<column name="Amount_Cleared" type="varchar(14)" />
			<column name="Clearing_Date" type="datetime" />
			<column name="Clearing_Status" type="char(1)" />
			<column name="Bounce_Code" type="varchar(100)" />
			<column name="Bounce_Remarks" type="varchar(1000)" />
			<column name="Reason_Code" type="varchar(100)" />
			<column name="Bank_Code" type="varchar(8)" />
			<column name="Bank_Name" type="varchar(50)" />
			<column name="Branch_Code" type="varchar(8)" />
			<column name="Branch_Name" type="varchar(50)" />
			<column name="Partner_Bank_Code" type="varchar(50)" />
			<column name="Partner_Bank_Name" type="varchar(50)" />
			<column name="Bank_Address" type="varchar(50)" />
			<column name="Account_Number" type="varchar(50)" />
			<column name="Ifsc_Code" type="varchar(20)" />
			<column name="Umrn_No" type="varchar(20)" />
			<column name="Micr_Code" type="varchar(20)" />
			<column name="Cheque_Serial_No" type="varchar(20)" />
			<column name="Corporate_User_No" type="varchar(50)" />
			<column name="Corporate_User_Name" type="varchar(100)" />
			<column name="Dest_Acc_Holder" type="varchar(50)" />
			<column name="Debit_Credit_Flag" type="char(1)" />
			<column name="Process_Flag" type="bigint" />
			<column name="Thread_Id" type="bigint" />
			<column name="Utr_Number" type="varchar(50)" />
			<column name="FinId" type="bigint" />
			<column name="FateCorrection" type="CHAR(1)">
				<constraints nullable="false" />
			</column>
			<column name="Error_Code" type="varchar(10)" />
			<column name="Error_Description" type="varchar(2000)" />
			<column name="Progress" type="int" />
			<column name="Status" type="char(1)" />
		</createTable>
	</changeSet>

	<changeSet id="ST#5.33" author="bhaskara.k">
		<addColumn tableName="PRESENTMENT_RESP_UPLOAD">
			<column name="PresentmentId" type="bigint" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#711.2" author="bhaskara.k">
		<addPrimaryKey constraintName="PK_PRE_RESPONCE_UPLOAD_Id" tableName="PRESENTMENT_RESP_UPLOAD"
			columnNames="Id" />
	</changeSet>

	<changeSet id="ST#711.3" author="bhaskara.k" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE PRESENTMENT_RESP_UPLOAD ADD CONSTRAINT DF_PRU_INSTALMENT_NO DEFAULT 0 FOR INSTALMENT_NO;
				ALTER TABLE PRESENTMENT_RESP_UPLOAD ADD CONSTRAINT DF_PRU_PROCESS_FLAG DEFAULT 0 FOR PROCESS_FLAG;
				ALTER TABLE PRESENTMENT_RESP_UPLOAD ADD CONSTRAINT DF_PRU_THREAD_ID DEFAULT 0 FOR THREAD_ID;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#711.3" author="bhaskara.k" dbms="postgresql, oracle">
		<addDefaultValue columnName="Instalment_No" tableName="PRESENTMENT_RESP_UPLOAD" defaultValue="0" />
		<addDefaultValue columnName="Process_Flag" tableName="PRESENTMENT_RESP_UPLOAD" defaultValue="0" />
		<addDefaultValue columnName="Thread_Id" tableName="PRESENTMENT_RESP_UPLOAD" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#711.4" author="bhaskara.k">
		<sql>
			<![CDATA[	
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='FATE_CORRECTION_UPLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='FATE_CORRECTION_UPLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='FATE_CORRECTION_UPLOAD';
 				
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD';
				
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'FATE_CORRECTION_UPLOAD', 'FATE CORRECTION UPLOAD FILE.', 12, 'FATECORRECTION', null, null, ',', 1, 1, null, 'ROW:{FINREFERENCE, AMOUNT_CLEARED, CLEARING_DATE, UMRN_NO, CLEARING_STATUS, BOUNCE_CODE, BOUNCE_REMARKS}', null, 'C', '/opt/pff/hdfc/fatecorrection/upload', 'FateCorrection_', '.xls', 0, CURRENT_TIMESTAMP, '${ddmm},.${SEQ_DATE_FILE}', NULL, '0', NULL, 1, 1);
		
				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD'), 'PRESENTMENT_RESP_UPLOAD', 1, 'ID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 9, 0, 0);
						
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'HEADER_ID',					0, 'N', NULL, NULL, '${HEADER_ID}', NULL, '0', NULL, NULL, NULL, NULL, 			'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'FINREFERENCE',  			0, 'N', NULL, NULL, NULL,			NULL, '0', NULL, NULL, NULL, NULL, 			'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'AMOUNT_CLEARED',  			0, 'N', NULL, NULL, NULL, 			NULL, '1', NULL, NULL, NULL, NULL, 			'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'CLEARING_DATE',  			0, 'N', NULL, NULL, NULL, 			NULL, '2', NULL, NULL, NULL, 'dd-MMM-yyyy', 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'UMRN_NO',  					0, 'N', NULL, NULL, NULL,			NULL, '3', NULL, NULL, NULL, NULL, 			'O');						
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'FATECORRECTION',  			0, 'N', NULL, 'Y',  NULL, 			NULL, '0', NULL, NULL, NULL, NULL,			'O');	
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'CLEARING_STATUS',  			0, 'N', NULL, NULL, NULL,			NULL, '4', NULL, NULL, NULL, NULL, 			'M');						
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'BOUNCE_CODE',  				0, 'N', NULL, NULL, NULL, 			NULL, '5', NULL, NULL, NULL, NULL,			'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'BOUNCE_REMARKS',  			0, 'N', NULL, NULL, NULL,			NULL, '6', NULL, NULL, NULL, NULL, 			'O');
					
	 		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#711.5" author="bhaskara.k">
		<sql>
			<![CDATA[	
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='FATE_CORRECTION_TEMPLATE');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='FATE_CORRECTION_TEMPLATE');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='FATE_CORRECTION_TEMPLATE';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_TEMPLATE'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_TEMPLATE');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_TEMPLATE';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'FATE_CORRECTION_TEMPLATE', 'FATE CORRECTION TEMPLATE DOWNLOAD', 3, 'FATECORRECTION', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{FINREFERENCE, AMOUNT_CLEARED, CLEARING_DATE, UMRN_NO, CLEARING_STATUS, BOUNCE_CODE, BOUNCE_REMARKS}',  NULL, 'A', '/opt/pff/hdfc/fatecorrection/template', 'FateCorrection_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_TEMPLATE'), 'PRESENTMENT_RESP_UPLOAD',  1, 'ID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 7, 0, 0);
					
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_TEMPLATE')), 'FINREFERENCE',  			0, 'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_TEMPLATE')), 'AMOUNT_CLEARED',  		0, 'N', NULL, NULL, NULL, NULL, '1', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_TEMPLATE')), 'CLEARING_DATE',  			0, 'N', NULL, NULL, NULL, NULL, '2', NULL, NULL, NULL, 'dd-MMM-yyyy', 'M');			
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_TEMPLATE')), 'UMRN_NO',  				0, 'N', NULL, NULL, NULL, NULL, '3', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'CLEARING_STATUS',  			0, 'N', NULL, NULL, NULL, NULL, '4', NULL, NULL, NULL, NULL, 'M');						
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'BOUNCE_CODE',  				0, 'N', NULL, NULL, NULL, NULL, '5', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_UPLOAD')), 'BOUNCE_REMARKS',  			0, 'N', NULL, NULL, NULL, NULL, '6', NULL, NULL, NULL, NULL, 'O');
				
				
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#711.6" author="bhaskara.k">
		<sql>
			<![CDATA[	
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='FATE_CORRECTION_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='FATE_CORRECTION_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='FATE_CORRECTION_DOWNLOAD';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'FATE_CORRECTION_DOWNLOAD', 'FATE CORRECTION DOWNLOAD', 3, 'FATECORRECTION', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{FINREFERENCE, PRESENTMENT_REFERENCE, AMOUNT_CLEARED, CLEARING_DATE, CLEARING_STATUS, UMRN_NO, FATECORRECTION, STATUS, ERROR_CODE, ERROR_DESCRIPTION, CREATEDBY, APPROVEDBY}', NULL, 'A', '/opt/pff/hdfc/fatecorrection/download', 'FateCorrection_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD'), 'PRESENTMENT_RESP_UPLOAD',  1, 'ID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 12, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'FINREFERENCE',  			0, 'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'PRESENTMENT_REFERENCE',  	0, 'N', NULL, NULL, NULL, NULL, '1', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'AMOUNT_CLEARED',  		0, 'N', NULL, NULL, NULL, NULL, '2', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'CLEARING_DATE',  			0, 'N', NULL, NULL, NULL, NULL, '3', NULL, NULL, NULL, 'dd-MMM-yyyy', 'M');			
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'CLEARING_STATUS',  		0, 'N', NULL, NULL, NULL, NULL, '4', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'UMRN_NO',  				0, 'N', NULL, NULL, NULL, NULL, '5', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'FATECORRECTION',  		0, 'N', NULL, NULL, NULL, NULL, '6', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'STATUS',	                0, 'N', NULL, NULL, NULL, NULL, '7', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'ERROR_CODE',	            0, 'N', NULL, NULL, NULL, NULL, '8', NULL, NULL, NULL, NULL, 'O');		
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'ERROR_DESCRIPTION',	    0, 'N', NULL, NULL, NULL, NULL, '9', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'CREATEDBY',	     		0, 'N', NULL, NULL, NULL, NULL, '10', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PRESENTMENT_RESP_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'FATE_CORRECTION_DOWNLOAD')), 'APPROVEDBY',	     		0, 'N', NULL, NULL, NULL, NULL, '11', NULL, NULL, NULL, NULL, 'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#711.7" author="bhaskara.k">
		<sql>
			<![CDATA[
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FATE_CORRECTION_UPLOAD_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FATE_CORRECTION_UPLOAD_APPROVER');

				DELETE FROM SECROLES WHERE ROLECD ='FATE_CORRECTION_UPLOAD_MAKER';
				DELETE FROM SECROLES WHERE ROLECD ='FATE_CORRECTION_UPLOAD_APPROVER';

				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FATE_CORRECTION_UPLOAD_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FATE_CORRECTION_UPLOAD_APPROVER');

				DELETE FROM SECGROUPS WHERE GRPCODE ='FATE_CORRECTION_UPLOAD_MAKER';
				DELETE FROM SECGROUPS WHERE GRPCODE ='FATE_CORRECTION_UPLOAD_APPROVER';

				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_FateCorrectionUpload_Maker';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_FateCorrectionUpload_Approver';

				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_FateCorrectionUpload_Maker', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_FateCorrectionUpload_Approver', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'FATE_CORRECTION_UPLOAD_MAKER', 'WF Maker for FateCorrection Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'FATE_CORRECTION_UPLOAD_APPROVER', 'WF Approver for FateCorrection Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);

				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FATE_CORRECTION_UPLOAD_MAKER'),    (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_FateCorrectionUpload_Maker'),    1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FATE_CORRECTION_UPLOAD_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_FateCorrectionUpload_Approver'), 1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'FATE_CORRECTION_UPLOAD_MAKER', 'Maker role from FateCorrection Upload', '', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0); 
				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'FATE_CORRECTION_UPLOAD_APPROVER', 'Approver role from FateCorrection Upload',	'', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FATE_CORRECTION_UPLOAD_MAKER'),    (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'FATE_CORRECTION_UPLOAD_MAKER'),    0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FATE_CORRECTION_UPLOAD_APPROVER'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'FATE_CORRECTION_UPLOAD_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#708.01" author="sainaveen.y">
		<createTable tableName="CHEQUES_UPLOAD">
			<column name="ID" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="HeaderId" type="bigint" />
			<column name="ChequeDetailsId" type="bigint" />
			<column name="ChequeHeaderId" type="bigint" />
			<column name="BankBranchId" type="bigint" />
			<column name="FinReference" type="varchar(20)" />
			<column name="FinID" type="bigint" />
			<column name="AccountNo" type="varchar(50)" />
			<column name="ChequeSerialNo" type="int" />
			<column name="ChequeDate" type="datetime" />
			<column name="EmiRefNo" type="int" />
			<column name="Amount" type="bigint" />
			<column name="ChequeCcy" type="varchar(3)" />
			<column name="Active" type="varchar(40)" />
			<column name="version" type="int" />
			<column name="lastmntby" type="bigint" />
			<column name="lastmnton" type="datetime" />
			<column name="recordstatus" type="varchar(50)" />
			<column name="rolecode" type="varchar(100)" />
			<column name="nextrolecode" type="varchar(200)" />
			<column name="taskid" type="varchar(50)" />
			<column name="nexttaskid" type="varchar(200)" />
			<column name="recordtype" type="varchar(50)" />
			<column name="workflowid" type="bigint" />
			<column name="DocumentName" type="varchar(200)" />
			<column name="DocumentRef" type="bigint" />
			<column name="ChequeType" type="varchar(8)" />
			<column name="ChequeStatus" type="varchar(10)" />
			<column name="AccountType" type="varchar(20)" />
			<column name="AccHolderName" type="varchar(200)" />
			<column name="Action" type="varchar(10)" />
			<column name="IfscCode" type="varchar(20)" />
			<column name="Micr" type="varchar(20)" />
			<column name="Progress" type="int" />
			<column name="Status" type="char(1)" />
			<column name="ErrorCode" type="varchar(20)" />
			<column name="ErrorDesc" type="varchar(2000)" />
		</createTable>
	</changeSet>

	<changeSet id="ST#708.2" author="sainaveen.y">
		<addPrimaryKey constraintName="PK_CU_ID" tableName="CHEQUES_UPLOAD" columnNames="ID" />
	</changeSet>

	<changeSet id="ST#708.3" author="sainaveen.y" dbms="postgresql,oracle">
		<addDefaultValue columnName="ChequeStatus" tableName="CHEQUES_UPLOAD" defaultValue="NEW" />
		<addDefaultValue columnName="Version" tableName="CHEQUES_UPLOAD" defaultValue="0" />
	</changeSet>
	
	<changeSet id="ST#708.3" author="bhaskara.k" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE CHEQUES_UPLOAD ADD CONSTRAINT DF_CU_CHEQUESTATUS DEFAULT 'NEW' FOR ChequeStatus;
				ALTER TABLE CHEQUES_UPLOAD ADD CONSTRAINT DF_CU_VERSION 	 DEFAULT 0 FOR Version;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#708.11" author="sainaveen.y">
		<sql>
			<![CDATA[
		        DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='CHEQUE_UPLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='CHEQUE_UPLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='CHEQUE_UPLOAD';
 				
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD';
				
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'CHEQUE_UPLOAD', 'Cheque Upload File.', 12, 'Cheque', null, null, ',', 0, 1, null, 'ROW:{Action,Type Of Cheque,Loan Reference,Cheque No,Account Type,Account Holder Name,Account Number,IFSC Code,MICR,Amount,ChequeDate}', null, 'C', '/opt/pff/hdfc/cheque/upload', 'Cheque_', '.xls', 0, CURRENT_TIMESTAMP, '${ddmm},.${SEQ_DATE_FILE}', null, '0', NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD'), 'CHEQUES_UPLOAD', 1, 'ID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 11, 0, 0);
		       
		        INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'HEADERID',     0, 'N', NULL, NULL, '${HEADER_ID}', NULL, '0',  NULL, NULL, NULL, NULL, 'M');
		        INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'ACTION',                0, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'M');
		        INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'CHEQUETYPE',            0, 'N', NULL, NULL, NULL, NULL, '1',  NULL, NULL, NULL, NULL, 'M');
		        INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'FINREFERENCE',          0, 'N', NULL, NULL, NULL, NULL, '2',  NULL, NULL, NULL, NULL, 'M');
		        INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'CHEQUESERIALNO',        0, 'N', NULL, NULL, NULL, NULL, '3',  NULL, NULL, NULL, NULL, 'M');
		        INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'ACCOUNTTYPE',           0, 'N', NULL, NULL, NULL, NULL, '4',  NULL, NULL, NULL, NULL, 'O');
		        INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'ACCHOLDERNAME',         0, 'N', NULL, NULL, NULL, NULL, '5',  NULL, NULL, NULL, NULL, 'M');
		        INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'ACCOUNTNO',             0, 'N', NULL, NULL, NULL, NULL, '6',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'IFSCCODE',              0, 'N', NULL, NULL, NULL, NULL, '7',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'MICR',                  0, 'N', NULL, NULL, NULL, NULL, '8',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'AMOUNT',                0, 'N', NULL, NULL, NULL, NULL, '9',  NULL, NULL, NULL, NULL, 'O');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_UPLOAD')),  'CHEQUEDATE',            0, 'N', NULL, NULL, NULL, NULL, '10',  NULL, NULL, NULL, 'dd-MMM-yyyy', 'O');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#708.12" author="sainaveen.y">
		<sql>
			<![CDATA[
	            DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='CHEQUE_TEMPLATE');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='CHEQUE_TEMPLATE');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='CHEQUE_TEMPLATE';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'CHEQUE_TEMPLATE', 'Cheque template download', 3, 'Cheque', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{Action,Type Of Cheque,Loan Reference,Cheque No,Account Type,Account Holder Name,Account Number,IFSC Code,MICR,Amount,ChequeDate}',  '', 'A', '/opt/pff/hdfc/cheque/template', 'Cheque_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE'), 'CHEQUES_UPLOAD',  0, 'ID', 'HEADERID = 0', NULL, NULL, NULL, NULL, NULL, NULL, 11, 0, 0);
                	
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'ACTION',            0, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'CHEQUETYPE',        0, 'N', NULL, NULL, NULL, NULL, '1',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'FINREFERENCE',      0, 'N', NULL, NULL, NULL, NULL, '2',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'CHEQUESERIALNO',    0, 'N', NULL, NULL, NULL, NULL, '3',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'ACCOUNTTYPE',       0, 'N', NULL, NULL, NULL, NULL, '4',  NULL, NULL, NULL, NULL, 'O');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'ACCHOLDERNAME',     0, 'N', NULL, NULL, NULL, NULL, '5',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'ACCOUNTNO',         0, 'N', NULL, NULL, NULL, NULL, '6',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'IFSCCODE',          0, 'N', NULL, NULL, NULL, NULL, '7',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'MICR',              0, 'N', NULL, NULL, NULL, NULL, '8',  NULL, NULL, NULL, NULL, 'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'AMOUNT',            0, 'N', NULL, NULL, NULL, NULL, '9',  NULL, NULL, NULL, NULL, 'O');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_TEMPLATE')),  'CHEQUEDATE',            0, 'N', NULL, NULL, NULL, NULL, '10',  NULL, NULL, NULL, 'dd-MMM-yyyy', 'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#708.13" author="sainaveen.y">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='CHEQUE_DOWNLOAD');
				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='CHEQUE_DOWNLOAD');
				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='CHEQUE_DOWNLOAD';
						
			  	DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD'));
			  	DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD');
			  	DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD';
						
			  	INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'CHEQUE_DOWNLOAD', ' cheques download', 3, 'Cheque', NULL, NULL, ',' , 0, 1, NULL, 'ROW:{ACTION,CHEQUETYPE,LOANREFERENCE,CHEQUESERIALNO,ACCOUNTTYPE,ACCHOLDERNAME,ACCOUNTNO,IFSCCODE,MICR,AMOUNT,UPLOADID,CHEQUEDETAILSID,APPROVEDON,CREATEDON,STATUS,ERRORCODE,ERRORDESC,CREATEDBY,APPROVEDBY,CHEQUEDATE}',  '', 'A', '/opt/pff/hdfc/pdc/download', 'Cheque_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);
			
			  	INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD'), 'CHEQUES_UPLOAD',  0, 'ID', 'HEADERID = :HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, 20, 0, 0);
			 
			    INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'ACTION',                      0, 'N', NULL, NULL, NULL, NULL, '0',   NULL, NULL, NULL,   NULL,         'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'CHEQUETYPE',                  0, 'N', NULL, NULL, NULL, NULL, '1',   NULL, NULL, NULL,   NULL,         'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'FINREFERENCE',                0, 'N', NULL, NULL, NULL, NULL, '2',   NULL, NULL, NULL,   NULL,         'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'CHEQUESERIALNO',              0, 'N', NULL, NULL, NULL, NULL, '3',   NULL, NULL, NULL,   NULL,         'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'ACCOUNTTYPE',                 0, 'N', NULL, NULL, NULL, NULL, '4',   NULL, NULL, NULL,   NULL,         'O');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'ACCHOLDERNAME',               0, 'N', NULL, NULL, NULL, NULL, '5',   NULL, NULL, NULL,   NULL,         'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'ACCOUNTNO',                   0, 'N', NULL, NULL, NULL, NULL, '6',   NULL, NULL, NULL,   NULL,         'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'IFSCCODE',                    0, 'N', NULL, NULL, NULL, NULL, '7',   NULL, NULL, NULL,   NULL,         'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'MICR',                        0, 'N', NULL, NULL, NULL, NULL, '8',   NULL, NULL, NULL,   NULL,         'M');
                INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'AMOUNT',                      0, 'N', NULL, NULL, NULL, NULL, '9',   NULL, NULL, NULL,   NULL,         'O');
			    INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'ID',	                       0, 'N', NULL, NULL, NULL, NULL, '10',  NULL, NULL, NULL,   NULL,         'O');
			    INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'CHEQUEDETAILSID',	           0, 'N', NULL, NULL, NULL, NULL, '11',  NULL, NULL, NULL,   NULL,         'O');
			    INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'APPROVEDON',	               0, 'N', NULL, NULL, NULL, NULL, '12',  NULL, NULL, NULL,  'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'CREATEDON',	               0, 'N', NULL, NULL, NULL, NULL, '13',  NULL, NULL, NULL,  'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'STATUS',	                   0, 'N', NULL, NULL, NULL, NULL, '14',  NULL, NULL, NULL,   NULL,         'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'ERRORCODE',	               0, 'N', NULL, NULL, NULL, NULL, '15',  NULL, NULL, NULL,   NULL,         'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'ERRORDESC',	               0, 'N', NULL, NULL, NULL, NULL, '16',  NULL, NULL, NULL,   NULL,         'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'CREATEDBY',	               0, 'N', NULL, NULL, NULL, NULL, '17',  NULL, NULL, NULL,   NULL,         'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'APPROVEDBY',	               0, 'N', NULL, NULL, NULL, NULL, '18',  NULL, NULL, NULL,   NULL,         'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'CHEQUES_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'CHEQUE_DOWNLOAD')),  'CHEQUEDATE',	               0, 'N', NULL, NULL, NULL, NULL, '19',  NULL, NULL, NULL,   'dd-MMM-yyyy',         'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#708.7" author="sainaveen.y">
		<sql>
			<![CDATA[
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'CHEQUE_UPLOAD_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'CHEQUE_UPLOAD_APPROVER');

				DELETE FROM SECROLES WHERE ROLECD = 'CHEQUE_UPLOAD_MAKER';
				DELETE FROM SECROLES WHERE ROLECD = 'CHEQUE_UPLOAD_APPROVER';

				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'CHEQUE_UPLOAD_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'CHEQUE_UPLOAD_APPROVER');

				DELETE FROM SECGROUPS WHERE GRPCODE ='CHEQUE_UPLOAD_MAKER';
				DELETE FROM SECGROUPS WHERE GRPCODE ='CHEQUE_UPLOAD_APPROVER';

				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_ChequeUpload_Maker';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_ChequeUpload_Approver';

				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_ChequeUpload_Maker', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_ChequeUpload_Approver', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'CHEQUE_UPLOAD_MAKER', 'WF Maker for Cheque Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'CHEQUE_UPLOAD_APPROVER', 'WF Approver for Cheque Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);

				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'CHEQUE_UPLOAD_MAKER'),    (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_ChequeUpload_Maker'),    1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'CHEQUE_UPLOAD_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_ChequeUpload_Approver'), 1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'CHEQUE_UPLOAD_MAKER', 'Maker role from Cheque Upload', '', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0); 
				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'CHEQUE_UPLOAD_APPROVER', 'Approver role from Cheque Upload',	'', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'CHEQUE_UPLOAD_MAKER'),    (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'CHEQUE_UPLOAD_MAKER'),    0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'CHEQUE_UPLOAD_APPROVER'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'CHEQUE_UPLOAD_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#2649.1" author="Mounika.M">
		<addColumn tableName="FinExcessAmount">
			<column name="ReceiptId" type="bigint" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#2649.2" author="Mounika.M">
		<addColumn tableName="FinExcessAmount">
			<column name="PostDate" type="datetime" />
		</addColumn>
	</changeSet>

	<changeSet id="ST#2649.3" author="Mounika.M">
		<addColumn tableName="FinExcessAmount">
			<column name="ValueDate" type="datetime" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2644_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finexcessamount_lovview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2644" author="saikiran.n">
		<createView viewName="FINEXCESSAMOUNT_LOVVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT EXCESSID
					, FINID
					, FINREFERENCE
					, AMOUNTTYPE
					, cast(round(AMOUNT / 100,2) as numeric(36,2)) AMOUNT
					, cast(round(UTILISEDAMT / 100,2) as numeric(36,2)) UTILISEDAMT
					, cast(round(RESERVEDAMT / 100,2) as numeric(36,2)) RESERVEDAMT
					, cast(round(BALANCEAMT / 100,2) as numeric(36,2)) BALANCEAMT
					, RECEIPTID
					, VALUEDATE
				FROM FINEXCESSAMOUNT
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2644__post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finexcessamount_lovview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rbfielddetails');
			]]>
		</sql>
	</changeSet>

	<changeSet id="1.1_pre" author="Gopal.p" dbms="oracle">
		<sql>
			<![CDATA[
				DROP INDEX IX_RBFLDDET_MOD_EVNT_FLDNAME;
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="1_pre" author="Gopal.p" dbms="mssql">
    	<dropPrimaryKey constraintName="PK_RBFieldDetails" tableName="RBFIELDDETAILS"/>
	</changeSet>

	<changeSet id="1" author="Gopal.p">
		<modifyDataType tableName="RBFIELDDETAILS" columnName="RBMODULE" newDataType="varchar(20)" />
		<modifyDataType tableName="RBFIELDDETAILS" columnName="RBEVENT" newDataType="varchar(20)" />
	</changeSet>
	
	<changeSet id="1.0_post" author="Gopal.p" dbms="mssql">
		<addNotNullConstraint tableName="RBFIELDDETAILS" columnName="RBModule" columnDataType="varchar(20)" />
		<addNotNullConstraint tableName="RBFIELDDETAILS" columnName="RBEvent" columnDataType="varchar(20)" />
		<addNotNullConstraint tableName="RBFIELDDETAILS" columnName="RBFldName" columnDataType="varchar(50)" />
	</changeSet>
	
	<changeSet id="1.1_post" author="Gopal.p" dbms="mssql">
    	<addPrimaryKey columnNames="RBModule, RBEvent, RBFldName" constraintName="PK_RBFieldDetails" tableName="RBFIELDDETAILS"/>
	</changeSet>

	<changeSet id="1_post" author="Gopal.p" dbms="oracle">
		<sql>
			<![CDATA[
				CREATE INDEX IX_RBFLDDET_MOD_EVNT_FLDNAME ON RBFIELDDETAILS (NLSSORT("RBMODULE",'nls_sort=''BINARY_CI'''), NLSSORT("RBEVENT",'nls_sort=''BINARY_CI'''), NLSSORT("RBFLDNAME",'nls_sort=''BINARY_CI'''));
			]]>
		</sql>
	</changeSet>

	<changeSet id="1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rbfielddetails');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.10.1" author="AnilKumar.G">
		<sql>
            <![CDATA[
              	DELETE FROM RBFIELDDETAILS WHERE  RBMODULE= 'FEE_AUTO_REFUND' and RBEVENT = 'FEE_AUTO_REFUND';
              	
              	INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'CustCtgCode',     'Customer Category',                'nvarchar', 12, '0', '1', NULL, 'static', NULL);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'CustTypeCode',    'Customer Type',                    'nvarchar', 12, '0', '1', NULL, 'static', NULL);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'FinDivision',     'Loan Division',                    'nvarchar', 12, '0', '1', NULL, 'static', NULL);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'FinType',         'Loan Type',                        'nvarchar', 12, '0', '1', NULL, 'static', NULL);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'NumberOfTerms',   'Number of Terms in the Schedule.', 'int',       8, '0', '1', NULL, 'static', NULL);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'Finstatus',       'Loan Status',                      'nvarchar',  8, '0', '1', NULL, 'static', NULL);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'NoofFutureTerms', 'No of Future Installments',        'int',       8, '0', '1', NULL, 'static', NULL);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'finProduct',      'Product',                          'nvarchar',  8, '0', '1', NULL, 'static', NULL);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'FutInstAmt',      'Future Installment Amount',        'decimal',  18, '0', '1', NULL, 'static', NULL);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'Fin_ODDays',      'Overdue Days',                     'int',      12, '0', '1', null, 'static', null);
				INSERT INTO RBFIELDDETAILS (RBMODULE, RBEVENT, RBFLDNAME, RBFLDDESC, RBFLDTYPE, RBFLDLEN, RBFORCALFLDS, RBFORBLDFLDS, RBFLDTABLENAME, RBSTFLDS, MODULECODE) VALUES ('FEE_AUTO_REFUND', 'FEE_AUTO_REFUND', 'Fin_CurODamt',    'Current Overdue Amount',           'decimal',  18, '0', '1', NULL, 'static', NULL);
            ]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.51" author="Anilkumar.G">
		<addColumn tableName="FEETYPES">
			<column name="AllowAutoRefund" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.51.1_post" author="Anilkumar.G">
		<sql>
			<![CDATA[  
				UPDATE FEETYPES SET ALLOWAUTOREFUND = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.51_post" author="Anilkumar.G" dbms="postgresql, oracle">
		<addDefaultValue columnName="AllowAutoRefund" tableName="FEETYPES" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2509.51_post" author="Anilkumar.G" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FEETYPES ADD CONSTRAINT DF_FET_ALWAUTOREF DEFAULT 0 FOR ALLOWAUTOREFUND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.61" author="Anilkumar.G">
		<addColumn tableName="FEETYPES_TEMP">
			<column name="AllowAutoRefund" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.61.1_post" author="Anilkumar.G">
		<sql>
			<![CDATA[  
				UPDATE FEETYPES_TEMP SET ALLOWAUTOREFUND = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.61_post" author="Anilkumar.G" dbms="postgresql, oracle">
		<addDefaultValue columnName="AllowAutoRefund" tableName="FEETYPES_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2509.61_post" author="Anilkumar.G" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FEETYPES_TEMP ADD CONSTRAINT DF_FETT_ALWAUTOREF DEFAULT 0 FOR ALLOWAUTOREFUND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.71" author="Anilkumar.G">
		<sql>
		    <![CDATA[
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS),0, 'menuItem_RulesFactory_AutoRefundRule', 'MENU', 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'AUTO_REFUND_RULE_VIEW', 'Auto Refund menu group', 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		   		INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'AUTO_REFUND_RULE_VIEW', 'Auto Refund menu role',	'', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		   
		   		INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'AUTO_REFUND_RULE_VIEW'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_RulesFactory_AutoRefundRule'), 1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		    	INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'AUTO_REFUND_RULE_VIEW'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'AUTO_REFUND_RULE_VIEW'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		     ]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.8_pre" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'feetypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.8" author="AnilKumar.G">
		<createView replaceIfExists="true" viewName="FEETYPES_VIEW">
			<![CDATA[
			   SELECT T1.FEETYPEID
					, T1.FEETYPECODE
					, T1.FEETYPEDESC
					, T1.MANUALADVICE
					, T1.REFUNDABLE
					, T1.ADVISETYPE
					, T1.ACCOUNTSETID
					, T1.HOSTFEETYPECODE
					, T1.TAXAPPLICABLE
					, T1.TAXCOMPONENT
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T2.ACCOUNTSETCODE
					, T2.ACCOUNTSETCODENAME
					, T1.AMORTZREQ
					, T1.DUEACCREQ
					, T1.DUEACCSET
					, T3.ACCOUNTSETCODE DUEACCTSETCODE
					, T3.ACCOUNTSETCODENAME DUEACCTSETCODENAME
					, T1.TDSREQ
					, T1.INCOMEOREXPENSEACTYPE
					, T1.WAIVERORREFUNDACTYPE 
					, T1.ACTYPE 
					, T4.ACTYPEDESC
					, T1.PAYABLELINKTO
					, T1.RECVFEETYPEID
					, T5.FEETYPEDESC RECVFEETYPEDESC
					, T5.FEETYPECODE RECVFEETYPECODE
					, T1.ALLOWAUTOREFUND
				FROM FEETYPES_TEMP T1
				LEFT JOIN RMTACCOUNTINGSET T2 ON T2.ACCOUNTSETID = T1.ACCOUNTSETID
				LEFT JOIN RMTACCOUNTINGSET T3 ON T3.ACCOUNTSETID = T1.DUEACCSET
				LEFT JOIN RMTACCOUNTTYPES T4 ON T4.ACTYPE = T1.ACTYPE
				LEFT JOIN FEETYPES T5 ON T5.FEETYPEID = T1.RECVFEETYPEID
				UNION ALL
				SELECT T1.FEETYPEID
					, T1.FEETYPECODE
					, T1.FEETYPEDESC
					, T1.MANUALADVICE
					, T1.REFUNDABLE
					, T1.ADVISETYPE
					, T1.ACCOUNTSETID
					, T1.HOSTFEETYPECODE
					, T1.TAXAPPLICABLE
					, T1.TAXCOMPONENT
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T2.ACCOUNTSETCODE
					, T2.ACCOUNTSETCODENAME
					, T1.AMORTZREQ
					, T1.DUEACCREQ
					, T1.DUEACCSET
					, T3.ACCOUNTSETCODE DUEACCTSETCODE
					, T3.ACCOUNTSETCODENAME DUEACCTSETCODENAME
					, T1.TDSREQ
					, T1.INCOMEOREXPENSEACTYPE
					, T1.WAIVERORREFUNDACTYPE
					, T1.ACTYPE 
					, T4.ACTYPEDESC
					, T1.PAYABLELINKTO
					, T1.RECVFEETYPEID
					, T5.FEETYPEDESC RECVFEETYPEDESC
					, T5.FEETYPECODE RECVFEETYPECOD
					, T1.ALLOWAUTOREFUND
				FROM FEETYPES T1
				LEFT JOIN RMTACCOUNTINGSET T2 ON T2.ACCOUNTSETID = T1.ACCOUNTSETID
				LEFT JOIN RMTACCOUNTINGSET T3 ON T3.ACCOUNTSETID = T1.DUEACCSET
				LEFT JOIN RMTACCOUNTTYPES T4 ON T4.ACTYPE = T1.ACTYPE
				LEFT JOIN FEETYPES T5 ON T5.FEETYPEID = T1.RECVFEETYPEID
				WHERE NOT EXISTS (SELECT 1 FROM FEETYPES_TEMP WHERE FEETYPEID = T1.FEETYPEID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2509.8_post" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'feetypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.9_pre" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'feetypes_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.9" author="AnilKumar.G">
		<createView replaceIfExists="true" viewName="FEETYPES_AVIEW">
			<![CDATA[
			   SELECT T1.FEETYPEID
					, T1.FEETYPECODE
					, T1.FEETYPEDESC
					, T1.MANUALADVICE
					, T1.REFUNDABLE
					, T1.ADVISETYPE
					, T1.ACCOUNTSETID
					, T1.HOSTFEETYPECODE
					, T1.TAXAPPLICABLE
					, T1.TAXCOMPONENT
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T2.ACCOUNTSETCODE
					, T2.ACCOUNTSETCODENAME
					, T1.AMORTZREQ
					, T1.DUEACCREQ
					, T1.DUEACCSET
	        		, T3.ACCOUNTSETCODE DUEACCTSETCODE
					, T3.ACCOUNTSETCODENAME DUEACCTSETCODENAME
					, T1.TDSREQ
					, T1.INCOMEOREXPENSEACTYPE
					, T1.WAIVERORREFUNDACTYPE
		    		, T1.ACTYPE 
		    		, T4.ACTYPEDESC
					, T1.PAYABLELINKTO
					, T1.RECVFEETYPEID
					, T1.ALLOWAUTOREFUND
				FROM FEETYPES T1
				LEFT JOIN RMTACCOUNTINGSET T2 ON T2.ACCOUNTSETID = T1.ACCOUNTSETID
          		LEFT JOIN RMTACCOUNTINGSET T3 ON T3.ACCOUNTSETID = T1.DUEACCSET
          		LEFT JOIN RMTACCOUNTTYPES T4 ON T4.ACTYPE = T1.ACTYPE
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2509.9_post" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'feetypes_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.10_pre" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'feetypes_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.10" author="AnilKumar.G">
		<createView replaceIfExists="true" viewName="FEETYPES_TVIEW">
			<![CDATA[
			   SELECT T1.FEETYPEID
					, T1.FEETYPECODE
					, T1.FEETYPEDESC
					, T1.MANUALADVICE
					, T1.REFUNDABLE
					, T1.ADVISETYPE
					, T1.ACCOUNTSETID
					, T1.HOSTFEETYPECODE
					, T1.TAXAPPLICABLE
					, T1.TAXCOMPONENT
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T2.ACCOUNTSETCODE
					, T2.ACCOUNTSETCODENAME
					, T1.AMORTZREQ
					, T1.DUEACCREQ
					, T1.DUEACCSET
	        		, T3.ACCOUNTSETCODE DUEACCTSETCODE
					, T3.ACCOUNTSETCODENAME DUEACCTSETCODENAME
					, T1.TDSREQ
					, T1.INCOMEOREXPENSEACTYPE
					, T1.WAIVERORREFUNDACTYPE
		    		, T1.ACTYPE 
		    		, T4.ACTYPEDESC
					, T1.PAYABLELINKTO
					, T1.RECVFEETYPEID
					, T1.ALLOWAUTOREFUND
				FROM FEETYPES_TEMP T1
				LEFT JOIN RMTACCOUNTINGSET T2 ON T2.ACCOUNTSETID = T1.ACCOUNTSETID
           		LEFT JOIN RMTACCOUNTINGSET T3 ON T3.ACCOUNTSETID = T1.DUEACCSET
           		LEFT JOIN RMTACCOUNTTYPES T4 ON T4.ACTYPE = T1.ACTYPE
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2509.10_post" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'feetypes_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.11" author="Anilkumar.G">
		<sql>
		    <![CDATA[
		        DELETE FROM SMTPARAMETERS WHERE SYSPARMCODE = 'AUTO_REFUND_N_DAYS_CLOSED_LAN';
		        DELETE FROM SMTPARAMETERS WHERE SYSPARMCODE = 'AUTO_REFUND_N_DAYS_ACTIVE_LAN';
		        DELETE FROM SMTPARAMETERS WHERE SYSPARMCODE = 'REMOVE_HOLD_FLAG_N_DAYS_CLOSED_LAN';
		        DELETE FROM SMTPARAMETERS WHERE SYSPARMCODE = 'HOLD_AUTO_REFUND_DPD';
		        DELETE FROM SMTPARAMETERS WHERE SYSPARMCODE = 'CHECK_OVERDUE_AUTO_REFUND';
				DELETE FROM SMTPARAMETERS WHERE SYSPARMCODE = 'AUTO_REFUND_THROUGH_CHEQUE';
				DELETE FROM SMTPARAMETERS WHERE SYSPARMCODE = 'REFUND_UPLOAD_THREAD_COUNT';
				
				INSERT INTO SMTPARAMETERS (SYSPARMCODE, SYSPARMDESC, SYSPARMTYPE, SYSPARMMAINT, SYSPARMVALUE, SYSPARMLENGTH, SYSPARMDEC, SYSPARMLIST, SYSPARMVALDMOD, SYSPARMDESCRIPTION, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('AUTO_REFUND_N_DAYS_CLOSED_LAN',       'Number of Days to Provide Auto Refund For Closed Lan',     'int',    1, 15,   3, 0, NULL, NULL, 'Number of Days to Auto Refund For Closed Lan',                        1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SMTPARAMETERS (SYSPARMCODE, SYSPARMDESC, SYSPARMTYPE, SYSPARMMAINT, SYSPARMVALUE, SYSPARMLENGTH, SYSPARMDEC, SYSPARMLIST, SYSPARMVALDMOD, SYSPARMDESCRIPTION, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('AUTO_REFUND_N_DAYS_ACTIVE_LAN',       'Number of Days to Provide Auto Refund For Active Lan',     'int',    1, 15,   3, 0, NULL, NULL, 'Number of Days to Auto Refund For Active Lan',                        1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SMTPARAMETERS (SYSPARMCODE, SYSPARMDESC, SYSPARMTYPE, SYSPARMMAINT, SYSPARMVALUE, SYSPARMLENGTH, SYSPARMDEC, SYSPARMLIST, SYSPARMVALDMOD, SYSPARMDESCRIPTION, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('REMOVE_HOLD_FLAG_N_DAYS_CLOSED_LAN',  'Number of Days to Remove Hold Auto Refund For Closed Lan', 'int',    1, 15,   3, 0, NULL, NULL, 'Number of Days to Remove Hold Auto Refund For Closed Lan',      	  1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SMTPARAMETERS (SYSPARMCODE, SYSPARMDESC, SYSPARMTYPE, SYSPARMMAINT, SYSPARMVALUE, SYSPARMLENGTH, SYSPARMDEC, SYSPARMLIST, SYSPARMVALDMOD, SYSPARMDESCRIPTION, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('HOLD_AUTO_REFUND_DPD',                'DPD Days to Exclude Loan from Auto Refund',                'int',    1, 15,   3, 0, NULL, NULL, 'DPD Days to Exclude Lan from Auto Refund',                            1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SMTPARAMETERS (SYSPARMCODE, SYSPARMDESC, SYSPARMTYPE, SYSPARMMAINT, SYSPARMVALUE, SYSPARMLENGTH, SYSPARMDEC, SYSPARMLIST, SYSPARMVALDMOD, SYSPARMDESCRIPTION, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('CHECK_OVERDUE_AUTO_REFUND',           'Check Overdues for Loan While Auto Refund',                'String', 1, 'N',  3, 0, NULL, NULL, 'Check Overdues for Lan Whilw Auto Refund',                            1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SMTPARAMETERS (SYSPARMCODE, SYSPARMDESC, SYSPARMTYPE, SYSPARMMAINT, SYSPARMVALUE, SYSPARMLENGTH, SYSPARMDEC, SYSPARMLIST, SYSPARMVALDMOD, SYSPARMDESCRIPTION, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('AUTO_REFUND_THROUGH_CHEQUE',          'Auto Refund Allowed Through Cheque or not',                'String', 1, 'N',  3, 0, NULL, NULL, 'Auto Refund Allowed Through Cheque or not',						      1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SMTPARAMETERS (SYSPARMCODE, SYSPARMDESC, SYSPARMTYPE, SYSPARMMAINT, SYSPARMVALUE, SYSPARMLENGTH, SYSPARMDEC, SYSPARMLIST, SYSPARMVALDMOD, SYSPARMDESCRIPTION, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('REFUND_UPLOAD_THREAD_COUNT',          'Manual Refund default thread count',                       'int',   '1','10', 2, 0, NULL, NULL, '',                                                                    1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		     ]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.32" author="Anilkumar.G">
		<sql>
		    <![CDATA[
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RightID) + 1 FROM SECRIGHTS_VIEW), 3, 'FeeTypeDialog_AllowAutoRefund', 'FeeTypeDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		    	INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FEETYPE_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FeeTypeDialog_AllowAutoRefund'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
		     ]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.12" author="AnilKumar.G">
		<sql>
			<![CDATA[
				INSERT INTO BMTLOVFIELDCODE (FIELDCODE, FIELDCODEDESC, FIELDCODETYPE, FIELDEDIT, ISACTIVE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES('HOLD_REFUND', 'Reason for holding Refund', 'String', 1, 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);																														
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.21" author="AnilKumar.G">
		<addColumn tableName="RMTBRANCHES">
			<column name="DefChequeDDPrintLoc" type="varchar(15)" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.23" author="AnilKumar.G">
		<addColumn tableName="RMTBRANCHES_TEMP">
			<column name="DefChequeDDPrintLoc" type="varchar(15)" />
		</addColumn>
	</changeSet>

	<changeSet id="TK#2509.25_pre" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rmtbranches_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.25" author="AnilKumar.G">
		<createView replaceIfExists="true" viewName="RMTBRANCHES_AVIEW">
			<![CDATA[
			     SELECT T1.BRANCHCODE,
				    T1.BRANCHDESC,
				    T1.BRANCHADDRLINE1,
				    T1.BRANCHADDRLINE2,
				    T1.BRANCHPOBOX,
				    T1.BRANCHCITY,
				    T4.PCCITYNAME LOVDESCBRANCHCITYNAME,
				    T1.BRANCHPROVINCE,
				    T3.CPPROVINCENAME LOVDESCBRANCHPROVINCENAME,
				    T1.BRANCHCOUNTRY,
				    T2.COUNTRYDESC LOVDESCBRANCHCOUNTRYNAME,
				    T1.BRANCHFAX,
				    T1.BRANCHTEL,
				    T1.BRANCHSWIFTBANKCDE,
				    T1.BRANCHSWIFTCOUNTRY,
				    T1.BRANCHSWIFTLOCCODE,
				    T1.BRANCHSWIFTBRNCDE,
				    T1.BRANCHSORTCODE,
				    T1.BRANCHISACTIVE,
				    T1.NEWBRANCHCODE,
				    T6.BRANCHDESC NEWBRANCHDESC,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T1.MINIBRANCH,
				    T1.BRANCHTYPE,
				    T1.PARENTBRANCH,
				    T1.PINCODE,
				    T1.REGION,
				    T1.BANKREFNO,
				    T1.BRANCHADDRHNBR,
				    T1.BRANCHFLATNBR,
				    T1.BRANCHADDRSTREET,
				    T7.BRANCHDESC PARENTBRANCHDESC,
				    T5.COUNTRYDESC LOVDESCBRANCHSWIFTCOUNTRYNAME,
				    T8.AREANAME PINAREADESC,
				    T1.ENTITY,
				    T10.ENTITYDESC,
				    T1.CLUSTERID,
				    T9.CODE CLUSTERCODE,
				    T9.NAME CLUSTERNAME,
				    T1.PINCODEID,
				    T1.DEFCHEQUEDDPRINTLOC
		   		FROM RMTBRANCHES T1
				LEFT JOIN BMTCOUNTRIES T2 ON T1.BRANCHCOUNTRY = T2.COUNTRYCODE
			    LEFT JOIN RMTCOUNTRYVSPROVINCE T3 ON T1.BRANCHCOUNTRY = T3.CPCOUNTRY AND T1.BRANCHPROVINCE = T3.CPPROVINCE
			    LEFT JOIN RMTPROVINCEVSCITY T4 ON T1.BRANCHCOUNTRY = T4.PCCOUNTRY AND T1.BRANCHPROVINCE = T4.PCPROVINCE AND T1.BRANCHCITY = T4.PCCITY
			    LEFT JOIN BMTCOUNTRIES T5 ON T1.BRANCHSWIFTCOUNTRY = T5.COUNTRYCODE
			    LEFT JOIN RMTBRANCHES T6 ON T1.NEWBRANCHCODE = T6.BRANCHCODE
			    LEFT JOIN RMTBRANCHES T7 ON T1.PARENTBRANCH = T6.BRANCHCODE
			    LEFT JOIN PINCODES T8 ON T8.PINCODEID = T1.PINCODEID
			    LEFT JOIN CLUSTERS T9 ON T9.ID = T1.CLUSTERID
			    LEFT JOIN ENTITY T10 ON T10.ENTITYCODE = T1.ENTITY
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2509.25_post" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rmtbranches_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.26_pre" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rmtbranches_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.26" author="AnilKumar.G">
		<createView replaceIfExists="true" viewName="RMTBRANCHES_VIEW">
			<![CDATA[
			     SELECT T1.BRANCHCODE,
				    T1.BRANCHDESC,
				    T1.BRANCHADDRLINE1,
				    T1.BRANCHADDRLINE2,
				    T1.BRANCHPOBOX,
				    T1.BRANCHCITY,
				    T4.PCCITYNAME LOVDESCBRANCHCITYNAME,
					T1.BRANCHPROVINCE,
				    T3.CPPROVINCENAME LOVDESCBRANCHPROVINCENAME,
				    T1.BRANCHCOUNTRY,
				    T2.COUNTRYDESC LOVDESCBRANCHCOUNTRYNAME,
				    T1.BRANCHFAX,
				    T1.BRANCHTEL,
				    T1.BRANCHSWIFTBANKCDE,
				    T1.BRANCHSWIFTCOUNTRY,
				    T1.BRANCHSWIFTLOCCODE,
				    T1.BRANCHSWIFTBRNCDE,
				    T1.BRANCHSORTCODE,
				    T1.BRANCHISACTIVE,
				    T1.NEWBRANCHCODE,
				    T6.BRANCHDESC NEWBRANCHDESC,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T1.MINIBRANCH,
				    T1.BRANCHTYPE,
				    T1.PARENTBRANCH,
				    T1.PINCODE,
				    T1.REGION,
				    T1.BANKREFNO,
				    T1.BRANCHADDRHNBR,
				    T1.BRANCHFLATNBR,
				    T1.BRANCHADDRSTREET,
				    T7.BRANCHDESC PARENTBRANCHDESC,
				    T5.COUNTRYDESC LOVDESCBRANCHSWIFTCOUNTRYNAME,
				    T8.AREANAME PINAREADESC,
				    T1.ENTITY,
				    T10.ENTITYDESC,
				    T1.CLUSTERID,
				    T9.CODE CLUSTERCODE,
				    T9.NAME CLUSTERNAME,
					T8.PINCODEID,
					T1.DEFCHEQUEDDPRINTLOC
				FROM RMTBRANCHES_TEMP T1
				LEFT JOIN BMTCOUNTRIES T2 ON T1.BRANCHCOUNTRY = T2.COUNTRYCODE
				LEFT JOIN RMTCOUNTRYVSPROVINCE T3 ON T1.BRANCHCOUNTRY = T3.CPCOUNTRY AND T1.BRANCHPROVINCE = T3.CPPROVINCE
				LEFT JOIN RMTPROVINCEVSCITY T4 ON T1.BRANCHCOUNTRY = T4.PCCOUNTRY AND T1.BRANCHPROVINCE = T4.PCPROVINCE AND T1.BRANCHCITY = T4.PCCITY
				LEFT JOIN BMTCOUNTRIES T5 ON T1.BRANCHSWIFTCOUNTRY = T5.COUNTRYCODE
				LEFT JOIN RMTBRANCHES T6 ON T1.NEWBRANCHCODE = T6.BRANCHCODE
				LEFT JOIN RMTBRANCHES T7 ON T1.PARENTBRANCH = T6.BRANCHCODE
				LEFT JOIN PINCODES T8 ON T8.PINCODEID = T1.PINCODEID
				LEFT JOIN CLUSTERS T9 ON T9.ID = T1.CLUSTERID
				LEFT JOIN ENTITY T10 ON T10.ENTITYCODE = T1.ENTITY
				UNION ALL
				SELECT T1.BRANCHCODE,
				    T1.BRANCHDESC,
				    T1.BRANCHADDRLINE1,
				    T1.BRANCHADDRLINE2,
				    T1.BRANCHPOBOX,
				    T1.BRANCHCITY,
				    T4.PCCITYNAME LOVDESCBRANCHCITYNAME,
				    T1.BRANCHPROVINCE,
				    T3.CPPROVINCENAME LOVDESCBRANCHPROVINCENAME,
				    T1.BRANCHCOUNTRY,
				    T2.COUNTRYDESC LOVDESCBRANCHCOUNTRYNAME,
				    T1.BRANCHFAX,
				    T1.BRANCHTEL,
				    T1.BRANCHSWIFTBANKCDE,
				    T1.BRANCHSWIFTCOUNTRY,
				    T1.BRANCHSWIFTLOCCODE,
				    T1.BRANCHSWIFTBRNCDE,
				    T1.BRANCHSORTCODE,
				    T1.BRANCHISACTIVE,
				    T1.NEWBRANCHCODE,
				    T6.BRANCHDESC NEWBRANCHDESC,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T1.MINIBRANCH,
				    T1.BRANCHTYPE,
				    T1.PARENTBRANCH,
				    T1.PINCODE,
				    T1.REGION,
				    T1.BANKREFNO,
				    T1.BRANCHADDRHNBR,
				    T1.BRANCHFLATNBR,
				    T1.BRANCHADDRSTREET,
				    T7.BRANCHDESC PARENTBRANCHDESC,
				    T5.COUNTRYDESC LOVDESCBRANCHSWIFTCOUNTRYNAME,
				    T8.AREANAME PINAREADESC,
				    T1.ENTITY,
				    T10.ENTITYDESC,
				    T1.CLUSTERID,
				    T9.CODE CLUSTERCODE,
				    T9.NAME CLUSTERNAME,
					T8.PINCODEID,
					T1.DEFCHEQUEDDPRINTLOC
				FROM RMTBRANCHES T1
				LEFT JOIN BMTCOUNTRIES T2 ON T1.BRANCHCOUNTRY = T2.COUNTRYCODE
				LEFT JOIN RMTCOUNTRYVSPROVINCE T3 ON T1.BRANCHCOUNTRY = T3.CPCOUNTRY AND T1.BRANCHPROVINCE = T3.CPPROVINCE
				LEFT JOIN RMTPROVINCEVSCITY T4 ON T1.BRANCHCOUNTRY = T4.PCCOUNTRY AND T1.BRANCHPROVINCE = T4.PCPROVINCE AND T1.BRANCHCITY = T4.PCCITY
				LEFT JOIN BMTCOUNTRIES T5 ON T1.BRANCHSWIFTCOUNTRY = T5.COUNTRYCODE
				LEFT JOIN RMTBRANCHES T6 ON T1.NEWBRANCHCODE = T6.BRANCHCODE
				LEFT JOIN RMTBRANCHES T7 ON T1.PARENTBRANCH = T6.BRANCHCODE
				LEFT JOIN PINCODES T8 ON T8.PINCODEID = T1.PINCODEID
				LEFT JOIN CLUSTERS T9 ON T9.ID = T1.CLUSTERID
				LEFT JOIN ENTITY T10 ON T10.ENTITYCODE = T1.ENTITY
				WHERE NOT EXISTS (SELECT 1 FROM RMTBRANCHES_TEMP WHERE RMTBRANCHES_TEMP.BRANCHCODE = T1.BRANCHCODE)
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2509.26_post" author="AnilKumar.G" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rmtbranches_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2509.28_post" author="vijaya.a">
		<sql>
			<![CDATA[
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'BranchDialog_DefChequeDDPrintLoc', 'BranchDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'BRANCH_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'BranchDialog_DefChequeDDPrintLoc'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.1_pre" author="saisandeep.b" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'paymentheader_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.1" author="saisandeep.b">
		<createView replaceIfExists="true" viewName="PAYMENTHEADER_VIEW">
			<![CDATA[
				SELECT T1.PAYMENTID,
					FM.FINID,
					FM.FINREFERENCE,
					T1.PAYMENTTYPE,
					T1.PAYMENTAMOUNT,
					T1.CREATEDON,
					T1.APPROVEDON,
					T1.STATUS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					PIT.PAYMENTTYPE PAYMENTINSTRTYPE,
					FM.CUSTID,
					C.CUSTCOREBANK
				FROM PAYMENTHEADER_TEMP T1
				INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
				LEFT JOIN PAYMENTINSTRUCTIONS_TEMP PIT ON T1.PAYMENTID = PIT.PAYMENTID
				INNER JOIN CUSTOMERS C ON C.CUSTID = FM.CUSTID
				UNION ALL
				SELECT T1.PAYMENTID,
					FM.FINID,
					FM.FINREFERENCE,
					T1.PAYMENTTYPE,
					T1.PAYMENTAMOUNT,
					T1.CREATEDON,
					T1.APPROVEDON,
					T1.STATUS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					PI.PAYMENTTYPE PAYMENTINSTRTYPE,
					FM.CUSTID,
					C.CUSTCOREBANK
				FROM PAYMENTHEADER T1
				INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
				LEFT JOIN PAYMENTINSTRUCTIONS PI ON T1.PAYMENTID = PI.PAYMENTID
				INNER JOIN CUSTOMERS C ON C.CUSTID = FM.CUSTID
				WHERE NOT EXISTS (SELECT 1 FROM PAYMENTHEADER_TEMP WHERE PAYMENTHEADER_TEMP.PAYMENTID = T1.PAYMENTID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2565.1_post" author="saisandeep.b" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'paymentheader_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.2_pre" author="saisandeep.b" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'paymentheader_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.2" author="saisandeep.b">
		<createView replaceIfExists="true" viewName="PAYMENTHEADER_AVIEW">
			<![CDATA[
				SELECT T1.PAYMENTID,
					FM.FINID,
					FM.FINREFERENCE,
					T1.PAYMENTTYPE,
					T1.PAYMENTAMOUNT,
					T1.CREATEDON,
					T1.APPROVEDON,
					T1.STATUS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					PI.PAYMENTTYPE PAYMENTINSTRTYPE,
					FM.CUSTID,
					C.CUSTCOREBANK
				FROM PAYMENTHEADER T1
				INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
				LEFT JOIN PAYMENTINSTRUCTIONS PI ON T1.PAYMENTID = PI.PAYMENTID
				INNER JOIN CUSTOMERS C ON C.CUSTID = FM.CUSTID
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2565.2_post" author="saisandeep.b" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'paymentheader_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.3" author="saisandeep.b">
		<createTable tableName="PAYMINS_UPLOADS">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="HeaderId" type="bigint" />
			<column name="FinId" type="bigInt" />
			<column name="FinReference" type="varchar(20)" />
			<column name="ExcessType" type="char(1)" />
			<column name="FeeType" type="varchar(8)" />
			<column name="PayAmount" type="decimal(18,0)" />
			<column name="Remarks" type="varchar(100)" />
			<column name="OverRideOverDue" type="char(1)" />
			<column name="Progress" type="int" />
			<column name="Status" type="char(1)" />
			<column name="ErrorCode" type="varchar(20)" />
			<column name="ErrorDesc" type="varchar(2000)" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2565.4" author="saisandeep.b">
		<addPrimaryKey tableName="PAYMINS_UPLOADS" columnNames="Id" constraintName="pk_paymins_uploads_id" />
	</changeSet>

	<changeSet id="TK#2565.5" author="saisandeep.b">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='PAYINS_REFUND_UPLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='PAYINS_REFUND_UPLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='PAYINS_REFUND_UPLOAD';
 				
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD';

				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'PAYINS_REFUND_UPLOAD', 'payment Instruction Upload File.', 12, 'PaymentInstruction', null, null, ',', 0, 1, null, 'ROW:{Reference No,Type of Excess,Fee Type,Pay Amount,Remarks,Override Overdue}', null, 'C', '/opt/pff/hdfc/paymentinstruction/upload', 'PaymentInstruction_', '.xls', 0, CURRENT_TIMESTAMP, '${ddmm},.${SEQ_DATE_FILE}', null, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD'), 'PAYMINS_UPLOADS', 1, 'HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 2, 0, 0);

				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD')), 'HEADERID',     0, 'N', NULL, NULL, '${HEADER_ID}', NULL, '0', NULL, NULL, NULL, NULL, 'M');								
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD')), 'FINREFERENCE',  0, 'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD')), 'EXCESSTYPE',       0, 'N', NULL, NULL, NULL, NULL, '1', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD')), 'FEETYPE',       0, 'N', NULL, NULL, NULL, NULL, '2', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD')), 'PAYAMOUNT',       0, 'N', NULL, NULL, NULL, NULL, '3', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD')), 'REMARKS',       0, 'N', NULL, NULL, NULL, NULL, '4', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_UPLOAD')), 'OVERRIDEOVERDUE',       0, 'N', NULL, NULL, NULL, NULL, '5', NULL, NULL, NULL, NULL, 'M');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.6" author="saisandeep.b">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='PAYINS_REFUND_TEMPLATE');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='PAYINS_REFUND_TEMPLATE');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='PAYINS_REFUND_TEMPLATE';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'PAYINS_REFUND_TEMPLATE', 'PaymentInstruction template download', 3, 'PaymentInstruction', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{Reference No,Type of Excess,Fee Type,Pay Amount,Remarks,Override Overdue}',  '', 'A', '/opt/pff/hdfc/paymentinstruction/template', 'PaymentInstruction_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE'), 'PAYMINS_UPLOADS',  0, 'ID', 'HEADERID = :HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, 2, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE')), 'FINREFERENCE',0, 'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE')), 'EXCESSTYPE',0, 'N', NULL, NULL, NULL, NULL, '1', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE')), 'FEETYPE',0, 'N', NULL, NULL, NULL, NULL, '2', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE')), 'PAYAMOUNT',0, 'N', NULL, NULL, NULL, NULL, '3', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE')), 'REMARKS',0, 'N', NULL, NULL, NULL, NULL, '4', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_TEMPLATE')), 'OVERRIDEOVERDUE',0, 'N', NULL, NULL, NULL, NULL, '5', NULL, NULL, NULL, NULL, 'M');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.7" author="saisandeep.b">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='PAYINS_REFUND_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='PAYINS_REFUND_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='PAYINS_REFUND_DOWNLOAD';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'PAYINS_REFUND_DOWNLOAD', 'PaymentInstruction download', 3, 'PaymentInstruction', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{Reference No,Type of Excess,Fee Type,Pay Amount,Remarks,Override Overdue,Upload Status,Upload Failure Reason}',  '', 'A', '/opt/pff/hdfc/paymentinstruction/download', 'PaymentInstruction_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD'), 'PAYMINS_UPLOADS',  0, 'ID', 'HEADERID = :HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, 10, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD')), 'FINREFERENCE',    0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD')), 'TYPEOFEXCESS',	 0,'N', NULL, NULL, NULL, NULL, '1', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD')), 'FEETYPE',	     0,'N', NULL, NULL, NULL, NULL, '2', NULL, NULL, NULL, 'dd-MMM-yyyy', 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD')), 'PAYAMOUNT',	         0,'N', NULL, NULL, NULL, NULL, '3', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD')), 'REMARKS',	     0,'N', NULL, NULL, NULL, NULL, '4', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD')), 'OVERRIDEOVERDUE',	     0,'N', NULL, NULL, NULL, NULL, '5', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD')), 'STATUS',	     0,'N', NULL, NULL, NULL, NULL, '6', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'PAYMINS_UPLOADS' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'PAYINS_REFUND_DOWNLOAD')), 'ErrorDesc',	     0,'N', NULL, NULL, NULL, NULL, '7', NULL, NULL, NULL, NULL, 'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.8_pre" author="saisandeep.b" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemainmaintenance_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.8" author="saisandeep.b">
		<createView replaceIfExists="true" viewName="FINANCEMAINMAINTENANCE_VIEW">
			<![CDATA[
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.FINTYPE,
					T1.FINCCY,
					T1.CALROUNDINGMODE,
					T1.ROUNDINGTARGET,
					T1.FINBRANCH,
					T1.CUSTID,
					T1.FINSTARTDATE,
					T1.MATURITYDATE,
					T1.CLOSINGSTATUS,
					T1.WRITEOFFLOAN
				FROM FINANCEMAIN_TEMP T1
				UNION ALL
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.FINTYPE,
					T1.FINCCY,
					T1.CALROUNDINGMODE,
					T1.ROUNDINGTARGET,
					T1.FINBRANCH,
					T1.CUSTID,
					T1.FINSTARTDATE,
					T1.MATURITYDATE,
					T1.CLOSINGSTATUS,
					T1.WRITEOFFLOAN
				FROM FINANCEMAIN T1
				WHERE NOT EXISTS (SELECT 1 FROM FINANCEMAIN_TEMP WHERE FINID= T1.FINID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2565.8_post" author="saisandeep.b" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemainmaintenance_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2565.9.1" author="saisandeep.b">
		<createTable tableName="PaymentInstUploadQueuing">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="UploadHeaderId" type="bigint" />
			<column name="UploadDetailId" type="bigint" />
			<column name="Finreference" type="varchar(20)" />
			<column name="JsonObject" type="clob" />
			<column name="EodDate" type="datetime" />
			<column name="ThreadId" type="int" />
			<column name="Progress" type="int" />
			<column name="StartTime" type="datetime" />
			<column name="EndTime" type="datetime" />
			<column name="ErrorLog" type="Varchar(2000)" />
			<column name="EodProcess" type="int" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2565.9.1.1" author="saisandeep.b">
		<addPrimaryKey tableName="PaymentInstUploadQueuing" columnNames="Id"
			constraintName="pk_pyinsupqueuing_upid" />
	</changeSet>

	<changeSet id="TK#2565.9.2" author="saisandeep.b">
		<createTable tableName="PaymentInstUploadQueuing_Log">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="UploadHeaderId" type="bigint" />
			<column name="UploadDetailId" type="bigint" />
			<column name="Finreference" type="Varchar(20)" />
			<column name="JsonObject" type="clob" />
			<column name="EodDate" type="datetime" />
			<column name="ThreadId" type="int" />
			<column name="Progress" type="int" />
			<column name="StartTime" type="datetime" />
			<column name="EndTime" type="datetime" />
			<column name="ErrorLog" type="Varchar(2000)" />
			<column name="EodProcess" type="int" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2565.9.2.1" author="saisandeep.b">
		<addPrimaryKey tableName="PaymentInstUploadQueuing_Log" columnNames="Id"
			constraintName="pk_pyinsupqueuing_log_upid" />
	</changeSet>

	<changeSet id="TK#2565.12" author="saisandeep.b">
		<sql>
			<![CDATA[
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANUAL_REF_UPLOAD_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANUAL_REF_UPLOAD_APPROVER');

				DELETE FROM SECROLES WHERE ROLECD = 'MANUAL_REF_UPLOAD_MAKER';
				DELETE FROM SECROLES WHERE ROLECD = 'MANUAL_REF_UPLOAD_APPROVER';

				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANUAL_REF_UPLOAD_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANUAL_REF_UPLOAD_APPROVER');

				DELETE FROM SECGROUPS WHERE GRPCODE ='MANUAL_REF_UPLOAD_MAKER';
				DELETE FROM SECGROUPS WHERE GRPCODE ='MANUAL_REF_UPLOAD_APPROVER';

				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_ManualRefUpload_Maker';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_ManualRefUpload_Approver';

				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_ManualRefUpload_Maker', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_ManualRefUpload_Approver', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'MANUAL_REF_UPLOAD_MAKER', 'WF Maker for Manual Refund Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'MANUAL_REF_UPLOAD_APPROVER', 'WF Approver for Manual Refund Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);

				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANUAL_REF_UPLOAD_MAKER'),    (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_ManualRefUpload_Maker'),    1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANUAL_REF_UPLOAD_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_ManualRefUpload_Approver'), 1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'MANUAL_REF_UPLOAD_MAKER', 'Maker role from Manual Refund Upload', '', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0); 
				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'MANUAL_REF_UPLOAD_APPROVER', 'Approver role from Manual Refund Upload',	'', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANUAL_REF_UPLOAD_MAKER'),    (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'MANUAL_REF_UPLOAD_MAKER'),    0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'MANUAL_REF_UPLOAD_APPROVER'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'MANUAL_REF_UPLOAD_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2568.1" author="Vijayakumar.K">
		<sql>
			<![CDATA[
				DELETE FROM ERRORDETAILS WHERE CODE = 'REFUND014';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, EXTENDEDMESSAGE, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID, LASTMNTON, LASTMNTBY, VERSION) VALUES('REFUND014','EN','W','There are dues available for knock off! Please confirm to proceed','','Approved',null,null,null,null,null,0,CURRENT_TIMESTAMP,1000,0);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND001';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND001', 'EN', 'E', 'DPD days are grater than the Configured system parameter value.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND002';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND002', 'EN', 'E', 'Receipt in Cancellation process.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND003';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND003', 'EN', 'E', 'Receipt in refund process.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND004';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND004', 'EN', 'E', 'Refund Amount is grater than the max refund amount in loan type.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND005';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND005', 'EN', 'E', 'Refund Amount is less than the minimum refund amount in loan type.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND006';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND006', 'EN', 'E', 'Refund Amount is zero.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND007';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND007', 'EN', 'E', 'Beneficiary details are not available for  the refund loan.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND008';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND008', 'EN', 'E', 'Amount refunded sucessfully to loan..', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND009';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND009', 'EN', 'E', ' Auto refund Failed', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND010';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND010', 'EN', 'E', 'Loan was write off.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND011';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND011', 'EN', 'E', 'Loan is in Hold Staus.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND012';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND012', 'EN', 'E', 'Loan was not refund because auto refund through cheque  flag value is false.', 'Approved', 0, 1000, 1);
				DELETE FROM ERRORDETAILS WHERE CODE='REFUND013';
				INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, RECORDSTATUS, WORKFLOWID, LASTMNTBY, VERSION) VALUES ('REFUND013', 'EN', 'E', 'Unhandled expection.', 'Approved', 0, 1000, 1);
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2568.2" author="Vijayakumar.k">
		<createTable tableName="Auto_Refund_Loans">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="FinId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="RefundAmt" type="decimal(18,0)" />
			<column name="AppDate" type="datetime" />
			<column name="ExecutionTime" type="datetime" />
			<column name="Status" type="char(1)" />
			<column name="ErrorCode" type="varchar(20)" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2568.2.1" author="Vijayakumar.k">
		<addPrimaryKey tableName="Auto_Refund_Loans" columnNames="Id" constraintName="PK_Auto_Refund_Loans_ID" />
	</changeSet>

	<changeSet id="TK#2568.2.2" author="Vijayakumar.k" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE AUTO_REFUND_LOANS ADD CONSTRAINT DF_ARL_REFUNDAMT DEFAULT 0 FOR REFUNDAMT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2568.2.2" author="Vijayakumar.k" dbms="postgresql, oracle">
		<addDefaultValue tableName="Auto_Refund_Loans" columnName="RefundAmt" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2566.1" author="sampath.d">
		<createTable tableName="Fee_Refund_Header">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="CustCif" type="varchar(10)" />
			<column name="FinID" type="bigint" />
			<column name="PaymentType" type="varchar(5)" />
			<column name="FinType" type="varchar(10)" />
			<column name="BranchName" type="varchar(20)" />
			<column name="PaymentAmount" type="Decimal(18,0)" />
			<column name="Status" type="varchar(5)" />
			<column name="ApprovalStatus" type="varchar(5)" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2566.1.1" author="sampath.d">
		<addPrimaryKey tableName="Fee_Refund_Header" columnNames="Id" constraintName="pk_feerfdhdr_feeid" />
	</changeSet>

	<changeSet id="TK#2566.2" author="sampath.d">
		<createSequence sequenceName="SeqFee_Refund_Header" incrementBy="1" maxValue="999999999999999"
			startValue="1" />
	</changeSet>

	<changeSet id="TK#2566.3" author="sampath.d">
		<createTable tableName="Fee_Refund_Header_Temp">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="CustCif" type="varchar(10)" />
			<column name="FinID" type="bigint" />
			<column name="PaymentType" type="varchar(5)" />
			<column name="FinType" type="varchar(10)" />
			<column name="BranchName" type="varchar(20)" />
			<column name="PaymentAmount" type="Decimal(18,0)" />
			<column name="Status" type="varchar(5)" />
			<column name="ApprovalStatus" type="varchar(5)" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2566.3.1" author="sampath.d">
		<addPrimaryKey tableName="Fee_Refund_Header_Temp" columnNames="Id" constraintName="pk_feerfdhdrt_feeid" />
	</changeSet>

	<changeSet id="TK#2566.4_pre" author="sampath.d" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fee_refund_header_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2566.4" author="sampath.d">
		<createView viewName="FEE_REFUND_HEADER_AVIEW" replaceIfExists="true">
			<![CDATA[
			    SELECT T1.ID,
					T1.CUSTCIF,
					T2.CUSTSHRTNAME,
					T1.FINID,
					T3.FINREFERENCE,
					T1.PAYMENTTYPE,
					T1.FINTYPE,
					T1.BRANCHNAME,
					T1.PAYMENTAMOUNT,
					T1.STATUS,
					T1.APPROVALSTATUS,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.APPROVEDBY,
					T1.APPROVEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.CUSTID,
					T2.CUSTCOREBANK
				FROM FEE_REFUND_HEADER T1
				INNER JOIN CUSTOMERS T2 ON T2.CUSTCIF = T1.CUSTCIF
				INNER JOIN FINANCEMAIN T3 ON T3.FINID = T1.FINID
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#2566.4_post" author="sampath.d" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fee_refund_header_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2566.5_pre" author="sampath.d" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fee_refund_header_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2566.5" author="sampath.d">
		<createView viewName="FEE_REFUND_HEADER_VIEW" replaceIfExists="true">
			<![CDATA[
			 	SELECT T1.ID,
			 		T1.CUSTCIF,
	                T2.CUSTSHRTNAME CUSTNAME,
	                T1.FINID,
	                T3.FINREFERENCE,
	                T1.PAYMENTTYPE,
	                T1.FINTYPE,
	                T4.BRANCHDESC BRANCHNAME,
	                T1.PAYMENTAMOUNT,
	                T1.STATUS,
					T1.APPROVALSTATUS,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.APPROVEDBY,
					T1.APPROVEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
	                T1.RECORDSTATUS,
	                T1.ROLECODE,
	                T1.NEXTROLECODE,
	                T1.TASKID,
	                T1.NEXTTASKID,
	                T1.RECORDTYPE,
	                T1.WORKFLOWID,
	                T2.CUSTID,
	                T2.CUSTCOREBANK 
	            FROM FEE_REFUND_HEADER_TEMP T1
                INNER JOIN CUSTOMERS T2 ON T2.CUSTCIF = T1.CUSTCIF
                INNER JOIN FINANCEMAIN T3 ON T3.FINID = T1.FINID
                INNER JOIN RMTBRANCHES T4 ON T4.BRANCHCODE = T3.FINBRANCH
	            UNION ALL
	            SELECT T1.ID,
			 		T1.CUSTCIF,
	                T2.CUSTSHRTNAME CUSTNAME,
	                T1.FINID,
	                T3.FINREFERENCE,
	                T1.PAYMENTTYPE,
	                T1.FINTYPE,
	                T4.BRANCHDESC BRANCHNAME,
	                T1.PAYMENTAMOUNT,
	                T1.STATUS,
					T1.APPROVALSTATUS,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.APPROVEDBY,
					T1.APPROVEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
	                T1.RECORDSTATUS,
	                T1.ROLECODE,
	                T1.NEXTROLECODE,
	                T1.TASKID,
	                T1.NEXTTASKID,
	                T1.RECORDTYPE,
	                T1.WORKFLOWID,
	                T2.CUSTID,
	                T2.CUSTCOREBANK 
	            FROM FEE_REFUND_HEADER T1
                INNER JOIN CUSTOMERS T2 ON T2.CUSTCIF = T1.CUSTCIF
                INNER JOIN FINANCEMAIN T3 ON T3.FINID = T1.FINID
                INNER JOIN RMTBRANCHES T4 ON T4.BRANCHCODE = T3.FINBRANCH
	            WHERE NOT EXISTS (SELECT 1 FROM FEE_REFUND_HEADER_TEMP WHERE ID = T1.ID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2566.5_post" author="sampath.d" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fee_refund_header_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2566.6" author="sampath.d">
		<createTable tableName="Fee_Refund_Details">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="HeaderID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ReceivableType" type="VARCHAR(5)" />
			<column name="TotalAmount" type="Decimal(18,0)" />
			<column name="PaidAmount" type="Decimal(18,0)" />
			<column name="PrevRefundAmount" type="Decimal(18,0)" />
			<column name="currRefundAmount" type="Decimal(18,0)" />
			<column name="AvailableAmount" type="Decimal(18,0)" />
			<column name="ReceivableRefId" type="bigint" />
			<column name="FeeTypeCode" type="VARCHAR(10)" />
			<column name="FeeTypeDesc" type="VARCHAR(50)" />
			<column name="PayableFeeTypeCode" type="VARCHAR(10)" />
			<column name="PayableFeeTypeDesc" type="VARCHAR(50)" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2566.6.1" author="sampath.d">
		<addPrimaryKey tableName="Fee_Refund_Details" columnNames="Id,HeaderID"
			constraintName="pk_feerfddtl_feedtlid" />
	</changeSet>

	<changeSet id="TK#2566.7" author="sampath.d">
		<createSequence sequenceName="SeqFee_Refund_Details" incrementBy="1" maxValue="999999999999999"
			startValue="1" />
	</changeSet>

	<changeSet id="TK#2566.8" author="sampath.d">
		<createTable tableName="Fee_Refund_Details_Temp">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="HeaderId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ReceivableType" type="VARCHAR(5)" />
			<column name="TotalAmount" type="Decimal(18,0)" />
			<column name="PaidAmount" type="Decimal(18,0)" />
			<column name="PrevRefundAmount" type="Decimal(18,0)" />
			<column name="currRefundAmount" type="Decimal(18,0)" />
			<column name="AvailableAmount" type="Decimal(18,0)" />
			<column name="ReceivableRefId" type="bigint" />
			<column name="FeeTypeCode" type="VARCHAR(10)" />
			<column name="FeeTypeDesc" type="VARCHAR(50)" />
			<column name="PayableFeeTypeCode" type="VARCHAR(10)" />
			<column name="PayableFeeTypeDesc" type="VARCHAR(50)" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2566.7.1" author="sampath.d">
		<addPrimaryKey tableName="Fee_Refund_Details_Temp" columnNames="Id,HeaderId"
			constraintName="pk_feerfddtlt_feedtlid" />
	</changeSet>

	<changeSet id="TK#2566.9" author="sampath.d">
		<createTable tableName="Fee_Refund_Instructions">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="HeaderId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaymentType" type="VARCHAR(5)" />
			<column name="PaymentAmount" type="Decimal(18,0)" />
			<column name="Remarks" type="VARCHAR(100)" />
			<column name="PartnerBankId" type="bigint" />
			<column name="IssuingBank" type="VARCHAR(8)" />
			<column name="FavourName" type="VARCHAR(200)" />
			<column name="FavourNumber" type="VARCHAR(100)" />
			<column name="PayableLoc" type="VARCHAR(50)" />
			<column name="PrintingLoc" type="VARCHAR(50)" />
			<column name="ValueDate" type="Datetime" />
			<column name="PostDate" type="Datetime" />
			<column name="BankBranchId" type="bigint" />
			<column name="AcctHolderName" type="VARCHAR(200)" />
			<column name="AccountNo" type="VARCHAR(100)" />
			<column name="PhoneCountryCode" type="VARCHAR(5)" />
			<column name="PhoneNumber" type="VARCHAR(12)" />
			<column name="ClearingDate" type="Datetime" />
			<column name="Status" type="VARCHAR(50)" />
			<column name="Active" type="boolean" />
			<column name="PaymentCCy" type="VARCHAR(3)" />
			<column name="Lei" type="VARCHAR(100)" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2566.9.1" author="sampath.d">
		<addPrimaryKey tableName="Fee_Refund_Instructions" columnNames="Id,HeaderId"
			constraintName="pk_feerfdinst_feeinsid" />
	</changeSet>

	<changeSet id="TK#2566.10" author="sampath.d">
		<createSequence sequenceName="SeqFee_Refund_Instructions" incrementBy="1" maxValue="999999999999999"
			startValue="1" />
	</changeSet>

	<changeSet id="TK#2566.11" author="sampath.d">
		<createTable tableName="Fee_Refund_Instructions_Temp">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="HeaderId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaymentType" type="VARCHAR(5)" />
			<column name="PaymentAmount" type="Decimal(18,0)" />
			<column name="Remarks" type="VARCHAR(100)" />
			<column name="PartnerBankId" type="bigint" />
			<column name="IssuingBank" type="VARCHAR(8)" />
			<column name="FavourName" type="VARCHAR(200)" />
			<column name="FavourNumber" type="VARCHAR(100)" />
			<column name="PayableLoc" type="VARCHAR(50)" />
			<column name="PrintingLoc" type="VARCHAR(50)" />
			<column name="ValueDate" type="Datetime" />
			<column name="PostDate" type="Datetime" />
			<column name="BankBranchId" type="bigint" />
			<column name="AcctHolderName" type="VARCHAR(200)" />
			<column name="AccountNo" type="VARCHAR(100)" />
			<column name="PhoneCountryCode" type="VARCHAR(5)" />
			<column name="PhoneNumber" type="VARCHAR(12)" />
			<column name="ClearingDate" type="Datetime" />
			<column name="Status" type="VARCHAR(50)" />
			<column name="Active" type="boolean" />
			<column name="PaymentCCy" type="VARCHAR(3)" />
			<column name="Lei" type="VARCHAR(100)" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2566.11.1" author="sampath.d">
		<addPrimaryKey tableName="Fee_Refund_Instructions_Temp" columnNames="Id,HeaderId"
			constraintName="pk_feerfdinstt_feeinsid" />
	</changeSet>

	<changeSet id="TK#2566.12_pre" author="sampath.d" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fee_refund_details_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2566.12" author="sampath.d">
		<createView viewName="FEE_REFUND_DETAILS_VIEW" replaceIfExists="true">
			<![CDATA[
			 	SELECT T1.ID,
			 	 	T1.HEADERID,
					T1.RECEIVABLETYPE,
					T1.TOTALAMOUNT,
					T1.PAIDAMOUNT,
					T1.PREVREFUNDAMOUNT,
					T1.CURRREFUNDAMOUNT,
					T1.AVAILABLEAMOUNT,
					T1.RECEIVABLEREFID,
					T1.FEETYPECODE,
					T1.FEETYPEDESC,
					T1.PAYABLEFEETYPECODE,
					T1.PAYABLEFEETYPEDESC,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.APPROVEDBY,
					T1.APPROVEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID
				FROM FEE_REFUND_DETAILS_TEMP T1	
				LEFT JOIN MANUALADVISE T2 ON  T1.RECEIVABLEREFID = T2.ADVISEID AND T1.RECEIVABLETYPE = '1'
				UNION ALL
				SELECT T1.ID,
			 	 	T1.HEADERID,
					T1.RECEIVABLETYPE,
					T1.TOTALAMOUNT,
					T1.PAIDAMOUNT,
					T1.PREVREFUNDAMOUNT,
					T1.CURRREFUNDAMOUNT,
					T1.AVAILABLEAMOUNT,
					T1.RECEIVABLEREFID,
					T1.FEETYPECODE,
					T1.FEETYPEDESC,
					T1.PAYABLEFEETYPECODE,
					T1.PAYABLEFEETYPEDESC,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.APPROVEDBY,
					T1.APPROVEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID
				FROM FEE_REFUND_DETAILS T1
				LEFT JOIN MANUALADVISE T2 ON T1.RECEIVABLEREFID = T2.ADVISEID AND T1.RECEIVABLETYPE = '1'
				WHERE NOT EXISTS (SELECT 1 FROM FEE_REFUND_DETAILS_TEMP WHERE ID = T1.ID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2566.12_post" author="sampath.d" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fee_refund_details_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2566.13_pre" author="sampath.d" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fee_refund_instructions_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2566.13" author="sampath.d">
		<createView viewName="FEE_REFUND_INSTRUCTIONS_VIEW" replaceIfExists="true">
			<![CDATA[
			 	SELECT T1.ID,
					T1.HEADERID,
					T1.PAYMENTTYPE,
					T1.PAYMENTAMOUNT,
					T1.REMARKS,
					T1.PARTNERBANKID,
					T1.ISSUINGBANK,
					T1.FAVOURNAME,
					T1.FAVOURNUMBER,
					T1.PAYABLELOC,
					T1.PRINTINGLOC,
					T1.VALUEDATE,
					T1.POSTDATE,
					T1.BANKBRANCHID,
					T1.ACCTHOLDERNAME,
					T1.ACCOUNTNO,
					T1.PHONECOUNTRYCODE,
					T1.PHONENUMBER,
					T1.CLEARINGDATE,
					T1.ACTIVE,
					T1.PAYMENTCCY,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.APPROVEDBY,
					T1.APPROVEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.STATUS,
					T5.PARTNERBANKCODE,
					T5.PARTNERBANKNAME,
					T3.BANKCODE BRANCHBANKCODE,
					T3.BRANCHCODE BANKBRANCHCODE,
					T3.IFSC BANKBRANCHIFSC,
					T3.CITY,
					T4.BANKNAME ISSUINGBANKNAME,
					T6.PCCITYNAME,
					T3.BRANCHDESC,
					T2.BANKNAME,
					T5.ACCOUNTNO PARTNERBANKAC,
					T5.ACTYPE PARTNERBANKACTYPE,
					T1.LEI
				FROM FEE_REFUND_INSTRUCTIONS_TEMP T1
				LEFT JOIN BANKBRANCHES T3 ON T1.BANKBRANCHID = T3.BANKBRANCHID
				LEFT JOIN BMTBANKDETAIL T2 ON T2.BANKCODE = T3.BANKCODE
				LEFT JOIN BMTBANKDETAIL T4 ON T1.ISSUINGBANK = T4.BANKCODE
				LEFT JOIN PARTNERBANKS T5 ON T5.PARTNERBANKID = T1.PARTNERBANKID
				LEFT JOIN RMTPROVINCEVSCITY T6 ON T6.PCCITY = T3.CITY
				UNION ALL
				SELECT T1.ID,
					T1.HEADERID,
					T1.PAYMENTTYPE,
					T1.PAYMENTAMOUNT,
					T1.REMARKS,
					T1.PARTNERBANKID,
					T1.ISSUINGBANK,
					T1.FAVOURNAME,
					T1.FAVOURNUMBER,
					T1.PAYABLELOC,
					T1.PRINTINGLOC,
					T1.VALUEDATE,
					T1.POSTDATE,
					T1.BANKBRANCHID,
					T1.ACCTHOLDERNAME,
					T1.ACCOUNTNO,
					T1.PHONECOUNTRYCODE,
					T1.PHONENUMBER,
					T1.CLEARINGDATE,
					T1.ACTIVE,
					T1.PAYMENTCCY,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.APPROVEDBY,
					T1.APPROVEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.STATUS,
					T5.PARTNERBANKCODE,
					T5.PARTNERBANKNAME,
					T3.BANKCODE BRANCHBANKCODE,
					T3.BRANCHCODE BANKBRANCHCODE,
					T3.IFSC BANKBRANCHIFSC,
					T3.CITY,
					T4.BANKNAME ISSUINGBANKNAME,
					T6.PCCITYNAME,
					T3.BRANCHDESC,
					T2.BANKNAME,
					T5.ACCOUNTNO PARTNERBANKAC,
					T5.ACTYPE PARTNERBANKACTYPE,
					T1.LEI
				FROM FEE_REFUND_INSTRUCTIONS T1
				LEFT JOIN BANKBRANCHES T3 ON T1.BANKBRANCHID = T3.BANKBRANCHID
				LEFT JOIN BMTBANKDETAIL T2 ON T2.BANKCODE = T3.BANKCODE
				LEFT JOIN BMTBANKDETAIL T4 ON T1.ISSUINGBANK = T4.BANKCODE
				LEFT JOIN PARTNERBANKS T5 ON T5.PARTNERBANKID = T1.PARTNERBANKID
				LEFT JOIN RMTPROVINCEVSCITY T6 ON T6.PCCITY = T3.CITY
				WHERE NOT EXISTS (SELECT 1 FROM FEE_REFUND_INSTRUCTIONS_TEMP WHERE ID = T1.ID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2566.13_post" author="sampath.d" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fee_refund_instructions_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2566.14" author="sampath.d">
		<createTable tableName="FeeRefundProcessQueuing">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="FeeRefundHeaderId" type="bigint" />
			<column name="FinReference" type="VARCHAR(16)" />
			<column name="JsonObject" type="clob" />
			<column name="EodDate" type="datetime" />
			<column name="ThreadId" type="int" />
			<column name="Progress" type="int" />
			<column name="StartTime" type="datetime" />
			<column name="EndTime" type="datetime" />
			<column name="ErrorLog" type="Varchar(2000)" />
			<column name="EodProcess" type="int" />
		</createTable>
	</changeSet>


	<changeSet id="TK#2566.14.1" author="sampath.d">
		<addPrimaryKey tableName="FeeRefundProcessQueuing" columnNames="Id" constraintName="PK_FEERFDQUE_ID" />
	</changeSet>

	<changeSet id="TK#2566.15" author="sampath.d">
		<createTable tableName="FeeRefundProcessQueuing_Log">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="FeeRefundHeaderId" type="bigint" />
			<column name="FinReference" type="VARCHAR(16)" />
			<column name="JsonObject" type="clob" />
			<column name="EodDate" type="datetime" />
			<column name="ThreadId" type="int" />
			<column name="Progress" type="int" />
			<column name="StartTime" type="datetime" />
			<column name="EndTime" type="datetime" />
			<column name="ErrorLog" type="Varchar(2000)" />
			<column name="EodProcess" type="int" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2566.15.1" author="sampath.d">
		<addPrimaryKey tableName="FeeRefundProcessQueuing_Log" columnNames="Id"
			constraintName="PK_FEERFDQUEL_ID" />
	</changeSet>

	<changeSet id="TK#2562.1" author="sampath.d">
		<createTable tableName="Fin_Hold_Details">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="FinId" type="bigint" />
			<column name="HoldStatus" type="char(1)" />
			<column name="Reason" type="varchar(50)" />
			<column name="Remarks" type="varchar(50)" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2562.2" author="sampath.d">
		<addPrimaryKey tableName="Fin_Hold_Details" columnNames="Id" constraintName="PK_FIN_HOLD_DETAILS"/>
	</changeSet>

	<changeSet id="TK#2562.3" author="sampath.d">
		<createTable tableName="HOLD_REFUND_UPLOAD">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="HeaderId" type="bigint" />
			<column name="FinID" type="bigint" />
			<column name="FinReference" type="varchar(20)" />
			<column name="HoldStatus" type="char(1)" />
			<column name="Reason" type="varchar(50)" />
			<column name="Remarks" type="varchar(50)" />
			<column name="Progress" type="int" />
			<column name="Status" type="char(1)" />
			<column name="ErrorCode" type="varchar(20)" />
			<column name="ErrorDesc" type="varchar(2000)" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2562.4" author="sampath.d">
		<addPrimaryKey tableName="HOLD_REFUND_UPLOAD" columnNames="Id" constraintName="PK_HOLD_REFUND_UPLOAD"/>
	</changeSet>

	<changeSet id="TK#2562.5" author="sampath.d">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='HOLD_REFUND_UPLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='HOLD_REFUND_UPLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='HOLD_REFUND_UPLOAD';
 				
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_UPLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_UPLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_UPLOAD';

				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'HOLD_REFUND_UPLOAD', 'Hold Refund Upload File.', 12, 'HoldRefund', null, null, ',', 0, 1, null, 'ROW:{LOAN_REFERENCE_NO, STATUS, REASON, REMARKS}', null, 'C', '/opt/pff/hdfc/holdrefund/upload', 'HoldRefund_', '.xlsx', 0, CURRENT_TIMESTAMP, '${ddmm},.${SEQ_DATE_FILE}', null, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_UPLOAD'), 'HOLD_REFUND_UPLOAD', 1, 'HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 2, 0, 0);

				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_UPLOAD')), 'HEADERID',     0, 'N', NULL, NULL, '${HEADER_ID}', NULL, '0', NULL, NULL, NULL, NULL, 'M');								
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_UPLOAD')), 'FINREFERENCE',  0, 'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_UPLOAD')), 'HOLDSTATUS',       0, 'N', NULL, NULL, NULL, NULL, '1', NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_UPLOAD')), 'REASON',       0, 'N', NULL, NULL, NULL, NULL, '2', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_UPLOAD')), 'REMARKS',       0, 'N', NULL, NULL, NULL, NULL, '3', NULL, NULL, NULL, NULL, 'O'); 			
 			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2562.6" author="sampath.d">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='HOLD_REFUND_TEMPLATE');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='HOLD_REFUND_TEMPLATE');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='HOLD_REFUND_TEMPLATE';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_TEMPLATE'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_TEMPLATE');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_TEMPLATE';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'HOLD_REFUND_TEMPLATE', 'Hold Refund template download', 3, 'HoldRefund', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{LOAN_REFERENCE_NO, STATUS, REASON, REMARKS}',  '', 'A', '/opt/pff/hdfc/holdrefund/template', 'HoldRefund_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_TEMPLATE'), 'HOLD_REFUND_UPLOAD',  0, 'ID', 'HEADERID = 0', NULL, NULL, NULL, NULL, NULL, NULL, 2, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_TEMPLATE')), 'LOAN_REFERENCE_NO',  0, 'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_TEMPLATE')), 'HOLDSTATUS',       0, 'N', NULL, NULL, NULL, NULL, '1', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_TEMPLATE')), 'REASON',       0, 'N', NULL, NULL, NULL, NULL, '2', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_TEMPLATE')), 'REMARKS',       0, 'N', NULL, NULL, NULL, NULL, '3', NULL, NULL, NULL, NULL, 'O'); 	
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2562.7" author="sampath.d">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='HOLD_REFUND_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='HOLD_REFUND_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='HOLD_REFUND_DOWNLOAD';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'HOLD_REFUND_DOWNLOAD', 'Hold Refund download', 3, 'HoldRefund', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{Loan Reference No,Status,Reason,Remarks,Upload Status,Failure Code,Failure Desc}',  '', 'A', '/opt/pff/hdfc/holdrefund/download', 'HoldRefund_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD'), 'HOLD_REFUND_UPLOAD',  0, 'ID', 'HEADERID = :HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, 9, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD')), 'FINREFERENCE',      0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD')), 'HOLDSTATUS',	     0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD')), 'REASON',	         0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD')), 'REMARKS',	         0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD')), 'STATUS',	         0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD')), 'ERRORCODE',	     0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'HOLD_REFUND_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'HOLD_REFUND_DOWNLOAD')), 'ERRORDESC',	     0,'N', NULL, NULL, NULL, NULL, '0', NULL, NULL, NULL, NULL, 'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2562.8" author="sampath.d">
		<createTable tableName="HOLD_REFUND_UPLOAD_LOG">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="FinID" type="bigint" />
			<column name="FinReference" type="varchar(20)" />
			<column name="HoldStatus" type="char(1)" />
			<column name="Reason" type="varchar(50)" />
			<column name="Remarks" type="varchar(50)" />
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2562.8.1" author="sampath.d">
		<addPrimaryKey tableName="HOLD_REFUND_UPLOAD_LOG" columnNames="Id" constraintName="PK_HOLD_REFUND_UPLOAD_LOG" />
	</changeSet>

	<changeSet id="TK#2566.16" author="sampath.d">
		<sql>
			<![CDATA[
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FEE_REFUND_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FEE_REFUND_APPROVER');

				DELETE FROM SECROLES WHERE ROLECD = 'FEE_REFUND_MAKER';
				DELETE FROM SECROLES WHERE ROLECD = 'FEE_REFUND_APPROVER';

				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FEE_REFUND_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FEE_REFUND_APPROVER');

				DELETE FROM SECGROUPS WHERE GRPCODE ='FEE_REFUND_MAKER';
				DELETE FROM SECGROUPS WHERE GRPCODE ='FEE_REFUND_APPROVER';

				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_FeeRefundMaker';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_FeeRefundApprover';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='button_FeeRefundHeaderDialog_btnNew';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='button_FeeRefundHeaderDialog_btnEdit';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='button_FeeRefundHeaderDialog_btnDelete';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='button_FeeRefundHeaderDialog_btnSave';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundHeaderDialog_currRefundAmount';
				
				INSERT INTO SECROLES (ROLEID,ROLEAPP,ROLECD,ROLEDESC,ROLECATEGORY,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID)  VALUES ((select max(roleid)+1 from secroles), 1, 'FEE_REFUND_MAKER', 'Role for Fee Refund Maker', NULL, 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLES (ROLEID,ROLEAPP,ROLECD,ROLEDESC,ROLECATEGORY,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) VALUES ((select max(roleid)+1 from secroles), 1, 'FEE_REFUND_APPROVER', 'Role for Fee Refund Approver',	NULL, 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0) ;
				
				INSERT INTO SECGROUPS (GRPID,GRPCODE,GRPDESC,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(GrpID)+1 From SecGroups), 'FEE_REFUND_MAKER', 'Group for Fee Refund Group maker', 		1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				INSERT INTO SECGROUPS (GRPID,GRPCODE,GRPDESC,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(GrpID)+1 From SecGroups), 'FEE_REFUND_APPROVER', 'Group for Fee Refund Group approver', 	1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((select max(RightId)+1 from SecRights),0, 'menu_Item_FeeRefundMaker','MENU',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),0, 'menu_Item_FeeRefundApprover','MENU',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'button_FeeRefundHeaderList_NewFeeRefundHeader','FeeRefundHeaderList',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'button_FeeRefundHeaderDialog_btnNew','FeeRefundHeaderDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'button_FeeRefundHeaderDialog_btnEdit','FeeRefundHeaderDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'button_FeeRefundHeaderDialog_btnDelete','FeeRefundHeaderDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'button_FeeRefundHeaderDialog_btnSave','FeeRefundHeaderDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundHeaderDialog_currRefundAmount','FeeRefundHeaderDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_MAKER'), (Select RightID from SecRights where RightName = 'menu_Item_FeeRefundMaker'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_MAKER'), (Select RightID from SecRights where RightName = 'button_FeeRefundHeaderDialog_btnNew'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_MAKER'), (Select RightID from SecRights where RightName = 'button_FeeRefundHeaderDialog_btnEdit'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_MAKER'), (Select RightID from SecRights where RightName = 'button_FeeRefundHeaderDialog_btnDelete'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_MAKER'), (Select RightID from SecRights where RightName = 'button_FeeRefundHeaderDialog_btnSave'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundHeaderDialog_currRefundAmount'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_APPROVER'), (Select RightID from SecRights where RightName = 'menu_Item_FeeRefundApprover'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECROLEGROUPS (ROLEGRPID,GRPID,ROLEID,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='FEE_REFUND_MAKER'),(select RoleID from secRoles where RoleCd='FEE_REFUND_MAKER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLEGROUPS (ROLEGRPID,GRPID,ROLEID,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='FEE_REFUND_APPROVER'),(select RoleID from secRoles where RoleCd='FEE_REFUND_APPROVER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2566.17" author="sampath.d">
		<sql>
			<![CDATA[
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FEE_REFUND_INST_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FEE_REFUND_INST_APPROVER');

				DELETE FROM SECROLES WHERE ROLECD = 'FEE_REFUND_INST_MAKER';
				DELETE FROM SECROLES WHERE ROLECD = 'FEE_REFUND_INST_APPROVER';

				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FEE_REFUND_INST_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FEE_REFUND_INST_APPROVER');

				DELETE FROM SECGROUPS WHERE GRPCODE ='FEE_REFUND_INST_MAKER';
				DELETE FROM SECGROUPS WHERE GRPCODE ='FEE_REFUND_INST_APPROVER';

				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_paymentAmount';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_postDate';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_paymentType';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_remarks';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_bankBranchID';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_acctNumber';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_acctHolderName';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_phoneNumber';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_issuingBank';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_favouringName';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_chequeOrDDumber';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_payableLoc';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_printingLoc';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_valueDate';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_partnerBankID';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='FeeRefundInstructionDialog_leiNumber';
				
				INSERT INTO SECROLES (ROLEID,ROLEAPP,ROLECD,ROLEDESC,ROLECATEGORY,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID)  VALUES ((select max(roleid)+1 from secroles), 1, 'FEE_REFUND_INST_MAKER', 'Role for Fee Refund Inst Maker', NULL, 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLES (ROLEID,ROLEAPP,ROLECD,ROLEDESC,ROLECATEGORY,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) VALUES ((select max(roleid)+1 from secroles), 1, 'FEE_REFUND_INST_APPROVER', 'Role for Fee Refund Inst Approver',	NULL, 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0) ;
				
				INSERT INTO SECGROUPS (GRPID,GRPCODE,GRPDESC,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(GrpID)+1 From SecGroups), 'FEE_REFUND_INST_MAKER', 'Group for Fee Refund Inst Group maker', 		1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				INSERT INTO SECGROUPS (GRPID,GRPCODE,GRPDESC,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(GrpID)+1 From SecGroups), 'FEE_REFUND_INST_APPROVER', 'Group for Fee Refund Inst Group approver', 	1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_paymentAmount','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_postDate','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_paymentType','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_remarks','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_bankBranchID','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_acctNumber','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_acctHolderName','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_phoneNumber','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_issuingBank','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_favouringName','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_chequeOrDDumber','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_payableLoc','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_printingLoc','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_valueDate','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_partnerBankID','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				INSERT INTO SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((Select MAX(RightID)+1 From SecRights),2, 'FeeRefundInstructionDialog_leiNumber','FeeRefundInstructionDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_paymentAmount'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_postDate'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_paymentType'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_remarks'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_bankBranchID'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_acctNumber'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_acctHolderName'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_phoneNumber'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_issuingBank'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_favouringName'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_chequeOrDDumber'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_payableLoc'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_printingLoc'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_valueDate'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_partnerBankID'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID,GRPID,RIGHTID,ACCESSTYPE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values((Select max(GrpRightID)+1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'FEE_REFUND_INST_MAKER'), (Select RightID from SecRights where RightName = 'FeeRefundInstructionDialog_leiNumber'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECROLEGROUPS (ROLEGRPID,GRPID,ROLEID,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='FEE_REFUND_INST_MAKER'),(select RoleID from secRoles where RoleCd='FEE_REFUND_INST_MAKER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLEGROUPS (ROLEGRPID,GRPID,ROLEID,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='FEE_REFUND_INST_APPROVER'),(select RoleID from secRoles where RoleCd='FEE_REFUND_INST_APPROVER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2562.9" author="saisandeep.b">
		<sql>
			<![CDATA[
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'HOLD_REF_UPLOAD_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'HOLD_REF_UPLOAD_APPROVER');

				DELETE FROM SECROLES WHERE ROLECD = 'HOLD_REF_UPLOAD_MAKER';
				DELETE FROM SECROLES WHERE ROLECD = 'HOLD_REF_UPLOAD_APPROVER';

				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'HOLD_REF_UPLOAD_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'HOLD_REF_UPLOAD_APPROVER');

				DELETE FROM SECGROUPS WHERE GRPCODE ='HOLD_REF_UPLOAD_MAKER';
				DELETE FROM SECGROUPS WHERE GRPCODE ='HOLD_REF_UPLOAD_APPROVER';

				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_HoldRefundUpload_Maker';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_HoldRefundUpload_Approver';

				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_HoldRefundUpload_Maker', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_HoldRefundUpload_Approver', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'HOLD_REF_UPLOAD_MAKER', 'WF Maker for Hold Refund Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'HOLD_REF_UPLOAD_APPROVER', 'WF Approver for Hold Refund Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);

				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'HOLD_REF_UPLOAD_MAKER'),    (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_HoldRefundUpload_Maker'),    1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'HOLD_REF_UPLOAD_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_HoldRefundUpload_Approver'), 1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'HOLD_REF_UPLOAD_MAKER', 'Maker role from Hold Refund Upload', '', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0); 
				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'HOLD_REF_UPLOAD_APPROVER', 'Approver role from Hold Refund Upload',	'', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'HOLD_REF_UPLOAD_MAKER'),    (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'HOLD_REF_UPLOAD_MAKER'),    0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'HOLD_REF_UPLOAD_APPROVER'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'HOLD_REF_UPLOAD_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2650.0" author="sandeepkumar.m" context="Dropping index">
		<comment>Dropping index</comment>
		<dropIndex tableName="FINEXCESSAMOUNT" indexName="IDX_FNEXCSSAMN_FINID_AMTTYPE" />
	</changeSet>

	<changeSet id="TK#2650.1" author="sandeepkumar.m" >
		<createIndex tableName="FINEXCESSAMOUNT" indexName="IDX_FNXCSAM_FID_AMTY_VLDT_REID" unique="true">
			<column name="FINID" type="bigint" />
			<column name="AMOUNTTYPE" type="varchar(8)" />
			<column name="RECEIPTID" type="bigint" />
			<column name="VALUEDATE" type="datetime" />
		</createIndex>
	</changeSet>

	<changeSet id="STLMT#1" author="Shanakr.M">
		<comment>New Sequence for settlement Type Detail Table</comment>
		<createSequence sequenceName="SEQSETTLEMENTTYPES" incrementBy="1" startValue="1" minValue="1"
			maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="STLMT#2" author="saikiran.n">
		<comment>New Table for settlement Type Detail</comment>
		<createTable tableName="SETTLEMENTTYPES">
			<column name="SettlementTypeID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="SettlementCode" type="VARCHAR(20)" >
				<constraints nullable="false" />
			</column>
			<column name="SettlementDesc" type="VARCHAR(200)" />
			<column name="AlwGracePeriod" type="smallint" />
			<column name="Active" type="smallint" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="STLMT#3" author="saikiran.n">
		<addPrimaryKey tableName="SETTLEMENTTYPES" columnNames="SettlementTypeID, SettlementCode"
			constraintName="PK_HDRID_STLCODE" />
	</changeSet>

	<changeSet id="STLMT#4" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="AlwGracePeriod" tableName="SETTLEMENTTYPES" defaultValue="0" />
		<addDefaultValue columnName="Active" tableName="SETTLEMENTTYPES" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#4" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SETTLEMENTTYPES ADD CONSTRAINT DF_P_AlwGracePeriod DEFAULT 0 FOR AlwGracePeriod;
				ALTER TABLE SETTLEMENTTYPES ADD CONSTRAINT DF_P_Active DEFAULT 0 FOR Active;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#5" author="saikiran.n">
		<comment>New Temp Table for settlement Type Detail</comment>
		<createTable tableName="SETTLEMENTTYPES_TEMP">
			<column name="SettlementTypeID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="SettlementCode" type="VARCHAR(20)" >
				<constraints nullable="false" />
			</column>
			<column name="SettlementDesc" type="VARCHAR(200)" />
			<column name="AlwGracePeriod" type="smallint" />
			<column name="Active" type="smallint" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="STLMT#6" author="saikiran.n">
		<addPrimaryKey tableName="SETTLEMENTTYPES_TEMP" columnNames="SettlementTypeID, SettlementCode"
			constraintName="PKT_HDRID_STLCODE" />
	</changeSet>

	<changeSet id="STLMT#7" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="AlwGracePeriod" tableName="SETTLEMENTTYPES_TEMP" defaultValue="0" />
		<addDefaultValue columnName="Active" tableName="SETTLEMENTTYPES_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#7" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SETTLEMENTTYPES_TEMP ADD CONSTRAINT DF_PT_AlwGracePeriod DEFAULT 0 FOR AlwGracePeriod;
				ALTER TABLE SETTLEMENTTYPES_TEMP ADD CONSTRAINT DF_PT_Active DEFAULT 0 FOR Active;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#8_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementtypes_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#8" author="saikiran.n">
		<createView viewName="SETTLEMENTTYPES_AVIEW" replaceIfExists="true">
		<![CDATA[
		   SELECT T1.SETTLEMENTTYPEID
				,T1.SETTLEMENTCODE
				, T1.SETTLEMENTDESC
				, T1.ALWGRACEPERIOD
				, T1.ACTIVE
				, T1.VERSION
				, T1.LASTMNTBY
				, T1.LASTMNTON
				, T1.RECORDSTATUS
				, T1.ROLECODE
				, T1.NEXTROLECODE
				, T1.TASKID
				, T1.NEXTTASKID
				, T1.RECORDTYPE
				, T1.WORKFLOWID
			    FROM SETTLEMENTTYPES T1
		]]>
	</createView>
	</changeSet>

	<changeSet id="STLMT#8_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementtypes_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#9_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementtypes_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#9" author="saikiran.n">
		<createView viewName="SETTLEMENTTYPES_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTTYPEID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTTYPES_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="PSTLMT#9_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementtypes_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#10_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlementtypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#10" author="saikiran.n">
		<createView viewName="SETTLEMENTTYPES_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTTYPEID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTTYPES_TEMP T1
				UNION ALL 
				SELECT T1.SETTLEMENTTYPEID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTTYPES T1
				WHERE NOT (EXISTS ( SELECT 1 FROM SETTLEMENTTYPES_TEMP
				WHERE SETTLEMENTTYPES_TEMP.SETTLEMENTTYPEID = T1.SETTLEMENTTYPEID))
			]]>
		</createView>
	</changeSet>

	<changeSet id="STLMT#10_post" author="Shankar.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'settlementtypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#11" author="saikiran.n">
		<comment>RIGHTS for settlement Type Detail</comment>
		<sql>
			<![CDATA[
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_APPROVER');
		
				DELETE FROM SECROLEGROUPS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_APPROVER');
				
				DELETE FROM SECGROUPS WHERE GRPCODE IN ('SETTLEMENTTYPEDETAIL_MAKER', 'SETTLEMENTTYPEDETAIL_APPROVER');
		
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnNew');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnEdit');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnSave');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnDelete');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_SettlementCode');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_SettlementDesc');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_AlwGracePeriod');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_Active');
				
				DELETE FROM SECRIGHTS WHERE RightName = 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnNew';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnEdit';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnSave';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnDelete';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_SettlementCode';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_SettlementDesc';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_AlwGracePeriod';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_Active';
				
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail', 'MENU', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementTypeDetailDialog_btnNew','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementTypeDetailDialog_btnEdit','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementTypeDetailDialog_btnSave','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementTypeDetailDialog_btnDelete','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementTypeDetailDialog_SettlementCode','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementTypeDetailDialog_SettlementDesc','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementTypeDetailDialog_AlwGracePeriod','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementTypeDetailDialog_Active','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SETTLEMENTTYPEDETAIL_MAKER', 'Settlement Type Detail Maker',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SETTLEMENTTYPEDETAIL_APPROVER', 'Settlement Type Detail Approver',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnNew'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementTypeDetailDialog_SettlementCode'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementTypeDetailDialog_SettlementDesc'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementTypeDetailDialog_AlwGracePeriod'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementTypeDetailDialog_Active'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#12" author="Shanakr.M">
		<comment>New Sequence for settlement Table</comment>
		<createSequence sequenceName="SEQSETTLEMENT" incrementBy="1" startValue="1" minValue="1"
			maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="STLMT#13" author="saikiran.n">
		<comment>New Table for settlement Details</comment>
		<createTable tableName="FinSettlementHeader">
			<column name="settlementHeaderID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FinId" type="bigint" />
			<column name="finReference" type="VarChar(20)" />
			<column name="settlementType" type="bigint" />
			<column name="settlementStatus" type="VarChar(5)" />
			<column name="startDate" type="datetime" />
			<column name="otsDate" type="datetime" />
			<column name="endDate" type="datetime" />
			<column name="settlementReason" type="VarChar(50)" />
			<column name="settlementAmount" type="Decimal(18,0)" />
			<column name="noOfGraceDays" type="bigint" />
			<column name="settlementEndAfterGrace" type="datetime" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementReasonId" type="bigint" />
			<column name="cancelReasonCode" type="varchar(10)" />
			<column name="cancelRemarks" type="varchar(20)" />
		</createTable>
	</changeSet>

	<changeSet id="STLMT#14" author="saikiran.n">
		<addPrimaryKey tableName="FinSettlementHeader" columnNames="settlementHeaderID"
			constraintName="PK_settlementHeaderID" />
	</changeSet>

	<changeSet id="PSD#213383.30" author="saikiran.n">
		<sql>
			<![CDATA[
				update FINSETTLEMENTHEADER set settlementReasonId = 0 where settlementReasonId is Null;			
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#15" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="FinId" tableName="FinSettlementHeader" defaultValue="0" />
		<addDefaultValue columnName="settlementType" tableName="FinSettlementHeader" defaultValue="0" />
		<addDefaultValue columnName="settlementAmount" tableName="FinSettlementHeader" defaultValue="0" />
		<addDefaultValue columnName="noOfGraceDays" tableName="FinSettlementHeader" defaultValue="0" />
		<addDefaultValue columnName="settlementReasonId" tableName="FINSETTLEMENTHEADER" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#15" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FinSettlementHeader ADD CONSTRAINT DF_FSH_FinId DEFAULT 0 FOR FinId;
				ALTER TABLE FinSettlementHeader ADD CONSTRAINT DF_FSH_settlementType DEFAULT 0 FOR settlementType;
				ALTER TABLE FinSettlementHeader ADD CONSTRAINT DF_FSH_SettlementAmount DEFAULT 0 FOR SettlementAmount;
				ALTER TABLE FinSettlementHeader ADD CONSTRAINT DF_FSH_noOfGraceDays DEFAULT 0 FOR noOfGraceDays;
				ALTER TABLE FINSETTLEMENTHEADER ADD CONSTRAINT DF_FSH_settlementReasonId DEFAULT 0 FOR settlementReasonId;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#16" author="saikiran.n">
		<comment>New Temp Table for settlement Details</comment>
		<createTable tableName="FinSettlementHeader_TEMP">
			<column name="SettlementHeaderID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FinId" type="bigint" />
			<column name="FinReference" type="VarChar(20)" />
			<column name="SettlementType" type="bigint" />
			<column name="SettlementStatus" type="VarChar(5)" />
			<column name="StartDate" type="datetime" />
			<column name="OtsDate" type="datetime" />
			<column name="EndDate" type="datetime" />
			<column name="SettlementReason" type="VarChar(50)" />
			<column name="SettlementAmount" type="Decimal(18,0)" />
			<column name="NoOfGraceDays" type="bigint" />
			<column name="SettlementEndAfterGrace" type="datetime" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementReasonId" type="bigint" />
			<column name="cancelReasonCode" type="varchar(10)" />
			<column name="cancelRemarks" type="varchar(20)" />
		</createTable>
	</changeSet>

	<changeSet id="STLMT#17" author="saikiran.n">
		<addPrimaryKey tableName="FinSettlementHeader_TEMP" columnNames="settlementHeaderID"
			constraintName="PKT_FinSettlementHeaderID" />
	</changeSet>

	<changeSet id="PSD#213383.31" author="saikiran.n">
		<sql>
			<![CDATA[
				update FINSETTLEMENTHEADER_TEMP set settlementReasonId = 0 where settlementReasonId is Null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#18" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="FinId" tableName="FinSettlementHeader_TEMP" defaultValue="0" />
		<addDefaultValue columnName="settlementType" tableName="FinSettlementHeader_TEMP" defaultValue="0" />
		<addDefaultValue columnName="settlementAmount" tableName="FinSettlementHeader_TEMP" defaultValue="0" />
		<addDefaultValue columnName="noOfGraceDays" tableName="FinSettlementHeader_TEMP" defaultValue="0" />
		<addDefaultValue columnName="settlementReasonId" tableName="FINSETTLEMENTHEADER_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#18" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FinSettlementHeader_TEMP ADD CONSTRAINT DF_STLMTTemp_FinId DEFAULT 0 FOR FinId;
				ALTER TABLE FinSettlementHeader_TEMP ADD CONSTRAINT DF_STLMTTemp_SettlementType DEFAULT 0 FOR SettlementType;
				ALTER TABLE FinSettlementHeader_TEMP ADD CONSTRAINT DF_STLMTTemp_SettlementAmount DEFAULT 0 FOR SettlementAmount;
				ALTER TABLE FinSettlementHeader_TEMP ADD CONSTRAINT DF_STLMTTemp_NoOfGraceDays DEFAULT 0 FOR NoOfGraceDays;
				ALTER TABLE FINSETTLEMENTHEADER_TEMP ADD CONSTRAINT DF_FSH_T_settlementReasonId DEFAULT 0 FOR settlementReasonId;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#19_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'finsettlementheader_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#19" author="saikiran.n">
		<createView viewName="FINSETTLEMENTHEADER_AVIEW" replaceIfExists="true">
			<![CDATA[
		  	 	SELECT T1.SETTLEMENTHEADERID
					,T1.FINID
					,T1.FINREFERENCE
					,T1.SETTLEMENTTYPE
					,T1.SETTLEMENTSTATUS
					,T1.STARTDATE
					,T1.OTSDATE
					,T1.ENDDATE
					,T1.SETTLEMENTREASON
					,T1.SETTLEMENTAMOUNT
					,T1.NOOFGRACEDAYS
					,T1.SETTLEMENTENDAFTERGRACE
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
					,T1.CANCELREASONCODE
					,T1.CANCELREMARKS
					,T2.SETTLEMENTCODE SETTLEMENTCODE
					,T1.SETTLEMENTREASONID
					,T3.DESCRIPTION SETTLEMENTREASONDESC
				FROM FINSETTLEMENTHEADER T1
				LEFT JOIN SETTLEMENTTYPES T2 ON T1.SETTLEMENTTYPE = T2.SETTLEMENTTYPEID
				LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
			]]>
		</createView>
	</changeSet>

	<changeSet id="STLMT#19_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'finsettlementheader_aview');
		]]>
		</sql>
	</changeSet>



	<changeSet id="PSD#213383.28_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'finsettlementheader_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#213383.28" author="saikiran.n">
		<createView viewName="FINSETTLEMENTHEADER_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					,T1.FINID
					,T1.FINREFERENCE
					,T1.SETTLEMENTTYPE
					,T1.SETTLEMENTSTATUS
					,T1.STARTDATE
					,T1.OTSDATE
					,T1.ENDDATE
					,T1.SETTLEMENTREASON
					,T1.SETTLEMENTAMOUNT
					,T1.NOOFGRACEDAYS
					,T1.SETTLEMENTENDAFTERGRACE
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
					,T1.CANCELREASONCODE
					,T1.CANCELREMARKS
					,T2.SETTLEMENTCODE SETTLEMENTCODE
					,T1.SETTLEMENTREASONID
				FROM FINSETTLEMENTHEADER_TEMP T1
				LEFT JOIN SETTLEMENTTYPES T2 ON T1.SETTLEMENTTYPE = T2.SETTLEMENTTYPEID
            	LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
				UNION ALL 
				SELECT T1.SETTLEMENTHEADERID
					,T1.FINID
					,T1.FINREFERENCE
					,T1.SETTLEMENTTYPE
					,T1.SETTLEMENTSTATUS
					,T1.STARTDATE
					,T1.OTSDATE
					,T1.ENDDATE
					,T1.SETTLEMENTREASON
					,T1.SETTLEMENTAMOUNT
					,T1.NOOFGRACEDAYS
					,T1.SETTLEMENTENDAFTERGRACE
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
					,T1.CANCELREASONCODE
					,T1.CANCELREMARKS
					,T2.SETTLEMENTCODE SETTLEMENTCODE
					,T1.SETTLEMENTREASONID
				FROM FINSETTLEMENTHEADER T1
				LEFT JOIN SETTLEMENTTYPES T2 ON T1.SETTLEMENTTYPE = T2.SETTLEMENTTYPEID
           		LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
				WHERE NOT (EXISTS ( SELECT 1 FROM FINSETTLEMENTHEADER_TEMP
				WHERE FINSETTLEMENTHEADER_TEMP.SETTLEMENTHEADERID = T1.SETTLEMENTHEADERID))
			]]>
		</createView>
	</changeSet>

	<changeSet id="PSD#213383.28_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finsettlementheader_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#213383.29_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finsettlementheader_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#213383.29" author="saikiran.n">
		<createView viewName="FINSETTLEMENTHEADER_TVIEW" replaceIfExists="true">
		    <![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					,T1.FINID
					,T1.FINREFERENCE
					,T1.SETTLEMENTTYPE
					,T1.SETTLEMENTSTATUS
					,T1.STARTDATE
					,T1.OTSDATE
					,T1.ENDDATE
					,T1.SETTLEMENTREASON
					,T1.SETTLEMENTAMOUNT
					,T1.NOOFGRACEDAYS
					,T1.SETTLEMENTENDAFTERGRACE
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
					,T1.CANCELREASONCODE
					,T1.CANCELREMARKS
					,T2.SETTLEMENTCODE SETTLEMENTCODE
					,T1.SETTLEMENTREASONID
				FROM FINSETTLEMENTHEADER_TEMP T1
				LEFT JOIN SETTLEMENTTYPES T2 ON T1.SETTLEMENTTYPE = T2.SETTLEMENTTYPEID
				LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
			]]>
		</createView>
	</changeSet>

	<changeSet id="PSD#213383.29_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finsettlementheader_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#22" author="saikiran.n">
		<comment>RIGHTS for settlement Type Detail</comment>
		<sql>
			<![CDATA[
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_APPROVER');
		
				DELETE FROM SECROLEGROUPS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_APPROVER');
				
				DELETE FROM SECGROUPS WHERE GRPCODE IN ('SETTLEMENT_MAKER', 'SETTLEMENT_APPROVER');
		
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'menuItem_SettlementMaster_Settlement');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnNew');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnEdit');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnSave');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnDelete');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementType');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementStatus');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_StartDate');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_OtsDate');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementReason');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_EndDate');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_FinReference');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_FinID');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementAmount');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementEndAfterGrace');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_NoOfGraceDays');
				
				DELETE FROM SECRIGHTS WHERE RightName = 'menuItem_SettlementMaster_Settlement';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnNew';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnEdit';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnSave';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnDelete';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementType';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementStatus';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_StartDate';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_OtsDate';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementReason';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_EndDate';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_FinReference';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_FinID';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementAmount';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementEndAfterGrace';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_NoOfGraceDays';
				
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menuItem_SettlementMaster_Settlement', 'MENU', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementDialog_btnNew','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementDialog_btnEdit','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementDialog_btnSave','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementDialog_btnDelete','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementType','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementStatus','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_StartDate','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_OtsDate','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementReason','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_EndDate','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_FinReference','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_FinID','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementAmount','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementEndAfterGrace','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_NoOfGraceDays','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SETTLEMENT_MAKER', 'Settlement Maker',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SETTLEMENT_APPROVER', 'Settlement Approver',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_SettlementMaster_Settlement'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnNew'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementType'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementStatus'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_StartDate'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_OtsDate'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementReason'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_EndDate'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_FinReference'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_FinID'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementAmount'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementEndAfterGrace'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_NoOfGraceDays'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_SettlementMaster_Settlement'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#23" author="Shanakr.M">
		<comment>New Sequence for settlement Table</comment>
		<createSequence sequenceName="SEQSETTLEMENTALLOCATIONDTLS" incrementBy="1" startValue="1" minValue="1"
			maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="STLMT#24" author="saikiran.n">
		<comment>New Table for settlement Allocation Details</comment>
		<createTable tableName="SettlementAllocationDtls">
			<column name="SETTLEMENTHEADERID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ALLOCATIONID" type="Decimal(10,0)" >
				<constraints nullable="false" />
			</column>
			<column name="ALLOCATIONTYPE" type="Char(8)" />
			<column name="ALLOCATIONTO" type="bigint" />
			<column name="PAIDAMOUNT" type="Decimal(18,0)" />
			<column name="TOTALDUE" type="Decimal(18,0)" />
			<column name="WAIVEDAMOUNT" type="Decimal(18,0)" />
			<column name="SETTLEMENTALLOCATIONID" type="bigint" />
			<column name="PAIDGST" type="Decimal(18,0)" />
			<column name="WAIVEDREQAMOUNT" type="Decimal(18,0)" />
			<column name="WAIVERACCEPTED" type="Char(1)" />
			<column name="WAIVEDGST" type="Decimal(18,0)" />
			<column name="TAXHEADERID" type="bigint" />
			<column name="TDSDUE" type="Decimal(18,0)" />
			<column name="TDSPAID" type="Decimal(18,0)" />
			<column name="TDSWAIVED" type="Decimal(18,0)" />
		</createTable>
	</changeSet>

	<changeSet id="STLMT#25" author="saikiran.n">
		<addForeignKeyConstraint constraintName="FK_StlmtAlctnDtls_HdrID"
			referencedTableName="FINSETTLEMENTHEADER" referencedColumnNames="SETTLEMENTHEADERID"
			baseTableName="SettlementAllocationDtls" baseColumnNames="SETTLEMENTHEADERID" />
	</changeSet>

	<changeSet id="STLMT#26" author="saikiran.n">
		<addPrimaryKey tableName="SettlementAllocationDtls" columnNames="SETTLEMENTHEADERID, ALLOCATIONID"
			constraintName="PK_HDRID_ALOCID" />
	</changeSet>

	<changeSet id="STLMT#27" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="PAIDGST" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TOTALDUE" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="WAIVEDREQAMOUNT" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="WAIVERACCEPTED" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="WAIVEDGST" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TAXHEADERID" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TDSDUE" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TDSPAID" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TDSWAIVED" tableName="SettlementAllocationDtls" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#27" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_PAIDGST DEFAULT 0 FOR PAIDGST;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TOTALDUE DEFAULT 0 FOR TOTALDUE;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_WAIVEDREQAMOUNT DEFAULT 0 FOR WAIVEDREQAMOUNT;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_WAIVERACCEPTED DEFAULT 0 FOR WAIVERACCEPTED;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_WAIVEDGST DEFAULT 0 FOR WAIVEDGST;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TAXHEADERID DEFAULT 0 FOR TAXHEADERID;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TDSDUE DEFAULT 0 FOR TDSDUE;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TDSPAID DEFAULT 0 FOR TDSPAID;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TDSWAIVED DEFAULT 0 FOR TDSWAIVED;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#28" author="saikiran.n">
		<comment>New Temp Table for settlement Allocation Details</comment>
		<createTable tableName="SettlementAllocationDtls_Temp">
			<column name="SETTLEMENTHEADERID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ALLOCATIONID" type="Decimal(10,0)" >
				<constraints nullable="false" />
			</column>
			<column name="ALLOCATIONTYPE" type="Char(8)" />
			<column name="ALLOCATIONTO" type="bigint" />
			<column name="PAIDAMOUNT" type="Decimal(18,0)" />
			<column name="TOTALDUE" type="Decimal(18,0)" />
			<column name="WAIVEDAMOUNT" type="Decimal(18,0)" />
			<column name="SETTLEMENTALLOCATIONID" type="bigint" />
			<column name="PAIDGST" type="Decimal(18,0)" />
			<column name="WAIVEDREQAMOUNT" type="Decimal(18,0)" />
			<column name="WAIVERACCEPTED" type="Char(1)" />
			<column name="WAIVEDGST" type="Decimal(18,0)" />
			<column name="TAXHEADERID" type="bigint" />
			<column name="TDSDUE" type="Decimal(18,0)" />
			<column name="TDSPAID" type="Decimal(18,0)" />
			<column name="TDSWAIVED" type="Decimal(18,0)" />
		</createTable>
	</changeSet>

	<changeSet id="STLMT#29" author="saikiran.n">
		<addPrimaryKey tableName="SettlementAllocationDtls_Temp" columnNames="SETTLEMENTHEADERID, ALLOCATIONID"
			constraintName="PKT_HDRID_ALOCID" />
	</changeSet>

	<changeSet id="STLMT#30" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="PAIDGST" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TOTALDUE" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="WAIVEDREQAMOUNT" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="WAIVERACCEPTED" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="WAIVEDGST" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TAXHEADERID" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TDSDUE" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TDSPAID" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TDSWAIVED" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#30" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_PAIDGST DEFAULT 0 FOR PAIDGST;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TOTALDUE DEFAULT 0 FOR TOTALDUE;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_WAIVEDREQAMOUNT DEFAULT 0 FOR WAIVEDREQAMOUNT;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_WAIVERACCEPTED DEFAULT 0 FOR WAIVERACCEPTED;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_WAIVEDGST DEFAULT 0 FOR WAIVEDGST;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TAXHEADERID DEFAULT 0 FOR TAXHEADERID;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TDSDUE DEFAULT 0 FOR TDSDUE;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TDSPAID DEFAULT 0 FOR TDSPAID;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TDSWAIVED DEFAULT 0 FOR TDSWAIVED;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#31_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementallocationdtls_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#31" author="saikiran.n">
		<createView viewName="SETTLEMENTALLOCATIONDTLS_AVIEW" replaceIfExists="true">
		<![CDATA[
			SELECT T1.SETTLEMENTHEADERID
				, T1.SETTLEMENTALLOCATIONID
				, T1.ALLOCATIONID
				, T1.ALLOCATIONTYPE
				, T1.ALLOCATIONTO
				, T1.PAIDAMOUNT
				, T1.WAIVEDAMOUNT
				, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
				, T1.PAIDGST
				, T1.WAIVEDREQAMOUNT
				, T1.WAIVERACCEPTED
				, T1.TOTALDUE
				, T1.WAIVEDGST
				, T1.TAXHEADERID
				, T1.TDSDUE
				, T1.TDSPAID
				, T1.TDSWAIVED
			FROM SETTLEMENTALLOCATIONDTLS T1
			LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE= 'FEE'
			LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
			LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
			LEFT JOIN FEETYPES T5 ON T4.FEETYPEID = T5.FEETYPEID
		]]>
	</createView>
	</changeSet>

	<changeSet id="STLMT#31_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementallocationdtls_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#32_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementallocationdtls_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#32" author="saikiran.n">
		<createView viewName="SETTLEMENTALLOCATIONDTLS_VIEW" replaceIfExists="true">
		<![CDATA[
			SELECT T1.SETTLEMENTHEADERID
				, T1.SETTLEMENTALLOCATIONID
				, T1.ALLOCATIONID
				, T1.ALLOCATIONTYPE
				, T1.ALLOCATIONTO
				, T1.PAIDAMOUNT
				, T1.WAIVEDAMOUNT
				, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
				, T1.PAIDGST
				, T1.WAIVEDREQAMOUNT
				, T1.WAIVERACCEPTED
				, T1.TOTALDUE
				, T1.WAIVEDGST
				, T1.TAXHEADERID
				, T1.TDSDUE
				, T1.TDSPAID
				, T1.TDSWAIVED
			FROM SETTLEMENTALLOCATIONDTLS_TEMP T1
    		LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE = 'FEE'
     		LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
     		LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
    		LEFT JOIN FEETYPES T5 ON  T4.FEETYPEID = T5.FEETYPEID
			UNION ALL
			SELECT T1.SETTLEMENTHEADERID
				, T1.SETTLEMENTALLOCATIONID
				, T1.ALLOCATIONID
				, T1.ALLOCATIONTYPE
				, T1.ALLOCATIONTO
				, T1.PAIDAMOUNT
				, T1.WAIVEDAMOUNT
				, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
				, T1.PAIDGST
				, T1.WAIVEDREQAMOUNT
				, T1.WAIVERACCEPTED
				, T1.TOTALDUE
				, T1.WAIVEDGST
				, T1.TAXHEADERID
				, T1.TDSDUE
				, T1.TDSPAID
				, T1.TDSWAIVED
   			FROM SETTLEMENTALLOCATIONDTLS T1
     		LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE = 'FEE'
     		LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
     		LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
   			LEFT JOIN FEETYPES T5 ON  T4.FEETYPEID = T5.FEETYPEID
			WHERE  NOT EXISTS (SELECT 1 FROM SETTLEMENTALLOCATIONDTLS_TEMP WHERE SETTLEMENTALLOCATIONDTLS_TEMP.SETTLEMENTALLOCATIONID = T1.SETTLEMENTALLOCATIONID)
		]]>
	</createView>
	</changeSet>

	<changeSet id="STLMT#32_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'settlementallocationdtls_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#33" author="Shanakr.M">
		<comment>New Sequence for settlement Table</comment>
		<createSequence sequenceName="SEQSETTLEMENTSCHEDULE" incrementBy="1" startValue="1" minValue="1"
			maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="STLMT#34" author="saikiran.n">
		<comment>New Table for settlement Schedule Details</comment>
		<createTable tableName="SettlementSchedule">
			<column name="SettlementHeaderID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementDetailID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementInstalDate" type="datetime" />
			<column name="settlementAmount" type="Decimal(18,0)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="STLMT#35" author="saikiran.n">
		<addForeignKeyConstraint constraintName="FK_StlmtSchdl_HdrID"
			referencedTableName="FINSETTLEMENTHEADER" referencedColumnNames="SettlementHeaderID"
			baseTableName="SettlementSchedule" baseColumnNames="SettlementHeaderID" />
	</changeSet>

	<changeSet id="STLMT#36" author="saikiran.n">
		<addPrimaryKey tableName="SettlementSchedule" columnNames="settlementDetailID"
			constraintName="PK_SettlementSchedule" />
	</changeSet>

	<changeSet id="STLMT#37" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="settlementAmount" tableName="SettlementSchedule" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#37" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SETTLEMENTSCHEDULE ADD CONSTRAINT DF_STLMTSCH_SETTLEMENTAMOUNT DEFAULT 0 FOR SETTLEMENTAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#38" author="saikiran.n">
		<comment>New Temp Table for settlement Schedule Details</comment>
		<createTable tableName="SettlementSchedule_Temp">
			<column name="SettlementHeaderID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementDetailID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementInstalDate" type="datetime" />
			<column name="settlementAmount" type="Decimal(18,0)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="STLMT#39" author="saikiran.n">
		<addPrimaryKey tableName="SettlementSchedule_Temp" columnNames="settlementDetailID"
			constraintName="PKT_SettlementSchedule" />
	</changeSet>

	<changeSet id="STLMT#40" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="settlementAmount" tableName="SettlementSchedule_Temp" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#40" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SETTLEMENTSCHEDULE_TEMP ADD CONSTRAINT DF_STLMTSCHTEMP_STLNTAMNT DEFAULT 0 FOR SETTLEMENTAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#41_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlementschedule_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#41" author="saikiran.n">
		<createView viewName="SETTLEMENTSCHEDULE_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					, T1.SETTLEMENTDETAILID
					, T1.SETTLEMENTINSTALDATE
					, T1.SETTLEMENTAMOUNT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTSCHEDULE T1
			]]>
	</createView>
	</changeSet>

	<changeSet id="STLMT#41_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'settlementschedule_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#42_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlementschedule_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#42" author="saikiran.n">
		<createView viewName="SETTLEMENTSCHEDULE_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					, T1.SETTLEMENTDETAILID
					, T1.SETTLEMENTINSTALDATE
					, T1.SETTLEMENTAMOUNT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTSCHEDULE_TEMP T1
				UNION ALL
				SELECT T1.SETTLEMENTHEADERID
					, T1.SETTLEMENTDETAILID
					, T1.SETTLEMENTINSTALDATE
					, T1.SETTLEMENTAMOUNT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTSCHEDULE T1
				WHERE NOT EXISTS ( SELECT 1 FROM SETTLEMENTSCHEDULE_TEMP WHERE SETTLEMENTDETAILID = T1.SETTLEMENTDETAILID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="STLMT#42_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementschedule_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.40_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementschedule_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.40" author="saikiran.n">
		<createView viewName="SETTLEMENTSCHEDULE_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					, T1.SETTLEMENTDETAILID
					, T1.SETTLEMENTINSTALDATE
					, T1.SETTLEMENTAMOUNT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTSCHEDULE_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="DE#267.40_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementschedule_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.17" author="saikiran.n">
		<addColumn tableName="FINANCEMAIN">
			<column name="underSettlement" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="DE#267.18" author="saikiran.n">
		<addColumn tableName="FINANCEMAIN_TEMP">
			<column name="underSettlement" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="DE#267.19" author="saikiran.n">
		<sql>
			<![CDATA[
				UPDATE FINANCEMAIN_TEMP SET UNDERSETTLEMENT=0 WHERE UNDERSETTLEMENT IS NULL;
				UPDATE FINANCEMAIN SET UNDERSETTLEMENT=0 WHERE UNDERSETTLEMENT IS NULL;
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.20" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="underSettlement" tableName="FINANCEMAIN_TEMP" defaultValue="0" />
		<addDefaultValue columnName="underSettlement" tableName="FINANCEMAIN" defaultValue="0" />
	</changeSet>

	<changeSet id="DE#267.21" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FINANCEMAIN_TEMP ADD CONSTRAINT DF_F_T_UNDERSETT DEFAULT 0 FOR UNDERSETTLEMENT;
				ALTER TABLE FINANCEMAIN ADD CONSTRAINT DF_F_UNDERSETT DEFAULT 0 FOR UNDERSETTLEMENT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.22_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'financemain_lview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.22" author="saikiran.n">
		<createView viewName="FINANCEMAIN_LVIEW" replaceIfExists="true">
			<![CDATA[
		 		SELECT T1.FINID
		 			, T1.FINREFERENCE
					, T1.INVESTMENTREF
					, T1.FINTYPE
					, T1.FINCCY
					, T1.FINAMOUNT
					, T1.DOWNPAYMENT
					, T1.FEECHARGEAMT
					, T1.SCHEDULEMETHOD
					, T1.NUMBEROFTERMS
					, T1.RECORDSTATUS
					, T1.RECORDTYPE
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.FINBRANCH
					, T1.FINCONTRACTDATE
					, T1.LINKEDFINREF
					, T1.NEXTUSERID
					, T1.PRIORITY
					, T1.WORKFLOWID
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.FINPREAPPROVEDREF
					, T1.RCDMAINTAINSTS
					, T1.FINCURRASSETVALUE
					, T1.CALTERMS
					, T1.DEVIATIONAPPROVAL
					, T1.FINPURPOSE
					, T1.INITIATEDATE
					, T1.FINASSETVALUE
					, T2.CUSTCIF LOVDESCCUSTCIF
					, T2.CUSTSHRTNAME LOVDESCCUSTSHRTNAME
					, T2.CUSTPASSPORTNO LOVDESCCUSTPASSPORTNO
					, T2.CUSTDOB LOVDESCCUSTDOB
					, T2.CUSTCRCPR LOVDESCCUSTCRCPR
					, T2.PHONENUMBER
					, T3.FINCATEGORY LOVDESCPRODUCTCODENAME
					, T3.FINDIVISION LOVDESCFINDIVISION
					, T3.PRODUCT LOVDESCFINPRODUCT
					, T3.FINTYPEDESC LOVDESCFINTYPENAME
					, COALESCE(T4.ROLEDESC, ${add.schema}FN_GET_ROLEDESC(T1.NEXTROLECODE)) LOVDESCREQUESTSTAGE
					, T1.SAMPLINGREQUIRED
					, T1.ADVANCEEMI
					, T1.ADVEMITERMS
					, T1.BPIPFTDAYSBASIS
					, T1.GRACETERMS
					, T1.PRODUCTCATEGORY
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T1.OFFERID
					, T1.APPLICATIONNO
					, T1.LASTMNTON
					, T1.VERSION
					, T1.TDSAPPLICABLE
					, T2.CUSTID
					, T1.INSTBASEDSCHD
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T5.DEALERNAME MANUFACTURERDEALERNAME
					, T5.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN_TEMP T1
				INNER JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
				INNER JOIN RMTFINANCETYPES T3 ON T3.FINTYPE = T1.FINTYPE
				LEFT JOIN SECROLES T4 ON T1.NEXTROLECODE= T4.ROLECD
				LEFT JOIN AMTVEHICLEDEALER T5 ON T1.MANUFACTURERDEALERID = T5.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
			]]>
		</createView>
	</changeSet>

	<changeSet id="DE#267.22_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_lview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.23_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'financemain_aview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.23" author="saikiran.n">
		<createView viewName="FINANCEMAIN_AVIEW" replaceIfExists="true">
			 <![CDATA[ 
				SELECT T1.FINID
					, T1.FINREFERENCE
			    	, T1.INVESTMENTREF
			    	, T1.NUMBEROFTERMS
			    	, T1.GRCPERIODENDDATE
			    	, T1.ALLOWGRCPERIOD
			    	, T1.GRACEBASERATE
			    	, T1.GRACESPECIALRATE
			    	, T1.GRCPFTRATE
			    	, T1.GRCPFTFRQ
			    	, T1.NEXTGRCPFTDATE
			    	, T1.ALLOWGRCPFTRVW
			    	, T1.GRCPFTRVWFRQ
			    	, T1.NEXTGRCPFTRVWDATE
			    	, T1.ALLOWGRCCPZ
			    	, T1.GRCCPZFRQ
			    	, T1.NEXTGRCCPZDATE
			    	, T1.REPAYBASERATE
			    	, T1.REPAYSPECIALRATE
			    	, T1.REPAYPROFITRATE
			    	, T1.REPAYFRQ
			    	, T1.NEXTREPAYDATE
			    	, T1.REPAYPFTFRQ
			    	, T1.NEXTREPAYPFTDATE
			    	, T1.ALLOWREPAYRVW
			    	, T1.REPAYRVWFRQ
			    	, T1.NEXTREPAYRVWDATE
			    	, T1.ALLOWREPAYCPZ
			    	, T1.REPAYCPZFRQ
			    	, T1.NEXTREPAYCPZDATE
			    	, T1.MATURITYDATE
			    	, T1.CPZATGRACEEND
			    	, T1.DOWNPAYMENT
			    	, T1.GRACEFLATAMOUNT
			    	, T1.REQREPAYAMOUNT
			    	, T1.TOTALPROFIT
			    	, T1.TOTALCPZ
			    	, T1.TOTALGROSSPFT
			    	, T1.TOTALGROSSGRCPFT
			    	, T1.TOTALGRACEPFT
			    	, T1.TOTALGRACECPZ
			    	, T1.GRCRATEBASIS
			    	, T1.REPAYRATEBASIS
			    	, T1.FINTYPE
			    	, T1.FINREMARKS
			    	, T1.FINCCY
			    	, T1.SCHEDULEMETHOD
			    	, T1.PROFITDAYSBASIS
			    	, T1.REQMATURITY
			    	, T1.CALTERMS
			    	, T1.CALMATURITY
			    	, T1.FIRSTREPAY
			    	, T1.LASTREPAY
			    	, T1.FINSTARTDATE
			    	, T1.FINAMOUNT
					, T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT LOVDESCFINANCINGAMOUNT
			    	, T1.FINREPAYMENTAMOUNT
			    	, T1.CUSTID
			   		, T1.DEFFERMENTS
			    	, T1.PLANDEFERCOUNT
			    	, T1.FINBRANCH
			    	, T1.FINSOURCEID
			    	, T1.ALLOWEDDEFRPYCHANGE
			    	, T1.AVAILEDDEFRPYCHANGE
			    	, T1.ALLOWEDDEFFRQCHANGE
			    	, T1.AVAILEDDEFFRQCHANGE
			    	, T1.RECALTYPE
			    	, T1.FINASSETVALUE
			    	, T1.FINISACTIVE
			    	, T1.LIMITVALID
			    	, T1.OVERRIDELIMIT
			    	, T1.VERSION
			    	, T1.LASTMNTBY
			    	, T1.LASTMNTON
			    	, T1.RECORDSTATUS
			    	, T1.ROLECODE
			    	, T1.NEXTROLECODE
			    	, T1.TASKID
			    	, T1.NEXTTASKID
			    	, T1.RECORDTYPE
			    	, T1.WORKFLOWID
					, T7.FINTYPEDESC LOVDESCFINTYPENAME
					, T7.FINMAXAMOUNT LOVDESCFINMAXAMT
					, T7.FINMINAMOUNT LOVDESCFINMINAMOUNT
			    	, T1.MINDOWNPAYPERC
					, T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT
					, T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ
					, T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT
					, T12.BRANCHDESC LOVDESCFINBRANCHNAME
					, T12.BRANCHPROVINCE FINBRANCHPROVINCECODE
			    	, T1.LASTREPAYDATE
			    	, T1.LASTREPAYPFTDATE
			    	, T1.LASTREPAYRVWDATE
			    	, T1.LASTREPAYCPZDATE
			    	, T1.ALLOWGRCREPAY
			    	, T1.GRCSCHDMTHD
			    	, T1.GRCMARGIN
			    	, T1.REPAYMARGIN
			    	, T1.FINCURRASSETVALUE
			    	, T1.FINCOMMITMENTREF
			    	, T1.FINLIMITREF
			    	, T1.FINCONTRACTDATE
					, T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD
			    	, T7.FINRVWRATEAPPLFOR
			    	, T1.TOTALREPAYAMT
			    	, T1.CLOSINGSTATUS
			    	, T1.FINAPPROVEDDATE
			    	, T1.FEECHARGEAMT
			    	, T1.BLACKLISTED
			    	, T1.FINREPAYPFTONFRQ
			    	, T1.ANUALIZEDPERCRATE
			    	, T1.EFFECTIVERATEOFRETURN
			    	, T1.MIGRATEDFINANCE
			    	, T1.SCHEDULEMAINTAINED
			    	, T1.SCHEDULEREGENERATED
			    	, T1.FINPURPOSE
					, T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME
			    	, T1.FINSTATUS
			    	, T1.FINSTSREASON
			    	, T1.INITIATEUSER
					, T7.FINSCHEDULEON LOVDESCFINSCHEDULEON
			    	, T1.CUSTDSR
			    	, T1.JOINTACCOUNT
			    	, T1.JOINTCUSTID
			    	, T1.DOWNPAYBANK
			    	, T1.DOWNPAYSUPL
			    	, T1.SECURITYCOLLATERAL
			    	, T1.APPROVED
			    	, T1.DISCREPANCY
			    	, T1.LIMITAPPROVED
			    	, T1.GRACETERMS
					, T7.FINDIVISION LOVDESCFINDIVISION
			    	, T1.RCDMAINTAINSTS
			    	, T1.FINREPAYMETHOD
			    	, T1.GRCPROFITDAYSBASIS
			    	, T1.STEPFINANCE
			    	, T1.STEPTYPE
				    , T1.STEPPOLICY
				    , T1.ALWMANUALSTEPS
				    , T1.NOOFSTEPS
				    , T1.LINKEDFINREF
				    , T1.NEXTUSERID
				    , T1.PRIORITY
					, T24.POLICYDESC LOVDESCSTEPPOLICYNAME
				    , T1.GRCMINRATE
				    , T1.GRCMAXRATE
				    , T1.RPYMINRATE
				    , T1.RPYMAXRATE
				    , T1.DEVIATIONAPPROVAL
				    , T1.MANUALSCHEDULE
				    , T1.CREDITINSAMT
				    , T27.CUSTSTSDESCRIPTION
				    , T1.INITIATEDATE
				    , T1.FINPREAPPROVEDREF
				    , T1.ACCOUNTSOFFICER
					, T28.DEALERNAME LOVDESCACCOUNTSOFFICER
					, T28.DEALERCITY LOVDESCSOURCECITY
				    , T1.DSACODE
					, T30.ROFFICERDESC DSACODEDESC
				    , T1.TDSAPPLICABLE
				    , T1.MANDATEID
				    , T1.DROPLINEFRQ
				    , T1.FIRSTDROPLINEDATE
				    , T1.PFTSERVICINGODLIMIT
				    , T1.ALWBPI
				    , T1.BPITREATMENT
				    , T1.PLANEMIHALW
				    , T1.PLANEMIHMETHOD
				    , T1.PLANEMIHMAXPERYEAR
				    , T1.PLANEMIHMAX
				    , T1.PLANEMIHLOCKPERIOD
				    , T1.PLANEMICPZ
				    , T1.CALROUNDINGMODE
				    , T1.ALWMULTIDISB
				    , T1.APPLICATIONNO
				    , T1.REFERRALID
					, T33.ROFFICERDESC REFERRALIDDESC
				    , T1.DMACODE
					, T34.ROFFICERDESC DMACODEDESC
				    , T1.SALESDEPARTMENT
					, T35.DEPTDESC SALESDEPARTMENTDESC
				    , T1.QUICKDISB
				    , T1.WIFREFERENCE
				    , T1.UNPLANEMIHLOCKPERIOD
				    , T1.UNPLANEMICPZ
				    , T1.REAGECPZ
				    , T1.MAXUNPLANNEDEMI
				    , T1.MAXREAGEHOLIDAYS
				    , T1.AVAILEDUNPLANEMI
				    , T1.AVAILEDREAGEH
				    , T1.BPIAMOUNT
				    , T1.DEDUCTFEEDISB
				    , T1.RVWRATEAPPLFOR
				    , T1.SCHCALONRVW
				    , T1.PASTDUEPFTCALMTHD
				    , T1.PASTDUEPFTMARGIN
				    , T1.DROPPINGMETHOD
				    , T1.RATECHGANYDAY
				    , T1.PROMOTIONCODE
				    , T1.RESTRUCTURELOAN
				    , T1.OLDFINREFERENCE
				    , T1.REAGEBUCKET
				    , T1.FINCATEGORY
				    , T1.PRODUCTCATEGORY
				    , T1.ROUNDINGTARGET
					, T36.ENTITYCODE LOVDESCENTITYCODE
				    , T1.ELIGIBILITYMETHOD
					, T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD
					, T38.VALUEDESC LOVDESCELIGIBILITYMETHOD
				    , T1.EMPLOYEENAME
					, T37.ROFFICERDESC EMPLOYEENAMEDESC
				    , T1.SAMPLINGREQUIRED
				    , T1.LEGALREQUIRED
				    , T1.GRCMAXAMOUNT
				    , T1.CONNECTOR
					, T40.DEALERNAME CONNECTORCODE
					, T40.DEALERCITY CONNECTORDESC
				    , T1.ADVANCEEMI
				    , T1.ADVEMITERMS
				    , T1.BPIPFTDAYSBASIS
				    , T1.FIXEDRATETENOR
				    , T1.FIXEDTENORRATE
					, T12.BRANCHTEL FINBRANCHCONTACT
				    , T1.PROCESSATTRIBUTES
				    , T1.BUSINESSVERTICAL
					, BV.CODE BUSINESSVERTICALCODE
					, BV.DESCRIPTION BUSINESSVERTICALDESC
				    , T1.GRCADVTYPE
				    , T1.GRCADVTERMS
				    , T1.ADVTYPE
				    , T1.ADVTERMS
				    , T1.ADVSTAGE
				    , T1.TDSPERCENTAGE
				    , T1.TDSSTARTDATE
				    , T1.TDSENDDATE
				    , T1.TDSLIMITAMT
				    , T1.VANREQ
				    , T1.VANCODE
				    , T1.ALLOWDRAWINGPOWER
				    , T1.ALLOWREVOLVING
				    , T1.SANBSDSCHDLE
				    , T1.PROMOTIONSEQID
				    , T1.SVAMOUNT
				    , T1.CBAMOUNT
				    , T1.APPLIEDLOANAMT
				    , T1.FINISRATERVWATGRCEND
				    , T1.PLANEMIHALWINGRACE
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T13.BRANCHDESC LOVDESCSOURCINGBRANCH
					, T1.ENDGRCPERIODAFTRFULLDISB
					, T1.AUTOINCGRCENDDATE
					, T1.ALWGRCADJ
					, T1.PMAY
					, T1.OFFERID
					, T1.ALWLOANSPLIT
					, T1.PARENTREF
					, T1.LOANSPLITTED
					, T1.INSTBASEDSCHD
					, C.CUSTCIF LOVDESCCUSTCIF
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T41.DEALERNAME MANUFACTURERDEALERNAME
					, T41.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T17.NOINST
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				INNER JOIN CUSTOMERS C ON C.CUSTID = T1.CUSTID
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
			]]>
		</createView>
	</changeSet>


	<changeSet id="DE#267.23_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.24_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.24" author="saikiran.n">
		<createView viewName="FINANCEMAIN_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINID
					, T1.FINREFERENCE
				    , T1.INVESTMENTREF
				    , T1.NUMBEROFTERMS
				    , T1.GRCPERIODENDDATE
				    , T1.ALLOWGRCPERIOD
				    , T1.GRACEBASERATE
				    , T1.GRACESPECIALRATE
				    , T1.GRCPFTRATE
				    , T1.GRCPFTFRQ
				    , T1.NEXTGRCPFTDATE
				    , T1.ALLOWGRCPFTRVW
				    , T1.GRCPFTRVWFRQ
				    , T1.NEXTGRCPFTRVWDATE
				    , T1.ALLOWGRCCPZ
				    , T1.GRCCPZFRQ
				    , T1.NEXTGRCCPZDATE
				    , T1.REPAYBASERATE
				    , T1.REPAYSPECIALRATE
				    , T1.REPAYPROFITRATE
				    , T1.REPAYFRQ
				    , T1.NEXTREPAYDATE
				    , T1.REPAYPFTFRQ
				    , T1.NEXTREPAYPFTDATE
				    , T1.ALLOWREPAYRVW
				    , T1.REPAYRVWFRQ
				    , T1.NEXTREPAYRVWDATE
				    , T1.ALLOWREPAYCPZ
				    , T1.REPAYCPZFRQ
				    , T1.NEXTREPAYCPZDATE
				    , T1.MATURITYDATE
				    , T1.CPZATGRACEEND
				    , T1.DOWNPAYMENT
				    , T1.GRACEFLATAMOUNT
				    , T1.REQREPAYAMOUNT
				    , T1.TOTALPROFIT
				    , T1.TOTALCPZ
				    , T1.TOTALGROSSPFT
				    , T1.TOTALGROSSGRCPFT
				    , T1.TOTALGRACEPFT
				    , T1.TOTALGRACECPZ
				    , T1.GRCRATEBASIS
				    , T1.REPAYRATEBASIS
				    , T1.FINTYPE
				    , T1.FINREMARKS
				    , T1.FINCCY
				    , T1.SCHEDULEMETHOD
				    , T1.PROFITDAYSBASIS
				    , T1.REQMATURITY
				    , T1.CALTERMS
				    , T1.CALMATURITY
				    , T1.FIRSTREPAY
				    , T1.LASTREPAY
				    , T1.FINSTARTDATE
				    , T1.FINAMOUNT
					, ((T1.FINAMOUNT + T1.FEECHARGEAMT) - T1.DOWNPAYMENT) LOVDESCFINANCINGAMOUNT
				    , T1.FINREPAYMENTAMOUNT
				    , T1.CUSTID
				    , T1.DEFFERMENTS
				    , T1.PLANDEFERCOUNT
				    , T1.FINBRANCH
				    , T1.FINSOURCEID
				    , T1.ALLOWEDDEFRPYCHANGE
				    , T1.AVAILEDDEFRPYCHANGE
				    , T1.ALLOWEDDEFFRQCHANGE
				    , T1.AVAILEDDEFFRQCHANGE
				    , T1.RECALTYPE
				    , T1.FINASSETVALUE
				    , T1.FINISACTIVE
				    , T1.LIMITVALID
				    , T1.OVERRIDELIMIT
				    , T1.VERSION
				    , T1.LASTMNTBY
				    , T1.LASTMNTON
				    , T1.RECORDSTATUS
				    , T1.ROLECODE
				    , T1.NEXTROLECODE
				    , T1.TASKID
				    , T1.NEXTTASKID
				    , T1.RECORDTYPE
				    , T1.WORKFLOWID
				    , T7.FINTYPEDESC LOVDESCFINTYPENAME
				    , T7.FINMAXAMOUNT LOVDESCFINMAXAMT
				    , T7.FINMINAMOUNT LOVDESCFINMINAMOUNT
				    , T1.MINDOWNPAYPERC
				    , T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT
				    , T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ
				    , T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT
				    , T12.BRANCHDESC LOVDESCFINBRANCHNAME
				    , T12.BRANCHPROVINCE FINBRANCHPROVINCECODE
				    , T1.LASTREPAYDATE
				    , T1.LASTREPAYPFTDATE
				    , T1.LASTREPAYRVWDATE
				    , T1.LASTREPAYCPZDATE
				    , T1.ALLOWGRCREPAY
				    , T1.GRCSCHDMTHD
				    , T1.GRCMARGIN
				    , T1.REPAYMARGIN
				    , T1.FINCURRASSETVALUE
				    , T1.FINCOMMITMENTREF
				    , T1.FINLIMITREF
				    , T1.FINCONTRACTDATE
				    , T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD
				    , T7.FINRVWRATEAPPLFOR
				    , T1.TOTALREPAYAMT
				    , T1.CLOSINGSTATUS
				    , T1.FINAPPROVEDDATE
				    , T1.FEECHARGEAMT
				    , T1.BLACKLISTED
				    , T1.FINREPAYPFTONFRQ
				    , T1.ANUALIZEDPERCRATE
				    , T1.EFFECTIVERATEOFRETURN
				    , T1.MIGRATEDFINANCE
				    , T1.SCHEDULEMAINTAINED
				    , T1.SCHEDULEREGENERATED
				    , T1.FINPURPOSE
				    , T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME
				    , T1.FINSTATUS
				    , T1.FINSTSREASON
				    , T1.INITIATEUSER
				    , T7.FINSCHEDULEON LOVDESCFINSCHEDULEON
				    , T1.CUSTDSR
				    , T1.JOINTACCOUNT
				    , T1.JOINTCUSTID
				    , T1.DOWNPAYBANK
				    , T1.DOWNPAYSUPL
				    , T1.SECURITYCOLLATERAL
				    , T1.APPROVED
				    , T1.DISCREPANCY
				    , T1.LIMITAPPROVED
				    , T1.GRACETERMS
				    , T7.FINDIVISION LOVDESCFINDIVISION
				    , T1.RCDMAINTAINSTS
				    , T1.FINREPAYMETHOD
				    , T1.GRCPROFITDAYSBASIS
				    , T1.STEPFINANCE
				    , T1.STEPTYPE
				    , T1.STEPPOLICY
				    , T1.ALWMANUALSTEPS
				    , T1.NOOFSTEPS
				    , T1.LINKEDFINREF
				    , T1.NEXTUSERID
				    , T1.PRIORITY
				    , T24.POLICYDESC LOVDESCSTEPPOLICYNAME
				    , T1.GRCMINRATE
				    , T1.GRCMAXRATE
				    , T1.RPYMINRATE
				    , T1.RPYMAXRATE
				    , T1.DEVIATIONAPPROVAL
				    , T1.MANUALSCHEDULE
				    , T1.CREDITINSAMT
				    , T27.CUSTSTSDESCRIPTION
				    , T1.INITIATEDATE
				    , T1.FINPREAPPROVEDREF
				    , T1.ACCOUNTSOFFICER
				    , T28.DEALERNAME LOVDESCACCOUNTSOFFICER
				    , T28.DEALERCITY LOVDESCSOURCECITY
				    , T1.DSACODE
				    , T30.ROFFICERDESC DSACODEDESC
				    , T1.TDSAPPLICABLE
				    , T1.MANDATEID
				    , T1.DROPLINEFRQ
				    , T1.FIRSTDROPLINEDATE
				    , T1.PFTSERVICINGODLIMIT
				    , T1.ALWBPI
				    , T1.BPITREATMENT
				    , T1.PLANEMIHALW
				    , T1.PLANEMIHMETHOD
				    , T1.PLANEMIHMAXPERYEAR
				    , T1.PLANEMIHMAX
				    , T1.PLANEMIHLOCKPERIOD
				    , T1.PLANEMICPZ
				    , T1.CALROUNDINGMODE
				    , T1.ALWMULTIDISB
				    , T1.APPLICATIONNO
				    , T1.REFERRALID
				    , T33.ROFFICERDESC REFERRALIDDESC
				    , T1.DMACODE
				    , T34.ROFFICERDESC DMACODEDESC
				    , T1.SALESDEPARTMENT
				    , T35.DEPTDESC SALESDEPARTMENTDESC
				    , T1.QUICKDISB
				    , T1.WIFREFERENCE
				    , T1.UNPLANEMIHLOCKPERIOD
				    , T1.UNPLANEMICPZ
				    , T1.REAGECPZ
				    , T1.MAXUNPLANNEDEMI
				    , T1.MAXREAGEHOLIDAYS
				    , T1.AVAILEDUNPLANEMI
				    , T1.AVAILEDREAGEH
				    , T1.BPIAMOUNT
				    , T1.DEDUCTFEEDISB
				    , T1.RVWRATEAPPLFOR
				    , T1.SCHCALONRVW
				    , T1.PASTDUEPFTCALMTHD
				    , T1.PASTDUEPFTMARGIN
				    , T1.DROPPINGMETHOD
				    , T1.RATECHGANYDAY
				    , T1.PROMOTIONCODE
				    , T1.RESTRUCTURELOAN
				    , T1.OLDFINREFERENCE
				    , T1.REAGEBUCKET
				    , T1.FINCATEGORY
				    , T1.PRODUCTCATEGORY
				    , T1.ROUNDINGTARGET
				    , T36.ENTITYCODE LOVDESCENTITYCODE
				    , T1.ELIGIBILITYMETHOD
				    , T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD
				    , T38.VALUEDESC LOVDESCELIGIBILITYMETHOD
				    , T1.EMPLOYEENAME
				    , T37.ROFFICERDESC EMPLOYEENAMEDESC
				    , T1.SAMPLINGREQUIRED
				    , T1.LEGALREQUIRED
				    , T1.GRCMAXAMOUNT
				    , T1.CONNECTOR
				    , T40.DEALERNAME CONNECTORCODE
				    , T40.DEALERCITY CONNECTORDESC
				    , T1.ADVANCEEMI
				    , T1.ADVEMITERMS
				    , T1.BPIPFTDAYSBASIS
				    , T1.FIXEDRATETENOR
				    , T1.FIXEDTENORRATE
				    , T12.BRANCHTEL FINBRANCHCONTACT
				    , T1.PROCESSATTRIBUTES
				    , T1.BUSINESSVERTICAL
				    , BV.CODE BUSINESSVERTICALCODE
				    , BV.DESCRIPTION BUSINESSVERTICALDESC
				    , T1.GRCADVTYPE
				    , T1.GRCADVTERMS
				    , T1.ADVTYPE
				    , T1.ADVTERMS
				    , T1.ADVSTAGE
				    , T1.TDSPERCENTAGE
				    , T1.TDSSTARTDATE
				    , T1.TDSENDDATE
				    , T1.TDSLIMITAMT
				    , T1.VANREQ
				    , T1.VANCODE
				    , T1.ALLOWDRAWINGPOWER
				    , T1.ALLOWREVOLVING
				    , T1.SANBSDSCHDLE
				    , T1.PROMOTIONSEQID
				    , T1.SVAMOUNT
				    , T1.CBAMOUNT
				    , T1.APPLIEDLOANAMT
				    , T1.FINISRATERVWATGRCEND
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T13.BRANCHDESC LOVDESCSOURCINGBRANCH
					, T1.OFFERID
					, T1.ALWGRCADJ
					, T1.ENDGRCPERIODAFTRFULLDISB
					, T1.AUTOINCGRCENDDATE
					, T1.PMAY
					, T1.ALWLOANSPLIT
					, T1.PARENTREF
					, T1.LOANSPLITTED
					, T1.INSTBASEDSCHD
					, T1.PLANEMIHALWINGRACE
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T41.DEALERNAME MANUFACTURERDEALERNAME
					, T41.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN_TEMP T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE  = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
				UNION ALL
				SELECT T1.FINID
					, T1.FINREFERENCE
				    , T1.INVESTMENTREF
				    , T1.NUMBEROFTERMS
				    , T1.GRCPERIODENDDATE
				    , T1.ALLOWGRCPERIOD
				    , T1.GRACEBASERATE
				    , T1.GRACESPECIALRATE
				    , T1.GRCPFTRATE
				    , T1.GRCPFTFRQ
				    , T1.NEXTGRCPFTDATE
				    , T1.ALLOWGRCPFTRVW
				    , T1.GRCPFTRVWFRQ
				    , T1.NEXTGRCPFTRVWDATE
				    , T1.ALLOWGRCCPZ
				    , T1.GRCCPZFRQ
				    , T1.NEXTGRCCPZDATE
				    , T1.REPAYBASERATE
				    , T1.REPAYSPECIALRATE
				    , T1.REPAYPROFITRATE
				    , T1.REPAYFRQ
				    , T1.NEXTREPAYDATE
				    , T1.REPAYPFTFRQ
				    , T1.NEXTREPAYPFTDATE
				    , T1.ALLOWREPAYRVW
				    , T1.REPAYRVWFRQ
				    , T1.NEXTREPAYRVWDATE
				    , T1.ALLOWREPAYCPZ
				    , T1.REPAYCPZFRQ
				    , T1.NEXTREPAYCPZDATE
				    , T1.MATURITYDATE
				    , T1.CPZATGRACEEND
				    , T1.DOWNPAYMENT
				    , T1.GRACEFLATAMOUNT
				    , T1.REQREPAYAMOUNT
				    , T1.TOTALPROFIT
				    , T1.TOTALCPZ
				    , T1.TOTALGROSSPFT
				    , T1.TOTALGROSSGRCPFT
				    , T1.TOTALGRACEPFT
				    , T1.TOTALGRACECPZ
				    , T1.GRCRATEBASIS
				    , T1.REPAYRATEBASIS
				    , T1.FINTYPE
				    , T1.FINREMARKS
				    , T1.FINCCY
				    , T1.SCHEDULEMETHOD
				    , T1.PROFITDAYSBASIS
				    , T1.REQMATURITY
				    , T1.CALTERMS
				    , T1.CALMATURITY
				    , T1.FIRSTREPAY
				    , T1.LASTREPAY
				    , T1.FINSTARTDATE
				    , T1.FINAMOUNT
					, ((T1.FINAMOUNT + T1.FEECHARGEAMT) - T1.DOWNPAYMENT) LOVDESCFINANCINGAMOUNT
				    , T1.FINREPAYMENTAMOUNT
				    , T1.CUSTID
				    , T1.DEFFERMENTS
				    , T1.PLANDEFERCOUNT
				    , T1.FINBRANCH
				    , T1.FINSOURCEID
				    , T1.ALLOWEDDEFRPYCHANGE
				    , T1.AVAILEDDEFRPYCHANGE
				    , T1.ALLOWEDDEFFRQCHANGE
				    , T1.AVAILEDDEFFRQCHANGE
				    , T1.RECALTYPE
				    , T1.FINASSETVALUE
				    , T1.FINISACTIVE
				    , T1.LIMITVALID
				    , T1.OVERRIDELIMIT
				    , T1.VERSION
				    , T1.LASTMNTBY
				    , T1.LASTMNTON
				    , T1.RECORDSTATUS
				    , T1.ROLECODE
				    , T1.NEXTROLECODE
				    , T1.TASKID
				    , T1.NEXTTASKID
				    , T1.RECORDTYPE
				    , T1.WORKFLOWID
				    , T7.FINTYPEDESC LOVDESCFINTYPENAME
				    , T7.FINMAXAMOUNT LOVDESCFINMAXAMT
				    , T7.FINMINAMOUNT LOVDESCFINMINAMOUNT
				    , T1.MINDOWNPAYPERC
				    , T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT
				    , T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ
				    , T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT
				    , T12.BRANCHDESC LOVDESCFINBRANCHNAME
				    , T12.BRANCHPROVINCE FINBRANCHPROVINCECODE
				    , T1.LASTREPAYDATE
				    , T1.LASTREPAYPFTDATE
				    , T1.LASTREPAYRVWDATE
				    , T1.LASTREPAYCPZDATE
				    , T1.ALLOWGRCREPAY
				    , T1.GRCSCHDMTHD
				    , T1.GRCMARGIN
				    , T1.REPAYMARGIN
				    , T1.FINCURRASSETVALUE
				    , T1.FINCOMMITMENTREF
				    , T1.FINLIMITREF
				    , T1.FINCONTRACTDATE
				    , T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD
				    , T7.FINRVWRATEAPPLFOR
				    , T1.TOTALREPAYAMT
				    , T1.CLOSINGSTATUS
				    , T1.FINAPPROVEDDATE
				    , T1.FEECHARGEAMT
				    , T1.BLACKLISTED
				    , T1.FINREPAYPFTONFRQ
				    , T1.ANUALIZEDPERCRATE
				    , T1.EFFECTIVERATEOFRETURN
				    , T1.MIGRATEDFINANCE
				    , T1.SCHEDULEMAINTAINED
				    , T1.SCHEDULEREGENERATED
				    , T1.FINPURPOSE
				    , T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME
				    , T1.FINSTATUS
				    , T1.FINSTSREASON
				    , T1.INITIATEUSER
				    , T7.FINSCHEDULEON LOVDESCFINSCHEDULEON
				    , T1.CUSTDSR
				    , T1.JOINTACCOUNT
				    , T1.JOINTCUSTID
				    , T1.DOWNPAYBANK
				    , T1.DOWNPAYSUPL
				    , T1.SECURITYCOLLATERAL
				    , T1.APPROVED
				    , T1.DISCREPANCY
				    , T1.LIMITAPPROVED
				    , T1.GRACETERMS
				    , T7.FINDIVISION LOVDESCFINDIVISION
				    , T1.RCDMAINTAINSTS
				    , T1.FINREPAYMETHOD
				    , T1.GRCPROFITDAYSBASIS
				    , T1.STEPFINANCE
				    , T1.STEPTYPE
				    , T1.STEPPOLICY
				    , T1.ALWMANUALSTEPS
				    , T1.NOOFSTEPS
				    , T1.LINKEDFINREF
				    , T1.NEXTUSERID
				    , T1.PRIORITY
				    , T24.POLICYDESC LOVDESCSTEPPOLICYNAME
				    , T1.GRCMINRATE
				    , T1.GRCMAXRATE
				    , T1.RPYMINRATE
				    , T1.RPYMAXRATE
				    , T1.DEVIATIONAPPROVAL
				    , T1.MANUALSCHEDULE
				    , T1.CREDITINSAMT
				    , T27.CUSTSTSDESCRIPTION
				    , T1.INITIATEDATE
				    , T1.FINPREAPPROVEDREF
				    , T1.ACCOUNTSOFFICER
				    , T28.DEALERNAME LOVDESCACCOUNTSOFFICER
				    , T28.DEALERCITY LOVDESCSOURCECITY
				    , T1.DSACODE
				    , T30.ROFFICERDESC DSACODEDESC
				    , T1.TDSAPPLICABLE
				    , T1.MANDATEID
				    , T1.DROPLINEFRQ
				    , T1.FIRSTDROPLINEDATE
				    , T1.PFTSERVICINGODLIMIT
				    , T1.ALWBPI
				    , T1.BPITREATMENT
				    , T1.PLANEMIHALW
				    , T1.PLANEMIHMETHOD
				    , T1.PLANEMIHMAXPERYEAR
				    , T1.PLANEMIHMAX
				    , T1.PLANEMIHLOCKPERIOD
				    , T1.PLANEMICPZ
				    , T1.CALROUNDINGMODE
				    , T1.ALWMULTIDISB
				    , T1.APPLICATIONNO
				    , T1.REFERRALID
				    , T33.ROFFICERDESC REFERRALIDDESC
				    , T1.DMACODE
				    , T34.ROFFICERDESC DMACODEDESC
				    , T1.SALESDEPARTMENT
				    , T35.DEPTDESC SALESDEPARTMENTDESC
				    , T1.QUICKDISB
				    , T1.WIFREFERENCE
				    , T1.UNPLANEMIHLOCKPERIOD
				    , T1.UNPLANEMICPZ
				    , T1.REAGECPZ
				    , T1.MAXUNPLANNEDEMI
				    , T1.MAXREAGEHOLIDAYS
				    , T1.AVAILEDUNPLANEMI
				    , T1.AVAILEDREAGEH
				    , T1.BPIAMOUNT
				    , T1.DEDUCTFEEDISB
				    , T1.RVWRATEAPPLFOR
				    , T1.SCHCALONRVW
				    , T1.PASTDUEPFTCALMTHD
				    , T1.PASTDUEPFTMARGIN
				    , T1.DROPPINGMETHOD
				    , T1.RATECHGANYDAY
				    , T1.PROMOTIONCODE
				    , T1.RESTRUCTURELOAN
				    , T1.OLDFINREFERENCE
				    , T1.REAGEBUCKET
				    , T1.FINCATEGORY
				    , T1.PRODUCTCATEGORY
				    , T1.ROUNDINGTARGET
				    , T36.ENTITYCODE LOVDESCENTITYCODE
				    , T1.ELIGIBILITYMETHOD
				    , T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD
				    , T38.VALUEDESC LOVDESCELIGIBILITYMETHOD
				    , T1.EMPLOYEENAME
				    , T37.ROFFICERDESC EMPLOYEENAMEDESC
				    , T1.SAMPLINGREQUIRED
				    , T1.LEGALREQUIRED
				    , T1.GRCMAXAMOUNT
				    , T1.CONNECTOR
				    , T40.DEALERNAME CONNECTORCODE
				    , T40.DEALERCITY CONNECTORDESC
				    , T1.ADVANCEEMI
				    , T1.ADVEMITERMS
				    , T1.BPIPFTDAYSBASIS
				    , T1.FIXEDRATETENOR
				    , T1.FIXEDTENORRATE
				    , T12.BRANCHTEL FINBRANCHCONTACT
				    , T1.PROCESSATTRIBUTES
				    , T1.BUSINESSVERTICAL
				    , BV.CODE BUSINESSVERTICALCODE
				    , BV.DESCRIPTION BUSINESSVERTICALDESC
				    , T1.GRCADVTYPE
				    , T1.GRCADVTERMS
				    , T1.ADVTYPE
				    , T1.ADVTERMS
				    , T1.ADVSTAGE
				    , T1.TDSPERCENTAGE
				    , T1.TDSSTARTDATE
				    , T1.TDSENDDATE
				    , T1.TDSLIMITAMT
				    , T1.VANREQ
				    , T1.VANCODE
				    , T1.ALLOWDRAWINGPOWER
				    , T1.ALLOWREVOLVING
				    , T1.SANBSDSCHDLE
				    , T1.PROMOTIONSEQID
				    , T1.SVAMOUNT
				    , T1.CBAMOUNT
				    , T1.APPLIEDLOANAMT
				    , T1.FINISRATERVWATGRCEND
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T13.BRANCHDESC LOVDESCSOURCINGBRANCH
					, T1.OFFERID
					, T1.ALWGRCADJ
					, T1.ENDGRCPERIODAFTRFULLDISB
					, T1.AUTOINCGRCENDDATE
					, T1.PMAY
					, T1.ALWLOANSPLIT
					, T1.PARENTREF
					, T1.LOANSPLITTED
					, T1.INSTBASEDSCHD
					, T1.PLANEMIHALWINGRACE
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T41.DEALERNAME MANUFACTURERDEALERNAME
					, T41.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE  = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
				WHERE NOT EXISTS (SELECT 1 FROM FINANCEMAIN_TEMP WHERE FINANCEMAIN_TEMP.FINID = T1.FINID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="DE#267.24_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.25_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.25" author="saikiran.n">
		<createView viewName="FINANCEMAIN_TVIEW" replaceIfExists="true">
		    <![CDATA[
				SELECT T1.FINID
					, T1.FINREFERENCE
					, T1.INVESTMENTREF
					, T1.NUMBEROFTERMS
					, T1.GRCPERIODENDDATE
					, T1.ALLOWGRCPERIOD
					, T1.GRACEBASERATE
					, T1.GRACESPECIALRATE
					, T1.GRCPFTRATE
					, T1.GRCPFTFRQ
					, T1.NEXTGRCPFTDATE
					, T1.ALLOWGRCPFTRVW
					, T1.GRCPFTRVWFRQ
					, T1.NEXTGRCPFTRVWDATE
					, T1.ALLOWGRCCPZ
					, T1.GRCCPZFRQ
					, T1.NEXTGRCCPZDATE
					, T1.REPAYBASERATE
					, T1.REPAYSPECIALRATE
					, T1.REPAYPROFITRATE
					, T1.REPAYFRQ
					, T1.NEXTREPAYDATE
					, T1.REPAYPFTFRQ
					, T1.NEXTREPAYPFTDATE
					, T1.ALLOWREPAYRVW
					, T1.REPAYRVWFRQ
					, T1.NEXTREPAYRVWDATE
					, T1.ALLOWREPAYCPZ
					, T1.REPAYCPZFRQ
					, T1.NEXTREPAYCPZDATE
					, T1.MATURITYDATE
					, T1.CPZATGRACEEND
					, T1.DOWNPAYMENT
					, T1.GRACEFLATAMOUNT
					, T1.REQREPAYAMOUNT
					, T1.TOTALPROFIT
					, T1.TOTALCPZ
					, T1.TOTALGROSSPFT
					, T1.TOTALGROSSGRCPFT
					, T1.TOTALGRACEPFT
					, T1.TOTALGRACECPZ
					, T1.GRCRATEBASIS
					, T1.REPAYRATEBASIS
					, T1.FINTYPE
					, T1.FINREMARKS
					, T1.FINCCY
					, T1.SCHEDULEMETHOD
					, T1.PROFITDAYSBASIS
					, T1.REQMATURITY
					, T1.CALTERMS
					, T1.CALMATURITY
					, T1.FIRSTREPAY
					, T1.LASTREPAY
					, T1.FINSTARTDATE
					, T1.FINAMOUNT
					, T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT LOVDESCFINANCINGAMOUNT
					, T1.FINREPAYMENTAMOUNT
					, T1.CUSTID
					, T1.DEFFERMENTS
					, T1.PLANDEFERCOUNT
					, T1.FINBRANCH
					, T1.FINSOURCEID
					, T1.ALLOWEDDEFRPYCHANGE
					, T1.AVAILEDDEFRPYCHANGE
					, T1.ALLOWEDDEFFRQCHANGE
					, T1.AVAILEDDEFFRQCHANGE
					, T1.RECALTYPE
					, T1.FINASSETVALUE
					, T1.FINISACTIVE
					, T1.LIMITVALID
					, T1.OVERRIDELIMIT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T7.FINTYPEDESC LOVDESCFINTYPENAME
					, T7.FINMAXAMOUNT LOVDESCFINMAXAMT
					, T7.FINMINAMOUNT LOVDESCFINMINAMOUNT
					, T1.MINDOWNPAYPERC
					, T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT
					, T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ
					, T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT
					, T12.BRANCHDESC LOVDESCFINBRANCHNAME
					, T12.BRANCHPROVINCE FINBRANCHPROVINCECODE
					, T1.LASTREPAYDATE
					, T1.LASTREPAYPFTDATE
					, T1.LASTREPAYRVWDATE
					, T1.LASTREPAYCPZDATE
					, T1.ALLOWGRCREPAY
					, T1.GRCSCHDMTHD
					, T1.GRCMARGIN
					, T1.REPAYMARGIN
					, T1.FINCURRASSETVALUE
					, T1.FINCOMMITMENTREF
					, T1.FINLIMITREF
					, T1.FINCONTRACTDATE
					, T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD
					, T7.FINRVWRATEAPPLFOR
					, T1.TOTALREPAYAMT
					, T1.CLOSINGSTATUS
					, T1.FINAPPROVEDDATE
					, T1.FEECHARGEAMT
					, T1.BLACKLISTED
					, T1.FINREPAYPFTONFRQ
					, T1.ANUALIZEDPERCRATE
					, T1.EFFECTIVERATEOFRETURN
					, T1.MIGRATEDFINANCE
					, T1.SCHEDULEMAINTAINED
					, T1.SCHEDULEREGENERATED
					, T1.FINPURPOSE
					, T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME
					, T1.FINSTATUS
					, T1.FINSTSREASON
					, T1.INITIATEUSER
					, T7.FINSCHEDULEON LOVDESCFINSCHEDULEON
					, T1.CUSTDSR
					, T1.JOINTACCOUNT
					, T1.JOINTCUSTID
					, T1.DOWNPAYBANK
					, T1.DOWNPAYSUPL
					, T1.SECURITYCOLLATERAL
					, T1.APPROVED
					, T1.DISCREPANCY
					, T1.LIMITAPPROVED
					, T1.GRACETERMS
					, T7.FINDIVISION LOVDESCFINDIVISION
					, T1.RCDMAINTAINSTS
					, T1.FINREPAYMETHOD
					, T1.GRCPROFITDAYSBASIS
					, T1.STEPFINANCE
					, T1.STEPTYPE
					, T1.STEPPOLICY
					, T1.ALWMANUALSTEPS
					, T1.NOOFSTEPS
					, T1.LINKEDFINREF
					, T1.NEXTUSERID
					, T1.PRIORITY
					, T24.POLICYDESC LOVDESCSTEPPOLICYNAME
					, T1.GRCMINRATE
					, T1.GRCMAXRATE
					, T1.RPYMINRATE
					, T1.RPYMAXRATE
					, T1.DEVIATIONAPPROVAL
					, T1.MANUALSCHEDULE
					, T1.CREDITINSAMT
					, T27.CUSTSTSDESCRIPTION
					, T1.INITIATEDATE
					, T1.FINPREAPPROVEDREF
					, T1.ACCOUNTSOFFICER
					, T28.DEALERNAME LOVDESCACCOUNTSOFFICER
					, T28.DEALERCITY LOVDESCSOURCECITY
					, T1.DSACODE
					, T30.ROFFICERDESC DSACODEDESC
					, T1.TDSAPPLICABLE
					, T1.MANDATEID
					, T1.DROPLINEFRQ
					, T1.FIRSTDROPLINEDATE
					, T1.PFTSERVICINGODLIMIT
					, T1.ALWBPI
					, T1.BPITREATMENT
					, T1.PLANEMIHALW
					, T1.PLANEMIHMETHOD
					, T1.PLANEMIHMAXPERYEAR
					, T1.PLANEMIHMAX
					, T1.PLANEMIHLOCKPERIOD
					, T1.PLANEMICPZ
					, T1.CALROUNDINGMODE
					, T1.ALWMULTIDISB
					, T1.APPLICATIONNO
					, T1.REFERRALID
					, T33.ROFFICERDESC REFERRALIDDESC
					, T1.DMACODE
					, T34.ROFFICERDESC DMACODEDESC
					, T1.SALESDEPARTMENT
					, T35.DEPTDESC SALESDEPARTMENTDESC
					, T1.QUICKDISB
					, T1.WIFREFERENCE
					, T1.UNPLANEMIHLOCKPERIOD
					, T1.UNPLANEMICPZ
					, T1.REAGECPZ
					, T1.MAXUNPLANNEDEMI
					, T1.MAXREAGEHOLIDAYS
					, T1.AVAILEDUNPLANEMI
					, T1.AVAILEDREAGEH
					, T1.BPIAMOUNT
					, T1.DEDUCTFEEDISB
					, T1.RVWRATEAPPLFOR
					, T1.SCHCALONRVW
					, T1.PASTDUEPFTCALMTHD
					, T1.PASTDUEPFTMARGIN
					, T1.DROPPINGMETHOD
					, T1.RATECHGANYDAY
					, T1.PROMOTIONCODE
					, T1.RESTRUCTURELOAN
					, T1.OLDFINREFERENCE
					, T1.REAGEBUCKET
					, T1.FINCATEGORY
					, T1.PRODUCTCATEGORY
					, T1.ROUNDINGTARGET
					, T36.ENTITYCODE LOVDESCENTITYCODE
					, T1.ELIGIBILITYMETHOD
					, T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD
					, T38.VALUEDESC LOVDESCELIGIBILITYMETHOD
					, T1.EMPLOYEENAME
					, T37.ROFFICERDESC EMPLOYEENAMEDESC
					, T1.SAMPLINGREQUIRED
					, T1.LEGALREQUIRED
					, T1.GRCMAXAMOUNT
					, T1.CONNECTOR
					, T40.DEALERNAME CONNECTORCODE
					, T40.DEALERCITY CONNECTORDESC
					, T1.ADVANCEEMI
					, T1.ADVEMITERMS
					, T1.BPIPFTDAYSBASIS
					, T1.FIXEDRATETENOR
					, T1.FIXEDTENORRATE
					, T12.BRANCHTEL FINBRANCHCONTACT
					, T1.PROCESSATTRIBUTES
					, T1.BUSINESSVERTICAL
					, BV.CODE BUSINESSVERTICALCODE
					, BV.DESCRIPTION BUSINESSVERTICALDESC
					, T1.GRCADVTYPE
					, T1.GRCADVTERMS
					, T1.ADVTYPE
					, T1.ADVTERMS
					, T1.ADVSTAGE
					, T1.TDSPERCENTAGE
					, T1.TDSSTARTDATE
					, T1.TDSENDDATE
					, T1.TDSLIMITAMT
					, T1.VANREQ
					, T1.VANCODE
					, T1.ALLOWDRAWINGPOWER
					, T1.ALLOWREVOLVING
					, T1.SANBSDSCHDLE
					, T1.PROMOTIONSEQID
					, T1.SVAMOUNT
					, T1.CBAMOUNT
					, T1.APPLIEDLOANAMT
					, T1.FINISRATERVWATGRCEND
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T13.BRANCHDESC LOVDESCSOURCINGBRANCH
					, T1.OFFERID
					, T1.ENDGRCPERIODAFTRFULLDISB
					, T1.AUTOINCGRCENDDATE
					, T1.ALWGRCADJ
					, T1.PMAY
					, T1.ALWLOANSPLIT
					, T1.PARENTREF
					, T1.LOANSPLITTED
					, T1.INSTBASEDSCHD
					, T1.PLANEMIHALWINGRACE
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T41.DEALERNAME MANUFACTURERDEALERNAME
					, T41.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN_TEMP T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE  = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
			]]>
		</createView>
	</changeSet>


	<changeSet id="DE#267.25.1_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SETT#0.1" author="saikiran.n">
		<sql> 
			<![CDATA[
				DELETE FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_CancelReasonCode';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_CancelRemarks';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_WaivedAmount';
				
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_CancelReasonCode', 'SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_CancelRemarks', 'SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_WaivedAmount', 'SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="OTS#0" author="saikiran.n" dbms="postgresql">
		<dropView viewName="FINSETTLEMENTHEADER_AVIEW" />
		<dropView viewName="FINSETTLEMENTHEADER_VIEW" />
		<dropView viewName="FINSETTLEMENTHEADER_TVIEW" />
	</changeSet>

	<changeSet id="OTS#1" author="saikiran.n">
		<renameTable newTableName="FIN_SETTLEMENT_HEADER" oldTableName="FINSETTLEMENTHEADER" />
	</changeSet>

	<changeSet id="OTS#2" author="saikiran.n">
		<renameTable newTableName="FIN_SETTLEMENT_HEADER_TEMP" oldTableName="FINSETTLEMENTHEADER_TEMP" />
	</changeSet>

	<changeSet id="OTS#3" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTHEADERID" tableName="FIN_SETTLEMENT_HEADER" />
	</changeSet>

	<changeSet id="OTS#4" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTHEADERID"
			tableName="FIN_SETTLEMENT_HEADER_TEMP" />
	</changeSet>

	<changeSet id="OTS#9" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_TYPES" oldTableName="SETTLEMENTTYPES" />
	</changeSet>

	<changeSet id="OTS#10" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_TYPES_TEMP" oldTableName="SETTLEMENTTYPES_TEMP" />
	</changeSet>

	<changeSet id="OTS#11" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTTYPEID" tableName="SETTLEMENT_TYPES" />
	</changeSet>

	<changeSet id="OTS#12" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTTYPEID" tableName="SETTLEMENT_TYPES_TEMP" />
	</changeSet>
	

	<changeSet id="OTS#6_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'fin_settlement_header_aview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#6" author="saikiran.n">
		<createView viewName="FIN_SETTLEMENT_HEADER_AVIEW" replaceIfExists="true">
			 <![CDATA[ 
				SELECT T1.ID
					, T1.FINID
					, T1.FINREFERENCE
					, T1.SETTLEMENTTYPE
					, T1.SETTLEMENTSTATUS
					, T1.STARTDATE
					, T1.OTSDATE
					, T1.ENDDATE
					, T1.SETTLEMENTREASON
					, T1.SETTLEMENTAMOUNT
					, T1.NOOFGRACEDAYS
					, T1.SETTLEMENTENDAFTERGRACE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.CANCELREASONCODE
					, T1.CANCELREMARKS
				FROM FIN_SETTLEMENT_HEADER T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#6_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fin_settlement_header_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#7_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'fin_settlement_header_view'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#7" author="saikiran.n">
		<createView viewName="FIN_SETTLEMENT_HEADER_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.FINID
					, T1.FINREFERENCE
					, T1.SETTLEMENTTYPE
					, T1.SETTLEMENTSTATUS
					, T1.STARTDATE
					, T1.OTSDATE
					, T1.ENDDATE
					, T1.SETTLEMENTREASON
					, T1.SETTLEMENTAMOUNT
					, T1.NOOFGRACEDAYS
					, T1.SETTLEMENTENDAFTERGRACE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.CANCELREASONCODE
					, T1.CANCELREMARKS
					, T2.SETTLEMENTCODE SETTLEMENTCODE
					, T1.SETTLEMENTREASONID
					, T3.DESCRIPTION SETTLEMENTREASONDESC
				FROM FIN_SETTLEMENT_HEADER_TEMP T1
				LEFT JOIN SETTLEMENT_TYPES T2 ON T1.SETTLEMENTTYPE = T2.ID
				LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
				UNION ALL 
				SELECT T1.ID
					, T1.FINID
					, T1.FINREFERENCE
					, T1.SETTLEMENTTYPE
					, T1.SETTLEMENTSTATUS
					, T1.STARTDATE
					, T1.OTSDATE
					, T1.ENDDATE
					, T1.SETTLEMENTREASON
					, T1.SETTLEMENTAMOUNT
					, T1.NOOFGRACEDAYS
					, T1.SETTLEMENTENDAFTERGRACE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.CANCELREASONCODE
					, T1.CANCELREMARKS
					, T2.SETTLEMENTCODE SETTLEMENTCODE
					, T1.SETTLEMENTREASONID
					, T3.DESCRIPTION SETTLEMENTREASONDESC
				FROM FIN_SETTLEMENT_HEADER T1
				LEFT JOIN SETTLEMENT_TYPES T2 ON T1.SETTLEMENTTYPE = T2.ID
				LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
				WHERE NOT EXISTS (SELECT 1 FROM FIN_SETTLEMENT_HEADER_TEMP WHERE ID = T1.ID)
			]]>
		</createView>
	</changeSet>


	<changeSet id="OTS#7_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fin_settlement_header_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#8_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fin_settlement_header_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#8" author="saikiran.n">
		<createView viewName="FIN_SETTLEMENT_HEADER_TVIEW" replaceIfExists="true">
		    <![CDATA[
				 SELECT T1.ID
					, T1.FINID
					, T1.FINREFERENCE
					, T1.SETTLEMENTTYPE
					, T1.SETTLEMENTSTATUS
					, T1.STARTDATE
					, T1.OTSDATE
					, T1.ENDDATE
					, T1.SETTLEMENTREASON
					, T1.SETTLEMENTAMOUNT
					, T1.NOOFGRACEDAYS
					, T1.SETTLEMENTENDAFTERGRACE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.CANCELREASONCODE
					, T1.CANCELREMARKS
				FROM FIN_SETTLEMENT_HEADER_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#8_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fin_settlement_header_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#13" author="saikiran.n" dbms="postgresql">
		<dropView viewName="SETTLEMENTTYPES_AVIEW" />
		<dropView viewName="SETTLEMENTTYPES_TVIEW" />
		<dropView viewName="SETTLEMENTTYPES_VIEW" />
	</changeSet>

	<changeSet id="OTS#14_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlement_types_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#14" author="saikiran.n">
		<createView viewName="SETTLEMENT_TYPES_AVIEW" replaceIfExists="true">
			<![CDATA[
			    SELECT T1.ID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_TYPES T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#14_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_types_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#15_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_types_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#15" author="saikiran.n">
		<createView viewName="SETTLEMENT_TYPES_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_TYPES_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#15_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_types_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#16_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlement_types_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#16" author="saikiran.n">
		<createView viewName="SETTLEMENT_TYPES_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_TYPES_TEMP T1
				UNION ALL 
				SELECT T1.ID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_TYPES T1
				WHERE NOT EXISTS (SELECT 1 FROM SETTLEMENT_TYPES_TEMP WHERE ID = T1.ID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#16_post" author="Shankar.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'settlement_types_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#17" author="saikiran.n">
		<sql> 
			<![CDATA[ 
				DELETE FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_WaivedAmount';
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_WaivedAmount', 'SettlementDialog', 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0); 
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="OTS#22" author="saikiran.n" dbms="postgresql">
		<dropView viewName="settlementallocationdtls_aview" />
		<dropView viewName="settlementallocationdtls_view" />
	</changeSet>

	<changeSet id="OTS#18" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_ALLOC_DTLS" oldTableName="SETTLEMENTALLOCATIONDTLS" />
	</changeSet>

	<changeSet id="OTS#19" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_ALLOC_DTLS_TEMP" oldTableName="SETTLEMENTALLOCATIONDTLS_TEMP" />
	</changeSet>

	<changeSet id="OTS#20" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="ALLOCATIONID" tableName="SETTLEMENT_ALLOC_DTLS" />
		<renameColumn newColumnName="HEADERID" oldColumnName="SETTLEMENTHEADERID" tableName="SETTLEMENT_ALLOC_DTLS" />
		<renameColumn newColumnName="ALLOCATIONID" oldColumnName="SETTLEMENTALLOCATIONID" tableName="SETTLEMENT_ALLOC_DTLS" />
	</changeSet>

	<changeSet id="OTS#21" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="ALLOCATIONID" tableName="SETTLEMENT_ALLOC_DTLS_TEMP" />
		<renameColumn newColumnName="ALLOCATIONID" oldColumnName="SETTLEMENTALLOCATIONID" tableName="SETTLEMENT_ALLOC_DTLS_TEMP" />
		<renameColumn newColumnName="HEADERID" oldColumnName="SETTLEMENTHEADERID" tableName="SETTLEMENT_ALLOC_DTLS_TEMP" />
	</changeSet>

	<changeSet id="OTS#23_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_allocation_dtls_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#23" author="saikiran.n">
		<createView viewName="SETTLEMENT_ALLOC_DTLS_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.HEADERID
					, T1.ALLOCATIONID
					, T1.ALLOCATIONTYPE
					, T1.ALLOCATIONTO
					, T1.PAIDAMOUNT
					, T1.WAIVEDAMOUNT
					, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
					, T1.PAIDGST
					, T1.WAIVEDREQAMOUNT
					, T1.WAIVERACCEPTED
					, T1.TOTALDUE
					, T1.WAIVEDGST
					, T1.TAXHEADERID
					, T1.TDSDUE
					, T1.TDSPAID
					, T1.TDSWAIVED
				FROM SETTLEMENT_ALLOC_DTLS T1
				LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE= 'FEE'
				LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
				LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
				LEFT JOIN FEETYPES T5 ON T4.FEETYPEID = T5.FEETYPEID
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#23_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_allocation_dtls_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#24_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_allocation_dtls_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#24" author="saikiran.n">
		<createView viewName="SETTLEMENT_ALLOC_DTLS_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.HEADERID
					, T1.ALLOCATIONID
					, T1.ALLOCATIONTYPE
					, T1.ALLOCATIONTO
					, T1.PAIDAMOUNT
					, T1.WAIVEDAMOUNT
					, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
					, T1.PAIDGST
					, T1.WAIVEDREQAMOUNT
					, T1.WAIVERACCEPTED
					, T1.TOTALDUE
					, T1.WAIVEDGST
					, T1.TAXHEADERID
					, T1.TDSDUE
					, T1.TDSPAID
					, T1.TDSWAIVED
				FROM SETTLEMENT_ALLOC_DTLS_TEMP T1
    			LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE = 'FEE'
     			LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
     			LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
    			LEFT JOIN FEETYPES T5 ON  T4.FEETYPEID = T5.FEETYPEID
				UNION ALL
				SELECT T1.ID
					, T1.HEADERID
					, T1.ALLOCATIONID
					, T1.ALLOCATIONTYPE
					, T1.ALLOCATIONTO
					, T1.PAIDAMOUNT
					, T1.WAIVEDAMOUNT
					, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
					, T1.PAIDGST
					, T1.WAIVEDREQAMOUNT
					, T1.WAIVERACCEPTED
					, T1.TOTALDUE
					, T1.WAIVEDGST
					, T1.TAXHEADERID
					, T1.TDSDUE
					, T1.TDSPAID
					, T1.TDSWAIVED
   				FROM SETTLEMENT_ALLOC_DTLS T1
     			LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE = 'FEE'
     			LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
     			LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
   				LEFT JOIN FEETYPES T5 ON  T4.FEETYPEID = T5.FEETYPEID
				WHERE  NOT EXISTS (SELECT 1 FROM SETTLEMENT_ALLOC_DTLS_TEMP WHERE SETTLEMENT_ALLOC_DTLS_TEMP.ALLOCATIONID = T1.ALLOCATIONID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#24_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_allocation_dtls_view');
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="OTS#29" author="saikiran.n" dbms="postgresql">
		<dropView viewName="settlementschedule_aview" />
		<dropView viewName="settlementschedule_view" />
		<dropView viewName="settlementschedule_tview" />
	</changeSet>

	<changeSet id="OTS#25" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_SCHEDULE" oldTableName="SETTLEMENTSCHEDULE" />
	</changeSet>

	<changeSet id="OTS#26" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_SCHEDULE_TEMP" oldTableName="SETTLEMENTSCHEDULE_TEMP" />
	</changeSet>

	<changeSet id="OTS#27" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTDETAILID" tableName="SETTLEMENT_SCHEDULE" />
		<renameColumn newColumnName="HEADERID" oldColumnName="SETTLEMENTHEADERID" tableName="SETTLEMENT_SCHEDULE" />
	</changeSet>

	<changeSet id="OTS#28" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTDETAILID" tableName="SETTLEMENT_SCHEDULE_TEMP" />
		<renameColumn newColumnName="HEADERID" oldColumnName="SETTLEMENTHEADERID" tableName="SETTLEMENT_SCHEDULE_TEMP" />
	</changeSet>

	<changeSet id="OTS#29_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlement_schedule_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#29.1" author="saikiran.n">
		<createView viewName="SETTLEMENT_SCHEDULE_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.HEADERID
					, T1.SETTLEMENTINSTALDATE
					, T1.SETTLEMENTAMOUNT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_SCHEDULE T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#29_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'settlement_schedule_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#30_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlement_schedule_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#30" author="saikiran.n">
		<createView viewName="SETTLEMENT_SCHEDULE_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.HEADERID
					, T1.SETTLEMENTINSTALDATE
					, T1.SETTLEMENTAMOUNT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_SCHEDULE_TEMP T1
				UNION ALL
				SELECT T1.ID
					, T1.HEADERID
					, T1.SETTLEMENTINSTALDATE
					, T1.SETTLEMENTAMOUNT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_SCHEDULE T1
				WHERE NOT EXISTS (SELECT 1 FROM SETTLEMENT_SCHEDULE_TEMP WHERE ID = T1.ID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#30_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'settlement_schedule_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#31_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlement_schedule_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#31" author="saikiran.n">
		<createView viewName="SETTLEMENT_SCHEDULE_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.HEADERID
					, T1.SETTLEMENTINSTALDATE
					, T1.SETTLEMENTAMOUNT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_SCHEDULE_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#31_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_schedule_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#211875_pre" author="Sravani.M" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fm_settlement_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#211875" author="saikiran.n">
		<createView viewName="FM_SETTLEMENT_VIEW" replaceIfExists="true">
			<![CDATA[
			SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.FINTYPE,
					T1.CUSTID,
					T1.CLOSINGSTATUS,
					T1.FINISACTIVE,
					T1.MATURITYDATE,
					T1.PRODUCTCATEGORY,
					T1.WRITEOFFLOAN,
					T1.CALCOFSTEPS,
					T1.STEPSAPPLIEDFOR,
					T1.NOOFGRCSTEPS,
					T1.SCHDVERSION,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T1.ESCROW,
					T1.CUSTBANKID,
					T1.MANUALSCHDTYPE,
					T1.MANUALSCHEDULE,
					T1.SANCTIONEDDATE
					FROM FINANCEMAIN T1 
					WHERE T1.FINREFERENCE NOT IN (SELECT T2.REFERENCE FROM FINRECEIPTHEADER_TEMP T2) AND 
					T1.FINREFERENCE NOT IN (SELECT T3.FINREFERENCE FROM FEEWAIVERHEADER_TEMP T3) AND
					T1.FINREFERENCE NOT IN (SELECT T4.FINREFERENCE FROM FIN_SETTLEMENT_HEADER_TEMP T4)
				]]>
		</createView>
	</changeSet>

	<changeSet id="PSD#211875_post" author="Sravani.M" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fm_settlement_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#32.1" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader">
			<column name="WMDetailId" type="bigint" />
		</addColumn>
	</changeSet>
	
	<changeSet id="OTS#32.2" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader">
			<column name="AlwCondWaiver" type="int" />
		</addColumn>
	</changeSet>
	
	<changeSet id="OTS#32.3" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader">
			<column name="waiverFullFillAmount" type="decimal(18,0)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="OTS#32.4" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader">
			<column name="waiverFullFillDate" type="datetime" />
		</addColumn>
	</changeSet>

	<changeSet id="OTS#33.1" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader_Temp">
			<column name="WMDetailId" type="bigint" />
		</addColumn>
	</changeSet>
	
	<changeSet id="OTS#33.2" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader_Temp">
			<column name="AlwCondWaiver" type="int" />
		</addColumn>
	</changeSet>
	
	<changeSet id="OTS#33.3" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader_Temp">
			<column name="waiverFullFillAmount" type="decimal(18,0)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="OTS#33.4" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader_Temp">
			<column name="waiverFullFillDate" type="datetime" />
		</addColumn>
	</changeSet>

	<changeSet id="OTS#32.1.1" author="Sravani.M" dbms="postgresql, oracle">
		<addDefaultValue columnName="AlwCondWaiver" defaultValue="0" tableName="FeeWaiverHeader" />
		<addDefaultValue columnName="waiverFullFillAmount" defaultValue="0" tableName="FeeWaiverHeader" />
	</changeSet>

	<changeSet id="OTS#33.1.1" author="Sravani.M" dbms="postgresql, oracle">
		<addDefaultValue columnName="AlwCondWaiver" defaultValue="0" tableName="FeeWaiverHeader_Temp" />
		<addDefaultValue columnName="waiverFullFillAmount" defaultValue="0" tableName="FeeWaiverHeader_Temp" />
	</changeSet>

	<changeSet id="OTS#32.2.1" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader_Temp">
			<column name="LinkedTranId" type="bigint" />
			<column name="Status" type="char(1)" />
		</addColumn>
	</changeSet>

	<changeSet id="OTS#33.2.1" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader">
			<column name="LinkedTranId" type="bigint" />
			<column name="Status" type="char(1)" />
		</addColumn>
	</changeSet>

	<changeSet id="OTS#33.3" author="Sravani" dbms="postgresql, oracle">
		<addDefaultValue columnName="LinkedTranId" tableName="FEEWAIVERHEADER_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="OTS#32.3" author="Sravani" dbms="postgresql, oracle">
		<addDefaultValue columnName="LinkedTranId" tableName="FEEWAIVERHEADER" defaultValue="0" />
	</changeSet>

	<changeSet id="OTS#34.1" author="Sravani.M">
		<sql>
			<![CDATA[
				UPDATE FEEWAIVERHEADER SET ALWCONDWAIVER=0 WHERE ALWCONDWAIVER IS NULL;
				UPDATE FEEWAIVERHEADER SET WAIVERFULLFILLAMOUNT=0 WHERE WAIVERFULLFILLAMOUNT IS NULL;
				UPDATE FEEWAIVERHEADER_TEMP SET ALWCONDWAIVER=0 WHERE ALWCONDWAIVER IS NULL;
				UPDATE FEEWAIVERHEADER_TEMP SET WAIVERFULLFILLAMOUNT=0 WHERE WAIVERFULLFILLAMOUNT IS NULL;
				UPDATE FEEWAIVERHEADER_TEMP SET LINKEDTRANID = 0 WHERE LINKEDTRANID IS NULL;
				UPDATE FEEWAIVERHEADER SET LINKEDTRANID = 0 WHERE LINKEDTRANID IS NULL;
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#37.1" author="Sravani.M" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FEEWAIVERHEADER ADD CONSTRAINT DF_FEWAIVERHEADER_ALWC DEFAULT 0 FOR ALWCONDWAIVER;
				ALTER TABLE FEEWAIVERHEADER ADD CONSTRAINT DF_FEWAIVERHEADER_WFFA DEFAULT 0 FOR WAIVERFULLFILLAMOUNT;
				ALTER TABLE FEEWAIVERHEADER_TEMP ADD CONSTRAINT DF_FEWAIVERHEADER_T_ALWC DEFAULT 0 FOR ALWCONDWAIVER;
				ALTER TABLE FEEWAIVERHEADER_TEMP ADD CONSTRAINT DF_FEWAIVERHEADER_T_WFFA DEFAULT 0 FOR WAIVERFULLFILLAMOUNT;
				ALTER TABLE FEEWAIVERHEADER ADD CONSTRAINT DF_FEWAIVERHEADER_LNKDTRNID DEFAULT 0 FOR LINKEDTRANID;
				ALTER TABLE FEEWAIVERHEADER_TEMP ADD CONSTRAINT DF_FEWAIVERHEADER_T_LNKDTRNID DEFAULT 0 FOR LINKEDTRANID;
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#35.1_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'feewaiverheader_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#35.1" author="saikiran.n">
		<createView viewName="FEEWAIVERHEADER_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.WAIVERID
					, FM.FINID
					, FM.FINREFERENCE
					, T1.EVENT
					, T1.REMARKS
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.POSTINGDATE
					, T1.VALUEDATE
					, T1.WMDETAILID
					, T1.ALWCONDWAIVER
					, T1.WAIVERFULLFILLDATE
					, T1.WAIVERFULLFILLAMOUNT
					, T1.STATUS
					, T1.LINKEDTRANID
				FROM FEEWAIVERHEADER_TEMP T1
				INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
				UNION ALL
				SELECT T1.WAIVERID
					, FM.FINID
					, FM.FINREFERENCE
					, T1.EVENT
					, T1.REMARKS
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.POSTINGDATE
					, T1.VALUEDATE
					, T1.WMDETAILID
					, T1.ALWCONDWAIVER
					, T1.WAIVERFULLFILLDATE
					, T1.WAIVERFULLFILLAMOUNT
					, T1.STATUS
					, T1.LINKEDTRANID
				FROM FEEWAIVERHEADER T1
				INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
				WHERE NOT EXISTS (SELECT 1 FROM FEEWAIVERHEADER_TEMP
					WHERE FEEWAIVERHEADER_TEMP.WAIVERID = T1.WAIVERID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#35.1_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'feewaiverheader_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#36.1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'feewaiverheader_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#36.1" author="saikiran.n">
		<createView viewName="FEEWAIVERHEADER_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.WAIVERID
					, FM.FINID
					, FM.FINREFERENCE
					, T1.EVENT
					, T1.REMARKS
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.POSTINGDATE
					, T1.VALUEDATE
					, T1.WMDETAILID
					, T1.ALWCONDWAIVER
					, T1.WAIVERFULLFILLDATE
					, T1.WAIVERFULLFILLAMOUNT
					, T1.STATUS
					, T1.LINKEDTRANID
				FROM FEEWAIVERHEADER_TEMP T1
				INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#36.1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'feewaiverheader_tview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="AMO#1" author="Shankar">
		<sql>
   			<![CDATA[
                INSERT INTO BMTAMOUNTCODES (ALLOWEDEVENT, ALLOWEDRIA, AMOUNTCODE, AMOUNTCODEDESC, AMOUNTCODEISACTIVE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('EXTRF', 0, 'ae_toExcessAmt',		'Transfer To Excess',				'1', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
                INSERT INTO BMTAMOUNTCODES (ALLOWEDEVENT, ALLOWEDRIA, AMOUNTCODE, AMOUNTCODEDESC, AMOUNTCODEISACTIVE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('EXTRF', 0, 'ae_toPolicy',			'Transfer To Policy Excess',		'1', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
                INSERT INTO BMTAMOUNTCODES (ALLOWEDEVENT, ALLOWEDRIA, AMOUNTCODE, AMOUNTCODEDESC, AMOUNTCODEISACTIVE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('EXTRF', 0, 'ae_toSettlement',		'Transfer To Settlement Excess',	'1', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
                INSERT INTO BMTAMOUNTCODES (ALLOWEDEVENT, ALLOWEDRIA, AMOUNTCODE, AMOUNTCODEDESC, AMOUNTCODEISACTIVE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('EXTRF', 0, 'EX_ReceiptAmount',		'Transfer FROM Excess',				'1', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
                INSERT INTO BMTAMOUNTCODES (ALLOWEDEVENT, ALLOWEDRIA, AMOUNTCODE, AMOUNTCODEDESC, AMOUNTCODEISACTIVE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('EXTRF', 0, 'POLC_ReceiptAmount',	'Transfer FROM Policy Excess',		'1', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
                INSERT INTO BMTAMOUNTCODES (ALLOWEDEVENT, ALLOWEDRIA, AMOUNTCODE, AMOUNTCODEDESC, AMOUNTCODEISACTIVE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ('EXTRF', 0, 'SETTLE_ReceiptAmount',	'Transfer FROM Settlement Excess',	'1', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);     		
         	 ]]>
		</sql>
	</changeSet>

	<changeSet id="ST#712_01" author="murthy.y">
		<sql>
			<![CDATA[
				Update Customers set CustCoreBank = -1*CustID;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#712_02" author="murthy.y">
		<addNotNullConstraint tableName="Customers" columnName="CustCoreBank"  columnDataType="varchar(50)" />
	</changeSet>

	<changeSet id="ST#712_03" author="murthy.y">
		<createIndex tableName="Customers" indexName="idx_Customers_CustCoreBank">
			<column name="CustCoreBank" type="varchar(50)" />
		</createIndex>
	</changeSet>

	<changeSet id="ST#712_04" author="murthy.y">
		<sql>
			<![CDATA[
				Update Customers_Temp set CustCoreBank = -1*CustID;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#712_05" author="murthy.y">
		<addNotNullConstraint tableName="Customers_Temp" columnName="CustCoreBank" columnDataType="varchar(50)"/>
	</changeSet>

	<changeSet id="ST#712_06" author="murthy.y">
		<createIndex tableName="Customers_Temp" indexName="idx_Customers_T_CustCoreBank">
			<column name="CustCoreBank" type="varchar(50)" />
		</createIndex>
	</changeSet>

	<changeSet id="ST#712_07" author="saikrishna.b">
		<createTable tableName="EOD_CUSTOMER_QUEUE">
			<column name="ID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="AppDate" type="dateTime">
				<constraints nullable="false" />
			</column>
			<column name="CustId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="CoreBankID" type="varchar(50)">
				<constraints nullable="false" />
			</column>
			<column name="LoanExist" type="boolean">
				<constraints nullable="false" />
			</column>
			<column name="LimitRebuild" type="boolean">
				<constraints nullable="false" />
			</column>
			<column name="WorkerHost" type="varchar(50)" />
			<column name="ThreadId" type="int">
				<constraints nullable="false" />
			</column>
			<column name="StartTime" type="datetime" />
			<column name="EndTime" type="datetime" />
			<column name="Progress" type="int">
				<constraints nullable="false" />
			</column>
			<column name="ErrorLog" type="varchar(2000)" />
			<column name="ResetCounterId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PickUpFlag" type="boolean">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="ST#712_07.1" author="murthy.y">
		<addPrimaryKey tableName="EOD_CUSTOMER_QUEUE" columnNames="ID" constraintName="pk_eod_customer_queue" />
	</changeSet>

	<changeSet id="ST#712_07.2" author="murthy.y" dbms="postgresql, oracle">
		<addDefaultValue columnName="LoanExist" tableName="EOD_CUSTOMER_QUEUE" defaultValue="0" />
		<addDefaultValue columnName="LimitRebuild" tableName="EOD_CUSTOMER_QUEUE" defaultValue="0" />
		<addDefaultValue columnName="ThreadId" tableName="EOD_CUSTOMER_QUEUE" defaultValue="0" />
		<addDefaultValue columnName="Progress" tableName="EOD_CUSTOMER_QUEUE" defaultValue="0" />
		<addDefaultValue columnName="ResetCounterId" tableName="EOD_CUSTOMER_QUEUE" defaultValue="0" />
		<addDefaultValue columnName="PickUpFlag" tableName="EOD_CUSTOMER_QUEUE" defaultValue="0" />
	</changeSet>

	<changeSet id="ST#712_07.2" author="murthy.y" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE EOD_CUSTOMER_QUEUE ADD CONSTRAINT DF_EOD_CUSTOMER_QUEUE_LOANEXST DEFAULT 0 FOR LOANEXIST;
				ALTER TABLE EOD_CUSTOMER_QUEUE ADD CONSTRAINT DF_EOD_CUSTOMER_QUEUE_LMTB DEFAULT 0 FOR LIMITREBUILD;
				ALTER TABLE EOD_CUSTOMER_QUEUE ADD CONSTRAINT DF_EOD_CUSTOMER_QUEUE_THREADID DEFAULT 0 FOR THREADID;
				ALTER TABLE EOD_CUSTOMER_QUEUE ADD CONSTRAINT DF_EOD_CUSTOMER_QUEUE_PROGRESS DEFAULT 0 FOR PROGRESS;
				ALTER TABLE EOD_CUSTOMER_QUEUE ADD CONSTRAINT DF_EOD_CUSTOMER_QUEUE_RCID DEFAULT 0 FOR RESETCOUNTERID;
				ALTER TABLE EOD_CUSTOMER_QUEUE ADD CONSTRAINT DF_EOD_CUSTOMER_QUEUE_PCPF DEFAULT 0 FOR PICKUPFLAG;
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#712_08" author="murthy.y">
		<createTable tableName="EOD_CUSTOMER_QUEUE_LOG">
			<column name="ID" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="SeqId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="AppDate" type="dateTime">
				<constraints nullable="false" />
			</column>
			<column name="CustID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="CoreBankID" type="varchar(50)" />
			<column name="LoanExist" type="boolean">
				<constraints nullable="false" />
			</column>
			<column name="LimitRebuild" type="boolean">
				<constraints nullable="false" />
			</column>
			<column name="WorkerHost" type="varchar(50)" />
			<column name="ThreadId" type="int">
				<constraints nullable="false" />
			</column>
			<column name="StartTime" type="datetime" />
			<column name="EndTime" type="datetime" />
			<column name="Progress" type="int">
				<constraints nullable="false" />
			</column>
			<column name="ErrorLog" type="varchar(2000)" />
		</createTable>
	</changeSet>

	<changeSet id="ST#712_08.1" author="murthy.y">
		<addPrimaryKey tableName="EOD_CUSTOMER_QUEUE_LOG" columnNames="ID"
			constraintName="pk_eod_customer_queue_log" />
	</changeSet>

	<changeSet id="ST#712_pre" author="Mounika.M" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'mandates_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#712" author="Mounika.M">
		<createView viewName="MANDATES_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT M.MANDATEID
					, M.CUSTID
					, M.MANDATEREF
					, M.MANDATETYPE
					, M.BANKBRANCHID
					, M.ACCNUMBER
					, M.ACCHOLDERNAME
					, M.JOINTACCHOLDERNAME
					, M.ACCTYPE
					, M.OPENMANDATE
					, M.STARTDATE
					, M.EXPIRYDATE
					, M.MAXLIMIT
					, M.PERIODICITY
					, M.PHONECOUNTRYCODE
					, M.PHONEAREACODE
					, M.PHONENUMBER
					, M.STATUS
					, M.APPROVALID
					, M.VERSION
					, M.LASTMNTBY
					, M.LASTMNTON
					, M.RECORDSTATUS
					, M.ROLECODE
					, M.NEXTROLECODE
					, M.TASKID
					, M.NEXTTASKID
					, M.RECORDTYPE
					, M.WORKFLOWID
					, M.REASON
					, M.MANDATECCY
					, C.CUSTCIF
					, C.CUSTSHRTNAME
					, C.CUSTCOREBANK
					, BB.BANKCODE
					, BB.BRANCHCODE
					, BB.BRANCHDESC
					, BB.MICR
					, BB.IFSC
					, BB.CITY
					, BD.BANKNAME
					, M.INPUTDATE
					, M.INPUTDATE FROMDATE
					, M.INPUTDATE TODATE
					, M.ACTIVE
					, M.DEFAULTMANDATE
					, 1  USEEXISTING
					, M.ORGREFERENCE
					, PC.PCCITYNAME
					, M.DOCUMENTNAME
					, M.DOCUMENTREF
					, M.EXTERNALREF
					, M.ENTITYCODE
					, E.ENTITYDESC
					, M.PRIMARYMANDATEID
					, M.SWAPISACTIVE
					, M.BARCODENUMBER
					, PB.PARTNERBANKCODE
					, PB.PARTNERBANKNAME
					, M.PARTNERBANKID
					, M.EMANDATESOURCE
					, M.EMANDATEREFERENCENO
					, FM.FINTYPE
					, M.HOLDREASON
					, M.SWAPEFFECTIVEDATE
					, M.SECURITYMANDATE
					, M.EMPLOYERID
					, ED.EMPNAME
					, M.EMPLOYEENO
				FROM MANDATES M
				INNER JOIN CUSTOMERS C ON C.CUSTID = M.CUSTID
				LEFT JOIN BANKBRANCHES BB ON BB.BANKBRANCHID = M.BANKBRANCHID
				LEFT JOIN BMTBANKDETAIL BD ON BD.BANKCODE = BB.BANKCODE 
				LEFT JOIN RMTPROVINCEVSCITY PC ON PC.PCCITY = BB.CITY
				LEFT JOIN ENTITY E ON E.ENTITYCODE = M.ENTITYCODE
				LEFT JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = M.PARTNERBANKID
				LEFT JOIN FINANCEMAIN FM ON FM.FINREFERENCE = M.ORGREFERENCE
				LEFT JOIN EMPLOYERDETAIL ED ON ED.EMPLOYERID = M.EMPLOYERID
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#712_post" author="Mounika.M" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'mandates_aview');
			]]>
		</sql>
	</changeSet>
	<changeSet id="ST#712.1_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'mandates_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#712.1" author="saikiran.n">
		<createView viewName="MANDATES_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT M.MANDATEID
					, M.CUSTID
					, M.MANDATEREF
					, M.MANDATETYPE
					, M.BANKBRANCHID
					, M.ACCNUMBER
					, M.ACCHOLDERNAME
					, M.JOINTACCHOLDERNAME
					, M.ACCTYPE
					, M.OPENMANDATE
					, M.STARTDATE
					, M.EXPIRYDATE
					, M.MAXLIMIT
					, M.PERIODICITY
					, M.PHONECOUNTRYCODE
					, M.PHONEAREACODE
					, M.PHONENUMBER
					, M.STATUS
					, M.APPROVALID
					, M.VERSION
					, M.LASTMNTBY
					, M.LASTMNTON
					, M.RECORDSTATUS
					, M.ROLECODE
					, M.NEXTROLECODE
					, M.TASKID
					, M.NEXTTASKID
					, M.RECORDTYPE
					, M.WORKFLOWID
					, M.REASON
					, M.MANDATECCY
					, C.CUSTCIF
					, C.CUSTSHRTNAME
					, C.CUSTCOREBANK
					, BB.BANKCODE
					, BB.BRANCHCODE
					, BB.BRANCHDESC
					, BB.MICR
					, BB.IFSC
					, BB.CITY
					, BD.BANKNAME
					, M.INPUTDATE
					, M.ACTIVE
					, M.DEFAULTMANDATE
					, 0 USEEXISTING
					, M.ORGREFERENCE
					, PC.PCCITYNAME
					, M.DOCUMENTNAME
					, M.DOCUMENTREF
					, M.EXTERNALREF
					, M.ENTITYCODE
					, E.ENTITYDESC
					, M.PRIMARYMANDATEID
					, M.SWAPISACTIVE
					, M.BARCODENUMBER
					, PB.PARTNERBANKCODE
					, PB.PARTNERBANKNAME
					, M.PARTNERBANKID
					, M.EMANDATESOURCE
					, M.EMANDATEREFERENCENO
					, FM.FINTYPE
					, M.HOLDREASON
					, M.SWAPEFFECTIVEDATE
					, M.SECURITYMANDATE
					, M.EMPLOYERID
					, ED.EMPNAME
					, M.EMPLOYEENO
				FROM MANDATES_TEMP M
				INNER JOIN CUSTOMERS C ON M.CUSTID = C.CUSTID
				LEFT JOIN BANKBRANCHES BB ON M.BANKBRANCHID = BB.BANKBRANCHID
				LEFT JOIN BMTBANKDETAIL BD ON BB.BANKCODE = BD.BANKCODE
				LEFT JOIN RMTPROVINCEVSCITY PC ON BB.CITY = PC.PCCITY
				LEFT JOIN ENTITY E ON M.ENTITYCODE = E.ENTITYCODE
				LEFT JOIN PARTNERBANKS PB ON M.PARTNERBANKID = PB.PARTNERBANKID
				LEFT JOIN FINANCEMAIN FM ON M.ORGREFERENCE = FM.FINREFERENCE
				LEFT JOIN EMPLOYERDETAIL ED ON ED.EMPLOYERID = M.EMPLOYERID
				UNION ALL
				SELECT M.MANDATEID
					, M.CUSTID
					, M.MANDATEREF
					, M.MANDATETYPE
					, M.BANKBRANCHID
					, M.ACCNUMBER
					, M.ACCHOLDERNAME
					, M.JOINTACCHOLDERNAME
					, M.ACCTYPE
					, M.OPENMANDATE
					, M.STARTDATE
					, M.EXPIRYDATE
					, M.MAXLIMIT
					, M.PERIODICITY
					, M.PHONECOUNTRYCODE
					, M.PHONEAREACODE
					, M.PHONENUMBER
					, M.STATUS
					, M.APPROVALID
					, M.VERSION
					, M.LASTMNTBY
					, M.LASTMNTON
					, M.RECORDSTATUS
					, M.ROLECODE
					, M.NEXTROLECODE
					, M.TASKID
					, M.NEXTTASKID
					, M.RECORDTYPE
					, M.WORKFLOWID
					, M.REASON
					, M.MANDATECCY
					, C.CUSTCIF
					, C.CUSTSHRTNAME
					, C.CUSTCOREBANK
					, BB.BANKCODE
					, BB.BRANCHCODE
					, BB.BRANCHDESC
					, BB.MICR
					, BB.IFSC
					, BB.CITY
					, BD.BANKNAME
					, M.INPUTDATE
					, M.ACTIVE
					, M.DEFAULTMANDATE
					, 1 USEEXISTING
					, M.ORGREFERENCE
					, PC.PCCITYNAME
					, M.DOCUMENTNAME
					, M.DOCUMENTREF
					, M.EXTERNALREF
					, M.ENTITYCODE
					, E.ENTITYDESC
					, M.PRIMARYMANDATEID
					, M.SWAPISACTIVE
					, M.BARCODENUMBER
					, PB.PARTNERBANKCODE
					, PB.PARTNERBANKNAME
					, M.PARTNERBANKID
					, M.EMANDATESOURCE
					, M.EMANDATEREFERENCENO
					, FM.FINTYPE
					, M.HOLDREASON
					, M.SWAPEFFECTIVEDATE
					, M.SECURITYMANDATE
					, M.EMPLOYERID
					, ED.EMPNAME
					, M.EMPLOYEENO
				FROM MANDATES M
				INNER JOIN CUSTOMERS C ON M.CUSTID = C.CUSTID
				LEFT JOIN BANKBRANCHES BB ON M.BANKBRANCHID = BB.BANKBRANCHID
				LEFT JOIN BMTBANKDETAIL BD ON BB.BANKCODE = BD.BANKCODE
				LEFT JOIN RMTPROVINCEVSCITY PC ON BB.CITY = PC.PCCITY
				LEFT JOIN ENTITY E ON M.ENTITYCODE = E.ENTITYCODE
				LEFT JOIN PARTNERBANKS PB ON M.PARTNERBANKID = PB.PARTNERBANKID
				LEFT JOIN FINANCEMAIN FM ON M.ORGREFERENCE = FM.FINREFERENCE
				LEFT JOIN EMPLOYERDETAIL ED ON ED.EMPLOYERID = M.EMPLOYERID
				WHERE NOT EXISTS (SELECT 1 FROM MANDATES_TEMP WHERE MANDATES_TEMP.MANDATEID = M.MANDATEID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#712.1_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'mandates_view');
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="TK#2658.1.0" author="Sravani">
		<createSequence sequenceName="SeqExcess_Transfer_Details" incrementBy="1" startValue="1" minValue="1"
			maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="TK#2658.2.0" author="Sravani">
		<comment>New Temp Table for ExcessTransfer</comment>
		<createTable tableName="Excess_Transfer_Details_Temp">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FinId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FinReference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="TransferDate" type="datetime" />
			<column name="TransferToType" type="varchar(8)" />
			<column name="TransferToId" type="bigint" />
			<column name="TransferFromType" type="varchar(8)" />
			<column name="TransferFromId" type="bigint" />
			<column name="LinkedTranId" type="bigint" />
			<column name="Status" type="varchar(50)" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="TransferAmount" type="decimal(18,0)" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2658.3.0" author="Sravani">
		<addPrimaryKey tableName="Excess_Transfer_Details_Temp" columnNames="Id"
			constraintName="pk_Excess_Transfer_Details_T" />
	</changeSet>

	<changeSet id="TK#2658.4.0" author="Sravani">
		<comment>New Temp Table for ExcessTransfer</comment>
		<createTable tableName="Excess_Transfer_Details">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FinId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FinReference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="TransferDate" type="datetime" />
			<column name="TransferToType" type="varchar(8)" />
			<column name="TransferToId" type="bigint" />
			<column name="TransferFromType" type="varchar(8)" />
			<column name="TransferFromId" type="bigint" />
			<column name="LinkedTranId" type="bigint" />
			<column name="Status" type="varchar(50)" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="CreatedBy" type="bigint" />
			<column name="CreatedOn" type="datetime" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="ApprovedBy" type="bigint" />
			<column name="ApprovedOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="TransferAmount" type="decimal(18,0)" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2658.5.0" author="Sravani">
		<addPrimaryKey tableName="Excess_Transfer_Details" columnNames="Id"
			constraintName="pk_Excess_Transfer_Details" />
	</changeSet>

	<changeSet id="TK#2658.6.0" author="Sravani">
		<addForeignKeyConstraint constraintName="fk_ETD_FinID" referencedTableName="FinanceMain"
			baseColumnNames="FinID" baseTableName="Excess_Transfer_Details" referencedColumnNames="FinID" />
	</changeSet>

	<changeSet id="TK#2658.8.0" author="Sravani" dbms="mssql">
		<sql>
        <![CDATA[
            ALTER TABLE EXCESS_TRANSFER_DETAILS_TEMP Add CONSTRAINT DF_FETDT_TRANSFERAMOUNT default 0 for TransferAmount;
         ]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.8.0" author="Sravani" dbms="postgresql, oracle">
		<addDefaultValue tableName="Excess_Transfer_Details_Temp" columnName="TransferAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2658.10.0" author="Sravani" dbms="mssql">
		<sql>
        <![CDATA[
            ALTER TABLE EXCESS_TRANSFER_DETAILS Add CONSTRAINT DF_FETD_TRANSFERAMOUNT default 0 for TransferAmount;
         ]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.10.0" author="Sravani" dbms="postgresql, oracle">
		<addDefaultValue tableName="Excess_Transfer_Details" columnName="TransferAmount" defaultValue="0" />
	</changeSet>

	<changeSet id="TK#2658.11.0_pre" author="Sravani" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'excess_transfer_details_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.11.0.1" author="Sravani">
		<createView viewName="EXCESS_TRANSFER_DETAILS_VIEW" replaceIfExists="true">
			<![CDATA[
			SELECT T1.ID
					, T1.FINID
					, T1.FINREFERENCE
				    , T1.TRANSFERDATE
					, T1.TRANSFERTOTYPE
				    , T1.TRANSFERTOID
				    , T1.TRANSFERFROMTYPE
				    , T1.TRANSFERFROMID
				    , T1.LINKEDTRANID
				    , T1.STATUS
            		, CUST.CUSTCIF
				    , T1.VERSION
				    , T1.CREATEDBY
				    , T1.CREATEDON
				    , T1.LASTMNTBY
				    , T1.LASTMNTON
				    , T1.APPROVEDBY
				    , T1.APPROVEDON
				    , T1.RECORDSTATUS
				    , T1.ROLECODE
				    , T1.NEXTROLECODE
				    , T1.TASKID
				    , T1.NEXTTASKID
				    , T1.RECORDTYPE
				    , T1.WORKFLOWID
				    , T1.TRANSFERAMOUNT
				FROM EXCESS_TRANSFER_DETAILS_TEMP T1
        		INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
        		INNER JOIN CUSTOMERS CUST ON CUST.CUSTID = FM.CUSTID
				UNION ALL
	 			SELECT T1.ID
	 				, T1.FINID
					, T1.FINREFERENCE
				    , T1.TRANSFERDATE
					, T1.TRANSFERTOTYPE
				    , T1.TRANSFERTOID
				    , T1.TRANSFERFROMTYPE
				    , T1.TRANSFERFROMID
				    , T1.LINKEDTRANID
				    , T1.STATUS
		            , CUST.CUSTCIF
				    , T1.VERSION
				    , T1.CREATEDBY
				    , T1.CREATEDON
				    , T1.LASTMNTBY
				    , T1.LASTMNTON
				    , T1.APPROVEDBY
				    , T1.APPROVEDON
				    , T1.RECORDSTATUS
				    , T1.ROLECODE
				    , T1.NEXTROLECODE
				    , T1.TASKID
				    , T1.NEXTTASKID
				    , T1.RECORDTYPE
				    , T1.WORKFLOWID
				    , T1.TRANSFERAMOUNT
				FROM EXCESS_TRANSFER_DETAILS T1
        		INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
        		INNER JOIN CUSTOMERS CUST ON CUST.CUSTID = FM.CUSTID
				WHERE NOT EXISTS (SELECT 1 FROM EXCESS_TRANSFER_DETAILS_TEMP WHERE ID = T1.ID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2658.11.0_post" author="Sravani" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'excess_transfer_details_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.12.0_pre" author="Sravani" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'excess_transfer_details_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.12.0.1" author="Sravani">
		<createView viewName="EXCESS_TRANSFER_DETAILS_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.FINID
					, T1.FINREFERENCE
				    , T1.TRANSFERDATE
					, T1.TRANSFERTOTYPE
				    , T1.TRANSFERTOID
				    , T1.TRANSFERFROMTYPE
				    , T1.TRANSFERFROMID
				    , T1.LINKEDTRANID
				    , T1.STATUS
				    , T1.VERSION
				    , T1.CREATEDBY
				    , T1.CREATEDON
				    , T1.LASTMNTBY
				    , T1.LASTMNTON
				    , T1.APPROVEDBY
				    , T1.APPROVEDON
				    , T1.RECORDSTATUS
				    , T1.ROLECODE
				    , T1.NEXTROLECODE
				    , T1.TASKID
				    , T1.NEXTTASKID
				    , T1.RECORDTYPE
				    , T1.WORKFLOWID
				    , T1.TRANSFERAMOUNT
				FROM EXCESS_TRANSFER_DETAILS T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2658.12.0_post" author="Sravani" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'excess_transfer_details_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.13.0_pre" author="Sravani" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'excess_transfer_details_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.13.0.1" author="Sravani">
		<createView viewName="EXCESS_TRANSFER_DETAILS_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.FINID
					, T1.FINREFERENCE
				    , T1.TRANSFERDATE
					, T1.TRANSFERTOTYPE
				    , T1.TRANSFERTOID
				    , T1.TRANSFERFROMTYPE
				    , T1.TRANSFERFROMID
				    , T1.LINKEDTRANID
				    , T1.STATUS
				    , T1.VERSION
				    , T1.CREATEDBY
				    , T1.CREATEDON
				    , T1.LASTMNTBY
				    , T1.LASTMNTON
				    , T1.APPROVEDBY
				    , T1.APPROVEDON
				    , T1.RECORDSTATUS
				    , T1.ROLECODE
				    , T1.NEXTROLECODE
				    , T1.TASKID
				    , T1.NEXTTASKID
				    , T1.RECORDTYPE
				    , T1.WORKFLOWID
				    , T1.TRANSFERAMOUNT
				FROM EXCESS_TRANSFER_DETAILS_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="TK#2658.13.0_post" author="Sravani" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'excess_transfer_details_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.14.0" author="Sravani">
		<comment>RIGHTS for Excess Transfer</comment>
		<sql>
			<![CDATA[
				DELETE FROM SECROLEGROUPS WHERE ROLEID = (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'EXCESS_TRANSFER_MAKER');
				DELETE FROM SECROLEGROUPS WHERE ROLEID = (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'EXCESS_TRANSFER_APPROVER');
				DELETE FROM SECROLEGROUPS WHERE ROLEID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER');
				DELETE FROM SECROLEGROUPS WHERE ROLEID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_APPROVER');
			
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_APPROVER');
					
				DELETE FROM SECROLES WHERE ROLECD = 'EXCESS_TRANSFER_MAKER';
				DELETE FROM SECROLES WHERE ROLECD = 'EXCESS_TRANSFER_APPROVER';
				
				DELETE FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER';
				DELETE FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_APPROVER';
					
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'menuItem_ExcessTransferMaster_ExcessTransfer');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferDialog_btnNew');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferList_NewExcessTransfer');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferList_ExcessTransferSearchDialog');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferDialog_btnEdit');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferDialog_btnSave');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferDialog_btnDelete');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_TransferDate');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_ExcessReference');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_TransferFrom');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_FinReference');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_TransferAmount');
				
				DELETE FROM SECRIGHTS WHERE RightName = 'menuItem_ExcessTransferMaster_ExcessTransfer';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferDialog_btnNew';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferList_NewExcessTransfer';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferList_ExcessTransferSearchDialog';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferDialog_btnEdit';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferDialog_btnSave';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_ExcessTransferDialog_btnDelete';
				DELETE FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_TransferDate';
				DELETE FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_ExcessReference';
				DELETE FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_TransferFrom';
				DELETE FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_FinReference';
				DELETE FROM SECRIGHTS WHERE RightName = 'ExcessTransferDialog_TransferAmount';
				 
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menuItem_ExcessTransferMaster_ExcessTransfer', 'MENU', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_ExcessTransferDialog_btnNew','ExcessTransferDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_ExcessTransferList_NewExcessTransfer','ExcessTransferList', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_ExcessTransferList_ExcessTransferSearchDialog','ExcessTransferList', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_ExcessTransferDialog_btnEdit','ExcessTransferDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_ExcessTransferDialog_btnSave','ExcessTransferDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_ExcessTransferDialog_btnDelete','ExcessTransferDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'ExcessTransferDialog_TransferDate','ExcessTransferDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'ExcessTransferDialog_ExcessReference','ExcessTransferDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'ExcessTransferDialog_TransferFrom','ExcessTransferDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'ExcessTransferDialog_FinReference','ExcessTransferDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'ExcessTransferDialog_TransferAmount','ExcessTransferDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'EXCESS_TRANSFER_MAKER', 'EXCESS TRANSFER MAKER',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'EXCESS_TRANSFER_APPROVER', 'EXCESS TRANSFER APPROVER',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_ExcessTransferMaster_ExcessTransfer'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_ExcessTransferDialog_btnNew'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_ExcessTransferList_NewExcessTransfer'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_ExcessTransferList_ExcessTransferSearchDialog'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_ExcessTransferDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_ExcessTransferDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_ExcessTransferDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'ExcessTransferDialog_TransferDate'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'ExcessTransferDialog_ExcessReference'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'ExcessTransferDialog_TransferFrom'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'ExcessTransferDialog_FinReference'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'ExcessTransferDialog_TransferAmount'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_ExcessTransferMaster_ExcessTransfer'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_ExcessTransferDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				
				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'EXCESS_TRANSFER_MAKER', 'Maker role for Excess Transfer', '', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0); 
		  		INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'EXCESS_TRANSFER_APPROVER', 'Approver role for Excess Transfer',	'', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		    
		    	INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'),    (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'EXCESS_TRANSFER_MAKER'),    0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		    	INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_APPROVER'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'EXCESS_TRANSFER_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		    	
		   		INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_MAKER'),    (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'MSTGRP1_MAKER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
		    	INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_APPROVER'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'MSTGRP1_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.15.0" author="Sravani">
		<sql>
			<![CDATA[
				DELETE FROM ERRORDETAILS WHERE CODE = 'PFA';
	            INSERT INTO ERRORDETAILS (CODE, LANGUAGE, SEVERITY, MESSAGE, EXTENDEDMESSAGE, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID, LASTMNTON, LASTMNTBY, VERSION) VALUES('PFA', 'EN', 'E', '{0}',NULL,'Approved', NULL, NULL, NULL, NULL, NULL, 0, CURRENT_TIMESTAMP, 1000, 0);
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="TK#2658.16.0" author="Sravani">
		<createTable tableName="EXCESS_TRANSFER_DETAILS_UPLOAD">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="HeaderId" type="bigint" />
			<column name="FinID" type="bigint" />
			<column name="FinReference" type="varchar(20)" />
			<column name="TransferFromType" type="varchar(8)" />
			<column name="TransferFromId" type="bigint" />
			<column name="TransferToType" type="varchar(8)" />
			<column name="TransferToId" type="bigint" />
			<column name="TransferAmount" type="decimal(18,0)" />
			<column name="Status" type="char(1)" />
			<column name="Progress" type="int" />
			<column name="ErrorCode" type="varchar(20)" />
			<column name="ErrorDesc" type="varchar(2000)" />
		</createTable>
	</changeSet>

	<changeSet id="TK#2658.17.0" author="Sravani">
		<addPrimaryKey tableName="EXCESS_TRANSFER_DETAILS_UPLOAD" columnNames="Id" constraintName="pk_EXCESS_TRANSFER_DETILS_UPLD"/>
	</changeSet>

	<changeSet id="TK#2658.18.01" author="Sravani">
		<sql>
			<![CDATA[
				DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='EXCESS_TRANSFER_UPLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='EXCESS_TRANSFER_UPLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='EXCESS_TRANSFER_UPLOAD';
 				
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_UPLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_UPLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_UPLOAD';

				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'EXCESS_TRANSFER_UPLOAD', 'Excess Transfer UPLOAD File.', 12, 'EXCESSTRANSFER', null, null, ',', 1, 1, null, 'ROW:{FinReference, TransferFromType, TransferToType, TransferAmount}', null, 'C', '/opt/pff/hdfc/excesstransfer/UPLOAD', 'ExcessTransfer_', '.xls', 0, CURRENT_TIMESTAMP, '${ddmm},.${SEQ_DATE_FILE}', null, '0', NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_UPLOAD'), 'EXCESS_TRANSFER_DETAILS_UPLOAD', 1, 'ID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 4, 0, 0);
								
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_UPLOAD')), 'HEADERID',     		0, 'N', NULL, NULL, '${HEADER_ID}', NULL, '0',  NULL, NULL, NULL, NULL, 'M');								
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_UPLOAD')), 'FINREFERENCE',       0, 'N', NULL, NULL, NULL, 			NULL, '0',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_UPLOAD')), 'TRANSFERFROMTYPE',   0, 'N', NULL, NULL, NULL, 			NULL, '1',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_UPLOAD')), 'TRANSFERTOTYPE',    	0, 'N', NULL, NULL, NULL, 			NULL, '2',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_UPLOAD')), 'TRANSFERAMOUNT',    	0, 'N', NULL, NULL, NULL, 			NULL, '3',  NULL, NULL, NULL, NULL, 'M');
 			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.19.01" author="Sravani">
		<sql>
			<![CDATA[
			    DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='EXCESS_TRANSFER_TEMPLATE');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='EXCESS_TRANSFER_TEMPLATE');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='EXCESS_TRANSFER_TEMPLATE';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_TEMPLATE'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_TEMPLATE');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_TEMPLATE';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'EXCESS_TRANSFER_TEMPLATE', 'Excess Transfer template download', 3, 'EXCESSTRANSFER', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{FinReference, TransferFromType, TransferToType, TransferAmount}', NULL, 'A', '/opt/pff/hdfc/excesstransfer/template', 'EXCESSTRANSFER_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_TEMPLATE'), 'EXCESS_TRANSFER_DETAILS_UPLOAD',  0, 'ID', 'HEADERID = :HEADERID', NULL, NULL, NULL, NULL, NULL, NULL, 4, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_TEMPLATE')), 'FINREFERENCE',      	0, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_TEMPLATE')), 'TRANSFERFROMTYPE',     0, 'N', NULL, NULL, NULL, NULL, '1',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_TEMPLATE')), 'TRANSFERTOTYPE',   	0, 'N', NULL, NULL, NULL, NULL, '2',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_TEMPLATE')), 'TRANSFERAMOUNT',       0, 'N', NULL, NULL, NULL, NULL, '3',  NULL, NULL, NULL, NULL, 'M');
				]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.20.01" author="Sravani">
		<sql>
			<![CDATA[

                DELETE FROM DATA_ENGINE_LOG WHERE STATUSID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='EXCESS_TRANSFER_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_DOWNLOAD_HISTORY WHERE ID IN (SELECT ID FROM DATA_ENGINE_STATUS WHERE NAME ='EXCESS_TRANSFER_DOWNLOAD');
 				DELETE FROM DATA_ENGINE_STATUS WHERE NAME ='EXCESS_TRANSFER_DOWNLOAD';
							
				DELETE FROM DATA_ENGINE_COLUMN WHERE TABLEID IN (SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD'));
				DELETE FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD');
				DELETE FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD';
							
				INSERT INTO DATA_ENGINE_CONFIG (ID, NAME, DESCRIPTION, PARSER, WORKSHEET, TEXTQUALIFIER, ROWDELIMITER, COLUMNDELIMITER, STARTINGROW, SKIPHEADERROW, FIELDNAMES, HEADER, TRAILER, UPLOADLOCATION, UPLOADPATH, FILEPREFIXNAME, FILEEXTENSION, FILESEQUENCENO, LASTPROCESSEDON, FILENAMEFORMAT, CRONEXPRESSION, NOTIFICATIONSTATUSEMAIL, POSTEVENT, BACKUPFILE, ACTIVE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_CONFIG), 'EXCESS_TRANSFER_DOWNLOAD', 'Excess Transfer download', 3, 'EXCESSTRANSFER', NULL, NULL, ',' , 0, 0, NULL, 'ROW:{FinReference, TransferFromType, TransferToType, TransferAmount, Status, Progress, ErrorCode, ErrorDesc}',  '', 'A', '/opt/pff/hdfc/excesstransfer/download', 'ExcessTransfer_', '.xls', 0, current_timestamp, '${ddMMYYYYHms}', NULL, 0, NULL, 1, 1);

				INSERT INTO DATA_ENGINE_TABLE (ID, CONFIGID, NAME, OPERATION, KEYFIELDS, FILTER, STATUSUPDATE, SKIPROWS, IDENTIFIER, DESCRIPTION, STARTINDEX, ENDINDEX, RECORDLENGTH, MULTIROW, HEADERTABLE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_TABLE), (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD'), 'EXCESS_TRANSFER_DETAILS_UPLOAD',  0, 'ID', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 8, 0, 0);
				
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD')), 'FINREFERENCE',      		0, 'N', NULL, NULL, NULL, NULL, '0',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD')), 'TRANSFERFROMTYPE',      	0, 'N', NULL, NULL, NULL, NULL, '1',  NULL, NULL, NULL, NULL, 'M');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD')), 'TRANSFERTOTYPE',       	0, 'N', NULL, NULL, NULL, NULL, '2',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD')), 'TRANSFERAMOUNT',    		0, 'N', NULL, NULL, NULL, NULL, '3',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD')), 'STATUS',	                0, 'N', NULL, NULL, NULL, NULL, '4',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD')), 'PROGRESS',      			0, 'N', NULL, NULL, NULL, NULL, '5',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD')), 'ERRORCODE',	            0, 'N', NULL, NULL, NULL, NULL, '6',  NULL, NULL, NULL, NULL, 'O');
				INSERT INTO DATA_ENGINE_COLUMN (ID, TABLEID, NAME, SKIP, SEQTYPE, SEQOBJECT, DEFAULTVALUE, DERIVEDFROM, REFERENCECOLUMN, STARTINDEX, ENDINDEX, RULEFORVALUE, QUERYFORVALUE, FORMAT, CONSTRAINTTYPE) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM DATA_ENGINE_COLUMN), (SELECT ID FROM DATA_ENGINE_TABLE WHERE NAME = 'EXCESS_TRANSFER_DETAILS_UPLOAD' AND CONFIGID = (SELECT ID FROM DATA_ENGINE_CONFIG WHERE NAME = 'EXCESS_TRANSFER_DOWNLOAD')), 'ERRORDESC',	            0, 'N', NULL, NULL, NULL, NULL, '7',  NULL, NULL, NULL, NULL, 'O');
			]]>
		</sql>
	</changeSet>

	<changeSet id="TK#2658.21.0" author="Sravani">
		<sql>
			<![CDATA[
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_UPLOAD_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_UPLOAD_APPROVER');

				DELETE FROM SECROLES WHERE ROLECD ='EXCESS_TRANSFER_UPLOAD_MAKER';
				DELETE FROM SECROLES WHERE ROLECD ='EXCESS_TRANSFER_UPLOAD_APPROVER';

				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_UPLOAD_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID IN (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_UPLOAD_APPROVER');

				DELETE FROM SECGROUPS WHERE GRPCODE ='EXCESS_TRANSFER_UPLOAD_MAKER';
				DELETE FROM SECGROUPS WHERE GRPCODE ='EXCESS_TRANSFER_UPLOAD_APPROVER';

				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_ExcessTransferUpload_Maker';
				DELETE FROM SECRIGHTS WHERE RIGHTNAME ='menu_Item_ExcessTransferUpload_Approver';

				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_ExcessTransferUpload_Maker', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS(RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_ExcessTransferUpload_Approver', 'MENU', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'EXCESS_TRANSFER_UPLOAD_MAKER', 'WF Maker for ExcessTransfer Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPS(GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'EXCESS_TRANSFER_UPLOAD_APPROVER', 'WF Approver for ExcessTransfer Upload', 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);

				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_UPLOAD_MAKER'),    (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_ExcessTransferUpload_Maker'),    1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_UPLOAD_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_ExcessTransferUpload_Approver'), 1, 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'EXCESS_TRANSFER_UPLOAD_MAKER', 'Maker role from ExcessTransfer Upload', '', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0); 
				INSERT INTO SECROLES (ROLEID, ROLEAPP, ROLECD, ROLEDESC, ROLECATEGORY, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES((SELECT MAX(ROLEID)+1 FROM SECROLES), 1, 'EXCESS_TRANSFER_UPLOAD_APPROVER', 'Approver role from ExcessTransfer Upload',	'', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);

				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_UPLOAD_MAKER'),    (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'EXCESS_TRANSFER_UPLOAD_MAKER'),    0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECROLEGROUPS (ROLEGRPID, GRPID, ROLEID, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID)VALUES ((SELECT MAX(ROLEGRPID)+1 FROM SECROLEGROUPS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'EXCESS_TRANSFER_UPLOAD_APPROVER'), (SELECT ROLEID FROM SECROLES WHERE ROLECD = 'EXCESS_TRANSFER_UPLOAD_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="ST#717.50" author="Mounika.M">
		<sql>
			<![CDATA[
				DELETE FROM BMTAMOUNTCODES WHERE ALLOWEDEVENT = 'EARLYSTL' AND AMOUNTCODE = 'ET_ReceiptAmount';
				DELETE FROM BMTAMOUNTCODES WHERE ALLOWEDEVENT = 'EARLYPAY' AND AMOUNTCODE = 'ET_ReceiptAmount';
				
				INSERT INTO BMTAMOUNTCODES (ALLOWEDEVENT, ALLOWEDRIA, AMOUNTCODE, AMOUNTCODEDESC, AMOUNTCODEISACTIVE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES('EARLYSTL', 0, 'ET_ReceiptAmount', 'Termination Receipt Amount', 1, 1, '1005', CURRENT_TIMESTAMP, 'Approved', '', '', '', '', '', '0');
				INSERT INTO BMTAMOUNTCODES (ALLOWEDEVENT, ALLOWEDRIA, AMOUNTCODE, AMOUNTCODEDESC, AMOUNTCODEISACTIVE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES('EARLYPAY', 0, 'ET_ReceiptAmount', 'Termination Receipt Amount', 1, 1, '1005', CURRENT_TIMESTAMP, 'Approved', '', '', '', '', '', '0');
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="PSD#216165" author="Gopal.p">
		<sql>
			<![CDATA[
				UPDATE DATA_ENGINE_CONFIG SET FILEEXTENSION = '.xlsx' WHERE NAME in ('PAYINS_REFUND_UPLOAD', 'PAYINS_REFUND_TEMPLATE', 'PAYINS_REFUND_DOWNLOAD');
				UPDATE DATA_ENGINE_CONFIG SET FILEEXTENSION = '.xlsx' WHERE NAME in ('HOLD_REFUND_UPLOAD', 'HOLD_REFUND_TEMPLATE', 'HOLD_REFUND_DOWNLOAD');
			]]>
		</sql>
	</changeSet>
	
</databaseChangeLog>