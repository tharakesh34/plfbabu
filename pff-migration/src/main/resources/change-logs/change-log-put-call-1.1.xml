<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value="" dbms="oracle" />
	<property name="add.schema" value="" dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PLFAVANSEQC.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="amanullah.m" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plf, public, pg_catalog;
		</sql>
	</changeSet>

	<changeSet id="1" author="shinde.b">
		<addColumn tableName="RMTFINANCETYPES">
			<column name="putCallRequired" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="1.1" author="shinde.b" dbms="postgresql, oracle">
		<addDefaultValue columnName="putCallRequired" tableName="RMTFINANCETYPES" defaultValue="0" />
	</changeSet>

	<changeSet id="1.1" author="murthy.y" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_RMTFINANCETYPES_PUTCALLREQUIRED DEFAULT 0 FOR PUTCALLREQUIRED;
			]]>
		</sql>
	</changeSet>

	<changeSet id="1.3" author="murthy.y">
		<sql>
			<![CDATA[
				UPDATE RMTFINANCETYPES set putCallRequired =0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="1.4" author="shinde.b" dbms="postgresql, oracle">
		<addNotNullConstraint tableName="RMTFINANCETYPES" columnName="putCallRequired" />
	</changeSet>

    <changeSet id="1.4" dbms="mssql" author="shinde.b">
		<addNotNullConstraint tableName="RMTFINANCETYPES" columnName="putCallRequired" columnDataType="boolean"/>
	</changeSet>
	
	<changeSet id="2" author="shinde.b">
		<addColumn tableName="RMTFINANCETYPES_TEMP">
			<column name="putCallRequired" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="2.1" author="shinde.b" dbms="postgresql, oracle">
		<addDefaultValue columnName="putCallRequired" tableName="RMTFINANCETYPES_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="2.1" author="murthy.y" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_RMTFINANCETYPES_TEMP_PUTCALLREQUIRED DEFAULT 0 FOR PUTCALLREQUIRED;
			]]>
		</sql>
	</changeSet>

	<changeSet id="2.3" author="murthy.y">
		<sql>
			<![CDATA[
				UPDATE RMTFINANCETYPES_TEMP set putCallRequired =0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="2.4" author="shinde.b"  dbms="postgresql, oracle" >
		<addNotNullConstraint tableName="RMTFINANCETYPES_TEMP" columnName="putCallRequired" />
	</changeSet>
	
	<changeSet id="2.4" dbms="mssql" author="shinde.b">
		<addNotNullConstraint tableName="RMTFINANCETYPES_TEMP" columnName="putCallRequired" columnDataType="boolean" />
	</changeSet>

	<changeSet id="3" author="shinde.b">
		<createView viewName="rmtfinancetypes_view" replaceIfExists="true">
			SELECT t1.fintype,
		    t1.fincategory,
		    t1.fintypedesc,
		    t1.finccy,
		    t1.findayscaltype,
		    t1.finactype,
		    t1.fincontingentactype,
		    t1.finisgenref,
		    t1.finmaxamount,
		    t1.finminamount,
		    t1.finisopennewfinac,
		    t1.findftstmtfrq,
		    t1.finisalwmd,
		    t1.finschdmthd,
		    t1.finisalwgrace,
		    t1.finhistretension,
		    t1.equalrepayment,
		    t1.finratetype,
		    t1.finbaserate,
		    t1.finsplrate,
		    t1.finintrate,
		    t1.finminrate,
		    t1.finmaxrate,
		    t1.findftintfrq,
		    t1.finisintcpz,
		    t1.fincpzfrq,
		    t1.finisrvwalw,
		    t1.finrvwfrq,
		    t1.fingrcratetype,
		    t1.fingrcbaserate,
		    t1.fingrcsplrate,
		    t1.fingrcintrate,
		    t1.fingrcminrate,
		    t1.fingrcmaxrate,
		    t1.fingrcdftintfrq,
		    t1.fingrcisintcpz,
		    t1.fingrccpzfrq,
		    t1.fingrcisrvwalw,
		    t1.fingrcrvwfrq,
		    t1.finminterm,
		    t1.finmaxterm,
		    t1.findftterms,
		    t1.finrpyfrq,
		    t1.finrepaymethod,
		    t1.finisalwpartialrpy,
		    t1.finisalwdifferment,
		    t1.finmaxdifferment,
		    t1.finisalwearlyrpy,
		    t1.finisalwearlysettle,
		    t1.finodrpytries,
		    t1.finearlypayrule,
		    t1.finearlysettlerule,
		    t1.findepositrestrictedto,
		    t1.finaebuyorinception,
		    t1.finaesellormaturity,
		    t1.finisactive,
		    t1.version,
		    t1.lastmntby,
		    t1.lastmnton,
		    t1.recordstatus,
		    t1.rolecode,
		    t1.nextrolecode,
		    t1.taskid,
		    t1.nexttaskid,
		    t1.recordtype,
		    t1.workflowid,
		    t1.stepfinance,
		    t1.steppingmandatory,
		    t1.alwmanualsteps,
		    t1.alwdsteppolicies,
		    t1.dftsteppolicy,
		    t4.actypedesc lovdescfincontingentactypename,
		    t5.actypedesc lovdescfinactypename,
		    t1.finisdwpayrequired,
		    t1.finrvwrateapplfor,
		    t1.finalwratechangeanydate,
		    t1.finisintcpzatgrcend,
		    t1.finelgrulecode,
		    t1.limitelgrulecode,
		    t1.finschcalcodeonrvw,
		    t1.alwplandeferment,
		    t1.plandefercount,
		    t1.finassettype,
		    t1.pftpayactype,
		    t1.finisopenpftpayacc,
		    t31.actypedesc lovdescpftpayactypename,
		    t1.finisalwgrcrepay,
		    t1.fingrcschdmthd,
		    t1.fingrcmargin,
		    t1.finmargin,
		    t1.finscheduleon,
		    t1.fingrcscheduleon,
		    t1.fincommitmentreq,
		    t1.fincollateralreq,
		    t1.findepreciationreq,
		    t1.findepreciationfrq,
		    t1.finbankcontingentactype,
		    t1.finprovisionactype,
		    t38.actypedesc lovdescfinbankcontactypename,
		    t39.actypedesc lovdescfinprovisionactypename,
		    t1.allowriainvestment,
		    t1.overridelimit,
		    t1.limitrequired,
		    t1.fincommitmentovrride,
		    t1.fincollateralovrride,
		    t1.finpftunchanged,
		    t1.applyodpenalty,
		    t1.odincgrcdays,
		    t1.odchargetype,
		    t1.odgracedays,
		    t1.odchargecalon,
		    t1.odchargeamtorperc,
		    t1.odallowwaiver,
		    t1.odmaxwaiverperc,
		    t1.findivision,
		    t48.divisioncodedesc lovdescfindivisionname,
		    t48.entitycode lovdescentitycode,
		    t1.finsuspactype,
		    t49.actypedesc lovdescfinsuspactypename,
		    t1.product,
		    t1.startdate,
		    t1.enddate,
		    t1.allowdownpaypgm,
		    t1.fintypedesc lovdescpromofintypedesc,
		    t1.remarks,
		    t1.alwearlypaymethods,
		    t1.pastduepftcalmthd,
		    t1.pastduepftmargin,
		    t1.alwadvancerent,
		    t1.grcadvbaserate,
		    t1.grcadvmargin,
		    t1.grcadvpftrate,
		    t1.rpyadvbaserate,
		    t1.rpyadvmargin,
		    t1.rpyadvpftrate,
		    t1.rolloverfinance,
		    t1.rolloverfrq,
		    t1.downpayrule,
		    t59.rulecode downpayruledesc,
		    t1.finsusptrigger,
		    t1.finsuspremarks,
		    t1.alwmultipartydisb,
		    t1.collateraltype,
		    t1.tdsapplicable,
		    t1.manualschedule,
		    t1.applygrcpricing,
		    t1.grcpricingmethod,
		    t1.applyrpypricing,
		    t1.rpypricingmethod,
		    t1.rpyhierarchy,
		    t67.rulecode grcpricingmethoddesc,
		    t68.rulecode rpypricingmethoddesc,
		    t1.droplineod,
		    t1.droppingmethod,
		    t1.ratechganyday,
		    t1.finrepaypftonfrq,
		    t1.alwbpi,
		    t1.bpitreatment,
		    t1.pftdueschon,
		    t1.planemihalw,
		    t1.planemihmethod,
		    t1.planemihmaxperyear,
		    t1.planemihmax,
		    t1.planemihlockperiod,
		    t1.planemicpz,
		    t1.unplanemihlockperiod,
		    t1.unplanemicpz,
		    t1.reagecpz,
		    t1.fddlockperiod,
		    t1.alwdrpymethods,
		    t1.maxunplannedemi,
		    t1.maxreageholidays,
		    t1.roundingmode,
		    t1.roundingtarget,
		    t1.frequencydays,
		    t1.quickdisb,
		    t1.alwmaxdisbcheckreq,
		    t1.alwreage,
		    t1.alwunplanemiholiday,
		    t1.profitcenterid,
		    t69.profitcentercode,
		    t69.profitcenterdesc,
		    t1.productcategory,
		    t2.productdesc fincategorydesc,
		    t1.developerfinance,
		    t1.costoffunds,
		    t1.chequecapturereq,
		    t1.finltvcheck,
		    t1.partiallysecured,
		    t1.alwadvemi,
		    t1.advemiminterms,
		    t1.advemimaxterms,
		    t1.advemidftterms,
		    t1.advemischdmthd,
		    t1.bpipftdaysbasis,
		    t1.eligibilitymethods,
		    t1.alwhybridrate,
		    t1.fixedratetenor,
		    t1.odmincapamount,
		    t1.odrulecode,
		    t1.alwzerointacc,
		    t1.autorejectiondays,
		    t1.taxnomand,
			t1.PutCallRequired
		   FROM rmtfinancetypes_temp t1
		     LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
		     LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
		     LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
		     LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
		     LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
		     LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
		     LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
		     LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
		     LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
		     LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
		     LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
		     LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
		UNION ALL
		 SELECT t1.fintype,
		    t1.fincategory,
		    t1.fintypedesc,
		    t1.finccy,
		    t1.findayscaltype,
		    t1.finactype,
		    t1.fincontingentactype,
		    t1.finisgenref,
		    t1.finmaxamount,
		    t1.finminamount,
		    t1.finisopennewfinac,
		    t1.findftstmtfrq,
		    t1.finisalwmd,
		    t1.finschdmthd,
		    t1.finisalwgrace,
		    t1.finhistretension,
		    t1.equalrepayment,
		    t1.finratetype,
		    t1.finbaserate,
		    t1.finsplrate,
		    t1.finintrate,
		    t1.finminrate,
		    t1.finmaxrate,
		    t1.findftintfrq,
		    t1.finisintcpz,
		    t1.fincpzfrq,
		    t1.finisrvwalw,
		    t1.finrvwfrq,
		    t1.fingrcratetype,
		    t1.fingrcbaserate,
		    t1.fingrcsplrate,
		    t1.fingrcintrate,
		    t1.fingrcminrate,
		    t1.fingrcmaxrate,
		    t1.fingrcdftintfrq,
		    t1.fingrcisintcpz,
		    t1.fingrccpzfrq,
		    t1.fingrcisrvwalw,
		    t1.fingrcrvwfrq,
		    t1.finminterm,
		    t1.finmaxterm,
		    t1.findftterms,
		    t1.finrpyfrq,
		    t1.finrepaymethod,
		    t1.finisalwpartialrpy,
		    t1.finisalwdifferment,
		    t1.finmaxdifferment,
		    t1.finisalwearlyrpy,
		    t1.finisalwearlysettle,
		    t1.finodrpytries,
		    t1.finearlypayrule,
		    t1.finearlysettlerule,
		    t1.findepositrestrictedto,
		    t1.finaebuyorinception,
		    t1.finaesellormaturity,
		    t1.finisactive,
		    t1.version,
		    t1.lastmntby,
		    t1.lastmnton,
		    t1.recordstatus,
		    t1.rolecode,
		    t1.nextrolecode,
		    t1.taskid,
		    t1.nexttaskid,
		    t1.recordtype,
		    t1.workflowid,
		    t1.stepfinance,
		    t1.steppingmandatory,
		    t1.alwmanualsteps,
		    t1.alwdsteppolicies,
		    t1.dftsteppolicy,
		    t4.actypedesc lovdescfincontingentactypename,
		    t5.actypedesc lovdescfinactypename,
		    t1.finisdwpayrequired,
		    t1.finrvwrateapplfor,
		    t1.finalwratechangeanydate,
		    t1.finisintcpzatgrcend,
		    t1.finelgrulecode,
		    t1.limitelgrulecode,
		    t1.finschcalcodeonrvw,
		    t1.alwplandeferment,
		    t1.plandefercount,
		    t1.finassettype,
		    t1.pftpayactype,
		    t1.finisopenpftpayacc,
		    t31.actypedesc AS lovdescpftpayactypename,
		    t1.finisalwgrcrepay,
		    t1.fingrcschdmthd,
		    t1.fingrcmargin,
		    t1.finmargin,
		    t1.finscheduleon,
		    t1.fingrcscheduleon,
		    t1.fincommitmentreq,
		    t1.fincollateralreq,
		    t1.findepreciationreq,
		    t1.findepreciationfrq,
		    t1.finbankcontingentactype,
		    t1.finprovisionactype,
		    t38.actypedesc lovdescfinbankcontactypename,
		    t39.actypedesc lovdescfinprovisionactypename,
		    t1.allowriainvestment,
		    t1.overridelimit,
		    t1.limitrequired,
		    t1.fincommitmentovrride,
		    t1.fincollateralovrride,
		    t1.finpftunchanged,
		    t1.applyodpenalty,
		    t1.odincgrcdays,
		    t1.odchargetype,
		    t1.odgracedays,
		    t1.odchargecalon,
		    t1.odchargeamtorperc,
		    t1.odallowwaiver,
		    t1.odmaxwaiverperc,
		    t1.findivision,
		    t48.divisioncodedesc lovdescfindivisionname,
		    t48.entitycode lovdescentitycode,
		    t1.finsuspactype,
		    t49.actypedesc lovdescfinsuspactypename,
		    t1.product,
		    t1.startdate,
		    t1.enddate,
		    t1.allowdownpaypgm,
		    t1.fintypedesc lovdescpromofintypedesc,
		    t1.remarks,
		    t1.alwearlypaymethods,
		    t1.pastduepftcalmthd,
		    t1.pastduepftmargin,
		    t1.alwadvancerent,
		    t1.grcadvbaserate,
		    t1.grcadvmargin,
		    t1.grcadvpftrate,
		    t1.rpyadvbaserate,
		    t1.rpyadvmargin,
		    t1.rpyadvpftrate,
		    t1.rolloverfinance,
		    t1.rolloverfrq,
		    t1.downpayrule,
		    t59.rulecode downpayruledesc,
		    t1.finsusptrigger,
		    t1.finsuspremarks,
		    t1.alwmultipartydisb,
		    t1.collateraltype,
		    t1.tdsapplicable,
		    t1.manualschedule,
		    t1.applygrcpricing,
		    t1.grcpricingmethod,
		    t1.applyrpypricing,
		    t1.rpypricingmethod,
		    t1.rpyhierarchy,
		    t67.rulecode grcpricingmethoddesc,
		    t68.rulecode rpypricingmethoddesc,
		    t1.droplineod,
		    t1.droppingmethod,
		    t1.ratechganyday,
		    t1.finrepaypftonfrq,
		    t1.alwbpi,
		    t1.bpitreatment,
		    t1.pftdueschon,
		    t1.planemihalw,
		    t1.planemihmethod,
		    t1.planemihmaxperyear,
		    t1.planemihmax,
		    t1.planemihlockperiod,
		    t1.planemicpz,
		    t1.unplanemihlockperiod,
		    t1.unplanemicpz,
		    t1.reagecpz,
		    t1.fddlockperiod,
		    t1.alwdrpymethods,
		    t1.maxunplannedemi,
		    t1.maxreageholidays,
		    t1.roundingmode,
		    t1.roundingtarget,
		    t1.frequencydays,
		    t1.quickdisb,
		    t1.alwmaxdisbcheckreq,
		    t1.alwreage,
		    t1.alwunplanemiholiday,
		    t1.profitcenterid,
		    t69.profitcentercode,
		    t69.profitcenterdesc,
		    t1.productcategory,
		    t2.productdesc fincategorydesc,
		    t1.developerfinance,
		    t1.costoffunds,
		    t1.chequecapturereq,
		    t1.finltvcheck,
		    t1.partiallysecured,
		    t1.alwadvemi,
		    t1.advemiminterms,
		    t1.advemimaxterms,
		    t1.advemidftterms,
		    t1.advemischdmthd,
		    t1.bpipftdaysbasis,
		    t1.eligibilitymethods,
		    t1.alwhybridrate,
		    t1.fixedratetenor,
		    t1.odmincapamount,
		    t1.odrulecode,
		    t1.alwzerointacc,
		    t1.autorejectiondays,
		    t1.taxnomand,
		  	t1.PutCallRequired
		   FROM rmtfinancetypes t1
		     LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
		     LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
		     LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
		     LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
		     LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
		     LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
		     LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
		     LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
		     LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
		     LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
		     LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
		     LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
		  WHERE NOT (EXISTS ( SELECT 1 AS expr1
		           FROM rmtfinancetypes_temp
		          WHERE rmtfinancetypes_temp.fintype = t1.fintype))
	</createView>
	</changeSet>
	
	<changeSet id="4" author="shinde.b">
		<createView viewName="RMTFINANCETYPES_AVIEW" replaceIfExists="true">
			SELECT t1.fintype,
		    t1.fincategory,
		    t1.fintypedesc,
		    t1.finccy,
		    t1.findayscaltype,
		    t1.finactype,
		    t1.fincontingentactype,
		    t1.finisgenref,
		    t1.finmaxamount,
		    t1.finminamount,
		    t1.finisopennewfinac,
		    t1.findftstmtfrq,
		    t1.finisalwmd,
		    t1.finschdmthd,
		    t1.finisalwgrace,
		    t1.finhistretension,
		    t1.equalrepayment,
		    t1.finratetype,
		    t1.finbaserate,
		    t1.finsplrate,
		    t1.finintrate,
		    t1.finminrate,
		    t1.finmaxrate,
		    t1.findftintfrq,
		    t1.finisintcpz,
		    t1.fincpzfrq,
		    t1.finisrvwalw,
		    t1.finrvwfrq,
		    t1.fingrcratetype,
		    t1.fingrcbaserate,
		    t1.fingrcsplrate,
		    t1.fingrcintrate,
		    t1.fingrcminrate,
		    t1.fingrcmaxrate,
		    t1.fingrcdftintfrq,
		    t1.fingrcisintcpz,
		    t1.fingrccpzfrq,
		    t1.fingrcisrvwalw,
		    t1.fingrcrvwfrq,
		    t1.finminterm,
		    t1.finmaxterm,
		    t1.findftterms,
		    t1.finrpyfrq,
		    t1.finrepaymethod,
		    t1.finisalwpartialrpy,
		    t1.finisalwdifferment,
		    t1.finmaxdifferment,
		    t1.finisalwearlyrpy,
		    t1.finisalwearlysettle,
		    t1.finodrpytries,
		    t1.finearlypayrule,
		    t1.finearlysettlerule,
		    t1.findepositrestrictedto,
		    t1.finaebuyorinception,
		    t1.finaesellormaturity,
		    t1.finisactive,
		    t1.version,
		    t1.lastmntby,
		    t1.lastmnton,
		    t1.recordstatus,
		    t1.rolecode,
		    t1.nextrolecode,
		    t1.taskid,
		    t1.nexttaskid,
		    t1.recordtype,
		    t1.workflowid,
		    t1.stepfinance,
		    t1.steppingmandatory,
		    t1.alwmanualsteps,
		    t1.alwdsteppolicies,
		    t1.dftsteppolicy,
		    t4.actypedesc lovdescfincontingentactypename,
		    t5.actypedesc lovdescfinactypename,
		    t1.finisdwpayrequired,
		    t1.finrvwrateapplfor,
		    t1.finalwratechangeanydate,
		    t1.finisintcpzatgrcend,
		    t1.finelgrulecode,
		    t1.limitelgrulecode,
		    t1.finschcalcodeonrvw,
		    t1.alwplandeferment,
		    t1.plandefercount,
		    t1.finassettype,
		    t1.pftpayactype,
		    t1.finisopenpftpayacc,
		    t31.actypedesc lovdescpftpayactypename,
		    t1.finisalwgrcrepay,
		    t1.fingrcschdmthd,
		    t1.fingrcmargin,
		    t1.finmargin,
		    t1.finscheduleon,
		    t1.fingrcscheduleon,
		    t1.fincommitmentreq,
		    t1.fincollateralreq,
		    t1.findepreciationreq,
		    t1.findepreciationfrq,
		    t1.finbankcontingentactype,
		    t1.finprovisionactype,
		    t38.actypedesc lovdescfinbankcontactypename,
		    t39.actypedesc lovdescfinprovisionactypename,
		    t1.allowriainvestment,
		    t1.overridelimit,
		    t1.limitrequired,
		    t1.fincommitmentovrride,
		    t1.fincollateralovrride,
		    t1.finpftunchanged,
		    t1.applyodpenalty,
		    t1.odincgrcdays,
		    t1.odchargetype,
		    t1.odgracedays,
		    t1.odchargecalon,
		    t1.odchargeamtorperc,
		    t1.odallowwaiver,
		    t1.odmaxwaiverperc,
		    t1.findivision,
		    t48.divisioncodedesc lovdescfindivisionname,
		    t48.entitycode lovdescentitycode,
		    t1.finsuspactype,
		    t49.actypedesc lovdescfinsuspactypename,
		    t1.product,
		    t1.startdate,
		    t1.enddate,
		    t1.allowdownpaypgm,
		    t1.remarks,
		    t1.alwearlypaymethods,
		    t1.pastduepftcalmthd,
		    t1.pastduepftmargin,
		    t1.alwadvancerent,
		    t1.grcadvbaserate,
		    t1.grcadvmargin,
		    t1.grcadvpftrate,
		    t1.rpyadvbaserate,
		    t1.rpyadvmargin,
		    t1.rpyadvpftrate,
		    t1.rolloverfinance,
		    t1.rolloverfrq,
		    t1.downpayrule,
		    t59.rulecode downpayruledesc,
		    t1.finsusptrigger,
		    t1.finsuspremarks,
		    t1.alwmultipartydisb,
		    t1.collateraltype,
		    t1.tdsapplicable,
		    t1.manualschedule,
		    t1.applygrcpricing,
		    t1.grcpricingmethod,
		    t1.applyrpypricing,
		    t1.rpypricingmethod,
		    t1.rpyhierarchy,
		    t67.rulecode grcpricingmethoddesc,
		    t68.rulecode rpypricingmethoddesc,
		    t1.droplineod,
		    t1.droppingmethod,
		    t1.ratechganyday,
		    t1.finrepaypftonfrq,
		    t1.alwbpi,
		    t1.bpitreatment,
		    t1.pftdueschon,
		    t1.planemihalw,
		    t1.planemihmethod,
		    t1.planemihmaxperyear,
		    t1.planemihmax,
		    t1.planemihlockperiod,
		    t1.planemicpz,
		    t1.unplanemihlockperiod,
		    t1.unplanemicpz,
		    t1.reagecpz,
		    t1.fddlockperiod,
		    t1.alwdrpymethods,
		    t1.maxunplannedemi,
		    t1.maxreageholidays,
		    t1.roundingmode,
		    t1.roundingtarget,
		    t1.frequencydays,
		    t1.quickdisb,
		    t1.alwreage,
		    t1.alwunplanemiholiday,
		    t1.alwmaxdisbcheckreq,
		    t1.fintypedesc lovdescpromofintypedesc,
		    t1.profitcenterid,
		    t69.profitcentercode,
		    t69.profitcenterdesc,
		    t1.productcategory,
		    t2.productdesc fincategorydesc,
		    t1.developerfinance,
		    t1.costoffunds,
		    t1.chequecapturereq,
		    t1.finltvcheck,
		    t1.partiallysecured,
		    t1.alwadvemi,
		    t1.advemiminterms,
		    t1.advemimaxterms,
		    t1.advemidftterms,
		    t1.advemischdmthd,
		    t1.bpipftdaysbasis,
		    t1.eligibilitymethods,
		    t1.alwhybridrate,
		    t1.fixedratetenor,
		    t1.odmincapamount,
		    t1.odrulecode,
		    t1.alwzerointacc,
		    t1.autorejectiondays,
		    t1.taxnomand,
			t1.PutCallRequired
		   FROM rmtfinancetypes t1
		     LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
		     LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
		     LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
		     LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
		     LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
		     LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
		     LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
		     LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
		     LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
		     LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
		     LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
		     LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
	</createView>
	</changeSet>

	<changeSet id="5" author="shinde.b">
		<createView viewName="RMTFINANCETYPES_ORGVIEW" replaceIfExists="true">
			 SELECT t1.fintype,
		    t1.fincategory,
		    t1.fintypedesc,
		    t1.finccy,
		    t1.findayscaltype,
		    t1.finactype,
		    t1.fincontingentactype,
		    t1.finisgenref,
		    t1.finmaxamount,
		    t1.finminamount,
		    t1.finisopennewfinac,
		    t1.finisalwmd,
		    t1.finschdmthd,
		    t1.finisalwgrace,
		    t1.equalrepayment,
		    t1.finratetype,
		    t1.finbaserate,
		    t1.finsplrate,
		    t1.finintrate,
		    t1.finminrate,
		    t1.finmaxrate,
		    t1.findftintfrq,
		    t1.finisintcpz,
		    t1.fincpzfrq,
		    t1.finisrvwalw,
		    t1.finrvwfrq,
		    t1.fingrcratetype,
		    t1.fingrcbaserate,
		    t1.fingrcsplrate,
		    t1.fingrcintrate,
		    t1.fingrcminrate,
		    t1.fingrcmaxrate,
		    t1.fingrcdftintfrq,
		    t1.fingrcisintcpz,
		    t1.fingrccpzfrq,
		    t1.fingrcisrvwalw,
		    t1.fingrcrvwfrq,
		    t1.finminterm,
		    t1.finmaxterm,
		    t1.findftterms,
		    t1.finrpyfrq,
		    t1.finrepaymethod,
		    t1.finisalwdifferment,
		    t1.finmaxdifferment,
		    t1.finisactive,
		    t1.stepfinance,
		    t1.steppingmandatory,
		    t1.alwmanualsteps,
		    t1.alwdsteppolicies,
		    t1.dftsteppolicy,
		    t1.finisdwpayrequired,
		    t1.finrvwrateapplfor,
		    t1.finalwratechangeanydate,
		    t1.finisintcpzatgrcend,
		    t1.finschcalcodeonrvw,
		    t1.alwplandeferment,
		    t1.plandefercount,
		    t1.pftpayactype,
		    t1.finisopenpftpayacc,
		    t1.finisalwgrcrepay,
		    t1.fingrcschdmthd,
		    t1.fingrcmargin,
		    t1.finmargin,
		    t1.fincommitmentreq,
		    t1.fincollateralreq,
		    t1.findepreciationreq,
		    t1.findepreciationfrq,
		    t1.finbankcontingentactype,
		    t1.finprovisionactype,
		    t1.allowriainvestment,
		    t1.overridelimit,
		    t1.limitrequired,
		    t1.fincommitmentovrride,
		    t1.fincollateralovrride,
		    t1.finrepaypftonfrq,
		    t1.finpftunchanged,
		    t1.applyodpenalty,
		    t1.odincgrcdays,
		    t1.odchargetype,
		    t1.odgracedays,
		    t1.odchargecalon,
		    t1.odchargeamtorperc,
		    t1.odallowwaiver,
		    t1.odmaxwaiverperc,
		    t1.findivision,
		    t3.divisioncodedesc lovdescfindivisionname,
		    t1.finsuspactype,
		    t1.product,
		    t1.startdate,
		    t1.enddate,
		    t1.allowdownpaypgm,
		    t1.fintypedesc lovdescpromofintypedesc,
		    t1.remarks,
		    t4.policydesc lovdescdftsteppolicyname,
		    t1.pastduepftcalmthd,
		    t1.pastduepftmargin,
		    t1.alwadvancerent,
		    t1.grcadvbaserate,
		    t1.grcadvmargin,
		    t1.grcadvpftrate,
		    t1.rpyadvbaserate,
		    t1.rpyadvmargin,
		    t1.rpyadvpftrate,
		    t1.rolloverfinance,
		    t1.rolloverfrq,
		    t1.downpayrule,
		    t1.alwmultipartydisb,
		    t1.collateraltype,
		    t1.tdsapplicable,
		    t5.rulecode downpayruledesc,
		    t1.applygrcpricing,
		    t1.applyrpypricing,
		    t6.rulecode grcpricingmethoddesc,
		    t7.rulecode rpypricingmethoddesc,
		    t1.droplineod,
		    t1.droppingmethod,
		    t1.ratechganyday,
		    t4.steptype dftsteppolicytype,
		    t1.manualschedule,
		    t1.alwbpi,
		    t1.bpitreatment,
		    t1.pftdueschon,
		    t1.planemihalw,
		    t1.planemihmethod,
		    t1.planemihmaxperyear,
		    t1.planemihmax,
		    t1.planemihlockperiod,
		    t1.planemicpz,
		    t1.unplanemihlockperiod,
		    t1.unplanemicpz,
		    t1.reagecpz,
		    t1.fddlockperiod,
		    t1.alwdrpymethods,
		    t1.maxunplannedemi,
		    t1.maxreageholidays,
		    t1.roundingmode,
		    t1.roundingtarget,
		    t1.frequencydays,
		    t1.quickdisb,
		    t1.alwreage,
		    t1.alwunplanemiholiday,
		    t1.alwmaxdisbcheckreq,
		    t1.productcategory,
		    t1.rpyhierarchy,
		    t1.developerfinance,
		    t3.entitycode lovdescentitycode,
		    t8.entitydesc lovdescentitydesc,
		    t1.costoffunds,
		    t1.chequecapturereq,
		    t1.finltvcheck,
		    t1.partiallysecured,
		    t1.alwadvemi,
		    t1.advemiminterms,
		    t1.advemimaxterms,
		    t1.advemidftterms,
		    t1.advemischdmthd,
		    t1.bpipftdaysbasis,
		    t1.eligibilitymethods,
		    t1.alwhybridrate,
		    t1.fixedratetenor,
		    t1.odmincapamount,
		    t1.odrulecode,
		    t1.alwzerointacc,
		    t1.finisalwpartialrpy,
		    t1.autorejectiondays,
		    t1.taxnomand,
			t1.PutCallRequired
		   FROM rmtfinancetypes t1
		     JOIN smtdivisiondetail t3 ON t1.findivision = t3.divisioncode
		     LEFT JOIN steppolicyheader t4 ON t1.dftsteppolicy = t4.policycode
		     LEFT JOIN rules t5 ON t1.downpayrule = t5.ruleid
		     LEFT JOIN rules t6 ON t1.grcpricingmethod = t6.ruleid
		     LEFT JOIN rules t7 ON t1.rpypricingmethod = t7.ruleid
		     LEFT JOIN entity t8 ON t3.entitycode = t8.entitycode
		</createView>
	</changeSet>

	<changeSet id="6" author="shinde.b" dbms="postgresql, oracle">
		<createSequence sequenceName="SEQ_FIN_OPTIONS" />
	</changeSet>

	<changeSet id="6" author="shinde.b" dbms="mssql">
		<createTable tableName="SEQ_FIN_OPTIONS">
			<column name="SeqNo" type="bigint" autoIncrement="true" />
			<column name="Value" type="int"></column>
		</createTable>
	</changeSet>

	<changeSet id="7" author="shinde.b">
		<createTable tableName="FIN_OPTIONS">
			<column name="Id" type="bigint">
				<constraints nullable="false" primaryKey="true" primaryKeyName="PK_FIN_OPTIONS" />
			</column>
			<column name="Finreference" type="varchar(20)" />
			<column name="OptionType" type="varchar(20)" />
			<column name="CurrentOptionDate" type="datetime" />
			<column name="Frequency" type="varchar(20)" />
			<column name="NoticePeriodDays" type="smallint" />
			<column name="AlertDays" type="smallint" />
			<column name="OptionExercise" type="boolean" />
			<column name="NextOptionDate" type="datetime" />
			<column name="AlertType" type="varchar(10)" />
			<column name="AlertToRoles" type="varchar(1000)" />
			<column name="UserTemplate" type="bigint" />
			<column name="CustomerTemplate" type="bigint" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="8" author="shinde.b">
		<createTable tableName="FIN_OPTIONS_TEMP">
			<column name="Id" type="bigint">
				<constraints nullable="false" primaryKey="true" primaryKeyName="PK_FIN_OPTIONS_TEMP" />
			</column>
			<column name="Finreference" type="varchar(20)" />
			<column name="OptionType" type="varchar(20)" />
			<column name="CurrentOptionDate" type="datetime" />
			<column name="Frequency" type="varchar(20)" />
			<column name="NoticePeriodDays" type="smallint" />
			<column name="AlertDays" type="smallint" />
			<column name="OptionExercise" type="boolean" />
			<column name="NextOptionDate" type="datetime" />
			<column name="AlertType" type="varchar(10)" />
			<column name="AlertToRoles" type="varchar(1000)" />
			<column name="UserTemplate" type="bigint" />
			<column name="CustomerTemplate" type="bigint" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="9" author="shinde.b">
		<addUniqueConstraint tableName="FIN_OPTIONS" columnNames="Finreference, OptionType" />
	</changeSet>

	<changeSet id="10" author="shinde.b">
		<addUniqueConstraint tableName="FIN_OPTIONS_TEMP" columnNames="Finreference, OptionType" />
	</changeSet>

	<changeSet id="11" author="shinde.b">
		<createView viewName="FIN_OPTIONS_VIEW">
			SELECT T1.Id,
					  T1.Finreference,
					  T1.OptionType,
					  T1.CurrentOptionDate,
					  T1.Frequency,
					  T1.NoticePeriodDays,
					  T1.AlertDays,
					  T1.OptionExercise,
					  T1.NextOptionDate,
					  T1.AlertType,
					  T1.AlertToRoles,
					  T1.UserTemplate,
					  T1.CustomerTemplate,
					  ut.TemplateCode UserTemplateCode,
                      cust.TemplateCode CustomerTemplateCode,
					  T1.Version,
					  T1.LastMntBy,
					  T1.LastMntOn,
					  T1.RecordStatus,
					  T1.RoleCode,
					  T1.NextRoleCode,
					  T1.TaskId,
					  T1.NextTaskId,
					  T1.RecordType,
					  T1.WorkflowId
					FROM FIN_OPTIONS_TEMP T1
					 left join Templates ut on ut.TemplateId = T1.UserTemplate
					 left join Templates cust on cust.TemplateId =T1.CustomerTemplate
					UNION ALL
					SELECT T1.Id,
					  T1.Finreference,
					  T1.OptionType,
					  T1.CurrentOptionDate,
					  T1.Frequency,
					  T1.NoticePeriodDays,
					  T1.AlertDays,
					  T1.OptionExercise,
					  T1.NextOptionDate,
					  T1.AlertType,
					  T1.AlertToRoles,
					  T1.UserTemplate,
					  T1.CustomerTemplate,
					  ut.TemplateCode UserTemplateCode,
                      cust.TemplateCode CustomerTemplateCode,
					  T1.Version,
					  T1.LastMntBy,
					  T1.LastMntOn,
					  T1.RecordStatus,
					  T1.RoleCode,
					  T1.NextRoleCode,
					  T1.TaskId,
					  T1.NextTaskId,
					  T1.RecordType,
					  T1.WorkflowId
					FROM  FIN_OPTIONS T1
					 left join Templates ut on ut.TemplateId = T1.UserTemplate
					  left join Templates cust on cust.TemplateId =T1.CustomerTemplate
					WHERE NOT EXISTS (SELECT 1 FROM FIN_OPTIONS_TEMP WHERE Id = T1.Id)
	    </createView>
	</changeSet>
	<changeSet id="26" author="shinde.b">
		<createView viewName="FIN_OPTIONS_AVIEW">
		      SELECT T1.Id,
					  T1.Finreference,
					  T1.OptionType,
					  T1.CurrentOptionDate,
					  T1.Frequency,
					  T1.NoticePeriodDays,
					  T1.AlertDays,
					  T1.OptionExercise,
					  T1.NextOptionDate,
					  T1.AlertType,
					  T1.AlertToRoles,
					  T1.UserTemplate,
					  T1.CustomerTemplate,
                      ut.TemplateCode UserTemplateCode,
                      cust.TemplateCode CustomerTemplateCode,
					  T1.Version,
					  T1.LastMntBy,
					  T1.LastMntOn,
					  T1.RecordStatus,
					  T1.RoleCode,
					  T1.NextRoleCode,
					  T1.TaskId,
					  T1.NextTaskId,
					  T1.RecordType,
					  T1.WorkflowId
					  FROM  FIN_OPTIONS T1
					  left join Templates ut on ut.TemplateId = T1.UserTemplate
					  left join Templates cust on cust.TemplateId =T1.CustomerTemplate
	     </createView>
	</changeSet>

	<changeSet id="27" author="amanullah.m">
		<createTable tableName="FIN_OPTION_ALERTS">
			<column name="Id" type="bigint" autoIncrement="true">
				<constraints nullable="false" primaryKey="true" primaryKeyName="PK_PUTCALL_ALERTS" />
			</column>
			<column name="FinOptiontId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="CurrentOptionDate" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="AlertFor" type="char(1)">
				<constraints nullable="false" />
			</column>
			<column name="NotificationId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="AlertSentOn" type="datetime">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="27.1" author="amanullah.m">
		<addForeignKeyConstraint constraintName="FK_FIN_OPTION_ALERTS_FOID" referencedTableName="FIN_OPTIONS" baseColumnNames="FinOptiontId"
			baseTableName="FIN_OPTION_ALERTS" referencedColumnNames="id" />
	</changeSet>

	<changeSet id="28" author="amanulla.m">
		<sql>
			<![CDATA[
				DELETE FROM TEMPLATEFIELDS WHERE EVENT = 'Putcall';
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'fm_finReference', 'Loan Reference Number', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'fm_finType', 'Loan Type', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'fm_lovDescFinTypeName', 'Loan Type Description', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'ct_custShrtName', 'Customer Name', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_currentOptionDate', 'Putcall Current option Date', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_code', 'Putcall Type Code', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_description', 'Putcall Description', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_frequency', 'Putcall Frequency', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_nextFrequencyDate', 'Putcall Next Frequency Date', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_nextOptionDate', 'Putcall Next Option Date', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_totalPriBal', 'Putcall Total Principal balance', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_penaltyPaid', 'Putcall Penalty paid', 'A', 'Putcall');
				INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_totalAmt', 'Putcall Total', 'A', 'Putcall');
			]]>
		</sql>
	</changeSet>
	<changeSet id="29" author="Shinde.b">
		<createView viewName="FinoptionsMaintenance_view" replaceIfExists="true">
			SELECT T1.FINREFERENCE,
			  T1.FINBRANCH,
			  T1.FINTYPE,
			  T1.FINCCY,
			  T1.SCHEDULEMETHOD,
			  T1.PROFITDAYSBASIS,
			  T1.FINSTARTDATE,
			  T1.NUMBEROFTERMS,
			  T1.CUSTID,
			  T1.FINAMOUNT,
			  T1.MATURITYDATE,
			  T1.FINREPAYMENTAMOUNT,
			  T1.FINISACTIVE,
			  T1.BLACKLISTED,
			  T1.FEECHARGEAMT,
			  T1.INSURANCEAMT,
			  T1.GRACETERMS,
			  T1.ALLOWGRCPERIOD,
			  T1.GRCPERIODENDDATE,
			  T1.ALWMULTIDISB,
			  T1.DEFFERMENTS,
			  T1.ALLOWGRCPFTRVW,
			  T1.ALLOWREPAYRVW,
			  T1.LASTREPAYDATE,
			  T1.LASTREPAYPFTDATE,
			  T1.ALLOWEDDEFRPYCHANGE,
			  T1.AVAILEDDEFRPYCHANGE,
			  T1.MIGRATEDFINANCE,
			  T1.CLOSINGSTATUS,
			  T1.REPAYRATEBASIS,
			  T1.MANUALSCHEDULE,
			  T1.FINCURRASSETVALUE,
			  T1.TAKEOVERFINANCE ,
			  T1.NEXTROLLOVERDATE,
			  T1.AVAILEDUNPLANEMI,
			  T1.AVAILEDREAGEH,
			  T1.MAXUNPLANNEDEMI,
			  T1.MAXREAGEHOLIDAYS,
			  T1.DOWNPAYMENT,
			  T1.PLANEMIHALW,
			  T1.CALTERMS,
			  T1.RATECHGANYDAY,
			  T1.FINASSETVALUE,
			  T2.CUSTCIF LOVDESCCUSTCIF,
			  T3.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
			  T3.FINDIVISION LOVDESCFINDIVISION,
			  T3.FINCATEGORY LOVDESCPRODUCTCODENAME,
			  T4.PRODUCTCATEGORY,
			  COALESCE(T9.NOINST,0) NOINST,
			  COALESCE(T5.ROLEDESC, ${add.schema}FN_GET_ROLEDESC(T10.NEXTROLECODE)) LOVDESCREQUESTSTAGE,
			  T10.FINMAINTAINID,
			  T10.EVENT RCDMAINTAINSTS,
			  T10.NEXTROLECODE,
			  T10.RECORDSTATUS,
			  T10.RECORDTYPE
			FROM FINMAINTAININSTRUCTIONS_TEMP T10
			INNER JOIN FINANCEMAIN T1 ON T1.FINREFERENCE = T10.FINREFERENCE
			INNER JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
			INNER JOIN RMTFINANCETYPES T3 ON T1.FINTYPE = T3.FINTYPE
			LEFT OUTER JOIN SECROLES T5 ON T10.NEXTROLECODE = T5.ROLECD
			INNER JOIN BMTPRODUCT T4 ON T3.FINCATEGORY = T4.PRODUCTCODE
			LEFT JOIN FINPFTDETAILS T9 ON T1.FINREFERENCE = T9.FINREFERENCE
			WHERE T10.EVENT    = 'FinOptions'
			UNION ALL
			SELECT T1.FINREFERENCE,
			  T1.FINBRANCH,
			  T1.FINTYPE,
			  T1.FINCCY,
			  T1.SCHEDULEMETHOD,
			  T1.PROFITDAYSBASIS,
			  T1.FINSTARTDATE,
			  T1.NUMBEROFTERMS,
			  T1.CUSTID,
			  T1.FINAMOUNT,
			  T1.MATURITYDATE,
			  T1.FINREPAYMENTAMOUNT,
			  T1.FINISACTIVE,
			  T1.BLACKLISTED,
			  T1.FEECHARGEAMT,
			  T1.INSURANCEAMT,
			  T1.GRACETERMS,
			  T1.ALLOWGRCPERIOD,
			  T1.GRCPERIODENDDATE,
			  T1.ALWMULTIDISB,
			  T1.DEFFERMENTS,
			  T1.ALLOWGRCPFTRVW,
			  T1.ALLOWREPAYRVW,
			  T1.LASTREPAYDATE,
			  T1.LASTREPAYPFTDATE,
			  T1.ALLOWEDDEFRPYCHANGE,
			  T1.AVAILEDDEFRPYCHANGE,
			  T1.MIGRATEDFINANCE,
			  T1.CLOSINGSTATUS,
			  T1.REPAYRATEBASIS,
			  T1.MANUALSCHEDULE,
			  T1.FINCURRASSETVALUE,
			  T1.TAKEOVERFINANCE ,
			  T1.NEXTROLLOVERDATE,
			  T1.AVAILEDUNPLANEMI,
			  T1.AVAILEDREAGEH,
			  T1.MAXUNPLANNEDEMI,
			  T1.MAXREAGEHOLIDAYS,
			  T1.DOWNPAYMENT,
			  T1.PLANEMIHALW,
			  T1.CALTERMS,
			  T1.RATECHGANYDAY,
			  T1.FINASSETVALUE,
			  T2.CUSTCIF LOVDESCCUSTCIF,
			  T3.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
			  T3.FINDIVISION LOVDESCFINDIVISION,
			  T3.FINCATEGORY LOVDESCPRODUCTCODENAME,
			  T4.PRODUCTCATEGORY,
			  COALESCE(T9.NOINST,0) NOINST,
			  NULL LOVDESCREQUESTSTAGE,
			  NULL FINMAINTAINID,
			  NULL RCDMAINTAINSTS,
			  NULL NEXTROLECODE,
			  NULL RECORDSTATUS,
			  NULL RECORDTYPE
			FROM FINANCEMAIN T1
			INNER JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
			INNER JOIN RMTFINANCETYPES T3 ON T1.FINTYPE = T3.FINTYPE
			LEFT OUTER JOIN SECROLES T5 ON T1.NEXTROLECODE = T5.ROLECD
			INNER JOIN BMTPRODUCT T4 ON T3.FINCATEGORY = T4.PRODUCTCODE
			LEFT JOIN FINPFTDETAILS T9 ON T1.FINREFERENCE = T9.FINREFERENCE
			WHERE (NOT EXISTS (SELECT 1 EXPR1 FROM FINMAINTAININSTRUCTIONS_TEMP WHERE (FINREFERENCE = T1.FINREFERENCE)
			))
		</createView>
	</changeSet>
	
	<changeSet id="30" author="shinde.b">
		<sql>
			<![CDATA[
				Insert into REPORTCONFIGURATION values ((select max(reportid)+1 from REPORTCONFIGURATION), 'Excel:PUT-CALL Report', 'PUT-CALL Report', 1, 'PutCallReport', 'dataSource', 1, 'menu_Item_Put_CallReport', 1, 1000, null, null, null, null, null, null, 0, current_timestamp, 0, 1);
				Insert into REPORTFILTERFIELDS values ((select reportid from REPORTCONFIGURATION where menuitemcode='menu_Item_Put_CallReport'), 1, 'Reference', 'LOVSEARCH', 'Reference', 'T.KeyReference', null, 'FinanceMain', 'getFinReference', 'getFinReference', 1, 0, 0, 0, 1, 1, null, null, null, null, 150, 0, '=', 1, 1000, 'Approved', null, null, null, null, null, 0, current_timestamp, null);
				Insert into REPORTFILTERFIELDS values ((select reportid from REPORTCONFIGURATION where menuitemcode='menu_Item_Put_CallReport'), 2, 'Cust CIF', 'LOVSEARCH', 'Customer Number', 't2.custcif', null, 'Customer', 'getCustCIF', 'getCustShrtName', 1, 0, 0, 0, 2, 0, ' ', ' ', ' ', ' ', 250, 0, '=', 1, 1000, 'Approved', null, null, null, null, null, 0, current_timestamp, null);
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="31" author="shinde.b">
		<sql>
			<![CDATA[
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights);
				
				INSERT INTO SecGroups Values ((Select max(GrpID)+1 From SecGroups), 'PUT_CALL_REPORTS','Group for Put-call Report', 1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),0, 'menu_Item_Put_CallReport', 'MENU', 0, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'PUT_CALL_REPORTS'), (Select RightID from SecRights where RightName = 'menu_Item_Put_CallReport'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights);
			]]>
		</sql>
	</changeSet>
</databaseChangeLog>