<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="Adarsh" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>
  
  <changeSet id="1" author="Shinde.b">
		<addColumn tableName="RMTFinanceTypes">
			<column name="AutoApprove" type="boolean" defaultValueBoolean="0" />
		</addColumn>
	</changeSet>
	
	<changeSet id="2" author="Shinde.b">
		<addColumn tableName="RMTFinanceTypes_Temp">
			<column name="AutoApprove" type="boolean" defaultValueBoolean="0"/>
		</addColumn>
	</changeSet>
	
	<changeSet id="3" author="Shinde.b">
		<sql>
			Update RMTFinanceTypes set AutoApprove = 0;
			Update RMTFinanceTypes_Temp set AutoApprove = 0;
		</sql>
	</changeSet>
	
	<changeSet id="4" author="Shinde.b">
        <createView viewName="RMTFINANCETYPES_VIEW" replaceIfExists="true">
				   SELECT t1.fintype,
					    t1.fincategory,
					    t1.fintypedesc,
					    t1.finccy,
					    t1.findayscaltype,
					    t1.finactype,
					    t1.fincontingentactype,
					    t1.finisgenref,
					    t1.finmaxamount,
					    t1.finminamount,
					    t1.finisopennewfinac,
					    t1.findftstmtfrq,
					    t1.finisalwmd,
					    t1.finschdmthd,
					    t1.finisalwgrace,
					    t1.finhistretension,
					    t1.equalrepayment,
					    t1.finratetype,
					    t1.finbaserate,
					    t1.finsplrate,
					    t1.finintrate,
					    t1.finminrate,
					    t1.finmaxrate,
					    t1.findftintfrq,
					    t1.finisintcpz,
					    t1.fincpzfrq,
					    t1.finisrvwalw,
					    t1.finrvwfrq,
					    t1.fingrcratetype,
					    t1.fingrcbaserate,
					    t1.fingrcsplrate,
					    t1.fingrcintrate,
					    t1.fingrcminrate,
					    t1.fingrcmaxrate,
					    t1.fingrcdftintfrq,
					    t1.fingrcisintcpz,
					    t1.fingrccpzfrq,
					    t1.fingrcisrvwalw,
					    t1.fingrcrvwfrq,
					    t1.finminterm,
					    t1.finmaxterm,
					    t1.findftterms,
					    t1.finrpyfrq,
					    t1.finrepaymethod,
					    t1.finisalwpartialrpy,
					    t1.finisalwdifferment,
					    t1.finmaxdifferment,
					    t1.finisalwearlyrpy,
					    t1.finisalwearlysettle,
					    t1.finodrpytries,
					    t1.finearlypayrule,
					    t1.finearlysettlerule,
					    t1.findepositrestrictedto,
					    t1.finaebuyorinception,
					    t1.finaesellormaturity,
					    t1.finisactive,
					    t1.version,
					    t1.lastmntby,
					    t1.lastmnton,
					    t1.recordstatus,
					    t1.rolecode,
					    t1.nextrolecode,
					    t1.taskid,
					    t1.nexttaskid,
					    t1.recordtype,
					    t1.workflowid,
					    t1.stepfinance,
					    t1.steppingmandatory,
					    t1.alwmanualsteps,
					    t1.alwdsteppolicies,
					    t1.dftsteppolicy,
					    t4.actypedesc AS lovdescfincontingentactypename,
					    t5.actypedesc AS lovdescfinactypename,
					    t1.finisdwpayrequired,
					    t1.finrvwrateapplfor,
					    t1.finalwratechangeanydate,
					    t1.finisintcpzatgrcend,
					    t1.finelgrulecode,
					    t1.limitelgrulecode,
					    t1.finschcalcodeonrvw,
					    t1.alwplandeferment,
					    t1.plandefercount,
					    t1.finassettype,
					    t1.pftpayactype,
					    t1.finisopenpftpayacc,
					    t31.actypedesc AS lovdescpftpayactypename,
					    t1.finisalwgrcrepay,
					    t1.fingrcschdmthd,
					    t1.fingrcmargin,
					    t1.finmargin,
					    t1.finscheduleon,
					    t1.fingrcscheduleon,
					    t1.fincommitmentreq,
					    t1.fincollateralreq,
					    t1.findepreciationreq,
					    t1.findepreciationfrq,
					    t1.finbankcontingentactype,
					    t1.finprovisionactype,
					    t38.actypedesc AS lovdescfinbankcontactypename,
					    t39.actypedesc AS lovdescfinprovisionactypename,
					    t1.allowriainvestment,
					    t1.overridelimit,
					    t1.limitrequired,
					    t1.fincommitmentovrride,
					    t1.fincollateralovrride,
					    t1.finpftunchanged,
					    t1.applyodpenalty,
					    t1.odincgrcdays,
					    t1.odchargetype,
					    t1.odgracedays,
					    t1.odchargecalon,
					    t1.odchargeamtorperc,
					    t1.odallowwaiver,
					    t1.odmaxwaiverperc,
					    t1.findivision,
					    t48.divisioncodedesc AS lovdescfindivisionname,
					    t48.entitycode AS lovdescentitycode,
					    t1.finsuspactype,
					    t49.actypedesc AS lovdescfinsuspactypename,
					    t1.product,
					    t1.startdate,
					    t1.enddate,
					    t1.allowdownpaypgm,
					    t1.fintypedesc AS lovdescpromofintypedesc,
					    t1.remarks,
					    t1.alwearlypaymethods,
					    t1.pastduepftcalmthd,
					    t1.pastduepftmargin,
					    t1.alwadvancerent,
					    t1.grcadvbaserate,
					    t1.grcadvmargin,
					    t1.grcadvpftrate,
					    t1.rpyadvbaserate,
					    t1.rpyadvmargin,
					    t1.rpyadvpftrate,
					    t1.rolloverfinance,
					    t1.rolloverfrq,
					    t1.downpayrule,
					    t59.rulecode AS downpayrulecode,
					    t59.rulecodedesc AS downpayruledesc,
					    t1.finsusptrigger,
					    t1.finsuspremarks,
					    t1.alwmultipartydisb,
					    t1.collateraltype,
					    t1.tdsapplicable,
					    t1.manualschedule,
					    t1.applygrcpricing,
					    t1.grcpricingmethod,
					    t1.applyrpypricing,
					    t1.rpypricingmethod,
					    t1.rpyhierarchy,
					    t67.rulecode AS grcpricingmethoddesc,
					    t68.rulecode AS rpypricingmethoddesc,
					    t1.droplineod,
					    t1.droppingmethod,
					    t1.ratechganyday,
					    t1.finrepaypftonfrq,
					    t1.alwbpi,
					    t1.bpitreatment,
					    t1.pftdueschon,
					    t1.planemihalw,
					    t1.planemihmethod,
					    t1.planemihmaxperyear,
					    t1.planemihmax,
					    t1.planemihlockperiod,
					    t1.planemicpz,
					    t1.unplanemihlockperiod,
					    t1.unplanemicpz,
					    t1.reagecpz,
					    t1.fddlockperiod,
					    t1.alwdrpymethods,
					    t1.maxunplannedemi,
					    t1.maxreageholidays,
					    t1.roundingmode,
					    t1.roundingtarget,
					    t1.frequencydays,
					    t1.quickdisb,
					    t1.alwmaxdisbcheckreq,
					    t1.alwreage,
					    t1.alwunplanemiholiday,
					    t1.profitcenterid,
					    t69.profitcentercode,
					    t69.profitcenterdesc,
					    t1.productcategory,
					    t2.productdesc AS fincategorydesc,
					    t1.developerfinance,
					    t1.costoffunds,
					    t1.chequecapturereq,
					    t1.finltvcheck,
					    t1.partiallysecured,
					    t1.alwadvemi,
					    t1.advemiminterms,
					    t1.advemimaxterms,
					    t1.advemidftterms,
					    t1.advemischdmthd,
					    t1.bpipftdaysbasis,
					    t1.eligibilitymethods,
					    t1.alwhybridrate,
					    t1.fixedratetenor,
					    t1.odmincapamount,
					    t1.odrulecode,
					    t1.alwzerointacc,
					    t1.autorejectiondays,
					    t1.taxnomand,
					    t1.putcallrequired,
					    t1.grcadvintersetreq,
					    t1.grcadvtype,
					    t1.grcadvminterms,
					    t1.grcadvmaxterms,
					    t1.grcadvdefaultterms,
					    t1.advintersetreq,
					    t1.advtype,
					    t1.advminterms,
					    t1.advmaxterms,
					    t1.advdefaultterms,
					    t1.advstage,
					    t1.dsfreq,
					    t1.cashcollateralreq,
					    t1.tdsallowtomodify,
					    t1.tdsapplicableto,
					    t1.alwvan,
					    t1.vanallocationmethod,
					    t1.allowdrawingpower,
					    t1.allowrevolving,
					    t1.alwsanctionamt,
					    t1.alwsanctionamtoverride,
					    t1.sanbsdschdle,
					    t1.finisratervwatgrcend,
					    t1.schdonpmtcal,
						t1.autoApprove
			     FROM rmtfinancetypes_temp t1
			     LEFT JOIN bmtproduct t2 ON t1.fincategory::text = t2.productcode::text
			     LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype::text = t4.actype::text
			     LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype::text = t38.actype::text
			     LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype::text = t39.actype::text
			     LEFT JOIN rmtaccounttypes t5 ON t1.finactype::text = t5.actype::text
			     LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype::text = t31.actype::text
			     LEFT JOIN smtdivisiondetail t48 ON t1.findivision::text = t48.divisioncode::text
			     LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype::text = t49.actype::text
			     LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			     LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			     LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			     LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
					 UNION ALL
					 SELECT t1.fintype,
					    t1.fincategory,
					    t1.fintypedesc,
					    t1.finccy,
					    t1.findayscaltype,
					    t1.finactype,
					    t1.fincontingentactype,
					    t1.finisgenref,
					    t1.finmaxamount,
					    t1.finminamount,
					    t1.finisopennewfinac,
					    t1.findftstmtfrq,
					    t1.finisalwmd,
					    t1.finschdmthd,
					    t1.finisalwgrace,
					    t1.finhistretension,
					    t1.equalrepayment,
					    t1.finratetype,
					    t1.finbaserate,
					    t1.finsplrate,
					    t1.finintrate,
					    t1.finminrate,
					    t1.finmaxrate,
					    t1.findftintfrq,
					    t1.finisintcpz,
					    t1.fincpzfrq,
					    t1.finisrvwalw,
					    t1.finrvwfrq,
					    t1.fingrcratetype,
					    t1.fingrcbaserate,
					    t1.fingrcsplrate,
					    t1.fingrcintrate,
					    t1.fingrcminrate,
					    t1.fingrcmaxrate,
					    t1.fingrcdftintfrq,
					    t1.fingrcisintcpz,
					    t1.fingrccpzfrq,
					    t1.fingrcisrvwalw,
					    t1.fingrcrvwfrq,
					    t1.finminterm,
					    t1.finmaxterm,
					    t1.findftterms,
					    t1.finrpyfrq,
					    t1.finrepaymethod,
					    t1.finisalwpartialrpy,
					    t1.finisalwdifferment,
					    t1.finmaxdifferment,
					    t1.finisalwearlyrpy,
					    t1.finisalwearlysettle,
					    t1.finodrpytries,
					    t1.finearlypayrule,
					    t1.finearlysettlerule,
					    t1.findepositrestrictedto,
					    t1.finaebuyorinception,
					    t1.finaesellormaturity,
					    t1.finisactive,
					    t1.version,
					    t1.lastmntby,
					    t1.lastmnton,
					    t1.recordstatus,
					    t1.rolecode,
					    t1.nextrolecode,
					    t1.taskid,
					    t1.nexttaskid,
					    t1.recordtype,
					    t1.workflowid,
					    t1.stepfinance,
					    t1.steppingmandatory,
					    t1.alwmanualsteps,
					    t1.alwdsteppolicies,
					    t1.dftsteppolicy,
					    t4.actypedesc AS lovdescfincontingentactypename,
					    t5.actypedesc AS lovdescfinactypename,
					    t1.finisdwpayrequired,
					    t1.finrvwrateapplfor,
					    t1.finalwratechangeanydate,
					    t1.finisintcpzatgrcend,
					    t1.finelgrulecode,
					    t1.limitelgrulecode,
					    t1.finschcalcodeonrvw,
					    t1.alwplandeferment,
					    t1.plandefercount,
					    t1.finassettype,
					    t1.pftpayactype,
					    t1.finisopenpftpayacc,
					    t31.actypedesc AS lovdescpftpayactypename,
					    t1.finisalwgrcrepay,
					    t1.fingrcschdmthd,
					    t1.fingrcmargin,
					    t1.finmargin,
					    t1.finscheduleon,
					    t1.fingrcscheduleon,
					    t1.fincommitmentreq,
					    t1.fincollateralreq,
					    t1.findepreciationreq,
					    t1.findepreciationfrq,
					    t1.finbankcontingentactype,
					    t1.finprovisionactype,
					    t38.actypedesc AS lovdescfinbankcontactypename,
					    t39.actypedesc AS lovdescfinprovisionactypename,
					    t1.allowriainvestment,
					    t1.overridelimit,
					    t1.limitrequired,
					    t1.fincommitmentovrride,
					    t1.fincollateralovrride,
					    t1.finpftunchanged,
					    t1.applyodpenalty,
					    t1.odincgrcdays,
					    t1.odchargetype,
					    t1.odgracedays,
					    t1.odchargecalon,
					    t1.odchargeamtorperc,
					    t1.odallowwaiver,
					    t1.odmaxwaiverperc,
					    t1.findivision,
					    t48.divisioncodedesc AS lovdescfindivisionname,
					    t48.entitycode AS lovdescentitycode,
					    t1.finsuspactype,
					    t49.actypedesc AS lovdescfinsuspactypename,
					    t1.product,
					    t1.startdate,
					    t1.enddate,
					    t1.allowdownpaypgm,
					    t1.fintypedesc AS lovdescpromofintypedesc,
					    t1.remarks,
					    t1.alwearlypaymethods,
					    t1.pastduepftcalmthd,
					    t1.pastduepftmargin,
					    t1.alwadvancerent,
					    t1.grcadvbaserate,
					    t1.grcadvmargin,
					    t1.grcadvpftrate,
					    t1.rpyadvbaserate,
					    t1.rpyadvmargin,
					    t1.rpyadvpftrate,
					    t1.rolloverfinance,
					    t1.rolloverfrq,
					    t1.downpayrule,
					    t59.rulecode AS downpayrulecode,
					    t59.rulecodedesc AS downpayruledesc,
					    t1.finsusptrigger,
					    t1.finsuspremarks,
					    t1.alwmultipartydisb,
					    t1.collateraltype,
					    t1.tdsapplicable,
					    t1.manualschedule,
					    t1.applygrcpricing,
					    t1.grcpricingmethod,
					    t1.applyrpypricing,
					    t1.rpypricingmethod,
					    t1.rpyhierarchy,
					    t67.rulecode AS grcpricingmethoddesc,
					    t68.rulecode AS rpypricingmethoddesc,
					    t1.droplineod,
					    t1.droppingmethod,
					    t1.ratechganyday,
					    t1.finrepaypftonfrq,
					    t1.alwbpi,
					    t1.bpitreatment,
					    t1.pftdueschon,
					    t1.planemihalw,
					    t1.planemihmethod,
					    t1.planemihmaxperyear,
					    t1.planemihmax,
					    t1.planemihlockperiod,
					    t1.planemicpz,
					    t1.unplanemihlockperiod,
					    t1.unplanemicpz,
					    t1.reagecpz,
					    t1.fddlockperiod,
					    t1.alwdrpymethods,
					    t1.maxunplannedemi,
					    t1.maxreageholidays,
					    t1.roundingmode,
					    t1.roundingtarget,
					    t1.frequencydays,
					    t1.quickdisb,
					    t1.alwmaxdisbcheckreq,
					    t1.alwreage,
					    t1.alwunplanemiholiday,
					    t1.profitcenterid,
					    t69.profitcentercode,
					    t69.profitcenterdesc,
					    t1.productcategory,
					    t2.productdesc AS fincategorydesc,
					    t1.developerfinance,
					    t1.costoffunds,
					    t1.chequecapturereq,
					    t1.finltvcheck,
					    t1.partiallysecured,
					    t1.alwadvemi,
					    t1.advemiminterms,
					    t1.advemimaxterms,
					    t1.advemidftterms,
					    t1.advemischdmthd,
					    t1.bpipftdaysbasis,
					    t1.eligibilitymethods,
					    t1.alwhybridrate,
					    t1.fixedratetenor,
					    t1.odmincapamount,
					    t1.odrulecode,
					    t1.alwzerointacc,
					    t1.autorejectiondays,
					    t1.taxnomand,
					    t1.putcallrequired,
					    t1.grcadvintersetreq,
					    t1.grcadvtype,
					    t1.grcadvminterms,
					    t1.grcadvmaxterms,
					    t1.grcadvdefaultterms,
					    t1.advintersetreq,
					    t1.advtype,
					    t1.advminterms,
					    t1.advmaxterms,
					    t1.advdefaultterms,
					    t1.advstage,
					    t1.dsfreq,
					    t1.cashcollateralreq,
					    t1.tdsallowtomodify,
					    t1.tdsapplicableto,
					    t1.alwvan,
					    t1.vanallocationmethod,
					    t1.allowdrawingpower,
					    t1.allowrevolving,
					    t1.alwsanctionamt,
					    t1.alwsanctionamtoverride,
					    t1.sanbsdschdle,
					    t1.finisratervwatgrcend,
					    t1.schdonpmtcal,
						t1.autoApprove
					   FROM rmtfinancetypes t1
					     LEFT JOIN bmtproduct t2 ON t1.fincategory::text = t2.productcode::text
					     LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype::text = t4.actype::text
					     LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype::text = t38.actype::text
					     LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype::text = t39.actype::text
					     LEFT JOIN rmtaccounttypes t5 ON t1.finactype::text = t5.actype::text
					     LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype::text = t31.actype::text
					     LEFT JOIN smtdivisiondetail t48 ON t1.findivision::text = t48.divisioncode::text
					     LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype::text = t49.actype::text
					     LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
					     LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
					     LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
					     LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
					  WHERE NOT (EXISTS ( SELECT 1 AS expr1
					     FROM rmtfinancetypes_temp
					     WHERE rmtfinancetypes_temp.fintype::text = t1.fintype::text))
			   </createView>
			</changeSet> 
	 
	 
	 
	 <changeSet id="4.1" author="Shinde.b" dbms="postgresql">
		 <sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'lmtfinanceworkflowdef_aview');
		 	]]>
		 </sql>
    </changeSet>
    
       <changeSet id="4.2" author="Shinde.b">
	         <sql>
	         <![CDATA[
	            Drop View RMTFINANCETYPES_AVIEW cascade;
	         ]]>
	         </sql>
       </changeSet>
   
	 
	 <changeSet id="5" author="Shinde.b">
	     <createView viewName="RMTFINANCETYPES_AVIEW" replaceIfExists="true">
			 SELECT t1.fintype,
				    t1.fincategory,
				    t1.fintypedesc,
				    t1.finccy,
				    t1.findayscaltype,
				    t1.finactype,
				    t1.fincontingentactype,
				    t1.finisgenref,
				    t1.finmaxamount,
				    t1.finminamount,
				    t1.finisopennewfinac,
				    t1.findftstmtfrq,
				    t1.finisalwmd,
				    t1.finschdmthd,
				    t1.finisalwgrace,
				    t1.finhistretension,
				    t1.equalrepayment,
				    t1.finratetype,
				    t1.finbaserate,
				    t1.finsplrate,
				    t1.finintrate,
				    t1.finminrate,
				    t1.finmaxrate,
				    t1.findftintfrq,
				    t1.finisintcpz,
				    t1.fincpzfrq,
				    t1.finisrvwalw,
				    t1.finrvwfrq,
				    t1.fingrcratetype,
				    t1.fingrcbaserate,
				    t1.fingrcsplrate,
				    t1.fingrcintrate,
				    t1.fingrcminrate,
				    t1.fingrcmaxrate,
				    t1.fingrcdftintfrq,
				    t1.fingrcisintcpz,
				    t1.fingrccpzfrq,
				    t1.fingrcisrvwalw,
				    t1.fingrcrvwfrq,
				    t1.finminterm,
				    t1.finmaxterm,
				    t1.findftterms,
				    t1.finrpyfrq,
				    t1.finrepaymethod,
				    t1.finisalwpartialrpy,
				    t1.finisalwdifferment,
				    t1.finmaxdifferment,
				    t1.finisalwearlyrpy,
				    t1.finisalwearlysettle,
				    t1.finodrpytries,
				    t1.finearlypayrule,
				    t1.finearlysettlerule,
				    t1.findepositrestrictedto,
				    t1.finaebuyorinception,
				    t1.finaesellormaturity,
				    t1.finisactive,
				    t1.version,
				    t1.lastmntby,
				    t1.lastmnton,
				    t1.recordstatus,
				    t1.rolecode,
				    t1.nextrolecode,
				    t1.taskid,
				    t1.nexttaskid,
				    t1.recordtype,
				    t1.workflowid,
				    t1.stepfinance,
				    t1.steppingmandatory,
				    t1.alwmanualsteps,
				    t1.alwdsteppolicies,
				    t1.dftsteppolicy,
				    t4.actypedesc AS lovdescfincontingentactypename,
				    t5.actypedesc AS lovdescfinactypename,
				    t1.finisdwpayrequired,
				    t1.finrvwrateapplfor,
				    t1.finalwratechangeanydate,
				    t1.finisintcpzatgrcend,
				    t1.finelgrulecode,
				    t1.limitelgrulecode,
				    t1.finschcalcodeonrvw,
				    t1.alwplandeferment,
				    t1.plandefercount,
				    t1.finassettype,
				    t1.pftpayactype,
				    t1.finisopenpftpayacc,
				    t31.actypedesc AS lovdescpftpayactypename,
				    t1.finisalwgrcrepay,
				    t1.fingrcschdmthd,
				    t1.fingrcmargin,
				    t1.finmargin,
				    t1.finscheduleon,
				    t1.fingrcscheduleon,
				    t1.fincommitmentreq,
				    t1.fincollateralreq,
				    t1.findepreciationreq,
				    t1.findepreciationfrq,
				    t1.finbankcontingentactype,
				    t1.finprovisionactype,
				    t38.actypedesc AS lovdescfinbankcontactypename,
				    t39.actypedesc AS lovdescfinprovisionactypename,
				    t1.allowriainvestment,
				    t1.overridelimit,
				    t1.limitrequired,
				    t1.fincommitmentovrride,
				    t1.fincollateralovrride,
				    t1.finpftunchanged,
				    t1.applyodpenalty,
				    t1.odincgrcdays,
				    t1.odchargetype,
				    t1.odgracedays,
				    t1.odchargecalon,
				    t1.odchargeamtorperc,
				    t1.odallowwaiver,
				    t1.odmaxwaiverperc,
				    t1.findivision,
				    t48.divisioncodedesc AS lovdescfindivisionname,
				    t48.entitycode AS lovdescentitycode,
				    t1.finsuspactype,
				    t49.actypedesc AS lovdescfinsuspactypename,
				    t1.product,
				    t1.startdate,
				    t1.enddate,
				    t1.allowdownpaypgm,
				    t1.remarks,
				    t1.alwearlypaymethods,
				    t1.pastduepftcalmthd,
				    t1.pastduepftmargin,
				    t1.alwadvancerent,
				    t1.grcadvbaserate,
				    t1.grcadvmargin,
				    t1.grcadvpftrate,
				    t1.rpyadvbaserate,
				    t1.rpyadvmargin,
				    t1.rpyadvpftrate,
				    t1.rolloverfinance,
				    t1.rolloverfrq,
				    t1.downpayrule,
				    t59.rulecode AS downpayrulecode,
				    t59.rulecodedesc AS downpayruledesc,
				    t1.finsusptrigger,
				    t1.finsuspremarks,
				    t1.alwmultipartydisb,
				    t1.collateraltype,
				    t1.tdsapplicable,
				    t1.manualschedule,
				    t1.applygrcpricing,
				    t1.grcpricingmethod,
				    t1.applyrpypricing,
				    t1.rpypricingmethod,
				    t1.rpyhierarchy,
				    t67.rulecode AS grcpricingmethoddesc,
				    t68.rulecode AS rpypricingmethoddesc,
				    t1.droplineod,
				    t1.droppingmethod,
				    t1.ratechganyday,
				    t1.finrepaypftonfrq,
				    t1.alwbpi,
				    t1.bpitreatment,
				    t1.pftdueschon,
				    t1.planemihalw,
				    t1.planemihmethod,
				    t1.planemihmaxperyear,
				    t1.planemihmax,
				    t1.planemihlockperiod,
				    t1.planemicpz,
				    t1.unplanemihlockperiod,
				    t1.unplanemicpz,
				    t1.reagecpz,
				    t1.fddlockperiod,
				    t1.alwdrpymethods,
				    t1.maxunplannedemi,
				    t1.maxreageholidays,
				    t1.roundingmode,
				    t1.roundingtarget,
				    t1.frequencydays,
				    t1.quickdisb,
				    t1.alwreage,
				    t1.alwunplanemiholiday,
				    t1.alwmaxdisbcheckreq,
				    t1.fintypedesc AS lovdescpromofintypedesc,
				    t1.profitcenterid,
				    t69.profitcentercode,
				    t69.profitcenterdesc,
				    t1.productcategory,
				    t2.productdesc AS fincategorydesc,
				    t1.developerfinance,
				    t1.costoffunds,
				    t1.chequecapturereq,
				    t1.finltvcheck,
				    t1.partiallysecured,
				    t1.alwadvemi,
				    t1.advemiminterms,
				    t1.advemimaxterms,
				    t1.advemidftterms,
				    t1.advemischdmthd,
				    t1.bpipftdaysbasis,
				    t1.eligibilitymethods,
				    t1.alwhybridrate,
				    t1.fixedratetenor,
				    t1.odmincapamount,
				    t1.odrulecode,
				    t1.alwzerointacc,
				    t1.autorejectiondays,
				    t1.taxnomand,
				    t1.putcallrequired,
				    t1.grcadvintersetreq,
				    t1.grcadvtype,
				    t1.grcadvminterms,
				    t1.grcadvmaxterms,
				    t1.grcadvdefaultterms,
				    t1.advintersetreq,
				    t1.advtype,
				    t1.advminterms,
				    t1.advmaxterms,
				    t1.advdefaultterms,
				    t1.advstage,
				    t1.dsfreq,
				    t1.cashcollateralreq,
				    t1.tdsallowtomodify,
				    t1.tdsapplicableto,
				    t1.alwvan,
				    t1.vanallocationmethod,
				    t1.allowdrawingpower,
				    t1.allowrevolving,
				    t1.alwsanctionamt,
				    t1.alwsanctionamtoverride,
				    t1.sanbsdschdle,
				    t1.finisratervwatgrcend,
				    t1.schdonpmtcal,
				   t1.autoApprove
				   FROM rmtfinancetypes t1
				     LEFT JOIN bmtproduct t2 ON t1.fincategory::text = t2.productcode::text
				     LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype::text = t4.actype::text
				     LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype::text = t38.actype::text
				     LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype::text = t39.actype::text
				     LEFT JOIN rmtaccounttypes t5 ON t1.finactype::text = t5.actype::text
				     LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype::text = t31.actype::text
				     LEFT JOIN smtdivisiondetail t48 ON t1.findivision::text = t48.divisioncode::text
				     LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype::text = t49.actype::text
				     LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
				     LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
				     LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
				     LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
	     </createView>
	 </changeSet>
	 
	  <changeSet id="5.1" author="Shinde.b" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'lmtfinanceworkflowdef_aview');
			]]>
		</sql>
	</changeSet>
	
	 
	<changeSet id="6" author="Shinde.b">
    	<createView viewName="RMTFINANCETYPES_ORGVIEW" replaceIfExists="true">
			 SELECT t1.fintype,
			    t1.fincategory,
			    t1.fintypedesc,
			    t1.finccy,
			    t1.findayscaltype,
			    t1.finactype,
			    t1.fincontingentactype,
			    t1.finisgenref,
			    t1.finmaxamount,
			    t1.finminamount,
			    t1.finisopennewfinac,
			    t1.finisalwmd,
			    t1.finschdmthd,
			    t1.finisalwgrace,
			    t1.equalrepayment,
			    t1.finratetype,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finintrate,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.findftintfrq,
			    t1.finisintcpz,
			    t1.fincpzfrq,
			    t1.finisrvwalw,
			    t1.finrvwfrq,
			    t1.fingrcratetype,
			    t1.fingrcbaserate,
			    t1.fingrcsplrate,
			    t1.fingrcintrate,
			    t1.fingrcminrate,
			    t1.fingrcmaxrate,
			    t1.fingrcdftintfrq,
			    t1.fingrcisintcpz,
			    t1.fingrccpzfrq,
			    t1.fingrcisrvwalw,
			    t1.fingrcrvwfrq,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.findftterms,
			    t1.finrpyfrq,
			    t1.finrepaymethod,
			    t1.finisalwdifferment,
			    t1.finmaxdifferment,
			    t1.finisactive,
			    t1.stepfinance,
			    t1.steppingmandatory,
			    t1.alwmanualsteps,
			    t1.alwdsteppolicies,
			    t1.dftsteppolicy,
			    t1.finisdwpayrequired,
			    t1.finrvwrateapplfor,
			    t1.finalwratechangeanydate,
			    t1.finisintcpzatgrcend,
			    t1.finschcalcodeonrvw,
			    t1.alwplandeferment,
			    t1.plandefercount,
			    t1.pftpayactype,
			    t1.finisopenpftpayacc,
			    t1.finisalwgrcrepay,
			    t1.fingrcschdmthd,
			    t1.fingrcmargin,
			    t1.finmargin,
			    t1.fincommitmentreq,
			    t1.fincollateralreq,
			    t1.findepreciationreq,
			    t1.findepreciationfrq,
			    t1.finbankcontingentactype,
			    t1.finprovisionactype,
			    t1.allowriainvestment,
			    t1.overridelimit,
			    t1.limitrequired,
			    t1.fincommitmentovrride,
			    t1.fincollateralovrride,
			    t1.finrepaypftonfrq,
			    t1.finpftunchanged,
			    t1.applyodpenalty,
			    t1.odincgrcdays,
			    t1.odchargetype,
			    t1.odgracedays,
			    t1.odchargecalon,
			    t1.odchargeamtorperc,
			    t1.odallowwaiver,
			    t1.odmaxwaiverperc,
			    t1.findivision,
			    t3.divisioncodedesc AS lovdescfindivisionname,
			    t1.finsuspactype,
			    t1.product,
			    t1.startdate,
			    t1.enddate,
			    t1.allowdownpaypgm,
			    t1.fintypedesc AS lovdescpromofintypedesc,
			    t1.remarks,
			    t4.policydesc AS lovdescdftsteppolicyname,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.alwadvancerent,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.rolloverfinance,
			    t1.rolloverfrq,
			    t1.downpayrule,
			    t1.alwmultipartydisb,
			    t1.collateraltype,
			    t1.tdsapplicable,
			    t5.rulecode AS downpayrulecode,
			    t5.rulecodedesc AS downpayruledesc,
			    t1.applygrcpricing,
			    t1.applyrpypricing,
			    t6.rulecode AS grcpricingmethoddesc,
			    t7.rulecode AS rpypricingmethoddesc,
			    t1.droplineod,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t4.steptype AS dftsteppolicytype,
			    t1.manualschedule,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.pftdueschon,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.fddlockperiod,
			    t1.alwdrpymethods,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.roundingmode,
			    t1.roundingtarget,
			    t1.frequencydays,
			    t1.quickdisb,
			    t1.alwreage,
			    t1.alwunplanemiholiday,
			    t1.alwmaxdisbcheckreq,
			    t1.productcategory,
			    t1.rpyhierarchy,
			    t1.developerfinance,
			    t3.entitycode AS lovdescentitycode,
			    t8.entitydesc AS lovdescentitydesc,
			    t1.costoffunds,
			    t1.chequecapturereq,
			    t1.finltvcheck,
			    t1.partiallysecured,
			    t1.alwadvemi,
			    t1.advemiminterms,
			    t1.advemimaxterms,
			    t1.advemidftterms,
			    t1.advemischdmthd,
			    t1.bpipftdaysbasis,
			    t1.eligibilitymethods,
			    t1.alwhybridrate,
			    t1.fixedratetenor,
			    t1.odmincapamount,
			    t1.odrulecode,
			    t1.alwzerointacc,
			    t1.finisalwpartialrpy,
			    t1.autorejectiondays,
			    t1.taxnomand,
			    t1.putcallrequired,
			    t1.grcadvintersetreq,
			    t1.grcadvtype,
			    t1.grcadvminterms,
			    t1.grcadvmaxterms,
			    t1.grcadvdefaultterms,
			    t1.advintersetreq,
			    t1.advtype,
			    t1.advminterms,
			    t1.advmaxterms,
			    t1.advdefaultterms,
			    t1.advstage,
			    t1.dsfreq,
			    t1.cashcollateralreq,
			    t1.alwearlypaymethods,
			    t1.tdsallowtomodify,
			    t1.tdsapplicableto,
			    t1.alwvan,
			    t1.vanallocationmethod,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.alwsanctionamt,
			    t1.alwsanctionamtoverride,
			    t1.sanbsdschdle,
			    t1.finisratervwatgrcend,
			    t1.schdonpmtcal,
				t1.autoApprove
			   FROM rmtfinancetypes t1
	     JOIN smtdivisiondetail t3 ON t1.findivision::text = t3.divisioncode::text
	     LEFT JOIN steppolicyheader t4 ON t1.dftsteppolicy::text = t4.policycode::text
	     LEFT JOIN rules t5 ON t1.downpayrule = t5.ruleid
	     LEFT JOIN rules t6 ON t1.grcpricingmethod = t6.ruleid
	     LEFT JOIN rules t7 ON t1.rpypricingmethod = t7.ruleid
	     LEFT JOIN entity t8 ON t3.entitycode::text = t8.entitycode::text
	</createView>
</changeSet>

 <changeSet id="7" author="Shinde.b">
    <sql>
    <![CDATA[
        Insert into SMTPARAMETERS (SYSPARMCODE,SYSPARMDESC,SYSPARMTYPE,SYSPARMMAINT,SYSPARMVALUE,SYSPARMLENGTH,SYSPARMDEC,SYSPARMLIST,SYSPARMVALDMOD,SYSPARMDESCRIPTION,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) values ('ALLOW_AUTOAPRROVE','Allow Auto Approve Fin','String',1,'N',3,0,null,null,'Allow Auto Approve Fin',1,1000,to_date('26-11-19','DD-MM-RR'),'Approved',null,null,null,null,null,0);
     ]]>
    </sql>
  </changeSet>

</databaseChangeLog>

