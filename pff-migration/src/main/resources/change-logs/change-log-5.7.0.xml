<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value="" dbms="oracle" />
	<property name="add.schema" value="" dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PLFAVANSEQC.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="Adarsh" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>

	<changeSet id="01" author="shekar.b">
		<addColumn tableName="RMTFINANCETYPES">
			<column name="AlwPlannedEmiInGrc" type="boolean" defaultValue="false">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

    <changeSet id="02" author="shekar.b">
		<addColumn tableName="RMTFINANCETYPES_Temp">
			<column name="AlwPlannedEmiInGrc" type="boolean" defaultValue="false">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>
	
	<changeSet id="03" author="shekar.b">
		<sql>
			<![CDATA[
				Update RMTFinanceTypes set AlwPlannedEmiInGrc = 0;
				Update RMTFinanceTypes_Temp set AlwPlannedEmiInGrc = 0;
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="04_pre" author="shekar.b" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_view');
		 	]]>
		</sql>
	</changeSet>
	
	<changeSet id="04" author="shekar.b">
		<createView viewName="RMTFINANCETYPES_VIEW" replaceIfExists="true">
		  <![CDATA[
			SELECT t1.fintype,
			t1.fincategory,
			t1.fintypedesc,
			t1.finccy,
			t1.findayscaltype,
			t1.finactype,
			t1.fincontingentactype,
			t1.finisgenref,
			t1.finmaxamount,
			t1.finminamount,
			t1.finisopennewfinac,
			t1.findftstmtfrq,
			t1.finisalwmd,
			t1.finschdmthd,
			t1.finisalwgrace,
			t1.finhistretension,
			t1.equalrepayment,
			t1.finratetype,
			t1.finbaserate,
			t1.finsplrate,
			t1.finintrate,
			t1.finminrate,
			t1.finmaxrate,
			t1.findftintfrq,
			t1.finisintcpz,
			t1.fincpzfrq,
			t1.finisrvwalw,
			t1.finrvwfrq,
			t1.fingrcratetype,
			t1.fingrcbaserate,
			t1.fingrcsplrate,
			t1.fingrcintrate,
			t1.fingrcminrate,
			t1.fingrcmaxrate,
			t1.fingrcdftintfrq,
			t1.fingrcisintcpz,
			t1.fingrccpzfrq,
			t1.fingrcisrvwalw,
			t1.fingrcrvwfrq,
			t1.finminterm,
			t1.finmaxterm,
			t1.findftterms,
			t1.finrpyfrq,
			t1.finrepaymethod,
			t1.finisalwpartialrpy,
			t1.finisalwdifferment,
			t1.finmaxdifferment,
			t1.finisalwearlyrpy,
			t1.finisalwearlysettle,
			t1.finodrpytries,
			t1.finearlypayrule,
			t1.finearlysettlerule,
			t1.findepositrestrictedto,
			t1.finaebuyorinception,
			t1.finaesellormaturity,
			t1.finisactive,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.stepfinance,
			t1.steppingmandatory,
			t1.alwmanualsteps,
			t1.alwdsteppolicies,
			t1.dftsteppolicy,
			t4.actypedesc AS lovdescfincontingentactypename,
			t5.actypedesc AS lovdescfinactypename,
			t1.finisdwpayrequired,
			t1.finrvwrateapplfor,
			t1.finalwratechangeanydate,
			t1.finisintcpzatgrcend,
			t1.finelgrulecode,
			t1.limitelgrulecode,
			t1.finschcalcodeonrvw,
			t1.alwplandeferment,
			t1.plandefercount,
			t1.finassettype,
			t1.pftpayactype,
			t1.finisopenpftpayacc,
			t31.actypedesc AS lovdescpftpayactypename,
			t1.finisalwgrcrepay,
			t1.fingrcschdmthd,
			t1.fingrcmargin,
			t1.finmargin,
			t1.finscheduleon,
			t1.fingrcscheduleon,
			t1.fincommitmentreq,
			t1.fincollateralreq,
			t1.findepreciationreq,
			t1.findepreciationfrq,
			t1.finbankcontingentactype,
			t1.finprovisionactype,
			t38.actypedesc AS lovdescfinbankcontactypename,
			t39.actypedesc AS lovdescfinprovisionactypename,
			t1.allowriainvestment,
			t1.overridelimit,
			t1.limitrequired,
			t1.fincommitmentovrride,
			t1.fincollateralovrride,
			t1.finpftunchanged,
			t1.applyodpenalty,
			t1.odincgrcdays,
			t1.odchargetype,
			t1.odgracedays,
			t1.odchargecalon,
			t1.odchargeamtorperc,
			t1.odallowwaiver,
			t1.odmaxwaiverperc,
			t1.findivision,
			t48.divisioncodedesc AS lovdescfindivisionname,
			t48.entitycode AS lovdescentitycode,
			t1.finsuspactype,
			t49.actypedesc AS lovdescfinsuspactypename,
			t1.product,
			t1.startdate,
			t1.enddate,
			t1.allowdownpaypgm,
			t1.fintypedesc AS lovdescpromofintypedesc,
			t1.remarks,
			t1.alwearlypaymethods,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.alwadvancerent,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.rolloverfinance,
			t1.rolloverfrq,
			t1.downpayrule,
			t59.rulecode AS downpayrulecode,
			t59.rulecodedesc AS downpayruledesc,
			t1.finsusptrigger,
			t1.finsuspremarks,
			t1.alwmultipartydisb,
			t1.collateraltype,
			t1.tdsapplicable,
			t1.manualschedule,
			t1.applygrcpricing,
			t1.grcpricingmethod,
			t1.applyrpypricing,
			t1.rpypricingmethod,
			t1.rpyhierarchy,
			t67.rulecode AS grcpricingmethoddesc,
			t68.rulecode AS rpypricingmethoddesc,
			t1.droplineod,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.finrepaypftonfrq,
			t1.alwbpi,
			t1.bpitreatment,
			t1.pftdueschon,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.fddlockperiod,
			t1.alwdrpymethods,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.roundingmode,
			t1.roundingtarget,
			t1.frequencydays,
			t1.quickdisb,
			t1.alwmaxdisbcheckreq,
			t1.alwreage,
			t1.alwunplanemiholiday,
			t1.profitcenterid,
			t69.profitcentercode,
			t69.profitcenterdesc,
			t1.productcategory,
			t2.productdesc AS fincategorydesc,
			t1.developerfinance,
			t1.costoffunds,
			t1.chequecapturereq,
			t1.finltvcheck,
			t1.partiallysecured,
			t1.alwadvemi,
			t1.advemiminterms,
			t1.advemimaxterms,
			t1.advemidftterms,
			t1.advemischdmthd,
			t1.bpipftdaysbasis,
			t1.eligibilitymethods,
			t1.alwhybridrate,
			t1.fixedratetenor,
			t1.odmincapamount,
			t1.odrulecode,
			t1.alwzerointacc,
			t1.autorejectiondays,
			t1.taxnomand,
			t1.putcallrequired,
			t1.grcadvintersetreq,
			t1.grcadvtype,
			t1.grcadvminterms,
			t1.grcadvmaxterms,
			t1.grcadvdefaultterms,
			t1.advintersetreq,
			t1.advtype,
			t1.advminterms,
			t1.advmaxterms,
			t1.advdefaultterms,
			t1.advstage,
			t1.dsfreq,
			t1.cashcollateralreq,
			t1.tdsallowtomodify,
			t1.tdsapplicableto,
			t1.alwvan,
			t1.vanallocationmethod,
			t1.allowdrawingpower,
			t1.allowrevolving,
			t1.alwsanctionamt,
			t1.alwsanctionamtoverride,
			t1.sanbsdschdle,
			t1.finisratervwatgrcend,
			t1.schdonpmtcal,
			t1.autoapprove,
			t1.AlwPlannedEmiInGrc
		   FROM rmtfinancetypes_temp t1
			 LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
			 LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
			 LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
			 LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
			 LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
			 LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
			 LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
			 LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
			 LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			 LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			 LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			 LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
		UNION ALL
		 SELECT t1.fintype,
			t1.fincategory,
			t1.fintypedesc,
			t1.finccy,
			t1.findayscaltype,
			t1.finactype,
			t1.fincontingentactype,
			t1.finisgenref,
			t1.finmaxamount,
			t1.finminamount,
			t1.finisopennewfinac,
			t1.findftstmtfrq,
			t1.finisalwmd,
			t1.finschdmthd,
			t1.finisalwgrace,
			t1.finhistretension,
			t1.equalrepayment,
			t1.finratetype,
			t1.finbaserate,
			t1.finsplrate,
			t1.finintrate,
			t1.finminrate,
			t1.finmaxrate,
			t1.findftintfrq,
			t1.finisintcpz,
			t1.fincpzfrq,
			t1.finisrvwalw,
			t1.finrvwfrq,
			t1.fingrcratetype,
			t1.fingrcbaserate,
			t1.fingrcsplrate,
			t1.fingrcintrate,
			t1.fingrcminrate,
			t1.fingrcmaxrate,
			t1.fingrcdftintfrq,
			t1.fingrcisintcpz,
			t1.fingrccpzfrq,
			t1.fingrcisrvwalw,
			t1.fingrcrvwfrq,
			t1.finminterm,
			t1.finmaxterm,
			t1.findftterms,
			t1.finrpyfrq,
			t1.finrepaymethod,
			t1.finisalwpartialrpy,
			t1.finisalwdifferment,
			t1.finmaxdifferment,
			t1.finisalwearlyrpy,
			t1.finisalwearlysettle,
			t1.finodrpytries,
			t1.finearlypayrule,
			t1.finearlysettlerule,
			t1.findepositrestrictedto,
			t1.finaebuyorinception,
			t1.finaesellormaturity,
			t1.finisactive,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.stepfinance,
			t1.steppingmandatory,
			t1.alwmanualsteps,
			t1.alwdsteppolicies,
			t1.dftsteppolicy,
			t4.actypedesc AS lovdescfincontingentactypename,
			t5.actypedesc AS lovdescfinactypename,
			t1.finisdwpayrequired,
			t1.finrvwrateapplfor,
			t1.finalwratechangeanydate,
			t1.finisintcpzatgrcend,
			t1.finelgrulecode,
			t1.limitelgrulecode,
			t1.finschcalcodeonrvw,
			t1.alwplandeferment,
			t1.plandefercount,
			t1.finassettype,
			t1.pftpayactype,
			t1.finisopenpftpayacc,
			t31.actypedesc AS lovdescpftpayactypename,
			t1.finisalwgrcrepay,
			t1.fingrcschdmthd,
			t1.fingrcmargin,
			t1.finmargin,
			t1.finscheduleon,
			t1.fingrcscheduleon,
			t1.fincommitmentreq,
			t1.fincollateralreq,
			t1.findepreciationreq,
			t1.findepreciationfrq,
			t1.finbankcontingentactype,
			t1.finprovisionactype,
			t38.actypedesc AS lovdescfinbankcontactypename,
			t39.actypedesc AS lovdescfinprovisionactypename,
			t1.allowriainvestment,
			t1.overridelimit,
			t1.limitrequired,
			t1.fincommitmentovrride,
			t1.fincollateralovrride,
			t1.finpftunchanged,
			t1.applyodpenalty,
			t1.odincgrcdays,
			t1.odchargetype,
			t1.odgracedays,
			t1.odchargecalon,
			t1.odchargeamtorperc,
			t1.odallowwaiver,
			t1.odmaxwaiverperc,
			t1.findivision,
			t48.divisioncodedesc AS lovdescfindivisionname,
			t48.entitycode AS lovdescentitycode,
			t1.finsuspactype,
			t49.actypedesc AS lovdescfinsuspactypename,
			t1.product,
			t1.startdate,
			t1.enddate,
			t1.allowdownpaypgm,
			t1.fintypedesc AS lovdescpromofintypedesc,
			t1.remarks,
			t1.alwearlypaymethods,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.alwadvancerent,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.rolloverfinance,
			t1.rolloverfrq,
			t1.downpayrule,
			t59.rulecode AS downpayrulecode,
			t59.rulecodedesc AS downpayruledesc,
			t1.finsusptrigger,
			t1.finsuspremarks,
			t1.alwmultipartydisb,
			t1.collateraltype,
			t1.tdsapplicable,
			t1.manualschedule,
			t1.applygrcpricing,
			t1.grcpricingmethod,
			t1.applyrpypricing,
			t1.rpypricingmethod,
			t1.rpyhierarchy,
			t67.rulecode AS grcpricingmethoddesc,
			t68.rulecode AS rpypricingmethoddesc,
			t1.droplineod,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.finrepaypftonfrq,
			t1.alwbpi,
			t1.bpitreatment,
			t1.pftdueschon,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.fddlockperiod,
			t1.alwdrpymethods,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.roundingmode,
			t1.roundingtarget,
			t1.frequencydays,
			t1.quickdisb,
			t1.alwmaxdisbcheckreq,
			t1.alwreage,
			t1.alwunplanemiholiday,
			t1.profitcenterid,
			t69.profitcentercode,
			t69.profitcenterdesc,
			t1.productcategory,
			t2.productdesc AS fincategorydesc,
			t1.developerfinance,
			t1.costoffunds,
			t1.chequecapturereq,
			t1.finltvcheck,
			t1.partiallysecured,
			t1.alwadvemi,
			t1.advemiminterms,
			t1.advemimaxterms,
			t1.advemidftterms,
			t1.advemischdmthd,
			t1.bpipftdaysbasis,
			t1.eligibilitymethods,
			t1.alwhybridrate,
			t1.fixedratetenor,
			t1.odmincapamount,
			t1.odrulecode,
			t1.alwzerointacc,
			t1.autorejectiondays,
			t1.taxnomand,
			t1.putcallrequired,
			t1.grcadvintersetreq,
			t1.grcadvtype,
			t1.grcadvminterms,
			t1.grcadvmaxterms,
			t1.grcadvdefaultterms,
			t1.advintersetreq,
			t1.advtype,
			t1.advminterms,
			t1.advmaxterms,
			t1.advdefaultterms,
			t1.advstage,
			t1.dsfreq,
			t1.cashcollateralreq,
			t1.tdsallowtomodify,
			t1.tdsapplicableto,
			t1.alwvan,
			t1.vanallocationmethod,
			t1.allowdrawingpower,
			t1.allowrevolving,
			t1.alwsanctionamt,
			t1.alwsanctionamtoverride,
			t1.sanbsdschdle,
			t1.finisratervwatgrcend,
			t1.schdonpmtcal,
			t1.autoapprove,
			t1.AlwPlannedEmiInGrc
		   FROM rmtfinancetypes t1
			 LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
			 LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
			 LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
			 LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
			 LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
			 LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
			 LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
			 LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
			 LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			 LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			 LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			 LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
			 WHERE NOT (EXISTS ( SELECT 1 AS expr1
				 FROM rmtfinancetypes_temp
				  WHERE rmtfinancetypes_temp.fintype = t1.fintype))
			]]>
		</createView>
	</changeSet>
	
	<changeSet id="04_post" author="Shinde.b" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_view');
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="05_pre" author="shekar.b" dbms="postgresql">
			<sql>
				<![CDATA[
						select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_aview');
				]]>
			</sql>
	</changeSet>
	
	
	 <changeSet id="05" author="shekar.b">
		<createView viewName="RMTFINANCETYPES_AVIEW" replaceIfExists="true">
			<![CDATA[ 
			SELECT t1.fintype,
			t1.fincategory,
			t1.fintypedesc,
			t1.finccy,
			t1.findayscaltype,
			t1.finactype,
			t1.fincontingentactype,
			t1.finisgenref,
			t1.finmaxamount,
			t1.finminamount,
			t1.finisopennewfinac,
			t1.findftstmtfrq,
			t1.finisalwmd,
			t1.finschdmthd,
			t1.finisalwgrace,
			t1.finhistretension,
			t1.equalrepayment,
			t1.finratetype,
			t1.finbaserate,
			t1.finsplrate,
			t1.finintrate,
			t1.finminrate,
			t1.finmaxrate,
			t1.findftintfrq,
			t1.finisintcpz,
			t1.fincpzfrq,
			t1.finisrvwalw,
			t1.finrvwfrq,
			t1.fingrcratetype,
			t1.fingrcbaserate,
			t1.fingrcsplrate,
			t1.fingrcintrate,
			t1.fingrcminrate,
			t1.fingrcmaxrate,
			t1.fingrcdftintfrq,
			t1.fingrcisintcpz,
			t1.fingrccpzfrq,
			t1.fingrcisrvwalw,
			t1.fingrcrvwfrq,
			t1.finminterm,
			t1.finmaxterm,
			t1.findftterms,
			t1.finrpyfrq,
			t1.finrepaymethod,
			t1.finisalwpartialrpy,
			t1.finisalwdifferment,
			t1.finmaxdifferment,
			t1.finisalwearlyrpy,
			t1.finisalwearlysettle,
			t1.finodrpytries,
			t1.finearlypayrule,
			t1.finearlysettlerule,
			t1.findepositrestrictedto,
			t1.finaebuyorinception,
			t1.finaesellormaturity,
			t1.finisactive,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.stepfinance,
			t1.steppingmandatory,
			t1.alwmanualsteps,
			t1.alwdsteppolicies,
			t1.dftsteppolicy,
			t4.actypedesc AS lovdescfincontingentactypename,
			t5.actypedesc AS lovdescfinactypename,
			t1.finisdwpayrequired,
			t1.finrvwrateapplfor,
			t1.finalwratechangeanydate,
			t1.finisintcpzatgrcend,
			t1.finelgrulecode,
			t1.limitelgrulecode,
			t1.finschcalcodeonrvw,
			t1.alwplandeferment,
			t1.plandefercount,
			t1.finassettype,
			t1.pftpayactype,
			t1.finisopenpftpayacc,
			t31.actypedesc AS lovdescpftpayactypename,
			t1.finisalwgrcrepay,
			t1.fingrcschdmthd,
			t1.fingrcmargin,
			t1.finmargin,
			t1.finscheduleon,
			t1.fingrcscheduleon,
			t1.fincommitmentreq,
			t1.fincollateralreq,
			t1.findepreciationreq,
			t1.findepreciationfrq,
			t1.finbankcontingentactype,
			t1.finprovisionactype,
			t38.actypedesc AS lovdescfinbankcontactypename,
			t39.actypedesc AS lovdescfinprovisionactypename,
			t1.allowriainvestment,
			t1.overridelimit,
			t1.limitrequired,
			t1.fincommitmentovrride,
			t1.fincollateralovrride,
			t1.finpftunchanged,
			t1.applyodpenalty,
			t1.odincgrcdays,
			t1.odchargetype,
			t1.odgracedays,
			t1.odchargecalon,
			t1.odchargeamtorperc,
			t1.odallowwaiver,
			t1.odmaxwaiverperc,
			t1.findivision,
			t48.divisioncodedesc AS lovdescfindivisionname,
			t48.entitycode AS lovdescentitycode,
			t1.finsuspactype,
			t49.actypedesc AS lovdescfinsuspactypename,
			t1.product,
			t1.startdate,
			t1.enddate,
			t1.allowdownpaypgm,
			t1.remarks,
			t1.alwearlypaymethods,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.alwadvancerent,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.rolloverfinance,
			t1.rolloverfrq,
			t1.downpayrule,
			t59.rulecode AS downpayrulecode,
			t59.rulecodedesc AS downpayruledesc,
			t1.finsusptrigger,
			t1.finsuspremarks,
			t1.alwmultipartydisb,
			t1.collateraltype,
			t1.tdsapplicable,
			t1.manualschedule,
			t1.applygrcpricing,
			t1.grcpricingmethod,
			t1.applyrpypricing,
			t1.rpypricingmethod,
			t1.rpyhierarchy,
			t67.rulecode AS grcpricingmethoddesc,
			t68.rulecode AS rpypricingmethoddesc,
			t1.droplineod,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.finrepaypftonfrq,
			t1.alwbpi,
			t1.bpitreatment,
			t1.pftdueschon,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.fddlockperiod,
			t1.alwdrpymethods,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.roundingmode,
			t1.roundingtarget,
			t1.frequencydays,
			t1.quickdisb,
			t1.alwreage,
			t1.alwunplanemiholiday,
			t1.alwmaxdisbcheckreq,
			t1.fintypedesc AS lovdescpromofintypedesc,
			t1.profitcenterid,
			t69.profitcentercode,
			t69.profitcenterdesc,
			t1.productcategory,
			t2.productdesc AS fincategorydesc,
			t1.developerfinance,
			t1.costoffunds,
			t1.chequecapturereq,
			t1.finltvcheck,
			t1.partiallysecured,
			t1.alwadvemi,
			t1.advemiminterms,
			t1.advemimaxterms,
			t1.advemidftterms,
			t1.advemischdmthd,
			t1.bpipftdaysbasis,
			t1.eligibilitymethods,
			t1.alwhybridrate,
			t1.fixedratetenor,
			t1.odmincapamount,
			t1.odrulecode,
			t1.alwzerointacc,
			t1.autorejectiondays,
			t1.taxnomand,
			t1.putcallrequired,
			t1.grcadvintersetreq,
			t1.grcadvtype,
			t1.grcadvminterms,
			t1.grcadvmaxterms,
			t1.grcadvdefaultterms,
			t1.advintersetreq,
			t1.advtype,
			t1.advminterms,
			t1.advmaxterms,
			t1.advdefaultterms,
			t1.advstage,
			t1.dsfreq,
			t1.cashcollateralreq,
			t1.tdsallowtomodify,
			t1.tdsapplicableto,
			t1.alwvan,
			t1.vanallocationmethod,
			t1.allowdrawingpower,
			t1.allowrevolving,
			t1.alwsanctionamt,
			t1.alwsanctionamtoverride,
			t1.sanbsdschdle,
			t1.finisratervwatgrcend,
			t1.schdonpmtcal,
			t1.autoapprove,
			t1.AlwPlannedEmiInGrc
		   FROM rmtfinancetypes t1
			 LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
			 LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
			 LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
			 LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
			 LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
			 LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
			 LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
			 LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
			 LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			 LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			 LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			 LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
			]]>
		</createView>
	</changeSet>
	
	<changeSet id="05_post" author="shekar.b" dbms="postgresql">
			<sql>
				<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_aview');
				]]>
			</sql>
	</changeSet>
	
	<changeSet id="06_pre" author="shekar.b" dbms="postgresql">
			<sql>
				<![CDATA[
						select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_orgview');
				]]>
			</sql>
	</changeSet>
	
	<changeSet id="05" author="shekar.b">
		<createView viewName="RMTFINANCETYPES_ORGVIEW" replaceIfExists="true">
			<![CDATA[ 
				SELECT t1.fintype,
			    t1.fincategory,
			    t1.fintypedesc,
			    t1.finccy,
			    t1.findayscaltype,
			    t1.finactype,
			    t1.fincontingentactype,
			    t1.finisgenref,
			    t1.finmaxamount,
			    t1.finminamount,
			    t1.finisopennewfinac,
			    t1.finisalwmd,
			    t1.finschdmthd,
			    t1.finisalwgrace,
			    t1.equalrepayment,
			    t1.finratetype,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finintrate,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.findftintfrq,
			    t1.finisintcpz,
			    t1.fincpzfrq,
			    t1.finisrvwalw,
			    t1.finrvwfrq,
			    t1.fingrcratetype,
			    t1.fingrcbaserate,
			    t1.fingrcsplrate,
			    t1.fingrcintrate,
			    t1.fingrcminrate,
			    t1.fingrcmaxrate,
			    t1.fingrcdftintfrq,
			    t1.fingrcisintcpz,
			    t1.fingrccpzfrq,
			    t1.fingrcisrvwalw,
			    t1.fingrcrvwfrq,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.findftterms,
			    t1.finrpyfrq,
			    t1.finrepaymethod,
			    t1.finisalwdifferment,
			    t1.finmaxdifferment,
			    t1.finisactive,
			    t1.stepfinance,
			    t1.steppingmandatory,
			    t1.alwmanualsteps,
			    t1.alwdsteppolicies,
			    t1.dftsteppolicy,
			    t1.finisdwpayrequired,
			    t1.finrvwrateapplfor,
			    t1.finalwratechangeanydate,
			    t1.finisintcpzatgrcend,
			    t1.finschcalcodeonrvw,
			    t1.alwplandeferment,
			    t1.plandefercount,
			    t1.pftpayactype,
			    t1.finisopenpftpayacc,
			    t1.finisalwgrcrepay,
			    t1.fingrcschdmthd,
			    t1.fingrcmargin,
			    t1.finmargin,
			    t1.fincommitmentreq,
			    t1.fincollateralreq,
			    t1.findepreciationreq,
			    t1.findepreciationfrq,
			    t1.finbankcontingentactype,
			    t1.finprovisionactype,
			    t1.allowriainvestment,
			    t1.overridelimit,
			    t1.limitrequired,
			    t1.fincommitmentovrride,
			    t1.fincollateralovrride,
			    t1.finrepaypftonfrq,
			    t1.finpftunchanged,
			    t1.applyodpenalty,
			    t1.odincgrcdays,
			    t1.odchargetype,
			    t1.odgracedays,
			    t1.odchargecalon,
			    t1.odchargeamtorperc,
			    t1.odallowwaiver,
			    t1.odmaxwaiverperc,
			    t1.findivision,
			    t3.divisioncodedesc AS lovdescfindivisionname,
			    t1.finsuspactype,
			    t1.product,
			    t1.startdate,
			    t1.enddate,
			    t1.allowdownpaypgm,
			    t1.fintypedesc AS lovdescpromofintypedesc,
			    t1.remarks,
			    t4.policydesc AS lovdescdftsteppolicyname,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.alwadvancerent,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.rolloverfinance,
			    t1.rolloverfrq,
			    t1.downpayrule,
			    t1.alwmultipartydisb,
			    t1.collateraltype,
			    t1.tdsapplicable,
			    t5.rulecode AS downpayrulecode,
			    t5.rulecodedesc AS downpayruledesc,
			    t1.applygrcpricing,
			    t1.applyrpypricing,
			    t6.rulecode AS grcpricingmethoddesc,
			    t7.rulecode AS rpypricingmethoddesc,
			    t1.droplineod,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t4.steptype AS dftsteppolicytype,
			    t1.manualschedule,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.pftdueschon,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.fddlockperiod,
			    t1.alwdrpymethods,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.roundingmode,
			    t1.roundingtarget,
			    t1.frequencydays,
			    t1.quickdisb,
			    t1.alwreage,
			    t1.alwunplanemiholiday,
			    t1.alwmaxdisbcheckreq,
			    t1.productcategory,
			    t1.rpyhierarchy,
			    t1.developerfinance,
			    t3.entitycode AS lovdescentitycode,
			    t8.entitydesc AS lovdescentitydesc,
			    t1.costoffunds,
			    t1.chequecapturereq,
			    t1.finltvcheck,
			    t1.partiallysecured,
			    t1.alwadvemi,
			    t1.advemiminterms,
			    t1.advemimaxterms,
			    t1.advemidftterms,
			    t1.advemischdmthd,
			    t1.bpipftdaysbasis,
			    t1.eligibilitymethods,
			    t1.alwhybridrate,
			    t1.fixedratetenor,
			    t1.odmincapamount,
			    t1.odrulecode,
			    t1.alwzerointacc,
			    t1.finisalwpartialrpy,
			    t1.autorejectiondays,
			    t1.taxnomand,
			    t1.putcallrequired,
			    t1.grcadvintersetreq,
			    t1.grcadvtype,
			    t1.grcadvminterms,
			    t1.grcadvmaxterms,
			    t1.grcadvdefaultterms,
			    t1.advintersetreq,
			    t1.advtype,
			    t1.advminterms,
			    t1.advmaxterms,
			    t1.advdefaultterms,
			    t1.advstage,
			    t1.dsfreq,
			    t1.cashcollateralreq,
			    t1.alwearlypaymethods,
			    t1.tdsallowtomodify,
			    t1.tdsapplicableto,
			    t1.alwvan,
			    t1.vanallocationmethod,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.alwsanctionamt,
			    t1.alwsanctionamtoverride,
			    t1.sanbsdschdle,
			    t1.finisratervwatgrcend,
			    t1.schdonpmtcal,
			    t1.autoapprove,
			    t1.alwplannedemiingrc
			    FROM rmtfinancetypes t1
			    JOIN smtdivisiondetail t3 ON t1.findivision = t3.divisioncode
			    LEFT JOIN steppolicyheader t4 ON t1.dftsteppolicy = t4.policycode
			    LEFT JOIN rules t5 ON t1.downpayrule = t5.ruleid
			    LEFT JOIN rules t6 ON t1.grcpricingmethod = t6.ruleid
			    LEFT JOIN rules t7 ON t1.rpypricingmethod = t7.ruleid
			    LEFT JOIN entity t8 ON t3.entitycode = t8.entitycode
			]]>
		</createView>
	</changeSet>
	
	<changeSet id="06_post" author="shekar.b" dbms="postgresql">
			<sql>
				<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_orgview');
				]]>
			</sql>
	</changeSet>
	
	</changeSet>
		<changeSet id="07" author="Thirupathi.m">
		<sql>
			<![CDATA[
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights); 
				
				Insert into SecRights values((Select max(RightId) + 1 from SecRights), 3, 'FinanceMainDialog_AlwPlannedEmiHolidayInGrace', 'FinanceMainDialog', 0, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				Insert into SecGroupRights values((Select max(GrpRightId) + 1 from SecGroupRights), (Select GrpId from SecGroups where GrpCode = 'LOANQUEUE'), (Select RightId from SecRights where RightName = 'FinanceMainDialog_AlwPlannedEmiHolidayInGrace'), 1, 0, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);	
				Insert into SecGroupRights values((Select max(GrpRightId) + 1 from SecGroupRights), (Select GrpId from SecGroups where GrpCode = 'BFSD_ORIGINATION_MAKER'), (Select RightId from SecRights where RightName = 'FinanceMainDialog_AlwPlannedEmiHolidayInGrace'), 1, 0, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				Insert into SecGroupRights values((Select max(GrpRightId) + 1 from SecGroupRights), (Select GrpId from SecGroups where GrpCode = 'CL_ORIGINATION_WRM'), (Select RightId from SecRights where RightName = 'FinanceMainDialog_AlwPlannedEmiHolidayInGrace'), 1, 0, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				Insert into SecGroupRights values((Select max(GrpRightId) + 1 from SecGroupRights), (Select GrpId from SecGroups where GrpCode = 'CL_ORIGINATION_MAKER'), (Select RightId from SecRights where RightName = 'FinanceMainDialog_AlwPlannedEmiHolidayInGrace'), 1, 0, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				Insert into SecGroupRights values((Select max(GrpRightId) + 1 from SecGroupRights), (Select GrpId from SecGroups where GrpCode = 'LAP_SSO'), (Select RightId from SecRights where RightName = 'FinanceMainDialog_AlwPlannedEmiHolidayInGrace'), 1, 0, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights); 
			]]>
		</sql>
	</changeSet>
	
	
	<changeSet id="08" author="Thirupathi.m">
		<addColumn tableName="FinanceMain_temp">
		  <column name="planEMIHAlwInGrace" type="boolean" defaultValue="false">
				<constraints nullable="false" />
		  </column>
		</addColumn>
	</changeSet>
	
	<changeSet id="09" author="Thirupathi.m">
		<addColumn tableName="FinanceMain">
		  <column name="planEMIHAlwInGrace" type="boolean" defaultValue="false">
				<constraints nullable="false" />
		  </column>
		</addColumn>
	</changeSet>
	
	<changeSet id="10" author="Thirupathi.m">
		<sql>
			<![CDATA[
				Update FinanceMain set planEMIHAlwInGrace = 0;
				Update FinanceMain_temp set planEMIHAlwInGrace = 0;
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="11_pre" author="Thirupathi.m" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_tview');
		 	]]>
		</sql>
	</changeSet>
	
	<changeSet id="11" author="Thirupathi.m">
		<createView viewName="financemain_tview" replaceIfExists="true">
		   <![CDATA[
				  SELECT t1.finreference,
					t1.investmentref,
					t1.numberofterms,
					t1.grcperiodenddate,
					t1.allowgrcperiod,
					t1.gracebaserate,
					t1.gracespecialrate,
					t1.grcpftrate,
					t1.grcpftfrq,
					t1.nextgrcpftdate,
					t1.allowgrcpftrvw,
					t1.grcpftrvwfrq,
					t1.nextgrcpftrvwdate,
					t1.allowgrccpz,
					t1.grccpzfrq,
					t1.nextgrccpzdate,
					t1.repaybaserate,
					t1.repayspecialrate,
					t1.repayprofitrate,
					t1.repayfrq,
					t1.nextrepaydate,
					t1.repaypftfrq,
					t1.nextrepaypftdate,
					t1.allowrepayrvw,
					t1.repayrvwfrq,
					t1.nextrepayrvwdate,
					t1.allowrepaycpz,
					t1.repaycpzfrq,
					t1.nextrepaycpzdate,
					t1.maturitydate,
					t1.cpzatgraceend,
					t1.downpayment,
					t1.graceflatamount,
					t1.reqrepayamount,
					t1.totalprofit,
					t1.totalcpz,
					t1.totalgrosspft,
					t1.totalgrossgrcpft,
					t1.totalgracepft,
					t1.totalgracecpz,
					t1.grcratebasis,
					t1.repayratebasis,
					t1.fintype,
					t1.finremarks,
					t1.finccy,
					t1.schedulemethod,
					t1.profitdaysbasis,
					t1.reqmaturity,
					t1.calterms,
					t1.calmaturity,
					t1.firstrepay,
					t1.lastrepay,
					t1.finstartdate,
					t1.finamount,
					t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
					t1.finrepaymentamount,
					t1.custid,
					t1.defferments,
					t1.plandefercount,
					t1.finbranch,
					t1.finsourceid,
					t1.alloweddefrpychange,
					t1.availeddefrpychange,
					t1.alloweddeffrqchange,
					t1.availeddeffrqchange,
					t1.recaltype,
					t1.finassetvalue,
					t1.disbaccountid,
					t1.repayaccountid,
					t1.finisactive,
					t1.limitvalid,
					t1.overridelimit,
					t1.securitydeposit,
					t1.version,
					t1.lastmntby,
					t1.lastmnton,
					t1.recordstatus,
					t1.rolecode,
					t1.nextrolecode,
					t1.taskid,
					t1.nexttaskid,
					t1.recordtype,
					t1.workflowid,
					t7.fintypedesc AS lovdescfintypename,
					t7.finmaxamount AS lovdescfinmaxamt,
					t7.finminamount AS lovdescfinminamount,
					t1.mindownpayperc,
					t7.finisalwdifferment AS lovdescfinalwdeferment,
					t7.finisdwpayrequired AS lovdescdwnpayreq,
					t7.finmaxdifferment AS lovdescfinmaxdifferment,
					t12.branchdesc AS lovdescfinbranchname,
					t12.branchprovince AS finbranchprovincecode,
					t1.lastrepaydate,
					t1.lastrepaypftdate,
					t1.lastrepayrvwdate,
					t1.lastrepaycpzdate,
					t1.allowgrcrepay,
					t1.grcschdmthd,
					t1.grcmargin,
					t1.repaymargin,
					t1.fincurrassetvalue,
					t1.fincommitmentref,
					t1.finlimitref,
					t1.depreciationfrq,
					t1.fincontractdate,
					t1.nextdepdate,
					t1.lastdepdate,
					t1.finaccount,
					t1.fincustpftaccount,
					t17.acrtilllbd AS lovdescaccruedtilllbd,
					t7.finrvwrateapplfor,
					t1.totalrepayamt,
					t1.closingstatus,
					t1.finapproveddate,
					t1.feechargeamt,
					t1.blacklisted,
					t1.finrepaypftonfrq,
					t1.anualizedpercrate,
					t1.effectiverateofreturn,
					t1.migratedfinance,
					t1.schedulemaintained,
					t1.scheduleregenerated,
					t1.finpurpose,
					t39.loanpurposedesc AS lovdescfinpurposename,
					t1.finstatus,
					t1.finstsreason,
					t1.initiateuser,
					t1.bankname,
					t1.iban,
					t1.accounttype,
					t1.ddareferenceno,
					t7.finscheduleon AS lovdescfinscheduleon,
					t1.custdsr,
					t1.jointaccount,
					t1.jointcustid,
					t1.downpaybank,
					t1.downpaysupl,
					t1.downpayaccount,
					t1.securitycollateral,
					t1.approved,
					t1.discrepancy,
					t1.limitapproved,
					t1.graceterms,
					t7.findivision AS lovdescfindivision,
					t1.rcdmaintainsts,
					t1.finrepaymethod,
					t1.grcprofitdaysbasis,
					t1.stepfinance,
					t1.steptype,
					t1.steppolicy,
					t1.alwmanualsteps,
					t1.noofsteps,
					t1.linkedfinref,
					t1.nextuserid,
					t1.priority,
					t24.policydesc AS lovdescsteppolicyname,
					t1.grcminrate,
					t1.grcmaxrate,
					t1.rpyminrate,
					t1.rpymaxrate,
					t1.deviationapproval,
					t1.manualschedule,
					t1.takeoverfinance,
					t1.grcadvbaserate,
					t1.grcadvmargin,
					t1.grcadvpftrate,
					t1.rpyadvbaserate,
					t1.rpyadvmargin,
					t1.rpyadvpftrate,
					t1.supplementrent,
					t1.increasedcost,
					t1.creditinsamt,
					t1.rolloverfrq,
					t1.nextrolloverdate,
					t27.custstsdescription,
					t1.shariastatus,
					t1.initiatedate,
					t1.finpreapprovedref,
					t1.mmaid,
					t1.accountsofficer,
					t1.feeaccountid,
					t1.fincancelac,
					t28.dealername AS lovdescaccountsofficer,
					t28.dealercity AS lovdescsourcecity,
					t1.dsacode,
					t30.rofficerdesc AS dsacodedesc,
					t1.tdsapplicable,
					t1.mandateid,
					t1.droplinefrq,
					t1.firstdroplinedate,
					t1.pftservicingodlimit,
					t1.insuranceamt,
					t1.deductinsdisb,
					t1.alwbpi,
					t1.bpitreatment,
					t1.planemihalw,
					t1.planemihmethod,
					t1.planemihmaxperyear,
					t1.planemihmax,
					t1.planemihlockperiod,
					t1.planemicpz,
					t1.calroundingmode,
					t1.alwmultidisb,
					t1.applicationno,
					t1.referralid,
					t33.rofficerdesc AS referraliddesc,
					t1.dmacode,
					t34.rofficerdesc AS dmacodedesc,
					t1.salesdepartment,
					t35.deptdesc AS salesdepartmentdesc,
					t1.quickdisb,
					t1.wifreference,
					t1.unplanemihlockperiod,
					t1.unplanemicpz,
					t1.reagecpz,
					t1.maxunplannedemi,
					t1.maxreageholidays,
					t1.availedunplanemi,
					t1.availedreageh,
					t1.bpiamount,
					t1.deductfeedisb,
					t1.rvwrateapplfor,
					t1.schcalonrvw,
					t1.pastduepftcalmthd,
					t1.pastduepftmargin,
					t1.droppingmethod,
					t1.ratechganyday,
					t1.promotioncode,
					t1.restructureloan,
					t1.oldfinreference,
					t1.reagebucket,
					t1.fincategory,
					t1.productcategory,
					t1.roundingtarget,
					t36.entitycode AS lovdescentitycode,
					t1.eligibilitymethod,
					t38.fieldcodevalue AS loveligibilitymethod,
					t38.valuedesc AS lovdesceligibilitymethod,
					t1.employeename,
					t37.rofficerdesc AS employeenamedesc,
					t1.samplingrequired,
					t1.legalrequired,
					t1.grcmaxamount,
					t1.connector,
					t40.dealername AS connectorcode,
					t40.dealercity AS connectordesc,
					t1.advanceemi,
					t1.advemiterms,
					t1.bpipftdaysbasis,
					t1.fixedratetenor,
					t1.fixedtenorrate,
					t12.branchtel AS finbranchcontact,
					t1.processattributes,
					t1.businessvertical,
					bv.code AS businessverticalcode,
					bv.description AS businessverticaldesc,
					t1.grcadvtype,
					t1.grcadvterms,
					t1.advtype,
					t1.advterms,
					t1.advstage,
					t1.tdspercentage,
					t1.tdsstartdate,
					t1.tdsenddate,
					t1.tdslimitamt,
					t1.vanreq,
					t1.vancode,
					t1.allowdrawingpower,
					t1.allowrevolving,
					t1.sanbsdschdle,
					t1.promotionseqid,
					t1.svamount,
					t1.cbamount,
					t1.appliedloanamt,
					t1.finisratervwatgrcend,
					t1.planEMIHAlwInGrace
				   FROM financemain_temp t1
					 JOIN rmtfinancetypes t7 ON t1.fintype  = t7.fintype 
					 LEFT JOIN rmtbranches t12 ON t1.finbranch  = t12.branchcode 
					 LEFT JOIN finpftdetails t17 ON t17.finreference  = t1.finreference 
					 LEFT JOIN steppolicyheader t24 ON t1.steppolicy  = t24.policycode 
					 LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus  = t27.custstscode 
					 LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
					 LEFT JOIN relationshipofficers t30 ON t1.dsacode  = t30.rofficercode 
					 LEFT JOIN relationshipofficers t33 ON t1.referralid  = t33.rofficercode 
					 LEFT JOIN relationshipofficers t34 ON t1.dmacode  = t34.rofficercode 
					 LEFT JOIN bmtdepartments t35 ON t1.salesdepartment  = t35.deptcode 
					 LEFT JOIN smtdivisiondetail t36 ON t7.findivision  = t36.divisioncode 
					 LEFT JOIN relationshipofficers t37 ON t1.employeename  = t37.rofficercode 
					 LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode  = 'ELGMETHOD' 
					 LEFT JOIN loanpurposes t39 ON t1.finpurpose  = t39.loanpurposecode 
					 LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
					 LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
			]]>
		</createView>
	</changeSet>
	
	<changeSet id="11_post" author="Thirupathi.m" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>
	
	
	<changeSet id="12_pre" author="Thirupathi.m" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_aview');
		 	]]>
		</sql>
	</changeSet>
	
	<changeSet id="12" author="Thirupathi.m">
		<createView viewName="financemain_aview" replaceIfExists="true">
		 <![CDATA[ 
			  SELECT t1.finreference,
			    t1.investmentref,
			    t1.numberofterms,
			    t1.grcperiodenddate,
			    t1.allowgrcperiod,
			    t1.gracebaserate,
			    t1.gracespecialrate,
			    t1.grcpftrate,
			    t1.grcpftfrq,
			    t1.nextgrcpftdate,
			    t1.allowgrcpftrvw,
			    t1.grcpftrvwfrq,
			    t1.nextgrcpftrvwdate,
			    t1.allowgrccpz,
			    t1.grccpzfrq,
			    t1.nextgrccpzdate,
			    t1.repaybaserate,
			    t1.repayspecialrate,
			    t1.repayprofitrate,
			    t1.repayfrq,
			    t1.nextrepaydate,
			    t1.repaypftfrq,
			    t1.nextrepaypftdate,
			    t1.allowrepayrvw,
			    t1.repayrvwfrq,
			    t1.nextrepayrvwdate,
			    t1.allowrepaycpz,
			    t1.repaycpzfrq,
			    t1.nextrepaycpzdate,
			    t1.maturitydate,
			    t1.cpzatgraceend,
			    t1.downpayment,
			    t1.graceflatamount,
			    t1.reqrepayamount,
			    t1.totalprofit,
			    t1.totalcpz,
			    t1.totalgrosspft,
			    t1.totalgrossgrcpft,
			    t1.totalgracepft,
			    t1.totalgracecpz,
			    t1.grcratebasis,
			    t1.repayratebasis,
			    t1.fintype,
			    t1.finremarks,
			    t1.finccy,
			    t1.schedulemethod,
			    t1.profitdaysbasis,
			    t1.reqmaturity,
			    t1.calterms,
			    t1.calmaturity,
			    t1.firstrepay,
			    t1.lastrepay,
			    t1.finstartdate,
			    t1.finamount,
			    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
			    t1.finrepaymentamount,
			    t1.custid,
			    t1.defferments,
			    t1.plandefercount,
			    t1.finbranch,
			    t1.finsourceid,
			    t1.alloweddefrpychange,
			    t1.availeddefrpychange,
			    t1.alloweddeffrqchange,
			    t1.availeddeffrqchange,
			    t1.recaltype,
			    t1.finassetvalue,
			    t1.disbaccountid,
			    t1.repayaccountid,
			    t1.finisactive,
			    t1.limitvalid,
			    t1.overridelimit,
			    t1.securitydeposit,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t7.fintypedesc AS lovdescfintypename,
			    t7.finmaxamount AS lovdescfinmaxamt,
			    t7.finminamount AS lovdescfinminamount,
			    t1.mindownpayperc,
			    t7.finisalwdifferment AS lovdescfinalwdeferment,
			    t7.finisdwpayrequired AS lovdescdwnpayreq,
			    t7.finmaxdifferment AS lovdescfinmaxdifferment,
			    t12.branchdesc AS lovdescfinbranchname,
			    t12.branchprovince AS finbranchprovincecode,
			    t1.lastrepaydate,
			    t1.lastrepaypftdate,
			    t1.lastrepayrvwdate,
			    t1.lastrepaycpzdate,
			    t1.allowgrcrepay,
			    t1.grcschdmthd,
			    t1.grcmargin,
			    t1.repaymargin,
			    t1.fincurrassetvalue,
			    t1.fincommitmentref,
			    t1.finlimitref,
			    t1.depreciationfrq,
			    t1.fincontractdate,
			    t1.nextdepdate,
			    t1.lastdepdate,
			    t1.finaccount,
			    t1.fincustpftaccount,
			    t17.acrtilllbd AS lovdescaccruedtilllbd,
			    t7.finrvwrateapplfor,
			    t1.totalrepayamt,
			    t1.closingstatus,
			    t1.finapproveddate,
			    t1.feechargeamt,
			    t1.blacklisted,
			    t1.finrepaypftonfrq,
			    t1.anualizedpercrate,
			    t1.effectiverateofreturn,
			    t1.migratedfinance,
			    t1.schedulemaintained,
			    t1.scheduleregenerated,
			    t1.finpurpose,
			    t39.loanpurposedesc AS lovdescfinpurposename,
			    t1.finstatus,
			    t1.finstsreason,
			    t1.initiateuser,
			    t1.bankname,
			    t1.iban,
			    t1.accounttype,
			    t1.ddareferenceno,
			    t7.finscheduleon AS lovdescfinscheduleon,
			    t1.custdsr,
			    t1.jointaccount,
			    t1.jointcustid,
			    t1.downpaybank,
			    t1.downpaysupl,
			    t1.downpayaccount,
			    t1.securitycollateral,
			    t1.approved,
			    t1.discrepancy,
			    t1.limitapproved,
			    t1.graceterms,
			    t7.findivision AS lovdescfindivision,
			    t1.rcdmaintainsts,
			    t1.finrepaymethod,
			    t1.grcprofitdaysbasis,
			    t1.stepfinance,
			    t1.steptype,
			    t1.steppolicy,
			    t1.alwmanualsteps,
			    t1.noofsteps,
			    t1.linkedfinref,
			    t1.nextuserid,
			    t1.priority,
			    t24.policydesc AS lovdescsteppolicyname,
			    t1.grcminrate,
			    t1.grcmaxrate,
			    t1.rpyminrate,
			    t1.rpymaxrate,
			    t1.deviationapproval,
			    t1.manualschedule,
			    t1.takeoverfinance,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.supplementrent,
			    t1.increasedcost,
			    t1.creditinsamt,
			    t1.rolloverfrq,
			    t1.nextrolloverdate,
			    t27.custstsdescription,
			    t1.shariastatus,
			    t1.initiatedate,
			    t1.finpreapprovedref,
			    t1.mmaid,
			    t1.accountsofficer,
			    t1.feeaccountid,
			    t1.fincancelac,
			    t28.dealername AS lovdescaccountsofficer,
			    t28.dealercity AS lovdescsourcecity,
			    t1.dsacode,
			    t30.rofficerdesc AS dsacodedesc,
			    t1.tdsapplicable,
			    t1.mandateid,
			    t1.droplinefrq,
			    t1.firstdroplinedate,
			    t1.pftservicingodlimit,
			    t1.insuranceamt,
			    t1.deductinsdisb,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.calroundingmode,
			    t1.alwmultidisb,
			    t1.applicationno,
			    t1.referralid,
			    t33.rofficerdesc AS referraliddesc,
			    t1.dmacode,
			    t34.rofficerdesc AS dmacodedesc,
			    t1.salesdepartment,
			    t35.deptdesc AS salesdepartmentdesc,
			    t1.quickdisb,
			    t1.wifreference,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.availedunplanemi,
			    t1.availedreageh,
			    t1.bpiamount,
			    t1.deductfeedisb,
			    t1.rvwrateapplfor,
			    t1.schcalonrvw,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.promotioncode,
			    t1.restructureloan,
			    t1.oldfinreference,
			    t1.reagebucket,
			    t1.fincategory,
			    t1.productcategory,
			    t1.roundingtarget,
			    t36.entitycode AS lovdescentitycode,
			    t1.eligibilitymethod,
			    t38.fieldcodevalue AS loveligibilitymethod,
			    t38.valuedesc AS lovdesceligibilitymethod,
			    t1.employeename,
			    t37.rofficerdesc AS employeenamedesc,
			    t1.samplingrequired,
			    t1.legalrequired,
			    t1.grcmaxamount,
			    t1.connector,
			    t40.dealername AS connectorcode,
			    t40.dealercity AS connectordesc,
			    t1.advanceemi,
			    t1.advemiterms,
			    t1.bpipftdaysbasis,
			    t1.fixedratetenor,
			    t1.fixedtenorrate,
			    t12.branchtel AS finbranchcontact,
			    t1.processattributes,
			    t1.businessvertical,
			    bv.code AS businessverticalcode,
			    bv.description AS businessverticaldesc,
			    t1.grcadvtype,
			    t1.grcadvterms,
			    t1.advtype,
			    t1.advterms,
			    t1.advstage,
			    t1.tdspercentage,
			    t1.tdsstartdate,
			    t1.tdsenddate,
			    t1.tdslimitamt,
			    t1.vanreq,
			    t1.vancode,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.sanbsdschdle,
			    t1.promotionseqid,
			    t1.svamount,
			    t1.cbamount,
			    t1.appliedloanamt,
			    t1.finisratervwatgrcend,
				t1.planEMIHAlwInGrace
			   FROM financemain t1
			     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype 
			     LEFT JOIN rmtbranches t12 ON t1.finbranch  = t12.branchcode 
			     LEFT JOIN finpftdetails t17 ON t17.finreference  = t1.finreference 
			     LEFT JOIN steppolicyheader t24 ON t1.steppolicy  = t24.policycode 
			     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus  = t27.custstscode 
			     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
			     LEFT JOIN relationshipofficers t30 ON t1.dsacode  = t30.rofficercode 
			     LEFT JOIN relationshipofficers t33 ON t1.referralid  = t33.rofficercode 
			     LEFT JOIN relationshipofficers t34 ON t1.dmacode  = t34.rofficercode 
			     LEFT JOIN bmtdepartments t35 ON t1.salesdepartment  = t35.deptcode 
			     LEFT JOIN smtdivisiondetail t36 ON t7.findivision  = t36.divisioncode 
			     LEFT JOIN relationshipofficers t37 ON t1.employeename  = t37.rofficercode 
			     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode  = 'ELGMETHOD' 
			     LEFT JOIN loanpurposes t39 ON t1.finpurpose  = t39.loanpurposecode 
			     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
			     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
			 ]]>
		</createView>
	</changeSet>
	
	<changeSet id="12_post" author="Thirupathi.m" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_aview');
			]]>
		</sql>
	</changeSet>
	
		<changeSet id="13_pre" author="thirupathi" dbms="postgresql">
			<sql>
				<![CDATA[
						select deps_save_and_drop_dependencies ('plf', 'financemain_view');
				]]>
			</sql>
	</changeSet>
	
	
    
	<changeSet id="13" author="Thirupathi.m">
		<createView viewName="financemain_view" replaceIfExists="true">
			<![CDATA[
					SELECT t1.finreference,
				    t1.investmentref,
				    t1.numberofterms,
				    t1.grcperiodenddate,
				    t1.allowgrcperiod,
				    t1.gracebaserate,
				    t1.gracespecialrate,
				    t1.grcpftrate,
				    t1.grcpftfrq,
				    t1.nextgrcpftdate,
				    t1.allowgrcpftrvw,
				    t1.grcpftrvwfrq,
				    t1.nextgrcpftrvwdate,
				    t1.allowgrccpz,
				    t1.grccpzfrq,
				    t1.nextgrccpzdate,
				    t1.repaybaserate,
				    t1.repayspecialrate,
				    t1.repayprofitrate,
				    t1.repayfrq,
				    t1.nextrepaydate,
				    t1.repaypftfrq,
				    t1.nextrepaypftdate,
				    t1.allowrepayrvw,
				    t1.repayrvwfrq,
				    t1.nextrepayrvwdate,
				    t1.allowrepaycpz,
				    t1.repaycpzfrq,
				    t1.nextrepaycpzdate,
				    t1.maturitydate,
				    t1.cpzatgraceend,
				    t1.downpayment,
				    t1.graceflatamount,
				    t1.reqrepayamount,
				    t1.totalprofit,
				    t1.totalcpz,
				    t1.totalgrosspft,
				    t1.totalgrossgrcpft,
				    t1.totalgracepft,
				    t1.totalgracecpz,
				    t1.grcratebasis,
				    t1.repayratebasis,
				    t1.fintype,
				    t1.finremarks,
				    t1.finccy,
				    t1.schedulemethod,
				    t1.profitdaysbasis,
				    t1.reqmaturity,
				    t1.calterms,
				    t1.calmaturity,
				    t1.firstrepay,
				    t1.lastrepay,
				    t1.finstartdate,
				    t1.finamount,
				    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
				    t1.finrepaymentamount,
				    t1.custid,
				    t1.defferments,
				    t1.plandefercount,
				    t1.finbranch,
				    t1.finsourceid,
				    t1.alloweddefrpychange,
				    t1.availeddefrpychange,
				    t1.alloweddeffrqchange,
				    t1.availeddeffrqchange,
				    t1.recaltype,
				    t1.finassetvalue,
				    t1.disbaccountid,
				    t1.repayaccountid,
				    t1.finisactive,
				    t1.limitvalid,
				    t1.overridelimit,
				    t1.securitydeposit,
				    t1.version,
				    t1.lastmntby,
				    t1.lastmnton,
				    t1.recordstatus,
				    t1.rolecode,
				    t1.nextrolecode,
				    t1.taskid,
				    t1.nexttaskid,
				    t1.recordtype,
				    t1.workflowid,
				    t7.fintypedesc AS lovdescfintypename,
				    t7.finmaxamount AS lovdescfinmaxamt,
				    t7.finminamount AS lovdescfinminamount,
				    t1.mindownpayperc,
				    t7.finisalwdifferment AS lovdescfinalwdeferment,
				    t7.finisdwpayrequired AS lovdescdwnpayreq,
				    t7.finmaxdifferment AS lovdescfinmaxdifferment,
				    t12.branchdesc AS lovdescfinbranchname,
				    t12.branchprovince AS finbranchprovincecode,
				    t1.lastrepaydate,
				    t1.lastrepaypftdate,
				    t1.lastrepayrvwdate,
				    t1.lastrepaycpzdate,
				    t1.allowgrcrepay,
				    t1.grcschdmthd,
				    t1.grcmargin,
				    t1.repaymargin,
				    t1.fincurrassetvalue,
				    t1.fincommitmentref,
				    t1.finlimitref,
				    t1.depreciationfrq,
				    t1.fincontractdate,
				    t1.nextdepdate,
				    t1.lastdepdate,
				    t1.finaccount,
				    t1.fincustpftaccount,
				    t17.acrtilllbd AS lovdescaccruedtilllbd,
				    t7.finrvwrateapplfor,
				    t1.totalrepayamt,
				    t1.closingstatus,
				    t1.finapproveddate,
				    t1.feechargeamt,
				    t1.blacklisted,
				    t1.finrepaypftonfrq,
				    t1.anualizedpercrate,
				    t1.effectiverateofreturn,
				    t1.migratedfinance,
				    t1.schedulemaintained,
				    t1.scheduleregenerated,
				    t1.finpurpose,
				    t39.loanpurposedesc AS lovdescfinpurposename,
				    t1.finstatus,
				    t1.finstsreason,
				    t1.initiateuser,
				    t1.bankname,
				    t1.iban,
				    t1.accounttype,
				    t1.ddareferenceno,
				    t7.finscheduleon AS lovdescfinscheduleon,
				    t1.custdsr,
				    t1.jointaccount,
				    t1.jointcustid,
				    t1.downpaybank,
				    t1.downpaysupl,
				    t1.downpayaccount,
				    t1.securitycollateral,
				    t1.approved,
				    t1.discrepancy,
				    t1.limitapproved,
				    t1.graceterms,
				    t7.findivision AS lovdescfindivision,
				    t1.rcdmaintainsts,
				    t1.finrepaymethod,
				    t1.grcprofitdaysbasis,
				    t1.stepfinance,
				    t1.steptype,
				    t1.steppolicy,
				    t1.alwmanualsteps,
				    t1.noofsteps,
				    t1.linkedfinref,
				    t1.nextuserid,
				    t1.priority,
				    t24.policydesc AS lovdescsteppolicyname,
				    t1.grcminrate,
				    t1.grcmaxrate,
				    t1.rpyminrate,
				    t1.rpymaxrate,
				    t1.deviationapproval,
				    t1.manualschedule,
				    t1.takeoverfinance,
				    t1.grcadvbaserate,
				    t1.grcadvmargin,
				    t1.grcadvpftrate,
				    t1.rpyadvbaserate,
				    t1.rpyadvmargin,
				    t1.rpyadvpftrate,
				    t1.supplementrent,
				    t1.increasedcost,
				    t1.creditinsamt,
				    t1.rolloverfrq,
				    t1.nextrolloverdate,
				    t27.custstsdescription,
				    t1.shariastatus,
				    t1.initiatedate,
				    t1.finpreapprovedref,
				    t1.mmaid,
				    t1.accountsofficer,
				    t1.feeaccountid,
				    t1.fincancelac,
				    t28.dealername AS lovdescaccountsofficer,
				    t28.dealercity AS lovdescsourcecity,
				    t1.dsacode,
				    t30.rofficerdesc AS dsacodedesc,
				    t1.tdsapplicable,
				    t1.mandateid,
				    t1.droplinefrq,
				    t1.firstdroplinedate,
				    t1.pftservicingodlimit,
				    t1.insuranceamt,
				    t1.deductinsdisb,
				    t1.alwbpi,
				    t1.bpitreatment,
				    t1.planemihalw,
				    t1.planemihmethod,
				    t1.planemihmaxperyear,
				    t1.planemihmax,
				    t1.planemihlockperiod,
				    t1.planemicpz,
				    t1.calroundingmode,
				    t1.alwmultidisb,
				    t1.applicationno,
				    t1.referralid,
				    t33.rofficerdesc AS referraliddesc,
				    t1.dmacode,
				    t34.rofficerdesc AS dmacodedesc,
				    t1.salesdepartment,
				    t35.deptdesc AS salesdepartmentdesc,
				    t1.quickdisb,
				    t1.wifreference,
				    t1.unplanemihlockperiod,
				    t1.unplanemicpz,
				    t1.reagecpz,
				    t1.maxunplannedemi,
				    t1.maxreageholidays,
				    t1.availedunplanemi,
				    t1.availedreageh,
				    t1.bpiamount,
				    t1.deductfeedisb,
				    t1.rvwrateapplfor,
				    t1.schcalonrvw,
				    t1.pastduepftcalmthd,
				    t1.pastduepftmargin,
				    t1.droppingmethod,
				    t1.ratechganyday,
				    t1.promotioncode,
				    t1.restructureloan,
				    t1.oldfinreference,
				    t1.reagebucket,
				    t1.fincategory,
				    t1.productcategory,
				    t1.roundingtarget,
				    t36.entitycode AS lovdescentitycode,
				    t1.eligibilitymethod,
				    t38.fieldcodevalue AS loveligibilitymethod,
				    t38.valuedesc AS lovdesceligibilitymethod,
				    t1.employeename,
				    t37.rofficerdesc AS employeenamedesc,
				    t1.samplingrequired,
				    t1.legalrequired,
				    t1.grcmaxamount,
				    t1.connector,
				    t40.dealername AS connectorcode,
				    t40.dealercity AS connectordesc,
				    t1.advanceemi,
				    t1.advemiterms,
				    t1.bpipftdaysbasis,
				    t1.fixedratetenor,
				    t1.fixedtenorrate,
				    t12.branchtel AS finbranchcontact,
				    t1.processattributes,
				    t1.businessvertical,
				    bv.code AS businessverticalcode,
				    bv.description AS businessverticaldesc,
				    t1.grcadvtype,
				    t1.grcadvterms,
				    t1.advtype,
				    t1.advterms,
				    t1.advstage,
				    t1.tdspercentage,
				    t1.tdsstartdate,
				    t1.tdsenddate,
				    t1.tdslimitamt,
				    t1.vanreq,
				    t1.vancode,
				    t1.allowdrawingpower,
				    t1.allowrevolving,
				    t1.sanbsdschdle,
				    t1.promotionseqid,
				    t1.svamount,
				    t1.cbamount,
				    t1.appliedloanamt,
				    t1.finisratervwatgrcend,
					t1.planEMIHAlwInGrace
				   FROM financemain_temp t1
				     JOIN rmtfinancetypes t7 ON t1.fintype  = t7.fintype 
				     LEFT JOIN rmtbranches t12 ON t1.finbranch  = t12.branchcode 
				     LEFT JOIN finpftdetails t17 ON t17.finreference  = t1.finreference 
				     LEFT JOIN steppolicyheader t24 ON t1.steppolicy  = t24.policycode 
				     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus  = t27.custstscode 
				     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
				     LEFT JOIN relationshipofficers t30 ON t1.dsacode  = t30.rofficercode 
				     LEFT JOIN relationshipofficers t33 ON t1.referralid  = t33.rofficercode 
				     LEFT JOIN relationshipofficers t34 ON t1.dmacode  = t34.rofficercode 
				     LEFT JOIN bmtdepartments t35 ON t1.salesdepartment  = t35.deptcode 
				     LEFT JOIN smtdivisiondetail t36 ON t7.findivision  = t36.divisioncode 
				     LEFT JOIN relationshipofficers t37 ON t1.employeename  = t37.rofficercode 
				     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode  = 'ELGMETHOD' 
				     LEFT JOIN loanpurposes t39 ON t1.finpurpose  = t39.loanpurposecode 
				     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
				     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
				UNION ALL
				 SELECT t1.finreference,
				    t1.investmentref,
				    t1.numberofterms,
				    t1.grcperiodenddate,
				    t1.allowgrcperiod,
				    t1.gracebaserate,
				    t1.gracespecialrate,
				    t1.grcpftrate,
				    t1.grcpftfrq,
				    t1.nextgrcpftdate,
				    t1.allowgrcpftrvw,
				    t1.grcpftrvwfrq,
				    t1.nextgrcpftrvwdate,
				    t1.allowgrccpz,
				    t1.grccpzfrq,
				    t1.nextgrccpzdate,
				    t1.repaybaserate,
				    t1.repayspecialrate,
				    t1.repayprofitrate,
				    t1.repayfrq,
				    t1.nextrepaydate,
				    t1.repaypftfrq,
				    t1.nextrepaypftdate,
				    t1.allowrepayrvw,
				    t1.repayrvwfrq,
				    t1.nextrepayrvwdate,
				    t1.allowrepaycpz,
				    t1.repaycpzfrq,
				    t1.nextrepaycpzdate,
				    t1.maturitydate,
				    t1.cpzatgraceend,
				    t1.downpayment,
				    t1.graceflatamount,
				    t1.reqrepayamount,
				    t1.totalprofit,
				    t1.totalcpz,
				    t1.totalgrosspft,
				    t1.totalgrossgrcpft,
				    t1.totalgracepft,
				    t1.totalgracecpz,
				    t1.grcratebasis,
				    t1.repayratebasis,
				    t1.fintype,
				    t1.finremarks,
				    t1.finccy,
				    t1.schedulemethod,
				    t1.profitdaysbasis,
				    t1.reqmaturity,
				    t1.calterms,
				    t1.calmaturity,
				    t1.firstrepay,
				    t1.lastrepay,
				    t1.finstartdate,
				    t1.finamount,
				    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
				    t1.finrepaymentamount,
				    t1.custid,
				    t1.defferments,
				    t1.plandefercount,
				    t1.finbranch,
				    t1.finsourceid,
				    t1.alloweddefrpychange,
				    t1.availeddefrpychange,
				    t1.alloweddeffrqchange,
				    t1.availeddeffrqchange,
				    t1.recaltype,
				    t1.finassetvalue,
				    t1.disbaccountid,
				    t1.repayaccountid,
				    t1.finisactive,
				    t1.limitvalid,
				    t1.overridelimit,
				    t1.securitydeposit,
				    t1.version,
				    t1.lastmntby,
				    t1.lastmnton,
				    t1.recordstatus,
				    t1.rolecode,
				    t1.nextrolecode,
				    t1.taskid,
				    t1.nexttaskid,
				    t1.recordtype,
				    t1.workflowid,
				    t7.fintypedesc AS lovdescfintypename,
				    t7.finmaxamount AS lovdescfinmaxamt,
				    t7.finminamount AS lovdescfinminamount,
				    t1.mindownpayperc,
				    t7.finisalwdifferment AS lovdescfinalwdeferment,
				    t7.finisdwpayrequired AS lovdescdwnpayreq,
				    t7.finmaxdifferment AS lovdescfinmaxdifferment,
				    t12.branchdesc AS lovdescfinbranchname,
				    t12.branchprovince AS finbranchprovincecode,
				    t1.lastrepaydate,
				    t1.lastrepaypftdate,
				    t1.lastrepayrvwdate,
				    t1.lastrepaycpzdate,
				    t1.allowgrcrepay,
				    t1.grcschdmthd,
				    t1.grcmargin,
				    t1.repaymargin,
				    t1.fincurrassetvalue,
				    t1.fincommitmentref,
				    t1.finlimitref,
				    t1.depreciationfrq,
				    t1.fincontractdate,
				    t1.nextdepdate,
				    t1.lastdepdate,
				    t1.finaccount,
				    t1.fincustpftaccount,
				    t17.acrtilllbd AS lovdescaccruedtilllbd,
				    t7.finrvwrateapplfor,
				    t1.totalrepayamt,
				    t1.closingstatus,
				    t1.finapproveddate,
				    t1.feechargeamt,
				    t1.blacklisted,
				    t1.finrepaypftonfrq,
				    t1.anualizedpercrate,
				    t1.effectiverateofreturn,
				    t1.migratedfinance,
				    t1.schedulemaintained,
				    t1.scheduleregenerated,
				    t1.finpurpose,
				    t39.loanpurposedesc AS lovdescfinpurposename,
				    t1.finstatus,
				    t1.finstsreason,
				    t1.initiateuser,
				    t1.bankname,
				    t1.iban,
				    t1.accounttype,
				    t1.ddareferenceno,
				    t7.finscheduleon AS lovdescfinscheduleon,
				    t1.custdsr,
				    t1.jointaccount,
				    t1.jointcustid,
				    t1.downpaybank,
				    t1.downpaysupl,
				    t1.downpayaccount,
				    t1.securitycollateral,
				    t1.approved,
				    t1.discrepancy,
				    t1.limitapproved,
				    t1.graceterms,
				    t7.findivision AS lovdescfindivision,
				    t1.rcdmaintainsts,
				    t1.finrepaymethod,
				    t1.grcprofitdaysbasis,
				    t1.stepfinance,
				    t1.steptype,
				    t1.steppolicy,
				    t1.alwmanualsteps,
				    t1.noofsteps,
				    t1.linkedfinref,
				    t1.nextuserid,
				    t1.priority,
				    t24.policydesc AS lovdescsteppolicyname,
				    t1.grcminrate,
				    t1.grcmaxrate,
				    t1.rpyminrate,
				    t1.rpymaxrate,
				    t1.deviationapproval,
				    t1.manualschedule,
				    t1.takeoverfinance,
				    t1.grcadvbaserate,
				    t1.grcadvmargin,
				    t1.grcadvpftrate,
				    t1.rpyadvbaserate,
				    t1.rpyadvmargin,
				    t1.rpyadvpftrate,
				    t1.supplementrent,
				    t1.increasedcost,
				    t1.creditinsamt,
				    t1.rolloverfrq,
				    t1.nextrolloverdate,
				    t27.custstsdescription,
				    t1.shariastatus,
				    t1.initiatedate,
				    t1.finpreapprovedref,
				    t1.mmaid,
				    t1.accountsofficer,
				    t1.feeaccountid,
				    t1.fincancelac,
				    t28.dealername AS lovdescaccountsofficer,
				    t28.dealercity AS lovdescsourcecity,
				    t1.dsacode,
				    t30.rofficerdesc AS dsacodedesc,
				    t1.tdsapplicable,
				    t1.mandateid,
				    t1.droplinefrq,
				    t1.firstdroplinedate,
				    t1.pftservicingodlimit,
				    t1.insuranceamt,
				    t1.deductinsdisb,
				    t1.alwbpi,
				    t1.bpitreatment,
				    t1.planemihalw,
				    t1.planemihmethod,
				    t1.planemihmaxperyear,
				    t1.planemihmax,
				    t1.planemihlockperiod,
				    t1.planemicpz,
				    t1.calroundingmode,
				    t1.alwmultidisb,
				    t1.applicationno,
				    t1.referralid,
				    t33.rofficerdesc AS referraliddesc,
				    t1.dmacode,
				    t34.rofficerdesc AS dmacodedesc,
				    t1.salesdepartment,
				    t35.deptdesc AS salesdepartmentdesc,
				    t1.quickdisb,
				    t1.wifreference,
				    t1.unplanemihlockperiod,
				    t1.unplanemicpz,
				    t1.reagecpz,
				    t1.maxunplannedemi,
				    t1.maxreageholidays,
				    t1.availedunplanemi,
				    t1.availedreageh,
				    t1.bpiamount,
				    t1.deductfeedisb,
				    t1.rvwrateapplfor,
				    t1.schcalonrvw,
				    t1.pastduepftcalmthd,
				    t1.pastduepftmargin,
				    t1.droppingmethod,
				    t1.ratechganyday,
				    t1.promotioncode,
				    t1.restructureloan,
				    t1.oldfinreference,
				    t1.reagebucket,
				    t1.fincategory,
				    t1.productcategory,
				    t1.roundingtarget,
				    t36.entitycode AS lovdescentitycode,
				    t1.eligibilitymethod,
				    t38.fieldcodevalue AS loveligibilitymethod,
				    t38.valuedesc AS lovdesceligibilitymethod,
				    t1.employeename,
				    t37.rofficerdesc AS employeenamedesc,
				    t1.samplingrequired,
				    t1.legalrequired,
				    t1.grcmaxamount,
				    t1.connector,
				    t40.dealername AS connectorcode,
				    t40.dealercity AS connectordesc,
				    t1.advanceemi,
				    t1.advemiterms,
				    t1.bpipftdaysbasis,
				    t1.fixedratetenor,
				    t1.fixedtenorrate,
				    t12.branchtel AS finbranchcontact,
				    t1.processattributes,
				    t1.businessvertical,
				    bv.code AS businessverticalcode,
				    bv.description AS businessverticaldesc,
				    t1.grcadvtype,
				    t1.grcadvterms,
				    t1.advtype,
				    t1.advterms,
				    t1.advstage,
				    t1.tdspercentage,
				    t1.tdsstartdate,
				    t1.tdsenddate,
				    t1.tdslimitamt,
				    t1.vanreq,
				    t1.vancode,
				    t1.allowdrawingpower,
				    t1.allowrevolving,
				    t1.sanbsdschdle,
				    t1.promotionseqid,
				    t1.svamount,
				    t1.cbamount,
				    t1.appliedloanamt,
				    t1.finisratervwatgrcend,
					t1.planEMIHAlwInGrace
				   FROM financemain t1
				     JOIN rmtfinancetypes t7 ON t1.fintype  = t7.fintype 
				     LEFT JOIN rmtbranches t12 ON t1.finbranch  = t12.branchcode 
				     LEFT JOIN finpftdetails t17 ON t17.finreference  = t1.finreference 
				     LEFT JOIN steppolicyheader t24 ON t1.steppolicy  = t24.policycode 
				     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus  = t27.custstscode 
				     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
				     LEFT JOIN relationshipofficers t30 ON t1.dsacode  = t30.rofficercode 
				     LEFT JOIN relationshipofficers t33 ON t1.referralid  = t33.rofficercode 
				     LEFT JOIN relationshipofficers t34 ON t1.dmacode  = t34.rofficercode 
				     LEFT JOIN bmtdepartments t35 ON t1.salesdepartment  = t35.deptcode 
				     LEFT JOIN smtdivisiondetail t36 ON t7.findivision  = t36.divisioncode 
				     LEFT JOIN relationshipofficers t37 ON t1.employeename  = t37.rofficercode 
				     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode  = 'ELGMETHOD' 
				     LEFT JOIN loanpurposes t39 ON t1.finpurpose  = t39.loanpurposecode 
				     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
				     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
				     WHERE NOT (EXISTS ( SELECT 1
				           FROM financemain_temp
				          WHERE financemain_temp.finreference  = t1.finreference ))
				   ]]>
			</createView>
	</changeSet>
	
	<changeSet id="13_post" author="thirupathi" dbms="postgresql">
			<sql>
				<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_view');
				]]>
			</sql>
	</changeSet>
	
</databaseChangeLog>