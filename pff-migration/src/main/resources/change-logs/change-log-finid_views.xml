<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="add.schema" value=" " dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="satish" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>

	<!-- (FMV) :: Finance Main Views handle in single place start -->

	<changeSet id="FMV_1_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'financemain_lview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_1" author="Gopal.p">
		<createView viewName="FINANCEMAIN_LVIEW" replaceIfExists="true">
			<![CDATA[
		 		SELECT T1.FINID,
		 			T1.FINREFERENCE,
					T1.INVESTMENTREF,
					T1.FINTYPE,
					T1.FINCCY,
					T1.FINAMOUNT,
					T1.DOWNPAYMENT,
					T1.FEECHARGEAMT,
					T1.SCHEDULEMETHOD,
					T1.NUMBEROFTERMS,
					T1.RECORDSTATUS,
					T1.RECORDTYPE,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.FINBRANCH,
					T1.FINCONTRACTDATE,
					T1.LINKEDFINREF,
					T1.NEXTUSERID,
					T1.PRIORITY,
					T1.WORKFLOWID,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.FINPREAPPROVEDREF,
					T1.RCDMAINTAINSTS,
					T1.INSURANCEAMT,
					T1.FINCURRASSETVALUE,
					T1.CALTERMS,
					T1.DEVIATIONAPPROVAL,
					T1.FINPURPOSE,
					T1.INITIATEDATE,
					T1.FINASSETVALUE,
					T2.CUSTCIF LOVDESCCUSTCIF,
					T2.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
					T2.CUSTPASSPORTNO LOVDESCCUSTPASSPORTNO,
					T2.CUSTDOB LOVDESCCUSTDOB,
					T2.CUSTCRCPR LOVDESCCUSTCRCPR,
					T2.PHONENUMBER,
					T3.FINCATEGORY LOVDESCPRODUCTCODENAME,
					T3.FINDIVISION LOVDESCFINDIVISION,
					T3.PRODUCT LOVDESCFINPRODUCT,
					T3.FINTYPEDESC LOVDESCFINTYPENAME,
					COALESCE(T4.ROLEDESC, ${add.schema}FN_GET_ROLEDESC(T1.NEXTROLECODE)) LOVDESCREQUESTSTAGE,
					T1.SAMPLINGREQUIRED,
					T1.ADVANCEEMI,
					T1.ADVEMITERMS,
					T1.BPIPFTDAYSBASIS,
					T1.GRACETERMS,
					T1.PRODUCTCATEGORY,
					T1.REQLOANAMT,
					T1.REQLOANTENOR,
					T1.FINOCRREQUIRED,
					T1.OFFERPRODUCT,
					T1.OFFERAMOUNT,
					T1.CUSTSEGMENTATION,
					T1.BASEPRODUCT,
					T1.PROCESSTYPE,
					T1.BUREAUTIMESERIES,
					T1.CAMPAIGNNAME,
					T1.EXISTINGLANREFNO,
					T1.LEADSOURCE,
					T1.POSOURCE,
					T1.RSA,
					T1.VERIFICATION,
					T1.SOURCINGBRANCH,
					T1.SOURCHANNELCATEGORY,
					T1.ASMNAME,
					T1.OFFERID,
					T1.APPLICATIONNO,
					T1.LASTMNTON,
					T1.VERSION,
					T1.TDSAPPLICABLE,
					T2.CUSTID,
					T1.INSTBASEDSCHD,
					T1.ALLOWSUBVENTION,
					T1.TDSTYPE,
					T1.WRITEOFFLOAN,
					T1.RESTRUCTURE,
					T1.CALCOFSTEPS,
					T1.STEPSAPPLIEDFOR,
					T1.NOOFGRCSTEPS,
					T1.SCHDVERSION,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T5.DEALERNAME MANUFACTURERDEALERNAME,
					T5.CODE MANUFACTURERDEALERCODE
				FROM FINANCEMAIN_TEMP T1
				INNER JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
				INNER JOIN RMTFINANCETYPES T3 ON T3.FINTYPE = T1.FINTYPE
				LEFT JOIN SECROLES T4 ON T1.NEXTROLECODE= T4.ROLECD
				LEFT JOIN AMTVEHICLEDEALER T5 ON T1.MANUFACTURERDEALERID = T5.DEALERID
			]]>
		</createView>
	</changeSet>

	<changeSet id="FMV_1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_lview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_2_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'financemain_aview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_2" author="Gopal.p">
		<createView viewName="FINANCEMAIN_AVIEW" replaceIfExists="true">
			 <![CDATA[ 
				SELECT T1.FINID,
					T1.FINREFERENCE,
			    	T1.INVESTMENTREF,
			    	T1.NUMBEROFTERMS,
			    	T1.GRCPERIODENDDATE,
			    	T1.ALLOWGRCPERIOD,
			    	T1.GRACEBASERATE,
			    	T1.GRACESPECIALRATE,
			    	T1.GRCPFTRATE,
			    	T1.GRCPFTFRQ,
			    	T1.NEXTGRCPFTDATE,
			    	T1.ALLOWGRCPFTRVW,
			    	T1.GRCPFTRVWFRQ,
			    	T1.NEXTGRCPFTRVWDATE,
			    	T1.ALLOWGRCCPZ,
			    	T1.GRCCPZFRQ,
			    	T1.NEXTGRCCPZDATE,
			    	T1.REPAYBASERATE,
			    	T1.REPAYSPECIALRATE,
			    	T1.REPAYPROFITRATE,
			    	T1.REPAYFRQ,
			    	T1.NEXTREPAYDATE,
			    	T1.REPAYPFTFRQ,
			    	T1.NEXTREPAYPFTDATE,
			    	T1.ALLOWREPAYRVW,
			    	T1.REPAYRVWFRQ,
			    	T1.NEXTREPAYRVWDATE,
			    	T1.ALLOWREPAYCPZ,
			    	T1.REPAYCPZFRQ,
			    	T1.NEXTREPAYCPZDATE,
			    	T1.MATURITYDATE,
			    	T1.CPZATGRACEEND,
			    	T1.DOWNPAYMENT,
			    	T1.GRACEFLATAMOUNT,
			    	T1.REQREPAYAMOUNT,
			    	T1.TOTALPROFIT,
			    	T1.TOTALCPZ,
			    	T1.TOTALGROSSPFT,
			    	T1.TOTALGROSSGRCPFT,
			    	T1.TOTALGRACEPFT,
			    	T1.TOTALGRACECPZ,
			    	T1.GRCRATEBASIS,
			    	T1.REPAYRATEBASIS,
			    	T1.FINTYPE,
			    	T1.FINREMARKS,
			    	T1.FINCCY,
			    	T1.SCHEDULEMETHOD,
			    	T1.PROFITDAYSBASIS,
			    	T1.REQMATURITY,
			    	T1.CALTERMS,
			    	T1.CALMATURITY,
			    	T1.FIRSTREPAY,
			    	T1.LASTREPAY,
			    	T1.FINSTARTDATE,
			    	T1.FINAMOUNT,
					T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT LOVDESCFINANCINGAMOUNT,
			    	T1.FINREPAYMENTAMOUNT,
			    	T1.CUSTID,
			   		T1.DEFFERMENTS,
			    	T1.PLANDEFERCOUNT,
			    	T1.FINBRANCH,
			    	T1.FINSOURCEID,
			    	T1.ALLOWEDDEFRPYCHANGE,
			    	T1.AVAILEDDEFRPYCHANGE,
			    	T1.ALLOWEDDEFFRQCHANGE,
			    	T1.AVAILEDDEFFRQCHANGE,
			    	T1.RECALTYPE,
			    	T1.FINASSETVALUE,
			    	T1.DISBACCOUNTID,
			    	T1.REPAYACCOUNTID,
			    	T1.FINISACTIVE,
			    	T1.LIMITVALID,
			    	T1.OVERRIDELIMIT,
			    	T1.SECURITYDEPOSIT,
			    	T1.VERSION,
			    	T1.LASTMNTBY,
			    	T1.LASTMNTON,
			    	T1.RECORDSTATUS,
			    	T1.ROLECODE,
			    	T1.NEXTROLECODE,
			    	T1.TASKID,
			    	T1.NEXTTASKID,
			    	T1.RECORDTYPE,
			    	T1.WORKFLOWID,
					T7.FINTYPEDESC LOVDESCFINTYPENAME,
					T7.FINMAXAMOUNT LOVDESCFINMAXAMT,
					T7.FINMINAMOUNT LOVDESCFINMINAMOUNT,
			    	T1.MINDOWNPAYPERC,
					T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
					T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ,
					T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT,
					T12.BRANCHDESC LOVDESCFINBRANCHNAME,
					T12.BRANCHPROVINCE FINBRANCHPROVINCECODE,
			    	T1.LASTREPAYDATE,
			    	T1.LASTREPAYPFTDATE,
			    	T1.LASTREPAYRVWDATE,
			    	T1.LASTREPAYCPZDATE,
			    	T1.ALLOWGRCREPAY,
			    	T1.GRCSCHDMTHD,
			    	T1.GRCMARGIN,
			    	T1.REPAYMARGIN,
			    	T1.FINCURRASSETVALUE,
			    	T1.FINCOMMITMENTREF,
			    	T1.FINLIMITREF,
			    	T1.DEPRECIATIONFRQ,
			    	T1.FINCONTRACTDATE,
			    	T1.NEXTDEPDATE,
			    	T1.LASTDEPDATE,
			    	T1.FINACCOUNT,
			    	T1.FINCUSTPFTACCOUNT,
					T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD,
			    	T7.FINRVWRATEAPPLFOR,
			    	T1.TOTALREPAYAMT,
			    	T1.CLOSINGSTATUS,
			    	T1.FINAPPROVEDDATE,
			    	T1.FEECHARGEAMT,
			    	T1.BLACKLISTED,
			    	T1.FINREPAYPFTONFRQ,
			    	T1.ANUALIZEDPERCRATE,
			    	T1.EFFECTIVERATEOFRETURN,
			    	T1.MIGRATEDFINANCE,
			    	T1.SCHEDULEMAINTAINED,
			    	T1.SCHEDULEREGENERATED,
			    	T1.FINPURPOSE,
					T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME,
			    	T1.FINSTATUS,
			    	T1.FINSTSREASON,
			    	T1.INITIATEUSER,
			    	T1.BANKNAME,
			    	T1.IBAN,
			    	T1.ACCOUNTTYPE,
			    	T1.DDAREFERENCENO,
					T7.FINSCHEDULEON LOVDESCFINSCHEDULEON,
			    	T1.CUSTDSR,
			    	T1.JOINTACCOUNT,
			    	T1.JOINTCUSTID,
			    	T1.DOWNPAYBANK,
			    	T1.DOWNPAYSUPL,
			    	T1.DOWNPAYACCOUNT,
			    	T1.SECURITYCOLLATERAL,
			    	T1.APPROVED,
			    	T1.DISCREPANCY,
			    	T1.LIMITAPPROVED,
			    	T1.GRACETERMS,
					T7.FINDIVISION LOVDESCFINDIVISION,
			    	T1.RCDMAINTAINSTS,
			    	T1.FINREPAYMETHOD,
			    	T1.GRCPROFITDAYSBASIS,
			    	T1.STEPFINANCE,
			    	T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T1.NEXTUSERID,
				    T1.PRIORITY,
					T24.POLICYDESC LOVDESCSTEPPOLICYNAME,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.DEVIATIONAPPROVAL,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.CREDITINSAMT,
				    T1.ROLLOVERFRQ,
				    T1.NEXTROLLOVERDATE,
				    T27.CUSTSTSDESCRIPTION,
				    T1.SHARIASTATUS,
				    T1.INITIATEDATE,
				    T1.FINPREAPPROVEDREF,
				    T1.MMAID,
				    T1.ACCOUNTSOFFICER,
				    T1.FEEACCOUNTID,
				    T1.FINCANCELAC,
					T28.DEALERNAME LOVDESCACCOUNTSOFFICER,
					T28.DEALERCITY LOVDESCSOURCECITY,
				    T1.DSACODE,
					T30.ROFFICERDESC DSACODEDESC,
				    T1.TDSAPPLICABLE,
				    T1.MANDATEID,
				    T1.DROPLINEFRQ,
				    T1.FIRSTDROPLINEDATE,
				    T1.PFTSERVICINGODLIMIT,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.APPLICATIONNO,
				    T1.REFERRALID,
					T33.ROFFICERDESC REFERRALIDDESC,
				    T1.DMACODE,
					T34.ROFFICERDESC DMACODEDESC,
				    T1.SALESDEPARTMENT,
					T35.DEPTDESC SALESDEPARTMENTDESC,
				    T1.QUICKDISB,
				    T1.WIFREFERENCE,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.AVAILEDUNPLANEMI,
				    T1.AVAILEDREAGEH,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.PROMOTIONCODE,
				    T1.RESTRUCTURELOAN,
				    T1.OLDFINREFERENCE,
				    T1.REAGEBUCKET,
				    T1.FINCATEGORY,
				    T1.PRODUCTCATEGORY,
				    T1.ROUNDINGTARGET,
					T36.ENTITYCODE LOVDESCENTITYCODE,
				    T1.ELIGIBILITYMETHOD,
					T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD,
					T38.VALUEDESC LOVDESCELIGIBILITYMETHOD,
				    T1.EMPLOYEENAME,
					T37.ROFFICERDESC EMPLOYEENAMEDESC,
				    T1.SAMPLINGREQUIRED,
				    T1.LEGALREQUIRED,
				    T1.GRCMAXAMOUNT,
				    T1.CONNECTOR,
					T40.DEALERNAME CONNECTORCODE,
					T40.DEALERCITY CONNECTORDESC,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS,
				    T1.FIXEDRATETENOR,
				    T1.FIXEDTENORRATE,
					T12.BRANCHTEL FINBRANCHCONTACT,
				    T1.PROCESSATTRIBUTES,
				    T1.BUSINESSVERTICAL,
					BV.CODE BUSINESSVERTICALCODE,
					BV.DESCRIPTION BUSINESSVERTICALDESC,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.TDSPERCENTAGE,
				    T1.TDSSTARTDATE,
				    T1.TDSENDDATE,
				    T1.TDSLIMITAMT,
				    T1.VANREQ,
				    T1.VANCODE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.SANBSDSCHDLE,
				    T1.PROMOTIONSEQID,
				    T1.SVAMOUNT,
				    T1.CBAMOUNT,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND,
				    T1.PLANEMIHALWINGRACE,
					T1.REQLOANAMT,
					T1.REQLOANTENOR,
					T1.FINOCRREQUIRED,
					T1.OFFERPRODUCT,
					T1.OFFERAMOUNT,
					T1.CUSTSEGMENTATION,
					T1.BASEPRODUCT,
					T1.PROCESSTYPE,
					T1.BUREAUTIMESERIES,
					T1.CAMPAIGNNAME,
					T1.EXISTINGLANREFNO,
					T1.LEADSOURCE,
					T1.POSOURCE,
					T1.RSA,
					T1.VERIFICATION,
					T1.SOURCINGBRANCH,
					T1.SOURCHANNELCATEGORY,
					T1.ASMNAME,
					T13.BRANCHDESC LOVDESCSOURCINGBRANCH,
					T1.ENDGRCPERIODAFTRFULLDISB,
					T1.AUTOINCGRCENDDATE,
					T1.ALWGRCADJ,
					T1.PMAY,
					T1.OFFERID,
					T1.ALWLOANSPLIT,
					T1.PARENTREF,
					T1.LOANSPLITTED,
					T1.INSTBASEDSCHD,
					C.CUSTCIF LOVDESCCUSTCIF,
					T1.ALLOWSUBVENTION,
					T1.TDSTYPE,
					T1.WRITEOFFLOAN,
					T1.RESTRUCTURE,
					T1.CALCOFSTEPS,
					T1.STEPSAPPLIEDFOR,
					T1.NOOFGRCSTEPS,
					T1.SCHDVERSION,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T41.DEALERNAME MANUFACTURERDEALERNAME,
					T41.CODE MANUFACTURERDEALERCODE
				FROM FINANCEMAIN T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				INNER JOIN CUSTOMERS C ON C.CUSTID = T1.CUSTID
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
			]]>
		</createView>
	</changeSet>

	<changeSet id="FMV_2_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_3_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_3" author="Gopal.p">
		<createView viewName="FINANCEMAIN_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINID,
					T1.FINREFERENCE,
				    T1.INVESTMENTREF,
				    T1.NUMBEROFTERMS,
				    T1.GRCPERIODENDDATE,
				    T1.ALLOWGRCPERIOD,
				    T1.GRACEBASERATE,
				    T1.GRACESPECIALRATE,
				    T1.GRCPFTRATE,
				    T1.GRCPFTFRQ,
				    T1.NEXTGRCPFTDATE,
				    T1.ALLOWGRCPFTRVW,
				    T1.GRCPFTRVWFRQ,
				    T1.NEXTGRCPFTRVWDATE,
				    T1.ALLOWGRCCPZ,
				    T1.GRCCPZFRQ,
				    T1.NEXTGRCCPZDATE,
				    T1.REPAYBASERATE,
				    T1.REPAYSPECIALRATE,
				    T1.REPAYPROFITRATE,
				    T1.REPAYFRQ,
				    T1.NEXTREPAYDATE,
				    T1.REPAYPFTFRQ,
				    T1.NEXTREPAYPFTDATE,
				    T1.ALLOWREPAYRVW,
				    T1.REPAYRVWFRQ,
				    T1.NEXTREPAYRVWDATE,
				    T1.ALLOWREPAYCPZ,
				    T1.REPAYCPZFRQ,
				    T1.NEXTREPAYCPZDATE,
				    T1.MATURITYDATE,
				    T1.CPZATGRACEEND,
				    T1.DOWNPAYMENT,
				    T1.GRACEFLATAMOUNT,
				    T1.REQREPAYAMOUNT,
				    T1.TOTALPROFIT,
				    T1.TOTALCPZ,
				    T1.TOTALGROSSPFT,
				    T1.TOTALGROSSGRCPFT,
				    T1.TOTALGRACEPFT,
				    T1.TOTALGRACECPZ,
				    T1.GRCRATEBASIS,
				    T1.REPAYRATEBASIS,
				    T1.FINTYPE,
				    T1.FINREMARKS,
				    T1.FINCCY,
				    T1.SCHEDULEMETHOD,
				    T1.PROFITDAYSBASIS,
				    T1.REQMATURITY,
				    T1.CALTERMS,
				    T1.CALMATURITY,
				    T1.FIRSTREPAY,
				    T1.LASTREPAY,
				    T1.FINSTARTDATE,
				    T1.FINAMOUNT,
					((T1.FINAMOUNT + T1.FEECHARGEAMT) - T1.DOWNPAYMENT) LOVDESCFINANCINGAMOUNT,
				    T1.FINREPAYMENTAMOUNT,
				    T1.CUSTID,
				    T1.DEFFERMENTS,
				    T1.PLANDEFERCOUNT,
				    T1.FINBRANCH,
				    T1.FINSOURCEID,
				    T1.ALLOWEDDEFRPYCHANGE,
				    T1.AVAILEDDEFRPYCHANGE,
				    T1.ALLOWEDDEFFRQCHANGE,
				    T1.AVAILEDDEFFRQCHANGE,
				    T1.RECALTYPE,
				    T1.FINASSETVALUE,
				    T1.DISBACCOUNTID,
				    T1.REPAYACCOUNTID,
				    T1.FINISACTIVE,
				    T1.LIMITVALID,
				    T1.OVERRIDELIMIT,
				    T1.SECURITYDEPOSIT,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T7.FINTYPEDESC LOVDESCFINTYPENAME,
				    T7.FINMAXAMOUNT LOVDESCFINMAXAMT,
				    T7.FINMINAMOUNT LOVDESCFINMINAMOUNT,
				    T1.MINDOWNPAYPERC,
				    T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
				    T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ,
				    T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT,
				    T12.BRANCHDESC LOVDESCFINBRANCHNAME,
				    T12.BRANCHPROVINCE FINBRANCHPROVINCECODE,
				    T1.LASTREPAYDATE,
				    T1.LASTREPAYPFTDATE,
				    T1.LASTREPAYRVWDATE,
				    T1.LASTREPAYCPZDATE,
				    T1.ALLOWGRCREPAY,
				    T1.GRCSCHDMTHD,
				    T1.GRCMARGIN,
				    T1.REPAYMARGIN,
				    T1.FINCURRASSETVALUE,
				    T1.FINCOMMITMENTREF,
				    T1.FINLIMITREF,
				    T1.DEPRECIATIONFRQ,
				    T1.FINCONTRACTDATE,
				    T1.NEXTDEPDATE,
				    T1.LASTDEPDATE,
				    T1.FINACCOUNT,
				    T1.FINCUSTPFTACCOUNT,
				    T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD,
				    T7.FINRVWRATEAPPLFOR,
				    T1.TOTALREPAYAMT,
				    T1.CLOSINGSTATUS,
				    T1.FINAPPROVEDDATE,
				    T1.FEECHARGEAMT,
				    T1.BLACKLISTED,
				    T1.FINREPAYPFTONFRQ,
				    T1.ANUALIZEDPERCRATE,
				    T1.EFFECTIVERATEOFRETURN,
				    T1.MIGRATEDFINANCE,
				    T1.SCHEDULEMAINTAINED,
				    T1.SCHEDULEREGENERATED,
				    T1.FINPURPOSE,
				    T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME,
				    T1.FINSTATUS,
				    T1.FINSTSREASON,
				    T1.INITIATEUSER,
				    T1.BANKNAME,
				    T1.IBAN,
				    T1.ACCOUNTTYPE,
				    T1.DDAREFERENCENO,
				    T7.FINSCHEDULEON LOVDESCFINSCHEDULEON,
				    T1.CUSTDSR,
				    T1.JOINTACCOUNT,
				    T1.JOINTCUSTID,
				    T1.DOWNPAYBANK,
				    T1.DOWNPAYSUPL,
				    T1.DOWNPAYACCOUNT,
				    T1.SECURITYCOLLATERAL,
				    T1.APPROVED,
				    T1.DISCREPANCY,
				    T1.LIMITAPPROVED,
				    T1.GRACETERMS,
				    T7.FINDIVISION LOVDESCFINDIVISION,
				    T1.RCDMAINTAINSTS,
				    T1.FINREPAYMETHOD,
				    T1.GRCPROFITDAYSBASIS,
				    T1.STEPFINANCE,
				    T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T1.NEXTUSERID,
				    T1.PRIORITY,
				    T24.POLICYDESC LOVDESCSTEPPOLICYNAME,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.DEVIATIONAPPROVAL,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.CREDITINSAMT,
				    T1.ROLLOVERFRQ,
				    T1.NEXTROLLOVERDATE,
				    T27.CUSTSTSDESCRIPTION,
				    T1.SHARIASTATUS,
				    T1.INITIATEDATE,
				    T1.FINPREAPPROVEDREF,
				    T1.MMAID,
				    T1.ACCOUNTSOFFICER,
				    T1.FEEACCOUNTID,
				    T1.FINCANCELAC,
				    T28.DEALERNAME LOVDESCACCOUNTSOFFICER,
				    T28.DEALERCITY LOVDESCSOURCECITY,
				    T1.DSACODE,
				    T30.ROFFICERDESC DSACODEDESC,
				    T1.TDSAPPLICABLE,
				    T1.MANDATEID,
				    T1.DROPLINEFRQ,
				    T1.FIRSTDROPLINEDATE,
				    T1.PFTSERVICINGODLIMIT,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.APPLICATIONNO,
				    T1.REFERRALID,
				    T33.ROFFICERDESC REFERRALIDDESC,
				    T1.DMACODE,
				    T34.ROFFICERDESC DMACODEDESC,
				    T1.SALESDEPARTMENT,
				    T35.DEPTDESC SALESDEPARTMENTDESC,
				    T1.QUICKDISB,
				    T1.WIFREFERENCE,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.AVAILEDUNPLANEMI,
				    T1.AVAILEDREAGEH,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.PROMOTIONCODE,
				    T1.RESTRUCTURELOAN,
				    T1.OLDFINREFERENCE,
				    T1.REAGEBUCKET,
				    T1.FINCATEGORY,
				    T1.PRODUCTCATEGORY,
				    T1.ROUNDINGTARGET,
				    T36.ENTITYCODE LOVDESCENTITYCODE,
				    T1.ELIGIBILITYMETHOD,
				    T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD,
				    T38.VALUEDESC LOVDESCELIGIBILITYMETHOD,
				    T1.EMPLOYEENAME,
				    T37.ROFFICERDESC EMPLOYEENAMEDESC,
				    T1.SAMPLINGREQUIRED,
				    T1.LEGALREQUIRED,
				    T1.GRCMAXAMOUNT,
				    T1.CONNECTOR,
				    T40.DEALERNAME CONNECTORCODE,
				    T40.DEALERCITY CONNECTORDESC,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS,
				    T1.FIXEDRATETENOR,
				    T1.FIXEDTENORRATE,
				    T12.BRANCHTEL FINBRANCHCONTACT,
				    T1.PROCESSATTRIBUTES,
				    T1.BUSINESSVERTICAL,
				    BV.CODE BUSINESSVERTICALCODE,
				    BV.DESCRIPTION BUSINESSVERTICALDESC,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.TDSPERCENTAGE,
				    T1.TDSSTARTDATE,
				    T1.TDSENDDATE,
				    T1.TDSLIMITAMT,
				    T1.VANREQ,
				    T1.VANCODE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.SANBSDSCHDLE,
				    T1.PROMOTIONSEQID,
				    T1.SVAMOUNT,
				    T1.CBAMOUNT,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND,
					T1.REQLOANAMT,
					T1.REQLOANTENOR,
					T1.FINOCRREQUIRED,
					T1.OFFERPRODUCT,
					T1.OFFERAMOUNT,
					T1.CUSTSEGMENTATION,
					T1.BASEPRODUCT,
					T1.PROCESSTYPE,
					T1.BUREAUTIMESERIES,
					T1.CAMPAIGNNAME,
					T1.EXISTINGLANREFNO,
					T1.LEADSOURCE,
					T1.POSOURCE,
					T1.RSA,
					T1.VERIFICATION,
					T1.SOURCINGBRANCH,
					T1.SOURCHANNELCATEGORY,
					T1.ASMNAME,
					T13.BRANCHDESC LOVDESCSOURCINGBRANCH,
					T1.OFFERID,
					T1.ALWGRCADJ,
					T1.ENDGRCPERIODAFTRFULLDISB,
					T1.AUTOINCGRCENDDATE,
					T1.PMAY,
					T1.ALWLOANSPLIT,
					T1.PARENTREF,
					T1.LOANSPLITTED,
					T1.INSTBASEDSCHD,
					T1.PLANEMIHALWINGRACE,
					T1.ALLOWSUBVENTION,
					T1.TDSTYPE,
					T1.WRITEOFFLOAN,
					T1.RESTRUCTURE,
					T1.CALCOFSTEPS,
					T1.STEPSAPPLIEDFOR,
					T1.NOOFGRCSTEPS,
					T1.SCHDVERSION,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T41.DEALERNAME MANUFACTURERDEALERNAME,
					T41.CODE MANUFACTURERDEALERCODE
				FROM FINANCEMAIN_TEMP T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE  = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				UNION ALL
				SELECT T1.FINID,
					T1.FINREFERENCE,
				    T1.INVESTMENTREF,
				    T1.NUMBEROFTERMS,
				    T1.GRCPERIODENDDATE,
				    T1.ALLOWGRCPERIOD,
				    T1.GRACEBASERATE,
				    T1.GRACESPECIALRATE,
				    T1.GRCPFTRATE,
				    T1.GRCPFTFRQ,
				    T1.NEXTGRCPFTDATE,
				    T1.ALLOWGRCPFTRVW,
				    T1.GRCPFTRVWFRQ,
				    T1.NEXTGRCPFTRVWDATE,
				    T1.ALLOWGRCCPZ,
				    T1.GRCCPZFRQ,
				    T1.NEXTGRCCPZDATE,
				    T1.REPAYBASERATE,
				    T1.REPAYSPECIALRATE,
				    T1.REPAYPROFITRATE,
				    T1.REPAYFRQ,
				    T1.NEXTREPAYDATE,
				    T1.REPAYPFTFRQ,
				    T1.NEXTREPAYPFTDATE,
				    T1.ALLOWREPAYRVW,
				    T1.REPAYRVWFRQ,
				    T1.NEXTREPAYRVWDATE,
				    T1.ALLOWREPAYCPZ,
				    T1.REPAYCPZFRQ,
				    T1.NEXTREPAYCPZDATE,
				    T1.MATURITYDATE,
				    T1.CPZATGRACEEND,
				    T1.DOWNPAYMENT,
				    T1.GRACEFLATAMOUNT,
				    T1.REQREPAYAMOUNT,
				    T1.TOTALPROFIT,
				    T1.TOTALCPZ,
				    T1.TOTALGROSSPFT,
				    T1.TOTALGROSSGRCPFT,
				    T1.TOTALGRACEPFT,
				    T1.TOTALGRACECPZ,
				    T1.GRCRATEBASIS,
				    T1.REPAYRATEBASIS,
				    T1.FINTYPE,
				    T1.FINREMARKS,
				    T1.FINCCY,
				    T1.SCHEDULEMETHOD,
				    T1.PROFITDAYSBASIS,
				    T1.REQMATURITY,
				    T1.CALTERMS,
				    T1.CALMATURITY,
				    T1.FIRSTREPAY,
				    T1.LASTREPAY,
				    T1.FINSTARTDATE,
				    T1.FINAMOUNT,
					((T1.FINAMOUNT + T1.FEECHARGEAMT) - T1.DOWNPAYMENT) LOVDESCFINANCINGAMOUNT,
				    T1.FINREPAYMENTAMOUNT,
				    T1.CUSTID,
				    T1.DEFFERMENTS,
				    T1.PLANDEFERCOUNT,
				    T1.FINBRANCH,
				    T1.FINSOURCEID,
				    T1.ALLOWEDDEFRPYCHANGE,
				    T1.AVAILEDDEFRPYCHANGE,
				    T1.ALLOWEDDEFFRQCHANGE,
				    T1.AVAILEDDEFFRQCHANGE,
				    T1.RECALTYPE,
				    T1.FINASSETVALUE,
				    T1.DISBACCOUNTID,
				    T1.REPAYACCOUNTID,
				    T1.FINISACTIVE,
				    T1.LIMITVALID,
				    T1.OVERRIDELIMIT,
				    T1.SECURITYDEPOSIT,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T7.FINTYPEDESC LOVDESCFINTYPENAME,
				    T7.FINMAXAMOUNT LOVDESCFINMAXAMT,
				    T7.FINMINAMOUNT LOVDESCFINMINAMOUNT,
				    T1.MINDOWNPAYPERC,
				    T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
				    T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ,
				    T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT,
				    T12.BRANCHDESC LOVDESCFINBRANCHNAME,
				    T12.BRANCHPROVINCE FINBRANCHPROVINCECODE,
				    T1.LASTREPAYDATE,
				    T1.LASTREPAYPFTDATE,
				    T1.LASTREPAYRVWDATE,
				    T1.LASTREPAYCPZDATE,
				    T1.ALLOWGRCREPAY,
				    T1.GRCSCHDMTHD,
				    T1.GRCMARGIN,
				    T1.REPAYMARGIN,
				    T1.FINCURRASSETVALUE,
				    T1.FINCOMMITMENTREF,
				    T1.FINLIMITREF,
				    T1.DEPRECIATIONFRQ,
				    T1.FINCONTRACTDATE,
				    T1.NEXTDEPDATE,
				    T1.LASTDEPDATE,
				    T1.FINACCOUNT,
				    T1.FINCUSTPFTACCOUNT,
				    T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD,
				    T7.FINRVWRATEAPPLFOR,
				    T1.TOTALREPAYAMT,
				    T1.CLOSINGSTATUS,
				    T1.FINAPPROVEDDATE,
				    T1.FEECHARGEAMT,
				    T1.BLACKLISTED,
				    T1.FINREPAYPFTONFRQ,
				    T1.ANUALIZEDPERCRATE,
				    T1.EFFECTIVERATEOFRETURN,
				    T1.MIGRATEDFINANCE,
				    T1.SCHEDULEMAINTAINED,
				    T1.SCHEDULEREGENERATED,
				    T1.FINPURPOSE,
				    T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME,
				    T1.FINSTATUS,
				    T1.FINSTSREASON,
				    T1.INITIATEUSER,
				    T1.BANKNAME,
				    T1.IBAN,
				    T1.ACCOUNTTYPE,
				    T1.DDAREFERENCENO,
				    T7.FINSCHEDULEON LOVDESCFINSCHEDULEON,
				    T1.CUSTDSR,
				    T1.JOINTACCOUNT,
				    T1.JOINTCUSTID,
				    T1.DOWNPAYBANK,
				    T1.DOWNPAYSUPL,
				    T1.DOWNPAYACCOUNT,
				    T1.SECURITYCOLLATERAL,
				    T1.APPROVED,
				    T1.DISCREPANCY,
				    T1.LIMITAPPROVED,
				    T1.GRACETERMS,
				    T7.FINDIVISION LOVDESCFINDIVISION,
				    T1.RCDMAINTAINSTS,
				    T1.FINREPAYMETHOD,
				    T1.GRCPROFITDAYSBASIS,
				    T1.STEPFINANCE,
				    T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T1.NEXTUSERID,
				    T1.PRIORITY,
				    T24.POLICYDESC LOVDESCSTEPPOLICYNAME,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.DEVIATIONAPPROVAL,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.CREDITINSAMT,
				    T1.ROLLOVERFRQ,
				    T1.NEXTROLLOVERDATE,
				    T27.CUSTSTSDESCRIPTION,
				    T1.SHARIASTATUS,
				    T1.INITIATEDATE,
				    T1.FINPREAPPROVEDREF,
				    T1.MMAID,
				    T1.ACCOUNTSOFFICER,
				    T1.FEEACCOUNTID,
				    T1.FINCANCELAC,
				    T28.DEALERNAME LOVDESCACCOUNTSOFFICER,
				    T28.DEALERCITY LOVDESCSOURCECITY,
				    T1.DSACODE,
				    T30.ROFFICERDESC DSACODEDESC,
				    T1.TDSAPPLICABLE,
				    T1.MANDATEID,
				    T1.DROPLINEFRQ,
				    T1.FIRSTDROPLINEDATE,
				    T1.PFTSERVICINGODLIMIT,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.APPLICATIONNO,
				    T1.REFERRALID,
				    T33.ROFFICERDESC REFERRALIDDESC,
				    T1.DMACODE,
				    T34.ROFFICERDESC DMACODEDESC,
				    T1.SALESDEPARTMENT,
				    T35.DEPTDESC SALESDEPARTMENTDESC,
				    T1.QUICKDISB,
				    T1.WIFREFERENCE,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.AVAILEDUNPLANEMI,
				    T1.AVAILEDREAGEH,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.PROMOTIONCODE,
				    T1.RESTRUCTURELOAN,
				    T1.OLDFINREFERENCE,
				    T1.REAGEBUCKET,
				    T1.FINCATEGORY,
				    T1.PRODUCTCATEGORY,
				    T1.ROUNDINGTARGET,
				    T36.ENTITYCODE LOVDESCENTITYCODE,
				    T1.ELIGIBILITYMETHOD,
				    T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD,
				    T38.VALUEDESC LOVDESCELIGIBILITYMETHOD,
				    T1.EMPLOYEENAME,
				    T37.ROFFICERDESC EMPLOYEENAMEDESC,
				    T1.SAMPLINGREQUIRED,
				    T1.LEGALREQUIRED,
				    T1.GRCMAXAMOUNT,
				    T1.CONNECTOR,
				    T40.DEALERNAME CONNECTORCODE,
				    T40.DEALERCITY CONNECTORDESC,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS,
				    T1.FIXEDRATETENOR,
				    T1.FIXEDTENORRATE,
				    T12.BRANCHTEL FINBRANCHCONTACT,
				    T1.PROCESSATTRIBUTES,
				    T1.BUSINESSVERTICAL,
				    BV.CODE BUSINESSVERTICALCODE,
				    BV.DESCRIPTION BUSINESSVERTICALDESC,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.TDSPERCENTAGE,
				    T1.TDSSTARTDATE,
				    T1.TDSENDDATE,
				    T1.TDSLIMITAMT,
				    T1.VANREQ,
				    T1.VANCODE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.SANBSDSCHDLE,
				    T1.PROMOTIONSEQID,
				    T1.SVAMOUNT,
				    T1.CBAMOUNT,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND,
					T1.REQLOANAMT,
					T1.REQLOANTENOR,
					T1.FINOCRREQUIRED,
					T1.OFFERPRODUCT,
					T1.OFFERAMOUNT,
					T1.CUSTSEGMENTATION,
					T1.BASEPRODUCT,
					T1.PROCESSTYPE,
					T1.BUREAUTIMESERIES,
					T1.CAMPAIGNNAME,
					T1.EXISTINGLANREFNO,
					T1.LEADSOURCE,
					T1.POSOURCE,
					T1.RSA,
					T1.VERIFICATION,
					T1.SOURCINGBRANCH,
					T1.SOURCHANNELCATEGORY,
					T1.ASMNAME,
					T13.BRANCHDESC LOVDESCSOURCINGBRANCH,
					T1.OFFERID,
					T1.ALWGRCADJ,
					T1.ENDGRCPERIODAFTRFULLDISB,
					T1.AUTOINCGRCENDDATE,
					T1.PMAY,
					T1.ALWLOANSPLIT,
					T1.PARENTREF,
					T1.LOANSPLITTED,
					T1.INSTBASEDSCHD,
					T1.PLANEMIHALWINGRACE,
					T1.ALLOWSUBVENTION,
					T1.TDSTYPE,
					T1.WRITEOFFLOAN,
					T1.RESTRUCTURE,
					T1.CALCOFSTEPS,
					T1.STEPSAPPLIEDFOR,
					T1.NOOFGRCSTEPS,
					T1.SCHDVERSION,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T41.DEALERNAME MANUFACTURERDEALERNAME,
					T41.CODE MANUFACTURERDEALERCODE
				FROM FINANCEMAIN T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE  = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				WHERE NOT EXISTS (SELECT 1 FROM FINANCEMAIN_TEMP WHERE FINANCEMAIN_TEMP.FINID = T1.FINID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="FMV_3_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_view');	
			]]>
		</sql>
	</changeSet>
	<changeSet id="FMV_4_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_4" author="Gopal.p">
		<createView viewName="FINANCEMAIN_TVIEW" replaceIfExists="true">
		    <![CDATA[
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.INVESTMENTREF,
					T1.NUMBEROFTERMS,
					T1.GRCPERIODENDDATE,
					T1.ALLOWGRCPERIOD,
					T1.GRACEBASERATE,
					T1.GRACESPECIALRATE,
					T1.GRCPFTRATE,
					T1.GRCPFTFRQ,
					T1.NEXTGRCPFTDATE,
					T1.ALLOWGRCPFTRVW,
					T1.GRCPFTRVWFRQ,
					T1.NEXTGRCPFTRVWDATE,
					T1.ALLOWGRCCPZ,
					T1.GRCCPZFRQ,
					T1.NEXTGRCCPZDATE,
					T1.REPAYBASERATE,
					T1.REPAYSPECIALRATE,
					T1.REPAYPROFITRATE,
					T1.REPAYFRQ,
					T1.NEXTREPAYDATE,
					T1.REPAYPFTFRQ,
					T1.NEXTREPAYPFTDATE,
					T1.ALLOWREPAYRVW,
					T1.REPAYRVWFRQ,
					T1.NEXTREPAYRVWDATE,
					T1.ALLOWREPAYCPZ,
					T1.REPAYCPZFRQ,
					T1.NEXTREPAYCPZDATE,
					T1.MATURITYDATE,
					T1.CPZATGRACEEND,
					T1.DOWNPAYMENT,
					T1.GRACEFLATAMOUNT,
					T1.REQREPAYAMOUNT,
					T1.TOTALPROFIT,
					T1.TOTALCPZ,
					T1.TOTALGROSSPFT,
					T1.TOTALGROSSGRCPFT,
					T1.TOTALGRACEPFT,
					T1.TOTALGRACECPZ,
					T1.GRCRATEBASIS,
					T1.REPAYRATEBASIS,
					T1.FINTYPE,
					T1.FINREMARKS,
					T1.FINCCY,
					T1.SCHEDULEMETHOD,
					T1.PROFITDAYSBASIS,
					T1.REQMATURITY,
					T1.CALTERMS,
					T1.CALMATURITY,
					T1.FIRSTREPAY,
					T1.LASTREPAY,
					T1.FINSTARTDATE,
					T1.FINAMOUNT,
					T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT LOVDESCFINANCINGAMOUNT,
					T1.FINREPAYMENTAMOUNT,
					T1.CUSTID,
					T1.DEFFERMENTS,
					T1.PLANDEFERCOUNT,
					T1.FINBRANCH,
					T1.FINSOURCEID,
					T1.ALLOWEDDEFRPYCHANGE,
					T1.AVAILEDDEFRPYCHANGE,
					T1.ALLOWEDDEFFRQCHANGE,
					T1.AVAILEDDEFFRQCHANGE,
					T1.RECALTYPE,
					T1.FINASSETVALUE,
					T1.DISBACCOUNTID,
					T1.REPAYACCOUNTID,
					T1.FINISACTIVE,
					T1.LIMITVALID,
					T1.OVERRIDELIMIT,
					T1.SECURITYDEPOSIT,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T7.FINTYPEDESC LOVDESCFINTYPENAME,
					T7.FINMAXAMOUNT LOVDESCFINMAXAMT,
					T7.FINMINAMOUNT LOVDESCFINMINAMOUNT,
					T1.MINDOWNPAYPERC,
					T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
					T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ,
					T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT,
					T12.BRANCHDESC LOVDESCFINBRANCHNAME,
					T12.BRANCHPROVINCE FINBRANCHPROVINCECODE,
					T1.LASTREPAYDATE,
					T1.LASTREPAYPFTDATE,
					T1.LASTREPAYRVWDATE,
					T1.LASTREPAYCPZDATE,
					T1.ALLOWGRCREPAY,
					T1.GRCSCHDMTHD,
					T1.GRCMARGIN,
					T1.REPAYMARGIN,
					T1.FINCURRASSETVALUE,
					T1.FINCOMMITMENTREF,
					T1.FINLIMITREF,
					T1.DEPRECIATIONFRQ,
					T1.FINCONTRACTDATE,
					T1.NEXTDEPDATE,
					T1.LASTDEPDATE,
					T1.FINACCOUNT,
					T1.FINCUSTPFTACCOUNT,
					T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD,
					T7.FINRVWRATEAPPLFOR,
					T1.TOTALREPAYAMT,
					T1.CLOSINGSTATUS,
					T1.FINAPPROVEDDATE,
					T1.FEECHARGEAMT,
					T1.BLACKLISTED,
					T1.FINREPAYPFTONFRQ,
					T1.ANUALIZEDPERCRATE,
					T1.EFFECTIVERATEOFRETURN,
					T1.MIGRATEDFINANCE,
					T1.SCHEDULEMAINTAINED,
					T1.SCHEDULEREGENERATED,
					T1.FINPURPOSE,
					T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME,
					T1.FINSTATUS,
					T1.FINSTSREASON,
					T1.INITIATEUSER,
					T1.BANKNAME,
					T1.IBAN,
					T1.ACCOUNTTYPE,
					T1.DDAREFERENCENO,
					T7.FINSCHEDULEON LOVDESCFINSCHEDULEON,
					T1.CUSTDSR,
					T1.JOINTACCOUNT,
					T1.JOINTCUSTID,
					T1.DOWNPAYBANK,
					T1.DOWNPAYSUPL,
					T1.DOWNPAYACCOUNT,
					T1.SECURITYCOLLATERAL,
					T1.APPROVED,
					T1.DISCREPANCY,
					T1.LIMITAPPROVED,
					T1.GRACETERMS,
					T7.FINDIVISION LOVDESCFINDIVISION,
					T1.RCDMAINTAINSTS,
					T1.FINREPAYMETHOD,
					T1.GRCPROFITDAYSBASIS,
					T1.STEPFINANCE,
					T1.STEPTYPE,
					T1.STEPPOLICY,
					T1.ALWMANUALSTEPS,
					T1.NOOFSTEPS,
					T1.LINKEDFINREF,
					T1.NEXTUSERID,
					T1.PRIORITY,
					T24.POLICYDESC LOVDESCSTEPPOLICYNAME,
					T1.GRCMINRATE,
					T1.GRCMAXRATE,
					T1.RPYMINRATE,
					T1.RPYMAXRATE,
					T1.DEVIATIONAPPROVAL,
					T1.MANUALSCHEDULE,
					T1.TAKEOVERFINANCE,
					T1.GRCADVBASERATE,
					T1.GRCADVMARGIN,
					T1.GRCADVPFTRATE,
					T1.RPYADVBASERATE,
					T1.RPYADVMARGIN,
					T1.RPYADVPFTRATE,
					T1.SUPPLEMENTRENT,
					T1.INCREASEDCOST,
					T1.CREDITINSAMT,
					T1.ROLLOVERFRQ,
					T1.NEXTROLLOVERDATE,
					T27.CUSTSTSDESCRIPTION,
					T1.SHARIASTATUS,
					T1.INITIATEDATE,
					T1.FINPREAPPROVEDREF,
					T1.MMAID,
					T1.ACCOUNTSOFFICER,
					T1.FEEACCOUNTID,
					T1.FINCANCELAC,
					T28.DEALERNAME LOVDESCACCOUNTSOFFICER,
					T28.DEALERCITY LOVDESCSOURCECITY,
					T1.DSACODE,
					T30.ROFFICERDESC DSACODEDESC,
					T1.TDSAPPLICABLE,
					T1.MANDATEID,
					T1.DROPLINEFRQ,
					T1.FIRSTDROPLINEDATE,
					T1.PFTSERVICINGODLIMIT,
					T1.INSURANCEAMT,
					T1.DEDUCTINSDISB,
					T1.ALWBPI,
					T1.BPITREATMENT,
					T1.PLANEMIHALW,
					T1.PLANEMIHMETHOD,
					T1.PLANEMIHMAXPERYEAR,
					T1.PLANEMIHMAX,
					T1.PLANEMIHLOCKPERIOD,
					T1.PLANEMICPZ,
					T1.CALROUNDINGMODE,
					T1.ALWMULTIDISB,
					T1.APPLICATIONNO,
					T1.REFERRALID,
					T33.ROFFICERDESC REFERRALIDDESC,
					T1.DMACODE,
					T34.ROFFICERDESC DMACODEDESC,
					T1.SALESDEPARTMENT,
					T35.DEPTDESC SALESDEPARTMENTDESC,
					T1.QUICKDISB,
					T1.WIFREFERENCE,
					T1.UNPLANEMIHLOCKPERIOD,
					T1.UNPLANEMICPZ,
					T1.REAGECPZ,
					T1.MAXUNPLANNEDEMI,
					T1.MAXREAGEHOLIDAYS,
					T1.AVAILEDUNPLANEMI,
					T1.AVAILEDREAGEH,
					T1.BPIAMOUNT,
					T1.DEDUCTFEEDISB,
					T1.RVWRATEAPPLFOR,
					T1.SCHCALONRVW,
					T1.PASTDUEPFTCALMTHD,
					T1.PASTDUEPFTMARGIN,
					T1.DROPPINGMETHOD,
					T1.RATECHGANYDAY,
					T1.PROMOTIONCODE,
					T1.RESTRUCTURELOAN,
					T1.OLDFINREFERENCE,
					T1.REAGEBUCKET,
					T1.FINCATEGORY,
					T1.PRODUCTCATEGORY,
					T1.ROUNDINGTARGET,
					T36.ENTITYCODE LOVDESCENTITYCODE,
					T1.ELIGIBILITYMETHOD,
					T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD,
					T38.VALUEDESC LOVDESCELIGIBILITYMETHOD,
					T1.EMPLOYEENAME,
					T37.ROFFICERDESC EMPLOYEENAMEDESC,
					T1.SAMPLINGREQUIRED,
					T1.LEGALREQUIRED,
					T1.GRCMAXAMOUNT,
					T1.CONNECTOR,
					T40.DEALERNAME CONNECTORCODE,
					T40.DEALERCITY CONNECTORDESC,
					T1.ADVANCEEMI,
					T1.ADVEMITERMS,
					T1.BPIPFTDAYSBASIS,
					T1.FIXEDRATETENOR,
					T1.FIXEDTENORRATE,
					T12.BRANCHTEL FINBRANCHCONTACT,
					T1.PROCESSATTRIBUTES,
					T1.BUSINESSVERTICAL,
					BV.CODE BUSINESSVERTICALCODE,
					BV.DESCRIPTION BUSINESSVERTICALDESC,
					T1.GRCADVTYPE,
					T1.GRCADVTERMS,
					T1.ADVTYPE,
					T1.ADVTERMS,
					T1.ADVSTAGE,
					T1.TDSPERCENTAGE,
					T1.TDSSTARTDATE,
					T1.TDSENDDATE,
					T1.TDSLIMITAMT,
					T1.VANREQ,
					T1.VANCODE,
					T1.ALLOWDRAWINGPOWER,
					T1.ALLOWREVOLVING,
					T1.SANBSDSCHDLE,
					T1.PROMOTIONSEQID,
					T1.SVAMOUNT,
					T1.CBAMOUNT,
					T1.APPLIEDLOANAMT,
					T1.FINISRATERVWATGRCEND,
					T1.REQLOANAMT,
					T1.REQLOANTENOR,
					T1.FINOCRREQUIRED,
					T1.OFFERPRODUCT,
					T1.OFFERAMOUNT,
					T1.CUSTSEGMENTATION,
					T1.BASEPRODUCT,
					T1.PROCESSTYPE,
					T1.BUREAUTIMESERIES,
					T1.CAMPAIGNNAME,
					T1.EXISTINGLANREFNO,
					T1.LEADSOURCE,
					T1.POSOURCE,
					T1.RSA,
					T1.VERIFICATION,
					T1.SOURCINGBRANCH,
					T1.SOURCHANNELCATEGORY,
					T1.ASMNAME,
					T13.BRANCHDESC LOVDESCSOURCINGBRANCH,
					T1.OFFERID,
					T1.ENDGRCPERIODAFTRFULLDISB,
					T1.AUTOINCGRCENDDATE,
					T1.ALWGRCADJ,
					T1.PMAY,
					T1.ALWLOANSPLIT,
					T1.PARENTREF,
					T1.LOANSPLITTED,
					T1.INSTBASEDSCHD,
					T1.PLANEMIHALWINGRACE,
					T1.ALLOWSUBVENTION,
					T1.TDSTYPE,
					T1.WRITEOFFLOAN,
					T1.RESTRUCTURE,
					T1.CALCOFSTEPS,
					T1.STEPSAPPLIEDFOR,
					T1.NOOFGRCSTEPS,
					T1.SCHDVERSION,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T41.DEALERNAME MANUFACTURERDEALERNAME,
					T41.CODE MANUFACTURERDEALERCODE
				FROM FINANCEMAIN_TEMP T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE  = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
			]]>
		</createView>
	</changeSet>

	<changeSet id="FMV_4_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_5_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'financemain_dview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_5" author="Gopal.p">
		<createView viewName="FINANCEMAIN_DVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.INVESTMENTREF,
					T1.FINTYPE,
					T1.FINCCY,
					T1.FINAMOUNT,
					T1.DOWNPAYMENT,
					T1.FEECHARGEAMT,
					T1.SCHEDULEMETHOD,
					T1.RECORDSTATUS,
					T1.RECORDTYPE,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.FINBRANCH,
					T1.FINASSETVALUE,
					T2.CUSTCIF LOVDESCCUSTCIF,
					T2.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
					T2.CUSTID,
					T2.CUSTCIF,
					T3.FINCATEGORY LOVDESCPRODUCTCODENAME,
					T3.FINDIVISION LOVDESCFINDIVISION,
					T1.SAMPLINGREQUIRED,
					T1.LEGALREQUIRED,
					T1.INSTBASEDSCHD,
					T1.ALLOWSUBVENTION,
					T1.TDSTYPE,
					T1.WRITEOFFLOAN,
					T1.RESTRUCTURE,
					T1.CALCOFSTEPS,
					T1.STEPSAPPLIEDFOR,
					T1.NOOFGRCSTEPS,
					T1.SCHDVERSION,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T5.DEALERNAME MANUFACTURERDEALERNAME,
					T5.CODE MANUFACTURERDEALERCODE
				FROM FINANCEMAIN_TEMP T1
				JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
				JOIN RMTFINANCETYPES T3 ON T3.FINTYPE = T1.FINTYPE
				JOIN INVESTMENTFINHEADER T4 ON T4.INVESTMENTREF = T1.INVESTMENTREF
				LEFT JOIN AMTVEHICLEDEALER T5 ON T1.MANUFACTURERDEALERID = T5.DEALERID
			]]>
		</createView>
	</changeSet>

	<changeSet id="FMV_5_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_dview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_6_Pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_dataview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_6" author="Gopal.p">
		<createView viewName="FINANCEMAIN_DATAVIEW" replaceIfExists="true"> 
			<![CDATA[
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.FINTYPE,
					T2.CUSTCIF LOVDESCCUSTCIF,
					T1.CUSTID,
					T1.CLOSINGSTATUS,
					T1.FINISACTIVE,
					T1.MATURITYDATE,
					T1.PRODUCTCATEGORY,
					T1.WRITEOFFLOAN,
					T1.CALCOFSTEPS,
					T1.STEPSAPPLIEDFOR,
					T1.NOOFGRCSTEPS,
					T1.SCHDVERSION,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T3.DEALERNAME MANUFACTURERDEALERNAME,
					T3.CODE MANUFACTURERDEALERCODE
				FROM FINANCEMAIN T1
				JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
				LEFT JOIN AMTVEHICLEDEALER T3 ON T1.MANUFACTURERDEALERID = T3.DEALERID
			]]>
		</createView>
	</changeSet>

	<changeSet id="FMV_6_Post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_dataview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_7_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_lfview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FMV_7" author="Gopal.p">
		<createView viewName="FINANCEMAIN_LFVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT F.FINID,
					F.FINREFERENCE, 
					F.CUSTID, 
					C.CUSTCIF LOVDESCCUSTCIF, 
					C.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
					F.FINTYPE, 
					F.FINISACTIVE, 
					SD.ENTITYCODE,
					F.RCDMAINTAINSTS,
					F.RECORDSTATUS,
					F.QUICKDISB
				FROM FINANCEMAIN_TEMP F 
				INNER JOIN CUSTOMERS C ON F.CUSTID = C.CUSTID AND F.QUICKDISB = 1 AND F.RECORDSTATUS = 'Submitted'
				INNER JOIN RMTFINANCETYPES FT ON FT.FINTYPE = F.FINTYPE
				INNER JOIN SMTDivisiondetail SD On FT.FINDIVISION = SD.DivisionCode
				UNION ALL
				SELECT F.FINID,
					F.FINREFERENCE, 
					F.CUSTID, 
					C.CUSTCIF LOVDESCCUSTCIF, 
					C.CUSTSHRTNAME LOVDESCCUSTSHRTNAME, 
					F.FINTYPE, 
					F.FINISACTIVE, 
					SD.ENTITYCODE, 
					F.RCDMAINTAINSTS,
					F.RECORDSTATUS,
					F.QUICKDISB
				FROM FINANCEMAIN F INNER JOIN CUSTOMERS C ON F.CUSTID = C.CUSTID
				INNER JOIN RMTFINANCETYPES FT ON FT.FINTYPE = F.FINTYPE
				INNER JOIN SMTDIVISIONDETAIL SD ON FT.FINDIVISION = SD.DIVISIONCODE
				WHERE NOT EXISTS (SELECT 1 EXPR1 FROM FINANCEMAIN_TEMP WHERE FINID = F.FINID)
			]]>	
		</createView>
	</changeSet>

	<changeSet id="FMV_7_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_lfview');
			]]>
		</sql>
	</changeSet>

	<!-- (FMV) :: Finance Main Views handle in single place end -->

	<!-- (FEV) :: Finance Enquiry views handle in single place start -->

	<changeSet id="FEV_1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financeenquiry_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FEV_1" author="Gopal.p">
		<createView viewName="FINANCEENQUIRY_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.FINBRANCH,
					T1.FINTYPE,
					T1.FINCCY,
					T1.SCHEDULEMETHOD,
					T1.PROFITDAYSBASIS,
					T1.FINSTARTDATE,
					T1.CALTERMS NUMBEROFTERMS,
					T1.CUSTID,
					T1.FINAMOUNT,
					T1.GRCPERIODENDDATE,
					T1.MATURITYDATE,
					T1.FINREPAYMENTAMOUNT,
					T1.FINISACTIVE,
					T1.ALLOWGRCPERIOD,
					T1.DOWNPAYMENT,
					T1.MIGRATEDFINANCE,
					T1.LASTREPAYDATE,
					T1.LASTREPAYPFTDATE,
					T1.FINCURRASSETVALUE,
					T1.BLACKLISTED,
					T1.FEECHARGEAMT,
					T1.CLOSINGSTATUS,
					T1.GRACETERMS,
					T1.ALWMULTIDISB,
					T1.DEFFERMENTS,
					T1.FINSTATUS,
					T1.MANDATEID,
					T1.FINREPAYMETHOD,
					T1.FINASSETVALUE,
					T1.FINCURRASSETVALUE + T1.FEECHARGEAMT + T1.INSURANCEAMT FINANCINGAMOUNT,
					T1.FINCURRASSETVALUE - T1.FINREPAYMENTAMOUNT + T1.FEECHARGEAMT + T1.INSURANCEAMT CURFINAMOUNT,
					T2.FINTYPEDESC LOVDESCFINTYPENAME,
					T2.FINSCHEDULEON LOVDESCFINSCHEDULEON,
					T2.FINDIVISION LOVDESCFINDIVISION,
					T2.FINCATEGORY LOVDESCPRODUCTCODENAME,
					T2.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
					T3.CUSTCIF LOVDESCCUSTCIF,
					T3.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
					T4.BRANCHDESC LOVDESCFINBRANCHNAME,
					T5.CUSTTYPECTG,
					COALESCE(T9.NOINST, 0)  NOINST,
					T1.FINOCRREQUIRED,
					T1.TOTALCPZ,
					T1.ALWGRCADJ,
					T1.ENDGRCPERIODAFTRFULLDISB,
					T1.AUTOINCGRCENDDATE,
					T1.RECORDSTATUS,
					T1.WRITEOFFLOAN,
					T1.RESTRUCTURE,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T10.DEALERNAME MANUFACTURERDEALERNAME,
					T10.CODE MANUFACTURERDEALERCODE
				FROM FINANCEMAIN_TEMP T1
				JOIN RMTFINANCETYPES T2 ON T1.FINTYPE = T2.FINTYPE
				JOIN CUSTOMERS T3 ON T1.CUSTID = T3.CUSTID
				JOIN RMTBRANCHES T4 ON T1.FINBRANCH = T4.BRANCHCODE
				JOIN RMTCUSTTYPES T5 ON T3.CUSTTYPECODE = T5.CUSTTYPECODE
				LEFT JOIN FINPFTDETAILS T9 ON T9.FINID = T1.FINID
				LEFT JOIN AMTVEHICLEDEALER T10 ON T1.MANUFACTURERDEALERID = T10.DEALERID
			]]>
		</createView>
	</changeSet>

	<changeSet id="FEV_1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financeenquiry_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FEV_2_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financeenquiry_view');
		 	]]>
		</sql>
	</changeSet>

	<changeSet id="FEV_2" author="Gopal.p">
		<createView viewName="FINANCEENQUIRY_VIEW" replaceIfExists="true">
		  <![CDATA[
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.FINBRANCH,
					T1.FINTYPE,
					T1.FINCCY,
					T1.SCHEDULEMETHOD,
					T1.PROFITDAYSBASIS,
					T1.FINSTARTDATE,
					T1.CALTERMS NUMBEROFTERMS,
					T1.CUSTID,
					T1.FINAMOUNT,
					T1.GRCPERIODENDDATE,
					T1.MATURITYDATE,
					T1.FINREPAYMENTAMOUNT,
					T1.FINISACTIVE,
					T1.ALLOWGRCPERIOD,
					T1.DOWNPAYMENT,
					T1.MIGRATEDFINANCE,
					T1.LASTREPAYDATE,
					T1.LASTREPAYPFTDATE,
					T1.FINCURRASSETVALUE,
					T1.BLACKLISTED,
					T1.FEECHARGEAMT,
					T1.CLOSINGSTATUS,
					T1.GRACETERMS,
					T1.ALWMULTIDISB,
					T1.DEFFERMENTS,
					T1.FINSTATUS ,
					T1.MANDATEID,
					T1.FINREPAYMETHOD,
					T1.FINASSETVALUE,
					T1.INSURANCEAMT,
					T1.SANBSDSCHDLE,
					T1.PROMOTIONSEQID,
					T1.SVAMOUNT,
					T1.CBAMOUNT,
					(T1.FINCURRASSETVALUE+ T1.FEECHARGEAMT+T1.INSURANCEAMT) FINANCINGAMOUNT,
					(T1.FINCURRASSETVALUE- T1.FINREPAYMENTAMOUNT+ T1.FEECHARGEAMT+T1.INSURANCEAMT) CURFINAMOUNT,
					T2.FINTYPEDESC LOVDESCFINTYPENAME,
					T2.FINSCHEDULEON LOVDESCFINSCHEDULEON,
					T2.FINDIVISION LOVDESCFINDIVISION,
					T2.FINCATEGORY LOVDESCPRODUCTCODENAME,
					T2.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
					T3.CUSTCIF LOVDESCCUSTCIF,
					T3.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
					T4.BRANCHDESC LOVDESCFINBRANCHNAME,
					T5.CUSTTYPECTG,
					COALESCE(T9.NOINST,0) NOINST,
					T1.TOTALCPZ,
					T1.FINOCRREQUIRED,
					T1.ALWGRCADJ,
					T1.ENDGRCPERIODAFTRFULLDISB,
					T1.AUTOINCGRCENDDATE,
					T1.RECORDSTATUS,
					T1.WRITEOFFLOAN,
					T1.RESTRUCTURE,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T10.DEALERNAME MANUFACTURERDEALERNAME,
					T10.CODE MANUFACTURERDEALERCODE
				FROM FINANCEMAIN T1
				INNER JOIN RMTFINANCETYPES T2 ON T1.FINTYPE = T2.FINTYPE
				INNER JOIN CUSTOMERS T3 ON T1.CUSTID = T3.CUSTID
				INNER JOIN RMTBRANCHES T4 ON T1.FINBRANCH = T4.BRANCHCODE
				INNER JOIN RMTCUSTTYPES T5 ON T3.CUSTTYPECODE = T5.CUSTTYPECODE
				LEFT JOIN FINPFTDETAILS T9 ON T9.FINID = T1.FINID
				LEFT JOIN AMTVEHICLEDEALER T10 ON T1.MANUFACTURERDEALERID = T10.DEALERID
			]]>
		</createView>
	</changeSet>

	<changeSet id="FEV_2_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financeenquiry_view');
			]]>
		</sql>
	</changeSet>

	<!-- (FEV) :: Finance Enquiry views handle in single place end -->

	<!-- (SDV) :: Finance Schedule detail Views handle in single place start -->

	<changeSet id="SDV_1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finscheduledetails_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SDV_1" author="Gopal.p">
		<createView viewName="FINSCHEDULEDETAILS_TVIEW" replaceIfExists="true">
		    <![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.SCHSEQ,
					T1.SCHDATE,
					T1.PFTONSCHDATE,
					T1.REPAYONSCHDATE,
					T1.CPZONSCHDATE,
					T1.RVWONSCHDATE,
					T1.DISBONSCHDATE,
					T1.DOWNPAYMENTONSCHDATE,
					T1.BALANCEFORPFTCAL,
					T1.BASERATE,
					T1.SPLRATE,
					T1.ACTRATE,
					T1.NOOFDAYS,
					T1.DAYFACTOR,
					T1.PROFITCALC,
					T1.PROFITSCHD,
					T1.PRINCIPALSCHD,
					T1.REPAYAMOUNT,
					T1.PROFITBALANCE,
					T1.DISBAMOUNT,
					T1.CPZAMOUNT,
					T1.DOWNPAYMENTAMOUNT,
					T1.CLOSINGBALANCE,
					T1.PROFITFRACTION,
					T1.PRVREPAYAMOUNT,
					T1.SCHDPFTPAID,
					T1.SCHPFTPAID,
					T1.SCHDPRIPAID,
					T1.SCHPRIPAID,
					T1.SPECIFIER,
					T1.DEFSCHDDATE,
					T1.SCHDMETHOD,
					T1.MRGRATE,
					T1.CALONINDRATE,
					T1.FEECHARGEAMT,
					T1.CALCULATEDRATE,
					T1.EARLYPAIDBAL,
					T1.EARLYPAID,
					T1.REFUNDORWAIVER,
					T1.WRITEOFFPRINCIPAL,
					T1.WRITEOFFPROFIT,
					T1.ORGPFT,
					T1.ORGPRI,
					T1.ORGENDBAL,
					T1.ORGPLANPFT,
					T1.FEESCHD,
					T1.SCHDFEEPAID,
					T1.SCHDFEEOS,
					T1.INSSCHD,
					T1.SCHDINSPAID,
					T1.ADVPFTRATE,
					T1.ADVPROFIT,
					T1.ADVREPAYAMOUNT,
					T1.ADVBASERATE,
					T1.ADVMARGIN,
					T1.ADVCALRATE,
					T1.SUPLRENT,
					T1.INCRCOST,
					T1.SUPLRENTPAID,
					T1.INCRCOSTPAID,
					T1.ROLLOVERONSCHDATE,
					T1.ROLLOVERAMOUNT,
					T1.ROLLOVERAMOUNTPAID,
					T1.TDSAMOUNT,
					T1.TDSPAID,
					T1.PFTDAYSBASIS,
					T1.WRITEOFFINS,
					T1.WRITEOFFINCRCOST,
					T1.WRITEOFFSUPLRENT,
					T1.WRITEOFFSCHFEE,
					T1.INSURANCEAMT,
					T1.INSTNUMBER,
					T1.BPIORHOLIDAY,
					T1.FRQDATE,
					T1.PRESENTMENTID,
					T1.PARTIALPAIDAMT,
					T1.FEETAX,
					T1.RECALLOCK,
					T1.TDSAPPLICABLE,
					T1.SCHDPFTWAIVER,
					T1.CPZBALANCE
				FROM FINSCHEDULEDETAILS_TEMP T1
				INNER JOIN FINANCEMAIN_TEMP T2 ON T2.FINID = T1.FINID
			]]>
		</createView>
	</changeSet>

	<changeSet id="SDV_1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finscheduledetails_tview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="SDV_2_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finscheduledetails_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SDV_2" author="Gopal.p">
		<createView viewName="FINSCHEDULEDETAILS_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.SCHSEQ,
					T1.SCHDATE,
					T1.PFTONSCHDATE,
					T1.REPAYONSCHDATE,
					T1.CPZONSCHDATE,
					T1.RVWONSCHDATE,
					T1.DISBONSCHDATE,
					T1.DOWNPAYMENTONSCHDATE,
					T1.BALANCEFORPFTCAL,
					T1.BASERATE,
					T1.SPLRATE,
					T1.ACTRATE,
					T1.NOOFDAYS,
					T1.DAYFACTOR,
					T1.PROFITCALC,
					T1.PROFITSCHD,
					T1.PRINCIPALSCHD,
					T1.REPAYAMOUNT,
					T1.PROFITBALANCE,
					T1.DISBAMOUNT,
					T1.CPZAMOUNT,
					T1.DOWNPAYMENTAMOUNT,
					T1.CLOSINGBALANCE,
					T1.PROFITFRACTION,
					T1.PRVREPAYAMOUNT,
					T1.SCHDPFTPAID,
					T1.SCHPFTPAID,
					T1.SCHDPRIPAID,
					T1.SCHPRIPAID,
					T1.SPECIFIER,
					T1.DEFSCHDDATE,
					T1.SCHDMETHOD,
					T1.MRGRATE,
					T1.CALONINDRATE,
					T1.FEECHARGEAMT,
					T1.CALCULATEDRATE,
					T1.EARLYPAIDBAL,
					T1.EARLYPAID,
					T1.REFUNDORWAIVER,
					T1.WRITEOFFPRINCIPAL,
					T1.WRITEOFFPROFIT,
					T1.ORGPFT,
					T1.ORGPRI,
					T1.ORGENDBAL,
					T1.ORGPLANPFT,
					T1.FEESCHD,
					T1.SCHDFEEPAID,
					T1.SCHDFEEOS,
					T1.INSSCHD,
					T1.SCHDINSPAID,
					T1.ADVPFTRATE,
					T1.ADVPROFIT,
					T1.ADVREPAYAMOUNT,
					T1.ADVBASERATE,
					T1.ADVMARGIN,
					T1.ADVCALRATE,
					T1.SUPLRENT,
					T1.INCRCOST,
					T1.SUPLRENTPAID,
					T1.INCRCOSTPAID,
					T1.ROLLOVERONSCHDATE,
					T1.ROLLOVERAMOUNT,
					T1.ROLLOVERAMOUNTPAID,
					T1.TDSAMOUNT,
					T1.TDSPAID,
					T1.PFTDAYSBASIS,
					T1.WRITEOFFINS,
					T1.WRITEOFFINCRCOST,
					T1.WRITEOFFSUPLRENT,
					T1.WRITEOFFSCHFEE,
					T1.INSURANCEAMT,
					T1.INSTNUMBER,
					T1.BPIORHOLIDAY,
					T1.FRQDATE,
					T1.PRESENTMENTID,
					T1.PARTIALPAIDAMT,
					T1.FEETAX,
					T1.RECALLOCK,
					T1.TDSAPPLICABLE,
					T1.SCHDPFTWAIVER,
					T1.CPZBALANCE
				FROM FINSCHEDULEDETAILS_TEMP T1
				INNER JOIN FINANCEMAIN_TEMP T2 ON T2.FINID = T1.FINID
				UNION ALL
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.SCHSEQ,
					T1.SCHDATE,
					T1.PFTONSCHDATE,
					T1.REPAYONSCHDATE,
					T1.CPZONSCHDATE,
					T1.RVWONSCHDATE,
					T1.DISBONSCHDATE,
					T1.DOWNPAYMENTONSCHDATE,
					T1.BALANCEFORPFTCAL,
					T1.BASERATE,
					T1.SPLRATE,
					T1.ACTRATE,
					T1.NOOFDAYS,
					T1.DAYFACTOR,
					T1.PROFITCALC,
					T1.PROFITSCHD,
					T1.PRINCIPALSCHD,
					T1.REPAYAMOUNT,
					T1.PROFITBALANCE,
					T1.DISBAMOUNT,
					T1.CPZAMOUNT,
					T1.DOWNPAYMENTAMOUNT,
					T1.CLOSINGBALANCE,
					T1.PROFITFRACTION,
					T1.PRVREPAYAMOUNT,
					T1.SCHDPFTPAID,
					T1.SCHPFTPAID,
					T1.SCHDPRIPAID,
					T1.SCHPRIPAID,
					T1.SPECIFIER,
					T1.DEFSCHDDATE,
					T1.SCHDMETHOD,
					T1.MRGRATE,
					T1.CALONINDRATE,
					T1.FEECHARGEAMT,
					T1.CALCULATEDRATE,
					T1.EARLYPAIDBAL,
					T1.EARLYPAID,
					T1.REFUNDORWAIVER,
					T1.WRITEOFFPRINCIPAL,
					T1.WRITEOFFPROFIT,
					T1.ORGPFT,
					T1.ORGPRI,
					T1.ORGENDBAL,
					T1.ORGPLANPFT,
					T1.FEESCHD,
					T1.SCHDFEEPAID,
					T1.SCHDFEEOS,
					T1.INSSCHD,
					T1.SCHDINSPAID,
					T1.ADVPFTRATE,
					T1.ADVPROFIT,
					T1.ADVREPAYAMOUNT,
					T1.ADVBASERATE,
					T1.ADVMARGIN,
					T1.ADVCALRATE,
					T1.SUPLRENT,
					T1.INCRCOST,
					T1.SUPLRENTPAID,
					T1.INCRCOSTPAID,
					T1.ROLLOVERONSCHDATE,
					T1.ROLLOVERAMOUNT,
					T1.ROLLOVERAMOUNTPAID,
					T1.TDSAMOUNT,
					T1.TDSPAID,
					T1.PFTDAYSBASIS,
					T1.WRITEOFFINS,
					T1.WRITEOFFINCRCOST,
					T1.WRITEOFFSUPLRENT,
					T1.WRITEOFFSCHFEE,
					T1.INSURANCEAMT,
					T1.INSTNUMBER,
					T1.BPIORHOLIDAY,
					T1.FRQDATE,
					T1.PRESENTMENTID,
					T1.PARTIALPAIDAMT,
					T1.FEETAX,
					T1.RECALLOCK,
					T1.TDSAPPLICABLE,
					T1.SCHDPFTWAIVER,
					T1.CPZBALANCE
				FROM FINSCHEDULEDETAILS T1
				INNER JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID
				WHERE NOT EXISTS (SELECT 1 FROM FINSCHEDULEDETAILS_TEMP
					WHERE FINSCHEDULEDETAILS_TEMP.FINID = T1.FINID)
			]]>
		</createView>
	</changeSet>


	<changeSet id="SDV_2_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finscheduledetails_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="SDV_3_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finscheduledetails_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SDV_3" author="Gopal.p">
		<createView viewName="FINSCHEDULEDETAILS_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.SCHSEQ,
					T1.SCHDATE,
					T1.PFTONSCHDATE,
					T1.REPAYONSCHDATE,
					T1.CPZONSCHDATE,
					T1.RVWONSCHDATE,
					T1.DISBONSCHDATE,
					T1.DOWNPAYMENTONSCHDATE,
					T1.BALANCEFORPFTCAL,
					T1.BASERATE,
					T1.SPLRATE,
					T1.ACTRATE,
					T1.NOOFDAYS,
					T1.DAYFACTOR,
					T1.PROFITCALC,
					T1.PROFITSCHD,
					T1.PRINCIPALSCHD,
					T1.REPAYAMOUNT,
					T1.PROFITBALANCE,
					T1.DISBAMOUNT,
					T1.CPZAMOUNT,
					T1.DOWNPAYMENTAMOUNT,
					T1.CLOSINGBALANCE,
					T1.PROFITFRACTION,
					T1.PRVREPAYAMOUNT,
					T1.SCHDPFTPAID,
					T1.SCHPFTPAID,
					T1.SCHDPRIPAID,
					T1.SCHPRIPAID,
					T1.SPECIFIER,
					T1.DEFSCHDDATE,
					T1.SCHDMETHOD,
					T1.MRGRATE,
					T1.CALONINDRATE,
					T1.FEECHARGEAMT,
					T1.CALCULATEDRATE,
					T1.EARLYPAIDBAL,
					T1.EARLYPAID,
					T1.REFUNDORWAIVER,
					T1.WRITEOFFPRINCIPAL,
					T1.WRITEOFFPROFIT,
					T1.ORGPFT,
					T1.ORGPRI,
					T1.ORGENDBAL,
					T1.ORGPLANPFT,
					T1.FEESCHD,
					T1.SCHDFEEPAID,
					T1.SCHDFEEOS,
					T1.INSSCHD,
					T1.SCHDINSPAID,
					T1.ADVPFTRATE,
					T1.ADVPROFIT,
					T1.ADVREPAYAMOUNT,
					T1.ADVBASERATE,
					T1.ADVMARGIN,
					T1.ADVCALRATE,
					T1.SUPLRENT,
					T1.INCRCOST,
					T1.SUPLRENTPAID,
					T1.INCRCOSTPAID,
					T1.ROLLOVERONSCHDATE,
					T1.ROLLOVERAMOUNT,
					T1.ROLLOVERAMOUNTPAID,
					T1.TDSAMOUNT,
					T1.TDSPAID,
					T1.PFTDAYSBASIS,
					T1.WRITEOFFINS,
					T1.WRITEOFFINCRCOST,
					T1.WRITEOFFSUPLRENT,
					T1.WRITEOFFSCHFEE,
					T1.INSURANCEAMT,
					T1.INSTNUMBER,
					T1.BPIORHOLIDAY,
					T1.FRQDATE,
					T1.PRESENTMENTID,
					T1.PARTIALPAIDAMT,
					T1.FEETAX,
					T1.RECALLOCK,
					T1.TDSAPPLICABLE,
					T1.SCHDPFTWAIVER,
					T1.CPZBALANCE
				FROM FINSCHEDULEDETAILS T1
				INNER JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID
			]]>
		</createView>
	</changeSet>

	<changeSet id="SDV_3_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finscheduledetails_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="SDV_4_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finscheduledetails_iview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SDV_4" author="Gopal.p">
		<createView viewName="FINSCHEDULEDETAILS_IVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T.REPAYACCOUNTID,
					T.FINTYPE,
					T.FINID,
					T.FINREFERENCE,
					T.SCHDATE,
					T.FINCCY,
					T.REPAYAMOUNT
				   FROM (SELECT row_number() OVER (PARTITION BY T1.FINID ORDER BY T1.SCHDATE) ROW_NUM,
							T2.REPAYACCOUNTID, T2.FINTYPE, T2.FINID, T1.SCHDATE, T2.FINREFERENCE, T2.FINCCY, T1.REPAYAMOUNT
						FROM FINSCHEDULEDETAILS T1
						JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID
						WHERE (T1.PROFITSCHD - T1.SCHDPFTPAID + T1.PRINCIPALSCHD - T1.SCHDPRIPAID) <> 0 AND
						T1.SCHDATE > (to_date((SELECT SYSPARMVALUE FROM SMTPARAMETERS WHERE SYSPARMCODE = 'APP_DATE'), 'yyyy-MM-dd'))) t
				  WHERE t.ROW_NUM = 1
			]]>
		</createView>
	</changeSet>

	<changeSet id="SDV_4_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finscheduledetails_iview');	
			]]>
		</sql>
	</changeSet>

	<!-- (SDV) :: Finance Schedule detail Views handle in single place end -->

	<!-- (FDDV) :: FIN DISBURSEMENT DETAILS Views handle in single place start -->

	<changeSet id="FDDV_1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'findisbursementdetails_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FDDV_1" author="Gopal.p">
		<createView viewName="FINDISBURSEMENTDETAILS_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T3.FINID,
					T3.FINREFERENCE,
					T1.DISBDATE,
					T1.DISBSEQ,
					T1.DISBDESC,
					T1.DISBACCOUNTID,
					T1.DISBAMOUNT,
					T1.DISBREQDATE,
					T1.DISBDISBURSED,
					T1.DISBISACTIVE,
					T1.DISBREMARKS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.FEECHARGEAMT,
					T1.DISBSTATUS,
					T1.DISBTYPE,
					T1.DISBCLAIM,
					T1.DISBEXPTYPE,
					T1.DISBRETPERC,
					T1.DISBRETAMOUNT,
					T1.AUTODISB,
					T1.NETADVDUE,
					T1.NETRETDUE,
					T1.DISBRETPAID,
					T1.RETPAIDDATE,
					T2.EXPENCETYPENAME LOVDESCDISBEXPTYPE,
					T1.CONSULTFEEFRQ,
					T1.CONSULTFEESTARTDATE,
					T1.CONSULTFEEENDDATE,
					T1.CONTRACTORID,
					T1.INSURANCEAMT,
					T1.INSTRUCTIONUID,
					T1.QUICKDISB,
					T1.InstCalReq,
					T1.LINKEDDISBID
				FROM FINDISBURSEMENTDETAILS_TEMP T1
				INNER JOIN FINANCEMAIN_TEMP T3 ON T3.FINID = T1.FINID
				LEFT JOIN AMTEXPENSETYPE T2 ON T2.EXPENCETYPEID = T1.DISBEXPTYPE
				UNION ALL
				SELECT T3.FINID,
					T3.FINREFERENCE,
					T1.DISBDATE,
					T1.DISBSEQ,
					T1.DISBDESC,
					T1.DISBACCOUNTID,
					T1.DISBAMOUNT,
					T1.DISBREQDATE,
					T1.DISBDISBURSED,
					T1.DISBISACTIVE,
					T1.DISBREMARKS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.FEECHARGEAMT,
					T1.DISBSTATUS,
					T1.DISBTYPE,
					T1.DISBCLAIM,
					T1.DISBEXPTYPE,
					T1.DISBRETPERC,
					T1.DISBRETAMOUNT,
					T1.AUTODISB,
					T1.NETADVDUE,
					T1.NETRETDUE,
					T1.DISBRETPAID,
					T1.RETPAIDDATE,
					T2.EXPENCETYPENAME LOVDESCDISBEXPTYPE,
					T1.CONSULTFEEFRQ,
					T1.CONSULTFEESTARTDATE,
					T1.CONSULTFEEENDDATE,
					T1.CONTRACTORID,
					T1.INSURANCEAMT,
					T1.INSTRUCTIONUID,
					T1.QUICKDISB,
					T1.InstCalReq,
					T1.LINKEDDISBID
				FROM FINDISBURSEMENTDETAILS T1
				INNER JOIN FINANCEMAIN_TEMP T3 ON T3.FINID = T1.FINID
				LEFT JOIN AMTEXPENSETYPE T2 ON T2.EXPENCETYPEID = T1.DISBEXPTYPE
				WHERE NOT (EXISTS (SELECT 1 FROM FINDISBURSEMENTDETAILS_TEMP
					WHERE FINDISBURSEMENTDETAILS_TEMP.FINID = T1.FINID))
			]]>
		</createView>
	</changeSet>

	<changeSet id="FDDV_1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'findisbursementdetails_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="FDDV_2_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'findisbursementdetails_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FDDV_2" author="Gopal.p">
		<createView viewName="FINDISBURSEMENTDETAILS_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T3.FINID,
					T3.FINREFERENCE,
					T1.DISBDATE,
					T1.DISBSEQ,
					T1.DISBDESC,
					T1.DISBACCOUNTID,
					T1.DISBAMOUNT,
					T1.DISBREQDATE,
					T1.DISBDISBURSED,
					T1.DISBISACTIVE,
					T1.DISBREMARKS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.FEECHARGEAMT,
					T1.DISBSTATUS,
					T1.DISBTYPE,
					T1.DISBCLAIM,
					T1.DISBEXPTYPE,
					T1.DISBRETPERC,
					T1.DISBRETAMOUNT,
					T1.AUTODISB,
					T1.NETADVDUE,
					T1.NETRETDUE,
					T1.DISBRETPAID,
					T1.RETPAIDDATE,
					T2.EXPENCETYPENAME LOVDESCDISBEXPTYPE,
					T1.CONSULTFEEFRQ,
					T1.CONSULTFEESTARTDATE,
					T1.CONSULTFEEENDDATE,
					T1.CONTRACTORID,
					T1.INSURANCEAMT,
					T1.INSTRUCTIONUID,
					T1.QUICKDISB,
					T1.INSTCALREQ,
					T1.LINKEDDISBID
				FROM FINDISBURSEMENTDETAILS_TEMP T1
				INNER JOIN FINANCEMAIN_TEMP T3 ON T3.FINID = T1.FINID
				LEFT JOIN AMTEXPENSETYPE T2 ON T2.EXPENCETYPEID = T1.DISBEXPTYPE
			]]>
		</createView>
	</changeSet>

	<changeSet id="FDDV_2_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'findisbursementdetails_tview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="FDDV_3_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'findisbursementdetails_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FDDV_3" author="Gopal.p">
		<createView viewName="FINDISBURSEMENTDETAILS_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T3.FINID,
					T3.FINREFERENCE,
					T1.DISBDATE,
					T1.DISBSEQ,
					T1.DISBDESC,
					T1.DISBACCOUNTID,
					T1.DISBAMOUNT,
					T1.DISBREQDATE,
					T1.DISBDISBURSED,
					T1.DISBISACTIVE,
					T1.DISBREMARKS,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.FEECHARGEAMT,
					T1.VERSION,
					T1.DISBSTATUS,
					T1.DISBTYPE,
					T1.DISBCLAIM,
					T1.DISBEXPTYPE,
					T1.DISBRETPERC,
					T1.DISBRETAMOUNT,
					T1.AUTODISB,
					T1.NETADVDUE,
					T1.NETRETDUE,
					T1.DISBRETPAID,
					T1.RETPAIDDATE,
					T2.EXPENCETYPENAME LOVDESCDISBEXPTYPE,
					T1.CONSULTFEEFRQ,
					T1.CONSULTFEESTARTDATE,
					T1.CONSULTFEEENDDATE,
					T1.CONTRACTORID,
					T1.INSURANCEAMT,
					T1.INSTRUCTIONUID,
					T1.QUICKDISB,
					T1.INSTCALREQ,
					T1.LINKEDDISBID
				FROM FINDISBURSEMENTDETAILS T1
				INNER JOIN FINANCEMAIN T3 ON T3.FINID = T1.FINID
				LEFT JOIN AMTEXPENSETYPE T2 ON T2.EXPENCETYPEID = T1.DISBEXPTYPE
			]]>
		</createView>
	</changeSet>

	<changeSet id="FDDV_3_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'findisbursementdetails_aview');	
			]]>
		</sql>
	</changeSet>

	<!-- (FDDV) :: FIN DISBURSEMENT DETAILS Views handle in single place end -->

	<!-- (PMV) :: PMAY Views handle in single place start -->

	<changeSet id="PMV_1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'pmay_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="PMV_1" author="Gopal.p">
		<createView viewName="PMAY_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.NOTIFIEDTOWN,
					T1.TOWNCODE,
					T4.TOWNNAME,
					T1.CENTRALASSISTANCE,
					T1.OWNEDHOUSE,
					T1.CARPETAREA,
					T1.HOUSEHOLDANNINCOME,
					T1.BALANCETRANSFER,
					T1.PRIMARYAPPLICANT,
					T1.TRANSACTIONFINTYPE,
					T1.PRODUCT,
					T1.PRPRTYOWNEDBYWOMEN,
					T1.WATERSUPPLY,
					T1.DRINAGE,
					T1.ELECTRICITY,
					T1.PMAYCATEGORY,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINTYPE
				FROM PMAY_TEMP T1
				INNER JOIN FINANCEMAIN_TEMP T2 ON T2.FINID = T1.FINID
				INNER JOIN CUSTOMERS T3 ON T3.CUSTID =T2.CUSTID
				LEFT JOIN TOWNCODE T4 ON T4.TOWNCODE = T1.TOWNCODE
				WHERE T2.FINISACTIVE = 1
       			UNION ALL 
       			SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.NOTIFIEDTOWN,
					T1.TOWNCODE,
					T4.TOWNNAME,
					T1.CENTRALASSISTANCE,
					T1.OWNEDHOUSE,
					T1.CARPETAREA,
					T1.HOUSEHOLDANNINCOME,
					T1.BALANCETRANSFER,
					T1.PRIMARYAPPLICANT,
					T1.TRANSACTIONFINTYPE,
					T1.PRODUCT,
					T1.PRPRTYOWNEDBYWOMEN,
					T1.WATERSUPPLY,
					T1.DRINAGE,
					T1.ELECTRICITY,
					T1.PMAYCATEGORY,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINTYPE
				FROM PMAY T1
      			INNER JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID
				INNER JOIN CUSTOMERS T3 ON T3.CUSTID = T2.CUSTID
				LEFT JOIN TOWNCODE T4 ON T4.TOWNCODE = T1.TOWNCODE
      			WHERE NOT EXISTS (SELECT 1 FROM PMAY_TEMP WHERE FINID = T2.FINID) AND T2.FINISACTIVE = 1
			]]>
		</createView>
	</changeSet>

	<changeSet id="PMV_1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'pmay_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="PMV_2_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'pmay_lview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="PMV_2" author="Gopal.p">
		<createView viewName="PMAY_LVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.NOTIFIEDTOWN,
					T1.TOWNCODE,
					T4.TOWNNAME,
					T1.CENTRALASSISTANCE,
					T1.OWNEDHOUSE,
					T1.CARPETAREA,
					T1.HOUSEHOLDANNINCOME,
					T1.BALANCETRANSFER,
					T1.PRIMARYAPPLICANT,
					T1.TRANSACTIONFINTYPE,
					T1.PRODUCT,
					T1.PRPRTYOWNEDBYWOMEN,
					T1.WATERSUPPLY,
					T1.DRINAGE,
					T1.ELECTRICITY,
					T1.PMAYCATEGORY,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINTYPE
				FROM PMAY_TEMP T1
				JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID
				JOIN CUSTOMERS T3 ON T3.CUSTID = T2.CUSTID
				LEFT JOIN TOWNCODE T4 ON T4.TOWNCODE = T1.TOWNCODE
				WHERE T2.FINISACTIVE = 1
				UNION ALL
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.NOTIFIEDTOWN,
					T1.TOWNCODE,
					T4.TOWNNAME,
					T1.CENTRALASSISTANCE,
					T1.OWNEDHOUSE,
					T1.CARPETAREA,
					T1.HOUSEHOLDANNINCOME,
					T1.BALANCETRANSFER,
					T1.PRIMARYAPPLICANT,
					T1.TRANSACTIONFINTYPE,
					T1.PRODUCT,
					T1.PRPRTYOWNEDBYWOMEN,
					T1.WATERSUPPLY,
					T1.DRINAGE,
					T1.ELECTRICITY,
					T1.PMAYCATEGORY,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINTYPE
				FROM PMAY T1
				JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID
				JOIN CUSTOMERS T3 ON T3.CUSTID = T2.CUSTID
				LEFT JOIN TOWNCODE T4 ON T4.TOWNCODE = T1.TOWNCODE
				WHERE NOT EXISTS (SELECT 1 FROM PMAY_TEMP WHERE PMAY_TEMP.FINID = T2.FINID) AND T2.FINISACTIVE = 1
			]]>
		</createView>
	</changeSet>

	<changeSet id="PMV_2_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'pmay_lview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="PMV_3_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'pmay_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="PMV_3" author="Gopal.p">
		<createView viewName="PMAY_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.NOTIFIEDTOWN,
					T1.TOWNCODE,
					T4.TOWNNAME,
					T1.CENTRALASSISTANCE,
					T1.OWNEDHOUSE,
					T1.CARPETAREA,
					T1.HOUSEHOLDANNINCOME,
					T1.BALANCETRANSFER,
					T1.PRIMARYAPPLICANT,
					T1.TRANSACTIONFINTYPE,
					T1.PRODUCT,
					T1.PRPRTYOWNEDBYWOMEN,
					T1.WATERSUPPLY,
					T1.DRINAGE,
					T1.ELECTRICITY,
					T1.PMAYCATEGORY,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINTYPE
				FROM PMAY T1
				JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID
				JOIN CUSTOMERS T3 ON T3.CUSTID = T2.CUSTID
				LEFT JOIN TOWNCODE T4 ON T4.TOWNCODE = T1.TOWNCODE
			]]>
		</createView>
	</changeSet>

	<changeSet id="PMV_3_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'pmay_aview');	
			]]>
		</sql>
	</changeSet>

	<!-- (PMV) :: PMAY Views handle in single place end -->

	<!-- (SSDV) :: Subvention Details and Subvention Schedule Detail Views handle in single place start -->

	<changeSet id="SSDV_1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'subventiondetails_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SSDV_1" author="Gopal.p">
		<createView viewName="SUBVENTIONDETAILS_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.METHOD, 
					T1.TYPE, 
					T1.RATE, 
					T1.PERIODRATE, 
					T1.DISCOUNTRATE, 
					T1.TENURE, 
					T1.STARTDATE, 
					T1.ENDDATE,		
					T1.VERSION, 
					T1.LASTMNTBY, 
					T1.LASTMNTON,
					T1.RECORDSTATUS, 
					T1.ROLECODE, 
					T1.NEXTROLECODE, 
					T1.TASKID, 
					T1.NEXTTASKID, 
					T1.RECORDTYPE, 
					T1.WORKFLOWID
				FROM SUBVENTIONDETAILS T1
				INNER JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID
			]]>
		</createView>
	</changeSet>

	<changeSet id="SSDV_1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'subventiondetails_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="SSDV_2_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'subventiondetails_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SSDV_2" author="Gopal.p">
		<createView viewName="SUBVENTIONDETAILS_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.METHOD, 
					T1.TYPE, 
					T1.RATE, 
					T1.PERIODRATE, 
					T1.DISCOUNTRATE, 
					T1.TENURE, 
					T1.STARTDATE, 
					T1.ENDDATE,		
					T1.VERSION, 
					T1.LASTMNTBY, 
					T1.LASTMNTON,
					T1.RECORDSTATUS, 
					T1.ROLECODE, 
					T1.NEXTROLECODE, 
					T1.TASKID, 
					T1.NEXTTASKID, 
					T1.RECORDTYPE, 
					T1.WORKFLOWID
				FROM SUBVENTIONDETAILS_TEMP T1
				INNER JOIN FINANCEMAIN_TEMP T2 ON T2.FINID = T1.FINID
				UNION ALL
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.METHOD, 
					T1.TYPE, 
					T1.RATE, 
					T1.PERIODRATE, 
					T1.DISCOUNTRATE, 
					T1.TENURE, 
					T1.STARTDATE, 
					T1.ENDDATE,		
					T1.VERSION, 
					T1.LASTMNTBY, 
					T1.LASTMNTON,
					T1.RECORDSTATUS, 
					T1.ROLECODE, 
					T1.NEXTROLECODE, 
					T1.TASKID, 
					T1.NEXTTASKID, 
					T1.RECORDTYPE, 
					T1.WORKFLOWID
				FROM SUBVENTIONDETAILS T1 
				INNER JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID
				WHERE NOT EXISTS (SELECT 1 FROM SUBVENTIONDETAILS_TEMP WHERE FINID = T1.FINID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="SSDV_2_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'subventiondetails_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="SSDV_3_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'subventionscheduledetail_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SSDV_3" author="Gopal.p">
		<createView viewName="SUBVENTIONSCHEDULEDETAIL_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.DISBSEQID, 
					T1.SCHDATE, 
					T1.NOOFDAYS, 
					T1.DISCOUNTEDPFT, 
					T1.PRESENTVALUE, 
					T1.FUTUREVALUE, 
					T1.CLOSINGBAL
				FROM SUBVENTIONSCHEDULEDETAIL T1
				INNER JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID				
			]]>
		</createView>
	</changeSet>

	<changeSet id="SSDV_3_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'subventionscheduledetail_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="SSDV_4_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'subventionscheduledetail_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SSDV_4" author="Gopal.p">
		<createView viewName="SUBVENTIONSCHEDULEDETAIL_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE, 
					T1.DISBSEQID, 
					T1.SCHDATE, 
					T1.NOOFDAYS, 
					T1.DISCOUNTEDPFT, 
					T1.PRESENTVALUE, 
					T1.FUTUREVALUE, 
					T1.CLOSINGBAL
				FROM SUBVENTIONSCHEDULEDETAIL_TEMP T1	
				INNER JOIN FINANCEMAIN_TEMP T2 ON T2.FINID = T1.FINID					
			]]>
		</createView>
	</changeSet>

	<changeSet id="SSDV_4_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'subventionscheduledetail_tview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="SSDV_5_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'subventionscheduledetail_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="SSDV_5" author="Gopal.p">
		<createView viewName="SUBVENTIONSCHEDULEDETAIL_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T2.FINID,
					T2.FINREFERENCE,
			 		T1.DISBSEQID,
			 		T1.SCHDATE,
			 		T1.NOOFDAYS, 
			 		T1.DISCOUNTEDPFT, 
			 		T1.PRESENTVALUE, 
			 		T1.FUTUREVALUE, 
			 		T1.CLOSINGBAL
				FROM SUBVENTIONSCHEDULEDETAIL_TEMP T1
				INNER JOIN FINANCEMAIN_TEMP T2 ON T2.FINID = T1.FINID	
				UNION ALL		 
				SELECT T2.FINID,
					T2.FINREFERENCE,
					T1.DISBSEQID,
					T1.SCHDATE, 
					T1.NOOFDAYS, 
					T1.DISCOUNTEDPFT, 
					T1.PRESENTVALUE, 
					T1.FUTUREVALUE, 
					T1.CLOSINGBAL
				FROM SUBVENTIONSCHEDULEDETAIL T1
				INNER JOIN FINANCEMAIN T2 ON T2.FINID = T1.FINID	
				WHERE NOT EXISTS (SELECT 1 FROM SUBVENTIONSCHEDULEDETAIL_TEMP WHERE FINID = T1.FINID AND DISBSEQID = T1.DISBSEQID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="SSDV_5_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'subventionscheduledetail_view');	
			]]>
		</sql>
	</changeSet>

	<!-- (SSDV) :: Subvention Details and Subvention Schedule Detail Views handle in single place end -->

	<!-- (FRIV) :: Finance Repay Instruction Views handle in single place start -->

	<changeSet id="FRIV_1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finrepayinstruction_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FRIV_1" author="Gopal.p">
		<createView viewName="FINREPAYINSTRUCTION_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.REPAYDATE,
					T1.REPAYAMOUNT,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.REPAYSCHDMETHOD
				FROM FINREPAYINSTRUCTION T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="FRIV_1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finrepayinstruction_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="FRIV_2_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finrepayinstruction_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FRIV_2" author="Gopal.p">
		<createView viewName="FINREPAYINSTRUCTION_TVIEW" replaceIfExists="true">
			<![CDATA[
				 SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.REPAYDATE,
					T1.REPAYAMOUNT,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.REPAYSCHDMETHOD
				FROM FINREPAYINSTRUCTION_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="FRIV_2_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finrepayinstruction_tview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="FRIV_3_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finrepayinstruction_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="FRIV_3" author="Gopal.p">
		<createView viewName="FINREPAYINSTRUCTION_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.REPAYDATE,
					T1.REPAYAMOUNT,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.REPAYSCHDMETHOD
				FROM FINREPAYINSTRUCTION_TEMP T1
				UNION ALL
				SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.REPAYDATE,
					T1.REPAYAMOUNT,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.REPAYSCHDMETHOD
				   FROM FINREPAYINSTRUCTION T1
				WHERE NOT EXISTS (SELECT 1 FROM FINREPAYINSTRUCTION_TEMP
					WHERE FINREPAYINSTRUCTION_TEMP.FINID = T1.FINID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="FRIV_3_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finrepayinstruction_view');	
			]]>
		</sql>
	</changeSet>

	<!-- (FRIV) :: Finance Repay Instruction Views handle in single place end -->

	<changeSet id="ST#2367.1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'custfinanceexposure_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#2367.1" author="Gopal.p">
		<createView viewName="CUSTFINANCEEXPOSURE_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT FM.FINID,
					FM.FINREFERENCE,
					FM.FINCOMMITMENTREF,
					CMT.CMTTITLE,
					FM.CUSTID,
					FM.NUMBEROFTERMS,
					FM.FINSTARTDATE,
					FM.FINTYPE,
					FM.FINAMOUNT + FM.TOTALPROFIT TOTALORIGINAL,
					CMT.CMTAMOUNT,
					CMT.CMTAVAILABLE,
					CMT.CMTEXPDATE CMTEXPIRYDATE,
					FM.FINAMOUNT - FM.FINREPAYMENTAMOUNT + FPD.TOTALPFTBAL TOTALOUTSTANDING,
					FM.MATURITYDATE,
					FM.TOTALREPAYAMT,
					FM.FINSTATUS
				FROM FINANCEMAIN FM
				JOIN FINPFTDETAILS FPD ON FM.FINID = FPD.FINID
				LEFT JOIN COMMITMENTS CMT ON CMT.CMTREFERENCE = FM.FINCOMMITMENTREF
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#2367.1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'custfinanceexposure_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#2367.2_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'gl_subheadcodes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#2367.2" author="Gopal.p">
		<createView viewName="GL_SUBHEADCODES_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT FM.FINID,
					FM.FINREFERENCE,
					NULL ENTITYCODE,
					0 ALWFLEXI,
					FM.FINBRANCH,
					NULL BTLOAN,
					BV.CODE BUSINESSVERTICAL,
					CUST.SUBCATEGORY EMPTYPE,
					PC.PCCITYNAME BRANCHCITY,
					FT.FINCOLLATERALREQ,
					RF.FINDIVISION
				FROM FINANCEMAIN_TEMP FM
				JOIN RMTFINANCETYPES FT ON FM.FINTYPE = FT.FINTYPE
				JOIN CUSTOMERS CUST ON CUST.CUSTID = FM.CUSTID
				JOIN RMTBRANCHES BR ON BR.BRANCHCODE = FM.FINBRANCH
				JOIN RMTPROVINCEVSCITY PC ON PC.PCCITY = BR.BRANCHCITY
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = FM.BUSINESSVERTICAL
				JOIN RMTFINANCETYPES RF ON RF.FINTYPE = FM.FINTYPE
				UNION ALL
				SELECT FM.FINID,
					FM.FINREFERENCE,
					NULL ENTITYCODE,
					0 ALWFLEXI,
					FM.FINBRANCH,
					NULL BTLOAN,
					BV.CODE BUSINESSVERTICAL,
					CUST.SUBCATEGORY EMPTYPE,
					PC.PCCITYNAME BRANCHCITY,
					FT.FINCOLLATERALREQ,
					RF.FINDIVISION
				FROM FINANCEMAIN FM
				JOIN RMTFINANCETYPES FT ON FM.FINTYPE = FT.FINTYPE
				JOIN CUSTOMERS CUST ON CUST.CUSTID = FM.CUSTID
				JOIN RMTBRANCHES BR ON BR.BRANCHCODE = FM.FINBRANCH
				JOIN RMTPROVINCEVSCITY PC ON PC.PCCITY = BR.BRANCHCITY
				JOIN BUSINESS_VERTICAL BV ON BV.ID = FM.BUSINESSVERTICAL
				JOIN RMTFINANCETYPES RF ON RF.FINTYPE = FM.FINTYPE
				WHERE NOT EXISTS (SELECT 1 FROM FINANCEMAIN_TEMP WHERE FINANCEMAIN_TEMP.FINID = FM.FINID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#2367.2_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'gl_subheadcodes_view');	
			]]>
		</sql>
	</changeSet>

</databaseChangeLog>