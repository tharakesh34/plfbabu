<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value="" dbms="oracle" />
	<property name="add.schema" value="" dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PLFAVANSEQC.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="Gopal.p" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>

	<changeSet id="STLMT#1" author="Shanakr.M">
		<comment>New Sequence for settlement Type Detail Table</comment>
		<createSequence sequenceName="SEQSETTLEMENTTYPES" incrementBy="1" startValue="1" minValue="1"
			maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="STLMT#2" author="saikiran.n">
		<comment>New Table for settlement Type Detail</comment>
		<createTable tableName="SETTLEMENTTYPES">
			<column name="SettlementTypeID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="SettlementCode" type="VARCHAR(20)" />
			<column name="SettlementDesc" type="VARCHAR(200)" />
			<column name="AlwGracePeriod" type="smallint" />
			<column name="Active" type="smallint" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="STLMT#3" author="saikiran.n">
		<addPrimaryKey tableName="SETTLEMENTTYPES" columnNames="SettlementTypeID, SettlementCode"
			constraintName="PK_HDRID_STLCODE" />
	</changeSet>

	<changeSet id="STLMT#4" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="AlwGracePeriod" tableName="SETTLEMENTTYPES" defaultValue="0" />
		<addDefaultValue columnName="Active" tableName="SETTLEMENTTYPES" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#4" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SETTLEMENTTYPES ADD CONSTRAINT DF_P_AlwGracePeriod DEFAULT 0 FOR AlwGracePeriod;
				ALTER TABLE SETTLEMENTTYPES ADD CONSTRAINT DF_P_Active DEFAULT 0 FOR Active;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#5" author="saikiran.n">
		<comment>New Temp Table for settlement Type Detail</comment>
		<createTable tableName="SETTLEMENTTYPES_TEMP">
			<column name="SettlementTypeID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="SettlementCode" type="VARCHAR(20)" />
			<column name="SettlementDesc" type="VARCHAR(200)" />
			<column name="AlwGracePeriod" type="smallint" />
			<column name="Active" type="smallint" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="STLMT#6" author="saikiran.n">
		<addPrimaryKey tableName="SETTLEMENTTYPES_TEMP" columnNames="SettlementTypeID, SettlementCode"
			constraintName="PKT_HDRID_STLCODE" />
	</changeSet>

	<changeSet id="STLMT#7" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="AlwGracePeriod" tableName="SETTLEMENTTYPES_TEMP" defaultValue="0" />
		<addDefaultValue columnName="Active" tableName="SETTLEMENTTYPES_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#7" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SETTLEMENTTYPES_TEMP ADD CONSTRAINT DF_PT_AlwGracePeriod DEFAULT 0 FOR AlwGracePeriod;
				ALTER TABLE SETTLEMENTTYPES_TEMP ADD CONSTRAINT DF_PT_Active DEFAULT 0 FOR Active;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#8_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementtypes_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#8" author="saikiran.n">
		<createView viewName="SETTLEMENTTYPES_AVIEW" replaceIfExists="true">
		<![CDATA[
		   SELECT T1.SETTLEMENTTYPEID
				,T1.SETTLEMENTCODE
				, T1.SETTLEMENTDESC
				, T1.ALWGRACEPERIOD
				, T1.ACTIVE
				, T1.VERSION
				, T1.LASTMNTBY
				, T1.LASTMNTON
				, T1.RECORDSTATUS
				, T1.ROLECODE
				, T1.NEXTROLECODE
				, T1.TASKID
				, T1.NEXTTASKID
				, T1.RECORDTYPE
				, T1.WORKFLOWID
			    FROM SETTLEMENTTYPES T1
		]]>
	</createView>
	</changeSet>

	<changeSet id="STLMT#8_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementtypes_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#9_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementtypes_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#9" author="saikiran.n">
		<createView viewName="SETTLEMENTTYPES_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTTYPEID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTTYPES_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="PSTLMT#9_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementtypes_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#10_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlementtypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#10" author="saikiran.n">
		<createView viewName="SETTLEMENTTYPES_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTTYPEID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTTYPES_TEMP T1
				UNION ALL 
				SELECT T1.SETTLEMENTTYPEID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENTTYPES T1
				WHERE NOT (EXISTS ( SELECT 1 FROM SETTLEMENTTYPES_TEMP
				WHERE SETTLEMENTTYPES_TEMP.SETTLEMENTTYPEID = T1.SETTLEMENTTYPEID))
			]]>
		</createView>
	</changeSet>

	<changeSet id="STLMT#10_post" author="Shankar.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'settlementtypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#11" author="saikiran.n">
		<comment>RIGHTS for settlement Type Detail</comment>
		<sql>
			<![CDATA[
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_APPROVER');
		
				DELETE FROM SECROLEGROUPS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_APPROVER');
				
				DELETE FROM SECGROUPS WHERE GRPCODE IN ('SETTLEMENTTYPEDETAIL_MAKER', 'SETTLEMENTTYPEDETAIL_APPROVER');
		
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnNew');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnEdit');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnSave');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnDelete');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_SettlementCode');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_SettlementDesc');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_AlwGracePeriod');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_Active');
				
				DELETE FROM SECRIGHTS WHERE RightName = 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnNew';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnEdit';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnSave';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementTypeDetailDialog_btnDelete';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_SettlementCode';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_SettlementDesc';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_AlwGracePeriod';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementTypeDetailDialog_Active';
				
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail', 'MENU', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementTypeDetailDialog_btnNew','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementTypeDetailDialog_btnEdit','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementTypeDetailDialog_btnSave','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementTypeDetailDialog_btnDelete','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementTypeDetailDialog_SettlementCode','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementTypeDetailDialog_SettlementDesc','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementTypeDetailDialog_AlwGracePeriod','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementTypeDetailDialog_Active','SettlementTypeDetailDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SETTLEMENTTYPEDETAIL_MAKER', 'Settlement Type Detail Maker',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SETTLEMENTTYPEDETAIL_APPROVER', 'Settlement Type Detail Approver',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnNew'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementTypeDetailDialog_SettlementCode'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementTypeDetailDialog_SettlementDesc'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementTypeDetailDialog_AlwGracePeriod'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementTypeDetailDialog_Active'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_SettlementTypeDetailMaster_SettlementTypeDetail'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENTTYPEDETAIL_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementTypeDetailDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#12" author="Shanakr.M">
		<comment>New Sequence for settlement Table</comment>
		<createSequence sequenceName="SEQSETTLEMENT" incrementBy="1" startValue="1" minValue="1"
			maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="STLMT#13" author="saikiran.n">
		<comment>New Table for settlement Details</comment>
		<createTable tableName="FinSettlementHeader">
			<column name="settlementHeaderID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FinId" type="bigint" />
			<column name="finReference" type="VarChar(20)" />
			<column name="settlementType" type="bigint" />
			<column name="settlementStatus" type="VarChar(5)" />
			<column name="startDate" type="datetime" />
			<column name="otsDate" type="datetime" />
			<column name="endDate" type="datetime" />
			<column name="settlementReason" type="VarChar(50)" />
			<column name="settlementAmount" type="Decimal(18,0)" />
			<column name="noOfGraceDays" type="bigint" />
			<column name="settlementEndAfterGrace" type="datetime" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementReasonId" type="bigint" />
			<column name="cancelReasonCode" type="varchar(10)" />
			<column name="cancelRemarks" type="varchar(20)" />
		</createTable>
	</changeSet>

	<changeSet id="STLMT#14" author="saikiran.n">
		<addPrimaryKey tableName="FinSettlementHeader" columnNames="settlementHeaderID"
			constraintName="PK_settlementHeaderID" />
	</changeSet>

	<changeSet id="PSD#213383.30" author="saikiran.n">
		<sql>
			<![CDATA[
				update FINSETTLEMENTHEADER set settlementReasonId = 0 where settlementReasonId is Null;			
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#15" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="FinId" tableName="FinSettlementHeader" defaultValue="0" />
		<addDefaultValue columnName="settlementType" tableName="FinSettlementHeader" defaultValue="0" />
		<addDefaultValue columnName="settlementAmount" tableName="FinSettlementHeader" defaultValue="0" />
		<addDefaultValue columnName="noOfGraceDays" tableName="FinSettlementHeader" defaultValue="0" />
		<addDefaultValue columnName="settlementReasonId" tableName="FINSETTLEMENTHEADER" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#15" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FinSettlementHeader ADD CONSTRAINT DF_STLMT_AlwGracePeriod DEFAULT 0 FOR FinId;
				ALTER TABLE FinSettlementHeader ADD CONSTRAINT DF_STLMT_Active DEFAULT 0 FOR settlementType;
				ALTER TABLE FinSettlementHeader ADD CONSTRAINT DF_STLMT_SettlementAmount DEFAULT 0 FOR SettlementAmount;
				ALTER TABLE FinSettlementHeader ADD CONSTRAINT DF_STLMT_Active DEFAULT 0 FOR noOfGraceDays;
				ALTER TABLE FINSETTLEMENTHEADER ADD CONSTRAINT DF_FSH_settlementReasonId DEFAULT 0 FOR settlementReasonId;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#16" author="saikiran.n">
		<comment>New Temp Table for settlement Details</comment>
		<createTable tableName="FinSettlementHeader_TEMP">
			<column name="SettlementHeaderID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FinId" type="bigint" />
			<column name="FinReference" type="VarChar(20)" />
			<column name="SettlementType" type="bigint" />
			<column name="SettlementStatus" type="VarChar(5)" />
			<column name="StartDate" type="datetime" />
			<column name="OtsDate" type="datetime" />
			<column name="EndDate" type="datetime" />
			<column name="SettlementReason" type="VarChar(50)" />
			<column name="SettlementAmount" type="Decimal(18,0)" />
			<column name="NoOfGraceDays" type="bigint" />
			<column name="SettlementEndAfterGrace" type="datetime" />
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementReasonId" type="bigint" />
			<column name="cancelReasonCode" type="varchar(10)" />
			<column name="cancelRemarks" type="varchar(20)" />
		</createTable>
	</changeSet>

	<changeSet id="STLMT#17" author="saikiran.n">
		<addPrimaryKey tableName="FinSettlementHeader_TEMP" columnNames="settlementHeaderID"
			constraintName="PKT_FinSettlementHeaderID" />
	</changeSet>

	<changeSet id="PSD#213383.31" author="saikiran.n">
		<sql>
			<![CDATA[
				update FINSETTLEMENTHEADER_TEMP set settlementReasonId = 0 where settlementReasonId is Null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#18" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="FinId" tableName="FinSettlementHeader_TEMP" defaultValue="0" />
		<addDefaultValue columnName="settlementType" tableName="FinSettlementHeader_TEMP" defaultValue="0" />
		<addDefaultValue columnName="settlementAmount" tableName="FinSettlementHeader_TEMP" defaultValue="0" />
		<addDefaultValue columnName="noOfGraceDays" tableName="FinSettlementHeader_TEMP" defaultValue="0" />
		<addDefaultValue columnName="settlementReasonId" tableName="FINSETTLEMENTHEADER_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#18" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FinSettlementHeader_TEMP ADD CONSTRAINT DF_STLMTTemp_FinId DEFAULT 0 FOR FinId;
				ALTER TABLE FinSettlementHeader_TEMP ADD CONSTRAINT DF_STLMTTemp_SettlementType DEFAULT 0 FOR SettlementType;
				ALTER TABLE FinSettlementHeader_TEMP ADD CONSTRAINT DF_STLMTTemp_SettlementAmount DEFAULT 0 FOR SettlementAmount;
				ALTER TABLE FinSettlementHeader_TEMP ADD CONSTRAINT DF_STLMTTemp_NoOfGraceDays DEFAULT 0 FOR NoOfGraceDays;
				ALTER TABLE FINSETTLEMENTHEADER_TEMP ADD CONSTRAINT DF_FSH_T_settlementReasonId DEFAULT 0 FOR settlementReasonId;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#19_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'finsettlementheader_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#19" author="saikiran.n">
		<createView viewName="FINSETTLEMENTHEADER_AVIEW" replaceIfExists="true">
			<![CDATA[
		  	 	SELECT T1.SETTLEMENTHEADERID
					,T1.FINID
					,T1.FINREFERENCE
					,T1.SETTLEMENTTYPE
					,T1.SETTLEMENTSTATUS
					,T1.STARTDATE
					,T1.OTSDATE
					,T1.ENDDATE
					,T1.SETTLEMENTREASON
					,T1.SETTLEMENTAMOUNT
					,T1.NOOFGRACEDAYS
					,T1.SETTLEMENTENDAFTERGRACE
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
					,T1.CANCELREASONCODE
					,T1.CANCELREMARKS
					,T2.SETTLEMENTCODE SETTLEMENTCODE
					,T1.SETTLEMENTREASONID
					,T3.DESCRIPTION SETTLEMENTREASONDESC
				FROM FINSETTLEMENTHEADER T1
				LEFT JOIN SETTLEMENTTYPES T2 ON T1.SETTLEMENTTYPE = T2.SETTLEMENTTYPEID
				LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
			]]>
		</createView>
	</changeSet>

	<changeSet id="STLMT#19_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'finsettlementheader_aview');
		]]>
		</sql>
	</changeSet>



	<changeSet id="PSD#213383.28_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'finsettlementheader_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#213383.28" author="saikiran.n">
		<createView viewName="FINSETTLEMENTHEADER_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					,T1.FINID
					,T1.FINREFERENCE
					,T1.SETTLEMENTTYPE
					,T1.SETTLEMENTSTATUS
					,T1.STARTDATE
					,T1.OTSDATE
					,T1.ENDDATE
					,T1.SETTLEMENTREASON
					,T1.SETTLEMENTAMOUNT
					,T1.NOOFGRACEDAYS
					,T1.SETTLEMENTENDAFTERGRACE
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
					,T1.CANCELREASONCODE
					,T1.CANCELREMARKS
					,T2.SETTLEMENTCODE SETTLEMENTCODE
					,T1.SETTLEMENTREASONID
				FROM FINSETTLEMENTHEADER_TEMP T1
				LEFT JOIN SETTLEMENTTYPES T2 ON T1.SETTLEMENTTYPE = T2.SETTLEMENTTYPEID
            	LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
				UNION ALL 
				SELECT T1.SETTLEMENTHEADERID
					,T1.FINID
					,T1.FINREFERENCE
					,T1.SETTLEMENTTYPE
					,T1.SETTLEMENTSTATUS
					,T1.STARTDATE
					,T1.OTSDATE
					,T1.ENDDATE
					,T1.SETTLEMENTREASON
					,T1.SETTLEMENTAMOUNT
					,T1.NOOFGRACEDAYS
					,T1.SETTLEMENTENDAFTERGRACE
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
					,T1.CANCELREASONCODE
					,T1.CANCELREMARKS
					,T2.SETTLEMENTCODE SETTLEMENTCODE
					,T1.SETTLEMENTREASONID
				FROM FINSETTLEMENTHEADER T1
				LEFT JOIN SETTLEMENTTYPES T2 ON T1.SETTLEMENTTYPE = T2.SETTLEMENTTYPEID
           		LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
				WHERE NOT (EXISTS ( SELECT 1 FROM FINSETTLEMENTHEADER_TEMP
				WHERE FINSETTLEMENTHEADER_TEMP.SETTLEMENTHEADERID = T1.SETTLEMENTHEADERID))
			]]>
		</createView>
	</changeSet>

	<changeSet id="PSD#213383.28_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finsettlementheader_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#213383.29_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finsettlementheader_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#213383.29" author="saikiran.n">
		<createView viewName="FINSETTLEMENTHEADER_TVIEW" replaceIfExists="true">
		    <![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					,T1.FINID
					,T1.FINREFERENCE
					,T1.SETTLEMENTTYPE
					,T1.SETTLEMENTSTATUS
					,T1.STARTDATE
					,T1.OTSDATE
					,T1.ENDDATE
					,T1.SETTLEMENTREASON
					,T1.SETTLEMENTAMOUNT
					,T1.NOOFGRACEDAYS
					,T1.SETTLEMENTENDAFTERGRACE
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
					,T1.CANCELREASONCODE
					,T1.CANCELREMARKS
					,T2.SETTLEMENTCODE SETTLEMENTCODE
					,T1.SETTLEMENTREASONID
				FROM FINSETTLEMENTHEADER_TEMP T1
				LEFT JOIN SETTLEMENTTYPES T2 ON T1.SETTLEMENTTYPE = T2.SETTLEMENTTYPEID
				LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
			]]>
		</createView>
	</changeSet>

	<changeSet id="PSD#213383.29_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finsettlementheader_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#22" author="saikiran.n">
		<comment>RIGHTS for settlement Type Detail</comment>
		<sql>
			<![CDATA[
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER');
				DELETE FROM SECGROUPRIGHTS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_APPROVER');
		
				DELETE FROM SECROLEGROUPS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER');
				DELETE FROM SECROLEGROUPS WHERE GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_APPROVER');
				
				DELETE FROM SECGROUPS WHERE GRPCODE IN ('SETTLEMENT_MAKER', 'SETTLEMENT_APPROVER');
		
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'menuItem_SettlementMaster_Settlement');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnNew');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnEdit');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnSave');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnDelete');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementType');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementStatus');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_StartDate');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_OtsDate');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementReason');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_EndDate');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_FinReference');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_FinID');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementAmount');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementEndAfterGrace');
				DELETE FROM SECGROUPRIGHTS WHERE RIGHTID = ( SELECT RIGHTID FROM SECRIGHTS WHERE RightName = 'SettlementDialog_NoOfGraceDays');
				
				DELETE FROM SECRIGHTS WHERE RightName = 'menuItem_SettlementMaster_Settlement';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnNew';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnEdit';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnSave';
				DELETE FROM SECRIGHTS WHERE RightName = 'button_SettlementDialog_btnDelete';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementType';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementStatus';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_StartDate';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_OtsDate';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementReason';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_EndDate';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_FinReference';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_FinID';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementAmount';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_SettlementEndAfterGrace';
				DELETE FROM SECRIGHTS WHERE RightName = 'SettlementDialog_NoOfGraceDays';
				
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menuItem_SettlementMaster_Settlement', 'MENU', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementDialog_btnNew','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementDialog_btnEdit','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementDialog_btnSave','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_SettlementDialog_btnDelete','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementType','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementStatus','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_StartDate','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_OtsDate','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementReason','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_EndDate','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_FinReference','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_FinID','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementAmount','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_SettlementEndAfterGrace','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECRIGHTS (RIGHTID, RIGHTTYPE, RIGHTNAME, PAGE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'SettlementDialog_NoOfGraceDays','SettlementDialog', 0, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SETTLEMENT_MAKER', 'Settlement Maker',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPS (GRPID, GRPCODE, GRPDESC, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'SETTLEMENT_APPROVER', 'Settlement Approver',  1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_SettlementMaster_Settlement'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnNew'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementType'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementStatus'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_StartDate'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_OtsDate'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementReason'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_EndDate'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_FinReference'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_FinID'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementAmount'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_SettlementEndAfterGrace'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'SettlementDialog_NoOfGraceDays'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menuItem_SettlementMaster_Settlement'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
				INSERT INTO SECGROUPRIGHTS (GRPRIGHTID, GRPID, RIGHTID, ACCESSTYPE, VERSION, LASTMNTBY, LASTMNTON, RECORDSTATUS, ROLECODE, NEXTROLECODE, TASKID, NEXTTASKID, RECORDTYPE, WORKFLOWID) VALUES ((SELECT MAX(GRPRIGHTID) + 1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE = 'SETTLEMENT_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_SettlementDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, 'Approved', null, null, null, null, null, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#23" author="Shanakr.M">
		<comment>New Sequence for settlement Table</comment>
		<createSequence sequenceName="SEQSETTLEMENTALLOCATIONDTLS" incrementBy="1" startValue="1" minValue="1"
			maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="STLMT#24" author="saikiran.n">
		<comment>New Table for settlement Allocation Details</comment>
		<createTable tableName="SettlementAllocationDtls">
			<column name="SETTLEMENTHEADERID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ALLOCATIONID" type="Decimal(10,0)" />
			<column name="ALLOCATIONTYPE" type="Char(8)" />
			<column name="ALLOCATIONTO" type="bigint" />
			<column name="PAIDAMOUNT" type="Decimal(18,0)" />
			<column name="TOTALDUE" type="Decimal(18,0)" />
			<column name="WAIVEDAMOUNT" type="Decimal(18,0)" />
			<column name="SETTLEMENTALLOCATIONID" type="bigint" />
			<column name="PAIDGST" type="Decimal(18,0)" />
			<column name="WAIVEDREQAMOUNT" type="Decimal(18,0)" />
			<column name="WAIVERACCEPTED" type="Char(1)" />
			<column name="WAIVEDGST" type="Decimal(18,0)" />
			<column name="TAXHEADERID" type="bigint" />
			<column name="TDSDUE" type="Decimal(18,0)" />
			<column name="TDSPAID" type="Decimal(18,0)" />
			<column name="TDSWAIVED" type="Decimal(18,0)" />
		</createTable>
	</changeSet>

	<changeSet id="STLMT#25" author="saikiran.n">
		<addForeignKeyConstraint constraintName="FK_StlmtAlctnDtls_HdrID"
			referencedTableName="FINSETTLEMENTHEADER" referencedColumnNames="SETTLEMENTHEADERID"
			baseTableName="SettlementAllocationDtls" baseColumnNames="SETTLEMENTHEADERID" />
	</changeSet>

	<changeSet id="STLMT#26" author="saikiran.n">
		<addPrimaryKey tableName="SettlementAllocationDtls" columnNames="SETTLEMENTHEADERID, ALLOCATIONID"
			constraintName="PK_HDRID_ALOCID" />
	</changeSet>

	<changeSet id="STLMT#27" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="PAIDGST" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TOTALDUE" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="WAIVEDREQAMOUNT" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="WAIVERACCEPTED" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="WAIVEDGST" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TAXHEADERID" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TDSDUE" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TDSPAID" tableName="SettlementAllocationDtls" defaultValue="0" />
		<addDefaultValue columnName="TDSWAIVED" tableName="SettlementAllocationDtls" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#27" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_PAIDGST DEFAULT 0 FOR PAIDGST;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TOTALDUE DEFAULT 0 FOR TOTALDUE;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_WAIVEDREQAMOUNT DEFAULT 0 FOR WAIVEDREQAMOUNT;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_WAIVERACCEPTED DEFAULT 0 FOR WAIVERACCEPTED;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_WAIVEDGST DEFAULT 0 FOR WAIVEDGST;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TAXHEADERID DEFAULT 0 FOR TAXHEADERID;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TDSDUE DEFAULT 0 FOR TDSDUE;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TDSPAID DEFAULT 0 FOR TDSPAID;
				ALTER TABLE SettlementAllocationDtls ADD CONSTRAINT DF_STLMT_TDSWAIVED DEFAULT 0 FOR TDSWAIVED;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#28" author="saikiran.n">
		<comment>New Temp Table for settlement Allocation Details</comment>
		<createTable tableName="SettlementAllocationDtls_Temp">
			<column name="SETTLEMENTHEADERID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ALLOCATIONID" type="Decimal(10,0)" />
			<column name="ALLOCATIONTYPE" type="Char(8)" />
			<column name="ALLOCATIONTO" type="bigint" />
			<column name="PAIDAMOUNT" type="Decimal(18,0)" />
			<column name="TOTALDUE" type="Decimal(18,0)" />
			<column name="WAIVEDAMOUNT" type="Decimal(18,0)" />
			<column name="SETTLEMENTALLOCATIONID" type="bigint" />
			<column name="PAIDGST" type="Decimal(18,0)" />
			<column name="WAIVEDREQAMOUNT" type="Decimal(18,0)" />
			<column name="WAIVERACCEPTED" type="Char(1)" />
			<column name="WAIVEDGST" type="Decimal(18,0)" />
			<column name="TAXHEADERID" type="bigint" />
			<column name="TDSDUE" type="Decimal(18,0)" />
			<column name="TDSPAID" type="Decimal(18,0)" />
			<column name="TDSWAIVED" type="Decimal(18,0)" />
		</createTable>
	</changeSet>

	<changeSet id="STLMT#29" author="saikiran.n">
		<addPrimaryKey tableName="SettlementAllocationDtls_Temp" columnNames="SETTLEMENTHEADERID, ALLOCATIONID"
			constraintName="PKT_HDRID_ALOCID" />
	</changeSet>

	<changeSet id="STLMT#30" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="PAIDGST" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TOTALDUE" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="WAIVEDREQAMOUNT" tableName="SettlementAllocationDtls_Temp"
			defaultValue="0" />
		<addDefaultValue columnName="WAIVERACCEPTED" tableName="SettlementAllocationDtls_Temp"
			defaultValue="0" />
		<addDefaultValue columnName="WAIVEDGST" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TAXHEADERID" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TDSDUE" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TDSPAID" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
		<addDefaultValue columnName="TDSWAIVED" tableName="SettlementAllocationDtls_Temp" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#30" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_PAIDGST DEFAULT 0 FOR PAIDGST;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TOTALDUE DEFAULT 0 FOR TOTALDUE;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_WAIVEDREQAMOUNT DEFAULT 0 FOR WAIVEDREQAMOUNT;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_WAIVERACCEPTED DEFAULT 0 FOR WAIVERACCEPTED;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_WAIVEDGST DEFAULT 0 FOR WAIVEDGST;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TAXHEADERID DEFAULT 0 FOR TAXHEADERID;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TDSDUE DEFAULT 0 FOR TDSDUE;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TDSPAID DEFAULT 0 FOR TDSPAID;
				ALTER TABLE SettlementAllocationDtls_Temp ADD CONSTRAINT DF_STLMTTEMP_TDSWAIVED DEFAULT 0 FOR TDSWAIVED;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#31_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementallocationdtls_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#31" author="saikiran.n">
		<createView viewName="SETTLEMENTALLOCATIONDTLS_AVIEW" replaceIfExists="true">
		<![CDATA[
			SELECT T1.SETTLEMENTHEADERID
				, T1.SETTLEMENTALLOCATIONID
				, T1.ALLOCATIONID
				, T1.ALLOCATIONTYPE
				, T1.ALLOCATIONTO
				, T1.PAIDAMOUNT
				, T1.WAIVEDAMOUNT
				, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
				, T1.PAIDGST
				, T1.WAIVEDREQAMOUNT
				, T1.WAIVERACCEPTED
				, T1.TOTALDUE
				, T1.WAIVEDGST
				, T1.TAXHEADERID
				, T1.TDSDUE
				, T1.TDSPAID
				, T1.TDSWAIVED
			FROM SETTLEMENTALLOCATIONDTLS T1
			LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE= 'FEE'
			LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
			LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
			LEFT JOIN FEETYPES T5 ON T4.FEETYPEID = T5.FEETYPEID
		]]>
	</createView>
	</changeSet>

	<changeSet id="STLMT#31_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementallocationdtls_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#32_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementallocationdtls_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#32" author="saikiran.n">
		<createView viewName="SETTLEMENTALLOCATIONDTLS_VIEW" replaceIfExists="true">
		<![CDATA[
			SELECT T1.SETTLEMENTHEADERID
				, T1.SETTLEMENTALLOCATIONID
				, T1.ALLOCATIONID
				, T1.ALLOCATIONTYPE
				, T1.ALLOCATIONTO
				, T1.PAIDAMOUNT
				, T1.WAIVEDAMOUNT
				, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
				, T1.PAIDGST
				, T1.WAIVEDREQAMOUNT
				, T1.WAIVERACCEPTED
				, T1.TOTALDUE
				, T1.WAIVEDGST
				, T1.TAXHEADERID
				, T1.TDSDUE
				, T1.TDSPAID
				, T1.TDSWAIVED
			FROM SETTLEMENTALLOCATIONDTLS_TEMP T1
    		LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE = 'FEE'
     		LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
     		LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
    		LEFT JOIN FEETYPES T5 ON  T4.FEETYPEID = T5.FEETYPEID
			UNION ALL
			SELECT T1.SETTLEMENTHEADERID
				, T1.SETTLEMENTALLOCATIONID
				, T1.ALLOCATIONID
				, T1.ALLOCATIONTYPE
				, T1.ALLOCATIONTO
				, T1.PAIDAMOUNT
				, T1.WAIVEDAMOUNT
				, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
				, T1.PAIDGST
				, T1.WAIVEDREQAMOUNT
				, T1.WAIVERACCEPTED
				, T1.TOTALDUE
				, T1.WAIVEDGST
				, T1.TAXHEADERID
				, T1.TDSDUE
				, T1.TDSPAID
				, T1.TDSWAIVED
   			FROM SETTLEMENTALLOCATIONDTLS T1
     		LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE = 'FEE'
     		LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
     		LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
   			LEFT JOIN FEETYPES T5 ON  T4.FEETYPEID = T5.FEETYPEID
			WHERE  NOT EXISTS (SELECT 1 FROM SETTLEMENTALLOCATIONDTLS_TEMP WHERE SETTLEMENTALLOCATIONDTLS_TEMP.SETTLEMENTALLOCATIONID = T1.SETTLEMENTALLOCATIONID)
		]]>
	</createView>
	</changeSet>

	<changeSet id="STLMT#32_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'settlementallocationdtls_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#33" author="Shanakr.M">
		<comment>New Sequence for settlement Table</comment>
		<createSequence sequenceName="SEQSETTLEMENTSCHEDULE" incrementBy="1" startValue="1" minValue="1"
			maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="STLMT#34" author="saikiran.n">
		<comment>New Table for settlement Schedule Details</comment>
		<createTable tableName="SettlementSchedule">
			<column name="SettlementHeaderID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementDetailID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementInstalDate" type="datetime" />
			<column name="settlementAmount" type="Decimal(18,0)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="STLMT#35" author="saikiran.n">
		<addForeignKeyConstraint constraintName="FK_StlmtSchdl_HdrID"
			referencedTableName="FINSETTLEMENTHEADER" referencedColumnNames="SettlementHeaderID"
			baseTableName="SettlementSchedule" baseColumnNames="SettlementHeaderID" />
	</changeSet>

	<changeSet id="STLMT#36" author="saikiran.n">
		<addPrimaryKey tableName="SettlementSchedule" columnNames="settlementDetailID"
			constraintName="PK_DETAILID" />
	</changeSet>

	<changeSet id="STLMT#37" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="settlementAmount" tableName="SettlementSchedule" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#37" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SETTLEMENTSCHEDULE ADD CONSTRAINT DF_STLMTSCH_SETTLEMENTAMOUNT DEFAULT 0 FOR SETTLEMENTAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#38" author="saikiran.n">
		<comment>New Temp Table for settlement Schedule Details</comment>
		<createTable tableName="SettlementSchedule_Temp">
			<column name="SettlementHeaderID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementDetailID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="settlementInstalDate" type="datetime" />
			<column name="settlementAmount" type="Decimal(18,0)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkFlowId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="STLMT#39" author="saikiran.n">
		<addPrimaryKey tableName="SettlementSchedule_Temp" columnNames="settlementDetailID"
			constraintName="PKT_DETAILID" />
	</changeSet>

	<changeSet id="STLMT#40" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="settlementAmount" tableName="SettlementSchedule_Temp" defaultValue="0" />
	</changeSet>

	<changeSet id="STLMT#40" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE SettlementSchedule_Temp ADD CONSTRAINT DF_STLMTSCHTEMP_STLNTAMNT DEFAULT 0 FOR SETTLEMENTAMOUNT;
			]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#41_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementschedule_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#41" author="saikiran.n">
		<createView viewName="SETTLEMENTSCHEDULE_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					,T1.SETTLEMENTDETAILID
					,T1.SETTLEMENTINSTALDATE
					,T1.SETTLEMENTAMOUNT
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
				FROM SETTLEMENTSCHEDULE T1
			]]>
	</createView>
	</changeSet>

	<changeSet id="STLMT#41_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementschedule_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#42_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementschedule_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="STLMT#42" author="saikiran.n">
		<createView viewName="SETTLEMENTSCHEDULE_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					,T1.SETTLEMENTDETAILID
					,T1.SETTLEMENTINSTALDATE
					,T1.SETTLEMENTAMOUNT
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
				FROM SETTLEMENTSCHEDULE_TEMP T1
				UNION ALL
				SELECT T1.SETTLEMENTHEADERID
					,T1.SETTLEMENTDETAILID
					,T1.SETTLEMENTINSTALDATE
					,T1.SETTLEMENTAMOUNT
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
				FROM SETTLEMENTSCHEDULE T1
				WHERE NOT (EXISTS ( SELECT 1 FROM SETTLEMENTSCHEDULE_TEMP
				WHERE SETTLEMENTSCHEDULE_TEMP.SETTLEMENTDETAILID = T1.SETTLEMENTDETAILID))
			]]>
		</createView>
	</changeSet>

	<changeSet id="STLMT#42_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementschedule_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.40_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlementschedule_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.40" author="saikiran.n">
		<createView viewName="SETTLEMENTSCHEDULE_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.SETTLEMENTHEADERID
					,T1.SETTLEMENTDETAILID
					,T1.SETTLEMENTINSTALDATE
					,T1.SETTLEMENTAMOUNT
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
				FROM SETTLEMENTSCHEDULE_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="DE#267.40_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlementschedule_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.17" author="saikiran.n">
		<addColumn tableName="FINANCEMAIN">
			<column name="underSettlement" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="DE#267.18" author="saikiran.n">
		<addColumn tableName="FINANCEMAIN_TEMP">
			<column name="underSettlement" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="DE#267.19" author="saikiran.n">
		<sql>
			<![CDATA[
				UPDATE FINANCEMAIN_TEMP SET underSettlement=0 WHERE underSettlement IS NULL;
				UPDATE FINANCEMAIN SET underSettlement=0 WHERE underSettlement IS NULL;
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.20" author="saikiran.n" dbms="postgresql, oracle">
		<addDefaultValue columnName="underSettlement" tableName="FINANCEMAIN_TEMP" defaultValue="0" />
		<addDefaultValue columnName="underSettlement" tableName="FINANCEMAIN" defaultValue="0" />
	</changeSet>

	<changeSet id="DE#267.21" author="saikiran.n" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FINANCEMAIN_TEMP ADD CONSTRAINT DF_P_T_underSett DEFAULT 0 FOR underSettlement;
				ALTER TABLE FINANCEMAIN ADD CONSTRAINT DF_P_underSett DEFAULT 0 FOR underSettlement;
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.22_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'financemain_lview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.22" author="saikiran.n">
		<createView viewName="FINANCEMAIN_LVIEW" replaceIfExists="true">
			<![CDATA[
		 		SELECT T1.FINID
		 			, T1.FINREFERENCE
					, T1.INVESTMENTREF
					, T1.FINTYPE
					, T1.FINCCY
					, T1.FINAMOUNT
					, T1.DOWNPAYMENT
					, T1.FEECHARGEAMT
					, T1.SCHEDULEMETHOD
					, T1.NUMBEROFTERMS
					, T1.RECORDSTATUS
					, T1.RECORDTYPE
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.FINBRANCH
					, T1.FINCONTRACTDATE
					, T1.LINKEDFINREF
					, T1.NEXTUSERID
					, T1.PRIORITY
					, T1.WORKFLOWID
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.FINPREAPPROVEDREF
					, T1.RCDMAINTAINSTS
					, T1.FINCURRASSETVALUE
					, T1.CALTERMS
					, T1.DEVIATIONAPPROVAL
					, T1.FINPURPOSE
					, T1.INITIATEDATE
					, T1.FINASSETVALUE
					, T2.CUSTCIF LOVDESCCUSTCIF
					, T2.CUSTSHRTNAME LOVDESCCUSTSHRTNAME
					, T2.CUSTPASSPORTNO LOVDESCCUSTPASSPORTNO
					, T2.CUSTDOB LOVDESCCUSTDOB
					, T2.CUSTCRCPR LOVDESCCUSTCRCPR
					, T2.PHONENUMBER
					, T3.FINCATEGORY LOVDESCPRODUCTCODENAME
					, T3.FINDIVISION LOVDESCFINDIVISION
					, T3.PRODUCT LOVDESCFINPRODUCT
					, T3.FINTYPEDESC LOVDESCFINTYPENAME
					, COALESCE(T4.ROLEDESC, ${add.schema}FN_GET_ROLEDESC(T1.NEXTROLECODE)) LOVDESCREQUESTSTAGE
					, T1.SAMPLINGREQUIRED
					, T1.ADVANCEEMI
					, T1.ADVEMITERMS
					, T1.BPIPFTDAYSBASIS
					, T1.GRACETERMS
					, T1.PRODUCTCATEGORY
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T1.OFFERID
					, T1.APPLICATIONNO
					, T1.LASTMNTON
					, T1.VERSION
					, T1.TDSAPPLICABLE
					, T2.CUSTID
					, T1.INSTBASEDSCHD
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T5.DEALERNAME MANUFACTURERDEALERNAME
					, T5.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN_TEMP T1
				INNER JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
				INNER JOIN RMTFINANCETYPES T3 ON T3.FINTYPE = T1.FINTYPE
				LEFT JOIN SECROLES T4 ON T1.NEXTROLECODE= T4.ROLECD
				LEFT JOIN AMTVEHICLEDEALER T5 ON T1.MANUFACTURERDEALERID = T5.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
			]]>
		</createView>
	</changeSet>

	<changeSet id="DE#267.22_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_lview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.23_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'financemain_aview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.23" author="saikiran.n">
		<createView viewName="FINANCEMAIN_AVIEW" replaceIfExists="true">
			 <![CDATA[ 
				SELECT T1.FINID
					, T1.FINREFERENCE
			    	, T1.INVESTMENTREF
			    	, T1.NUMBEROFTERMS
			    	, T1.GRCPERIODENDDATE
			    	, T1.ALLOWGRCPERIOD
			    	, T1.GRACEBASERATE
			    	, T1.GRACESPECIALRATE
			    	, T1.GRCPFTRATE
			    	, T1.GRCPFTFRQ
			    	, T1.NEXTGRCPFTDATE
			    	, T1.ALLOWGRCPFTRVW
			    	, T1.GRCPFTRVWFRQ
			    	, T1.NEXTGRCPFTRVWDATE
			    	, T1.ALLOWGRCCPZ
			    	, T1.GRCCPZFRQ
			    	, T1.NEXTGRCCPZDATE
			    	, T1.REPAYBASERATE
			    	, T1.REPAYSPECIALRATE
			    	, T1.REPAYPROFITRATE
			    	, T1.REPAYFRQ
			    	, T1.NEXTREPAYDATE
			    	, T1.REPAYPFTFRQ
			    	, T1.NEXTREPAYPFTDATE
			    	, T1.ALLOWREPAYRVW
			    	, T1.REPAYRVWFRQ
			    	, T1.NEXTREPAYRVWDATE
			    	, T1.ALLOWREPAYCPZ
			    	, T1.REPAYCPZFRQ
			    	, T1.NEXTREPAYCPZDATE
			    	, T1.MATURITYDATE
			    	, T1.CPZATGRACEEND
			    	, T1.DOWNPAYMENT
			    	, T1.GRACEFLATAMOUNT
			    	, T1.REQREPAYAMOUNT
			    	, T1.TOTALPROFIT
			    	, T1.TOTALCPZ
			    	, T1.TOTALGROSSPFT
			    	, T1.TOTALGROSSGRCPFT
			    	, T1.TOTALGRACEPFT
			    	, T1.TOTALGRACECPZ
			    	, T1.GRCRATEBASIS
			    	, T1.REPAYRATEBASIS
			    	, T1.FINTYPE
			    	, T1.FINREMARKS
			    	, T1.FINCCY
			    	, T1.SCHEDULEMETHOD
			    	, T1.PROFITDAYSBASIS
			    	, T1.REQMATURITY
			    	, T1.CALTERMS
			    	, T1.CALMATURITY
			    	, T1.FIRSTREPAY
			    	, T1.LASTREPAY
			    	, T1.FINSTARTDATE
			    	, T1.FINAMOUNT
					, T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT LOVDESCFINANCINGAMOUNT
			    	, T1.FINREPAYMENTAMOUNT
			    	, T1.CUSTID
			   		, T1.DEFFERMENTS
			    	, T1.PLANDEFERCOUNT
			    	, T1.FINBRANCH
			    	, T1.FINSOURCEID
			    	, T1.ALLOWEDDEFRPYCHANGE
			    	, T1.AVAILEDDEFRPYCHANGE
			    	, T1.ALLOWEDDEFFRQCHANGE
			    	, T1.AVAILEDDEFFRQCHANGE
			    	, T1.RECALTYPE
			    	, T1.FINASSETVALUE
			    	, T1.FINISACTIVE
			    	, T1.LIMITVALID
			    	, T1.OVERRIDELIMIT
			    	, T1.VERSION
			    	, T1.LASTMNTBY
			    	, T1.LASTMNTON
			    	, T1.RECORDSTATUS
			    	, T1.ROLECODE
			    	, T1.NEXTROLECODE
			    	, T1.TASKID
			    	, T1.NEXTTASKID
			    	, T1.RECORDTYPE
			    	, T1.WORKFLOWID
					, T7.FINTYPEDESC LOVDESCFINTYPENAME
					, T7.FINMAXAMOUNT LOVDESCFINMAXAMT
					, T7.FINMINAMOUNT LOVDESCFINMINAMOUNT
			    	, T1.MINDOWNPAYPERC
					, T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT
					, T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ
					, T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT
					, T12.BRANCHDESC LOVDESCFINBRANCHNAME
					, T12.BRANCHPROVINCE FINBRANCHPROVINCECODE
			    	, T1.LASTREPAYDATE
			    	, T1.LASTREPAYPFTDATE
			    	, T1.LASTREPAYRVWDATE
			    	, T1.LASTREPAYCPZDATE
			    	, T1.ALLOWGRCREPAY
			    	, T1.GRCSCHDMTHD
			    	, T1.GRCMARGIN
			    	, T1.REPAYMARGIN
			    	, T1.FINCURRASSETVALUE
			    	, T1.FINCOMMITMENTREF
			    	, T1.FINLIMITREF
			    	, T1.FINCONTRACTDATE
					, T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD
			    	, T7.FINRVWRATEAPPLFOR
			    	, T1.TOTALREPAYAMT
			    	, T1.CLOSINGSTATUS
			    	, T1.FINAPPROVEDDATE
			    	, T1.FEECHARGEAMT
			    	, T1.BLACKLISTED
			    	, T1.FINREPAYPFTONFRQ
			    	, T1.ANUALIZEDPERCRATE
			    	, T1.EFFECTIVERATEOFRETURN
			    	, T1.MIGRATEDFINANCE
			    	, T1.SCHEDULEMAINTAINED
			    	, T1.SCHEDULEREGENERATED
			    	, T1.FINPURPOSE
					, T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME
			    	, T1.FINSTATUS
			    	, T1.FINSTSREASON
			    	, T1.INITIATEUSER
					, T7.FINSCHEDULEON LOVDESCFINSCHEDULEON
			    	, T1.CUSTDSR
			    	, T1.JOINTACCOUNT
			    	, T1.JOINTCUSTID
			    	, T1.DOWNPAYBANK
			    	, T1.DOWNPAYSUPL
			    	, T1.SECURITYCOLLATERAL
			    	, T1.APPROVED
			    	, T1.DISCREPANCY
			    	, T1.LIMITAPPROVED
			    	, T1.GRACETERMS
					, T7.FINDIVISION LOVDESCFINDIVISION
			    	, T1.RCDMAINTAINSTS
			    	, T1.FINREPAYMETHOD
			    	, T1.GRCPROFITDAYSBASIS
			    	, T1.STEPFINANCE
			    	, T1.STEPTYPE
				    , T1.STEPPOLICY
				    , T1.ALWMANUALSTEPS
				    , T1.NOOFSTEPS
				    , T1.LINKEDFINREF
				    , T1.NEXTUSERID
				    , T1.PRIORITY
					, T24.POLICYDESC LOVDESCSTEPPOLICYNAME
				    , T1.GRCMINRATE
				    , T1.GRCMAXRATE
				    , T1.RPYMINRATE
				    , T1.RPYMAXRATE
				    , T1.DEVIATIONAPPROVAL
				    , T1.MANUALSCHEDULE
				    , T1.CREDITINSAMT
				    , T27.CUSTSTSDESCRIPTION
				    , T1.INITIATEDATE
				    , T1.FINPREAPPROVEDREF
				    , T1.ACCOUNTSOFFICER
					, T28.DEALERNAME LOVDESCACCOUNTSOFFICER
					, T28.DEALERCITY LOVDESCSOURCECITY
				    , T1.DSACODE
					, T30.ROFFICERDESC DSACODEDESC
				    , T1.TDSAPPLICABLE
				    , T1.MANDATEID
				    , T1.DROPLINEFRQ
				    , T1.FIRSTDROPLINEDATE
				    , T1.PFTSERVICINGODLIMIT
				    , T1.ALWBPI
				    , T1.BPITREATMENT
				    , T1.PLANEMIHALW
				    , T1.PLANEMIHMETHOD
				    , T1.PLANEMIHMAXPERYEAR
				    , T1.PLANEMIHMAX
				    , T1.PLANEMIHLOCKPERIOD
				    , T1.PLANEMICPZ
				    , T1.CALROUNDINGMODE
				    , T1.ALWMULTIDISB
				    , T1.APPLICATIONNO
				    , T1.REFERRALID
					, T33.ROFFICERDESC REFERRALIDDESC
				    , T1.DMACODE
					, T34.ROFFICERDESC DMACODEDESC
				    , T1.SALESDEPARTMENT
					, T35.DEPTDESC SALESDEPARTMENTDESC
				    , T1.QUICKDISB
				    , T1.WIFREFERENCE
				    , T1.UNPLANEMIHLOCKPERIOD
				    , T1.UNPLANEMICPZ
				    , T1.REAGECPZ
				    , T1.MAXUNPLANNEDEMI
				    , T1.MAXREAGEHOLIDAYS
				    , T1.AVAILEDUNPLANEMI
				    , T1.AVAILEDREAGEH
				    , T1.BPIAMOUNT
				    , T1.DEDUCTFEEDISB
				    , T1.RVWRATEAPPLFOR
				    , T1.SCHCALONRVW
				    , T1.PASTDUEPFTCALMTHD
				    , T1.PASTDUEPFTMARGIN
				    , T1.DROPPINGMETHOD
				    , T1.RATECHGANYDAY
				    , T1.PROMOTIONCODE
				    , T1.RESTRUCTURELOAN
				    , T1.OLDFINREFERENCE
				    , T1.REAGEBUCKET
				    , T1.FINCATEGORY
				    , T1.PRODUCTCATEGORY
				    , T1.ROUNDINGTARGET
					, T36.ENTITYCODE LOVDESCENTITYCODE
				    , T1.ELIGIBILITYMETHOD
					, T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD
					, T38.VALUEDESC LOVDESCELIGIBILITYMETHOD
				    , T1.EMPLOYEENAME
					, T37.ROFFICERDESC EMPLOYEENAMEDESC
				    , T1.SAMPLINGREQUIRED
				    , T1.LEGALREQUIRED
				    , T1.GRCMAXAMOUNT
				    , T1.CONNECTOR
					, T40.DEALERNAME CONNECTORCODE
					, T40.DEALERCITY CONNECTORDESC
				    , T1.ADVANCEEMI
				    , T1.ADVEMITERMS
				    , T1.BPIPFTDAYSBASIS
				    , T1.FIXEDRATETENOR
				    , T1.FIXEDTENORRATE
					, T12.BRANCHTEL FINBRANCHCONTACT
				    , T1.PROCESSATTRIBUTES
				    , T1.BUSINESSVERTICAL
					, BV.CODE BUSINESSVERTICALCODE
					, BV.DESCRIPTION BUSINESSVERTICALDESC
				    , T1.GRCADVTYPE
				    , T1.GRCADVTERMS
				    , T1.ADVTYPE
				    , T1.ADVTERMS
				    , T1.ADVSTAGE
				    , T1.TDSPERCENTAGE
				    , T1.TDSSTARTDATE
				    , T1.TDSENDDATE
				    , T1.TDSLIMITAMT
				    , T1.VANREQ
				    , T1.VANCODE
				    , T1.ALLOWDRAWINGPOWER
				    , T1.ALLOWREVOLVING
				    , T1.SANBSDSCHDLE
				    , T1.PROMOTIONSEQID
				    , T1.SVAMOUNT
				    , T1.CBAMOUNT
				    , T1.APPLIEDLOANAMT
				    , T1.FINISRATERVWATGRCEND
				    , T1.PLANEMIHALWINGRACE
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T13.BRANCHDESC LOVDESCSOURCINGBRANCH
					, T1.ENDGRCPERIODAFTRFULLDISB
					, T1.AUTOINCGRCENDDATE
					, T1.ALWGRCADJ
					, T1.PMAY
					, T1.OFFERID
					, T1.ALWLOANSPLIT
					, T1.PARENTREF
					, T1.LOANSPLITTED
					, T1.INSTBASEDSCHD
					, C.CUSTCIF LOVDESCCUSTCIF
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T41.DEALERNAME MANUFACTURERDEALERNAME
					, T41.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T17.NOINST
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				INNER JOIN CUSTOMERS C ON C.CUSTID = T1.CUSTID
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
			]]>
		</createView>
	</changeSet>


	<changeSet id="DE#267.23_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.24_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.24" author="saikiran.n">
		<createView viewName="FINANCEMAIN_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.FINID
					, T1.FINREFERENCE
				    , T1.INVESTMENTREF
				    , T1.NUMBEROFTERMS
				    , T1.GRCPERIODENDDATE
				    , T1.ALLOWGRCPERIOD
				    , T1.GRACEBASERATE
				    , T1.GRACESPECIALRATE
				    , T1.GRCPFTRATE
				    , T1.GRCPFTFRQ
				    , T1.NEXTGRCPFTDATE
				    , T1.ALLOWGRCPFTRVW
				    , T1.GRCPFTRVWFRQ
				    , T1.NEXTGRCPFTRVWDATE
				    , T1.ALLOWGRCCPZ
				    , T1.GRCCPZFRQ
				    , T1.NEXTGRCCPZDATE
				    , T1.REPAYBASERATE
				    , T1.REPAYSPECIALRATE
				    , T1.REPAYPROFITRATE
				    , T1.REPAYFRQ
				    , T1.NEXTREPAYDATE
				    , T1.REPAYPFTFRQ
				    , T1.NEXTREPAYPFTDATE
				    , T1.ALLOWREPAYRVW
				    , T1.REPAYRVWFRQ
				    , T1.NEXTREPAYRVWDATE
				    , T1.ALLOWREPAYCPZ
				    , T1.REPAYCPZFRQ
				    , T1.NEXTREPAYCPZDATE
				    , T1.MATURITYDATE
				    , T1.CPZATGRACEEND
				    , T1.DOWNPAYMENT
				    , T1.GRACEFLATAMOUNT
				    , T1.REQREPAYAMOUNT
				    , T1.TOTALPROFIT
				    , T1.TOTALCPZ
				    , T1.TOTALGROSSPFT
				    , T1.TOTALGROSSGRCPFT
				    , T1.TOTALGRACEPFT
				    , T1.TOTALGRACECPZ
				    , T1.GRCRATEBASIS
				    , T1.REPAYRATEBASIS
				    , T1.FINTYPE
				    , T1.FINREMARKS
				    , T1.FINCCY
				    , T1.SCHEDULEMETHOD
				    , T1.PROFITDAYSBASIS
				    , T1.REQMATURITY
				    , T1.CALTERMS
				    , T1.CALMATURITY
				    , T1.FIRSTREPAY
				    , T1.LASTREPAY
				    , T1.FINSTARTDATE
				    , T1.FINAMOUNT
					, ((T1.FINAMOUNT + T1.FEECHARGEAMT) - T1.DOWNPAYMENT) LOVDESCFINANCINGAMOUNT
				    , T1.FINREPAYMENTAMOUNT
				    , T1.CUSTID
				    , T1.DEFFERMENTS
				    , T1.PLANDEFERCOUNT
				    , T1.FINBRANCH
				    , T1.FINSOURCEID
				    , T1.ALLOWEDDEFRPYCHANGE
				    , T1.AVAILEDDEFRPYCHANGE
				    , T1.ALLOWEDDEFFRQCHANGE
				    , T1.AVAILEDDEFFRQCHANGE
				    , T1.RECALTYPE
				    , T1.FINASSETVALUE
				    , T1.FINISACTIVE
				    , T1.LIMITVALID
				    , T1.OVERRIDELIMIT
				    , T1.VERSION
				    , T1.LASTMNTBY
				    , T1.LASTMNTON
				    , T1.RECORDSTATUS
				    , T1.ROLECODE
				    , T1.NEXTROLECODE
				    , T1.TASKID
				    , T1.NEXTTASKID
				    , T1.RECORDTYPE
				    , T1.WORKFLOWID
				    , T7.FINTYPEDESC LOVDESCFINTYPENAME
				    , T7.FINMAXAMOUNT LOVDESCFINMAXAMT
				    , T7.FINMINAMOUNT LOVDESCFINMINAMOUNT
				    , T1.MINDOWNPAYPERC
				    , T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT
				    , T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ
				    , T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT
				    , T12.BRANCHDESC LOVDESCFINBRANCHNAME
				    , T12.BRANCHPROVINCE FINBRANCHPROVINCECODE
				    , T1.LASTREPAYDATE
				    , T1.LASTREPAYPFTDATE
				    , T1.LASTREPAYRVWDATE
				    , T1.LASTREPAYCPZDATE
				    , T1.ALLOWGRCREPAY
				    , T1.GRCSCHDMTHD
				    , T1.GRCMARGIN
				    , T1.REPAYMARGIN
				    , T1.FINCURRASSETVALUE
				    , T1.FINCOMMITMENTREF
				    , T1.FINLIMITREF
				    , T1.FINCONTRACTDATE
				    , T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD
				    , T7.FINRVWRATEAPPLFOR
				    , T1.TOTALREPAYAMT
				    , T1.CLOSINGSTATUS
				    , T1.FINAPPROVEDDATE
				    , T1.FEECHARGEAMT
				    , T1.BLACKLISTED
				    , T1.FINREPAYPFTONFRQ
				    , T1.ANUALIZEDPERCRATE
				    , T1.EFFECTIVERATEOFRETURN
				    , T1.MIGRATEDFINANCE
				    , T1.SCHEDULEMAINTAINED
				    , T1.SCHEDULEREGENERATED
				    , T1.FINPURPOSE
				    , T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME
				    , T1.FINSTATUS
				    , T1.FINSTSREASON
				    , T1.INITIATEUSER
				    , T7.FINSCHEDULEON LOVDESCFINSCHEDULEON
				    , T1.CUSTDSR
				    , T1.JOINTACCOUNT
				    , T1.JOINTCUSTID
				    , T1.DOWNPAYBANK
				    , T1.DOWNPAYSUPL
				    , T1.SECURITYCOLLATERAL
				    , T1.APPROVED
				    , T1.DISCREPANCY
				    , T1.LIMITAPPROVED
				    , T1.GRACETERMS
				    , T7.FINDIVISION LOVDESCFINDIVISION
				    , T1.RCDMAINTAINSTS
				    , T1.FINREPAYMETHOD
				    , T1.GRCPROFITDAYSBASIS
				    , T1.STEPFINANCE
				    , T1.STEPTYPE
				    , T1.STEPPOLICY
				    , T1.ALWMANUALSTEPS
				    , T1.NOOFSTEPS
				    , T1.LINKEDFINREF
				    , T1.NEXTUSERID
				    , T1.PRIORITY
				    , T24.POLICYDESC LOVDESCSTEPPOLICYNAME
				    , T1.GRCMINRATE
				    , T1.GRCMAXRATE
				    , T1.RPYMINRATE
				    , T1.RPYMAXRATE
				    , T1.DEVIATIONAPPROVAL
				    , T1.MANUALSCHEDULE
				    , T1.CREDITINSAMT
				    , T27.CUSTSTSDESCRIPTION
				    , T1.INITIATEDATE
				    , T1.FINPREAPPROVEDREF
				    , T1.ACCOUNTSOFFICER
				    , T28.DEALERNAME LOVDESCACCOUNTSOFFICER
				    , T28.DEALERCITY LOVDESCSOURCECITY
				    , T1.DSACODE
				    , T30.ROFFICERDESC DSACODEDESC
				    , T1.TDSAPPLICABLE
				    , T1.MANDATEID
				    , T1.DROPLINEFRQ
				    , T1.FIRSTDROPLINEDATE
				    , T1.PFTSERVICINGODLIMIT
				    , T1.ALWBPI
				    , T1.BPITREATMENT
				    , T1.PLANEMIHALW
				    , T1.PLANEMIHMETHOD
				    , T1.PLANEMIHMAXPERYEAR
				    , T1.PLANEMIHMAX
				    , T1.PLANEMIHLOCKPERIOD
				    , T1.PLANEMICPZ
				    , T1.CALROUNDINGMODE
				    , T1.ALWMULTIDISB
				    , T1.APPLICATIONNO
				    , T1.REFERRALID
				    , T33.ROFFICERDESC REFERRALIDDESC
				    , T1.DMACODE
				    , T34.ROFFICERDESC DMACODEDESC
				    , T1.SALESDEPARTMENT
				    , T35.DEPTDESC SALESDEPARTMENTDESC
				    , T1.QUICKDISB
				    , T1.WIFREFERENCE
				    , T1.UNPLANEMIHLOCKPERIOD
				    , T1.UNPLANEMICPZ
				    , T1.REAGECPZ
				    , T1.MAXUNPLANNEDEMI
				    , T1.MAXREAGEHOLIDAYS
				    , T1.AVAILEDUNPLANEMI
				    , T1.AVAILEDREAGEH
				    , T1.BPIAMOUNT
				    , T1.DEDUCTFEEDISB
				    , T1.RVWRATEAPPLFOR
				    , T1.SCHCALONRVW
				    , T1.PASTDUEPFTCALMTHD
				    , T1.PASTDUEPFTMARGIN
				    , T1.DROPPINGMETHOD
				    , T1.RATECHGANYDAY
				    , T1.PROMOTIONCODE
				    , T1.RESTRUCTURELOAN
				    , T1.OLDFINREFERENCE
				    , T1.REAGEBUCKET
				    , T1.FINCATEGORY
				    , T1.PRODUCTCATEGORY
				    , T1.ROUNDINGTARGET
				    , T36.ENTITYCODE LOVDESCENTITYCODE
				    , T1.ELIGIBILITYMETHOD
				    , T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD
				    , T38.VALUEDESC LOVDESCELIGIBILITYMETHOD
				    , T1.EMPLOYEENAME
				    , T37.ROFFICERDESC EMPLOYEENAMEDESC
				    , T1.SAMPLINGREQUIRED
				    , T1.LEGALREQUIRED
				    , T1.GRCMAXAMOUNT
				    , T1.CONNECTOR
				    , T40.DEALERNAME CONNECTORCODE
				    , T40.DEALERCITY CONNECTORDESC
				    , T1.ADVANCEEMI
				    , T1.ADVEMITERMS
				    , T1.BPIPFTDAYSBASIS
				    , T1.FIXEDRATETENOR
				    , T1.FIXEDTENORRATE
				    , T12.BRANCHTEL FINBRANCHCONTACT
				    , T1.PROCESSATTRIBUTES
				    , T1.BUSINESSVERTICAL
				    , BV.CODE BUSINESSVERTICALCODE
				    , BV.DESCRIPTION BUSINESSVERTICALDESC
				    , T1.GRCADVTYPE
				    , T1.GRCADVTERMS
				    , T1.ADVTYPE
				    , T1.ADVTERMS
				    , T1.ADVSTAGE
				    , T1.TDSPERCENTAGE
				    , T1.TDSSTARTDATE
				    , T1.TDSENDDATE
				    , T1.TDSLIMITAMT
				    , T1.VANREQ
				    , T1.VANCODE
				    , T1.ALLOWDRAWINGPOWER
				    , T1.ALLOWREVOLVING
				    , T1.SANBSDSCHDLE
				    , T1.PROMOTIONSEQID
				    , T1.SVAMOUNT
				    , T1.CBAMOUNT
				    , T1.APPLIEDLOANAMT
				    , T1.FINISRATERVWATGRCEND
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T13.BRANCHDESC LOVDESCSOURCINGBRANCH
					, T1.OFFERID
					, T1.ALWGRCADJ
					, T1.ENDGRCPERIODAFTRFULLDISB
					, T1.AUTOINCGRCENDDATE
					, T1.PMAY
					, T1.ALWLOANSPLIT
					, T1.PARENTREF
					, T1.LOANSPLITTED
					, T1.INSTBASEDSCHD
					, T1.PLANEMIHALWINGRACE
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T41.DEALERNAME MANUFACTURERDEALERNAME
					, T41.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN_TEMP T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE  = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
				UNION ALL
				SELECT T1.FINID
					, T1.FINREFERENCE
				    , T1.INVESTMENTREF
				    , T1.NUMBEROFTERMS
				    , T1.GRCPERIODENDDATE
				    , T1.ALLOWGRCPERIOD
				    , T1.GRACEBASERATE
				    , T1.GRACESPECIALRATE
				    , T1.GRCPFTRATE
				    , T1.GRCPFTFRQ
				    , T1.NEXTGRCPFTDATE
				    , T1.ALLOWGRCPFTRVW
				    , T1.GRCPFTRVWFRQ
				    , T1.NEXTGRCPFTRVWDATE
				    , T1.ALLOWGRCCPZ
				    , T1.GRCCPZFRQ
				    , T1.NEXTGRCCPZDATE
				    , T1.REPAYBASERATE
				    , T1.REPAYSPECIALRATE
				    , T1.REPAYPROFITRATE
				    , T1.REPAYFRQ
				    , T1.NEXTREPAYDATE
				    , T1.REPAYPFTFRQ
				    , T1.NEXTREPAYPFTDATE
				    , T1.ALLOWREPAYRVW
				    , T1.REPAYRVWFRQ
				    , T1.NEXTREPAYRVWDATE
				    , T1.ALLOWREPAYCPZ
				    , T1.REPAYCPZFRQ
				    , T1.NEXTREPAYCPZDATE
				    , T1.MATURITYDATE
				    , T1.CPZATGRACEEND
				    , T1.DOWNPAYMENT
				    , T1.GRACEFLATAMOUNT
				    , T1.REQREPAYAMOUNT
				    , T1.TOTALPROFIT
				    , T1.TOTALCPZ
				    , T1.TOTALGROSSPFT
				    , T1.TOTALGROSSGRCPFT
				    , T1.TOTALGRACEPFT
				    , T1.TOTALGRACECPZ
				    , T1.GRCRATEBASIS
				    , T1.REPAYRATEBASIS
				    , T1.FINTYPE
				    , T1.FINREMARKS
				    , T1.FINCCY
				    , T1.SCHEDULEMETHOD
				    , T1.PROFITDAYSBASIS
				    , T1.REQMATURITY
				    , T1.CALTERMS
				    , T1.CALMATURITY
				    , T1.FIRSTREPAY
				    , T1.LASTREPAY
				    , T1.FINSTARTDATE
				    , T1.FINAMOUNT
					, ((T1.FINAMOUNT + T1.FEECHARGEAMT) - T1.DOWNPAYMENT) LOVDESCFINANCINGAMOUNT
				    , T1.FINREPAYMENTAMOUNT
				    , T1.CUSTID
				    , T1.DEFFERMENTS
				    , T1.PLANDEFERCOUNT
				    , T1.FINBRANCH
				    , T1.FINSOURCEID
				    , T1.ALLOWEDDEFRPYCHANGE
				    , T1.AVAILEDDEFRPYCHANGE
				    , T1.ALLOWEDDEFFRQCHANGE
				    , T1.AVAILEDDEFFRQCHANGE
				    , T1.RECALTYPE
				    , T1.FINASSETVALUE
				    , T1.FINISACTIVE
				    , T1.LIMITVALID
				    , T1.OVERRIDELIMIT
				    , T1.VERSION
				    , T1.LASTMNTBY
				    , T1.LASTMNTON
				    , T1.RECORDSTATUS
				    , T1.ROLECODE
				    , T1.NEXTROLECODE
				    , T1.TASKID
				    , T1.NEXTTASKID
				    , T1.RECORDTYPE
				    , T1.WORKFLOWID
				    , T7.FINTYPEDESC LOVDESCFINTYPENAME
				    , T7.FINMAXAMOUNT LOVDESCFINMAXAMT
				    , T7.FINMINAMOUNT LOVDESCFINMINAMOUNT
				    , T1.MINDOWNPAYPERC
				    , T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT
				    , T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ
				    , T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT
				    , T12.BRANCHDESC LOVDESCFINBRANCHNAME
				    , T12.BRANCHPROVINCE FINBRANCHPROVINCECODE
				    , T1.LASTREPAYDATE
				    , T1.LASTREPAYPFTDATE
				    , T1.LASTREPAYRVWDATE
				    , T1.LASTREPAYCPZDATE
				    , T1.ALLOWGRCREPAY
				    , T1.GRCSCHDMTHD
				    , T1.GRCMARGIN
				    , T1.REPAYMARGIN
				    , T1.FINCURRASSETVALUE
				    , T1.FINCOMMITMENTREF
				    , T1.FINLIMITREF
				    , T1.FINCONTRACTDATE
				    , T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD
				    , T7.FINRVWRATEAPPLFOR
				    , T1.TOTALREPAYAMT
				    , T1.CLOSINGSTATUS
				    , T1.FINAPPROVEDDATE
				    , T1.FEECHARGEAMT
				    , T1.BLACKLISTED
				    , T1.FINREPAYPFTONFRQ
				    , T1.ANUALIZEDPERCRATE
				    , T1.EFFECTIVERATEOFRETURN
				    , T1.MIGRATEDFINANCE
				    , T1.SCHEDULEMAINTAINED
				    , T1.SCHEDULEREGENERATED
				    , T1.FINPURPOSE
				    , T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME
				    , T1.FINSTATUS
				    , T1.FINSTSREASON
				    , T1.INITIATEUSER
				    , T7.FINSCHEDULEON LOVDESCFINSCHEDULEON
				    , T1.CUSTDSR
				    , T1.JOINTACCOUNT
				    , T1.JOINTCUSTID
				    , T1.DOWNPAYBANK
				    , T1.DOWNPAYSUPL
				    , T1.SECURITYCOLLATERAL
				    , T1.APPROVED
				    , T1.DISCREPANCY
				    , T1.LIMITAPPROVED
				    , T1.GRACETERMS
				    , T7.FINDIVISION LOVDESCFINDIVISION
				    , T1.RCDMAINTAINSTS
				    , T1.FINREPAYMETHOD
				    , T1.GRCPROFITDAYSBASIS
				    , T1.STEPFINANCE
				    , T1.STEPTYPE
				    , T1.STEPPOLICY
				    , T1.ALWMANUALSTEPS
				    , T1.NOOFSTEPS
				    , T1.LINKEDFINREF
				    , T1.NEXTUSERID
				    , T1.PRIORITY
				    , T24.POLICYDESC LOVDESCSTEPPOLICYNAME
				    , T1.GRCMINRATE
				    , T1.GRCMAXRATE
				    , T1.RPYMINRATE
				    , T1.RPYMAXRATE
				    , T1.DEVIATIONAPPROVAL
				    , T1.MANUALSCHEDULE
				    , T1.CREDITINSAMT
				    , T27.CUSTSTSDESCRIPTION
				    , T1.INITIATEDATE
				    , T1.FINPREAPPROVEDREF
				    , T1.ACCOUNTSOFFICER
				    , T28.DEALERNAME LOVDESCACCOUNTSOFFICER
				    , T28.DEALERCITY LOVDESCSOURCECITY
				    , T1.DSACODE
				    , T30.ROFFICERDESC DSACODEDESC
				    , T1.TDSAPPLICABLE
				    , T1.MANDATEID
				    , T1.DROPLINEFRQ
				    , T1.FIRSTDROPLINEDATE
				    , T1.PFTSERVICINGODLIMIT
				    , T1.ALWBPI
				    , T1.BPITREATMENT
				    , T1.PLANEMIHALW
				    , T1.PLANEMIHMETHOD
				    , T1.PLANEMIHMAXPERYEAR
				    , T1.PLANEMIHMAX
				    , T1.PLANEMIHLOCKPERIOD
				    , T1.PLANEMICPZ
				    , T1.CALROUNDINGMODE
				    , T1.ALWMULTIDISB
				    , T1.APPLICATIONNO
				    , T1.REFERRALID
				    , T33.ROFFICERDESC REFERRALIDDESC
				    , T1.DMACODE
				    , T34.ROFFICERDESC DMACODEDESC
				    , T1.SALESDEPARTMENT
				    , T35.DEPTDESC SALESDEPARTMENTDESC
				    , T1.QUICKDISB
				    , T1.WIFREFERENCE
				    , T1.UNPLANEMIHLOCKPERIOD
				    , T1.UNPLANEMICPZ
				    , T1.REAGECPZ
				    , T1.MAXUNPLANNEDEMI
				    , T1.MAXREAGEHOLIDAYS
				    , T1.AVAILEDUNPLANEMI
				    , T1.AVAILEDREAGEH
				    , T1.BPIAMOUNT
				    , T1.DEDUCTFEEDISB
				    , T1.RVWRATEAPPLFOR
				    , T1.SCHCALONRVW
				    , T1.PASTDUEPFTCALMTHD
				    , T1.PASTDUEPFTMARGIN
				    , T1.DROPPINGMETHOD
				    , T1.RATECHGANYDAY
				    , T1.PROMOTIONCODE
				    , T1.RESTRUCTURELOAN
				    , T1.OLDFINREFERENCE
				    , T1.REAGEBUCKET
				    , T1.FINCATEGORY
				    , T1.PRODUCTCATEGORY
				    , T1.ROUNDINGTARGET
				    , T36.ENTITYCODE LOVDESCENTITYCODE
				    , T1.ELIGIBILITYMETHOD
				    , T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD
				    , T38.VALUEDESC LOVDESCELIGIBILITYMETHOD
				    , T1.EMPLOYEENAME
				    , T37.ROFFICERDESC EMPLOYEENAMEDESC
				    , T1.SAMPLINGREQUIRED
				    , T1.LEGALREQUIRED
				    , T1.GRCMAXAMOUNT
				    , T1.CONNECTOR
				    , T40.DEALERNAME CONNECTORCODE
				    , T40.DEALERCITY CONNECTORDESC
				    , T1.ADVANCEEMI
				    , T1.ADVEMITERMS
				    , T1.BPIPFTDAYSBASIS
				    , T1.FIXEDRATETENOR
				    , T1.FIXEDTENORRATE
				    , T12.BRANCHTEL FINBRANCHCONTACT
				    , T1.PROCESSATTRIBUTES
				    , T1.BUSINESSVERTICAL
				    , BV.CODE BUSINESSVERTICALCODE
				    , BV.DESCRIPTION BUSINESSVERTICALDESC
				    , T1.GRCADVTYPE
				    , T1.GRCADVTERMS
				    , T1.ADVTYPE
				    , T1.ADVTERMS
				    , T1.ADVSTAGE
				    , T1.TDSPERCENTAGE
				    , T1.TDSSTARTDATE
				    , T1.TDSENDDATE
				    , T1.TDSLIMITAMT
				    , T1.VANREQ
				    , T1.VANCODE
				    , T1.ALLOWDRAWINGPOWER
				    , T1.ALLOWREVOLVING
				    , T1.SANBSDSCHDLE
				    , T1.PROMOTIONSEQID
				    , T1.SVAMOUNT
				    , T1.CBAMOUNT
				    , T1.APPLIEDLOANAMT
				    , T1.FINISRATERVWATGRCEND
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T13.BRANCHDESC LOVDESCSOURCINGBRANCH
					, T1.OFFERID
					, T1.ALWGRCADJ
					, T1.ENDGRCPERIODAFTRFULLDISB
					, T1.AUTOINCGRCENDDATE
					, T1.PMAY
					, T1.ALWLOANSPLIT
					, T1.PARENTREF
					, T1.LOANSPLITTED
					, T1.INSTBASEDSCHD
					, T1.PLANEMIHALWINGRACE
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T41.DEALERNAME MANUFACTURERDEALERNAME
					, T41.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE  = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
				WHERE NOT EXISTS (SELECT 1 FROM FINANCEMAIN_TEMP WHERE FINANCEMAIN_TEMP.FINID = T1.FINID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="DE#267.24_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.25_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.25" author="saikiran.n">
		<createView viewName="FINANCEMAIN_TVIEW" replaceIfExists="true">
		    <![CDATA[
				SELECT T1.FINID
					, T1.FINREFERENCE
					, T1.INVESTMENTREF
					, T1.NUMBEROFTERMS
					, T1.GRCPERIODENDDATE
					, T1.ALLOWGRCPERIOD
					, T1.GRACEBASERATE
					, T1.GRACESPECIALRATE
					, T1.GRCPFTRATE
					, T1.GRCPFTFRQ
					, T1.NEXTGRCPFTDATE
					, T1.ALLOWGRCPFTRVW
					, T1.GRCPFTRVWFRQ
					, T1.NEXTGRCPFTRVWDATE
					, T1.ALLOWGRCCPZ
					, T1.GRCCPZFRQ
					, T1.NEXTGRCCPZDATE
					, T1.REPAYBASERATE
					, T1.REPAYSPECIALRATE
					, T1.REPAYPROFITRATE
					, T1.REPAYFRQ
					, T1.NEXTREPAYDATE
					, T1.REPAYPFTFRQ
					, T1.NEXTREPAYPFTDATE
					, T1.ALLOWREPAYRVW
					, T1.REPAYRVWFRQ
					, T1.NEXTREPAYRVWDATE
					, T1.ALLOWREPAYCPZ
					, T1.REPAYCPZFRQ
					, T1.NEXTREPAYCPZDATE
					, T1.MATURITYDATE
					, T1.CPZATGRACEEND
					, T1.DOWNPAYMENT
					, T1.GRACEFLATAMOUNT
					, T1.REQREPAYAMOUNT
					, T1.TOTALPROFIT
					, T1.TOTALCPZ
					, T1.TOTALGROSSPFT
					, T1.TOTALGROSSGRCPFT
					, T1.TOTALGRACEPFT
					, T1.TOTALGRACECPZ
					, T1.GRCRATEBASIS
					, T1.REPAYRATEBASIS
					, T1.FINTYPE
					, T1.FINREMARKS
					, T1.FINCCY
					, T1.SCHEDULEMETHOD
					, T1.PROFITDAYSBASIS
					, T1.REQMATURITY
					, T1.CALTERMS
					, T1.CALMATURITY
					, T1.FIRSTREPAY
					, T1.LASTREPAY
					, T1.FINSTARTDATE
					, T1.FINAMOUNT
					, T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT LOVDESCFINANCINGAMOUNT
					, T1.FINREPAYMENTAMOUNT
					, T1.CUSTID
					, T1.DEFFERMENTS
					, T1.PLANDEFERCOUNT
					, T1.FINBRANCH
					, T1.FINSOURCEID
					, T1.ALLOWEDDEFRPYCHANGE
					, T1.AVAILEDDEFRPYCHANGE
					, T1.ALLOWEDDEFFRQCHANGE
					, T1.AVAILEDDEFFRQCHANGE
					, T1.RECALTYPE
					, T1.FINASSETVALUE
					, T1.FINISACTIVE
					, T1.LIMITVALID
					, T1.OVERRIDELIMIT
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T7.FINTYPEDESC LOVDESCFINTYPENAME
					, T7.FINMAXAMOUNT LOVDESCFINMAXAMT
					, T7.FINMINAMOUNT LOVDESCFINMINAMOUNT
					, T1.MINDOWNPAYPERC
					, T7.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT
					, T7.FINISDWPAYREQUIRED LOVDESCDWNPAYREQ
					, T7.FINMAXDIFFERMENT LOVDESCFINMAXDIFFERMENT
					, T12.BRANCHDESC LOVDESCFINBRANCHNAME
					, T12.BRANCHPROVINCE FINBRANCHPROVINCECODE
					, T1.LASTREPAYDATE
					, T1.LASTREPAYPFTDATE
					, T1.LASTREPAYRVWDATE
					, T1.LASTREPAYCPZDATE
					, T1.ALLOWGRCREPAY
					, T1.GRCSCHDMTHD
					, T1.GRCMARGIN
					, T1.REPAYMARGIN
					, T1.FINCURRASSETVALUE
					, T1.FINCOMMITMENTREF
					, T1.FINLIMITREF
					, T1.FINCONTRACTDATE
					, T17.ACRTILLLBD LOVDESCACCRUEDTILLLBD
					, T7.FINRVWRATEAPPLFOR
					, T1.TOTALREPAYAMT
					, T1.CLOSINGSTATUS
					, T1.FINAPPROVEDDATE
					, T1.FEECHARGEAMT
					, T1.BLACKLISTED
					, T1.FINREPAYPFTONFRQ
					, T1.ANUALIZEDPERCRATE
					, T1.EFFECTIVERATEOFRETURN
					, T1.MIGRATEDFINANCE
					, T1.SCHEDULEMAINTAINED
					, T1.SCHEDULEREGENERATED
					, T1.FINPURPOSE
					, T39.LOANPURPOSEDESC LOVDESCFINPURPOSENAME
					, T1.FINSTATUS
					, T1.FINSTSREASON
					, T1.INITIATEUSER
					, T7.FINSCHEDULEON LOVDESCFINSCHEDULEON
					, T1.CUSTDSR
					, T1.JOINTACCOUNT
					, T1.JOINTCUSTID
					, T1.DOWNPAYBANK
					, T1.DOWNPAYSUPL
					, T1.SECURITYCOLLATERAL
					, T1.APPROVED
					, T1.DISCREPANCY
					, T1.LIMITAPPROVED
					, T1.GRACETERMS
					, T7.FINDIVISION LOVDESCFINDIVISION
					, T1.RCDMAINTAINSTS
					, T1.FINREPAYMETHOD
					, T1.GRCPROFITDAYSBASIS
					, T1.STEPFINANCE
					, T1.STEPTYPE
					, T1.STEPPOLICY
					, T1.ALWMANUALSTEPS
					, T1.NOOFSTEPS
					, T1.LINKEDFINREF
					, T1.NEXTUSERID
					, T1.PRIORITY
					, T24.POLICYDESC LOVDESCSTEPPOLICYNAME
					, T1.GRCMINRATE
					, T1.GRCMAXRATE
					, T1.RPYMINRATE
					, T1.RPYMAXRATE
					, T1.DEVIATIONAPPROVAL
					, T1.MANUALSCHEDULE
					, T1.CREDITINSAMT
					, T27.CUSTSTSDESCRIPTION
					, T1.INITIATEDATE
					, T1.FINPREAPPROVEDREF
					, T1.ACCOUNTSOFFICER
					, T28.DEALERNAME LOVDESCACCOUNTSOFFICER
					, T28.DEALERCITY LOVDESCSOURCECITY
					, T1.DSACODE
					, T30.ROFFICERDESC DSACODEDESC
					, T1.TDSAPPLICABLE
					, T1.MANDATEID
					, T1.DROPLINEFRQ
					, T1.FIRSTDROPLINEDATE
					, T1.PFTSERVICINGODLIMIT
					, T1.ALWBPI
					, T1.BPITREATMENT
					, T1.PLANEMIHALW
					, T1.PLANEMIHMETHOD
					, T1.PLANEMIHMAXPERYEAR
					, T1.PLANEMIHMAX
					, T1.PLANEMIHLOCKPERIOD
					, T1.PLANEMICPZ
					, T1.CALROUNDINGMODE
					, T1.ALWMULTIDISB
					, T1.APPLICATIONNO
					, T1.REFERRALID
					, T33.ROFFICERDESC REFERRALIDDESC
					, T1.DMACODE
					, T34.ROFFICERDESC DMACODEDESC
					, T1.SALESDEPARTMENT
					, T35.DEPTDESC SALESDEPARTMENTDESC
					, T1.QUICKDISB
					, T1.WIFREFERENCE
					, T1.UNPLANEMIHLOCKPERIOD
					, T1.UNPLANEMICPZ
					, T1.REAGECPZ
					, T1.MAXUNPLANNEDEMI
					, T1.MAXREAGEHOLIDAYS
					, T1.AVAILEDUNPLANEMI
					, T1.AVAILEDREAGEH
					, T1.BPIAMOUNT
					, T1.DEDUCTFEEDISB
					, T1.RVWRATEAPPLFOR
					, T1.SCHCALONRVW
					, T1.PASTDUEPFTCALMTHD
					, T1.PASTDUEPFTMARGIN
					, T1.DROPPINGMETHOD
					, T1.RATECHGANYDAY
					, T1.PROMOTIONCODE
					, T1.RESTRUCTURELOAN
					, T1.OLDFINREFERENCE
					, T1.REAGEBUCKET
					, T1.FINCATEGORY
					, T1.PRODUCTCATEGORY
					, T1.ROUNDINGTARGET
					, T36.ENTITYCODE LOVDESCENTITYCODE
					, T1.ELIGIBILITYMETHOD
					, T38.FIELDCODEVALUE LOVELIGIBILITYMETHOD
					, T38.VALUEDESC LOVDESCELIGIBILITYMETHOD
					, T1.EMPLOYEENAME
					, T37.ROFFICERDESC EMPLOYEENAMEDESC
					, T1.SAMPLINGREQUIRED
					, T1.LEGALREQUIRED
					, T1.GRCMAXAMOUNT
					, T1.CONNECTOR
					, T40.DEALERNAME CONNECTORCODE
					, T40.DEALERCITY CONNECTORDESC
					, T1.ADVANCEEMI
					, T1.ADVEMITERMS
					, T1.BPIPFTDAYSBASIS
					, T1.FIXEDRATETENOR
					, T1.FIXEDTENORRATE
					, T12.BRANCHTEL FINBRANCHCONTACT
					, T1.PROCESSATTRIBUTES
					, T1.BUSINESSVERTICAL
					, BV.CODE BUSINESSVERTICALCODE
					, BV.DESCRIPTION BUSINESSVERTICALDESC
					, T1.GRCADVTYPE
					, T1.GRCADVTERMS
					, T1.ADVTYPE
					, T1.ADVTERMS
					, T1.ADVSTAGE
					, T1.TDSPERCENTAGE
					, T1.TDSSTARTDATE
					, T1.TDSENDDATE
					, T1.TDSLIMITAMT
					, T1.VANREQ
					, T1.VANCODE
					, T1.ALLOWDRAWINGPOWER
					, T1.ALLOWREVOLVING
					, T1.SANBSDSCHDLE
					, T1.PROMOTIONSEQID
					, T1.SVAMOUNT
					, T1.CBAMOUNT
					, T1.APPLIEDLOANAMT
					, T1.FINISRATERVWATGRCEND
					, T1.REQLOANAMT
					, T1.REQLOANTENOR
					, T1.FINOCRREQUIRED
					, T1.OFFERPRODUCT
					, T1.OFFERAMOUNT
					, T1.CUSTSEGMENTATION
					, T1.BASEPRODUCT
					, T1.PROCESSTYPE
					, T1.BUREAUTIMESERIES
					, T1.CAMPAIGNNAME
					, T1.EXISTINGLANREFNO
					, T1.LEADSOURCE
					, T1.POSOURCE
					, T1.RSA
					, T1.VERIFICATION
					, T1.SOURCINGBRANCH
					, T1.SOURCHANNELCATEGORY
					, T1.ASMNAME
					, T13.BRANCHDESC LOVDESCSOURCINGBRANCH
					, T1.OFFERID
					, T1.ENDGRCPERIODAFTRFULLDISB
					, T1.AUTOINCGRCENDDATE
					, T1.ALWGRCADJ
					, T1.PMAY
					, T1.ALWLOANSPLIT
					, T1.PARENTREF
					, T1.LOANSPLITTED
					, T1.INSTBASEDSCHD
					, T1.PLANEMIHALWINGRACE
					, T1.ALLOWSUBVENTION
					, T1.TDSTYPE
					, T1.WRITEOFFLOAN
					, T1.RESTRUCTURE
					, T1.CALCOFSTEPS
					, T1.STEPSAPPLIEDFOR
					, T1.NOOFGRCSTEPS
					, T1.SCHDVERSION
					, T1.SUBVENTIONFROM
					, T1.MANUFACTURERDEALERID
					, T41.DEALERNAME MANUFACTURERDEALERNAME
					, T41.CODE MANUFACTURERDEALERCODE
					, T1.ESCROW
					, T1.CUSTBANKID
					, CB.ACCOUNTNUMBER CUSTACCTNUMBER
					, CB.ACCOUNTHOLDERNAME CUSTACCTHOLDERNAME
					, T1.MANUALSCHDTYPE
					, T1.ISRA
					, T1.SANCTIONEDDATE
					, T1.OVERDRAFTTXNCHRGREQ
					, T1.OVERDRAFTCALCCHRG
					, T1.OVERDRAFTCHRGAMTORPERC
					, T1.OVERDRAFTCHRCALON
					, T1.UNDERSETTLEMENT
				FROM FINANCEMAIN_TEMP T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE  = T7.FINTYPE 
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH  = T12.BRANCHCODE 
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINID  = T1.FINID 
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY  = T24.POLICYCODE 
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS  = T27.CUSTSTSCODE 
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE  = T30.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID  = T33.ROFFICERCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE  = T34.ROFFICERCODE 
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT  = T35.DEPTCODE 
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION  = T36.DIVISIONCODE 
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME  = T37.ROFFICERCODE 
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE  = 'ELGMETHOD' 
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE  = T39.LOANPURPOSECODE 
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				LEFT JOIN AMTVEHICLEDEALER T41 ON T1.MANUFACTURERDEALERID = T41.DEALERID
				LEFT JOIN CUSTOMERBANKINFO CB ON T1.CUSTBANKID = CB.BANKID
			]]>
		</createView>
	</changeSet>


	<changeSet id="DE#267.25.1_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="DE#267.31" author="saikiran.n">
		<sql>
			<![CDATA[ 
				DELETE from SecRights where rightname='SettlementDialog_WaivedAmount';
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3, 'SettlementDialog_WaivedAmount','SettlementDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="SETT#0.1" author="saikiran.n">
		<sql> 
			<![CDATA[
				delete SecRights where RightName='SettlementDialog_CancelReasonCode';
				delete SecRights where RightName='SettlementDialog_CancelRemarks';
				
				Insert into SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) values ((select max(RightId)+1 from SecRights),3,'SettlementDialog_CancelReasonCode','SettlementDialog',0,1000,current_timestamp,'Approved',null,null,null,null,null,0);
				Insert into SECRIGHTS (RIGHTID,RIGHTTYPE,RIGHTNAME,PAGE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) values ((select max(RightId)+1 from SecRights),3,'SettlementDialog_CancelRemarks','SettlementDialog',0,1000,current_timestamp,'Approved',null,null,null,null,null,0);
			]]>
		</sql>
	</changeSet>

	<!-- Modifications happened -->

	<changeSet id="OTS#1" author="saikiran.n">
		<renameTable newTableName="FIN_SETTLEMENT_HEADER" oldTableName="FINSETTLEMENTHEADER" />
	</changeSet>

	<changeSet id="OTS#2" author="saikiran.n">
		<renameTable newTableName="FIN_SETTLEMENT_HEADER_TEMP" oldTableName="FINSETTLEMENTHEADER_TEMP" />
	</changeSet>

	<changeSet id="OTS#3" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTHEADERID" tableName="FIN_SETTLEMENT_HEADER" />
	</changeSet>

	<changeSet id="OTS#4" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTHEADERID"
			tableName="FIN_SETTLEMENT_HEADER_TEMP" />
	</changeSet>

	<changeSet id="OTS#5" author="saikiran.n" dbms="postgresql">
		<dropView viewName="FINSETTLEMENTHEADER_AVIEW" />
		<dropView viewName="FINSETTLEMENTHEADER_VIEW" />
		<dropView viewName="FINSETTLEMENTHEADER_TVIEW" />
	</changeSet>

	<changeSet id="OTS#6_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'fin_settlement_header_aview'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#6" author="saikiran.n">
		<createView viewName="FIN_SETTLEMENT_HEADER_AVIEW" replaceIfExists="true">
			 <![CDATA[ 
					SELECT T1.ID
						,T1.FINID
						,T1.FINREFERENCE
						,T1.SETTLEMENTTYPE
						,T1.SETTLEMENTSTATUS
						,T1.STARTDATE
						,T1.OTSDATE
						,T1.ENDDATE
						,T1.SETTLEMENTREASON
						,T1.SETTLEMENTAMOUNT
						,T1.NOOFGRACEDAYS
						,T1.SETTLEMENTENDAFTERGRACE
						,T1.VERSION
						,T1.LASTMNTBY
						,T1.LASTMNTON
						,T1.RECORDSTATUS
						,T1.ROLECODE
						,T1.NEXTROLECODE
						,T1.TASKID
						,T1.NEXTTASKID
						,T1.RECORDTYPE
						,T1.WORKFLOWID
						,T1.CANCELREASONCODE
						,T1.CANCELREMARKS
				FROM FIN_SETTLEMENT_HEADER T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#6_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fin_settlement_header_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#7_pre" author="saikiran.n" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'fin_settlement_header_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#7" author="saikiran.n">
		<createView viewName="FIN_SETTLEMENT_HEADER_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
						,T1.FINID
						,T1.FINREFERENCE
						,T1.SETTLEMENTTYPE
						,T1.SETTLEMENTSTATUS
						,T1.STARTDATE
						,T1.OTSDATE
						,T1.ENDDATE
						,T1.SETTLEMENTREASON
						,T1.SETTLEMENTAMOUNT
						,T1.NOOFGRACEDAYS
						,T1.SETTLEMENTENDAFTERGRACE
						,T1.VERSION
						,T1.LASTMNTBY
						,T1.LASTMNTON
						,T1.RECORDSTATUS
						,T1.ROLECODE
						,T1.NEXTROLECODE
						,T1.TASKID
						,T1.NEXTTASKID
						,T1.RECORDTYPE
						,T1.WORKFLOWID
						,T1.CANCELREASONCODE
						,T1.CANCELREMARKS
						,T2.SETTLEMENTCODE SETTLEMENTCODE
						,T1.SETTLEMENTREASONID,
						,T3.DESCRIPTION SETTLEMENTREASONDESC
						FROM FIN_SETTLEMENT_HEADER_TEMP T1
						LEFT JOIN SETTLEMENT_TYPES T2 ON T1.SETTLEMENTTYPE = T2.ID
				        LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
						UNION ALL 
						SELECT T1.ID
						,T1.FINID
						,T1.FINREFERENCE
						,T1.SETTLEMENTTYPE
						,T1.SETTLEMENTSTATUS
						,T1.STARTDATE
						,T1.OTSDATE
						,T1.ENDDATE
						,T1.SETTLEMENTREASON
						,T1.SETTLEMENTAMOUNT
						,T1.NOOFGRACEDAYS
						,T1.SETTLEMENTENDAFTERGRACE
						,T1.VERSION
						,T1.LASTMNTBY
						,T1.LASTMNTON
						,T1.RECORDSTATUS
						,T1.ROLECODE
						,T1.NEXTROLECODE
						,T1.TASKID
						,T1.NEXTTASKID
						,T1.RECORDTYPE
						,T1.WORKFLOWID
						,T1.CANCELREASONCODE
						,T1.CANCELREMARKS
						,T2.SETTLEMENTCODE SETTLEMENTCODE
						,T1.SETTLEMENTREASONID,
						,T3.DESCRIPTION SETTLEMENTREASONDESC
						FROM FIN_SETTLEMENT_HEADER T1
						LEFT JOIN SETTLEMENTTYPES T2 ON T1.SETTLEMENTTYPE = T2.ID
						LEFT JOIN REASONS T3 ON T1.SETTLEMENTREASONID = T3.ID
						WHERE NOT (EXISTS ( SELECT 1 FROM FIN_SETTLEMENT_HEADER_TEMP
						WHERE FIN_SETTLEMENT_HEADER_TEMP.ID = T1.ID))
			]]>
		</createView>
	</changeSet>


	<changeSet id="OTS#7_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fin_settlement_header_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#8_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fin_settlement_header_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#8" author="saikiran.n">
		<createView viewName="FIN_SETTLEMENT_HEADER_TVIEW" replaceIfExists="true">
		    <![CDATA[
				 SELECT T1.ID
					,T1.FINID
					,T1.FINREFERENCE
					,T1.SETTLEMENTTYPE
					,T1.SETTLEMENTSTATUS
					,T1.STARTDATE
					,T1.OTSDATE
					,T1.ENDDATE
					,T1.SETTLEMENTREASON
					,T1.SETTLEMENTAMOUNT
					,T1.NOOFGRACEDAYS
					,T1.SETTLEMENTENDAFTERGRACE
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
					,T1.CANCELREASONCODE
					,T1.CANCELREMARKS
				FROM FIN_SETTLEMENT_HEADER_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#8_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fin_settlement_header_tview');
			]]>
		</sql>
	</changeSet>


	<changeSet id="OTS#9" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_TYPES" oldTableName="SETTLEMENTTYPES" />
	</changeSet>

	<changeSet id="OTS#10" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_TYPES_TEMP" oldTableName="SETTLEMENTTYPES_TEMP" />
	</changeSet>

	<changeSet id="OTS#11" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTTYPEID" tableName="SETTLEMENT_TYPES" />
	</changeSet>

	<changeSet id="OTS#12" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTTYPEID" tableName="SETTLEMENT_TYPES_TEMP" />
	</changeSet>

	<changeSet id="OTS#13" author="saikiran.n" dbms="postgresql">
		<dropView viewName="SETTLEMENTTYPES_AVIEW" />
		<dropView viewName="SETTLEMENTTYPES_TVIEW" />
		<dropView viewName="SETTLEMENTTYPES_VIEW" />
	</changeSet>

	<changeSet id="OTS#14_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_types_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#14" author="saikiran.n">
		<createView viewName="SETTLEMENT_TYPES_AVIEW" replaceIfExists="true">
		<![CDATA[
		    SELECT T1.ID
				, T1.SETTLEMENTCODE
				, T1.SETTLEMENTDESC
				, T1.ALWGRACEPERIOD
				, T1.ACTIVE
				, T1.VERSION
				, T1.LASTMNTBY
				, T1.LASTMNTON
				, T1.RECORDSTATUS
				, T1.ROLECODE
				, T1.NEXTROLECODE
				, T1.TASKID
				, T1.NEXTTASKID
				, T1.RECORDTYPE
				, T1.WORKFLOWID
			FROM SETTLEMENT_TYPES T1
		]]>
	</createView>
	</changeSet>

	<changeSet id="OTS#14_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_types_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#15_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_types_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#15" author="saikiran.n">
		<createView viewName="SETTLEMENT_TYPES_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_TYPES_TEMP T1
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#15_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_types_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#16_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'settlement_types_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#16" author="saikiran.n">
		<createView viewName="SETTLEMENT_TYPES_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_TYPES_TEMP T1
				UNION ALL 
				SELECT T1.ID
					, T1.SETTLEMENTCODE
					, T1.SETTLEMENTDESC
					, T1.ALWGRACEPERIOD
					, T1.ACTIVE
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
				FROM SETTLEMENT_TYPES T1
				WHERE NOT (EXISTS ( SELECT 1 FROM SETTLEMENT_TYPES_TEMP
						WHERE SETTLEMENT_TYPES_TEMP.ID = T1.ID))
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#16_post" author="Shankar.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'settlement_types_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#17" author="saikiran.n">
		<sql> <![CDATA[ 
			DELETE from SecRights where rightname='SettlementDialog_WaivedAmount';
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3, 'SettlementDialog_WaivedAmount','SettlementDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#18" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_ALLOC_DTLS" oldTableName="SETTLEMENTALLOCATIONDTLS" />
	</changeSet>

	<changeSet id="OTS#19" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_ALLOC_DTLS_TEMP" oldTableName="SETTLEMENTALLOCATIONDTLS_TEMP" />
	</changeSet>

	<changeSet id="OTS#20" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="ALLOCATIONID" tableName="SETTLEMENT_ALLOC_DTLS" />
		<renameColumn newColumnName="HEADERID" oldColumnName="SETTLEMENTHEADERID"
			tableName="SETTLEMENT_ALLOC_DTLS" />
		<renameColumn newColumnName="ALLOCATIONID" oldColumnName="SETTLEMENTALLOCATIONID"
			tableName="SETTLEMENT_ALLOC_DTLS" />
	</changeSet>

	<changeSet id="OTS#21" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="ALLOCATIONID" tableName="SETTLEMENT_ALLOC_DTLS_TEMP" />
		<renameColumn newColumnName="ALLOCATIONID" oldColumnName="SETTLEMENTALLOCATIONID"
			tableName="SETTLEMENT_ALLOC_DTLS_TEMP" />
		<renameColumn newColumnName="HEADERID" oldColumnName="SETTLEMENTHEADERID"
			tableName="SETTLEMENT_ALLOC_DTLS_TEMP" />
	</changeSet>

	<changeSet id="OTS#22" author="saikiran.n" dbms="postgresql">
		<dropView viewName="settlementallocationdtls_aview" />
		<dropView viewName="settlementallocationdtls_view" />
	</changeSet>

	<changeSet id="OTS#23_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_allocation_dtls_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#23" author="saikiran.n">
		<createView viewName="SETTLEMENT_ALLOC_DTLS_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.HEADERID
					, T1.ALLOCATIONID
					, T1.ALLOCATIONTYPE
					, T1.ALLOCATIONTO
					, T1.PAIDAMOUNT
					, T1.WAIVEDAMOUNT
					, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
					, T1.PAIDGST
					, T1.WAIVEDREQAMOUNT
					, T1.WAIVERACCEPTED
					, T1.TOTALDUE
					, T1.WAIVEDGST
					, T1.TAXHEADERID
					, T1.TDSDUE
					, T1.TDSPAID
					, T1.TDSWAIVED
				FROM SETTLEMENT_ALLOC_DTLS T1
				LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE= 'FEE'
				LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
				LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
				LEFT JOIN FEETYPES T5 ON T4.FEETYPEID = T5.FEETYPEID
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#23_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_allocation_dtls_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#24_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_allocation_dtls_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#24" author="saikiran.n">
		<createView viewName="SETTLEMENT_ALLOC_DTLS_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					, T1.HEADERID
					, T1.ALLOCATIONID
					, T1.ALLOCATIONTYPE
					, T1.ALLOCATIONTO
					, T1.PAIDAMOUNT
					, T1.WAIVEDAMOUNT
					, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
					, T1.PAIDGST
					, T1.WAIVEDREQAMOUNT
					, T1.WAIVERACCEPTED
					, T1.TOTALDUE
					, T1.WAIVEDGST
					, T1.TAXHEADERID
					, T1.TDSDUE
					, T1.TDSPAID
					, T1.TDSWAIVED
				FROM SETTLEMENT_ALLOC_DTLS_TEMP T1
    			LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE = 'FEE'
     			LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
     			LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
    			LEFT JOIN FEETYPES T5 ON  T4.FEETYPEID = T5.FEETYPEID
				UNION ALL
				SELECT T1.ID
					, T1.HEADERID
					, T1.ALLOCATIONID
					, T1.ALLOCATIONTYPE
					, T1.ALLOCATIONTO
					, T1.PAIDAMOUNT
					, T1.WAIVEDAMOUNT
					, COALESCE(T3.FEETYPEDESC, T5.FEETYPEDESC) TYPEDESC
					, T1.PAIDGST
					, T1.WAIVEDREQAMOUNT
					, T1.WAIVERACCEPTED
					, T1.TOTALDUE
					, T1.WAIVEDGST
					, T1.TAXHEADERID
					, T1.TDSDUE
					, T1.TDSPAID
					, T1.TDSWAIVED
   				FROM SETTLEMENT_ALLOC_DTLS T1
     			LEFT JOIN FINFEEDETAIL T2 ON T1.ALLOCATIONTO = T2.FEEID AND T1.ALLOCATIONTYPE = 'FEE'
     			LEFT JOIN FEETYPES T3 ON T2.FEETYPEID = T3.FEETYPEID
     			LEFT JOIN MANUALADVISE T4 ON T1.ALLOCATIONTO = T4.ADVISEID AND T1.ALLOCATIONTYPE = 'MANADV'
   				LEFT JOIN FEETYPES T5 ON  T4.FEETYPEID = T5.FEETYPEID
				WHERE  NOT EXISTS (SELECT 1 FROM SETTLEMENT_ALLOC_DTLS_TEMP WHERE SETTLEMENT_ALLOC_DTLS_TEMP.ALLOCATIONID = T1.ALLOCATIONID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#24_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_allocation_dtls_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#25" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_SCHEDULE" oldTableName="SETTLEMENTSCHEDULE" />
	</changeSet>

	<changeSet id="OTS#26" author="saikiran.n">
		<renameTable newTableName="SETTLEMENT_SCHEDULE_TEMP" oldTableName="SETTLEMENTSCHEDULE_TEMP" />
	</changeSet>

	<changeSet id="OTS#27" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTDETAILID" tableName="SETTLEMENT_SCHEDULE" />
		<renameColumn newColumnName="HEADERID" oldColumnName="SETTLEMENTHEADERID" tableName="SETTLEMENT_SCHEDULE" />
	</changeSet>

	<changeSet id="OTS#28" author="saikiran.n">
		<renameColumn newColumnName="ID" oldColumnName="SETTLEMENTDETAILID" tableName="SETTLEMENT_SCHEDULE_TEMP" />
		<renameColumn newColumnName="HEADERID" oldColumnName="SETTLEMENTHEADERID"
			tableName="SETTLEMENT_SCHEDULE_TEMP" />
	</changeSet>

	<changeSet id="OTS#29" author="saikiran.n" dbms="postgresql">
		<dropView viewName="settlementschedule_aview" />
		<dropView viewName="settlementschedule_view" />
		<dropView viewName="settlementschedule_tview" />
	</changeSet>

	<changeSet id="OTS#29_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_schedule_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#29" author="saikiran.n">
		<createView viewName="SETTLEMENT_SCHEDULE_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					,T1.HEADERID
					,T1.SETTLEMENTINSTALDATE
					,T1.SETTLEMENTAMOUNT
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
				FROM SETTLEMENT_SCHEDULE T1
		]]>
	</createView>
	</changeSet>

	<changeSet id="OTS#29_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_schedule_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#30_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_schedule_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#30" author="saikiran.n">
		<createView viewName="SETTLEMENT_SCHEDULE_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					,T1.HEADERID
					,T1.SETTLEMENTINSTALDATE
					,T1.SETTLEMENTAMOUNT
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
				FROM SETTLEMENT_SCHEDULE_TEMP T1
				UNION ALL
				SELECT T1.ID
					,T1.HEADERID
					,T1.SETTLEMENTINSTALDATE
					,T1.SETTLEMENTAMOUNT
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
				FROM SETTLEMENT_SCHEDULE T1
				WHERE NOT (EXISTS ( SELECT 1 FROM SETTLEMENT_SCHEDULE_TEMP
				WHERE SETTLEMENT_SCHEDULE_TEMP.ID = T1.ID))
		]]>
	</createView>
	</changeSet>

	<changeSet id="OTS#30_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_schedule_view');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#31_pre" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'settlement_schedule_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#31" author="saikiran.n">
		<createView viewName="SETTLEMENT_SCHEDULE_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID
					,T1.HEADERID
					,T1.SETTLEMENTINSTALDATE
					,T1.SETTLEMENTAMOUNT
					,T1.VERSION
					,T1.LASTMNTBY
					,T1.LASTMNTON
					,T1.RECORDSTATUS
					,T1.ROLECODE
					,T1.NEXTROLECODE
					,T1.TASKID
					,T1.NEXTTASKID
					,T1.RECORDTYPE
					,T1.WORKFLOWID
				FROM SETTLEMENT_SCHEDULE_TEMP T1
		]]>
	</createView>
	</changeSet>

	<changeSet id="OTS#31_post" author="saikiran.n" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'settlement_schedule_tview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#211875_pre" author="Sravani.M" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fm_settlementview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="PSD#211875" author="saikiran.n">
		<createView viewName="FM_SETTLEMENTVIEW" replaceIfExists="true">
			<![CDATA[
			SELECT T1.FINID,
					T1.FINREFERENCE,
					T1.FINTYPE,
					T1.CUSTID,
					T1.CLOSINGSTATUS,
					T1.FINISACTIVE,
					T1.MATURITYDATE,
					T1.PRODUCTCATEGORY,
					T1.WRITEOFFLOAN,
					T1.CALCOFSTEPS,
					T1.STEPSAPPLIEDFOR,
					T1.NOOFGRCSTEPS,
					T1.SCHDVERSION,
					T1.SUBVENTIONFROM,
					T1.MANUFACTURERDEALERID,
					T1.ESCROW,
					T1.CUSTBANKID,
					T1.MANUALSCHDTYPE,
					T1.MANUALSCHEDULE,
					T1.SANCTIONEDDATE
					FROM FINANCEMAIN T1 
					WHERE T1.FINREFERENCE NOT IN (SELECT T2.REFERENCE FROM FINRECEIPTHEADER_TEMP T2) AND 
					T1.FINREFERENCE NOT IN (SELECT T3.FINREFERENCE FROM FEEWAIVERHEADER_TEMP T3) AND
					T1.FINREFERENCE NOT IN (SELECT T4.FINREFERENCE FROM FIN_SETTLEMENT_HEADER_TEMP T4)
			  
				]]>
		</createView>
	</changeSet>


	<changeSet id="PSD#211875_post" author="Sravani.M" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fm_settlementview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#32" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader">
			<column name="WMDetailId" type="bigint" />
			<column name="AlwCondWaiver" type="int" />
			<column name="waiverFullFillAmount" type="decimal(18,0)" />
			<column name="waiverFullFillDate" type="datetime" />

		</addColumn>
	</changeSet>

	<changeSet id="OTS#33" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader_Temp">
			<column name="WMDetailId" type="bigint" />
			<column name="AlwCondWaiver" type="int" />
			<column name="waiverFullFillAmount" type="decimal(18,0)" />
			<column name="waiverFullFillDate" type="datetime" />

		</addColumn>
	</changeSet>


	<changeSet id="OTS#32.1" author="Sravani.M" dbms="postgresql, oracle">
		<addDefaultValue columnName="AlwCondWaiver" defaultValue="0" tableName="FeeWaiverHeader" />
		<addDefaultValue columnName="waiverFullFillAmount" defaultValue="0" tableName="FeeWaiverHeader" />
	</changeSet>

	<changeSet id="OTS#33.1" author="Sravani.M" dbms="postgresql, oracle">
		<addDefaultValue columnName="AlwCondWaiver" defaultValue="0" tableName="FeeWaiverHeader_Temp" />
		<addDefaultValue columnName="waiverFullFillAmount" defaultValue="0" tableName="FeeWaiverHeader_Temp" />
	</changeSet>

	<changeSet id="OTS#32.2" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader_Temp">
			<column name="LinkedTranId" type="bigint" />
			<column name="Status" type="char(1)" />
		</addColumn>
	</changeSet>

	<changeSet id="OTS#33.2" author="Sravani.M">
		<addColumn tableName="FeeWaiverHeader">
			<column name="LinkedTranId" type="bigint" />
			<column name="Status" type="char(1)" />
		</addColumn>
	</changeSet>

	<changeSet id="OTS#33.3" author="Sravani" dbms="postgresql, oracle">
		<addDefaultValue columnName="LinkedTranId" tableName="FEEWAIVERHEADER_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="OTS#32.3" author="Sravani" dbms="postgresql, oracle">
		<addDefaultValue columnName="LinkedTranId" tableName="FEEWAIVERHEADER" defaultValue="0" />
	</changeSet>

	<changeSet id="OTS#34.1" author="Sravani.M">
		<sql>
			<![CDATA[
				UPDATE FeeWaiverHeader SET AlwCondWaiver=0 WHERE AlwCondWaiver IS NULL;
				UPDATE FeeWaiverHeader SET waiverFullFillAmount=0 WHERE waiverFullFillAmount IS NULL;
				UPDATE FeeWaiverHeader_Temp SET AlwCondWaiver=0 WHERE AlwCondWaiver IS NULL;
				UPDATE FeeWaiverHeader_Temp SET waiverFullFillAmount=0 WHERE waiverFullFillAmount IS NULL;
				UPDATE FEEWAIVERHEADER_TEMP SET LinkedTranId = 0 where LinkedTranId is null;
				UPDATE FEEWAIVERHEADER SET LinkedTranId = 0 where LinkedTranId is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#37.1" author="Sravani.M" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FeeWaiverHeader ADD DEFAULT 0 FOR AlwCondWaiver;
				ALTER TABLE FeeWaiverHeader ADD DEFAULT 0 FOR waiverFullFillAmount;
				ALTER TABLE FeeWaiverHeader_Temp ADD DEFAULT 0 FOR AlwCondWaiver;
				ALTER TABLE FeeWaiverHeader_Temp ADD DEFAULT 0 FOR waiverFullFillAmount;
				ALTER TABLE FEEWAIVERHEADER ADD CONSTRAINT DF_FEWAIVERHEADER_LnkdTrnId DEFAULT 0 FOR LinkedTranId;
				ALTER TABLE FEEWAIVERHEADER_TEMP ADD CONSTRAINT DF_FEWAIVERHEADER_T_LnkdTrnId DEFAULT 0 FOR LinkedTranId;
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#35.1_pre" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'feewaiverheader_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#35.1" author="saikiran.n">
		<createView viewName="FEEWAIVERHEADER_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.WAIVERID
					, FM.FINID
					, FM.FINREFERENCE
					, T1.EVENT
					, T1.REMARKS
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.POSTINGDATE
					, T1.VALUEDATE
					, T1.WMDETAILID
					, T1.ALWCONDWAIVER
					, T1.WAIVERFULLFILLDATE
					, T1.WAIVERFULLFILLAMOUNT
					, T1.STATUS
					, T1.LINKEDTRANID
				FROM FEEWAIVERHEADER_TEMP T1
				INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
				UNION ALL
				SELECT T1.WAIVERID
					, FM.FINID
					, FM.FINREFERENCE
					, T1.EVENT
					, T1.REMARKS
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.POSTINGDATE
					, T1.VALUEDATE
					, T1.WMDETAILID
					, T1.ALWCONDWAIVER
					, T1.WAIVERFULLFILLDATE
					, T1.WAIVERFULLFILLAMOUNT
					, T1.STATUS
					, T1.LINKEDTRANID
				FROM FEEWAIVERHEADER T1
				INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
				WHERE NOT EXISTS (SELECT 1 FROM FEEWAIVERHEADER_TEMP
					WHERE FEEWAIVERHEADER_TEMP.WAIVERID = T1.WAIVERID)
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#35.1_post" author="saikiran.n" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'feewaiverheader_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#36.1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'feewaiverheader_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="OTS#36.1" author="saikiran.n">
		<createView viewName="FEEWAIVERHEADER_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.WAIVERID
					, FM.FINID
					, FM.FINREFERENCE
					, T1.EVENT
					, T1.REMARKS
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T1.POSTINGDATE
					, T1.VALUEDATE
					, T1.WMDETAILID
					, T1.ALWCONDWAIVER
					, T1.WAIVERFULLFILLDATE
					, T1.WAIVERFULLFILLAMOUNT
					, T1.STATUS
					, T1.LINKEDTRANID
				FROM FEEWAIVERHEADER_TEMP T1
				INNER JOIN FINANCEMAIN FM ON FM.FINID = T1.FINID
			]]>
		</createView>
	</changeSet>

	<changeSet id="OTS#36.1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'feewaiverheader_tview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="AMO#1" author="Shankar">
		<sql>
   			<![CDATA[
                Insert Into BMTAMOUNTCODES (ALLOWEDEVENT,ALLOWEDRIA,AMOUNTCODE,AMOUNTCODEDESC,AMOUNTCODEISACTIVE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) values('EXTRF',0,'ae_toExcessAmt','Transfer To Excess','1',1,1000,to_date('02-09-20','DD-MM-RR'),'Approved',null,null,null,null,null,0);
                Insert Into BMTAMOUNTCODES (ALLOWEDEVENT,ALLOWEDRIA,AMOUNTCODE,AMOUNTCODEDESC,AMOUNTCODEISACTIVE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) values('EXTRF',0,'ae_toPolicy','Transfer To Policy Excess','1',1,1000,to_date('02-09-20','DD-MM-RR'),'Approved',null,null,null,null,null,0);
                Insert Into BMTAMOUNTCODES (ALLOWEDEVENT,ALLOWEDRIA,AMOUNTCODE,AMOUNTCODEDESC,AMOUNTCODEISACTIVE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) values ('EXTRF',0,'ae_toSettlement','Transfer To Settlement Excess','1',1,1000,to_date('02-09-20','DD-MM-RR'),'Approved',null,null,null,null,null,0);
                      
                Insert Into BMTAMOUNTCODES (ALLOWEDEVENT,ALLOWEDRIA,AMOUNTCODE,AMOUNTCODEDESC,AMOUNTCODEISACTIVE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) values('EXTRF',0,'EX_ReceiptAmount','Transfer FROM Excess','1',1,1000,to_date('02-09-20','DD-MM-RR'),'Approved',null,null,null,null,null,0);
                Insert Into BMTAMOUNTCODES (ALLOWEDEVENT,ALLOWEDRIA,AMOUNTCODE,AMOUNTCODEDESC,AMOUNTCODEISACTIVE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) values('EXTRF',0,'POLC_ReceiptAmount','Transfer FROM Policy Excess','1',1,1000,to_date('02-09-20','DD-MM-RR'),'Approved',null,null,null,null,null,0);
                Insert Into BMTAMOUNTCODES (ALLOWEDEVENT,ALLOWEDRIA,AMOUNTCODE,AMOUNTCODEDESC,AMOUNTCODEISACTIVE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID) values('EXTRF',0,'SETTLE_ReceiptAmount','Transfer FROM Settlement Excess','1',1,1000,to_date('02-09-20','DD-MM-RR'),'Approved',null,null,null,null,null,0);     		
         	  ]]>
		</sql>
	</changeSet>


</databaseChangeLog>