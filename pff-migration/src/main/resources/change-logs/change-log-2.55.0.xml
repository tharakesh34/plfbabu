<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />

	<changeSet id="01" author="Irfan">
		<sql>
			INSERT INTO ErrorDetails VALUES('60204','EN','E','Loan Cannot be Processed
			for Reversal of Payment. Loan is in In-Active
			State.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('60205','EN','E','Not allowed to
			Reverse the transaction, because of insufficient balance on
			Excess','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('60206','EN','E','Loan was maintained
			after this Repayment
			done.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('60207','EN','E','Log Entry Details
			are not correct. Please contact
			Adminstrator.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('60208','EN','E','No Receipt Found to
			Reverse the
			Transaction.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
		</sql>
	</changeSet>
	<changeSet id="02" author="manojkumar.p">
		<sql>
			UPDATE DATA_ENGINE_TABLE SET RECORDLENGTH = 16 WHERE ID IN
			(SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM
			DATA_ENGINE_CONFIG WHERE NAME = 'DISB_HDFC_IMPORT'));
			UPDATE
			DATA_ENGINE_TABLE SET RECORDLENGTH = 16 WHERE ID IN (SELECT ID FROM
			DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM
			DATA_ENGINE_CONFIG WHERE NAME = 'DISB_OTHER_IMPORT'));
		</sql>
	</changeSet>
	<changeSet id="03" author="manojkumar.p">
		<sql>
			UPDATE DATA_ENGINE_TABLE SET RECORDLENGTH = 16 WHERE ID IN
			(SELECT ID FROM DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM
			DATA_ENGINE_CONFIG WHERE NAME = 'DISB_HDFC_IMPORT'));
			UPDATE
			DATA_ENGINE_TABLE SET RECORDLENGTH = 3 WHERE ID IN (SELECT ID FROM
			DATA_ENGINE_TABLE WHERE CONFIGID IN (SELECT ID FROM
			DATA_ENGINE_CONFIG WHERE NAME = 'DISB_OTHER_IMPORT'));
		</sql>
	</changeSet>
	<changeSet id="04" author="pruthvi">
		<sql>
			update reportfilterfields set multiselectsearch='0'
			where reportid=(select reportid from reportconfiguration where
			menuitemcode='menu_Item_PaymentSchedule') and fieldid='2';
		</sql>
	</changeSet>

	<changeSet id="05" author="Madhubabu">
		<createView replaceIfExists="true" viewName="PresentmentDownload_View">
			     select EntityCode, MandateType, BankID, SCHDATE, Sum(PresentmentAmt) PresentmentAmt, Count(*) count from (
			select 1 EntityCode, MandateType, SUBSTR(MICR,4,3) BANKID, SCHDATE, PresentmentAmt 
			from PresentmentDetails T1 
			Inner Join Mandates T2 on T1.MandateID = T2.MandateID 
			Inner Join BankBranches T3 on T3.BankBranchID = T2.BankBranchID 
			where ExcludeReason = 0
			) t 
			group BY EntityCode, MandateType, BankID ,SCHDATE
		</createView>
	</changeSet>	
	
	<changeSet id="6" author="Siva">
		<createTable tableName="ManualAdviseMovements_Temp">
			<column name="MovementID" type="bigint">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="AdviseID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="MovementDate" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="MovementAmount" type="decimal(18,0)">
				<constraints nullable="false" />
			</column>
			<column name="PaidAmount" type="decimal(18,0)">
				<constraints nullable="false" />
			</column>
			<column name="WaivedAmount" type="decimal(18,0)">
				<constraints nullable="false" />
			</column>
			<column name="Status" type="char(1)" />
			<column name="ReceiptID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ReceiptSeqID" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	
	<changeSet id="7" author="Siva">
		<sql>
			DELETE FROM ManualAdviseMovements;
		</sql>
	</changeSet>

	<changeSet id="8" author="Siva">
		<addColumn tableName="ManualAdviseMovements">
			<column name="ReceiptID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ReceiptSeqID" type="bigint">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>
	<changeSet id="9.1" author="Siva" dbms="oracle">
	<sql>
	drop sequence SeqManualAdviseMovements;
	</sql>
	</changeSet>	
	
<changeSet id="9" author="Siva" dbms="oracle">	
   		<sql splitStatements="false">
     		 begin
              execute immediate 'CREATE SEQUENCE SeqManualAdviseMovements START WITH 1 INCREMENT BY 1 MAXVALUE 9223372036854775807 NOCYCLE';  
     		 end;  
     	 </sql>
 </changeSet>
 
 <changeSet id="10" author="Siva" dbms="postgresql">	
   		<sql splitStatements="false">
   			do $$
			 begin
   execute 'CREATE SEQUENCE SeqManualAdviseMovements START  1 INCREMENT BY 1 ';  
			 end;  
			$$;
	    </sql>
 </changeSet>
 
 	<changeSet id="11" author="Siva" dbms="mssql">
		<sql splitStatements="false">
			CREATE TABLE SeqManualAdviseMovements(
			SeqNo 				bigint IDENTITY(1,1) NOT NULL,
			Value 				int NOT NULL
			);	
		</sql>
	</changeSet>
	
	<changeSet id="12" author="Siva">
		<renameColumn columnDataType="bigint" newColumnName="ReceiptSeqID"
			oldColumnName="ReceiptID" tableName="FinExcessAmountReserve" />
	</changeSet>
	
	<changeSet id="13" author="Siva">
    	<sql>
    	
    		DELETE FROM finrepayinstruction_temp WHERE finreference IN (select FinReference from FinanceMain_Temp WHERE RcdMaintainSts = 'Receipt');
			DELETE FROM findisbursementdetails_temp WHERE finreference IN (select FinReference from FinanceMain_Temp WHERE RcdMaintainSts = 'Receipt');
			DELETE FROM finscheduledetails_temp WHERE finreference IN (select FinReference from FinanceMain_Temp WHERE RcdMaintainSts = 'Receipt');
			DELETE from FinanceMain_Temp WHERE RcdMaintainSts = 'Receipt';

	    	DELETE from FinExcessAmountReserve;
			UPDATE FinExcessAmount SET ReservedAmt = 0, UtilisedAmt = 0, BalanceAmt = Amount;
			DELETE FROM ManualAdviseMovements;
			DELETE FROM ManualAdviseMovements_Temp;
			DELETE FROM FinRepayScheduleDetail_Temp;
			DELETE FROM FinRepayScheduleDetail;
			DELETE FROM FinRepayHeader_Temp;
			DELETE FROM FinRepayHeader;
			DELETE FROM FinReceiptDetail_Temp;
			DELETE FROM FinReceiptDetail;
			DELETE FROM ReceiptAllocationDetail_Temp;
			DELETE FROM ReceiptAllocationDetail;
			DELETE FROM FinReceiptHeader_Temp;
			DELETE FROM FinReceiptHeader;
    	</sql>
	</changeSet>
	
	<changeSet id="14" author="Durgaprasad.g">
		<addColumn tableName="FINSCHEDULEDETAILS">
			<column name="PRESENTMENTID" type="bigint" />
		</addColumn>
	</changeSet>
	
	
				  
	<changeSet id="15" author="Durgaprasad g">
		<sql>
				DELETE FROM SMTPARAMETERS WHERE SYSPARMCODE = 'PRESENTMENT_RESPONSE_UPLOAD_FILEPATH';
              INSERT INTO SMTPARAMETERS  VALUES ('PRESENTMENT_RESPONSE_UPLOAD_FILEPATH', 'Presentment response file upload path.', 'String', '1', 'D:\Data-Engine\PFF\Bajaj','200', 0, NULL, NULL, 'Presentment response file upload path.', 1, 1000,CURRENT_TIMESTAMP, 'Approved',
              '','','','','',0);
		</sql>
	</changeSet> 
	
	<changeSet id="16" author="Durgaprasad G">
		<addColumn tableName="PRESENTMENTDETAILS">
			<column name="EcsReturn" type="varchar(20)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="17" author="Durgaprasad G">
		<addColumn tableName="PRESENTMENTHEADER">
			<column name="DBStatusId" type="bigint" />
		</addColumn>
	</changeSet>
	
	
	<changeSet id="18" author="Durgaprasad G">
		<addColumn tableName="PRESENTMENTDETAILS_TEMP">
			<column name="EcsReturn" type="varchar(20)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="19" author="Durgaprasad G">
		<addColumn tableName="PRESENTMENTHEADER_TEMP">
			<column name="DBStatusId" type="bigint" />
		</addColumn>
	</changeSet>
	
	<changeSet id="20" author="manojkumar.p">
		<dropTable tableName="DISBURSEMENT_REQUESTS"/>
	</changeSet>
	<changeSet id="21" author="manojkumar.p">
		<createTable tableName="DISBURSEMENT_REQUESTS">
			<column name="ID" type="NUMBER(19,0)" defaultValue="SEQ_DISBURSEMENT_REQUESTS.NEXTVAL">
					<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="BATCH_ID" type="NUMBER(19,0)"/>
			<column name="DISBURSEMENT_ID" type="NUMBER(19,0)">
				<constraints nullable="false" />
			</column>
			<column name="FINREFERENCE" 				type="VARCHAR(20)"/>
			<column name="DISBURSEMENT_AMOUNT" 			type="DECIMAL(18,0)"/>
			<column name="DISBURSEMENT_DATE" 			type="DATETIME"/>
			<column name="DRAWEE_LOCATION" 				type="VARCHAR(50)"/>
			<column name="PRINT_LOCATION" 				type="VARCHAR(50)"/>
			<column name="CUSTOMER_NAME" 				type="VARCHAR(200)"/>
			<column name="CUSTOMER_EMAIL" 				type="VARCHAR(200)"/>
			<column name ="BENFICIARY_BANK" 			type="VARCHAR(200)"/>
			<column name ="BENFICIARY_BRANCH" 			type="VARCHAR(200)"/>
			<column name ="BENFICIARY_BRANCH_STATE" 	type="VARCHAR(200)"/>
			<column name ="BENFICIARY_BRANCH_CITY" 		type="VARCHAR(200)"/>
			<column name ="MICR_CODE" 					type="VARCHAR(20)"/>
			<column name ="IFSC_CODE" 					type="VARCHAR(20)"/>
			<column name ="BENFICIARY_NAME" 			type="VARCHAR(200)"/>
			<column name ="BENFICIRY_EMAIL" 			type="VARCHAR(200)"/>
			<column name ="BENFICIRY_CITY" 				type="VARCHAR(200)"/>
			<column name ="BENFICIARY_ADDRESS1" 		type="VARCHAR(100)"/>
			<column name ="BENFICIARY_ADDRESS2" 		type="VARCHAR(100)"/>
			<column name ="BENFICIARY_ADDRESS3" 		type="VARCHAR(100)"/>
			<column name ="BENFICIARY_ADDRESS4" 		type="VARCHAR(100)"/>
			<column name ="BENFICIARY_ADDRESS5" 		type="VARCHAR(100)"/>
			<column name ="PAYMENT_DETAIL1" 			type="VARCHAR(100)"/>
			<column name ="PAYMENT_DETAIL2" 			type="VARCHAR(100)"/>
			<column name ="PAYMENT_DETAIL3" 			type="VARCHAR(100)"/>
			<column name ="PAYMENT_DETAIL4" 			type="VARCHAR(100)"/>
			<column name ="PAYMENT_DETAIL5" 			type="VARCHAR(100)"/>
			<column name ="PAYMENT_DETAIL6" 			type="VARCHAR(100)"/>
			<column name ="PAYMENT_DETAIL7" 			type="VARCHAR(100)"/>
			<column name="RESP_BATCH_ID" 				type="NUMBER(19,0)"/>
			<column name="TRANSACTIONREF" 				type="VARCHAR(50)"/>
			<column name="CHEQUE_NUMBER" 				type="VARCHAR(50)"/>
			<column name="PAYMENT_DATE" 				type="DATETIME"/>
			<column name ="STATUS" 						type="VARCHAR(50)"/>
			<column name ="REMARKS" 					type="VARCHAR(500)"/>
			<column name ="REJECT_REASON" 				type="VARCHAR(100)"/>
		</createTable>
	</changeSet>
	
	<changeSet id="22" author="manojkumar.p">
		<dropTable tableName="DISBURSEMENT_REQUESTS"/>
	</changeSet>
	
	<changeSet id="23" author="manojkumar.p">
		<createTable tableName="DISBURSEMENT_REQUESTS">
			<column name="ID" type="NUMBER(19,0)" defaultValue="SEQ_DISBURSEMENT_REQUESTS.NEXTVAL">
					<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="BATCH_ID" type="NUMBER(19,0)"/>
			<column name="DISBURSEMENT_ID" type="NUMBER(19,0)">
				<constraints nullable="false" />
			</column>
			<column name="CUSTCIF" 						type="VARCHAR(20)"/>
			<column name="FINREFERENCE" 				type="VARCHAR(20)"/>
			<column name="DISBURSEMENT_AMOUNT" 			type="VARCHAR(200)"/>
			<column name="DISBURSEMENT_TYPE" 			type="VARCHAR(8)"/>
			<column name="DISBURSEMENT_DATE" 			type="DATETIME"/>
			<column name="DRAWEE_LOCATION" 				type="VARCHAR(50)"/>
			<column name="PRINT_LOCATION" 				type="VARCHAR(50)"/>
			<column name="CUSTOMER_NAME" 				type="VARCHAR(200)"/>
			<column name="CUSTOMER_MOBILE" 				type="VARCHAR(100)"/>
			<column name="CUSTOMER_EMAIL" 				type="VARCHAR(200)"/>
			<column name="CUSTOMER_STATE" 				type="VARCHAR(200)"/>
			<column name="CUSTOMER_CITY" 				type="VARCHAR(200)"/>
			<column name="CUSTOMER_ADDRESS1" 			type="VARCHAR(100)"/>
			<column name="CUSTOMER_ADDRESS2" 			type="VARCHAR(100)"/>
			<column name="CUSTOMER_ADDRESS3" 			type="VARCHAR(100)"/>
			<column name="CUSTOMER_ADDRESS4" 			type="VARCHAR(100)"/>
			<column name="CUSTOMER_ADDRESS5" 			type="VARCHAR(100)"/>
			<column name="BENFICIARY_BANK" 				type="VARCHAR(200)"/>
			<column name="BENFICIARY_BRANCH" 			type="VARCHAR(200)"/>
			<column name="BENFICIARY_BRANCH_STATE" 		type="VARCHAR(200)"/>
			<column name="BENFICIARY_BRANCH_CITY" 		type="VARCHAR(200)"/>
			<column name="MICR_CODE" 					type="VARCHAR(20)"/>
			<column name="IFSC_CODE" 					type="VARCHAR(20)"/>
			<column name="BENFICIARY_ACCOUNT" 			type="VARCHAR(50)"/>
			<column name="BENFICIARY_NAME" 				type="VARCHAR(200)"/>
			<column name="BENFICIARY_MOBILE" 			type="VARCHAR(100)"/>
			<column name="BENFICIRY_EMAIL" 				type="VARCHAR(200)"/>
			<column name="BENFICIRY_STATE" 				type="VARCHAR(200)"/>
			<column name="BENFICIRY_CITY" 				type="VARCHAR(200)"/>
			<column name="BENFICIARY_ADDRESS1" 			type="VARCHAR(100)"/>
			<column name="BENFICIARY_ADDRESS2" 			type="VARCHAR(100)"/>
			<column name="BENFICIARY_ADDRESS3" 			type="VARCHAR(100)"/>
			<column name="BENFICIARY_ADDRESS4" 			type="VARCHAR(100)"/>
			<column name="BENFICIARY_ADDRESS5" 			type="VARCHAR(100)"/>
			<column name="PAYMENT_DETAIL1" 				type="VARCHAR(100)"/>
			<column name="PAYMENT_DETAIL2" 				type="VARCHAR(100)"/>
			<column name="PAYMENT_DETAIL3" 				type="VARCHAR(100)"/>
			<column name="PAYMENT_DETAIL4" 				type="VARCHAR(100)"/>
			<column name="PAYMENT_DETAIL5" 				type="VARCHAR(100)"/>
			<column name="PAYMENT_DETAIL6" 				type="VARCHAR(100)"/>
			<column name="PAYMENT_DETAIL7" 				type="VARCHAR(100)"/>
			<column name="RESP_BATCH_ID" 				type="NUMBER(19,0)"/>
			<column name="TRANSACTIONREF" 				type="VARCHAR(50)"/>
			<column name="CHEQUE_NUMBER" 				type="VARCHAR(50)"/>
			<column name="DD_CHEQUE_CHARGE" 			type="VARCHAR(200)"/>
			<column name="PAYMENT_DATE" 				type="DATETIME"/>
			<column name="STATUS" 						type="VARCHAR(50)"/>
			<column name="REMARKS" 						type="VARCHAR(500)"/>
			<column name="REJECT_REASON" 				type="VARCHAR(100)"/>
		</createTable>
	</changeSet>
	
	<changeSet id="24" author="manojkumar.p">
		<createView viewName="INT_DISBURSEMENT_REQUEST_VIEW" replaceIfExists="true">
				SELECT   
		      FA. PAYMENTID,
		      FA.FINREFERENCE,
		      CASE WHEN FA.PAYMENTTYPE = 'NEFT' THEN 'N' WHEN FA.PAYMENTTYPE = 'RTGS' THEN 'R' WHEN FA.PAYMENTTYPE = 'DD' THEN 'D' WHEN FA.PAYMENTTYPE = 'CHEQUE' THEN 'C' ELSE  FA.PAYMENTTYPE END  DISBURSEMENT_TYPE,
		      FA.AMTTOBERELEASED/CCY.CCYMINORCCYUNITS  AMTTOBERELEASED,
		      FA.DISBDATE,
		      FA.PAYABLELOC,
		      FA.PRINTINGLOC,
		      CU.CUSTCIF,            
		      CU.CUSTSHRTNAME,     
		      CM.PHONECOUNTRYCODE||CM.PHONEAREACODE||CM.PHONENUMBER AS CUSTOMER_MOBILE,
		      CE.CUSTEMAIL       CUSTOMER_EMAIL,
		      CS.CPPROVINCENAME  CUSTOMER_STATE,
		      CC.PCCITYNAME      CUSTOMER_CITY,
		      ''                 CUSTOMER_ADDRESS1,
		      ''                 CUSTOMER_ADDRESS2,
		      ''                 CUSTOMER_ADDRESS3,
		      ''                 CUSTOMER_ADDRESS4,
		      ''                 CUSTOMER_ADDRESS5,
		      BD.BANKNAME,
          BB.BRANCHCODE,
		      BB.BRANCHDESC,
		      BBRS.CPPROVINCENAME  BENFICIARY_BRANCH_STATE,
		      BBRC.PCCITYNAME      BENFICIARY_BRANCH_CITY,
		      BB.MICR             MICR_CODE,
		      BB.IFSC             IFSC_CODE,
		      FA.BENEFICIARYACCNO,
		      FA.BENEFICIARYNAME,
		      FA.PHONECOUNTRYCODE||FA.PHONEAREACODE||FA.PHONENUMBER AS BENEFICIARY_MOBILE,
		      BCE.CUSTEMAIL        BENFICIRY_EMAIL,
		      BRS.CPPROVINCENAME  BENFICIARY_STATE,
		      BRC.PCCITYNAME      BENFICIARY_CITY,
		      ''                  BENFICIARY_ADDRESS1,
		      ''                  BENFICIARY_ADDRESS2,
		      ''                  BENFICIARY_ADDRESS3,
		      ''                  BENFICIARY_ADDRESS4,
		      ''                  BENFICIARY_ADDRESS5,
		      ''				          PAYMENT_DETAIL1,
		      ''                  PAYMENT_DETAIL2,
		      ''                  PAYMENT_DETAIL3,
		      ''                  PAYMENT_DETAIL4,
		      ''                  PAYMENT_DETAIL5,
		      ''                  PAYMENT_DETAIL6,
		      ''                  PAYMENT_DETAIL7,     
		      FA.STATUS           STATUS,
		      FA.DESCRIPTION      REMARKS,
          FA.PAYMENTTYPE      PAYMENTTYPE,
          FM.FINTYPE,
          PB.PARTNERBANKID,
          PB.PARTNERBANKCODE,
          FA.INPUTDATE
		      FROM FINADVANCEPAYMENTS FA
		      INNER JOIN FINANCEMAIN FM ON FM.FINREFERENCE = FA.FINREFERENCE
		      INNER JOIN CUSTOMERS CU ON CU.CUSTID = FM.CUSTID
		      INNER JOIN RMTCURRENCIES CCY ON CCY.CCYCODE = FA.DISBCCY
          INNER JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = FA.PARTNERBANKID
		      LEFT JOIN CUSTOMEREMAILS CE ON CE.CUSTID = CU.CUSTID AND CE.CUSTEMAILPRIORITY = 3
		      LEFT JOIN CUSTOMERADDRESSES CA ON CA.CUSTID = CE.CUSTID AND CA.CUSTADDRPRIORITY = 5
		      LEFT JOIN RMTPROVINCEVSCITY CC ON CC.PCCITY = CA.CUSTADDRCITY
		      LEFT JOIN RMTCOUNTRYVSPROVINCE CS ON CS.CPPROVINCE = CC.PCPROVINCE
		      LEFT JOIN CUSTOMERPHONENUMBERS CM ON CM.PHONECUSTID = CU.CUSTID AND CM.PHONETYPECODE = 'MOBILE1' AND CM.PHONETYPEPRIORITY = 5  
		      LEFT JOIN BANKBRANCHES BB ON BB.BANKBRANCHID = FA.BANKBRANCHID
		      LEFT JOIN BMTBANKDETAIL BD ON BD.BANKCODE = BB.BANKCODE
		      LEFT JOIN RMTPROVINCEVSCITY BBRC ON BBRC.PCCITY = BB.CITY
			    LEFT JOIN RMTCOUNTRYVSPROVINCE BBRS ON BBRS.CPPROVINCE = BBRC.PCPROVINCE
		      LEFT JOIN BENEFICIARY BR ON BR.BANKBRANCHID = FA.BANKBRANCHID AND BR.ACCNUMBER = FA.BENEFICIARYACCNO
		      LEFT JOIN CUSTOMERS BC ON BC.CUSTID = BR.CUSTID
		      LEFT JOIN CUSTOMEREMAILS BCE ON BCE.CUSTID = CU.CUSTID AND BCE.CUSTEMAILPRIORITY = 3
		      LEFT JOIN CUSTOMERADDRESSES BRCA ON BRCA.CUSTID = BR.CUSTID AND BRCA.CUSTADDRPRIORITY = 5
		      LEFT JOIN RMTPROVINCEVSCITY BRC ON BRC.PCCITY = BRCA.CUSTADDRCITY
		      LEFT JOIN RMTCOUNTRYVSPROVINCE BRS ON BRS.CPPROVINCE = BRC.PCPROVINCE
		      WHERE STATUS='APPROVED' AND PAYMENTID NOT IN (SELECT DISBURSEMENT_ID FROM DISBURSEMENT_REQUESTS)
		</createView>
	</changeSet>
	
</databaseChangeLog>