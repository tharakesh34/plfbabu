<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="add.schema" value=" " dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />
	
	 <changeSet id="pre_run_for_pgp" author="Jayant" runAlways="true"
		dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>
	<changeSet id="1" author="Akhilesh.k">
		<createTable tableName="Cibil_Member_Details">
			<column name="Code" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="Bureau_Type" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Name" type="varchar(50)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Short_Name" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Id" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Previous_Member_Id" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Password" type="varchar(1000)">
				<constraints nullable="false" />
			</column>
			<column name="File_Path" type="varchar(100)">
				<constraints nullable="false" />
			</column>
			<column name="Delimiter" type="varchar(1)" />
		</createTable>
	</changeSet>

	<changeSet id="2" author="Akhilesh.k">
		<addPrimaryKey tableName="Cibil_Member_Details" columnNames="Code, Bureau_Type" />
	</changeSet>

	<changeSet id="3" author="Akhilesh.k">
		<addUniqueConstraint tableName="Cibil_Member_Details" columnNames="Bureau_Type" />
	</changeSet>

	<changeSet id="4" author="Akhilesh.k">
		<addColumn tableName="CIBIL_FILE_INFO">
			<column name="Bureau_Type" type="varchar(10)" />
		</addColumn>
	</changeSet>

	<changeSet id="5" author="Akhilesh.k">
		<addColumn tableName="CIBIL_CUSTOMER_EXTRACT">
			<column name="Bureau_Type" type="varchar(10)" />
		</addColumn>
	</changeSet>

	<changeSet id="6" author="Akhilesh.k">
		<sql>
			<![CDATA[
				update CIBIL_FILE_INFO set Bureau_Type = 'RETAIL';
				update CIBIL_CUSTOMER_EXTRACT set Bureau_Type = 'RETAIL';
			]]>
		</sql>
	</changeSet>

	<changeSet id="6.1" author="Akhilesh.k" dbms="oracle,postgresql">
		<addNotNullConstraint tableName="CIBIL_FILE_INFO" columnName="Bureau_Type" />
		<addNotNullConstraint tableName="CIBIL_CUSTOMER_EXTRACT" columnName="Bureau_Type" />
	</changeSet>
	<changeSet id="6.1" author="Akhilesh.k" dbms="mssql">
		<addNotNullConstraint tableName="CIBIL_FILE_INFO" columnName="Bureau_Type" columnDataType="varchar(10)"/>
		<addNotNullConstraint tableName="CIBIL_CUSTOMER_EXTRACT" columnName="Bureau_Type" columnDataType="varchar(10)"/>
	</changeSet>
	<changeSet id="7" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="CIBIL_LEGAL_CONST_MAPPING" remarks="Legal Constitution">
			<column name="Code" type="char(2)">
				<constraints nullable="false" />
			</column>
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="CustType" type="VARCHAR2(8)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="7" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="CIBIL_LEGAL_CONST_MAPPING" remarks="Legal Constitution">
			<column name="Code" type="char(2)">
				<constraints nullable="false" />
			</column>
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="CustType" type="VARCHAR2(8)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="7_Post" author="Akhilesh.k" dbms="mssql">
	<sql>
		alter table CIBIL_LEGAL_CONST_MAPPING add constraint DF_CIB_LEG_CONS_MAP_VERSION DEFAULT 0 for version;
	</sql>
	</changeSet>
	<changeSet id="7.1" author="Akhilesh.k">
		<addPrimaryKey columnNames="Code, CustType" constraintName="PK_CB_LC_CD_CT" tableName="CIBIL_LEGAL_CONST_MAPPING" />
	</changeSet>

	<changeSet id="8" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="CIBIL_BUSINESS_CATEGOR_MAPPING">
			<column name="Code" type="char(2)">
				<constraints nullable="false" />
			</column>
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Category" type="VARCHAR2(8)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="8" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="CIBIL_BUSINESS_CATEGOR_MAPPING">
			<column name="Code" type="char(2)">
				<constraints nullable="false" />
			</column>
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Category" type="VARCHAR2(8)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="8_Post" author="Akhilesh.k" dbms="mssql">
	<sql>
		alter table CIBIL_BUSINESS_CATEGOR_MAPPING add constraint DF_CIB_BIS_CAT_MAP_VERSION DEFAULT 0 for version;
	</sql>
	</changeSet>
	<changeSet id="8.1" author="Akhilesh.k">
		<addPrimaryKey columnNames="Code, Category" constraintName="PK_CB_BC_CD_C" tableName="CIBIL_BUSINESS_CATEGOR_MAPPING" />
	</changeSet>

	<changeSet id="9" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="CIBIL_INDUSTRY_TYPE_MAPPING">
			<column name="Code" type="char(2)">
				<constraints nullable="false" />
			</column>
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Industry" type="VARCHAR2(8)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="9" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="CIBIL_INDUSTRY_TYPE_MAPPING">
			<column name="Code" type="char(2)">
				<constraints nullable="false" />
			</column>
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Industry" type="VARCHAR2(8)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="9_Post" author="Akhilesh.k" dbms="mssql">
	<sql>
		alter table CIBIL_INDUSTRY_TYPE_MAPPING add constraint DF_CIB_IND_TYP_MAP_VERSION DEFAULT 0 for version;
	</sql>
	</changeSet>
	<changeSet id="9.1" author="Akhilesh.k">
		<addPrimaryKey columnNames="Code, Industry" constraintName="PK_CB_IT_CD_CT" tableName="CIBIL_INDUSTRY_TYPE_MAPPING" />
	</changeSet>

	<changeSet id="10" author="Akhilesh.k">
		<createView viewName="cibil_corporate_customers_view" replaceIfExists="true">
			SELECT
				c.custid,
				c.custdftbranch,
			  	c.custfname,
			  	c.custmname,
			  	c.custlname,
			  	c.custshrtname,
			  	c.custtradelicencenum,
			  	c.custdob,
			  	c.custcrcpr,
			  	cin.custdoctitle cin,
			  	tin.custdoctitle tin,
			  	lcm.code legalconstitution,
			  	bcm.code businesscategory
			from customers c
			left join customerdocuments cin on cin.custid = c.custid and cin.custdoccategory='CIN'
			left join customerdocuments tin on tin.custid = c.custid and tin.custdoccategory='TIN'
			left join cibil_legal_const_mapping lcm on lcm.custtype = c.custtypecode
			left join cibil_business_categor_mapping bcm on bcm.category = c.custctgcode
			left join cibil_industry_type_mapping bit on bit.industry = c.custindustry
			where custctgcode!='RETAIL'
		</createView>
	</changeSet>

	<changeSet id="11" author="Akhilesh.k">
		<dropColumn tableName="Cibil_Member_Details" columnName="Member_Name" />
	</changeSet>
	<changeSet id="12" author="Akhilesh.k">
		<dropColumn tableName="Cibil_Member_Details" columnName="Delimiter" />
	</changeSet>

	<changeSet id="13" author="Akhilesh.k">
		<dropTable tableName="Cibil_Member_Details" />
	</changeSet>

	<changeSet id="14" author="Akhilesh.k">
		<createTable tableName="Cibil_Member_Details">
			<column name="Member_Type" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Id" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Previous_Member_Id" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Short_Name" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Password" type="varchar(1000)">
				<constraints nullable="false" />
			</column>
			<column name="File_Path" type="varchar(100)">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="14.1" author="Akhilesh.k">
		<addPrimaryKey tableName="Cibil_Member_Details" columnNames="Member_Type, Member_Id" />
	</changeSet>

	<changeSet id="15pre" author="Akhilesh.k" dbms="oracle,postgresql">
		<dropNotNullConstraint tableName="Cibil_Member_Details" columnName="Previous_Member_Id" />
	</changeSet>
	<changeSet id="15pre" author="Akhilesh.k" dbms="mssql">
		<dropNotNullConstraint tableName="Cibil_Member_Details" columnName="Previous_Member_Id" columnDataType="varchar(10)"/>
	</changeSet>
	<changeSet id="15" author="Akhilesh.k">
		<sql>
			<![CDATA[
				INSERT
					INTO Cibil_Member_Details
					  (
					    Member_Type,
					    Member_Id,
					    Previous_Member_Id,
					    Member_Short_Name,
					    Member_Password,
					    File_Path
					  )
					  VALUES
					  (
					    'RETAIL',
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_CODE'
					    ),
					    NULL,
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_SHORT_NAME'
					    ),
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_PASSWORD'
					    ),
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_PATH'
					    )
					  );
					INSERT
					INTO Cibil_Member_Details
					  (
					    Member_Type,
					    Member_Id,
					    Previous_Member_Id,
					    Member_Short_Name,
					    Member_Password,
					    File_Path
					  )
					  VALUES
					  (
					    'CORP',
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_CODE'
					    ),
					    NULL,
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_SHORT_NAME'
					    ),
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_PASSWORD'
					    ),
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_PATH'
					    )
					  );

			]]>
		</sql>
	</changeSet>

	<changeSet id="16pre" author="Akhilesh.k">
		<dropTable tableName="Cibil_Member_Details" />
	</changeSet>

	<changeSet id="16" author="Akhilesh.k">
		<createTable tableName="Cibil_Member_Details">
			<column name="Member_Type" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Code" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Id" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Previous_Member_Id" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="Member_Short_Name" type="varchar(20)" />
			<column name="Member_Password" type="varchar(1000)">
				<constraints nullable="false" />
			</column>
			<column name="File_Path" type="varchar(100)">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="16.1" author="Akhilesh.k">
		<addPrimaryKey tableName="Cibil_Member_Details" columnNames="Member_Type, Member_Code" />
	</changeSet>

	<changeSet id="17Pre" author="Akhilesh.k">
		<modifyDataType tableName="Cibil_Member_Details" columnName="Member_Id" newDataType="varchar(30)" />
	</changeSet>

	<changeSet id="17Pre1" author="Akhilesh.k" dbms="oracle,postgresql">
		<dropNotNullConstraint tableName="Cibil_Member_Details" columnName="Previous_Member_Id" />
		<addNotNullConstraint tableName="Cibil_Member_Details" columnName="Member_Short_Name" />
	</changeSet>
	<changeSet id="17Pre1" author="Akhilesh.k" dbms="mssql">
		<dropNotNullConstraint tableName="Cibil_Member_Details" columnName="Previous_Member_Id" columnDataType="varchar(10)"/>
		<addNotNullConstraint tableName="Cibil_Member_Details" columnName="Member_Short_Name" columnDataType="varchar(10)"/>
	</changeSet>

	<changeSet id="17" author="Akhilesh.k">
		<sql>
			<![CDATA[
				INSERT
					INTO Cibil_Member_Details
					  (
					    Member_Type,
					    Member_Code,
					    Member_Id,
					    Previous_Member_Id,
					    Member_Short_Name,
					    Member_Password,
					    File_Path
					  )
					  VALUES
					  (
					    'RETAIL',
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_CODE'
					    ),
					     (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_ID'
					    ),
					    NULL,
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_SHORT_NAME'
					    ),
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_PASSWORD'
					    ),
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_PATH'
					    )
					  );
					INSERT
					INTO Cibil_Member_Details
					  (
					    Member_Type,
					    Member_Code,
					    Member_Id,
					    Previous_Member_Id,
					    Member_Short_Name,
					    Member_Password,
					    File_Path
					  )
					  VALUES
					  (
					    'CORP',
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_CODE'
					    ),
					     (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_ID'
					    ),
					    NULL,
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_SHORT_NAME'
					    ),
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_MEMBER_PASSWORD'
					    ),
					    (SELECT sysparmvalue
					    FROM SMTPARAMETERS
					    WHERE sysparmcode = 'CBIL_REPORT_PATH'
					    )
					  );

			]]>
		</sql>
	</changeSet>

	<changeSet id="18" author="Akhilesh.k">
		<sql>
			<![CDATA[
				delete from SMTPARAMETERS where sysparmcode = 'CBIL_REPORT_PATH';
				delete from SMTPARAMETERS where sysparmcode = 'CBIL_REPORT_MEMBER_ID';
				delete from SMTPARAMETERS where sysparmcode = 'CBIL_REPORT_MEMBER_CODE';
				delete from SMTPARAMETERS where sysparmcode = 'CBIL_REPORT_MEMBER_SHORT_NAME';
				delete from SMTPARAMETERS where sysparmcode = 'CBIL_REPORT_MEMBER_PASSWORD';
			]]>
		</sql>
	</changeSet>

	<changeSet id="19" author="Akhilesh.k">
		<modifyDataType tableName="Cibil_Member_Details" columnName="Previous_Member_Id" newDataType="varchar(30)" />
		<renameColumn tableName="cibil_file_info" oldColumnName="Bureau_Type" newColumnName="Member_Type" />
	</changeSet>

	<changeSet id="20" author="Akhilesh.k">
		<renameColumn tableName="cibil_file_info" oldColumnName="Member_Name" newColumnName="Member_Short_Name" />
	</changeSet>

	<changeSet id="21" author="Akhilesh.k">
		<createView viewName="cibil_corporate_customers_view" replaceIfExists="true">
			SELECT
				c.custid,
				c.custdftbranch,
			  	c.custfname,
			  	c.custmname,
			  	c.custlname,
			  	c.custshrtname,
			  	c.custtradelicencenum,
			  	c.custdob,
			  	c.custcrcpr,
			  	cin.custdoctitle cin,
			  	tin.custdoctitle tin,
			  	lcm.code legalconstitution,
			  	bcm.code businesscategory,
			  	bit.code custindustry
			from customers c
			left join customerdocuments cin on cin.custid = c.custid and cin.custdoccategory='CIN'
			left join customerdocuments tin on tin.custid = c.custid and tin.custdoccategory='TIN'
			left join cibil_legal_const_mapping lcm on lcm.custtype = c.custtypecode
			left join cibil_business_categor_mapping bcm on bcm.category = c.custctgcode
			left join cibil_industry_type_mapping bit on bit.industry = c.custindustry
			where custctgcode!='RETAIL'
		</createView>
	</changeSet>
	<changeSet id="22" author="Akhilesh.k">
		<renameColumn tableName="cibil_member_details" oldColumnName="member_type" newColumnName="Segment_Type" />
		<renameColumn tableName="cibil_file_info" oldColumnName="member_type" newColumnName="Segment_Type" />
		<renameColumn tableName="cibil_address_types_mapping" oldColumnName="addrtypecode" newColumnName="address_types" />
	</changeSet>
	<changeSet id="23" author="Akhilesh.k">
		<renameTable newTableName="cibil_address_types_mapping_tt" oldTableName="cibil_address_types_mapping" />
		<renameTable newTableName="cibil_address_types_tt" oldTableName="cibil_address_types" />
	</changeSet>
	<changeSet id="24" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_address_types">
			<column name="Code" type="Char(2)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Description" type="varchar(250)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="24" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_address_types">
			<column name="Code" type="Char(2)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Description" type="varchar(250)" />
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
		</changeSet>
	<changeSet id="24_Post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_address_types add constraint df_cibil_addr_type_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="25" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_address_types_mapping">
			<column name="Code" type="Char(2)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Address_Type" type="varchar(8)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="25" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_address_types_mapping">
			<column name="Code" type="Char(2)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Address_Type" type="varchar(8)" />
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="25_Post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_address_types_mapping add constraint df_cibil_addr_typ_mpng_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="26" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_address_types select Code, null, description, Version, LastMntBy,  LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NextTaskId, RecordType, WorkflowId from cibil_address_types_tt;
				insert into cibil_address_types_mapping select Code, null, address_types, Version, LastMntBy,  LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NextTaskId, RecordType, WorkflowId from cibil_address_types_mapping_tt;   
			]]>
		</sql>
	</changeSet>
	<changeSet id="27" author="Akhilesh.k">
		<sql>
			<![CDATA[
				update cibil_address_types set Segment_Type = 'RETAIL';
				update cibil_address_types_mapping set Segment_Type = 'RETAIL';
			]]>
		</sql>
	</changeSet>
	<changeSet id="28_Pre" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_address_types alter column Code char(2) not null;
			alter table cibil_address_types alter column Segment_Type varchar(10) not null;
			alter table cibil_address_types_mapping alter column Code char(2) not null;
			alter table cibil_address_types_mapping alter column Segment_Type varchar(10) not null;
			alter table cibil_address_types_mapping alter column Address_Type varchar(8) not null;
		</sql>
	</changeSet>
	<changeSet id="28" author="Akhilesh.k">
		<addPrimaryKey tableName="cibil_address_types" columnNames="Code, Segment_Type" />
		<addPrimaryKey tableName="cibil_address_types_mapping" columnNames="Code, Segment_Type, Address_Type" />
		<createIndex tableName="cibil_address_types_mapping" indexName="IX_CDTYM_CD_ST">
			<column name="Code"/>
			<column name="Segment_Type"/>
		</createIndex>
	</changeSet>
	<changeSet id="29_pre" author="Akhilesh.k" dbms="postgresql">
		<modifyDataType tableName="cibil_address_types_mapping" columnName="Address_Type" newDataType="citext" />
	</changeSet>
	<changeSet id="29" author="Akhilesh.k">
		<addForeignKeyConstraint constraintName="FK_CBAM_ADT" referencedTableName="BMTADDRESSTYPES"
			referencedColumnNames="AddrTypeCode" baseTableName="cibil_address_types_mapping" baseColumnNames="Address_Type" />
	</changeSet>
	<changeSet id="30" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_address_types values('01', 'CORP', 'Registered Office – Required', 	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_address_types values('02', 'CORP', 'Plant / Factory Address', 	 	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_address_types values('03', 'CORP', 'Warehouse', 						1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_address_types values('04', 'CORP', 'Branch / Regional Office', 		1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_address_types values('05', 'CORP', 'Others', 							1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			]]>
		</sql>
	</changeSet>
	<changeSet id="31" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_legal_const_mapping values('11', 'Private Limited',                       'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('12', 'Public Limited',                        'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('20', 'Business Entities Created by Statute',  'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('30', 'Proprietorship',                        'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('40', 'Partnership',                           'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('50', 'Trust',                                 'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('55', 'Hindu Undivided Family',                'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('60', 'Co-operative Society',                  'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('70', 'Association of Persons',                'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('80', 'Government',                            'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('85', 'Self Help Group',                       'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_const_mapping values('99', 'Not classified',                        'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			]]>
		</sql>
	</changeSet>
	<changeSet id="32" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_business_categor_mapping values('01',  'MSME',     'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_categor_mapping values('02',  'SME',      'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_categor_mapping values('03',  'Micro',    'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_categor_mapping values('04',  'Small',    'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_categor_mapping values('05',  'Medium',   'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_categor_mapping values('06',  'Large',    'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_categor_mapping values('07',  'Others',   'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			
			]]>
		</sql>
	</changeSet>
	<changeSet id="33" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_industry_type_mapping values('01',  'Manufacturing',     'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('02',  'Distribution',      'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('03',  'Wholesale',   	   'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('04',  'Trading',    	   'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('05',  'Broking',   		   'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('06',  'Service Provider',  'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('07',  'Importing',  	   'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('08',  'Exporting',   	   'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('09',  'Agriculture',       'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('10',  'Dealers',   	  	   'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type_mapping values('11',  'Others',       	   'CORP', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			
			]]>
		</sql>
	</changeSet>

	<changeSet id="34" author="Akhilesh.k">
		<dropView viewName="cibil_customer_loans_view" />
		<renameTable newTableName="cibil_account_types_tt" oldTableName="cibil_account_types" />
		<renameTable newTableName="cibil_account_types_mapping_tt" oldTableName="cibil_account_types_mapping" />
	</changeSet>
	<changeSet id="35" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_account_types">
			<column name="Code" type="Char(4)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Description" type="varchar(250)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="35" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_account_types">
			<column name="Code" type="Char(4)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Description" type="varchar(250)" />
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="35_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_account_types add constraint df_cibil_account_types_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="36" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_account_types_mapping">
			<column name="Code" type="Char(4)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="fin_type" type="varchar(8)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="36" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_account_types_mapping">
			<column name="Code" type="Char(4)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="fin_type" type="varchar(8)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="37_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_account_types_mapping add constraint df_cibil_acc_typ_map_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="37_Pre" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_account_types alter column Code char(2) not null;
			alter table cibil_account_types alter column Segment_Type varchar(10) not null;
			alter table cibil_account_types_mapping alter column Code char(2) not null;
			alter table cibil_account_types_mapping alter column Segment_Type varchar(10) not null;
			alter table cibil_account_types_mapping alter column fin_type varchar(8) not null;
		</sql>
	</changeSet>
	<changeSet id="37" author="Akhilesh.k">
		<addPrimaryKey tableName="cibil_account_types" columnNames="Code, Segment_Type" />
		<addPrimaryKey tableName="cibil_account_types_mapping" columnNames="Code, Segment_Type, fin_type" />
		<createIndex tableName="cibil_account_types_mapping" indexName="IX_ACT_CD_ST">
			<column name="Code" />
			<column name="Segment_Type" />
		</createIndex>
	</changeSet>

	<changeSet id="38" author="Akhilesh.k">
		<sql>
			<![CDATA[
				update cibil_account_types set Segment_Type = 'RETAIL';
				update cibil_account_types_mapping set Segment_Type = 'RETAIL';
			]]>
		</sql>
	</changeSet>

	<changeSet id="39" author="Akhilesh.k" dbms="postgresql">
		<modifyDataType tableName="cibil_account_types_mapping" columnName="fin_type" newDataType="citext" />
	</changeSet>


	<changeSet id="40" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_account_types select Code, 'RETAIL', description, Version, LastMntBy,  LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NextTaskId, RecordType, WorkflowId from cibil_account_types_tt;
				insert into cibil_account_types_mapping select Code, 'RETAIL', fintype, Version, LastMntBy,  LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NextTaskId, RecordType, WorkflowId from cibil_account_types_mapping_tt;   
			]]>
		</sql>
	</changeSet>

	<changeSet id="41" author="Akhilesh.k">
		<addForeignKeyConstraint constraintName="FK_CBATM_FT" referencedTableName="rmtfinancetypes"
			referencedColumnNames="fintype" baseTableName="cibil_account_types_mapping" baseColumnNames="fin_type" />
	</changeSet>

	<changeSet id="42" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_account_types values('0100',  'CORP', 'Cash credit',                                            				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0200',  'CORP', 'Overdraft',                                              				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0300',  'CORP', 'Demand loan',                                           				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0310',  'CORP', 'Loan extended through credit cards',                     				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0410',  'CORP', 'Medium term loan',  				                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0420',  'CORP', 'Long term loan', 				  	                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0500',  'CORP', 'Packing credit',			   		                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0610',  'CORP', 'Export bills purchased', 			                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0620',  'CORP', 'Export bills discounted',   		                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0630',  'CORP', 'Export bills advanced against', 	                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('0640',  'CORP', 'Advances against export cash incentives and duty draw-back claims',   	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('0710',  'CORP', 'Inland bills purchased',			                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);		
                insert into cibil_account_types values('0720',  'CORP', 'Inland bills discounted', 			                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('0800',  'CORP', 'Advances against import bills',	                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('0900',  'CORP', 'Foreign currency cheques',			                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('1000',  'CORP', 'Lease finance',   					                     				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('1100',  'CORP', 'Hire purchase',     				                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('2000',  'CORP', 'Bank guarantee',					                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('2100',  'CORP', 'Deferred payment guarantee',                            				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('3000',  'CORP', 'Letters of credit',      			                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('3100',  'CORP', 'Corporate credit card', 			                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('4000',  'CORP', 'Commercial vehicle loan',	 		                     				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('4100',  'CORP', 'Equipment financing',	 			  					  				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5000',  'CORP', 'Unsecured business loan',           					  				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5100',  'CORP', 'Short term loan', 						 				  				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5200',  'CORP', 'Aggregation of all fund based facilities',              				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5300',  'CORP', 'Aggregation of all non fund based facilities',          				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5400',  'CORP', 'Facilities interchange between fund & non fund based',  				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5500',  'CORP', 'Derivatives',                                           				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5600',  'CORP', 'Plain vanilla forex forward contracts',                 				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5700',  'CORP', 'Plain vanila int rate swap',                            				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5800',  'CORP', 'Plain vanila foreign currency option',                   				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('5900',  'CORP', 'Complex int rate derv with optionalities',               				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('6000',  'CORP', 'Any complex derivative loan involving foreign currency with option',   1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('6100',  'CORP', 'Contracts on past performance - imports',                				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('6200',  'CORP', 'Contracts on past performance - exports',                				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('9000',  'CORP', 'Aggregate of all borrowings due to filing of suit',	   				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('9001',  'CORP', 'Auto Loan',  						                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('9002',  'CORP', 'Property Loan', 			                              				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('9003',  'CORP', 'Gold Loan', 		                                      				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
                insert into cibil_account_types values('9999',  'CORP', 'Others',		                                          				1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="43" author="Akhilesh.k">
		<createView viewName="cibil_customer_loans_view" replaceIfExists="true">
			SELECT      
		            CU.CUSTID,
					AT.CODE FINTYPE,
					FM.FINREFERENCE, 
					FM.FINSTARTDATE,
					FM.FINAPPROVEDDATE,
					PD.LATESTRPYDATE,
					${add.schema}UDF_CONVERTCURRENCY(FINASSETVALUE, FM.FINCCY, 'INR') FINASSETVALUE,
					${add.schema}UDF_CONVERTCURRENCY(PD.TOTALPRIBAL, FM.FINCCY, 'INR') FUTURE_SCHEDULE_PRIN,
					${add.schema}UDF_CONVERTCURRENCY((PD.ODPRINCIPAL + PD.ODPROFIT), FM.FINCCY, 'INR') INSTALMENT_DUE,
					${add.schema}UDF_CONVERTCURRENCY((PD.TOTALPFTPAID + PD.TOTALPRIPAID), FM.FINCCY, 'INR') INSTALMENT_PAID,
					${add.schema}UDF_CONVERTCURRENCY(BOUNCE_DUE, FM.FINCCY, 'INR') BOUNCE_DUE,
					${add.schema}UDF_CONVERTCURRENCY(BOUNCE_PAID, FM.FINCCY, 'INR') BOUNCE_PAID,
					${add.schema}UDF_CONVERTCURRENCY(LATE_PAYMENT_PENALTY_DUE, FM.FINCCY, 'INR') LATE_PAYMENT_PENALTY_DUE,
					${add.schema}UDF_CONVERTCURRENCY(LATE_PAYMENT_PENALTY_PAID,FM.FINCCY, 'INR') LATE_PAYMENT_PENALTY_PAID,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPRISCHD, FM.FINCCY, 'INR') TOTAL_PRI_SCHD,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPRIPAID, FM.FINCCY, 'INR') TOTAL_PRI_PAID,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPFTSCHD, FM.FINCCY, 'INR') TOTAL_PFT_SCHD,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPFTPAID, FM.FINCCY, 'INR') TOTAL_PFT_PAID,
					${add.schema}UDF_CONVERTCURRENCY(EXCESS_AMOUNT, FM.FINCCY, 'INR') EXCESS_AMOUNT,
					${add.schema}UDF_CONVERTCURRENCY(EXCESS_AMT_PAID, FM.FINCCY, 'INR') EXCESS_AMT_PAID,
					PD.CURODDAYS,
					FM.CLOSINGSTATUS,
					CU.OWNERSHIP,
					${add.schema}UDF_CONVERTCURRENCY(CUSTINCOME, FM.FINCCY, 'INR') CUSTINCOME
	       		FROM  FINANCEMAIN FM 
					INNER JOIN CIBIL_CUSTOMER_EXTRACT CU ON  CU.FINREFERENCE = FM.FINREFERENCE 
					INNER JOIN FINPFTDETAILS PD ON PD.FINREFERENCE = FM.FINREFERENCE				
					LEFT JOIN cibil_account_types_mapping ATM ON ATM.FIN_TYPE = FM.FINTYPE
					LEFT JOIN CIBIL_ACCOUNT_TYPES AT ON AT.CODE = ATM.CODE
					LEFT JOIN (SELECT MA.FINREFERENCE, SUM(COALESCE(MA.ADVISEAMOUNT,0)- COALESCE(MA.PAIDAMOUNT,0)- COALESCE(MA.WAIVEDAMOUNT,0)) BOUNCE_DUE, SUM(MA.PAIDAMOUNT) BOUNCE_PAID FROM MANUALADVISE  MA  WHERE BOUNCEID > 0 GROUP BY MA.FINREFERENCE) MA ON MA.FINREFERENCE = FM.FINREFERENCE
					LEFT JOIN (SELECT FINREFERENCE, SUM(TOTPENALTYBAL) LATE_PAYMENT_PENALTY_DUE, SUM(TOTPENALTYPAID) LATE_PAYMENT_PENALTY_PAID FROM FINODDETAILS GROUP BY FINREFERENCE) FO ON FO.FINREFERENCE = FM.FINREFERENCE
					LEFT JOIN (SELECT FINREFERENCE, SUM(AMOUNT) EXCESS_AMOUNT, SUM (COALESCE(UTILISEDAMT,0)+ COALESCE(RESERVEDAMT,0)) EXCESS_AMT_PAID FROM FINEXCESSAMOUNT  GROUP BY FINREFERENCE) FE ON FE.FINREFERENCE = FM.FINREFERENCE
					LEFT JOIN  (SELECT CUSTID, COALESCE(SUM(CUSTINCOME), 0) CUSTINCOME FROM CUSTOMERINCOMES GROUP BY CUSTID) CI ON CI.CUSTID = CU.CUSTID
	</createView>
	</changeSet>

	<changeSet id="44" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="CIBIL_REPAY_FREQUENCY_MAPPING">
			<column name="Code" type="Char(2)" />
			<column name="Description" type="varchar(250)" />
			<column name="RepayFrq" type="varchar(8)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="44" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="CIBIL_REPAY_FREQUENCY_MAPPING">
			<column name="Code" type="Char(2)" />
			<column name="Description" type="varchar(250)" />
			<column name="RepayFrq" type="varchar(8)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="44_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table CIBIL_REPAY_FREQUENCY_MAPPING add constraint df_cibil_rep_fre_map_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="45" author="Akhilesh.k">
		<dropTable tableName="cibil_address_types_mapping_tt" />
		<dropTable tableName="cibil_address_types_tt" />
		<dropTable tableName="cibil_account_types_mapping_tt" />
		<dropTable tableName="cibil_account_types_tt" />
	</changeSet>

	<changeSet id="46" author="Akhilesh.k">
		<renameColumn tableName="CIBIL_CUSTOMER_EXTRACT" oldColumnName="Bureau_Type" newColumnName="Segment_Type" />
	</changeSet>

	<changeSet id="47" author="Akhilesh.k">
		<renameTable newTableName="cibil_collateral_types_tt" oldTableName="cibil_collateral_types" />
		<renameTable newTableName="cibil_collateral_mapping_tt" oldTableName="cibil_collateral_types_mapping" />
	</changeSet>

	<changeSet id="48" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_collateral_types">
			<column name="Code" type="Char(4)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Description" type="varchar(250)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="48" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_collateral_types">
			<column name="Code" type="Char(4)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Description" type="varchar(250)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="48_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_collateral_types add constraint df_cibil_clt_typ_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="49" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_collateral_types_mapping">
			<column name="Code" type="Char(4)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Collateral_Type" type="varchar(8)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="49" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_collateral_types_mapping">
			<column name="Code" type="Char(4)" />
			<column name="Segment_Type" type="varchar(10)" />
			<column name="Collateral_Type" type="varchar(8)" />
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="49_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_collateral_types_mapping add constraint df_cbl_clt_typ_map_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="50_Pre" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_collateral_types alter column  Code char(4) not null;
			alter table cibil_collateral_types alter column  Segment_Type varchar(10) not null;
			alter table cibil_collateral_types_mapping alter column  code char(4) not null;
			alter table cibil_collateral_types_mapping alter column  Segment_Type varchar(10) not null;
			alter table cibil_collateral_types_mapping alter column  Collateral_Type varchar(8) not null;
		</sql>
	</changeSet>
	<changeSet id="50" author="Akhilesh.k">
		<addPrimaryKey tableName="cibil_collateral_types" columnNames="Code, Segment_Type" />
		<addPrimaryKey tableName="cibil_collateral_types_mapping" columnNames="Code, Segment_Type, Collateral_Type" />
		<createIndex tableName="cibil_collateral_types_mapping" indexName="IX_CCTM_CD_ST">
			<column name="Code" />
			<column name="Segment_Type" />
		</createIndex>
	</changeSet>

	<changeSet id="51" author="Akhilesh.k" dbms="postgresql">
		<modifyDataType tableName="cibil_collateral_types_mapping" columnName="Collateral_Type" newDataType="citext" />
	</changeSet>


	<changeSet id="52" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_collateral_types select Code, 'RETAIL', description, Version, LastMntBy,  LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NextTaskId, RecordType, WorkflowId from cibil_collateral_types_tt;
				insert into cibil_collateral_types_mapping select Code, 'RETAIL', collateralType, Version, LastMntBy,  LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NextTaskId, RecordType, WorkflowId from cibil_collateral_mapping_tt;   
			]]>
		</sql>
	</changeSet>

	<changeSet id="53" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_account_types values('001',  'CORP', 'Cash/ Bullion/ Bank Deposits', 						1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('002',  'CORP', 'Shares/ Bonds/ Securities', 						1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('003',  'CORP', 'Inventory (Raw Material, WIP and Finished Goods)', 	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('004',  'CORP', 'Accounts Receivable', 								1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('005',  'CORP', 'Other Current Assets',							 	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('006',  'CORP', 'Plant & Machinery and Equipment', 					1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('007',  'CORP', 'Land & Buildings', 									1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('008',  'CORP', 'Other Fixed Assets', 								1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('009',  'CORP', 'Other Assets', 										1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('010',  'CORP', 'Aggregate of all Current Assets', 	      			1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_account_types values('011',  'CORP', 'Aggregate of all Fixed Assets', 					1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="54" author="Akhilesh.k">
		<dropView viewName="cibil_corporate_customers_view" />
		<dropTable tableName="cibil_business_categor_mapping" />
	</changeSet>

	<changeSet id="55" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_business_category" remarks="cibil business category mapping">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="VARCHAR2(8)" />
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="55" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_business_category" remarks="cibil business category mapping">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="VARCHAR2(8)" />
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="55_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_business_category add constraint df_cbl_bus_cat_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="56_Pre" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_business_category alter column  Code char(4) not null;
			alter table cibil_business_category alter column  Segment_Type varchar(10) not null;
		</sql>
	</changeSet>
	<changeSet id="56" author="Akhilesh.k">
		<addPrimaryKey tableName="cibil_business_category" columnNames="Code, Segment_Type" />
	</changeSet>

	<changeSet id="57" author="Akhilesh.k" dbms="postgresql,oracle">
		<createTable tableName="cibil_business_catgry_mapping" remarks="cibil business category mapping">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="VARCHAR(8)" />
			<column name="Category" type="VARCHAR(8)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="57" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_business_catgry_mapping" remarks="cibil business category mapping">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="VARCHAR(8)" />
			<column name="Category" type="VARCHAR(8)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="57_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_business_catgry_mapping add constraint df_cbl_bus_cat_map_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="58_pre" author="Akhilesh.k" dbms="postgresql">
		<modifyDataType tableName="cibil_business_catgry_mapping" columnName="Category" newDataType="citext" />
	</changeSet>
	<changeSet id="58_Pre.1" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_business_catgry_mapping alter column Code char(2) not null;
			alter table cibil_business_catgry_mapping alter column Segment_Type varchar(8) not null;
			alter table cibil_business_catgry_mapping alter column Category varchar(8) not null;
		</sql>
	</changeSet>
	<changeSet id="58_Pre.3" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_business_catgry_mapping alter column Segment_Type varchar(10) not null;
			alter table cibil_business_catgry_mapping alter column code char(4) not null;
		</sql>
	</changeSet>
	<changeSet id="58" author="Akhilesh.k">
		<addPrimaryKey tableName="cibil_business_catgry_mapping" columnNames="Code, Segment_Type, Category" />
		<addForeignKeyConstraint baseTableName="cibil_business_catgry_mapping" baseColumnNames="Code, Segment_Type"
			referencedTableName="cibil_business_category" referencedColumnNames="Code, Segment_Type" constraintName="fk_cbcm_code_segment_Type" />
		<addForeignKeyConstraint baseTableName="cibil_business_catgry_mapping" baseColumnNames="Category"
			referencedTableName="bmtcustcategories" referencedColumnNames="custctgcode" constraintName="fk_cbc_cc_category_ccode" />
	</changeSet>

	<changeSet id="59" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_business_category values('01',  'CORP', 	'MSME',    	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_category values('02',  'CORP',	'SME', 		1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_category values('03',  'CORP',	'Micro',    1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_category values('04',  'CORP',	'Small',    1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_category values('05',  'CORP',	'Medium',   1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_category values('06',  'CORP',	'Large',    1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_business_category values('07',  'CORP',	'Others',   1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="60" author="Akhilesh.k">
		<createView viewName="cibil_corporate_customers_view" replaceIfExists="true">
			SELECT
				c.custid,
				c.custdftbranch,
			  	c.custfname,
			  	c.custmname,
			  	c.custlname,
			  	c.custshrtname,
			  	c.custtradelicencenum,
			  	c.custdob,
			  	c.custcrcpr,
			  	cin.custdoctitle cin,
			  	tin.custdoctitle tin,
			  	lcm.code legalconstitution,
			  	bcm.code businesscategory
			from cibil_customer_extract ce
			inner join customers c on c.custid = ce.custid
			left join customerdocuments cin on cin.custid = ce.custid and cin.custdoccategory='CIN'
			left join customerdocuments tin on tin.custid = ce.custid and tin.custdoccategory='TIN'
			left join cibil_legal_const_mapping lcm on lcm.custtype = c.custtypecode
			left join cibil_business_catgry_mapping bcm on bcm.category = c.custctgcode
			left join cibil_business_category bc on bc.code = bcm.code and bc.Segment_Type=bcm.Segment_Type
			left join cibil_industry_type_mapping bit on bit.industry = c.custindustry
			where ce.segment_type ='CORP'
		</createView>
	</changeSet>

	<changeSet id="61" author="Akhilesh.k">
		<dropView viewName="cibil_corporate_customers_view" />
		<dropTable tableName="CIBIL_LEGAL_CONST_MAPPING" />
	</changeSet>

	<changeSet id="62" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_legal_constitution" remarks="Legal Constitution">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="VARCHAR2(8)" />
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="62" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_legal_constitution" remarks="Legal Constitution">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="VARCHAR2(8)" />
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="62_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_legal_constitution add constraint df_cbl_legal_const_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="63" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_legal_const_mapping" remarks="Legal Constitution Mapping">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="varchar(8)" />
			<column name="Cust_Type_Code" type="varchar(8)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="63" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_legal_const_mapping" remarks="Legal Constitution Mapping">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="varchar(8)" />
			<column name="Cust_Type_Code" type="varchar(8)" />
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="63_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_legal_const_mapping add constraint df_cbl_legal_const_map_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="64_pre" author="Akhilesh.k" dbms="postgresql">
		<modifyDataType tableName="cibil_legal_const_mapping" columnName="Cust_Type_Code" newDataType="citext" />
	</changeSet>
	<changeSet id="64_Pre.1" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_legal_constitution alter column Code char(4) not null;
			alter table cibil_legal_constitution alter column Segment_Type varchar(8) not null;
			alter table cibil_legal_const_mapping alter column Code char(4) not null;
			alter table cibil_legal_const_mapping alter column Segment_Type varchar(8) not null;
			alter table cibil_legal_const_mapping alter column Cust_Type_Code varchar(8) not null;
		</sql>
	</changeSet>
	<changeSet id="64" author="Akhilesh.k">
		<addPrimaryKey columnNames="Code, Segment_Type" constraintName="pk_cb_lc_cd_st" tableName="cibil_legal_constitution" />
		<addPrimaryKey columnNames="Code, Segment_Type, Cust_Type_Code" constraintName="pk_cb_lcm_cd_st_ct"
			tableName="cibil_legal_const_mapping" />
		<addForeignKeyConstraint baseTableName="cibil_legal_const_mapping" baseColumnNames="Code, Segment_Type"
			referencedTableName="cibil_legal_constitution" referencedColumnNames="Code, Segment_Type" constraintName="fk_clcm_clc_cd_st" />
		<addForeignKeyConstraint baseTableName="cibil_legal_const_mapping" baseColumnNames="Cust_Type_Code"
			referencedTableName="rmtcusttypes" referencedColumnNames="custtypecode" constraintName="fk_clcm_ct_ctc" />
	</changeSet>

	<changeSet id="65" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_legal_constitution values('11', 'CORP',	'Private Limited', 					 	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('12', 'CORP',	'Public Limited',                		1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('20', 'CORP',	'Business Entities Created by Statute', 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('30', 'CORP',	'Proprietorship',                       1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('40', 'CORP',	'Partnership',                         	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('50', 'CORP',	'Trust',                               	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('55', 'CORP',	'Hindu Undivided Family',              	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('60', 'CORP',	'Co-operative Society',                	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('70', 'CORP',	'Association of Persons',              	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('80', 'CORP',	'Government',                          	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('85', 'CORP',	'Self Help Group',                     	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_legal_constitution values('99', 'CORP',	'Not classified',                      	1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="66" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_industry_type">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="varchar(8)" />
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="66" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_industry_type">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="varchar(8)" />
			<column name="Description" type="varchar(250)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int"/>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="66_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_industry_type add constraint df_cibil_industry_type_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="67_pre" author="Akhilesh.k">
		<dropTable tableName="cibil_industry_type_mapping" />
	</changeSet>

	<changeSet id="67" author="Akhilesh.k" dbms="oracle,postgresql">
		<createTable tableName="cibil_industry_type_mapping">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="varchar(8)" />
			<column name="Industry" type="varchar(8)" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="67" author="Akhilesh.k" dbms="mssql">
		<createTable tableName="cibil_industry_type_mapping">
			<column name="Code" type="char(2)" />
			<column name="Segment_Type" type="varchar(8)" />
			<column name="Industry" type="varchar(8)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="67_post" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_industry_type_mapping add constraint df_cbl_indstry_typ_map_version default 0 for version;
		</sql>
	</changeSet>
	<changeSet id="68_pre" author="Akhilesh.k" dbms="postgresql">
		<modifyDataType tableName="cibil_industry_type_mapping" columnName="Industry" newDataType="citext" />
	</changeSet>
	<changeSet id="68_Pre.2" author="Akhilesh.k" dbms="mssql">
		<sql>
			alter table cibil_industry_type alter column Code char(4) not null;
			alter table cibil_industry_type alter column Segment_Type varchar(8) not null;
			alter table cibil_industry_type_mapping alter column Code char(4) not null;
			alter table cibil_industry_type_mapping alter column Segment_Type varchar(8) not null;
			alter table cibil_industry_type_mapping alter column Industry varchar(8) not null;
		</sql>
	</changeSet>
	<changeSet id="68" author="Akhilesh.k">
		<addPrimaryKey columnNames="Code, Segment_Type" constraintName="pk_cb_it_cd_st" tableName="cibil_industry_type" />
		<addPrimaryKey columnNames="Code, Segment_Type, Industry" constraintName="pk_cb_itm_cd_st_in" tableName="cibil_industry_type_mapping" />
		<addForeignKeyConstraint baseTableName="cibil_industry_type_mapping" baseColumnNames="Code, Segment_Type"
			referencedTableName="cibil_industry_type" referencedColumnNames="Code, Segment_Type" constraintName="fk_citm_cit_cd_st" />
	</changeSet>


	<changeSet id="69" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_industry_type values('01', 'CORP',   'Manufacturing',           1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('02', 'CORP',   'Distribution',            1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('03', 'CORP',   'Wholesale',   	          1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('04', 'CORP',   'Trading',    	          1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('05', 'CORP',   'Broking',   		      1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('06', 'CORP',   'Service Provider',        1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('07', 'CORP',   'Importing',  	          1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('08', 'CORP',   'Exporting',   	          1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('09', 'CORP',   'Agriculture',             1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('10', 'CORP',   'Dealers',   	  	      1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_industry_type values('11', 'CORP',   'Others',       	          1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			
			]]>
		</sql>
	</changeSet>
	<changeSet id="70" author="Akhilesh.k">
		<createView viewName="cibil_corporate_customers_view" replaceIfExists="true">
			SELECT
				c.custid,
				c.custdftbranch,
			  	c.custfname,
			  	c.custmname,
			  	c.custlname,
			  	c.custshrtname,
			  	c.custtradelicencenum,
			  	c.custdob,
			  	c.custcrcpr,
			  	cin.custdoctitle cin,
			  	tin.custdoctitle tin,
			  	lc.code legalconstitution,
			  	bc.code businesscategory
			from cibil_customer_extract ce
			inner join customers c on c.custid = ce.custid
			left join customerdocuments cin on cin.custid = ce.custid and cin.custdoccategory='CIN'
			left join customerdocuments tin on tin.custid = ce.custid and tin.custdoccategory='TIN'
			left join cibil_legal_const_mapping lcm on lcm.cust_type_code = c.custtypecode
			left join cibil_legal_constitution lc on lc.Code = lcm.Code and lc.Segment_Type=lcm.Segment_Type
			left join cibil_business_catgry_mapping bcm on bcm.category = c.custctgcode
			left join cibil_business_category bc on bc.code = bcm.code and bc.Segment_Type=bcm.Segment_Type
			left join cibil_industry_type_mapping bitm on bitm.industry = c.custindustry
			left join cibil_industry_type bit on bit.Code = bitm.Code and bit.Segment_Type=bitm.Segment_Type
			where ce.segment_type ='CORP'
		</createView>
	</changeSet>

	<changeSet id="71" author="Akhilesh.k">
		<sql>
	<![CDATA[
				insert into Master_Def (master_type, key_type, key_code) values('DOC_TYPE', 'VOTER_ID', 'VOTER_ID');
				insert into Master_Def (master_type, key_type, key_code) values('DOC_TYPE', 'DRIVING_LICENCE', 'DRIVING_LICENCE');
				insert into Master_Def (master_type, key_type, key_code) values('DOC_TYPE', 'RATION_CARD', 'RATION_CARD');
				insert into Master_Def (master_type, key_type, key_code) values('DOC_TYPE', 'CORPORATE_ID_NUMBER', 'CORPORATE_ID_NUMBER');
				insert into Master_Def (master_type, key_type, key_code) values('DOC_TYPE', 'TAX_IDENTIFICATION_NUMBER', 'TAX_IDENTIFICATION_NUMBER');
				insert into Master_Def (master_type, key_type, key_code) values('DOC_TYPE', 'DIRECTOR_IDENTIFICATION_NUMBER', 'DIRECTOR_IDENTIFICATION_NUMBER');
				insert into Master_Def (master_type, key_type, key_code) values('DOC_TYPE', 'SERVICE_TAX_REG_NO', 'SERVICE_TAX_REG_NO');
	]]>
		</sql>
	</changeSet>

	<changeSet id="72" author="Akhilesh.k">
		<dropView viewName="cibil_corporate_customers_view" />
	</changeSet>

	<changeSet id="73" author="Akhilesh.k">
		<createView viewName="cibil_customer_loans_view" replaceIfExists="true">
			SELECT      
		            CU.CUSTID,
					AT.CODE FINTYPE,
					FM.FINREFERENCE, 
					FM.FINSTARTDATE,
					FM.FINAPPROVEDDATE,
					PD.LATESTRPYDATE,
					${add.schema}UDF_CONVERTCURRENCY(FINASSETVALUE, FM.FINCCY, 'INR') FINASSETVALUE,
					${add.schema}UDF_CONVERTCURRENCY(PD.TOTALPRIBAL, FM.FINCCY, 'INR') FUTURE_SCHEDULE_PRIN,
					${add.schema}UDF_CONVERTCURRENCY((PD.ODPRINCIPAL + PD.ODPROFIT), FM.FINCCY, 'INR') INSTALMENT_DUE,
					${add.schema}UDF_CONVERTCURRENCY((PD.TOTALPFTPAID + PD.TOTALPRIPAID), FM.FINCCY, 'INR') INSTALMENT_PAID,
					${add.schema}UDF_CONVERTCURRENCY(BOUNCE_DUE, FM.FINCCY, 'INR') BOUNCE_DUE,
					${add.schema}UDF_CONVERTCURRENCY(BOUNCE_PAID, FM.FINCCY, 'INR') BOUNCE_PAID,
					${add.schema}UDF_CONVERTCURRENCY(LATE_PAYMENT_PENALTY_DUE, FM.FINCCY, 'INR') LATE_PAYMENT_PENALTY_DUE,
					${add.schema}UDF_CONVERTCURRENCY(LATE_PAYMENT_PENALTY_PAID,FM.FINCCY, 'INR') LATE_PAYMENT_PENALTY_PAID,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPRISCHD, FM.FINCCY, 'INR') TOTAL_PRI_SCHD,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPRIPAID, FM.FINCCY, 'INR') TOTAL_PRI_PAID,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPFTSCHD, FM.FINCCY, 'INR') TOTAL_PFT_SCHD,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPFTPAID, FM.FINCCY, 'INR') TOTAL_PFT_PAID,
					${add.schema}UDF_CONVERTCURRENCY(EXCESS_AMOUNT, FM.FINCCY, 'INR') EXCESS_AMOUNT,
					${add.schema}UDF_CONVERTCURRENCY(EXCESS_AMT_PAID, FM.FINCCY, 'INR') EXCESS_AMT_PAID,
					PD.CURODDAYS,
					FM.CLOSINGSTATUS,
					CU.OWNERSHIP,
					${add.schema}UDF_CONVERTCURRENCY(CUSTINCOME, FM.FINCCY, 'INR') CUSTINCOME
	       		FROM  FINANCEMAIN FM 
					INNER JOIN CIBIL_CUSTOMER_EXTRACT CU ON  CU.FINREFERENCE = FM.FINREFERENCE 
					INNER JOIN FINPFTDETAILS PD ON PD.FINREFERENCE = FM.FINREFERENCE				
					LEFT JOIN cibil_account_types_mapping ATM ON ATM.FIN_TYPE = FM.FINTYPE
					LEFT JOIN CIBIL_ACCOUNT_TYPES AT ON AT.CODE = ATM.CODE and AT.segment_Type = ATM.segment_Type
					LEFT JOIN (SELECT MA.FINREFERENCE, SUM(COALESCE(MA.ADVISEAMOUNT,0)- COALESCE(MA.PAIDAMOUNT,0)- COALESCE(MA.WAIVEDAMOUNT,0)) BOUNCE_DUE, SUM(MA.PAIDAMOUNT) BOUNCE_PAID FROM MANUALADVISE  MA  WHERE BOUNCEID > 0 GROUP BY MA.FINREFERENCE) MA ON MA.FINREFERENCE = FM.FINREFERENCE
					LEFT JOIN (SELECT FINREFERENCE, SUM(TOTPENALTYBAL) LATE_PAYMENT_PENALTY_DUE, SUM(TOTPENALTYPAID) LATE_PAYMENT_PENALTY_PAID FROM FINODDETAILS GROUP BY FINREFERENCE) FO ON FO.FINREFERENCE = FM.FINREFERENCE
					LEFT JOIN (SELECT FINREFERENCE, SUM(AMOUNT) EXCESS_AMOUNT, SUM (COALESCE(UTILISEDAMT,0)+ COALESCE(RESERVEDAMT,0)) EXCESS_AMT_PAID FROM FINEXCESSAMOUNT  GROUP BY FINREFERENCE) FE ON FE.FINREFERENCE = FM.FINREFERENCE
					LEFT JOIN  (SELECT CUSTID, COALESCE(SUM(CUSTINCOME), 0) CUSTINCOME FROM CUSTOMERINCOMES GROUP BY CUSTID) CI ON CI.CUSTID = CU.CUSTID
	</createView>
	</changeSet>

	<changeSet id="74" author="Akhilesh.k">
		<sql>
			<![CDATA[
				insert into cibil_collateral_types values('001', 'CORP',   'Cash/ Bullion/ Bank Deposits',                               1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('002', 'CORP',   'Shares/ Bonds/ Securities',           						 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('003', 'CORP',   'Inventory (Raw Material, WIP and Finished Goods)',           1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('004', 'CORP',   'Accounts Receivable',         							     1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('005', 'CORP',   'Other Current Assets',          						     1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('006', 'CORP',   'Plant & Machinery and Equipment',          					 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('007', 'CORP',   'Land & Buildings',          								 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('008', 'CORP',   'Other Fixed Assets',         							     1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('009', 'CORP',   'Other Assets',                                               1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('010', 'CORP',   'Aggregate of all Current Assets',         				     1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
				insert into cibil_collateral_types values('011', 'CORP',   'Aggregate of all Fixed Assets',             			   	 1, 1000, current_timestamp, 'Approved', '', '', '', '', '', 0);
			]]>
		</sql>
	</changeSet>
	<changeSet id="75" author="Akhilesh.k">
		<createView viewName="CIBIL_FILE_INFO_VIEW" replaceIfExists="true">
			select id,
			  file_name,
			  createdon,
			  status,
			  file_location,
			  (select id from data_engine_config where name = 'CIBIL_REPORT'
			  ) configid,
			  null postevent,
			  segment_type
			from cibil_file_info
		</createView>
	</changeSet>
	
	<changeSet id="76" author="Akhilesh.k">
		<createView viewName="cibil_customer_loans_view" replaceIfExists="true">
			SELECT      
		            CU.CUSTID,
					AT.CODE FINTYPE,
					FM.FINREFERENCE, 
					FM.FINSTARTDATE,
					FM.FINAPPROVEDDATE,
					PD.LATESTRPYDATE,
					${add.schema}UDF_CONVERTCURRENCY(FINASSETVALUE, FM.FINCCY, 'INR') FINASSETVALUE,
					${add.schema}UDF_CONVERTCURRENCY(PD.TOTALPRIBAL, FM.FINCCY, 'INR') FUTURE_SCHEDULE_PRIN,
					${add.schema}UDF_CONVERTCURRENCY((PD.ODPRINCIPAL + PD.ODPROFIT), FM.FINCCY, 'INR') INSTALMENT_DUE,
					${add.schema}UDF_CONVERTCURRENCY((PD.TOTALPFTPAID + PD.TOTALPRIPAID), FM.FINCCY, 'INR') INSTALMENT_PAID,
					${add.schema}UDF_CONVERTCURRENCY(BOUNCE_DUE, FM.FINCCY, 'INR') BOUNCE_DUE,
					${add.schema}UDF_CONVERTCURRENCY(BOUNCE_PAID, FM.FINCCY, 'INR') BOUNCE_PAID,
					${add.schema}UDF_CONVERTCURRENCY(LATE_PAYMENT_PENALTY_DUE, FM.FINCCY, 'INR') LATE_PAYMENT_PENALTY_DUE,
					${add.schema}UDF_CONVERTCURRENCY(LATE_PAYMENT_PENALTY_PAID,FM.FINCCY, 'INR') LATE_PAYMENT_PENALTY_PAID,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPRISCHD, FM.FINCCY, 'INR') TOTAL_PRI_SCHD,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPRIPAID, FM.FINCCY, 'INR') TOTAL_PRI_PAID,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPFTSCHD, FM.FINCCY, 'INR') TOTAL_PFT_SCHD,
					${add.schema}UDF_CONVERTCURRENCY(TOTALPFTPAID, FM.FINCCY, 'INR') TOTAL_PFT_PAID,
					${add.schema}UDF_CONVERTCURRENCY(EXCESS_AMOUNT, FM.FINCCY, 'INR') EXCESS_AMOUNT,
					${add.schema}UDF_CONVERTCURRENCY(EXCESS_AMT_PAID, FM.FINCCY, 'INR') EXCESS_AMT_PAID,
					PD.CURODDAYS,
					FM.CLOSINGSTATUS,
					CU.OWNERSHIP,
					${add.schema}UDF_CONVERTCURRENCY(CUSTINCOME, FM.FINCCY, 'INR') CUSTINCOME
	       		FROM  FINANCEMAIN FM 
					INNER JOIN CIBIL_CUSTOMER_EXTRACT CU ON  CU.FINREFERENCE = FM.FINREFERENCE 
					INNER JOIN FINPFTDETAILS PD ON PD.FINREFERENCE = FM.FINREFERENCE				
					LEFT JOIN cibil_account_types_mapping ATM ON ATM.FIN_TYPE = FM.FINTYPE
					LEFT JOIN CIBIL_ACCOUNT_TYPES AT ON AT.CODE = ATM.CODE and AT.segment_Type = ATM.segment_Type
					LEFT JOIN (SELECT MA.FINREFERENCE, SUM(COALESCE(MA.ADVISEAMOUNT,0)- COALESCE(MA.PAIDAMOUNT,0)- COALESCE(MA.WAIVEDAMOUNT,0)) BOUNCE_DUE, SUM(MA.PAIDAMOUNT) BOUNCE_PAID FROM MANUALADVISE  MA  WHERE BOUNCEID > 0 GROUP BY MA.FINREFERENCE) MA ON MA.FINREFERENCE = FM.FINREFERENCE
					LEFT JOIN (SELECT FINREFERENCE, SUM(TOTPENALTYBAL) LATE_PAYMENT_PENALTY_DUE, SUM(TOTPENALTYPAID) LATE_PAYMENT_PENALTY_PAID FROM FINODDETAILS GROUP BY FINREFERENCE) FO ON FO.FINREFERENCE = FM.FINREFERENCE
					LEFT JOIN (SELECT FINREFERENCE, SUM(AMOUNT) EXCESS_AMOUNT, SUM (COALESCE(UTILISEDAMT,0)+ COALESCE(RESERVEDAMT,0)) EXCESS_AMT_PAID FROM FINEXCESSAMOUNT  GROUP BY FINREFERENCE) FE ON FE.FINREFERENCE = FM.FINREFERENCE
					LEFT JOIN  (SELECT CUSTID, COALESCE(SUM(CUSTINCOME), 0) CUSTINCOME FROM CUSTOMERINCOMES GROUP BY CUSTID) CI ON CI.CUSTID = CU.CUSTID
	</createView>
	</changeSet>

</databaseChangeLog>