<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="add.schema" value=" " dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="satish" runAlways="true"
		dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>

	<changeSet id="1" author="Somasekhar">
		<addColumn tableName="rmtfinancetypes">
			<column name="instbasedschd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="2" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="instbasedschd" tableName="rmtfinancetypes"
			defaultValue="0" />
	</changeSet>

	<changeSet id="3" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE rmtfinancetypes ADD CONSTRAINT DF_rmtfinancetypes_instbsdschd DEFAULT 0 FOR instbasedschd;
			]]>
		</sql>
	</changeSet>

	<changeSet id="4" author="Somasekhar">
		<addColumn tableName="rmtfinancetypes_temp">
			<column name="instbasedschd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="5" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="instbasedschd" tableName="rmtfinancetypes_temp"
			defaultValue="0" />
	</changeSet>

	<changeSet id="6" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE rmtfinancetypes_temp ADD CONSTRAINT DF_rmtfinancetypes_temp_instbasedschd DEFAULT 0 FOR instbasedschd;
			]]>
		</sql>
	</changeSet>

	<changeSet id="7" author="Somasekhar">
		<addColumn tableName="financemain">
			<column name="instbasedschd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="8" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="instbasedschd" tableName="financemain"
			defaultValue="0" />
	</changeSet>

	<changeSet id="9" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE financemain ADD CONSTRAINT DF_financemain_instbasedschd DEFAULT 0 FOR instbasedschd;
			]]>
		</sql>
	</changeSet>

	<changeSet id="10" author="Somasekhar">
		<addColumn tableName="financemain_temp">
			<column name="instbasedschd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="11" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="instbasedschd" tableName="financemain_temp"
			defaultValue="0" />
	</changeSet>

	<changeSet id="12" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE financemain_temp ADD CONSTRAINT DF_financemain_tp_instbsdschd DEFAULT 0 FOR instbasedschd;
			]]>
		</sql>
	</changeSet>

	<changeSet id="13" author="Somasekhar">
		<createTable tableName="INSTBASEDSCHDDETAILS">
			<column name="batchid" type="bigint" />
			<column name="finreference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="disbid" type="bigint" />
			<column name="realizeddate" type="datetime" />
			<column name="status" type="varchar(8)" />
			<column name="errordesc" type="varchar(1000)" />
			<column name="userid" type="bigint" />
			<column name="downloaded_on" type="datetime" />
			<column name="disbAmount" type="decimal(18,2)" />
			<column name="linkedTranId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="14" author="Somasekhar">
		<addColumn tableName="findisbursementdetails">
			<column name="linkeddisbid" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="15" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="linkeddisbid" tableName="findisbursementdetails"
			defaultValue="0" />
	</changeSet>

	<changeSet id="16" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE findisbursementdetails ADD CONSTRAINT DF_findisbrsmentdtls_InstlReq DEFAULT 0 FOR linkeddisbid;
			]]>
		</sql>
	</changeSet>

	<changeSet id="17" author="Somasekhar">
		<addColumn tableName="findisbursementdetails">
			<column name="InstCalReq" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="18" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="InstCalReq" tableName="findisbursementdetails"
			defaultValue="0" />
	</changeSet>

	<changeSet id="19" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE findisbursementdetails ADD CONSTRAINT DF_findisbursemntdtls_InstClRq DEFAULT 0 FOR InstCalReq;
			]]>
		</sql>
	</changeSet>

	<changeSet id="20" author="Somasekhar">
		<addColumn tableName="findisbursementdetails_temp">
			<column name="InstCalReq" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="21" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="InstCalReq"
			tableName="findisbursementdetails_temp" defaultValue="0" />
	</changeSet>

	<changeSet id="22" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE findisbursementdetails_temp ADD CONSTRAINT DF_findsbrsmntdtls_t_InstClRq DEFAULT 0 FOR InstCalReq;
			]]>
		</sql>
	</changeSet>

	<changeSet id="23" author="Somasekhar">
		<addColumn tableName="findisbursementdetails_temp">
			<column name="linkeddisbid" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="24" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="linkeddisbid"
			tableName="findisbursementdetails_temp" defaultValue="0" />
	</changeSet>

	<changeSet id="25" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE findisbursementdetails_temp ADD CONSTRAINT DF_findsbrsmntdtl_t_linkddsbid DEFAULT 0 FOR linkeddisbid;
			]]>
		</sql>
	</changeSet>

	<changeSet id="26" author="Somasekhar">
		<addColumn tableName="FinDisbursementDetails_Log">
			<column name="InstCalReq" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="27" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="InstCalReq"
			tableName="FinDisbursementDetails_Log" defaultValue="0" />
	</changeSet>

	<changeSet id="28" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FinDisbursementDetails_Log ADD CONSTRAINT DF_FnDsbrsmntDtls_Log_InstClRq DEFAULT 0 FOR InstCalReq;
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="29" author="Somasekhar">
		<addColumn tableName="FinDisbursementDetails_Log">
			<column name="linkeddisbid" type="boolean" />
		</addColumn>
	</changeSet>
	
	<changeSet id="30" author="Somasekhar" dbms="postgresql, oracle">
		<addDefaultValue columnName="linkeddisbid" tableName="FinDisbursementDetails_Log" defaultValue="0" />
	</changeSet>
	
	<changeSet id="31" author="Somasekhar" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FinDisbursementDetails_Log ADD CONSTRAINT DF_FnDsbrsmntDtls_Log_lnkddsbd DEFAULT 0 FOR linkeddisbid;
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="32" author="Somasekhar">
		<sql>
			<![CDATA[
				UPDATE rmtfinancetypes SET instbasedschd = 0;
				UPDATE rmtfinancetypes_temp SET instbasedschd = 0;
				UPDATE financemain SET instbasedschd = 0;
				UPDATE financemain_temp SET instbasedschd = 0;
				UPDATE findisbursementdetails SET linkeddisbid = 0;
				UPDATE findisbursementdetails SET InstCalReq = 0;
				UPDATE findisbursementdetails_temp SET InstCalReq = 0;
				UPDATE findisbursementdetails_temp SET linkeddisbid = 0;
				UPDATE FinDisbursementDetails_Log SET InstCalReq = 0;
				UPDATE FinDisbursementDetails_Log SET linkeddisbid = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="33" author="Somasekhar">
		<sql>
				<![CDATA[
					DELETE from SMTparameters WHERE SYSPARMCODE='IS_INST_BASED_SCHD_REQ'; 
					INSERT INTO smtparameters (sysparmcode, sysparmdesc, sysparmtype, sysparmmaint, sysparmvalue, sysparmlength, sysparmdec, sysparmlist, sysparmvaldmod, sysparmdescription, version, lastmntby, lastmnton, recordstatus, rolecode, nextrolecode, taskid, nexttaskid, recordtype, workflowid) VALUES ('IS_INST_BASED_SCHD_REQ', 'Instruction based Schedule required', 'String', 1, 'N', 20, 0, NULL, NULL, 'Instruction based Schedule required', 2, 1000, CURRENT_TIMESTAMP, 'Approved', '', '', '', '', '', 0);
				]]>
		</sql>
	</changeSet>
	


	<changeSet id="35.1" author="Somasekhar">
		<createView viewName="rmtfinancetypes_aeview" replaceIfExists="true">
			<![CDATA[	
				SELECT t1.fintype,
			    '' AS findeffreq,
			    t1.finactype,
			    t1.finccy,
			    t1.finisopennewfinac,
			    t1.pftpayactype,
			    t1.finisopenpftpayacc,
			    t1.fincontingentactype,
			    t1.finprovisionactype,
			    t1.finsuspactype,
			    t1.fincategory,
			    t1.developerfinance,
			    t1.PartiallySecured,
				t1.instbasedschd
			   FROM rmtfinancetypes t1
			]]>
		</createView>
	</changeSet>
	
	<changeSet id="36.1.1_pre" author="Somasekhar" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				truncate table deps_saved_ddl;
				]]>
		</sql>
	</changeSet>

	<changeSet id="36.1_pre" author="Somasekhar" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_aview'); 
		]]>
		</sql>
	</changeSet> 
	
	<changeSet id="36.1" author="Somasekhar">
		<createView viewName="RMTFinanceTypes_AView"
			replaceIfExists="true">
			<![CDATA[
			  SELECT t1.fintype,
			   t1.fincategory,
			   t1.fintypedesc,
			   t1.finccy,
			   t1.findayscaltype,
			   t1.finactype,
			   t1.fincontingentactype,
			   t1.finisgenref,
			   t1.finmaxamount,
			   t1.finminamount,
			   t1.finisopennewfinac,
			   t1.findftstmtfrq,
			   t1.finisalwmd,
			   t1.finschdmthd,
			   t1.finisalwgrace,
			   t1.finhistretension,
			   t1.equalrepayment,
			   t1.finratetype,
			   t1.finbaserate,
			   t1.finsplrate,
			   t1.finintrate,
			   t1.finminrate,
			   t1.finmaxrate,
			   t1.findftintfrq,
			   t1.finisintcpz,
			   t1.fincpzfrq,
			   t1.finisrvwalw,
			   t1.finrvwfrq,
			   t1.fingrcratetype,
			   t1.fingrcbaserate,
			   t1.fingrcsplrate,
			   t1.fingrcintrate,
			   t1.fingrcminrate,
			   t1.fingrcmaxrate,
			   t1.fingrcdftintfrq,
			   t1.fingrcisintcpz,
			   t1.fingrccpzfrq,
			   t1.fingrcisrvwalw,
			   t1.fingrcrvwfrq,
			   t1.finminterm,
			   t1.finmaxterm,
			   t1.findftterms,
			   t1.finrpyfrq,
			   t1.finrepaymethod,
			   t1.finisalwpartialrpy,
			   t1.finisalwdifferment,
			   t1.finmaxdifferment,
			   t1.finisalwearlyrpy,
			   t1.finisalwearlysettle,
			   t1.finodrpytries,
			   t1.finearlypayrule,
			   t1.finearlysettlerule,
			   t1.findepositrestrictedto,
			   t1.finaebuyorinception,
			   t1.finaesellormaturity,
			   t1.finisactive,
			   t1.version,
			   t1.lastmntby,
			   t1.lastmnton,
			   t1.recordstatus,
			   t1.rolecode,
			   t1.nextrolecode,
			   t1.taskid,
			   t1.nexttaskid,
			   t1.recordtype,
			   t1.workflowid,
			   t1.stepfinance,
			   t1.steppingmandatory,
			   t1.alwmanualsteps,
			   t1.alwdsteppolicies,
			   t1.dftsteppolicy,
			   t4.actypedesc AS lovdescfincontingentactypename,
			   t5.actypedesc AS lovdescfinactypename,
			   t1.finisdwpayrequired,
			   t1.finrvwrateapplfor,
			   t1.finalwratechangeanydate,
			   t1.finisintcpzatgrcend,
			   t1.finelgrulecode,
			   t1.limitelgrulecode,
			   t1.finschcalcodeonrvw,
			   t1.alwplandeferment,
			   t1.plandefercount,
			   t1.finassettype,
			   t1.pftpayactype,
			   t1.finisopenpftpayacc,
			   t31.actypedesc AS lovdescpftpayactypename,
			   t1.finisalwgrcrepay,
			   t1.fingrcschdmthd,
			   t1.fingrcmargin,
			   t1.finmargin,
			   t1.finscheduleon,
			   t1.fingrcscheduleon,
			   t1.fincommitmentreq,
			   t1.fincollateralreq,
			   t1.findepreciationreq,
			   t1.findepreciationfrq,
			   t1.finbankcontingentactype,
			   t1.finprovisionactype,
			   t38.actypedesc AS lovdescfinbankcontactypename,
			   t39.actypedesc AS lovdescfinprovisionactypename,
			   t1.allowriainvestment,
			   t1.overridelimit,
			   t1.limitrequired,
			   t1.fincommitmentovrride,
			   t1.fincollateralovrride,
			   t1.finpftunchanged,
			   t1.applyodpenalty,
			   t1.odincgrcdays,
			   t1.odchargetype,
			   t1.odgracedays,
			   t1.odchargecalon,
			   t1.odchargeamtorperc,
			   t1.odallowwaiver,
			   t1.odmaxwaiverperc,
			   t1.findivision,
			   t48.divisioncodedesc AS lovdescfindivisionname,
			   t48.entitycode AS lovdescentitycode,
			   t1.finsuspactype,
			   t49.actypedesc AS lovdescfinsuspactypename,
			   t1.product,
			   t1.startdate,
			   t1.enddate,
			   t1.allowdownpaypgm,
			   t1.remarks,
			   t1.alwearlypaymethods,
			   t1.pastduepftcalmthd,
			   t1.pastduepftmargin,
			   t1.alwadvancerent,
			   t1.grcadvbaserate,
			   t1.grcadvmargin,
			   t1.grcadvpftrate,
			   t1.rpyadvbaserate,
			   t1.rpyadvmargin,
			   t1.rpyadvpftrate,
			   t1.rolloverfinance,
			   t1.rolloverfrq,
			   t1.downpayrule,
			   t59.rulecode AS downpayrulecode,
			   t59.rulecodedesc AS downpayruledesc,
			   t1.finsusptrigger,
			   t1.finsuspremarks,
			   t1.alwmultipartydisb,
			   t1.collateraltype,
			   t1.tdsapplicable,
			   t1.manualschedule,
			   t1.applygrcpricing,
			   t1.grcpricingmethod,
			   t1.applyrpypricing,
			   t1.rpypricingmethod,
			   t1.rpyhierarchy,
			   t67.rulecode AS grcpricingmethoddesc,
			   t68.rulecode AS rpypricingmethoddesc,
			   t1.droplineod,
			   t1.droppingmethod,
			   t1.ratechganyday,
			   t1.finrepaypftonfrq,
			   t1.alwbpi,
			   t1.bpitreatment,
			   t1.pftdueschon,
			   t1.planemihalw,
			   t1.planemihmethod,
			   t1.planemihmaxperyear,
			   t1.planemihmax,
			   t1.planemihlockperiod,
			   t1.planemicpz,
			   t1.unplanemihlockperiod,
			   t1.unplanemicpz,
			   t1.reagecpz,
			   t1.fddlockperiod,
			   t1.alwdrpymethods,
			   t1.maxunplannedemi,
			   t1.maxreageholidays,
			   t1.roundingmode,
			   t1.roundingtarget,
			   t1.frequencydays,
			   t1.quickdisb,
			   t1.alwreage,
			   t1.alwunplanemiholiday,
			   t1.alwmaxdisbcheckreq,
			   t1.fintypedesc AS lovdescpromofintypedesc,
			   t1.profitcenterid,
			   t69.profitcentercode,
			   t69.profitcenterdesc,
			   t1.productcategory,
			   t2.productdesc AS fincategorydesc,
			   t1.developerfinance,
			   t1.costoffunds,
			   t1.chequecapturereq,
			   t1.finltvcheck,
			   t1.partiallysecured,
			   t1.alwadvemi,
			   t1.advemiminterms,
			   t1.advemimaxterms,
			   t1.advemidftterms,
			   t1.advemischdmthd,
			   t1.bpipftdaysbasis,
			   t1.eligibilitymethods,
			   t1.alwhybridrate,
			   t1.fixedratetenor,
			   t1.odmincapamount,
			   t1.odrulecode,
			   t1.alwzerointacc,
			   t1.autorejectiondays,
			   t1.taxnomand,
			   t1.putcallrequired,
			   t1.grcadvintersetreq,
			   t1.grcadvtype,
			   t1.grcadvminterms,
			   t1.grcadvmaxterms,
			   t1.grcadvdefaultterms,
			   t1.advintersetreq,
			   t1.advtype,
			   t1.advminterms,
			   t1.advmaxterms,
			   t1.advdefaultterms,
			   t1.advstage,
			   t1.dsfreq,
			   t1.cashcollateralreq,
			   t1.tdsallowtomodify,
			   t1.tdsapplicableto,
			   t1.alwvan,
			   t1.vanallocationmethod,
			   t1.allowdrawingpower,
			   t1.allowrevolving,
			   t1.alwsanctionamt,
			   t1.alwsanctionamtoverride,
			   t1.sanbsdschdle,
			   t1.finisratervwatgrcend,
			   t1.schdonpmtcal,
			   t1.autoapprove,
			   t1.ocrrequired,
			   t1.allowedocrs,
			   t1.defaultocr,
			   t1.allowedloanpurposes,
			   t1.specificloanpurposes,
			   t1.grcadjreq,
			   t1.grcperiodaftrfulldisb,
			   t1.autoincrgrcenddate,
			   t1.grcautoincrmonths,
			   t1.maxautoincrallowed,
			   t1.thrldtomaintaingrcprd,
			   t1.alwLoanSplit,
			   t1.splitLoanType,
			   t1.instbasedschd
			FROM rmtfinancetypes t1
			 LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
			 LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
			 LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
			 LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
			 LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
			 LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
			 LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
			 LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
			 LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			 LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			 LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			 LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
			
			]]>
		</createView>
	</changeSet>
	
		<changeSet id="36.1_post" author="Somasekhar" dbms="postgresql">
		<sql>
 		 <![CDATA[ 
	
			select deps_restore_dependencies ('plf', 'rmtfinancetypes_aview'); 
			
		 ]]>
		</sql>
	</changeSet>

	<changeSet id="37.1" author="Somasekhar">
		<createView viewName="rmtfinancetypes_orgview"
			replaceIfExists="true">
			<![CDATA[
					SELECT t1.fintype,
					t1.fincategory,
					t1.fintypedesc,
					t1.finccy,
					t1.findayscaltype,
					t1.finactype,
					t1.fincontingentactype,
					t1.finisgenref,
					t1.finmaxamount,
					t1.finminamount,
					t1.finisopennewfinac,
					t1.finisalwmd,
					t1.finschdmthd,
					t1.finisalwgrace,
					t1.equalrepayment,
					t1.finratetype,
					t1.finbaserate,
					t1.finsplrate,
					t1.finintrate,
					t1.finminrate,
					t1.finmaxrate,
					t1.findftintfrq,
					t1.finisintcpz,
					t1.fincpzfrq,
					t1.finisrvwalw,
					t1.finrvwfrq,
					t1.fingrcratetype,
					t1.fingrcbaserate,
					t1.fingrcsplrate,
					t1.fingrcintrate,
					t1.fingrcminrate,
					t1.fingrcmaxrate,
					t1.fingrcdftintfrq,
					t1.fingrcisintcpz,
					t1.fingrccpzfrq,
					t1.fingrcisrvwalw,
					t1.fingrcrvwfrq,
					t1.finminterm,
					t1.finmaxterm,
					t1.findftterms,
					t1.finrpyfrq,
					t1.finrepaymethod,
					t1.finisalwdifferment,
					t1.finmaxdifferment,
					t1.finisactive,
					t1.stepfinance,
					t1.steppingmandatory,
					t1.alwmanualsteps,
					t1.alwdsteppolicies,
					t1.dftsteppolicy,
					t1.finisdwpayrequired,
					t1.finrvwrateapplfor,
					t1.finalwratechangeanydate,
					t1.finisintcpzatgrcend,
					t1.finschcalcodeonrvw,
					t1.alwplandeferment,
					t1.plandefercount,
					t1.pftpayactype,
					t1.finisopenpftpayacc,
					t1.finisalwgrcrepay,
					t1.fingrcschdmthd,
					t1.fingrcmargin,
					t1.finmargin,
					t1.fincommitmentreq,
					t1.fincollateralreq,
					t1.findepreciationreq,
					t1.findepreciationfrq,
					t1.finbankcontingentactype,
					t1.finprovisionactype,
					t1.allowriainvestment,
					t1.overridelimit,
					t1.limitrequired,
					t1.fincommitmentovrride,
					t1.fincollateralovrride,
					t1.finrepaypftonfrq,
					t1.finpftunchanged,
					t1.applyodpenalty,
					t1.odincgrcdays,
					t1.odchargetype,
					t1.odgracedays,
					t1.odchargecalon,
					t1.odchargeamtorperc,
					t1.odallowwaiver,
					t1.odmaxwaiverperc,
					t1.findivision,
					t3.divisioncodedesc AS lovdescfindivisionname,
					t1.finsuspactype,
					t1.product,
					t1.startdate,
					t1.enddate,
					t1.allowdownpaypgm,
					t1.fintypedesc AS lovdescpromofintypedesc,
					t1.remarks,
					t4.policydesc AS lovdescdftsteppolicyname,
					t1.pastduepftcalmthd,
					t1.pastduepftmargin,
					t1.alwadvancerent,
					t1.grcadvbaserate,
					t1.grcadvmargin,
					t1.grcadvpftrate,
					t1.rpyadvbaserate,
					t1.rpyadvmargin,
					t1.rpyadvpftrate,
					t1.rolloverfinance,
					t1.rolloverfrq,
					t1.downpayrule,
					t1.alwmultipartydisb,
					t1.collateraltype,
					t1.tdsapplicable,
					t5.rulecode AS downpayrulecode,
					t5.rulecodedesc AS downpayruledesc,
					t1.applygrcpricing,
					t1.applyrpypricing,
					t6.rulecode AS grcpricingmethoddesc,
					t7.rulecode AS rpypricingmethoddesc,
					t1.droplineod,
					t1.droppingmethod,
					t1.ratechganyday,
					t4.steptype AS dftsteppolicytype,
					t1.manualschedule,
					t1.alwbpi,
					t1.bpitreatment,
					t1.pftdueschon,
					t1.planemihalw,
					t1.planemihmethod,
					t1.planemihmaxperyear,
					t1.planemihmax,
					t1.planemihlockperiod,
					t1.planemicpz,
					t1.unplanemihlockperiod,
					t1.unplanemicpz,
					t1.reagecpz,
					t1.fddlockperiod,
					t1.alwdrpymethods,
					t1.maxunplannedemi,
					t1.maxreageholidays,
					t1.roundingmode,
					t1.roundingtarget,
					t1.frequencydays,
					t1.quickdisb,
					t1.alwreage,
					t1.alwunplanemiholiday,
					t1.alwmaxdisbcheckreq,
					t1.productcategory,
					t1.rpyhierarchy,
					t1.developerfinance,
					t3.entitycode AS lovdescentitycode,
					t8.entitydesc AS lovdescentitydesc,
					t1.costoffunds,
					t1.chequecapturereq,
					t1.finltvcheck,
					t1.partiallysecured,
					t1.alwadvemi,
					t1.advemiminterms,
					t1.advemimaxterms,
					t1.advemidftterms,
					t1.advemischdmthd,
					t1.bpipftdaysbasis,
					t1.eligibilitymethods,
					t1.alwhybridrate,
					t1.fixedratetenor,
					t1.odmincapamount,
					t1.odrulecode,
					t1.alwzerointacc,
					t1.finisalwpartialrpy,
					t1.autorejectiondays,
					t1.taxnomand,
					t1.putcallrequired,
					t1.grcadvintersetreq,
					t1.grcadvtype,
					t1.grcadvminterms,
					t1.grcadvmaxterms,
					t1.grcadvdefaultterms,
					t1.advintersetreq,
					t1.advtype,
					t1.advminterms,
					t1.advmaxterms,
					t1.advdefaultterms,
					t1.advstage,
					t1.dsfreq,
					t1.cashcollateralreq,
					t1.alwearlypaymethods,
					t1.tdsallowtomodify,
					t1.tdsapplicableto,
					t1.alwvan,
					t1.vanallocationmethod,
					t1.allowdrawingpower,
					t1.allowrevolving,
					t1.alwsanctionamt,
					t1.alwsanctionamtoverride,
					t1.sanbsdschdle,
					t1.finisratervwatgrcend,
					t1.schdonpmtcal,
					t1.autoapprove,
					t1.ocrrequired,
					t1.allowedocrs,
					t1.defaultocr,
					t1.allowedloanpurposes,
					t1.specificloanpurposes,
					t1.grcadjreq,
					t1.grcperiodaftrfulldisb,
					t1.autoincrgrcenddate,
					t1.grcautoincrmonths,
					t1.maxautoincrallowed,
					t1.thrldtomaintaingrcprd,
					t1.alwLoanSplit,
					t1.splitLoanType,
					t1.instbasedschd					
			FROM rmtfinancetypes t1
				JOIN smtdivisiondetail t3 ON t1.findivision = t3.divisioncode
				LEFT JOIN steppolicyheader t4 ON t1.dftsteppolicy = t4.policycode
				LEFT JOIN rules t5 ON t1.downpayrule = t5.ruleid
				LEFT JOIN rules t6 ON t1.grcpricingmethod = t6.ruleid
				LEFT JOIN rules t7 ON t1.rpypricingmethod = t7.ruleid
				LEFT JOIN entity t8 ON t3.entitycode = t8.entitycode
			]]>
		</createView>
	</changeSet>

	<changeSet id="38.1" author="Somasekhar">
		<createView viewName="rmtfinancetypes_view"
			replaceIfExists="true">
			<![CDATA[
			SELECT t1.fintype,
						t1.fincategory,
						t1.fintypedesc,
						t1.finccy,
						t1.findayscaltype,
						t1.finactype,
						t1.fincontingentactype,
						t1.finisgenref,
						t1.finmaxamount,
						t1.finminamount,
						t1.finisopennewfinac,
						t1.findftstmtfrq,
						t1.finisalwmd,
						t1.finschdmthd,
						t1.finisalwgrace,
						t1.finhistretension,
						t1.equalrepayment,
						t1.finratetype,
						t1.finbaserate,
						t1.finsplrate,
						t1.finintrate,
						t1.finminrate,
						t1.finmaxrate,
						t1.findftintfrq,
						t1.finisintcpz,
						t1.fincpzfrq,
						t1.finisrvwalw,
						t1.finrvwfrq,
						t1.fingrcratetype,
						t1.fingrcbaserate,
						t1.fingrcsplrate,
						t1.fingrcintrate,
						t1.fingrcminrate,
						t1.fingrcmaxrate,
						t1.fingrcdftintfrq,
						t1.fingrcisintcpz,
						t1.fingrccpzfrq,
						t1.fingrcisrvwalw,
						t1.fingrcrvwfrq,
						t1.finminterm,
						t1.finmaxterm,
						t1.findftterms,
						t1.finrpyfrq,
						t1.finrepaymethod,
						t1.finisalwpartialrpy,
						t1.finisalwdifferment,
						t1.finmaxdifferment,
						t1.finisalwearlyrpy,
						t1.finisalwearlysettle,
						t1.finodrpytries,
						t1.finearlypayrule,
						t1.finearlysettlerule,
						t1.findepositrestrictedto,
						t1.finaebuyorinception,
						t1.finaesellormaturity,
						t1.finisactive,
						t1.version,
						t1.lastmntby,
						t1.lastmnton,
						t1.recordstatus,
						t1.rolecode,
						t1.nextrolecode,
						t1.taskid,
						t1.nexttaskid,
						t1.recordtype,
						t1.workflowid,
						t1.stepfinance,
						t1.steppingmandatory,
						t1.alwmanualsteps,
						t1.alwdsteppolicies,
						t1.dftsteppolicy,
						t4.actypedesc AS lovdescfincontingentactypename,
						t5.actypedesc AS lovdescfinactypename,
						t1.finisdwpayrequired,
						t1.finrvwrateapplfor,
						t1.finalwratechangeanydate,
						t1.finisintcpzatgrcend,
						t1.finelgrulecode,
						t1.limitelgrulecode,
						t1.finschcalcodeonrvw,
						t1.alwplandeferment,
						t1.plandefercount,
						t1.finassettype,
						t1.pftpayactype,
						t1.finisopenpftpayacc,
						t31.actypedesc AS lovdescpftpayactypename,
						t1.finisalwgrcrepay,
						t1.fingrcschdmthd,
						t1.fingrcmargin,
						t1.finmargin,
						t1.finscheduleon,
						t1.fingrcscheduleon,
						t1.fincommitmentreq,
						t1.fincollateralreq,
						t1.findepreciationreq,
						t1.findepreciationfrq,
						t1.finbankcontingentactype,
						t1.finprovisionactype,
						t38.actypedesc AS lovdescfinbankcontactypename,
						t39.actypedesc AS lovdescfinprovisionactypename,
						t1.allowriainvestment,
						t1.overridelimit,
						t1.limitrequired,
						t1.fincommitmentovrride,
						t1.fincollateralovrride,
						t1.finpftunchanged,
						t1.applyodpenalty,
						t1.odincgrcdays,
						t1.odchargetype,
						t1.odgracedays,
						t1.odchargecalon,
						t1.odchargeamtorperc,
						t1.odallowwaiver,
						t1.odmaxwaiverperc,
						t1.findivision,
						t48.divisioncodedesc AS lovdescfindivisionname,
						t48.entitycode AS lovdescentitycode,
						t1.finsuspactype,
						t49.actypedesc AS lovdescfinsuspactypename,
						t1.product,
						t1.startdate,
						t1.enddate,
						t1.allowdownpaypgm,
						t1.fintypedesc AS lovdescpromofintypedesc,
						t1.remarks,
						t1.alwearlypaymethods,
						t1.pastduepftcalmthd,
						t1.pastduepftmargin,
						t1.alwadvancerent,
						t1.grcadvbaserate,
						t1.grcadvmargin,
						t1.grcadvpftrate,
						t1.rpyadvbaserate,
						t1.rpyadvmargin,
						t1.rpyadvpftrate,
						t1.rolloverfinance,
						t1.rolloverfrq,
						t1.downpayrule,
						t59.rulecode AS downpayrulecode,
						t59.rulecodedesc AS downpayruledesc,
						t1.finsusptrigger,
						t1.finsuspremarks,
						t1.alwmultipartydisb,
						t1.collateraltype,
						t1.tdsapplicable,
						t1.manualschedule,
						t1.applygrcpricing,
						t1.grcpricingmethod,
						t1.applyrpypricing,
						t1.rpypricingmethod,
						t1.rpyhierarchy,
						t67.rulecode AS grcpricingmethoddesc,
						t68.rulecode AS rpypricingmethoddesc,
						t1.droplineod,
						t1.droppingmethod,
						t1.ratechganyday,
						t1.finrepaypftonfrq,
						t1.alwbpi,
						t1.bpitreatment,
						t1.pftdueschon,
						t1.planemihalw,
						t1.planemihmethod,
						t1.planemihmaxperyear,
						t1.planemihmax,
						t1.planemihlockperiod,
						t1.planemicpz,
						t1.unplanemihlockperiod,
						t1.unplanemicpz,
						t1.reagecpz,
						t1.fddlockperiod,
						t1.alwdrpymethods,
						t1.maxunplannedemi,
						t1.maxreageholidays,
						t1.roundingmode,
						t1.roundingtarget,
						t1.frequencydays,
						t1.quickdisb,
						t1.alwmaxdisbcheckreq,
						t1.alwreage,
						t1.alwunplanemiholiday,
						t1.profitcenterid,
						t69.profitcentercode,
						t69.profitcenterdesc,
						t1.productcategory,
						t2.productdesc AS fincategorydesc,
						t1.developerfinance,
						t1.costoffunds,
						t1.chequecapturereq,
						t1.finltvcheck,
						t1.partiallysecured,
						t1.alwadvemi,
						t1.advemiminterms,
						t1.advemimaxterms,
						t1.advemidftterms,
						t1.advemischdmthd,
						t1.bpipftdaysbasis,
						t1.eligibilitymethods,
						t1.alwhybridrate,
						t1.fixedratetenor,
						t1.odmincapamount,
						t1.odrulecode,
						t1.alwzerointacc,
						t1.autorejectiondays,
						t1.taxnomand,
						t1.putcallrequired,
						t1.grcadvintersetreq,
						t1.grcadvtype,
						t1.grcadvminterms,
						t1.grcadvmaxterms,
						t1.grcadvdefaultterms,
						t1.advintersetreq,
						t1.advtype,
						t1.advminterms,
						t1.advmaxterms,
						t1.advdefaultterms,
						t1.advstage,
						t1.dsfreq,
						t1.cashcollateralreq,
						t1.tdsallowtomodify,
						t1.tdsapplicableto,
						t1.alwvan,
						t1.vanallocationmethod,
						t1.allowdrawingpower,
						t1.allowrevolving,
						t1.alwsanctionamt,
						t1.alwsanctionamtoverride,
						t1.sanbsdschdle,
						t1.finisratervwatgrcend,
						t1.schdonpmtcal,
						t1.autoapprove,
						t1.ocrrequired,
						t1.allowedocrs,
						t1.defaultocr,
						t1.allowedloanpurposes,
						t1.specificloanpurposes,
						t1.grcadjreq,
						t1.grcperiodaftrfulldisb,
						t1.autoincrgrcenddate,
						t1.grcautoincrmonths,
						t1.maxautoincrallowed,
						t1.thrldtomaintaingrcprd, 
						t1.alwLoanSplit,
						t1.splitLoanType,
						t1.instbasedschd
				   FROM rmtfinancetypes_temp t1
					LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
					LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
					LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
					LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
					LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
					LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
					LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
					LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
					LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
					LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
					LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
					LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
			UNION ALL
				SELECT t1.fintype,
					   t1.fincategory,
					   t1.fintypedesc,
					   t1.finccy,
					   t1.findayscaltype,
					   t1.finactype,
					   t1.fincontingentactype,
					   t1.finisgenref,
					   t1.finmaxamount,
					   t1.finminamount,
					   t1.finisopennewfinac,
					   t1.findftstmtfrq,
					   t1.finisalwmd,
					   t1.finschdmthd,
					   t1.finisalwgrace,
					   t1.finhistretension,
					   t1.equalrepayment,
					   t1.finratetype,
					   t1.finbaserate,
					   t1.finsplrate,
					   t1.finintrate,
					   t1.finminrate,
					   t1.finmaxrate,
					   t1.findftintfrq,
					   t1.finisintcpz,
					   t1.fincpzfrq,
					   t1.finisrvwalw,
					   t1.finrvwfrq,
					   t1.fingrcratetype,
					   t1.fingrcbaserate,
					   t1.fingrcsplrate,
					   t1.fingrcintrate,
					   t1.fingrcminrate,
					   t1.fingrcmaxrate,
					   t1.fingrcdftintfrq,
					   t1.fingrcisintcpz,
					   t1.fingrccpzfrq,
					   t1.fingrcisrvwalw,
					   t1.fingrcrvwfrq,
					   t1.finminterm,
					   t1.finmaxterm,
					   t1.findftterms,
					   t1.finrpyfrq,
					   t1.finrepaymethod,
					   t1.finisalwpartialrpy,
					   t1.finisalwdifferment,
					   t1.finmaxdifferment,
					   t1.finisalwearlyrpy,
					   t1.finisalwearlysettle,
					   t1.finodrpytries,
					   t1.finearlypayrule,
					   t1.finearlysettlerule,
					   t1.findepositrestrictedto,
					   t1.finaebuyorinception,
					   t1.finaesellormaturity,
					   t1.finisactive,
					   t1.version,
					   t1.lastmntby,
					   t1.lastmnton,
					   t1.recordstatus,
					   t1.rolecode,
					   t1.nextrolecode,
					   t1.taskid,
					   t1.nexttaskid,
					   t1.recordtype,
					   t1.workflowid,
					   t1.stepfinance,
					   t1.steppingmandatory,
					   t1.alwmanualsteps,
					   t1.alwdsteppolicies,
					   t1.dftsteppolicy,
					   t4.actypedesc AS lovdescfincontingentactypename,
					   t5.actypedesc AS lovdescfinactypename,
					   t1.finisdwpayrequired,
					   t1.finrvwrateapplfor,
					   t1.finalwratechangeanydate,
					   t1.finisintcpzatgrcend,
					   t1.finelgrulecode,
					   t1.limitelgrulecode,
					   t1.finschcalcodeonrvw,
					   t1.alwplandeferment,
					   t1.plandefercount,
					   t1.finassettype,
					   t1.pftpayactype,
					   t1.finisopenpftpayacc,
					   t31.actypedesc AS lovdescpftpayactypename,
					   t1.finisalwgrcrepay,
					   t1.fingrcschdmthd,
					   t1.fingrcmargin,
					   t1.finmargin,
					   t1.finscheduleon,
					   t1.fingrcscheduleon,
					   t1.fincommitmentreq,
					   t1.fincollateralreq,
					   t1.findepreciationreq,
					   t1.findepreciationfrq,
					   t1.finbankcontingentactype,
					   t1.finprovisionactype,
					   t38.actypedesc AS lovdescfinbankcontactypename,
					   t39.actypedesc AS lovdescfinprovisionactypename,
					   t1.allowriainvestment,
					   t1.overridelimit,
					   t1.limitrequired,
					   t1.fincommitmentovrride,
					   t1.fincollateralovrride,
					   t1.finpftunchanged,
					   t1.applyodpenalty,
					   t1.odincgrcdays,
					   t1.odchargetype,
					   t1.odgracedays,
					   t1.odchargecalon,
					   t1.odchargeamtorperc,
					   t1.odallowwaiver,
					   t1.odmaxwaiverperc,
					   t1.findivision,
					   t48.divisioncodedesc AS lovdescfindivisionname,
					   t48.entitycode AS lovdescentitycode,
					   t1.finsuspactype,
					   t49.actypedesc AS lovdescfinsuspactypename,
					   t1.product,
					   t1.startdate,
					   t1.enddate,
					   t1.allowdownpaypgm,
					   t1.fintypedesc AS lovdescpromofintypedesc,
					   t1.remarks,
					   t1.alwearlypaymethods,
					   t1.pastduepftcalmthd,
					   t1.pastduepftmargin,
					   t1.alwadvancerent,
					   t1.grcadvbaserate,
					   t1.grcadvmargin,
					   t1.grcadvpftrate,
					   t1.rpyadvbaserate,
					   t1.rpyadvmargin,
					   t1.rpyadvpftrate,
					   t1.rolloverfinance,
					   t1.rolloverfrq,
					   t1.downpayrule,
					   t59.rulecode AS downpayrulecode,
					   t59.rulecodedesc AS downpayruledesc,
					   t1.finsusptrigger,
					   t1.finsuspremarks,
					   t1.alwmultipartydisb,
					   t1.collateraltype,
					   t1.tdsapplicable,
					   t1.manualschedule,
					   t1.applygrcpricing,
					   t1.grcpricingmethod,
					   t1.applyrpypricing,
					   t1.rpypricingmethod,
					   t1.rpyhierarchy,
					   t67.rulecode AS grcpricingmethoddesc,
					   t68.rulecode AS rpypricingmethoddesc,
					   t1.droplineod,
					   t1.droppingmethod,
					   t1.ratechganyday,
					   t1.finrepaypftonfrq,
					   t1.alwbpi,
					   t1.bpitreatment,
					   t1.pftdueschon,
					   t1.planemihalw,
					   t1.planemihmethod,
					   t1.planemihmaxperyear,
					   t1.planemihmax,
					   t1.planemihlockperiod,
					   t1.planemicpz,
					   t1.unplanemihlockperiod,
					   t1.unplanemicpz,
					   t1.reagecpz,
					   t1.fddlockperiod,
					   t1.alwdrpymethods,
					   t1.maxunplannedemi,
					   t1.maxreageholidays,
					   t1.roundingmode,
					   t1.roundingtarget,
					   t1.frequencydays,
					   t1.quickdisb,
					   t1.alwmaxdisbcheckreq,
					   t1.alwreage,
					   t1.alwunplanemiholiday,
					   t1.profitcenterid,
					   t69.profitcentercode,
					   t69.profitcenterdesc,
					   t1.productcategory,
					   t2.productdesc AS fincategorydesc,
					   t1.developerfinance,
					   t1.costoffunds,
					   t1.chequecapturereq,
					   t1.finltvcheck,
					   t1.partiallysecured,
					   t1.alwadvemi,
					   t1.advemiminterms,
					   t1.advemimaxterms,
					   t1.advemidftterms,
					   t1.advemischdmthd,
					   t1.bpipftdaysbasis,
					   t1.eligibilitymethods,
					   t1.alwhybridrate,
					   t1.fixedratetenor,
					   t1.odmincapamount,
					   t1.odrulecode,
					   t1.alwzerointacc,
					   t1.autorejectiondays,
					   t1.taxnomand,
					   t1.putcallrequired,
					   t1.grcadvintersetreq,
					   t1.grcadvtype,
					   t1.grcadvminterms,
					   t1.grcadvmaxterms,
					   t1.grcadvdefaultterms,
					   t1.advintersetreq,
					   t1.advtype,
					   t1.advminterms,
					   t1.advmaxterms,
					   t1.advdefaultterms,
					   t1.advstage,
					   t1.dsfreq,
					   t1.cashcollateralreq,
					   t1.tdsallowtomodify,
					   t1.tdsapplicableto,
					   t1.alwvan,
					   t1.vanallocationmethod,
					   t1.allowdrawingpower,
					   t1.allowrevolving,
					   t1.alwsanctionamt,
					   t1.alwsanctionamtoverride,
					   t1.sanbsdschdle,
					   t1.finisratervwatgrcend,
					   t1.schdonpmtcal,
					   t1.autoapprove,
					   t1.ocrrequired,
					   t1.allowedocrs,
					   t1.defaultocr,
					   t1.allowedloanpurposes,
					   t1.specificloanpurposes,
					   t1.grcadjreq,
					   t1.grcperiodaftrfulldisb,
					   t1.autoincrgrcenddate,
					   t1.grcautoincrmonths,
					   t1.maxautoincrallowed,
					   t1.thrldtomaintaingrcprd,
					   t1.alwLoanSplit,
					   t1.splitLoanType,
					   t1.instbasedschd					   
					FROM rmtfinancetypes t1
					  LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
					  LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
					  LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
					  LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
					  LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
					  LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
					  LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
					  LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
					  LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
					  LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
					  LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
					  LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
					  WHERE NOT (EXISTS ( SELECT 1 AS expr1
					  FROM rmtfinancetypes_temp
					  WHERE rmtfinancetypes_temp.fintype = t1.fintype))
			
			]]>
		</createView>
	</changeSet>

	<changeSet id="39_pre_1" author="Somasekhar" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				truncate table deps_saved_ddl;
				]]>
		</sql>
	</changeSet>
	
	<changeSet id="39_pre" author="Somasekhar" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain'); 
			select deps_save_and_drop_dependencies ('plf', 'financemain_temp'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="39" author="Somasekhar">
		<createView viewName="financemain_aview" replaceIfExists="true">
			<![CDATA[
			SELECT t1.finreference,
			t1.investmentref,
			t1.numberofterms,
			t1.grcperiodenddate,
			t1.allowgrcperiod,
			t1.gracebaserate,
			t1.gracespecialrate,
			t1.grcpftrate,
			t1.grcpftfrq,
			t1.nextgrcpftdate,
			t1.allowgrcpftrvw,
			t1.grcpftrvwfrq,
			t1.nextgrcpftrvwdate,
			t1.allowgrccpz,
			t1.grccpzfrq,
			t1.nextgrccpzdate,
			t1.repaybaserate,
			t1.repayspecialrate,
			t1.repayprofitrate,
			t1.repayfrq,
			t1.nextrepaydate,
			t1.repaypftfrq,
			t1.nextrepaypftdate,
			t1.allowrepayrvw,
			t1.repayrvwfrq,
			t1.nextrepayrvwdate,
			t1.allowrepaycpz,
			t1.repaycpzfrq,
			t1.nextrepaycpzdate,
			t1.maturitydate,
			t1.cpzatgraceend,
			t1.downpayment,
			t1.graceflatamount,
			t1.reqrepayamount,
			t1.totalprofit,
			t1.totalcpz,
			t1.totalgrosspft,
			t1.totalgrossgrcpft,
			t1.totalgracepft,
			t1.totalgracecpz,
			t1.grcratebasis,
			t1.repayratebasis,
			t1.fintype,
			t1.finremarks,
			t1.finccy,
			t1.schedulemethod,
			t1.profitdaysbasis,
			t1.reqmaturity,
			t1.calterms,
			t1.calmaturity,
			t1.firstrepay,
			t1.lastrepay,
			t1.finstartdate,
			t1.finamount,
			t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
			t1.finrepaymentamount,
			t1.custid,
			t1.defferments,
			t1.plandefercount,
			t1.finbranch,
			t1.finsourceid,
			t1.alloweddefrpychange,
			t1.availeddefrpychange,
			t1.alloweddeffrqchange,
			t1.availeddeffrqchange,
			t1.recaltype,
			t1.finassetvalue,
			t1.disbaccountid,
			t1.repayaccountid,
			t1.finisactive,
			t1.limitvalid,
			t1.overridelimit,
			t1.securitydeposit,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t7.fintypedesc AS lovdescfintypename,
			t7.finmaxamount AS lovdescfinmaxamt,
			t7.finminamount AS lovdescfinminamount,
			t1.mindownpayperc,
			t7.finisalwdifferment AS lovdescfinalwdeferment,
			t7.finisdwpayrequired AS lovdescdwnpayreq,
			t7.finmaxdifferment AS lovdescfinmaxdifferment,
			t12.branchdesc AS lovdescfinbranchname,
			t12.branchprovince AS finbranchprovincecode,
			t1.lastrepaydate,
			t1.lastrepaypftdate,
			t1.lastrepayrvwdate,
			t1.lastrepaycpzdate,
			t1.allowgrcrepay,
			t1.grcschdmthd,
			t1.grcmargin,
			t1.repaymargin,
			t1.fincurrassetvalue,
			t1.fincommitmentref,
			t1.finlimitref,
			t1.depreciationfrq,
			t1.fincontractdate,
			t1.nextdepdate,
			t1.lastdepdate,
			t1.finaccount,
			t1.fincustpftaccount,
			t17.acrtilllbd AS lovdescaccruedtilllbd,
			t7.finrvwrateapplfor,
			t1.totalrepayamt,
			t1.closingstatus,
			t1.finapproveddate,
			t1.feechargeamt,
			t1.blacklisted,
			t1.finrepaypftonfrq,
			t1.anualizedpercrate,
			t1.effectiverateofreturn,
			t1.migratedfinance,
			t1.schedulemaintained,
			t1.scheduleregenerated,
			t1.finpurpose,
			t39.loanpurposedesc AS lovdescfinpurposename,
			t1.finstatus,
			t1.finstsreason,
			t1.initiateuser,
			t1.bankname,
			t1.iban,
			t1.accounttype,
			t1.ddareferenceno,
			t7.finscheduleon AS lovdescfinscheduleon,
			t1.custdsr,
			t1.jointaccount,
			t1.jointcustid,
			t1.downpaybank,
			t1.downpaysupl,
			t1.downpayaccount,
			t1.securitycollateral,
			t1.approved,
			t1.discrepancy,
			t1.limitapproved,
			t1.graceterms,
			t7.findivision AS lovdescfindivision,
			t1.rcdmaintainsts,
			t1.finrepaymethod,
			t1.grcprofitdaysbasis,
			t1.stepfinance,
			t1.steptype,
			t1.steppolicy,
			t1.alwmanualsteps,
			t1.noofsteps,
			t1.linkedfinref,
			t1.nextuserid,
			t1.priority,
			t24.policydesc AS lovdescsteppolicyname,
			t1.grcminrate,
			t1.grcmaxrate,
			t1.rpyminrate,
			t1.rpymaxrate,
			t1.deviationapproval,
			t1.manualschedule,
			t1.takeoverfinance,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.supplementrent,
			t1.increasedcost,
			t1.creditinsamt,
			t1.rolloverfrq,
			t1.nextrolloverdate,
			t27.custstsdescription,
			t1.shariastatus,
			t1.initiatedate,
			t1.finpreapprovedref,
			t1.mmaid,
			t1.accountsofficer,
			t1.feeaccountid,
			t1.fincancelac,
			t28.dealername AS lovdescaccountsofficer,
			t28.dealercity AS lovdescsourcecity,
			t1.dsacode,
			t30.rofficerdesc AS dsacodedesc,
			t1.tdsapplicable,
			t1.mandateid,
			t1.droplinefrq,
			t1.firstdroplinedate,
			t1.pftservicingodlimit,
			t1.insuranceamt,
			t1.deductinsdisb,
			t1.alwbpi,
			t1.bpitreatment,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.calroundingmode,
			t1.alwmultidisb,
			t1.applicationno,
			t1.referralid,
			t33.rofficerdesc AS referraliddesc,
			t1.dmacode,
			t34.rofficerdesc AS dmacodedesc,
			t1.salesdepartment,
			t35.deptdesc AS salesdepartmentdesc,
			t1.quickdisb,
			t1.wifreference,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.availedunplanemi,
			t1.availedreageh,
			t1.bpiamount,
			t1.deductfeedisb,
			t1.rvwrateapplfor,
			t1.schcalonrvw,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.promotioncode,
			t1.restructureloan,
			t1.oldfinreference,
			t1.reagebucket,
			t1.fincategory,
			t1.productcategory,
			t1.roundingtarget,
			t36.entitycode AS lovdescentitycode,
			t1.eligibilitymethod,
			t38.fieldcodevalue AS loveligibilitymethod,
			t38.valuedesc AS lovdesceligibilitymethod,
			t1.employeename,
			t37.rofficerdesc AS employeenamedesc,
			t1.samplingrequired,
			t1.legalrequired,
			t1.grcmaxamount,
			t1.connector,
			t40.dealername AS connectorcode,
			t40.dealercity AS connectordesc,
			t1.advanceemi,
			t1.advemiterms,
			t1.bpipftdaysbasis,
			t1.fixedratetenor,
			t1.fixedtenorrate,
			t12.branchtel AS finbranchcontact,
			t1.processattributes,
			t1.businessvertical,
			bv.code AS businessverticalcode,
			bv.description AS businessverticaldesc,
			t1.grcadvtype,
			t1.grcadvterms,
			t1.advtype,
			t1.advterms,
			t1.advstage,
			t1.tdspercentage,
			t1.tdsstartdate,
			t1.tdsenddate,
			t1.tdslimitamt,
			t1.vanreq,
			t1.vancode,
			t1.allowdrawingpower,
			t1.allowrevolving,
			t1.sanbsdschdle,
			t1.promotionseqid,
			t1.svamount,
			t1.cbamount,
			t1.appliedloanamt,
			t1.finisratervwatgrcend,
			t1.reqloanamt,
			t1.reqloantenor,
			t1.finocrrequired,
			t1.offerproduct,
			t1.offeramount,
			t1.custsegmentation,
			t1.baseproduct,
			t1.processtype,
			t1.bureautimeseries,
			t1.campaignname,
			t1.existinglanrefno,
			t1.leadsource,
			t1.posource,
			t1.rsa,
			t1.verification,
			t1.sourcingbranch,
			t1.sourchannelcategory,
			t1.asmname,
			t13.branchdesc AS lovDescSourcingBranch,
			t1.EndGrcPeriodAftrFullDisb,
			t1.AutoIncGrcEndDate,
			t1.AlwGrcAdj,
			t1.pMay,
			t1.OfferId,
			t1.alwLoanSplit,
			t1.ParentRef,
			t1.loanSplitted,
			t1.instbasedschd
		FROM financemain t1
			JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
			LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
			LEFT JOIN rmtbranches t13 ON t1.sourcingbranch = t13.branchcode
			LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
			LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
			LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
			LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
			LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
			LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
			LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
			LEFT JOIN bmtdepartments t35 ON t1.salesdepartment = t35.deptcode
			LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
			LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
			LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
			LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
			LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
			LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical

			]]>
		</createView>
	</changeSet>

	<changeSet id="40" author="Somasekhar">
		<createView viewName="financemain_dview" replaceIfExists="true">
			<![CDATA[
			
					SELECT t1.finreference,
					t1.investmentref,
					t1.fintype,
					t1.finccy,
					t1.finamount,
					t1.downpayment,
					t1.feechargeamt,
					t1.schedulemethod,
					t1.recordstatus,
					t1.recordtype,
					t1.rolecode,
					t1.nextrolecode,
					t1.finbranch,
					t1.finassetvalue,
					t2.custcif AS lovdesccustcif,
					t2.custshrtname AS lovdesccustshrtname,
					t2.custid,
					t2.custcif,
					t3.fincategory AS lovdescproductcodename,
					t3.findivision AS lovdescfindivision,
					t1.Samplingrequired,
					t1.Legalrequired,
					t1.instbasedschd
					FROM (((financemain_temp t1
					 JOIN customers t2 ON ((t1.custid = t2.custid)))
					 JOIN rmtfinancetypes t3 ON ((t3.fintype = t1.fintype)))
					 JOIN investmentfinheader t4 ON ((t4.investmentref = t1.investmentref)))
			]]>
		</createView>
	</changeSet>

	<changeSet id="41" author="Somasekhar">
		<createView viewName="financemain_lview" replaceIfExists="true">
			<![CDATA[	
				SELECT
				t1.finreference,
				t1.investmentref,
				t1.fintype,
				t1.finccy,
				t1.finamount,
				t1.downpayment,
				t1.feechargeamt,
				t1.schedulemethod,
				t1.numberofterms,
				t1.recordstatus,
				t1.recordtype,
				t1.rolecode,
				t1.nextrolecode,
				t1.finbranch,
				t1.fincontractdate,
				t1.linkedfinref,
				t1.nextuserid,
				t1.priority,
				t1.workflowid,
				t1.taskid,
				t1.nexttaskid,
				t1.finpreapprovedref,
				t1.rcdmaintainsts,
				t1.insuranceamt,
				t1.fincurrassetvalue,
				t1.calterms,
				t1.deviationapproval,
				t1.finpurpose,
				t1.initiatedate,
				t1.finassetvalue,
				t2.custcif AS lovdesccustcif,
				t2.custshrtname AS lovdesccustshrtname,
				t2.custpassportno AS lovdesccustpassportno,
				t2.custdob AS lovdesccustdob,
				t2.custcrcpr AS lovdesccustcrcpr,
				t2.phonenumber,
				t3.fincategory AS lovdescproductcodename,
				t3.findivision AS lovdescfindivision,
				t3.product AS lovdescfinproduct,
				t3.fintypedesc AS lovdescfintypename,
				COALESCE(t4.roledesc,${add.schema}fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
				t1.samplingrequired,
				t1.advanceemi,
				t1.advemiterms,
				t1.bpipftdaysbasis,
				t1.graceterms,
				t1.productcategory,
				t1.reqloanamt,
				t1.reqloantenor,
				t1.finocrrequired,
				t1.offerproduct,
				t1.offeramount,
				t1.custsegmentation,
				t1.baseproduct,
				t1.processtype,
				t1.bureautimeseries,
				t1.campaignname,
				t1.existinglanrefno,
				t1.leadsource,
				t1.posource,
				t1.rsa,
				t1.verification,
				t1.sourcingbranch,
				t1.sourchannelcategory,
				t1.asmname,
				t1.offerid,
				t1.applicationno,
				t1.lastmnton,
				t1.CustID,
				t1.instbasedschd
				FROM financemain_temp t1
				JOIN customers t2 ON t1.custid = t2.custid
				JOIN rmtfinancetypes t3 ON t3.fintype = t1.fintype
				LEFT JOIN secroles t4 ON t1.nextrolecode = t4.rolecd
			]]>
		</createView>
	</changeSet>

	<changeSet id="42" author="Somasekhar">
		<createView viewName="financemain_view" replaceIfExists="true">
			<![CDATA[		
			SELECT t1.finreference,
			    t1.investmentref,
			    t1.numberofterms,
			    t1.grcperiodenddate,
			    t1.allowgrcperiod,
			    t1.gracebaserate,
			    t1.gracespecialrate,
			    t1.grcpftrate,
			    t1.grcpftfrq,
			    t1.nextgrcpftdate,
			    t1.allowgrcpftrvw,
			    t1.grcpftrvwfrq,
			    t1.nextgrcpftrvwdate,
			    t1.allowgrccpz,
			    t1.grccpzfrq,
			    t1.nextgrccpzdate,
			    t1.repaybaserate,
			    t1.repayspecialrate,
			    t1.repayprofitrate,
			    t1.repayfrq,
			    t1.nextrepaydate,
			    t1.repaypftfrq,
			    t1.nextrepaypftdate,
			    t1.allowrepayrvw,
			    t1.repayrvwfrq,
			    t1.nextrepayrvwdate,
			    t1.allowrepaycpz,
			    t1.repaycpzfrq,
			    t1.nextrepaycpzdate,
			    t1.maturitydate,
			    t1.cpzatgraceend,
			    t1.downpayment,
			    t1.graceflatamount,
			    t1.reqrepayamount,
			    t1.totalprofit,
			    t1.totalcpz,
			    t1.totalgrosspft,
			    t1.totalgrossgrcpft,
			    t1.totalgracepft,
			    t1.totalgracecpz,
			    t1.grcratebasis,
			    t1.repayratebasis,
			    t1.fintype,
			    t1.finremarks,
			    t1.finccy,
			    t1.schedulemethod,
			    t1.profitdaysbasis,
			    t1.reqmaturity,
			    t1.calterms,
			    t1.calmaturity,
			    t1.firstrepay,
			    t1.lastrepay,
			    t1.finstartdate,
			    t1.finamount,
			    ((t1.finamount + t1.feechargeamt) - t1.downpayment) AS lovdescfinancingamount,
			    t1.finrepaymentamount,
			    t1.custid,
			    t1.defferments,
			    t1.plandefercount,
			    t1.finbranch,
			    t1.finsourceid,
			    t1.alloweddefrpychange,
			    t1.availeddefrpychange,
			    t1.alloweddeffrqchange,
			    t1.availeddeffrqchange,
			    t1.recaltype,
			    t1.finassetvalue,
			    t1.disbaccountid,
			    t1.repayaccountid,
			    t1.finisactive,
			    t1.limitvalid,
			    t1.overridelimit,
			    t1.securitydeposit,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t7.fintypedesc AS lovdescfintypename,
			    t7.finmaxamount AS lovdescfinmaxamt,
			    t7.finminamount AS lovdescfinminamount,
			    t1.mindownpayperc,
			    t7.finisalwdifferment AS lovdescfinalwdeferment,
			    t7.finisdwpayrequired AS lovdescdwnpayreq,
			    t7.finmaxdifferment AS lovdescfinmaxdifferment,
			    t12.branchdesc AS lovdescfinbranchname,
			    t12.branchprovince AS finbranchprovincecode,
			    t1.lastrepaydate,
			    t1.lastrepaypftdate,
			    t1.lastrepayrvwdate,
			    t1.lastrepaycpzdate,
			    t1.allowgrcrepay,
			    t1.grcschdmthd,
			    t1.grcmargin,
			    t1.repaymargin,
			    t1.fincurrassetvalue,
			    t1.fincommitmentref,
			    t1.finlimitref,
			    t1.depreciationfrq,
			    t1.fincontractdate,
			    t1.nextdepdate,
			    t1.lastdepdate,
			    t1.finaccount,
			    t1.fincustpftaccount,
			    t17.acrtilllbd AS lovdescaccruedtilllbd,
			    t7.finrvwrateapplfor,
			    t1.totalrepayamt,
			    t1.closingstatus,
			    t1.finapproveddate,
			    t1.feechargeamt,
			    t1.blacklisted,
			    t1.finrepaypftonfrq,
			    t1.anualizedpercrate,
			    t1.effectiverateofreturn,
			    t1.migratedfinance,
			    t1.schedulemaintained,
			    t1.scheduleregenerated,
			    t1.finpurpose,
			    t39.loanpurposedesc AS lovdescfinpurposename,
			    t1.finstatus,
			    t1.finstsreason,
			    t1.initiateuser,
			    t1.bankname,
			    t1.iban,
			    t1.accounttype,
			    t1.ddareferenceno,
			    t7.finscheduleon AS lovdescfinscheduleon,
			    t1.custdsr,
			    t1.jointaccount,
			    t1.jointcustid,
			    t1.downpaybank,
			    t1.downpaysupl,
			    t1.downpayaccount,
			    t1.securitycollateral,
			    t1.approved,
			    t1.discrepancy,
			    t1.limitapproved,
			    t1.graceterms,
			    t7.findivision AS lovdescfindivision,
			    t1.rcdmaintainsts,
			    t1.finrepaymethod,
			    t1.grcprofitdaysbasis,
			    t1.stepfinance,
			    t1.steptype,
			    t1.steppolicy,
			    t1.alwmanualsteps,
			    t1.noofsteps,
			    t1.linkedfinref,
			    t1.nextuserid,
			    t1.priority,
			    t24.policydesc AS lovdescsteppolicyname,
			    t1.grcminrate,
			    t1.grcmaxrate,
			    t1.rpyminrate,
			    t1.rpymaxrate,
			    t1.deviationapproval,
			    t1.manualschedule,
			    t1.takeoverfinance,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.supplementrent,
			    t1.increasedcost,
			    t1.creditinsamt,
			    t1.rolloverfrq,
			    t1.nextrolloverdate,
			    t27.custstsdescription,
			    t1.shariastatus,
			    t1.initiatedate,
			    t1.finpreapprovedref,
			    t1.mmaid,
			    t1.accountsofficer,
			    t1.feeaccountid,
			    t1.fincancelac,
			    t28.dealername AS lovdescaccountsofficer,
			    t28.dealercity AS lovdescsourcecity,
			    t1.dsacode,
			    t30.rofficerdesc AS dsacodedesc,
			    t1.tdsapplicable,
			    t1.mandateid,
			    t1.droplinefrq,
			    t1.firstdroplinedate,
			    t1.pftservicingodlimit,
			    t1.insuranceamt,
			    t1.deductinsdisb,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.calroundingmode,
			    t1.alwmultidisb,
			    t1.applicationno,
			    t1.referralid,
			    t33.rofficerdesc AS referraliddesc,
			    t1.dmacode,
			    t34.rofficerdesc AS dmacodedesc,
			    t1.salesdepartment,
			    t35.deptdesc AS salesdepartmentdesc,
			    t1.quickdisb,
			    t1.wifreference,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.availedunplanemi,
			    t1.availedreageh,
			    t1.bpiamount,
			    t1.deductfeedisb,
			    t1.rvwrateapplfor,
			    t1.schcalonrvw,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.promotioncode,
			    t1.restructureloan,
			    t1.oldfinreference,
			    t1.reagebucket,
			    t1.fincategory,
			    t1.productcategory,
			    t1.roundingtarget,
			    t36.entitycode AS lovdescentitycode,
			    t1.eligibilitymethod,
			    t38.fieldcodevalue AS loveligibilitymethod,
			    t38.valuedesc AS lovdesceligibilitymethod,
			    t1.employeename,
			    t37.rofficerdesc AS employeenamedesc,
			    t1.samplingrequired,
			    t1.legalrequired,
			    t1.grcmaxamount,
			    t1.connector,
			    t40.dealername AS connectorcode,
			    t40.dealercity AS connectordesc,
			    t1.advanceemi,
			    t1.advemiterms,
			    t1.bpipftdaysbasis,
			    t1.fixedratetenor,
			    t1.fixedtenorrate,
			    t12.branchtel AS finbranchcontact,
			    t1.processattributes,
			    t1.businessvertical,
			    bv.code AS businessverticalcode,
			    bv.description AS businessverticaldesc,
			    t1.grcadvtype,
			    t1.grcadvterms,
			    t1.advtype,
			    t1.advterms,
			    t1.advstage,
			    t1.tdspercentage,
			    t1.tdsstartdate,
			    t1.tdsenddate,
			    t1.tdslimitamt,
			    t1.vanreq,
			    t1.vancode,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.sanbsdschdle,
			    t1.promotionseqid,
			    t1.svamount,
			    t1.cbamount,
			    t1.appliedloanamt,
			    t1.finisratervwatgrcend,
			    t1.reqloanamt,
			    t1.reqloantenor,
			    t1.finocrrequired,
			    t1.offerproduct,
			    t1.offeramount,
			    t1.custsegmentation,
			    t1.baseproduct,
			    t1.processtype,
			    t1.bureautimeseries,
			    t1.campaignname,
			    t1.existinglanrefno,
			    t1.leadsource,
			    t1.posource,
			    t1.rsa,
			    t1.verification,
			    t1.sourcingbranch,
			    t1.sourchannelcategory,
			    t1.asmname,
			    t13.branchdesc AS lovdescsourcingbranch,
				t1.OfferId,
                t1.EndGrcPeriodAftrFullDisb,
                t1.AutoIncGrcEndDate,
                t1.AlwGrcAdj,
				t1.pMay,
				t1.alwLoanSplit,
				t1.ParentRef,
				t1.loanSplitted,
				t1.instbasedschd
			   FROM (((((((((((((((((financemain_temp t1
			     JOIN rmtfinancetypes t7 ON (((t1.fintype) = (t7.fintype))))
			     LEFT JOIN rmtbranches t12 ON (((t1.finbranch) = (t12.branchcode))))
			     LEFT JOIN rmtbranches t13 ON (((t1.sourcingbranch) = (t13.branchcode))))
			     LEFT JOIN finpftdetails t17 ON (((t17.finreference) = (t1.finreference))))
			     LEFT JOIN steppolicyheader t24 ON (((t1.steppolicy) = (t24.policycode))))
			     LEFT JOIN bmtcuststatuscodes t27 ON (((t1.finstatus) = (t27.custstscode))))
			     LEFT JOIN amtvehicledealer t28 ON ((t1.accountsofficer = t28.dealerid)))
			     LEFT JOIN relationshipofficers t30 ON (((t1.dsacode) = (t30.rofficercode))))
			     LEFT JOIN relationshipofficers t33 ON (((t1.referralid) = (t33.rofficercode))))
			     LEFT JOIN relationshipofficers t34 ON (((t1.dmacode) = (t34.rofficercode))))
			     LEFT JOIN bmtdepartments t35 ON (((t1.salesdepartment) = (t35.deptcode))))
			     LEFT JOIN smtdivisiondetail t36 ON (((t7.findivision) = (t36.divisioncode))))
			     LEFT JOIN relationshipofficers t37 ON (((t1.employeename) = (t37.rofficercode))))
			     LEFT JOIN rmtlovfielddetail t38 ON (((t1.eligibilitymethod = t38.fieldcodeid) AND ((t38.fieldcode) ='ELGMETHOD'))))
			     LEFT JOIN loanpurposes t39 ON (((t1.finpurpose) = (t39.loanpurposecode))))
			     LEFT JOIN amtvehicledealer t40 ON ((t1.connector = t40.dealerid)))
			     LEFT JOIN business_vertical bv ON ((bv.id = t1.businessvertical)))
			UNION ALL
			 SELECT t1.finreference,
			    t1.investmentref,
			    t1.numberofterms,
			    t1.grcperiodenddate,
			    t1.allowgrcperiod,
			    t1.gracebaserate,
			    t1.gracespecialrate,
			    t1.grcpftrate,
			    t1.grcpftfrq,
			    t1.nextgrcpftdate,
			    t1.allowgrcpftrvw,
			    t1.grcpftrvwfrq,
			    t1.nextgrcpftrvwdate,
			    t1.allowgrccpz,
			    t1.grccpzfrq,
			    t1.nextgrccpzdate,
			    t1.repaybaserate,
			    t1.repayspecialrate,
			    t1.repayprofitrate,
			    t1.repayfrq,
			    t1.nextrepaydate,
			    t1.repaypftfrq,
			    t1.nextrepaypftdate,
			    t1.allowrepayrvw,
			    t1.repayrvwfrq,
			    t1.nextrepayrvwdate,
			    t1.allowrepaycpz,
			    t1.repaycpzfrq,
			    t1.nextrepaycpzdate,
			    t1.maturitydate,
			    t1.cpzatgraceend,
			    t1.downpayment,
			    t1.graceflatamount,
			    t1.reqrepayamount,
			    t1.totalprofit,
			    t1.totalcpz,
			    t1.totalgrosspft,
			    t1.totalgrossgrcpft,
			    t1.totalgracepft,
			    t1.totalgracecpz,
			    t1.grcratebasis,
			    t1.repayratebasis,
			    t1.fintype,
			    t1.finremarks,
			    t1.finccy,
			    t1.schedulemethod,
			    t1.profitdaysbasis,
			    t1.reqmaturity,
			    t1.calterms,
			    t1.calmaturity,
			    t1.firstrepay,
			    t1.lastrepay,
			    t1.finstartdate,
			    t1.finamount,
			    ((t1.finamount + t1.feechargeamt) - t1.downpayment) AS lovdescfinancingamount,
			    t1.finrepaymentamount,
			    t1.custid,
			    t1.defferments,
			    t1.plandefercount,
			    t1.finbranch,
			    t1.finsourceid,
			    t1.alloweddefrpychange,
			    t1.availeddefrpychange,
			    t1.alloweddeffrqchange,
			    t1.availeddeffrqchange,
			    t1.recaltype,
			    t1.finassetvalue,
			    t1.disbaccountid,
			    t1.repayaccountid,
			    t1.finisactive,
			    t1.limitvalid,
			    t1.overridelimit,
			    t1.securitydeposit,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t7.fintypedesc AS lovdescfintypename,
			    t7.finmaxamount AS lovdescfinmaxamt,
			    t7.finminamount AS lovdescfinminamount,
			    t1.mindownpayperc,
			    t7.finisalwdifferment AS lovdescfinalwdeferment,
			    t7.finisdwpayrequired AS lovdescdwnpayreq,
			    t7.finmaxdifferment AS lovdescfinmaxdifferment,
			    t12.branchdesc AS lovdescfinbranchname,
			    t12.branchprovince AS finbranchprovincecode,
			    t1.lastrepaydate,
			    t1.lastrepaypftdate,
			    t1.lastrepayrvwdate,
			    t1.lastrepaycpzdate,
			    t1.allowgrcrepay,
			    t1.grcschdmthd,
			    t1.grcmargin,
			    t1.repaymargin,
			    t1.fincurrassetvalue,
			    t1.fincommitmentref,
			    t1.finlimitref,
			    t1.depreciationfrq,
			    t1.fincontractdate,
			    t1.nextdepdate,
			    t1.lastdepdate,
			    t1.finaccount,
			    t1.fincustpftaccount,
			    t17.acrtilllbd AS lovdescaccruedtilllbd,
			    t7.finrvwrateapplfor,
			    t1.totalrepayamt,
			    t1.closingstatus,
			    t1.finapproveddate,
			    t1.feechargeamt,
			    t1.blacklisted,
			    t1.finrepaypftonfrq,
			    t1.anualizedpercrate,
			    t1.effectiverateofreturn,
			    t1.migratedfinance,
			    t1.schedulemaintained,
			    t1.scheduleregenerated,
			    t1.finpurpose,
			    t39.loanpurposedesc AS lovdescfinpurposename,
			    t1.finstatus,
			    t1.finstsreason,
			    t1.initiateuser,
			    t1.bankname,
			    t1.iban,
			    t1.accounttype,
			    t1.ddareferenceno,
			    t7.finscheduleon AS lovdescfinscheduleon,
			    t1.custdsr,
			    t1.jointaccount,
			    t1.jointcustid,
			    t1.downpaybank,
			    t1.downpaysupl,
			    t1.downpayaccount,
			    t1.securitycollateral,
			    t1.approved,
			    t1.discrepancy,
			    t1.limitapproved,
			    t1.graceterms,
			    t7.findivision AS lovdescfindivision,
			    t1.rcdmaintainsts,
			    t1.finrepaymethod,
			    t1.grcprofitdaysbasis,
			    t1.stepfinance,
			    t1.steptype,
			    t1.steppolicy,
			    t1.alwmanualsteps,
			    t1.noofsteps,
			    t1.linkedfinref,
			    t1.nextuserid,
			    t1.priority,
			    t24.policydesc AS lovdescsteppolicyname,
			    t1.grcminrate,
			    t1.grcmaxrate,
			    t1.rpyminrate,
			    t1.rpymaxrate,
			    t1.deviationapproval,
			    t1.manualschedule,
			    t1.takeoverfinance,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.supplementrent,
			    t1.increasedcost,
			    t1.creditinsamt,
			    t1.rolloverfrq,
			    t1.nextrolloverdate,
			    t27.custstsdescription,
			    t1.shariastatus,
			    t1.initiatedate,
			    t1.finpreapprovedref,
			    t1.mmaid,
			    t1.accountsofficer,
			    t1.feeaccountid,
			    t1.fincancelac,
			    t28.dealername AS lovdescaccountsofficer,
			    t28.dealercity AS lovdescsourcecity,
			    t1.dsacode,
			    t30.rofficerdesc AS dsacodedesc,
			    t1.tdsapplicable,
			    t1.mandateid,
			    t1.droplinefrq,
			    t1.firstdroplinedate,
			    t1.pftservicingodlimit,
			    t1.insuranceamt,
			    t1.deductinsdisb,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.calroundingmode,
			    t1.alwmultidisb,
			    t1.applicationno,
			    t1.referralid,
			    t33.rofficerdesc AS referraliddesc,
			    t1.dmacode,
			    t34.rofficerdesc AS dmacodedesc,
			    t1.salesdepartment,
			    t35.deptdesc AS salesdepartmentdesc,
			    t1.quickdisb,
			    t1.wifreference,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.availedunplanemi,
			    t1.availedreageh,
			    t1.bpiamount,
			    t1.deductfeedisb,
			    t1.rvwrateapplfor,
			    t1.schcalonrvw,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.promotioncode,
			    t1.restructureloan,
			    t1.oldfinreference,
			    t1.reagebucket,
			    t1.fincategory,
			    t1.productcategory,
			    t1.roundingtarget,
			    t36.entitycode AS lovdescentitycode,
			    t1.eligibilitymethod,
			    t38.fieldcodevalue AS loveligibilitymethod,
			    t38.valuedesc AS lovdesceligibilitymethod,
			    t1.employeename,
			    t37.rofficerdesc AS employeenamedesc,
			    t1.samplingrequired,
			    t1.legalrequired,
			    t1.grcmaxamount,
			    t1.connector,
			    t40.dealername AS connectorcode,
			    t40.dealercity AS connectordesc,
			    t1.advanceemi,
			    t1.advemiterms,
			    t1.bpipftdaysbasis,
			    t1.fixedratetenor,
			    t1.fixedtenorrate,
			    t12.branchtel AS finbranchcontact,
			    t1.processattributes,
			    t1.businessvertical,
			    bv.code AS businessverticalcode,
			    bv.description AS businessverticaldesc,
			    t1.grcadvtype,
			    t1.grcadvterms,
			    t1.advtype,
			    t1.advterms,
			    t1.advstage,
			    t1.tdspercentage,
			    t1.tdsstartdate,
			    t1.tdsenddate,
			    t1.tdslimitamt,
			    t1.vanreq,
			    t1.vancode,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.sanbsdschdle,
			    t1.promotionseqid,
			    t1.svamount,
			    t1.cbamount,
			    t1.appliedloanamt,
			    t1.finisratervwatgrcend,
			    t1.reqloanamt,
			    t1.reqloantenor,
			    t1.finocrrequired,
			    t1.offerproduct,
			    t1.offeramount,
			    t1.custsegmentation,
			    t1.baseproduct,
			    t1.processtype,
			    t1.bureautimeseries,
			    t1.campaignname,
			    t1.existinglanrefno,
			    t1.leadsource,
			    t1.posource,
			    t1.rsa,
			    t1.verification,
			    t1.sourcingbranch,
			    t1.sourchannelcategory,
			    t1.asmname,
			    t13.branchdesc AS lovdescsourcingbranch,
				t1.OfferId,
                t1.EndGrcPeriodAftrFullDisb,
                t1.AutoIncGrcEndDate,
                t1.AlwGrcAdj,
				t1.pMay,
				t1.alwLoanSplit,
				t1.ParentRef,
				t1.loanSplitted,
				t1.instbasedschd
			   FROM (((((((((((((((((financemain t1
			     JOIN rmtfinancetypes t7 ON (((t1.fintype) = (t7.fintype))))
			     LEFT JOIN rmtbranches t12 ON (((t1.finbranch) = (t12.branchcode))))
			     LEFT JOIN rmtbranches t13 ON (((t1.sourcingbranch) = (t13.branchcode))))
			     LEFT JOIN finpftdetails t17 ON (((t17.finreference) = (t1.finreference))))
			     LEFT JOIN steppolicyheader t24 ON (((t1.steppolicy) = (t24.policycode))))
			     LEFT JOIN bmtcuststatuscodes t27 ON (((t1.finstatus) = (t27.custstscode))))
			     LEFT JOIN amtvehicledealer t28 ON ((t1.accountsofficer = t28.dealerid)))
			     LEFT JOIN relationshipofficers t30 ON (((t1.dsacode) = (t30.rofficercode))))
			     LEFT JOIN relationshipofficers t33 ON (((t1.referralid) = (t33.rofficercode))))
			     LEFT JOIN relationshipofficers t34 ON (((t1.dmacode) = (t34.rofficercode))))
			     LEFT JOIN bmtdepartments t35 ON (((t1.salesdepartment) = (t35.deptcode))))
			     LEFT JOIN smtdivisiondetail t36 ON (((t7.findivision) = (t36.divisioncode))))
			     LEFT JOIN relationshipofficers t37 ON (((t1.employeename) = (t37.rofficercode))))
			     LEFT JOIN rmtlovfielddetail t38 ON (((t1.eligibilitymethod = t38.fieldcodeid) AND ((t38.fieldcode) ='ELGMETHOD'))))
			     LEFT JOIN loanpurposes t39 ON (((t1.finpurpose) = (t39.loanpurposecode))))
			     LEFT JOIN amtvehicledealer t40 ON ((t1.connector = t40.dealerid)))
			     LEFT JOIN business_vertical bv ON ((bv.id = t1.businessvertical)))
			  WHERE (NOT (EXISTS ( SELECT 1
			           FROM financemain_temp
			          WHERE ((financemain_temp.finreference) = (t1.finreference)))))

			]]>
		</createView>
	</changeSet>

	<changeSet id="43" author="Somasekhar">
		<createView viewName="financemain_tview" replaceIfExists="true">
			<![CDATA[
				SELECT t1.finreference,
			    t1.investmentref,
			    t1.numberofterms,
			    t1.grcperiodenddate,
			    t1.allowgrcperiod,
			    t1.gracebaserate,
			    t1.gracespecialrate,
			    t1.grcpftrate,
			    t1.grcpftfrq,
			    t1.nextgrcpftdate,
			    t1.allowgrcpftrvw,
			    t1.grcpftrvwfrq,
			    t1.nextgrcpftrvwdate,
			    t1.allowgrccpz,
			    t1.grccpzfrq,
			    t1.nextgrccpzdate,
			    t1.repaybaserate,
			    t1.repayspecialrate,
			    t1.repayprofitrate,
			    t1.repayfrq,
			    t1.nextrepaydate,
			    t1.repaypftfrq,
			    t1.nextrepaypftdate,
			    t1.allowrepayrvw,
			    t1.repayrvwfrq,
			    t1.nextrepayrvwdate,
			    t1.allowrepaycpz,
			    t1.repaycpzfrq,
			    t1.nextrepaycpzdate,
			    t1.maturitydate,
			    t1.cpzatgraceend,
			    t1.downpayment,
			    t1.graceflatamount,
			    t1.reqrepayamount,
			    t1.totalprofit,
			    t1.totalcpz,
			    t1.totalgrosspft,
			    t1.totalgrossgrcpft,
			    t1.totalgracepft,
			    t1.totalgracecpz,
			    t1.grcratebasis,
			    t1.repayratebasis,
			    t1.fintype,
			    t1.finremarks,
			    t1.finccy,
			    t1.schedulemethod,
			    t1.profitdaysbasis,
			    t1.reqmaturity,
			    t1.calterms,
			    t1.calmaturity,
			    t1.firstrepay,
			    t1.lastrepay,
			    t1.finstartdate,
			    t1.finamount,
			    ((t1.finamount + t1.feechargeamt) - t1.downpayment) AS lovdescfinancingamount,
			    t1.finrepaymentamount,
			    t1.custid,
			    t1.defferments,
			    t1.plandefercount,
			    t1.finbranch,
			    t1.finsourceid,
			    t1.alloweddefrpychange,
			    t1.availeddefrpychange,
			    t1.alloweddeffrqchange,
			    t1.availeddeffrqchange,
			    t1.recaltype,
			    t1.finassetvalue,
			    t1.disbaccountid,
			    t1.repayaccountid,
			    t1.finisactive,
			    t1.limitvalid,
			    t1.overridelimit,
			    t1.securitydeposit,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t7.fintypedesc AS lovdescfintypename,
			    t7.finmaxamount AS lovdescfinmaxamt,
			    t7.finminamount AS lovdescfinminamount,
			    t1.mindownpayperc,
			    t7.finisalwdifferment AS lovdescfinalwdeferment,
			    t7.finisdwpayrequired AS lovdescdwnpayreq,
			    t7.finmaxdifferment AS lovdescfinmaxdifferment,
			    t12.branchdesc AS lovdescfinbranchname,
			    t12.branchprovince AS finbranchprovincecode,
			    t1.lastrepaydate,
			    t1.lastrepaypftdate,
			    t1.lastrepayrvwdate,
			    t1.lastrepaycpzdate,
			    t1.allowgrcrepay,
			    t1.grcschdmthd,
			    t1.grcmargin,
			    t1.repaymargin,
			    t1.fincurrassetvalue,
			    t1.fincommitmentref,
			    t1.finlimitref,
			    t1.depreciationfrq,
			    t1.fincontractdate,
			    t1.nextdepdate,
			    t1.lastdepdate,
			    t1.finaccount,
			    t1.fincustpftaccount,
			    t17.acrtilllbd AS lovdescaccruedtilllbd,
			    t7.finrvwrateapplfor,
			    t1.totalrepayamt,
			    t1.closingstatus,
			    t1.finapproveddate,
			    t1.feechargeamt,
			    t1.blacklisted,
			    t1.finrepaypftonfrq,
			    t1.anualizedpercrate,
			    t1.effectiverateofreturn,
			    t1.migratedfinance,
			    t1.schedulemaintained,
			    t1.scheduleregenerated,
			    t1.finpurpose,
			    t39.loanpurposedesc AS lovdescfinpurposename,
			    t1.finstatus,
			    t1.finstsreason,
			    t1.initiateuser,
			    t1.bankname,
			    t1.iban,
			    t1.accounttype,
			    t1.ddareferenceno,
			    t7.finscheduleon AS lovdescfinscheduleon,
			    t1.custdsr,
			    t1.jointaccount,
			    t1.jointcustid,
			    t1.downpaybank,
			    t1.downpaysupl,
			    t1.downpayaccount,
			    t1.securitycollateral,
			    t1.approved,
			    t1.discrepancy,
			    t1.limitapproved,
			    t1.graceterms,
			    t7.findivision AS lovdescfindivision,
			    t1.rcdmaintainsts,
			    t1.finrepaymethod,
			    t1.grcprofitdaysbasis,
			    t1.stepfinance,
			    t1.steptype,
			    t1.steppolicy,
			    t1.alwmanualsteps,
			    t1.noofsteps,
			    t1.linkedfinref,
			    t1.nextuserid,
			    t1.priority,
			    t24.policydesc AS lovdescsteppolicyname,
			    t1.grcminrate,
			    t1.grcmaxrate,
			    t1.rpyminrate,
			    t1.rpymaxrate,
			    t1.deviationapproval,
			    t1.manualschedule,
			    t1.takeoverfinance,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.supplementrent,
			    t1.increasedcost,
			    t1.creditinsamt,
			    t1.rolloverfrq,
			    t1.nextrolloverdate,
			    t27.custstsdescription,
			    t1.shariastatus,
			    t1.initiatedate,
			    t1.finpreapprovedref,
			    t1.mmaid,
			    t1.accountsofficer,
			    t1.feeaccountid,
			    t1.fincancelac,
			    t28.dealername AS lovdescaccountsofficer,
			    t28.dealercity AS lovdescsourcecity,
			    t1.dsacode,
			    t30.rofficerdesc AS dsacodedesc,
			    t1.tdsapplicable,
			    t1.mandateid,
			    t1.droplinefrq,
			    t1.firstdroplinedate,
			    t1.pftservicingodlimit,
			    t1.insuranceamt,
			    t1.deductinsdisb,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.calroundingmode,
			    t1.alwmultidisb,
			    t1.applicationno,
			    t1.referralid,
			    t33.rofficerdesc AS referraliddesc,
			    t1.dmacode,
			    t34.rofficerdesc AS dmacodedesc,
			    t1.salesdepartment,
			    t35.deptdesc AS salesdepartmentdesc,
			    t1.quickdisb,
			    t1.wifreference,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.availedunplanemi,
			    t1.availedreageh,
			    t1.bpiamount,
			    t1.deductfeedisb,
			    t1.rvwrateapplfor,
			    t1.schcalonrvw,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.promotioncode,
			    t1.restructureloan,
			    t1.oldfinreference,
			    t1.reagebucket,
			    t1.fincategory,
			    t1.productcategory,
			    t1.roundingtarget,
			    t36.entitycode AS lovdescentitycode,
			    t1.eligibilitymethod,
			    t38.fieldcodevalue AS loveligibilitymethod,
			    t38.valuedesc AS lovdesceligibilitymethod,
			    t1.employeename,
			    t37.rofficerdesc AS employeenamedesc,
			    t1.samplingrequired,
			    t1.legalrequired,
			    t1.grcmaxamount,
			    t1.connector,
			    t40.dealername AS connectorcode,
			    t40.dealercity AS connectordesc,
			    t1.advanceemi,
			    t1.advemiterms,
			    t1.bpipftdaysbasis,
			    t1.fixedratetenor,
			    t1.fixedtenorrate,
			    t12.branchtel AS finbranchcontact,
			    t1.processattributes,
			    t1.businessvertical,
			    bv.code AS businessverticalcode,
			    bv.description AS businessverticaldesc,
			    t1.grcadvtype,
			    t1.grcadvterms,
			    t1.advtype,
			    t1.advterms,
			    t1.advstage,
			    t1.tdspercentage,
			    t1.tdsstartdate,
			    t1.tdsenddate,
			    t1.tdslimitamt,
			    t1.vanreq,
			    t1.vancode,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.sanbsdschdle,
			    t1.promotionseqid,
			    t1.svamount,
			    t1.cbamount,
			    t1.appliedloanamt,
			    t1.finisratervwatgrcend,
			    t1.reqloanamt,
			    t1.reqloantenor,
			    t1.finocrrequired,
			    t1.offerproduct,
			    t1.offeramount,
			    t1.custsegmentation,
			    t1.baseproduct,
			    t1.processtype,
			    t1.bureautimeseries,
			    t1.campaignname,
			    t1.existinglanrefno,
			    t1.leadsource,
			    t1.posource,
			    t1.rsa,
			    t1.verification,
			    t1.sourcingbranch,
			    t1.sourchannelcategory,
			    t1.asmname,
			    t13.branchdesc AS lovdescsourcingbranch,
				t1.OfferId,
                t1.EndGrcPeriodAftrFullDisb,
                t1.AutoIncGrcEndDate,
                t1.AlwGrcAdj,
				t1.pMay,
				t1.alwLoanSplit,
				t1.ParentRef,
				t1.loanSplitted,
				t1.instbasedschd
			   FROM (((((((((((((((((financemain_temp t1
			     JOIN rmtfinancetypes t7 ON (((t1.fintype) = (t7.fintype))))
			     LEFT JOIN rmtbranches t12 ON (((t1.finbranch) = (t12.branchcode))))
			     LEFT JOIN rmtbranches t13 ON (((t1.sourcingbranch) = (t13.branchcode))))
			     LEFT JOIN finpftdetails t17 ON (((t17.finreference) = (t1.finreference))))
			     LEFT JOIN steppolicyheader t24 ON (((t1.steppolicy) = (t24.policycode))))
			     LEFT JOIN bmtcuststatuscodes t27 ON (((t1.finstatus) = (t27.custstscode))))
			     LEFT JOIN amtvehicledealer t28 ON ((t1.accountsofficer = t28.dealerid)))
			     LEFT JOIN relationshipofficers t30 ON (((t1.dsacode) = (t30.rofficercode))))
			     LEFT JOIN relationshipofficers t33 ON (((t1.referralid) = (t33.rofficercode))))
			     LEFT JOIN relationshipofficers t34 ON (((t1.dmacode) = (t34.rofficercode))))
			     LEFT JOIN bmtdepartments t35 ON (((t1.salesdepartment) = (t35.deptcode))))
			     LEFT JOIN smtdivisiondetail t36 ON (((t7.findivision) = (t36.divisioncode))))
			     LEFT JOIN relationshipofficers t37 ON (((t1.employeename) = (t37.rofficercode))))
			     LEFT JOIN rmtlovfielddetail t38 ON (((t1.eligibilitymethod = t38.fieldcodeid) AND ((t38.fieldcode) ='ELGMETHOD'))))
			     LEFT JOIN loanpurposes t39 ON (((t1.finpurpose) = (t39.loanpurposecode))))
			     LEFT JOIN amtvehicledealer t40 ON ((t1.connector = t40.dealerid)))
			     LEFT JOIN business_vertical bv ON ((bv.id = t1.businessvertical)))

			]]>
		</createView>
	</changeSet>

	<changeSet id="39_post" author="Somasekhar" dbms="postgresql">
		<sql>
 		 <![CDATA[ 
	
			select deps_restore_dependencies ('plf', 'financemain'); 
			select deps_restore_dependencies ('plf', 'financemain_temp'); 
		 ]]>
		</sql>
	</changeSet>


	<changeSet id="45" author="Somasekhar">
		<createView viewName="findisbursementdetails_view"
			replaceIfExists="true">
			<![CDATA[
					SELECT  T1.FINREFERENCE,
						    T1.DISBDATE,
						    T1.DISBSEQ,
						    T1.DISBDESC,
						    T1.DISBACCOUNTID,
						    T1.DISBAMOUNT,
						    T1.DISBREQDATE,
						    T1.DISBDISBURSED,
						    T1.DISBISACTIVE,
						    T1.DISBREMARKS,
						    T1.VERSION,
						    T1.LASTMNTBY,
						    T1.LASTMNTON,
						    T1.RECORDSTATUS,
						    T1.ROLECODE,
						    T1.NEXTROLECODE,
						    T1.TASKID,
						    T1.NEXTTASKID,
						    T1.RECORDTYPE,
						    T1.WORKFLOWID,
						    T1.FEECHARGEAMT,
						    T1.DISBSTATUS,
						    T1.DISBTYPE,
						    T1.DISBCLAIM,
						    T1.DISBEXPTYPE,
						    T1.DISBRETPERC,
						    T1.DISBRETAMOUNT,
						    T1.AUTODISB,
						    T1.NETADVDUE,
						    T1.NETRETDUE,
						    T1.DISBRETPAID,
						    T1.RETPAIDDATE,
						    T2.EXPENCETYPENAME AS LOVDESCDISBEXPTYPE,
						    T1.CONSULTFEEFRQ,
						    T1.CONSULTFEESTARTDATE,
						    T1.CONSULTFEEENDDATE,
						    T1.CONTRACTORID,
						    T1.INSURANCEAMT,
						    T1.INSTRUCTIONUID,
							T1.QUICKDISB,
							T1.InstCalReq,
							T1.linkeddisbid
						   FROM FINDISBURSEMENTDETAILS_TEMP T1
						     LEFT JOIN AMTEXPENSETYPE T2 ON T2.EXPENCETYPEID = T1.DISBEXPTYPE
						UNION ALL
						 SELECT T1.FINREFERENCE,
						    T1.DISBDATE,
						    T1.DISBSEQ,
						    T1.DISBDESC,
						    T1.DISBACCOUNTID,
						    T1.DISBAMOUNT,
						    T1.DISBREQDATE,
						    T1.DISBDISBURSED,
						    T1.DISBISACTIVE,
						    T1.DISBREMARKS,
						    T1.VERSION,
						    T1.LASTMNTBY,
						    T1.LASTMNTON,
						    T1.RECORDSTATUS,
						    T1.ROLECODE,
						    T1.NEXTROLECODE,
						    T1.TASKID,
						    T1.NEXTTASKID,
						    T1.RECORDTYPE,
						    T1.WORKFLOWID,
						    T1.FEECHARGEAMT,
						    T1.DISBSTATUS,
						    T1.DISBTYPE,
						    T1.DISBCLAIM,
						    T1.DISBEXPTYPE,
						    T1.DISBRETPERC,
						    T1.DISBRETAMOUNT,
						    T1.AUTODISB,
						    T1.NETADVDUE,
						    T1.NETRETDUE,
						    T1.DISBRETPAID,
						    T1.RETPAIDDATE,
						    T2.EXPENCETYPENAME AS LOVDESCDISBEXPTYPE,
						    T1.CONSULTFEEFRQ,
						    T1.CONSULTFEESTARTDATE,
						    T1.CONSULTFEEENDDATE,
						    T1.CONTRACTORID,
						    T1.INSURANCEAMT,
						    T1.INSTRUCTIONUID,
							T1.QUICKDISB,
							T1.InstCalReq,
							T1.linkeddisbid
						   FROM FINDISBURSEMENTDETAILS T1
						     LEFT JOIN AMTEXPENSETYPE T2 ON T2.EXPENCETYPEID = T1.DISBEXPTYPE
						  WHERE NOT (EXISTS ( SELECT 1
						   FROM FINDISBURSEMENTDETAILS_TEMP
						   WHERE FINDISBURSEMENTDETAILS_TEMP.FINREFERENCE = T1.FINREFERENCE))
			]]>
		</createView>
	</changeSet>

	<changeSet id="46" author="Somasekhar">
		<createView viewName="findisbursementdetails_tview"
			replaceIfExists="true">
			<![CDATA[
			SELECT t1.finreference,
			t1.disbdate,
			t1.disbseq,
			t1.disbdesc,
			t1.disbaccountid,
			t1.disbamount,
			t1.disbreqdate,
			t1.disbdisbursed,
			t1.disbisactive,
			t1.disbremarks,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.feechargeamt,
			t1.disbstatus,
			t1.disbtype,
			t1.disbclaim,
			t1.disbexptype,
			t1.disbretperc,
			t1.disbretamount,
			t1.autodisb,
			t1.netadvdue,
			t1.netretdue,
			t1.disbretpaid,
			t1.retpaiddate,
			t2.expencetypename lovdescdisbexptype,
			t1.consultfeefrq,
			t1.consultfeestartdate,
			t1.consultfeeenddate,
			t1.contractorid,
			t1.insuranceamt,
			t1.instructionuid,
			t1.quickdisb,
			T1.InstCalReq,
			T1.linkeddisbid
			FROM findisbursementdetails_temp t1
			LEFT JOIN amtexpensetype t2 ON t2.expencetypeid = t1.disbexptype
			]]>
		</createView>
	</changeSet>

	<changeSet id="47" author="Somasekhar">
		<createView viewName="findisbursementdetails_aview"
			replaceIfExists="true">
			<![CDATA[
			SELECT t1.finreference,
			t1.disbdate,
			t1.disbseq,
			t1.disbdesc,
			t1.disbaccountid,
			t1.disbamount,
			t1.disbreqdate,
			t1.disbdisbursed,
			t1.disbisactive,
			t1.disbremarks,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.feechargeamt,
			t1.version,
			t1.disbstatus,
			t1.disbtype,
			t1.disbclaim,
			t1.disbexptype,
			t1.disbretperc,
			t1.disbretamount,
			t1.autodisb,
			t1.netadvdue,
			t1.netretdue,
			t1.disbretpaid,
			t1.retpaiddate,
			t2.expencetypename lovdescdisbexptype,
			t1.consultfeefrq,
			t1.consultfeestartdate,
			t1.consultfeeenddate,
			t1.contractorid,
			t1.insuranceamt,
			t1.instructionuid,
			t1.quickdisb,
			T1.InstCalReq,
			T1.linkeddisbid
			FROM findisbursementdetails t1
			LEFT JOIN amtexpensetype t2 ON t2.expencetypeid = t1.disbexptype
			]]>
		</createView>
	</changeSet>

</databaseChangeLog>