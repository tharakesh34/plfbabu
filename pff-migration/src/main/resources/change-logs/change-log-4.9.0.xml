<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value="" dbms="oracle" />
	<property name="add.schema" value="" dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PLFAVANSEQC.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()" dbms="postgresql" />


	 <changeSet id="pre_run_for_pgp" author="Jayant" runAlways="true"
		dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>
	
	<changeSet id = "1" author = "Siva">
		<comment> Profit Fraction setting based on Parameter </comment>
		<sql>
			Delete From SMTparameters where SYSPARMCODE = 'ROUND_ADJ_METHOD';
	
			INSERT INTO SMTparameters values('ROUND_ADJ_METHOD', 'Schedule Rounding Fraction Adjustment Method', 'String', 0, 'ADJ_NEXT_INST', 20, 0, NULL, NULL, 
				'Schedule Rounding Fraction Adjustment Method', 1, 1000, CURRENT_TIMESTAMP, 'Approved','','','','','',0);
		</sql>
	</changeSet>
	
	
	<changeSet id="01" author="Durgaprasad.g">
		<addColumn tableName="RMTFinanceTypes" >
			<column name="PartiallySecured" type="boolean" defaultValueBoolean="false"/>
		</addColumn>
	</changeSet>
	
	<changeSet id="02" author="Durgaprasad.g">
		<addColumn tableName="RMTFinanceTypes_temp" >
			<column name="PartiallySecured" type="boolean" defaultValueBoolean="false"/>
		</addColumn>
	</changeSet>
	
	<changeSet id="03" author="Durgaprasad.g">
		<createView viewName="rmtfinancetypes_view" replaceIfExists="true">
			 SELECT t1.fintype,
			    t1.fincategory,
			    t1.fintypedesc,
			    t1.finccy,
			    t1.findayscaltype,
			    t1.finactype,
			    t1.fincontingentactype,
			    t1.finisgenref,
			    t1.finmaxamount,
			    t1.finminamount,
			    t1.finisopennewfinac,
			    t1.findftstmtfrq,
			    t1.finisalwmd,
			    t1.finschdmthd,
			    t1.finisalwgrace,
			    t1.finhistretension,
			    t1.equalrepayment,
			    t1.finratetype,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finintrate,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.findftintfrq,
			    t1.finisintcpz,
			    t1.fincpzfrq,
			    t1.finisrvwalw,
			    t1.finrvwfrq,
			    t1.fingrcratetype,
			    t1.fingrcbaserate,
			    t1.fingrcsplrate,
			    t1.fingrcintrate,
			    t1.fingrcminrate,
			    t1.fingrcmaxrate,
			    t1.fingrcdftintfrq,
			    t1.fingrcisintcpz,
			    t1.fingrccpzfrq,
			    t1.fingrcisrvwalw,
			    t1.fingrcrvwfrq,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.findftterms,
			    t1.finrpyfrq,
			    t1.finrepaymethod,
			    t1.finisalwpartialrpy,
			    t1.finisalwdifferment,
			    t1.finmaxdifferment,
			    t1.finisalwearlyrpy,
			    t1.finisalwearlysettle,
			    t1.finodrpytries,
			    t1.finearlypayrule,
			    t1.finearlysettlerule,
			    t1.findepositrestrictedto,
			    t1.finaebuyorinception,
			    t1.finaesellormaturity,
			    t1.finisactive,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.stepfinance,
			    t1.steppingmandatory,
			    t1.alwmanualsteps,
			    t1.alwdsteppolicies,
			    t1.dftsteppolicy,
			    t4.actypedesc AS lovdescfincontingentactypename,
			    t5.actypedesc AS lovdescfinactypename,
			    t1.finisdwpayrequired,
			    t1.finrvwrateapplfor,
			    t1.finalwratechangeanydate,
			    t1.finisintcpzatgrcend,
			    t1.finelgrulecode,
			    t1.limitelgrulecode,
			    t1.finschcalcodeonrvw,
			    t1.alwplandeferment,
			    t1.plandefercount,
			    t1.finassettype,
			    t1.pftpayactype,
			    t1.finisopenpftpayacc,
			    t31.actypedesc AS lovdescpftpayactypename,
			    t1.finisalwgrcrepay,
			    t1.fingrcschdmthd,
			    t1.fingrcmargin,
			    t1.finmargin,
			    t1.finscheduleon,
			    t1.fingrcscheduleon,
			    t1.fincommitmentreq,
			    t1.fincollateralreq,
			    t1.findepreciationreq,
			    t1.findepreciationfrq,
			    t1.finbankcontingentactype,
			    t1.finprovisionactype,
			    t38.actypedesc AS lovdescfinbankcontactypename,
			    t39.actypedesc AS lovdescfinprovisionactypename,
			    t1.allowriainvestment,
			    t1.overridelimit,
			    t1.limitrequired,
			    t1.fincommitmentovrride,
			    t1.fincollateralovrride,
			    t1.finpftunchanged,
			    t1.applyodpenalty,
			    t1.odincgrcdays,
			    t1.odchargetype,
			    t1.odgracedays,
			    t1.odchargecalon,
			    t1.odchargeamtorperc,
			    t1.odallowwaiver,
			    t1.odmaxwaiverperc,
			    t1.findivision,
			    t48.divisioncodedesc AS lovdescfindivisionname,
			    t48.entitycode AS lovdescentitycode,
			    t1.finsuspactype,
			    t49.actypedesc AS lovdescfinsuspactypename,
			    t1.product,
			    t1.startdate,
			    t1.enddate,
			    t1.allowdownpaypgm,
			    t1.fintypedesc AS lovdescpromofintypedesc,
			    t1.remarks,
			    t1.alwearlypaymethods,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.alwadvancerent,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.rolloverfinance,
			    t1.rolloverfrq,
			    t1.downpayrule,
			    t59.rulecode AS downpayruledesc,
			    t1.finsusptrigger,
			    t1.finsuspremarks,
			    t1.alwmultipartydisb,
			    t1.collateraltype,
			    t1.tdsapplicable,
			    t1.manualschedule,
			    t1.applygrcpricing,
			    t1.grcpricingmethod,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.rpyhierarchy,
			    t67.rulecode AS grcpricingmethoddesc,
			    t68.rulecode AS rpypricingmethoddesc,
			    t1.droplineod,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.finrepaypftonfrq,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.pftdueschon,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.fddlockperiod,
			    t1.alwdrpymethods,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.roundingmode,
			    t1.roundingtarget,
			    t1.frequencydays,
			    t1.quickdisb,
			    t1.alwmaxdisbcheckreq,
			    t1.alwreage,
			    t1.alwunplanemiholiday,
			    t1.profitcenterid,
			    t69.profitcentercode,
			    t69.profitcenterdesc,
			    t1.productcategory,
			    t2.productdesc AS fincategorydesc,
			    t1.developerfinance,
			    t1.costoffunds,
			    t1.chequecapturereq,
			    t1.finltvcheck,
			    t1.PartiallySecured
			   FROM rmtfinancetypes_temp t1
			     LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
			     LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
			     LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
			     LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
			     LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
			     LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
			     LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
			     LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
			     LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			     LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			     LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			     LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
			UNION ALL
			 SELECT t1.fintype,
			    t1.fincategory,
			    t1.fintypedesc,
			    t1.finccy,
			    t1.findayscaltype,
			    t1.finactype,
			    t1.fincontingentactype,
			    t1.finisgenref,
			    t1.finmaxamount,
			    t1.finminamount,
			    t1.finisopennewfinac,
			    t1.findftstmtfrq,
			    t1.finisalwmd,
			    t1.finschdmthd,
			    t1.finisalwgrace,
			    t1.finhistretension,
			    t1.equalrepayment,
			    t1.finratetype,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finintrate,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.findftintfrq,
			    t1.finisintcpz,
			    t1.fincpzfrq,
			    t1.finisrvwalw,
			    t1.finrvwfrq,
			    t1.fingrcratetype,
			    t1.fingrcbaserate,
			    t1.fingrcsplrate,
			    t1.fingrcintrate,
			    t1.fingrcminrate,
			    t1.fingrcmaxrate,
			    t1.fingrcdftintfrq,
			    t1.fingrcisintcpz,
			    t1.fingrccpzfrq,
			    t1.fingrcisrvwalw,
			    t1.fingrcrvwfrq,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.findftterms,
			    t1.finrpyfrq,
			    t1.finrepaymethod,
			    t1.finisalwpartialrpy,
			    t1.finisalwdifferment,
			    t1.finmaxdifferment,
			    t1.finisalwearlyrpy,
			    t1.finisalwearlysettle,
			    t1.finodrpytries,
			    t1.finearlypayrule,
			    t1.finearlysettlerule,
			    t1.findepositrestrictedto,
			    t1.finaebuyorinception,
			    t1.finaesellormaturity,
			    t1.finisactive,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.stepfinance,
			    t1.steppingmandatory,
			    t1.alwmanualsteps,
			    t1.alwdsteppolicies,
			    t1.dftsteppolicy,
			    t4.actypedesc AS lovdescfincontingentactypename,
			    t5.actypedesc AS lovdescfinactypename,
			    t1.finisdwpayrequired,
			    t1.finrvwrateapplfor,
			    t1.finalwratechangeanydate,
			    t1.finisintcpzatgrcend,
			    t1.finelgrulecode,
			    t1.limitelgrulecode,
			    t1.finschcalcodeonrvw,
			    t1.alwplandeferment,
			    t1.plandefercount,
			    t1.finassettype,
			    t1.pftpayactype,
			    t1.finisopenpftpayacc,
			    t31.actypedesc AS lovdescpftpayactypename,
			    t1.finisalwgrcrepay,
			    t1.fingrcschdmthd,
			    t1.fingrcmargin,
			    t1.finmargin,
			    t1.finscheduleon,
			    t1.fingrcscheduleon,
			    t1.fincommitmentreq,
			    t1.fincollateralreq,
			    t1.findepreciationreq,
			    t1.findepreciationfrq,
			    t1.finbankcontingentactype,
			    t1.finprovisionactype,
			    t38.actypedesc AS lovdescfinbankcontactypename,
			    t39.actypedesc AS lovdescfinprovisionactypename,
			    t1.allowriainvestment,
			    t1.overridelimit,
			    t1.limitrequired,
			    t1.fincommitmentovrride,
			    t1.fincollateralovrride,
			    t1.finpftunchanged,
			    t1.applyodpenalty,
			    t1.odincgrcdays,
			    t1.odchargetype,
			    t1.odgracedays,
			    t1.odchargecalon,
			    t1.odchargeamtorperc,
			    t1.odallowwaiver,
			    t1.odmaxwaiverperc,
			    t1.findivision,
			    t48.divisioncodedesc AS lovdescfindivisionname,
			    t48.entitycode AS lovdescentitycode,
			    t1.finsuspactype,
			    t49.actypedesc AS lovdescfinsuspactypename,
			    t1.product,
			    t1.startdate,
			    t1.enddate,
			    t1.allowdownpaypgm,
			    t1.fintypedesc AS lovdescpromofintypedesc,
			    t1.remarks,
			    t1.alwearlypaymethods,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.alwadvancerent,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.rolloverfinance,
			    t1.rolloverfrq,
			    t1.downpayrule,
			    t59.rulecode AS downpayruledesc,
			    t1.finsusptrigger,
			    t1.finsuspremarks,
			    t1.alwmultipartydisb,
			    t1.collateraltype,
			    t1.tdsapplicable,
			    t1.manualschedule,
			    t1.applygrcpricing,
			    t1.grcpricingmethod,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.rpyhierarchy,
			    t67.rulecode AS grcpricingmethoddesc,
			    t68.rulecode AS rpypricingmethoddesc,
			    t1.droplineod,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.finrepaypftonfrq,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.pftdueschon,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.fddlockperiod,
			    t1.alwdrpymethods,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.roundingmode,
			    t1.roundingtarget,
			    t1.frequencydays,
			    t1.quickdisb,
			    t1.alwmaxdisbcheckreq,
			    t1.alwreage,
			    t1.alwunplanemiholiday,
			    t1.profitcenterid,
			    t69.profitcentercode,
			    t69.profitcenterdesc,
			    t1.productcategory,
			    t2.productdesc AS fincategorydesc,
			    t1.developerfinance,
			    t1.costoffunds,
			    t1.chequecapturereq,
			    t1.finltvcheck,
			    t1.PartiallySecured
			   FROM rmtfinancetypes t1
			     LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
			     LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
			     LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
			     LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
			     LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
			     LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
			     LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
			     LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
			     LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			     LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			     LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			     LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
			  WHERE NOT (EXISTS ( SELECT 1 AS expr1
			           FROM rmtfinancetypes_temp
			          WHERE rmtfinancetypes_temp.fintype = t1.fintype));
		</createView>
	</changeSet>
	
	<changeSet id="04" author="Durgaprasad.g">
		<createView viewName="rmtfinancetypes_aview" replaceIfExists="true">
			 SELECT t1.fintype,
			    t1.fincategory,
			    t1.fintypedesc,
			    t1.finccy,
			    t1.findayscaltype,
			    t1.finactype,
			    t1.fincontingentactype,
			    t1.finisgenref,
			    t1.finmaxamount,
			    t1.finminamount,
			    t1.finisopennewfinac,
			    t1.findftstmtfrq,
			    t1.finisalwmd,
			    t1.finschdmthd,
			    t1.finisalwgrace,
			    t1.finhistretension,
			    t1.equalrepayment,
			    t1.finratetype,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finintrate,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.findftintfrq,
			    t1.finisintcpz,
			    t1.fincpzfrq,
			    t1.finisrvwalw,
			    t1.finrvwfrq,
			    t1.fingrcratetype,
			    t1.fingrcbaserate,
			    t1.fingrcsplrate,
			    t1.fingrcintrate,
			    t1.fingrcminrate,
			    t1.fingrcmaxrate,
			    t1.fingrcdftintfrq,
			    t1.fingrcisintcpz,
			    t1.fingrccpzfrq,
			    t1.fingrcisrvwalw,
			    t1.fingrcrvwfrq,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.findftterms,
			    t1.finrpyfrq,
			    t1.finrepaymethod,
			    t1.finisalwpartialrpy,
			    t1.finisalwdifferment,
			    t1.finmaxdifferment,
			    t1.finisalwearlyrpy,
			    t1.finisalwearlysettle,
			    t1.finodrpytries,
			    t1.finearlypayrule,
			    t1.finearlysettlerule,
			    t1.findepositrestrictedto,
			    t1.finaebuyorinception,
			    t1.finaesellormaturity,
			    t1.finisactive,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.stepfinance,
			    t1.steppingmandatory,
			    t1.alwmanualsteps,
			    t1.alwdsteppolicies,
			    t1.dftsteppolicy,
			    t4.actypedesc AS lovdescfincontingentactypename,
			    t5.actypedesc AS lovdescfinactypename,
			    t1.finisdwpayrequired,
			    t1.finrvwrateapplfor,
			    t1.finalwratechangeanydate,
			    t1.finisintcpzatgrcend,
			    t1.finelgrulecode,
			    t1.limitelgrulecode,
			    t1.finschcalcodeonrvw,
			    t1.alwplandeferment,
			    t1.plandefercount,
			    t1.finassettype,
			    t1.pftpayactype,
			    t1.finisopenpftpayacc,
			    t31.actypedesc AS lovdescpftpayactypename,
			    t1.finisalwgrcrepay,
			    t1.fingrcschdmthd,
			    t1.fingrcmargin,
			    t1.finmargin,
			    t1.finscheduleon,
			    t1.fingrcscheduleon,
			    t1.fincommitmentreq,
			    t1.fincollateralreq,
			    t1.findepreciationreq,
			    t1.findepreciationfrq,
			    t1.finbankcontingentactype,
			    t1.finprovisionactype,
			    t38.actypedesc AS lovdescfinbankcontactypename,
			    t39.actypedesc AS lovdescfinprovisionactypename,
			    t1.allowriainvestment,
			    t1.overridelimit,
			    t1.limitrequired,
			    t1.fincommitmentovrride,
			    t1.fincollateralovrride,
			    t1.finpftunchanged,
			    t1.applyodpenalty,
			    t1.odincgrcdays,
			    t1.odchargetype,
			    t1.odgracedays,
			    t1.odchargecalon,
			    t1.odchargeamtorperc,
			    t1.odallowwaiver,
			    t1.odmaxwaiverperc,
			    t1.findivision,
			    t48.divisioncodedesc AS lovdescfindivisionname,
			    t48.entitycode AS lovdescentitycode,
			    t1.finsuspactype,
			    t49.actypedesc AS lovdescfinsuspactypename,
			    t1.product,
			    t1.startdate,
			    t1.enddate,
			    t1.allowdownpaypgm,
			    t1.remarks,
			    t1.alwearlypaymethods,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.alwadvancerent,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.rolloverfinance,
			    t1.rolloverfrq,
			    t1.downpayrule,
			    t59.rulecode AS downpayruledesc,
			    t1.finsusptrigger,
			    t1.finsuspremarks,
			    t1.alwmultipartydisb,
			    t1.collateraltype,
			    t1.tdsapplicable,
			    t1.manualschedule,
			    t1.applygrcpricing,
			    t1.grcpricingmethod,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.rpyhierarchy,
			    t67.rulecode AS grcpricingmethoddesc,
			    t68.rulecode AS rpypricingmethoddesc,
			    t1.droplineod,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.finrepaypftonfrq,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.pftdueschon,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.fddlockperiod,
			    t1.alwdrpymethods,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.roundingmode,
			    t1.roundingtarget,
			    t1.frequencydays,
			    t1.quickdisb,
			    t1.alwreage,
			    t1.alwunplanemiholiday,
			    t1.alwmaxdisbcheckreq,
			    t1.fintypedesc AS lovdescpromofintypedesc,
			    t1.profitcenterid,
			    t69.profitcentercode,
			    t69.profitcenterdesc,
			    t1.productcategory,
			    t2.productdesc AS fincategorydesc,
			    t1.developerfinance,
			    t1.costoffunds,
			    t1.chequecapturereq,
			    t1.finltvcheck,
			    t1.PartiallySecured
			   FROM rmtfinancetypes t1
			     LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
			     LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
			     LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
			     LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
			     LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
			     LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
			     LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
			     LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
			     LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			     LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			     LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			     LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid;
		</createView>
	</changeSet>
	
	<changeSet id="05" author="Durgaprasad g">
		<createView viewName="rmtfinancetypes_aeview" replaceIfExists="true">
			 SELECT t1.fintype,
			    '' AS findeffreq,
			    t1.finactype,
			    t1.finccy,
			    t1.finisopennewfinac,
			    t1.pftpayactype,
			    t1.finisopenpftpayacc,
			    t1.fincontingentactype,
			    t1.finprovisionactype,
			    t1.finsuspactype,
			    t1.fincategory,
			    t1.developerfinance,
			    t1.PartiallySecured
			   FROM rmtfinancetypes t1;
		</createView>
	</changeSet>
	
	<changeSet id="06" author="Durgaprasad g">
		<createView viewName="rmtfinancetypes_orgview" replaceIfExists="true">
			 SELECT t1.fintype,
			    t1.fincategory,
			    t1.fintypedesc,
			    t1.finccy,
			    t1.findayscaltype,
			    t1.finactype,
			    t1.fincontingentactype,
			    t1.finisgenref,
			    t1.finmaxamount,
			    t1.finminamount,
			    t1.finisopennewfinac,
			    t1.finisalwmd,
			    t1.finschdmthd,
			    t1.finisalwgrace,
			    t1.equalrepayment,
			    t1.finratetype,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finintrate,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.findftintfrq,
			    t1.finisintcpz,
			    t1.fincpzfrq,
			    t1.finisrvwalw,
			    t1.finrvwfrq,
			    t1.fingrcratetype,
			    t1.fingrcbaserate,
			    t1.fingrcsplrate,
			    t1.fingrcintrate,
			    t1.fingrcminrate,
			    t1.fingrcmaxrate,
			    t1.fingrcdftintfrq,
			    t1.fingrcisintcpz,
			    t1.fingrccpzfrq,
			    t1.fingrcisrvwalw,
			    t1.fingrcrvwfrq,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.findftterms,
			    t1.finrpyfrq,
			    t1.finrepaymethod,
			    t1.finisalwdifferment,
			    t1.finmaxdifferment,
			    t1.finisactive,
			    t1.stepfinance,
			    t1.steppingmandatory,
			    t1.alwmanualsteps,
			    t1.alwdsteppolicies,
			    t1.dftsteppolicy,
			    t1.finisdwpayrequired,
			    t1.finrvwrateapplfor,
			    t1.finalwratechangeanydate,
			    t1.finisintcpzatgrcend,
			    t1.finschcalcodeonrvw,
			    t1.alwplandeferment,
			    t1.plandefercount,
			    t1.pftpayactype,
			    t1.finisopenpftpayacc,
			    t1.finisalwgrcrepay,
			    t1.fingrcschdmthd,
			    t1.fingrcmargin,
			    t1.finmargin,
			    t1.fincommitmentreq,
			    t1.fincollateralreq,
			    t1.findepreciationreq,
			    t1.findepreciationfrq,
			    t1.finbankcontingentactype,
			    t1.finprovisionactype,
			    t1.allowriainvestment,
			    t1.overridelimit,
			    t1.limitrequired,
			    t1.fincommitmentovrride,
			    t1.fincollateralovrride,
			    t1.finrepaypftonfrq,
			    t1.finpftunchanged,
			    t1.applyodpenalty,
			    t1.odincgrcdays,
			    t1.odchargetype,
			    t1.odgracedays,
			    t1.odchargecalon,
			    t1.odchargeamtorperc,
			    t1.odallowwaiver,
			    t1.odmaxwaiverperc,
			    t1.findivision,
			    t3.divisioncodedesc AS lovdescfindivisionname,
			    t1.finsuspactype,
			    t1.product,
			    t1.startdate,
			    t1.enddate,
			    t1.allowdownpaypgm,
			    t1.fintypedesc AS lovdescpromofintypedesc,
			    t1.remarks,
			    t4.policydesc AS lovdescdftsteppolicyname,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.alwadvancerent,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.rolloverfinance,
			    t1.rolloverfrq,
			    t1.downpayrule,
			    t1.alwmultipartydisb,
			    t1.collateraltype,
			    t1.tdsapplicable,
			    t5.rulecode AS downpayruledesc,
			    t1.applygrcpricing,
			    t1.applyrpypricing,
			    t6.rulecode AS grcpricingmethoddesc,
			    t7.rulecode AS rpypricingmethoddesc,
			    t1.droplineod,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t4.steptype AS dftsteppolicytype,
			    t1.manualschedule,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.pftdueschon,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.fddlockperiod,
			    t1.alwdrpymethods,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.roundingmode,
			    t1.roundingtarget,
			    t1.frequencydays,
			    t1.quickdisb,
			    t1.alwreage,
			    t1.alwunplanemiholiday,
			    t1.alwmaxdisbcheckreq,
			    t1.productcategory,
			    t1.rpyhierarchy,
			    t1.developerfinance,
			    t3.entitycode AS lovdescentitycode,
			    t8.entitydesc AS lovdescentitydesc,
			    t1.costoffunds,
			    t1.chequecapturereq,
			    t1.finltvcheck,
			    t1.PartiallySecured
			   FROM rmtfinancetypes t1
			     JOIN smtdivisiondetail t3 ON t1.findivision = t3.divisioncode
			     LEFT JOIN steppolicyheader t4 ON t1.dftsteppolicy = t4.policycode
			     LEFT JOIN rules t5 ON t1.downpayrule = t5.ruleid
			     LEFT JOIN rules t6 ON t1.grcpricingmethod = t6.ruleid
			     LEFT JOIN rules t7 ON t1.rpypricingmethod = t7.ruleid
			     LEFT JOIN entity t8 ON t3.entitycode = t8.entitycode;
		</createView>
	</changeSet>
	
	<changeSet id="07" author="Durgaprasad.g">
		<sql>
			Update financechecklistref set recordtype = Null;
			Update financechecklistref_temp set recordtype = Null;
		</sql>
	</changeSet>

<changeSet id = "8" author = "Ganesh.p">
	<comment>Security operations added for PostingsDownload</comment>
	<sql>
	DELETE FROM SecOperationRoles Where OprId=(Select OprId  From SecOperations Where OprCode='OPERATION_POSTINGS_DOWNLOAD') AND RoleID=(Select  RoleID  From SecRoles Where RoleCd='Postings_download');
	DELETE FROM SecRoleGroups Where GrpId=(Select GrpId  From SecGroups Where GrpCode='Postings_Download') AND RoleID=(Select  RoleID  From SecRoles Where RoleCd='Postings_download');
	DELETE FROM SECGROUPRIGHTS Where GRPID=(SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='Postings_Download') AND RIGHTID=(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menu_Item_PostingsDownload');

	DELETE FROM SECRIGHTS  WHERE RIGHTNAME='menu_Item_PostingsDownload';
	DELETE FROM SECGROUPS Where GRPCODE='Postings_Download';
	DELETE FROM SECROLES Where RoleCd='Postings_download';
	DELETE FROM SECOPERATIONS Where OprCode='OPERATION_POSTINGS_DOWNLOAD';		

	Insert into SecRights(RightID,RightType,RightName,Page,Version,LastMntBy,LastMntOn,RecordStatus,RoleCode,NextRoleCode,TaskId,NextTaskId,RecordType,WorkflowId) Values
	((Select MAX(RightID)+1 From SecRights), 0, 'menu_Item_PostingsDownload', 'MENU', 1, 1000, Current_Timestamp, 'Approved',' ',' ',' ',' ',' ',0);

	Insert Into secGroups(GrpID,GrpCode,GrpDesc,Version,LastMntBy,LastMntOn,RecordStatus,RoleCode,NextRoleCode,TaskId,NextTaskId,RecordType,WorkflowId) values
	((Select MAX(GrpID)+1 From secGroups),'Postings_Download','Postings Download.',0,1000,Current_Timestamp,'Approved','','','','','',0);

	INSERT INTO SecRoles (RoleID,RoleApp,RoleCd,RoleDesc,RoleCategory,Version,LastMntBy,LastMntOn,RecordStatus,RoleCode,NextRoleCode,TaskId,NextTaskId,RecordType,WorkflowId) VALUES
	((select MAX(RoleID)+1 from SecRoles),1,'Postings_download','Postings file download.','BulkProcessing',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0);

	INSERT INTO SecOperations (OprID,OprCode,OprDesc,Version,LastMntBy,LastMntOn,RecordStatus,RoleCode,NextRoleCode,TaskId,NextTaskId,RecordType,WorkflowId) VALUES 
	((select MAX(OprID)+1 from SecOperations),'OPERATION_POSTINGS_DOWNLOAD','Postings Download',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0);
	
	INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='Postings_Download') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menu_Item_PostingsDownload'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
	INSERT INTO SECROLEGROUPS values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='Postings_Download'), (Select  RoleID  From SecRoles Where RoleCd='Postings_download'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
	INSERT INTO SECOPERATIONROLES values((Select MAX(OprRoleID)+1 From SecOperationRoles),(Select OprId  From SecOperations Where OprCode='OPERATION_POSTINGS_DOWNLOAD'), (Select  RoleID  From SecRoles Where RoleCd='Postings_download'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
	
	
	UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
	UPDATE SEQSECGROUPS SET SEQNO= (SELECT MAX(GRPID) FROM SECGROUPS);
	UPDATE SEQSECROLES SET SEQNO= (SELECT MAX(ROLEID) FROM SECROLES);
	UPDATE SEQSECOPERATIONS SET SEQNO= (SELECT MAX(OPRID) FROM SECOPERATIONS);
				
	UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS);
	UPDATE SEQSECROLEGROUPS SET SEQNO= (SELECT MAX(ROLEGRPID) FROM SECROLEGROUPS);
	UPDATE SEQSECOPERATIONROLES SET SEQNO= (SELECT MAX(OPRROLEID) FROM SECOPERATIONROLES);
		</sql>
</changeSet>

<changeSet id = "9" author = "Ganesh.p">
	<comment>Security operations added for External Upload</comment>
	<sql>
	DELETE FROM SecOperationRoles Where OprId=(Select OprId  From SecOperations Where OprCode='OPERATION_EXTERNAL_UPLOAD') AND RoleID=(Select  RoleID  From SecRoles Where RoleCd='External_Upload');
	DELETE FROM SecRoleGroups Where GrpId=(Select GrpId  From SecGroups Where GrpCode='External_Upload') AND RoleID=(Select  RoleID  From SecRoles Where RoleCd='External_Upload');
	DELETE FROM SECGROUPRIGHTS Where GRPID=(SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='External_Upload') AND RIGHTID=(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menu_Item_ExternalUpload');

	DELETE FROM SECRIGHTS  WHERE RIGHTNAME='menu_Item_ExternalUpload';
	DELETE FROM SECGROUPS Where GRPCODE='External_Upload';
	DELETE FROM SECROLES Where RoleCd='External_Upload';
	DELETE FROM SECOPERATIONS Where OprCode='OPERATION_EXTERNAL_UPLOAD';
	
	Insert into SecRights(RightID,RightType,RightName,Page,Version,LastMntBy,LastMntOn,RecordStatus,RoleCode,NextRoleCode,TaskId,NextTaskId,RecordType,WorkflowId) Values
	((Select MAX(RightID)+1 From SecRights), 0, 'menu_Item_ExternalUpload', 'MENU', 1, 1000, Current_Timestamp, 'Approved',' ',' ',' ',' ',' ',0);

	Insert Into secGroups(GrpID,GrpCode,GrpDesc,Version,LastMntBy,LastMntOn,RecordStatus,RoleCode,NextRoleCode,TaskId,NextTaskId,RecordType,WorkflowId) values
	((Select MAX(GrpID)+1 From secGroups),'External_Upload','External Uploads.',0,1000,Current_Timestamp,'Approved','','','','','',0);

	INSERT INTO SecRoles (RoleID,RoleApp,RoleCd,RoleDesc,RoleCategory,Version,LastMntBy,LastMntOn,RecordStatus,RoleCode,NextRoleCode,TaskId,NextTaskId,RecordType,WorkflowId) VALUES
	((select MAX(RoleID)+1 from SecRoles),1,'External_Upload','External uploads.','BulkProcessing',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0);

	INSERT INTO SecOperations (OprID,OprCode,OprDesc,Version,LastMntBy,LastMntOn,RecordStatus,RoleCode,NextRoleCode,TaskId,NextTaskId,RecordType,WorkflowId) VALUES 
	((select MAX(OprID)+1 from SecOperations),'OPERATION_EXTERNAL_UPLOAD','External Upload',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0);
	
	INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='External_Upload') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menu_Item_ExternalUpload'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
	INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='External_Upload'), (Select  RoleID  From SecRoles Where RoleCd='External_Upload'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
	INSERT INTO SecOperationRoles values((Select MAX(OprRoleID)+1 From SecOperationRoles),(Select OprId  From SecOperations Where OprCode='OPERATION_EXTERNAL_UPLOAD'), (Select  RoleID  From SecRoles Where RoleCd='External_Upload'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
	
		
	UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
	UPDATE SEQSECGROUPS SET SEQNO= (SELECT MAX(GRPID) FROM SECGROUPS);
	UPDATE SEQSECROLES SET SEQNO= (SELECT MAX(ROLEID) FROM SECROLES);
	UPDATE SEQSECOPERATIONS SET SEQNO= (SELECT MAX(OPRID) FROM SECOPERATIONS);
				
	UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS);
	UPDATE SEQSECROLEGROUPS SET SEQNO= (SELECT MAX(ROLEGRPID) FROM SECROLEGROUPS);
	UPDATE SEQSECOPERATIONROLES SET SEQNO= (SELECT MAX(OPRROLEID) FROM SECOPERATIONROLES);
	</sql>
</changeSet>
	<changeSet id="10" author="vijaykumar.l">
		<sql>
			update ExtendedFieldHeader set modulename = 'ASSETTYPE' where modulename ='AssetType';
    		update ExtendedFieldHeader_temp set modulename = 'ASSETTYPE' where modulename ='AssetType';
		</sql>
	</changeSet>	
		
</databaseChangeLog>
	