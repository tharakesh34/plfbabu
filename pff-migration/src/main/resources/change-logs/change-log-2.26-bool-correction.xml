<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<changeSet id="sys-1-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update CollateralStructure set Active = 0 where Active is null;
			alter table CollateralStructure alter column Active bit not null;

			update CollateralStructure set AllowLtvWaiver = 0 where AllowLtvWaiver is null;
			alter table CollateralStructure alter column AllowLtvWaiver bit not null;

			update CollateralStructure set CollateralLocReq = 0 where CollateralLocReq is null;
			alter table CollateralStructure alter column CollateralLocReq bit not null;

			update CollateralStructure set CollateralValuatorReq = 0 where CollateralValuatorReq is null;
			alter table CollateralStructure alter column CollateralValuatorReq bit not null;

			update CollateralStructure set MarketableSecurities = 0 where MarketableSecurities is null;
			alter table CollateralStructure alter column MarketableSecurities bit not null;

			update CollateralStructure set PostValidationReq = 0 where PostValidationReq is null;
			alter table CollateralStructure alter column PostValidationReq bit not null;

			update CollateralStructure set PreValidationReq = 0 where PreValidationReq is null;
			alter table CollateralStructure alter column PreValidationReq bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-1-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update CollateralStructure set Active = 0 where Active is null;
			update CollateralStructure set AllowLtvWaiver = 0 where AllowLtvWaiver is null;
			update CollateralStructure set CollateralLocReq = 0 where CollateralLocReq is null;
			update CollateralStructure set CollateralValuatorReq = 0 where CollateralValuatorReq is null;
			update CollateralStructure set MarketableSecurities = 0 where MarketableSecurities is null;
			update CollateralStructure set PostValidationReq = 0 where PostValidationReq is null;
			update CollateralStructure set PreValidationReq = 0 where PreValidationReq is null;
			
			create table sai_temp as select * from CollateralStructure;

			update CollateralStructure set Active = null, AllowLtvWaiver = null, CollateralLocReq = null
				, CollateralValuatorReq = null, MarketableSecurities = null, PostValidationReq = null, PreValidationReq = null;

			alter table CollateralStructure modify Active number(1);
			alter table CollateralStructure modify AllowLtvWaiver number(1);
			alter table CollateralStructure modify CollateralLocReq number(1);
			alter table CollateralStructure modify CollateralValuatorReq number(1);
			alter table CollateralStructure modify MarketableSecurities number(1);
			alter table CollateralStructure modify PostValidationReq number(1);
			alter table CollateralStructure modify PreValidationReq number(1);

			update CollateralStructure m 
			  set (m.Active, m.AllowLtvWaiver, m.CollateralLocReq, m.CollateralValuatorReq, m.MarketableSecurities
			  	, m.PostValidationReq, m.PreValidationReq) = (select t.Active, t.AllowLtvWaiver, t.CollateralLocReq
			  	, t.CollateralValuatorReq, t.MarketableSecurities, t.PostValidationReq, t.PreValidationReq 
			  	from sai_temp t where t.COLLATERALTYPE = m.COLLATERALTYPE)
			  where exists (select 1 from sai_temp t where t.COLLATERALTYPE = m.COLLATERALTYPE);
			
			alter table CollateralStructure modify Active number(1) not null;
			alter table CollateralStructure modify AllowLtvWaiver number(1) not null;
			alter table CollateralStructure modify CollateralLocReq number(1) not null;
			alter table CollateralStructure modify CollateralValuatorReq number(1) not null;
			alter table CollateralStructure modify MarketableSecurities number(1) not null;
			alter table CollateralStructure modify PostValidationReq number(1) not null;
			alter table CollateralStructure modify PreValidationReq number(1) not null;

			drop table sai_temp;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-2-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update CollateralStructure_Temp set Active = 0 where Active is null;
			alter table CollateralStructure_Temp alter column Active bit not null;

			update CollateralStructure_Temp set AllowLtvWaiver = 0 where AllowLtvWaiver is null;
			alter table CollateralStructure_Temp alter column AllowLtvWaiver bit not null;

			update CollateralStructure_Temp set CollateralLocReq = 0 where CollateralLocReq is null;
			alter table CollateralStructure_Temp alter column CollateralLocReq bit not null;

			update CollateralStructure_Temp set CollateralValuatorReq = 0 where CollateralValuatorReq is null;
			alter table CollateralStructure_Temp alter column CollateralValuatorReq bit not null;

			update CollateralStructure_Temp set MarketableSecurities = 0 where MarketableSecurities is null;
			alter table CollateralStructure_Temp alter column MarketableSecurities bit not null;

			update CollateralStructure_Temp set PostValidationReq = 0 where PostValidationReq is null;
			alter table CollateralStructure_Temp alter column PostValidationReq bit not null;

			update CollateralStructure_Temp set PreValidationReq = 0 where PreValidationReq is null;
			alter table CollateralStructure_Temp alter column PreValidationReq bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-2-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update CollateralStructure_Temp set Active = 0 where Active is null;
			alter table CollateralStructure_Temp modify Active number(1) not null;

			update CollateralStructure_Temp set AllowLtvWaiver = 0 where AllowLtvWaiver is null;
			alter table CollateralStructure_Temp modify AllowLtvWaiver number(1) not null;

			update CollateralStructure_Temp set CollateralLocReq = 0 where CollateralLocReq is null;
			alter table CollateralStructure_Temp modify CollateralLocReq number(1) not null;

			update CollateralStructure_Temp set CollateralValuatorReq = 0 where CollateralValuatorReq is null;
			alter table CollateralStructure_Temp modify CollateralValuatorReq number(1) not null;

			update CollateralStructure_Temp set MarketableSecurities = 0 where MarketableSecurities is null;
			alter table CollateralStructure_Temp modify MarketableSecurities number(1) not null;

			update CollateralStructure_Temp set PostValidationReq = 0 where PostValidationReq is null;
			alter table CollateralStructure_Temp modify PostValidationReq number(1) not null;

			update CollateralStructure_Temp set PreValidationReq = 0 where PreValidationReq is null;
			alter table CollateralStructure_Temp modify PreValidationReq number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-3-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinanceMain set AlwBPI = 0 where AlwBPI is null;
			alter table FinanceMain alter column AlwBPI bit not null;

			update FinanceMain set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table FinanceMain alter column AlwMultiDisb bit not null;

			update FinanceMain set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table FinanceMain alter column PlanEMICpz bit not null;

			update FinanceMain set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table FinanceMain alter column PlanEMIHAlw bit not null;

			update FinanceMain set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table FinanceMain alter column ReAgeCpz bit not null;

			update FinanceMain set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table FinanceMain alter column UnPlanEMICpz bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-3-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinanceMain set AlwBPI = 0 where AlwBPI is null;
			alter table FinanceMain modify AlwBPI number(1) not null;

			update FinanceMain set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table FinanceMain modify AlwMultiDisb number(1) not null;

			update FinanceMain set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table FinanceMain modify PlanEMICpz number(1) not null;

			update FinanceMain set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table FinanceMain modify PlanEMIHAlw number(1) not null;

			update FinanceMain set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table FinanceMain modify ReAgeCpz number(1) not null;

			update FinanceMain set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table FinanceMain modify UnPlanEMICpz number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-4-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinanceMain_PA set AlwBPI = 0 where AlwBPI is null;
			alter table FinanceMain_PA alter column AlwBPI bit not null;

			update FinanceMain_PA set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table FinanceMain_PA alter column AlwMultiDisb bit not null;

			update FinanceMain_PA set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table FinanceMain_PA alter column PlanEMICpz bit not null;

			update FinanceMain_PA set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table FinanceMain_PA alter column PlanEMIHAlw bit not null;

			update FinanceMain_PA set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table FinanceMain_PA alter column ReAgeCpz bit not null;

			update FinanceMain_PA set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table FinanceMain_PA alter column UnPlanEMICpz bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-4-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinanceMain_PA set AlwBPI = 0 where AlwBPI is null;
			alter table FinanceMain_PA modify AlwBPI number(1) not null;

			update FinanceMain_PA set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table FinanceMain_PA modify AlwMultiDisb number(1) not null;

			update FinanceMain_PA set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table FinanceMain_PA modify PlanEMICpz number(1) not null;

			update FinanceMain_PA set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table FinanceMain_PA modify PlanEMIHAlw number(1) not null;

			update FinanceMain_PA set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table FinanceMain_PA modify ReAgeCpz number(1) not null;

			update FinanceMain_PA set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table FinanceMain_PA modify UnPlanEMICpz number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-5-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinanceMain_Temp set AlwBPI = 0 where AlwBPI is null;
			alter table FinanceMain_Temp alter column AlwBPI bit not null;

			update FinanceMain_Temp set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table FinanceMain_Temp alter column AlwMultiDisb bit not null;

			update FinanceMain_Temp set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table FinanceMain_Temp alter column PlanEMICpz bit not null;

			update FinanceMain_Temp set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table FinanceMain_Temp alter column PlanEMIHAlw bit not null;

			update FinanceMain_Temp set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table FinanceMain_Temp alter column ReAgeCpz bit not null;

			update FinanceMain_Temp set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table FinanceMain_Temp alter column UnPlanEMICpz bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-5-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinanceMain_Temp set AlwBPI = 0 where AlwBPI is null;
			alter table FinanceMain_Temp modify AlwBPI number(1) not null;

			update FinanceMain_Temp set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table FinanceMain_Temp modify AlwMultiDisb number(1) not null;

			update FinanceMain_Temp set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table FinanceMain_Temp modify PlanEMICpz number(1) not null;

			update FinanceMain_Temp set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table FinanceMain_Temp modify PlanEMIHAlw number(1) not null;

			update FinanceMain_Temp set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table FinanceMain_Temp modify ReAgeCpz number(1) not null;

			update FinanceMain_Temp set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table FinanceMain_Temp modify UnPlanEMICpz number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-6-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinJointAccountDetails set IncludeRepay = 0 where IncludeRepay is null;
			alter table FinJointAccountDetails alter column IncludeRepay bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-6-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
		 create table sai_temp as select * from FinJointAccountDetails;
			update FinJointAccountDetails set IncludeRepay = null;
			alter table FinJointAccountDetails modify IncludeRepay number(1);
			 update FinJointAccountDetails m 
      set (m.IncludeRepay) = (select t.IncludeRepay from sai_temp t where t.JOINTACCOUNTID = m.JOINTACCOUNTID)
      where exists (select 1 from sai_temp t where t.JOINTACCOUNTID = m.JOINTACCOUNTID);
      Update FinJointAccountDetails set IncludeRepay=0 where IncludeRepay is null;
      drop table sai_temp;
 
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-6.1-oracle" author="sys" dbms="oracle">
	<addNotNullConstraint tableName="FinJointAccountDetails"
			columnName="IncludeRepay" columnDataType="number(1)" />
	</changeSet>
	<changeSet id="sys-7-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinJointAccountDetails_PA set IncludeRepay = 0 where IncludeRepay is null;
			alter table FinJointAccountDetails_PA alter column IncludeRepay bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-7-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinJointAccountDetails_PA set IncludeRepay = 0 where IncludeRepay is null;
			alter table FinJointAccountDetails_PA modify IncludeRepay number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-8-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinJointAccountDetails_Temp set IncludeRepay = 0 where IncludeRepay is null;
			alter table FinJointAccountDetails_Temp alter column IncludeRepay bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-8-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			 create table sai_temp as select * from FinJointAccountDetails_Temp;
			update FinJointAccountDetails_Temp set IncludeRepay = null;
			alter table FinJointAccountDetails_Temp modify IncludeRepay number(1);
			 update FinJointAccountDetails_Temp m 
      set (m.IncludeRepay) = (select t.IncludeRepay from sai_temp t where t.JOINTACCOUNTID = m.JOINTACCOUNTID)
      where exists (select 1 from sai_temp t where t.JOINTACCOUNTID = m.JOINTACCOUNTID);
      Update FinJointAccountDetails_Temp set IncludeRepay=0 where IncludeRepay is null;
      drop table sai_temp;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-8.1-oracle" author="sys" dbms="oracle">
	<addNotNullConstraint tableName="FinJointAccountDetails_Temp"
			columnName="IncludeRepay" columnDataType="number(1)" />
	</changeSet>
	<changeSet id="sys-9-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinScheduleDetails set FrqDate = 0 where FrqDate is null;
			alter table FinScheduleDetails alter column FrqDate bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-9-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinScheduleDetails set FrqDate = 0 where FrqDate is null;
			alter table FinScheduleDetails modify FrqDate number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-10-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinScheduleDetails_Log set FrqDate = 0 where FrqDate is null;
			alter table FinScheduleDetails_Log alter column FrqDate bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-10-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinScheduleDetails_Log set FrqDate = 0 where FrqDate is null;
			alter table FinScheduleDetails_Log modify FrqDate number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-11-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinScheduleDetails_PA set FrqDate = 0 where FrqDate is null;
			alter table FinScheduleDetails_PA alter column FrqDate bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-11-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinScheduleDetails_PA set FrqDate = 0 where FrqDate is null;
			alter table FinScheduleDetails_PA modify FrqDate number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-12-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinScheduleDetails_Temp set FrqDate = 0 where FrqDate is null;
			alter table FinScheduleDetails_Temp alter column FrqDate bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-12-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinScheduleDetails_Temp set FrqDate = 0 where FrqDate is null;
			alter table FinScheduleDetails_Temp modify FrqDate number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-13-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinTypeInsurances set AlwRateChange = 0 where AlwRateChange is null;
			alter table FinTypeInsurances alter column AlwRateChange bit not null;
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="sys-14-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update FinTypeInsurances_Temp set AlwRateChange = 0 where AlwRateChange is null;
			alter table FinTypeInsurances_Temp alter column AlwRateChange bit not null;
		]]>
		</sql>
	</changeSet>

	<changeSet id="sys-15-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update RejectFinanceMain set AlwBPI = 0 where AlwBPI is null;
			alter table RejectFinanceMain alter column AlwBPI bit not null;

			update RejectFinanceMain set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table RejectFinanceMain alter column AlwMultiDisb bit not null;

			update RejectFinanceMain set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table RejectFinanceMain alter column PlanEMICpz bit not null;

			update RejectFinanceMain set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table RejectFinanceMain alter column PlanEMIHAlw bit not null;

			update RejectFinanceMain set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table RejectFinanceMain alter column ReAgeCpz bit not null;

			update RejectFinanceMain set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table RejectFinanceMain alter column UnPlanEMICpz bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-15-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update RejectFinanceMain set AlwBPI = 0 where AlwBPI is null;
			alter table RejectFinanceMain modify AlwBPI number(1) not null;

			update RejectFinanceMain set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table RejectFinanceMain modify AlwMultiDisb number(1) not null;

			update RejectFinanceMain set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table RejectFinanceMain modify PlanEMICpz number(1) not null;

			update RejectFinanceMain set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table RejectFinanceMain modify PlanEMIHAlw number(1) not null;

			update RejectFinanceMain set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table RejectFinanceMain modify ReAgeCpz number(1) not null;

			update RejectFinanceMain set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table RejectFinanceMain modify UnPlanEMICpz number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-16-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update RejectFinScheduledetails set FrqDate = 0 where FrqDate is null;
			alter table RejectFinScheduledetails alter column FrqDate bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-16-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update RejectFinScheduledetails set FrqDate = 0 where FrqDate is null;
			alter table RejectFinScheduledetails modify FrqDate number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-17-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update RMTFinanceTypes set AlwBPI = 0 where AlwBPI is null;
			alter table RMTFinanceTypes alter column AlwBPI bit not null;

			update RMTFinanceTypes set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table RMTFinanceTypes alter column PlanEMICpz bit not null;

			update RMTFinanceTypes set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table RMTFinanceTypes alter column PlanEMIHAlw bit not null;

			update RMTFinanceTypes set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table RMTFinanceTypes alter column ReAgeCpz bit not null;

			update RMTFinanceTypes set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table RMTFinanceTypes alter column UnPlanEMICpz bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-17-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update RMTFinanceTypes set AlwBPI = 0 where AlwBPI is null;
			alter table RMTFinanceTypes modify AlwBPI number(1) not null;

			update RMTFinanceTypes set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table RMTFinanceTypes modify PlanEMICpz number(1) not null;

			update RMTFinanceTypes set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table RMTFinanceTypes modify PlanEMIHAlw number(1) not null;

			update RMTFinanceTypes set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table RMTFinanceTypes modify ReAgeCpz number(1) not null;

			update RMTFinanceTypes set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table RMTFinanceTypes modify UnPlanEMICpz number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-18-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update RMTFinanceTypes_Temp set AlwBPI = 0 where AlwBPI is null;
			alter table RMTFinanceTypes_Temp alter column AlwBPI bit not null;

			update RMTFinanceTypes_Temp set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table RMTFinanceTypes_Temp alter column PlanEMICpz bit not null;

			update RMTFinanceTypes_Temp set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table RMTFinanceTypes_Temp alter column PlanEMIHAlw bit not null;

			update RMTFinanceTypes_Temp set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table RMTFinanceTypes_Temp alter column ReAgeCpz bit not null;

			update RMTFinanceTypes_Temp set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table RMTFinanceTypes_Temp alter column UnPlanEMICpz bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-18-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update RMTFinanceTypes_Temp set AlwBPI = 0 where AlwBPI is null;
			alter table RMTFinanceTypes_Temp modify AlwBPI number(1) not null;

			update RMTFinanceTypes_Temp set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table RMTFinanceTypes_Temp modify PlanEMICpz number(1) not null;

			update RMTFinanceTypes_Temp set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table RMTFinanceTypes_Temp modify PlanEMIHAlw number(1) not null;

			update RMTFinanceTypes_Temp set ReAgeCpz = 0 where ReAgeCpz is null;
			alter table RMTFinanceTypes_Temp modify ReAgeCpz number(1) not null;

			update RMTFinanceTypes_Temp set UnPlanEMICpz = 0 where UnPlanEMICpz is null;
			alter table RMTFinanceTypes_Temp modify UnPlanEMICpz number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-19-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update VASRecording set FinanceProcess = 0 where FinanceProcess is null;
			alter table VASRecording alter column FinanceProcess bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-19-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update VASRecording set FinanceProcess = 0 where FinanceProcess is null;
			alter table VASRecording modify FinanceProcess number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-20-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update VASRecording_Temp set FinanceProcess = 0 where FinanceProcess is null;
			alter table VASRecording_Temp alter column FinanceProcess bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-20-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update VASRecording_Temp set FinanceProcess = 0 where FinanceProcess is null;
			alter table VASRecording_Temp modify FinanceProcess number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-21-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update WIFFinanceMain set AlwBPI = 0 where AlwBPI is null;
			alter table WIFFinanceMain alter column AlwBPI bit not null;

			update WIFFinanceMain set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table WIFFinanceMain alter column AlwMultiDisb bit not null;

			update WIFFinanceMain set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table WIFFinanceMain alter column PlanEMICpz bit not null;

			update WIFFinanceMain set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table WIFFinanceMain alter column PlanEMIHAlw bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-21-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update WIFFinanceMain set AlwBPI = 0 where AlwBPI is null;
			alter table WIFFinanceMain modify AlwBPI number(1) not null;

			update WIFFinanceMain set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table WIFFinanceMain modify AlwMultiDisb number(1) not null;

			update WIFFinanceMain set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table WIFFinanceMain modify PlanEMICpz number(1) not null;

			update WIFFinanceMain set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table WIFFinanceMain modify PlanEMIHAlw number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-22-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update WIFFinanceMain_Temp set AlwBPI = 0 where AlwBPI is null;
			alter table WIFFinanceMain_Temp alter column AlwBPI bit not null;

			update WIFFinanceMain_Temp set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table WIFFinanceMain_Temp alter column AlwMultiDisb bit not null;

			update WIFFinanceMain_Temp set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table WIFFinanceMain_Temp alter column PlanEMICpz bit not null;

			update WIFFinanceMain_Temp set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table WIFFinanceMain_Temp alter column PlanEMIHAlw bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-22-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update WIFFinanceMain_Temp set AlwBPI = 0 where AlwBPI is null;
			alter table WIFFinanceMain_Temp modify AlwBPI number(1) not null;

			update WIFFinanceMain_Temp set AlwMultiDisb = 0 where AlwMultiDisb is null;
			alter table WIFFinanceMain_Temp modify AlwMultiDisb number(1) not null;

			update WIFFinanceMain_Temp set PlanEMICpz = 0 where PlanEMICpz is null;
			alter table WIFFinanceMain_Temp modify PlanEMICpz number(1) not null;

			update WIFFinanceMain_Temp set PlanEMIHAlw = 0 where PlanEMIHAlw is null;
			alter table WIFFinanceMain_Temp modify PlanEMIHAlw number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-23-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update WIFFinScheduleDetails set FrqDate = 0 where FrqDate is null;
			alter table WIFFinScheduleDetails alter column FrqDate bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-23-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update WIFFinScheduleDetails set FrqDate = 0 where FrqDate is null;
			alter table WIFFinScheduleDetails modify FrqDate number(1) not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-24-mssql" author="sys" dbms="mssql">
		<sql>
		<![CDATA[
			update WIFFinScheduleDetails_Temp set FrqDate = 0 where FrqDate is null;
			alter table WIFFinScheduleDetails_Temp alter column FrqDate bit not null;
		]]>
		</sql>
	</changeSet>
	<changeSet id="sys-24-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update WIFFinScheduleDetails_Temp set FrqDate = 0 where FrqDate is null;
			alter table WIFFinScheduleDetails_Temp modify FrqDate number(1) not null;
		]]>
		</sql>
	</changeSet>
	<!-- TODO -->
	<!-- <changeSet id="sys-925" author="Sai">
		<createView viewName="RMTCheckListDetails_AView"
			replaceIfExists="true">
			SELECT     T1.CheckListId, T1.AnsSeqNo, T1.AnsDesc, T1.RemarksAllow, 
					   T1.RemarksMand, T1.DocRequired, T1.DocType, T1.AnsCond,
					   T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, 
			           T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
			           T2.DocTypeDesc   lovDescDocCategory, Coalesce(T2.DocIsCustDoc, 0)  DocIsCustDoc
			FROM   RMTCheckListDetails   T1
					LEFT OUTER JOIN  BMTDocumentTypes   T2 ON T1.DocType = T2.DocTypeCode
			</createView>
	</changeSet>
	<changeSet id="sys-926" author="Sai">
		<createView viewName="RMTCheckListDetails_View"
			replaceIfExists="true">
			SELECT     T1.CheckListId, T1.AnsSeqNo, T1.AnsDesc, T1.RemarksAllow, 
					   T1.RemarksMand, T1.DocRequired, T1.DocType, T1.AnsCond,
					   T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, 
			           T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
			           T2.DocTypeDesc   lovDescDocCategory, Coalesce(T2.DocIsCustDoc, 0)  DocIsCustDoc
			FROM   RMTCheckListDetails_TEMP   T1
					LEFT OUTER JOIN  BMTDocumentTypes   T2 ON T1.DocType = T2.DocTypeCode
			
			UNION ALL
			SELECT     T1.CheckListId, T1.AnsSeqNo, T1.AnsDesc, T1.RemarksAllow,
					   T1.RemarksMand, DocRequired,DocType, AnsCond,
					   T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, 
			           T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
			           T2.DocTypeDesc   lovDescDocCategory, Coalesce(T2.DocIsCustDoc, 0)  DocIsCustDoc
			FROM   RMTCheckListDetails   T1
					LEFT OUTER JOIN  BMTDocumentTypes   T2 ON T1.DocType = T2.DocTypeCode
			WHERE     NOT EXISTS
			                          (SELECT     1
			                            FROM          RMTCheckListDetails_TEMP
			                            WHERE      CheckListId = T1.CheckListId AND AnsSeqNo = T1.AnsSeqNo)
		</createView>
	</changeSet>
	<changeSet id="sys-927" author="Sai">
		<createView viewName="FacilityReferenceDetail_View"
			replaceIfExists="true">
			SELECT   T1.FinRefDetailId, T1.FinType, T1.FinRefType, T1.FinRefId,
					 T1.IsActive, T1.ShowInStage, T1.MandInputInStage, T1.AllowInputInStage,
					 T1.OverRide, T1.OverRideValue, 
					 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus,
					 T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId,
					 T1.RecordType, T1.WorkflowId, T2.FacilityDesc   lovDescFinTypeDescName,
					 COALESCE (T3.AggName, T5.ScoreGroupName, T6.ScoreGroupName)   lovDescNamelov,
					 COALESCE (T3.AggDesc, T4.CheckListDesc, T5.ScoreGroupName, T6.ScoreGroupName)   lovDescRefDesc,
					 T3.AggReportName   lovDescAggReportName, 
					 T3.AggReportPath   lovDescAggReportPath, T3.AggImage   lovDescAggImage,
					 COALESCE (T3.AggCode, T5.ScoreGroupCode, T6.ScoreGroupCode)   lovDescCodelov,
					 Coalesce(T4.Remarks, 0)   lovDescIsRemarksAllowed,
					 Coalesce(T4.CheckMinCount, 0)   lovDescCheckMinCount,
					 Coalesce(T4.CheckMaxCount, 0) 
					   lovDescCheckMaxCount, T41.SQLRule   LovDescElgRuleValue,
					 COALESCE (T5.MinScore, T6.MinScore, N'0')   lovDescminScore,
					 COALESCE (T5.IsOverride, T6.IsOverride, 0)   lovDescisoverride,
					 COALESCE (T5.OverrideScore, T6.OverrideScore, N'0')   lovDescoverrideScore 
			FROM      LMTFacilityRefDetail   T1 INNER JOIN
					  CAFFacilityTypes   T2 ON T1.FinType = T2.FacilityType LEFT OUTER JOIN
					  BMTAggrementDef   T3 ON T1.FinRefId = T3.AggId AND T1.FinRefType = '2' LEFT OUTER JOIN
					  BMTCheckList   T4 ON T1.FinRefId = T4.CheckListId AND T1.FinRefType = '1' LEFT OUTER JOIN
					  Rules   T41 ON T41.RuleCode = T4.CheckRule AND T41.RuleModule = 'CLRULE' AND T41.RuleEvent = '' LEFT OUTER JOIN
					  RMTScoringGroup   T5 ON T1.FinRefId = T5.ScoreGroupId AND T1.FinRefType = '4' AND T5.CategoryType = 'I' LEFT OUTER JOIN
					  RMTScoringGroup   T6 ON T1.FinRefId = T6.ScoreGroupId AND T1.FinRefType = '7' AND T6.CategoryType = 'C'
		</createView>
	</changeSet>
	<changeSet id="sys-928" author="Sai">
		<createView viewName="LMTFinanceWorkFlowDef_AView"
			replaceIfExists="true">
			SELECT T1.FinType , T1.FinType TypeCode, T2.FinTypeDesc lovDescFinTypeName  ,
				T6.CollateralDesc,T7.ProductDesc VasProductDesc,T8.Description CommitmentTypeDesc,
		          T1.FinType lovDescPromotionCode  ,
		          T2.FinTypeDesc lovDescPromotionName  ,
		          T4.FacilityDesc lovDescFacilityTypeName  ,
		          T1.ScreenCode ,
		          T1.WorkFlowType ,
		          T3.WorkFlowDesc lovDescWorkFlowTypeName  ,
		          T1.Version ,
		          T1.LastMntBy ,
		          T1.LastMntOn ,
		          T1.RecordStatus ,
		          T1.RoleCode ,
		          T1.NextRoleCode ,
		          T1.TaskId ,
		          T1.NextTaskId ,
		          T1.RecordType ,
		          T1.WorkflowId ,
		          T3.WorkFlowRoles LovDescWorkFlowRolesName  ,
		          T2.FinCategory LovdescProductCodeName  ,
		          T2.FinDivision lovDescFinDivisionName  ,
		          T3.FirstTaskOwner LovDescFirstTaskOwner  ,
		          T1.ModuleName ,
		         COALESCE(T2.FinIsActive, T6.Active,T7.Active,T8.Active ) FinIsActive, 
		          COALESCE(T2.Product, N'') LovDescProductName  ,
		          T2.lovDescPromoFinTypeDesc ,
		          T2.FinAssetType ,
		          T2.StartDate ,
		          T2.EndDate ,
		          T1.FinEvent,
		         COALESCE( T2.LovDescFinFormetter, 0) LovDescFinFormetter,
		          T5.ProductCategory
		     FROM LMTFinanceWorkFlowDef T1
		            LEFT JOIN RMTFinanceTypes_AView T2   ON T1.FinType = T2.FinType
		            INNER JOIN WorkFlowDetails T3   ON T1.WorkFlowType = T3.WorkFlowType AND T3.WorkFlowActive = 1
		            LEFT JOIN CAFFacilityTypes T4   ON T1.FinType = T4.FacilityType 
		            LEFT JOin BMTProduct T5 ON T2.FinCategory = T5.ProductCode
		            LEFT JOIN CollateralStructure T6 ON T1.FinType = T6.CollateralType 
					LEFT JOIN VasStructure T7 ON T1.FinType = T7.ProductCode 
					LEFT JOIN CommitmentType T8 ON T1.FinType = T8.TypeCode
		</createView>
	</changeSet>
	<changeSet id="sys-929" author="Sai">
		<createView viewName="FinODCRecovery_AView"
			replaceIfExists="true">
			SELECT     T1.FinReference, T1.FinODSchdDate, T1.FinODFor, T1.MovementDate, T1.SeqNo, T1.ODDays, T1.FinCurODAmt, T1.FinCurODPri, T1.FinCurODPft, 
                 T1.PenaltyType, T1.PenaltyCalOn, T1.PenaltyAmtPerc, T1.Penalty, T1.MaxWaiver, T1.WaivedAmt, T1.PenaltyPaid, T1.PenaltyBal, 
                 case when T1.RcdCanDel = 1 And T1.PenaltyBal = 0 then 0 else T1.RcdCanDel End RcdCanDel, 
                 T3.CcyEditField lovDescFinFormatter
			FROM         FinODCRecovery T1 INNER JOIN
                 FinanceMain T2 ON T1.FinReference = T2.FinReference INNER JOIN
                 RMTCurrencies T3 ON T2.FinCcy = T3.CcyCode
		</createView>
	</changeSet>
	<changeSet id="sys-930" author="Sai">
		<createView viewName="JointGuarantorFinSummary_View"
			replaceIfExists="true">
			<![CDATA[
			SELECT     T3.CustCIF, T3.CustShrtName, T6.FinTypeDesc ${call.concatenate} ' (' ${call.concatenate} T1.FinType ${call.concatenate} ')' FinType, T1.FinReference, T1.FinStartDate, T1.MaturityDate, T1.FinCcy, 
                  ${add.schema}UDF_ConvertAmount(T2.TotalPriPaid + T2.TotalPriBal, T5.CcyEditField) FinanceAmt, ${add.schema}UDF_ConvertAmount(T2.TotalPriBal, T5.CcyEditField) 
                  CurrentExpoSure, ${add.schema}UDF_ConvertAmount(Isnull(T4.OverdueAmt,0), T5.CcyEditField) OverdueAmt, T4.PastdueDays, (CASE WHEN PastdueDays IS NULL 
                  THEN 'FALSE' ELSE 'TRUE' END) Overdue, T7.CustCIF JointCif, CASE WHEN T7.CustCIF IS NOT NULL 
                  THEN (CASE WHEN T7.IncludeRepay = 0 THEN 'FALSE' ELSE 'TRUE' END) END IncludeRepay, T7.RepayAccountId, T8.GuarantorCIF, T8.GuarantorCIFName, 
                  T8.GuranteePercentage, T8.MobileNo, T3.CustSts Status, 
                   CAST(${add.schema}UDF_ConvertCurrency(T2.TotalPriPaid + T2.TotalPriBal, T1.FinCcy,
                      (SELECT SysParmValue FROM  SMTparameters WHERE (SysParmCode = 'APP_DFT_CURR')))*1000 as decimal(18,0)) FinanceAmtinBaseCCY, 
                  CAST(${add.schema}UDF_ConvertCurrency(T2.TotalPriBal, T1.FinCcy,
                      (SELECT     SysParmValue
                        FROM          SMTparameters
                        WHERE      (SysParmCode = 'APP_DFT_CURR')))*1000 as decimal(18, 0)) CurrentExpoSureinBaseCCY, cast(${add.schema}UDF_ConvertCurrency(T4.OverdueAmt, T1.FinCcy,
                      (SELECT     SysParmValue
                        FROM          SMTparameters
                        WHERE      (SysParmCode = 'APP_DFT_CURR')))*1000 as decimal(18,0)) OverdueAmtBaseCCY
			FROM         FinanceMain T1 INNER JOIN
				  FinPftDetails T2 ON T1.FinReference = T2.FinReference INNER JOIN
				  Customers T3 ON T2.CustId = T3.CustID INNER JOIN
				  RMTCurrencies T5 ON T1.FinCcy = T5.CcyCode INNER JOIN
				  RMTFinanceTypes T6 ON T6.FinType = T1.FinType LEFT OUTER JOIN
					  (SELECT     T1.FinReference, MAX(T2.FinCurODDays) PastdueDays, SUM(T2.FinCurODAmt) OverdueAmt
						FROM          FinanceMain T1 INNER JOIN
											   FinODDetails T2 ON T1.FinReference = T2.FinReference INNER JOIN
											   FinPftDetails T3 ON T1.FinReference = T3.FinReference
						WHERE      (T2.FinCurODAmt > 0) AND (T1.FinIsActive = 1)
						GROUP BY T1.FinReference) T4 ON T4.FinReference = T1.FinReference LEFT OUTER JOIN
				  FinJointAccountDetails T7 ON T7.FinReference = T1.FinReference LEFT OUTER JOIN
				  FinGuarantorsDetails T8 ON T8.FinReference = T1.FinReference
			WHERE     (T1.FinIsActive = 1)
			]]>
		</createView>
	</changeSet>
	<changeSet id="sys-931" author="Sai">
		<createView viewName="FacilityReferenceDetail_View"
			replaceIfExists="true">
			SELECT   T1.FinRefDetailId, T1.FinType, T1.FinRefType, T1.FinRefId,
					 T1.IsActive, T1.ShowInStage, T1.MandInputInStage, T1.AllowInputInStage,
					 T1.OverRide, T1.OverRideValue, 
					 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus,
					 T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId,
					 T1.RecordType, T1.WorkflowId, T2.FacilityDesc   lovDescFinTypeDescName,
					 COALESCE (T3.AggName, T5.ScoreGroupName, T6.ScoreGroupName)   lovDescNamelov,
					 COALESCE (T3.AggDesc, T4.CheckListDesc, T5.ScoreGroupName, T6.ScoreGroupName)   lovDescRefDesc,
					 T3.AggReportName   lovDescAggReportName, 
					 T3.AggReportPath   lovDescAggReportPath, T3.AggImage   lovDescAggImage,
					 COALESCE (T3.AggCode, T5.ScoreGroupCode, T6.ScoreGroupCode)   lovDescCodelov,
					 Coalesce(T4.Remarks, 0)   lovDescIsRemarksAllowed,
					 Coalesce(T4.CheckMinCount, 0)   lovDescCheckMinCount,
					 Coalesce(T4.CheckMaxCount, 0) 
					   lovDescCheckMaxCount, T41.SQLRule   LovDescElgRuleValue,
					 COALESCE (T5.MinScore, T6.MinScore, N'0')   lovDescminScore,
					 COALESCE (T5.IsOverride, T6.IsOverride, 0)   lovDescisoverride,
					 COALESCE (T5.OverrideScore, T6.OverrideScore, N'0')   lovDescoverrideScore 
			FROM      LMTFacilityRefDetail   T1 INNER JOIN
					  CAFFacilityTypes   T2 ON T1.FinType = T2.FacilityType LEFT OUTER JOIN
					  BMTAggrementDef   T3 ON T1.FinRefId = T3.AggId AND T1.FinRefType = 2 LEFT OUTER JOIN
					  BMTCheckList   T4 ON T1.FinRefId = T4.CheckListId AND T1.FinRefType = 1 LEFT OUTER JOIN
					  Rules   T41 ON T41.RuleCode = T4.CheckRule AND T41.RuleModule = 'CLRULE' AND T41.RuleEvent = '' LEFT OUTER JOIN
					  RMTScoringGroup   T5 ON T1.FinRefId = T5.ScoreGroupId AND T1.FinRefType = 4 AND T5.CategoryType = 'I' LEFT OUTER JOIN
					  RMTScoringGroup   T6 ON T1.FinRefId = T6.ScoreGroupId AND T1.FinRefType = 7 AND T6.CategoryType = 'C'
		</createView>
	</changeSet>
	<changeSet id="sys-932" author="Sai">
		<createView viewName="LMTFinRefDetail_AQView"
			replaceIfExists="true">
			SELECT     T1.FinRefDetailId, T1.FinType, Coalesce(T2.FinTypeDesc, T5.CollateralDesc,T6.ProductDesc)  lovDescFinTypeDescName, T1.FinRefType, T1.FinRefId, T3.CheckListDesc lovDescRefDesc, T1.IsActive, 
                  T1.ShowInStage, T1.MandInputInStage, T1.AllowInputInStage, T1.AllowDeviation, T1.AllowWaiver, T1.AllowPostpone, T1.AllowExpire, T1.Version, T1.LastMntBy, 
                  T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId, T3.Remarks lovDescIsRemarksAllowed,
                   T3.CheckMinCount lovDescCheckMinCount, T3.CheckMaxCount lovDescCheckMaxCount, T1.OverRide, T1.OverRideValue, 
                  T4.SQLRule LovDescElgRuleValue, T4.ReturnType lovDescRuleReturnType, T1.FinEvent, T1.AlertType
			FROM         LMTFinRefDetail T1 LEFT JOIN
				  RMTFinanceTypes T2 ON T1.FinType = T2.FinType  LEFT JOIN
				  CollateralStructure T5 ON T1.FinType = T5.CollateralType  LEFT JOIN
				  VasStructure T6 ON T1.FinType = T6.ProductCode  INNER JOIN
                     BMTCheckList T3 ON T1.FinRefId = T3.CheckListId AND T1.FinRefType = 1 LEFT OUTER JOIN
                     Rules T4 ON T4.RuleCode = T3.CheckRule AND T4.RuleModule = 'CLRULE' AND T4.RuleEvent = 'CLRULE'
		</createView>
	</changeSet>
	<changeSet id="sys-933" author="Sai">
		<createView viewName="FacilityCreationAccess_View"
			replaceIfExists="true">
			SELECT	T7.UsrID, COUNT(T2.FacilityType) FacilityCount
			FROM	CAFFacilityTypes T2 INNER JOIN
		            LMTFinanceWorkFlowDef T3 ON T2.FacilityType = T3.FinType INNER JOIN
		            WorkFlowDetails T4 ON T3.WorkFlowType = T4.WorkFlowType AND T4.WorkFlowActive = 1 INNER JOIN
		            SecRoles T5 ON T4.FirstTaskOwner = T5.RoleCd INNER JOIN
		            SecOperationRoles T6 ON T6.RoleID = T5.RoleID INNER JOIN
		            SecUserOperations T8 on T8.OprID=T6.OprID INNER JOIN
		            SecUsers T7 ON T7.UsrID = T8.UsrID
			GROUP BY T7.UsrID
		</createView>
	</changeSet>
	<changeSet id="sys-934" author="Sai">
		<createView viewName="FinanceCreationAccess_View"
			replaceIfExists="true">
			SELECT     T7.UsrID, COUNT(T2.FinType) FinTypeCount
			FROM          RMTFinanceTypes_AView T2 INNER JOIN
                LMTFinanceWorkFlowDef T3 ON T2.FinType = T3.FinType INNER JOIN
                WorkFlowDetails T4 ON T3.WorkFlowType = T4.WorkFlowType AND T4.WorkFlowActive = 1 INNER JOIN
                SecRoles T5 ON T4.FirstTaskOwner = T5.RoleCd INNER JOIN
                SecOperationRoles T6 ON T6.RoleID = T5.RoleID INNER JOIN
                SecUserOperations T8 on T8.OprID=T6.OprID INNER JOIN
                SecUsers T7 ON T7.UsrID = T8.UsrID
            group by T7.UsrID
		</createView>
	</changeSet>
	<changeSet id="sys-935" author="Sai">
		<dropView viewName="Rpt_ProjectFinAccrualDtl_View"/>
	</changeSet>
	<changeSet id="sys-936" author="Sai">
		<dropView viewName="RPT_FinTypeInvestmentSmry_View"/>
	</changeSet>
	<changeSet id="sys-937" author="Sai">
		<dropView viewName="RPT_ABG_AGINGOFINCOME_View"/>
	</changeSet>
	<changeSet id="sys-938" author="Sai">
		<createView viewName="PrimaryJointFinSummary_View"
			replaceIfExists="true">
			SELECT	T3.CustCIF,T6.FinTypeDesc ${call.concatenate} ' (' ${call.concatenate} T1.FinType ${call.concatenate} ')' FinType,T1.FinReference,T1.FinStartDate,
					T1.MaturityDate,T1.Finccy as FinCCY,
					${add.schema}UDF_ConvertCurrency((TotalPftSchd+TotalPriPaid+TotalPriBal),T1.FinCCY,(Select SysParmValue from SMTParameters where SysParmCode='APP_DFT_CURR'))FinanceAmtinBaseCCY,
					${add.schema}UDF_ConvertCurrency(TotalPriBal,T1.FinCCY,(Select SysParmValue from SMTParameters where SysParmCode='APP_DFT_CURR'))CurrentExpoSureinBaseCCY,
					PastdueDays,${add.schema}UDF_ConvertCurrency((OverdueAmt),T1.FinCCY,(Select SysParmValue from SMTParameters where SysParmCode='APP_DFT_CURR'))OverdueAmtBaseCCY,
					(CASE WHEN PastdueDays is null then 'FALSE' ELSE 'TRUE' END) Overdue
			FROM	FinanceMain T1 INNER JOIN
					FinPftDetails T2 ON T1.FinReference = T2.FinReference INNER JOIN
					Customers T3 ON T2.CustID = T3.CustID INNER JOIN
					RMTCurrencies T5 on T1.FinCCY=CCYCode INNER JOIN
					RMTFinanceTypes T6 ON T6.FinType=T1.FinType LEFT JOIN 
					(Select		T1.FinReference,MIN(FinCurODDays)PastdueDays,Sum(FinCurODAmt)OverdueAmt
					FROM		FinanceMain T1 INNER JOIN
								FinODDetails T2 ON T1.FinReference = T2.FinReference INNER JOIN
								FinPftDetails T3 ON T1.FinReference = T3.FinReference
				    WHERE		FinCurODAmt > 0 and T1.FinIsActive = 1
					Group By	T1.FinReference )T4 on T4.FinReference=T1.FinReference
			Where   T1.FinIsActive = 1
		</createView>
	</changeSet>
	<changeSet id="sys-939" author="Sai">
		<createView viewName="LMTFinRefDetail_TQView"
			replaceIfExists="true">
			SELECT     T1.FinRefDetailId, T1.FinType, Coalesce(T2.FinTypeDesc, T5.CollateralDesc,T6.ProductDesc)  lovDescFinTypeDescName, T1.FinRefType, T1.FinRefId, T3.CheckListDesc lovDescRefDesc, T1.IsActive, 
	                    T1.ShowInStage, T1.MandInputInStage, T1.AllowInputInStage, T1.AllowDeviation, T1.AllowWaiver, T1.AllowPostpone, T1.AllowExpire, T1.Version, T1.LastMntBy, 
	                    T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId, T3.Remarks lovDescIsRemarksAllowed, 
	                    T3.CheckMinCount lovDescCheckMinCount, T3.CheckMaxCount lovDescCheckMaxCount, T1.OverRide, T1.OverRideValue, T3.CheckRule LovDescElgRuleValue, 
	                    T4.ReturnType lovDescRuleReturnType, T1.FinEvent,T1.AlertType
			FROM         LMTFinRefDetail_Temp T1 LEFT JOIN
					  RMTFinanceTypes T2 ON T1.FinType = T2.FinType  LEFT JOIN
					  CollateralStructure T5 ON T1.FinType = T5.CollateralType  LEFT JOIN
					  VasStructure T6 ON T1.FinType = T6.ProductCode  JOIN
                      BMTCheckList T3 ON T1.FinRefId = T3.CheckListId AND T1.FinRefType = 1 LEFT JOIN
                      Rules T4 ON T4.RuleCode = T3.CheckRule AND T4.RuleModule = 'CLRULE' AND T4.RuleEvent = 'CLRULE'
			UNION ALL
			SELECT     T1.FinRefDetailId, T1.FinType, Coalesce(T2.FinTypeDesc, T5.CollateralDesc,T6.ProductDesc)  lovDescFinTypeDescName, T1.FinRefType, T1.FinRefId, T3.CheckListDesc lovDescRefDesc, T1.IsActive, 
                      T1.ShowInStage, T1.MandInputInStage, T1.AllowInputInStage, T1.AllowDeviation, T1.AllowWaiver, T1.AllowPostpone, T1.AllowExpire, T1.Version, T1.LastMntBy, 
                      T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId, T3.Remarks lovDescIsRemarksAllowed, 
                      T3.CheckMinCount lovDescCheckMinCount, T3.CheckMaxCount lovDescCheckMaxCount, T1.OverRide, T1.OverRideValue, T3.CheckRule LovDescElgRuleValue, 
                      T4.ReturnType lovDescRuleReturnType, T1.FinEvent,T1.AlertType
			FROM         LMTFinRefDetail T1 LEFT JOIN
					  RMTFinanceTypes T2 ON T1.FinType = T2.FinType  LEFT JOIN
					  CollateralStructure T5 ON T1.FinType = T5.CollateralType  LEFT JOIN
					  VasStructure T6 ON T1.FinType = T6.ProductCode  JOIN
                      BMTCheckList T3 ON T1.FinRefId = T3.CheckListId AND T1.FinRefType = 1 LEFT JOIN
                      Rules T4 ON T4.RuleCode = T3.CheckRule AND T4.RuleModule = 'CLRULE' AND T4.RuleEvent = 'CLRULE';
		</createView>
	</changeSet>
	<changeSet id="sys-940" author="Sai">
		<createView viewName="LMTFinRefDetail_PEView"
			replaceIfExists="true">
			SELECT     T1.FinRefDetailId, T1.FinType, T1.FinRefType, T1.FinRefId,T1.IsActive, T1.ShowInStage,
			           T1.MandInputInStage,T1.AllowInputInStage, T1.AllowDeviation, T1.AllowWaiver, T1.AllowPostpone,
					   T1.AllowExpire,T1.OverRide,T1.OverRideValue,T1.FinEvent, T1.AlertType,
					   T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId,
					   T1.RecordType, T1.WorkflowId, 
					   Coalesce(T2.FinTypeDesc, T10.CollateralDesc,T11.ProductDesc)  lovDescFinTypeDescName, T2.FinCcy lovDescFinCcyCode,T2.FinCategory lovDescProductCodeName,
					   T3.AggImage lovDescAggImage,
					   COALESCE (T3.AggName, T4.EventCode, T7.RuleCodeDesc, T8.ScoreGroupName, T9.ScoreGroupName) lovDescNamelov,
					   COALESCE (T3.AggCode, T7.RuleCode, T8.ScoreGroupCode, T9.ScoreGroupCode) lovDescCodelov,
					   COALESCE (T3.AggDesc, T4.AccountSetCodeName, T5.CheckListDesc, T7.RuleCode, T8.ScoreGroupCode, T9.ScoreGroupCode)
					   lovDescRefDesc,T3.AggReportName lovDescAggReportName,T3.AggReportPath lovDescAggReportPath,
					   T3.AgrRule lovDescAggRuleName, T3.Aggtype,T3.moduleType,COALESCE(T3.AllowMultiple, 0) AllowMultiple,
					   COALESCE(T5.Remarks, 0) lovDescIsRemarksAllowed,COALESCE(T5.CheckMinCount, 0) lovDescCheckMinCount,
					   COALESCE(T5.CheckMaxCount, 0) lovDescCheckMaxCount,
					   COALESCE (T6.SQLRule, T7.SQLRule) LovDescElgRuleValue,COALESCE (T6.ReturnType, T7.ReturnType) lovDescRuleReturnType,
					   COALESCE (T8.MinScore, T9.MinScore, N'0') lovDescminScore,COALESCE (T8.IsOverride, T9.IsOverride, 0) lovDescisoverride,
					   COALESCE (T8.OverrideScore, T9.OverrideScore, N'0') lovDescoverrideScore
					   		   
			FROM       LMTFinRefDetail T1 LEFT JOIN
					  RMTFinanceTypes T2 ON T1.FinType = T2.FinType  LEFT JOIN
					  CollateralStructure T10 ON T1.FinType = T10.CollateralType  LEFT JOIN
					  VasStructure T11 ON T1.FinType = T11.ProductCode LEFT OUTER JOIN
			           BMTAggrementDef T3 ON T1.FinRefId = T3.AggId AND T1.FinRefType = 2 LEFT OUTER JOIN
					   RMTAccountingSet T4 ON T1.FinRefId = T4.AccountSetid AND T1.FinRefType = 5 LEFT OUTER JOIN
			           BMTCheckList T5 ON T1.FinRefId = T5.CheckListId AND T1.FinRefType = 1 LEFT OUTER JOIN
			           Rules T6 ON T6.RuleCode = T5.CheckRule AND T6.RuleModule = 'CLRULE' AND T6.RuleEvent = 'CLRULE' LEFT OUTER JOIN
			           Rules T7 ON T1.FinRefId = T7.RuleId AND T1.FinRefType = 3 LEFT OUTER JOIN
			           RMTScoringGroup T8 ON T1.FinRefId = T8.ScoreGroupId AND T1.FinRefType = 4 AND 
					   T8.CategoryType = 'RETAIL'  LEFT OUTER JOIN
			           RMTScoringGroup T9 ON T1.FinRefId = T9.ScoreGroupId AND T1.FinRefType = 7 AND T9.CategoryType = 'CORP'
		</createView>
	</changeSet> -->
	<changeSet id="sys-941" author="Sai">
		<dropView viewName="PFF_FIN_DTL_SAS_view"/>
	</changeSet>
	
	<changeSet id="sys-13-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinTypeInsurances set AlwRateChange = 0 where AlwRateChange is null;
			alter table FinTypeInsurances modify AlwRateChange number(1) not null;
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="sys-14-oracle" author="sys" dbms="oracle">
		<sql>
		<![CDATA[
			update FinTypeInsurances_Temp set AlwRateChange = 0 where AlwRateChange is null;
			alter table FinTypeInsurances_Temp modify AlwRateChange number(1) not null;
		]]>
		</sql>
	</changeSet>
</databaseChangeLog>