<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />

	<changeSet id="1" author="Kesav">
		<createTable tableName="FinFeeReceipts">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FeeId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ReceiptId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaidAmount" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="2" author="Kesava">
		<addPrimaryKey columnNames="Id, FeeID, ReceiptId"
			constraintName="PK_FinFeeReceipts" tableName="FinFeeReceipts" />
	</changeSet>

	<changeSet id="3" author="Kesav">
		<createTable tableName="FinFeeReceipts_Temp">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="FeeId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="ReceiptId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaidAmount" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="4" author="Kesava">
		<addPrimaryKey columnNames="Id, FeeID, ReceiptId"
			constraintName="PK_FinFeeReceipts_Temp" tableName="FinFeeReceipts_Temp" />
	</changeSet>

	<changeSet id="5" author="Kesav" dbms="oracle">
		<sql splitStatements="false">
			begin
			execute immediate 'CREATE SEQUENCE
			SeqFinFeeReceipts START WITH 1 INCREMENT BY
			1 MAXVALUE
			9223372036854775807 NOCYCLE';
			end;
		</sql>
	</changeSet>

	<changeSet id="6" author="Kesav">
		<createView viewName="FinFeeReceipts_AView"
			replaceIfExists="true">
				SELECT	    T1.Id, T1.FEEID,T1.RECEIPTID, T1.PAIDAMOUNT, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, 
		                  	T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
		                  	T2.AMOUNT ActualAmount, T3.FeeTypeCode, T3.FeeTypeDesc
		      	FROM    	FinFeeReceipts  T1 
		     	Inner Join  FINRECEIPTDETAIL T2 on T1.ReceiptID = T2.RECEIPTID
		      	Inner Join  FINFEEDETAIL_VIEW T3 on T1.FeeId = T3.FEEID
		</createView>
	</changeSet>


	<changeSet id="7" author="Kesav">
		<createView viewName="FinFeeReceipts_View" replaceIfExists="true">
			SELECT	    T1.Id, T1.FEEID,T1.RECEIPTID, T1.PAIDAMOUNT, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, 
	                  	T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
	                  	T2.AMOUNT ActualAmount, T3.FeeTypeCode, T3.FeeTypeDesc
	      	FROM    	FinFeeReceipts_Temp  T1 
	      	Inner Join  FINRECEIPTDETAIL T2 on T1.ReceiptID = T2.RECEIPTID
	      	Inner Join  FINFEEDETAIL_VIEW T3 on T1.FeeId = T3.FEEID
	      
	     	UNION ALL
	      
	      	SELECT	    T1.Id, T1.FEEID,T1.RECEIPTID, T1.PAIDAMOUNT, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, 
	                 	T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
	                  	T2.AMOUNT ActualAmount, T3.FeeTypeCode, T3.FeeTypeDesc
	      	FROM    	FinFeeReceipts  T1 
	      	Inner Join  FINRECEIPTDETAIL T2 on T1.ReceiptID = T2.RECEIPTID
	      	Inner Join  FINFEEDETAIL_VIEW T3 on T1.FeeId = T3.FEEID
	     	
	     	WHERE     (NOT EXISTS  (SELECT  1 FROM FinFeeReceipts_Temp WHERE (Id = T1.Id)))
		</createView>
	</changeSet>

	<changeSet id="8" author="Kesav">
		<createView viewName="FinFeeReceipts_AView"
			replaceIfExists="true">
				SELECT	    T1.Id, T1.FEEID,T1.RECEIPTID, T1.PAIDAMOUNT, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, 
		                  	T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
		                  	T2.AMOUNT ActualAmount, T3.FeeTypeCode, T3.FeeTypeDesc, T3.FEETYPEID
		      	FROM    	FinFeeReceipts  T1 
		     	Inner Join  FINRECEIPTDETAIL T2 on T1.ReceiptID = T2.RECEIPTID
		      	Inner Join  FINFEEDETAIL_VIEW T3 on T1.FeeId = T3.FEEID
		</createView>
	</changeSet>

	<changeSet id="9" author="Kesav">
		<createView viewName="FinFeeReceipts_View" replaceIfExists="true">
			SELECT	    T1.Id, T1.FEEID,T1.RECEIPTID, T1.PAIDAMOUNT, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, 
	                  	T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
	                  	T2.AMOUNT ActualAmount, T3.FeeTypeCode, T3.FeeTypeDesc, T3.FEETYPEID
	      	FROM    	FinFeeReceipts_Temp  T1 
	      	Inner Join  FINRECEIPTDETAIL T2 on T1.ReceiptID = T2.RECEIPTID
	      	Inner Join  FINFEEDETAIL_VIEW T3 on T1.FeeId = T3.FEEID
	      
	     	UNION ALL
	      
	      	SELECT	    T1.Id, T1.FEEID,T1.RECEIPTID, T1.PAIDAMOUNT, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, 
	                 	T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
	                  	T2.AMOUNT ActualAmount, T3.FeeTypeCode, T3.FeeTypeDesc, T3.FEETYPEID
	      	FROM    	FinFeeReceipts  T1 
	      	Inner Join  FINRECEIPTDETAIL T2 on T1.ReceiptID = T2.RECEIPTID
	      	Inner Join  FINFEEDETAIL_VIEW T3 on T1.FeeId = T3.FEEID
	     	
	     	WHERE     (NOT EXISTS  (SELECT  1 FROM FinFeeReceipts_Temp WHERE (Id = T1.Id)))
		</createView>
	</changeSet>

	<changeSet id="10" author="Kesav">
		<createView viewName="FinFeeReceipts_TView"
			replaceIfExists="true">
				SELECT	    T1.Id, T1.FEEID,T1.RECEIPTID, T1.PAIDAMOUNT, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, 
		                  	T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
		                  	T2.AMOUNT ActualAmount, T3.FeeTypeCode, T3.FeeTypeDesc, T3.FEETYPEID
		      	FROM    	FinFeeReceipts_Temp  T1 
		     	Inner Join  FINRECEIPTDETAIL T2 on T1.ReceiptID = T2.RECEIPTID
		      	Inner Join  FINFEEDETAIL_VIEW T3 on T1.FeeId = T3.FEEID
		</createView>
	</changeSet>

	<changeSet id="2" author="Manoj.P">
		<dropTable tableName="DEDUP_EOD_CUST_ADDR_DTL" />
	</changeSet>


	<changeSet id="3" author="Manoj.P">
		<createTable tableName="DEDUP_EOD_CUST_ADDR_DTL">
			<column name="BATCHID" type="decimal(12,0)">
				<constraints nullable="false" />
			</column>
			<column name="CUSTOMER_NO" type="decimal(8,0)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="SOURCE_SYS_ID" type="varchar(5)" />
			<column name="SEGMENT" type="varchar(5)" />
			<column name="ADDRESS_TYPE" type="varchar(24)" />
			<column name="ADDRESS_1" type="varchar(255)" />
			<column name="ADDRESS_2" type="varchar(255)" />
			<column name="ADDRESS_3" type="varchar(255)" />
			<column name="STATE" type="varchar(100)" />
			<column name="CITY" type="varchar(105)" />
			<column name="PIN" type="varchar(24)" />
			<column name="LANDLINE_1" type="varchar(48)" />
			<column name="LANDLINE_2" type="varchar(48)" />
			<column name="MOBILE" type="varchar(105)" />
			<column name="AREA" type="varchar(120)" />
			<column name="LANDMARK" type="varchar(105)" />
			<column name="STD" type="varchar(48)" />
			<column name="PROCESS_TYPE" type="varchar(2)" />
			<column name="EMAIL" type="varchar(105)" />
			<column name="PROCESS_FLAG" type="varchar(1)" />
			<column name="ERROR_CODE" type="varchar(1)" />
			<column name="ERROR_DESC" type="varchar(100)" />
			<column name="CUSTOMER_ID" type="varchar(20)" />
			<column name="SOURCE_SYSTEM" type="varchar(20)" />
			<column name="PSX_BATCH_ID" type="decimal(18,0)" />
			<column name="EOD_BATCH_ID" type="decimal(18,0)" />

		</createTable>
	</changeSet>


	<changeSet id="4" author="Manoj.P">
		<dropTable tableName="DEDUP_EOD_CUST_LOAN_DTL" />
	</changeSet>

	<changeSet id="5" author="Manoj.P">
		<createTable tableName="DEDUP_EOD_CUST_LOAN_DTL">
			<column name="BATCHID" type="decimal(12,0)">
				<constraints nullable="false" />
			</column>
			<column name="CUSTOMER_NO" type="decimal(8,0)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="SOURCE_SYS_ID" type="varchar(5)" />
			<column name="SEGMENT" type="varchar(5)" />
			<column name="DEAL_ID" type="varchar(20)" />
			<column name="LAN_NO" type="varchar(20)" />
			<column name="CUSTOMER_TYPE" type="varchar(1)" />
			<column name="APPLN_NO" type="decimal(10,0)" />
			<column name="PRODUCT_CODE" type="varchar(10)" />
			<column name="PROCESS_TYPE" type="varchar(2)" />
			<column name="PROCESS_FLAG" type="varchar(1)" />
			<column name="ERROR_CODE" type="varchar(1)" />
			<column name="ERROR_DESC" type="varchar(100)" />
			<column name="PSX_BATCH_ID" type="decimal(18,0)" />
			<column name="PSX_ID" type="decimal(12,0)" />
			<column name="CUSTOMER_ID" type="varchar(20)" />
			<column name="SOURCE_SYSTEM" type="varchar(20)" />
			<column name="EOD_BATCH_ID" type="decimal(18,0)" />
		</createTable>
	</changeSet>

	<changeSet id="6" author="Manoj.P">
		<dropTable tableName="DEDUP_EOD_CUST_DEMO_DTL" />
	</changeSet>

	<changeSet id="7" author="Manoj.P">
		<createTable tableName="DEDUP_EOD_CUST_DEMO_DTL">
			<column name="BATCHID" type="decimal(12,0)">
				<constraints nullable="false" />
			</column>
			<column name="CUSTOMER_NO" type="decimal(8,0)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="SOURCE_SYS_ID" type="varchar(5)" />
			<column name="FIRST_NAME" type="varchar(90)" />
			<column name="MIDDLE_NAME" type="varchar(90)" />
			<column name="LAST_NAME" type="varchar(90)" />
			<column name="DOB" type="datetime" />
			<column name="PAN" type="varchar(30)" />
			<column name="DRIVING_LICENSE_NUMBER" type="varchar(45)" />
			<column name="VOTER_ID" type="varchar(20)" />
			<column name="DATE_OF_INCORPORATION" type="datetime" />
			<column name="TAN_NO" type="varchar(15)" />
			<column name="PROCESS_TYPE" type="varchar(2)" />
			<column name="APPLICANT_TYPE" type="varchar(1)" />
			<column name="EMPOYER_NAME" type="varchar(105)" />
			<column name="FATHER_NAME" type="varchar(105)" />
			<column name="PASSPORT_NO" type="varchar(45)" />
			<column name="ACCOUNT_NUMBER" type="varchar(20)" />
			<column name="CREDIT_CARD_NUMBER" type="varchar(60)" />
			<column name="PROCESS_FLAG" type="varchar(1)" />
			<column name="ERROR_CODE" type="varchar(1)" />
			<column name="ERROR_DESC" type="varchar(100)" />
			<column name="CUSTOMER_ID" type="varchar(20)" />
			<column name="SOURCE_SYSTEM" type="varchar(20)" />
			<column name="PSX_BATCH_ID" type="decimal(18,0)" />
			<column name="UCIN_FLAG" type="varchar(10)" />
			<column name="EOD_BATCH_ID" type="decimal(18,0)" />
			<column name="INSERT_TS" type="datetime" />
			<column name="GENDER" type="varchar(20)" />
			<column name="AADHAR_NO" type="varchar(16)" />
			<column name="CIN" type="varchar(100)" />
			<column name="DIN" type="varchar(20)" />
			<column name="REGISTRATION_NO" type="varchar(20)" />
			<column name="CA_NUMBER" type="varchar(100)" />
			<column name="SEGMENT" type="varchar(5)" />
		</createTable>
	</changeSet>

	<changeSet id="11" author="Durgaprasad G">
		<createTable tableName="SeqPaymentHeader">
			<column name="SeqNo" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="12" author="Durgaprasad G">
		<createTable tableName="SeqPaymentInstructions">
			<column name="SeqNo" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="13" author="Durgaprasad G">
		<createTable tableName="SeqPaymentDeatils">
			<column name="SeqNo" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="14" author="Durgaprasad G">
		<sql>
			Insert into SeqPaymentHeader Values (0);
			Insert into SeqPaymentInstructions Values (0);
			Insert into SeqPaymentDeatils Values (0);
		</sql>
	</changeSet>
	<changeSet id="15" author="Satya">
		<createView viewName="BuilderProjcet_View" replaceIfExists="true">
		SELECT		T1.Id, T1.Name, T1.BuilderId,T1.APFNO,T2.Name BuilderIdName	
		, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId,         T1.RecordType,           T1.WorkflowId
		FROM    	BuilderProjcet_Temp  T1 inner join
		BuilderCompany T2 ON T1.BuilderId = T2.id
		UNION ALL

		SELECT		T1.Id, T1.Name, T1.BuilderId,T1.APFNO,T2.Name BuilderIdName		
		, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	BuilderProjcet  T1 inner join
		BuilderCompany T2 ON T1.BuilderId = T2.id
		WHERE     NOT EXISTS (SELECT 1 FROM BuilderProjcet_TEMP WHERE Id = T1.Id)
	</createView>
	</changeSet>

	<changeSet id="16" author="Satya">
		<createView viewName="BuilderProjcet_AView"
			replaceIfExists="true">
		SELECT		T1.Id, T1.Name, T1.BuilderId,T1.APFNO,T2.Name BuilderIdName		
		, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	BuilderProjcet  T1 inner join
		BuilderCompany T2 ON T1.BuilderId = T2.id
	</createView>
	</changeSet>

	<changeSet id="17" author="durgaprasad G">
		<sql>
			Update SeqSecGroups Set SeqNo = (Select MAX(GrpID) + 1 from SecGroups);
			Update SeqSecRights Set SeqNo = (Select MAX(RightID) + 1 from
			SecRights);
			Update SeqSecGroupRights Set SeqNo = (Select MAX(GrpRightID) + 1 from
			SecGroupRights);
			Update SeqSecRoleGroups Set SeqNo = (Select MAX(RoleGrpID) + 1 from
			SecRoleGroups);

			Delete from SecGroupRights where GrpID In (Select GrpID from SecGroups
			where GrpCode = 'PAYMENTINSTRUCTIONS_MAKER');
			Delete from SecRoleGroups where GrpID IN (Select GrpId from SecGroups WHERE
			GrpCode = 'PAYMENTINSTRUCTIONS_MAKER') And RoleID IN (Select RoleID
			from SecRoles WHERE RoleCd = 'MSTGRP1_MAKER');
			Delete from SecGroups where GrpCode = 'PAYMENTINSTRUCTIONS_MAKER';
			INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups),
			'PAYMENTINSTRUCTIONS_MAKER','WF Maker for PaymentInstructions', 1,
			1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL,0);

			Delete from SecGroupRights where RightID In (Select RightID from
			SecRights where RightName = 'PaymentHeaderDialog_paymentAmount');
			Delete from SecRights where RightName =
			'PaymentHeaderDialog_paymentAmount';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentHeaderDialog_paymentAmount', 'PaymentHeaderDialog', 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentHeaderDialog_paymentAmount'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO SecRoleGroups values ((SELECT MAX(RoleGrpID) + 1 from
			SecRoleGroups), (Select MAX(GrpId) from SecGroups WHERE GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select MAX(RoleID) from SecRoles WHERE
			RoleCd = 'MSTGRP1_MAKER'), 0, 1000, CURRENT_TIMESTAMP, NULL, NULL,
			NULL, NULL, NULL, NULL, 0);

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_paymentAmount');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_paymentAmount';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_paymentAmount', 'PaymentInstructionDialog',
			1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_paymentAmount'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_postDate');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_postDate';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_postDate', 'PaymentInstructionDialog', 1,
			1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_postDate'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_paymentType');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_paymentType';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_paymentType', 'PaymentInstructionDialog',
			1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_paymentType'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_remarks');
			Delete from SecRights where RightName = 'PaymentInstructionDialog_remarks';
			Insert into SecRights Values((Select max(RightID) + 1 from
			SecRights), 3, 'PaymentInstructionDialog_remarks',
			'PaymentInstructionDialog', 1, 1000, CURRENT_TIMESTAMP, null, null,
			null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_remarks'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_bankBranchID');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_bankBranchID';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_bankBranchID', 'PaymentInstructionDialog',
			1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_bankBranchID'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_acctNumber');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_acctNumber';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_acctNumber', 'PaymentInstructionDialog', 1,
			1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_acctNumber'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_acctHolderName');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_acctHolderName';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_acctHolderName',
			'PaymentInstructionDialog', 1, 1000, CURRENT_TIMESTAMP, null, null,
			null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_acctHolderName'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_phoneNumber');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_phoneNumber';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_phoneNumber', 'PaymentInstructionDialog',
			1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_phoneNumber'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_issuingBank');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_issuingBank';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_issuingBank', 'PaymentInstructionDialog',
			1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_issuingBank'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_favouringName');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_favouringName';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_favouringName', 'PaymentInstructionDialog',
			1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_favouringName'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_chequeOrDDumber');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_chequeOrDDumber';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_chequeOrDDumber',
			'PaymentInstructionDialog', 1, 1000, CURRENT_TIMESTAMP, null, null,
			null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_chequeOrDDumber'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_payableLoc');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_payableLoc';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_payableLoc', 'PaymentInstructionDialog', 1,
			1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_payableLoc'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_printingLoc');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_printingLoc';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_printingLoc', 'PaymentInstructionDialog',
			1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_printingLoc'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_valueDate');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_valueDate';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_valueDate', 'PaymentInstructionDialog', 1,
			1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_valueDate'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'PaymentInstructionDialog_partnerBankID');
			Delete from SecRights where RightName =
			'PaymentInstructionDialog_partnerBankID';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'PaymentInstructionDialog_partnerBankID', 'PaymentInstructionDialog',
			1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'PaymentInstructionDialog_partnerBankID'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'RuleDialog_sqlRule');
			Delete from SecRights where RightName = 'RuleDialog_sqlRule';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 3,
			'RuleDialog_sqlRule', 'PaymentInstructionDialog', 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'RuleDialog_sqlRule'), 1, 1, 1000, CURRENT_TIMESTAMP,
			null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'button_PaymentHeaderDialog_btnEdit');
			Delete from SecRights where RightName =
			'button_PaymentHeaderDialog_btnEdit';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 2,
			'button_PaymentHeaderDialog_btnEdit', 'PaymentHeaderDialog', 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'button_PaymentHeaderDialog_btnEdit'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'button_PaymentHeaderDialog_btnDelete');
			Delete from SecRights where RightName =
			'button_PaymentHeaderDialog_btnDelete';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 2,
			'button_PaymentHeaderDialog_btnDelete', 'PaymentHeaderDialog', 1,
			1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'button_PaymentHeaderDialog_btnDelete'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'button_PaymentHeaderDialog_btnSave');
			Delete from SecRights where RightName =
			'button_PaymentHeaderDialog_btnSave';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 2,
			'button_PaymentHeaderDialog_btnSave', 'PaymentHeaderDialog', 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'button_PaymentHeaderDialog_btnSave'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'menuCat_payment_PaymentInstructions');
			Delete from SecRights where RightName =
			'menuCat_payment_PaymentInstructions';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 0,
			'menuCat_payment_PaymentInstructions', 'MENU', 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'menuCat_payment_PaymentInstructions'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'menuItem_payment_PaymentInstructions');
			Delete from SecRights where RightName =
			'menuItem_payment_PaymentInstructions';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 0,
			'menuItem_payment_PaymentInstructions', 'MENU', 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'menuItem_payment_PaymentInstructions'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where RightID In (Select RightID from SecRights
			where RightName = 'button_PaymentHeaderList_NewPaymentHeader');
			Delete from SecRights where RightName =
			'button_PaymentHeaderList_NewPaymentHeader';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 2,
			'button_PaymentHeaderList_NewPaymentHeader', 'PaymentHeaderList', 1,
			1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_MAKER'), (Select RightID from SecRights where
			RightName = 'button_PaymentHeaderList_NewPaymentHeader'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Delete from SecGroupRights where GrpID In (Select GrpID from SecGroups
			where GrpCode = 'PAYMENTINSTRUCTIONS_APPROVER');
			Delete from SecRoleGroups where GrpID IN (Select GrpId from SecGroups WHERE
			GrpCode = 'PAYMENTINSTRUCTIONS_APPROVER') And RoleID IN (Select
			RoleID from SecRoles WHERE RoleCd = 'MSTGRP1_APPROVER');
			Delete from SecGroups where GrpCode = 'PAYMENTINSTRUCTIONS_APPROVER';
			INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups),
			'PAYMENTINSTRUCTIONS_APPROVER','WF Approver for PaymentInstructions',
			1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL,0);

			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_APPROVER'), (Select RightID from SecRights where
			RightName = 'button_PaymentHeaderDialog_btnSave'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO SecRoleGroups values ((SELECT MAX(RoleGrpID) + 1 from
			SecRoleGroups), (Select MAX(GrpId) from SecGroups WHERE GrpCode =
			'PAYMENTINSTRUCTIONS_APPROVER'), (Select MAX(RoleID) from SecRoles
			WHERE RoleCd = 'MSTGRP1_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, NULL,
			NULL, NULL, NULL, NULL, NULL, 0);

			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_APPROVER'), (Select RightID from SecRights where
			RightName = 'menuCat_payment_PaymentInstructions'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from
			SecGroupRights), (Select GrpID from SecGroups where GrpCode =
			'PAYMENTINSTRUCTIONS_APPROVER'), (Select RightID from SecRights where
			RightName = 'menuItem_payment_PaymentInstructions'), 1, 1, 1000,
			CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );

			Update SeqSecGroups Set SeqNo = (Select MAX(GrpID) + 1 from SecGroups);
			Update SeqSecRights Set SeqNo = (Select MAX(RightID) + 1 from
			SecRights);
			Update SeqSecGroupRights Set SeqNo = (Select MAX(GrpRightID) + 1 from
			SecGroupRights);
			Update SeqSecRoleGroups Set SeqNo = (Select MAX(RoleGrpID) + 1 from
			SecRoleGroups);
		</sql>
	</changeSet>

	<changeSet id="18" author="Manoj.P">
		<dropTable tableName="DEDUP_EOD_CUST_LOAN_DTL" />
	</changeSet>

	<changeSet id="19" author="Manoj.P">
		<createTable tableName="DEDUP_EOD_CUST_LOAN_DTL">
			<column name="BATCHID" type="decimal(12,0)">
				<constraints nullable="false" />
			</column>
			<column name="CUSTOMER_NO" type="decimal(8,0)" />
			<column name="SOURCE_SYS_ID" type="varchar(5)" />
			<column name="SEGMENT" type="varchar(5)" />
			<column name="DEAL_ID" type="varchar(20)" />
			<column name="LAN_NO" type="varchar(20)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="CUSTOMER_TYPE" type="varchar(1)" />
			<column name="APPLN_NO" type="decimal(10,0)" />
			<column name="PRODUCT_CODE" type="varchar(10)" />
			<column name="PROCESS_TYPE" type="varchar(2)" />
			<column name="PROCESS_FLAG" type="varchar(1)" />
			<column name="ERROR_CODE" type="varchar(1)" />
			<column name="ERROR_DESC" type="varchar(100)" />
			<column name="PSX_BATCH_ID" type="decimal(18,0)" />
			<column name="PSX_ID" type="decimal(12,0)" />
			<column name="CUSTOMER_ID" type="varchar(20)" />
			<column name="SOURCE_SYSTEM" type="varchar(20)" />
			<column name="EOD_BATCH_ID" type="decimal(18,0)" />
		</createTable>
	</changeSet>

	<changeSet id="20" author="murthy.y">
		<renameColumn columnDataType="decimal(18,2)"
			newColumnName="PDC_SWAP_CHARGES_RECEIVABLE" oldColumnName="PDC_SWAP_CHARGESRECEIVABLE"
			tableName="CF_CONTROL_DUMP" />
		<renameColumn columnDataType="decimal(18,2)"
			newColumnName="PDC_SWAP_CHARGES_RECEIVED" oldColumnName="PDC_SWAP_CHARGESRECEIVED"
			tableName="CF_CONTROL_DUMP" />
		<renameColumn columnDataType="decimal(18,2)"
			newColumnName="PDC_SWAP_CHARGES_RECEIVABLE" oldColumnName="PDC_SWAP_CHARGESRECEIVABLE"
			tableName="CF_CONTROL_DUMP_LOG" />
		<renameColumn columnDataType="decimal(18,2)"
			newColumnName="PDC_SWAP_CHARGES_RECEIVED" oldColumnName="PDC_SWAP_CHARGESRECEIVED"
			tableName="CF_CONTROL_DUMP_LOG" />
	</changeSet>
	<changeSet id="21" author="Srikanth">
		<sql>
			Delete from ErrorDetails Where ErrorCode
			in('90297','90298','90299','90300','90321','90322');
			INSERT INTO ErrorDetails VALUES('90297','EN','E','Request should contain
			configured mandatory extended
			details.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90298','EN','E','{0} is only
			applicable for
			{1}.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90299','EN','E','{0} is invalid in
			extended details, It should be
			{1}.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90300','EN','E','maximum length of
			{0} field should be equals to
			{1}.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90321','EN','E','custDocIssuedOn
			should not be before on customer date of
			birth.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90322','EN','E','{0} is invalid in
			extended details, It should be as per
			configuration.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
		</sql>
	</changeSet>
	<changeSet id="23" author="Siva">
		<dropColumn tableName="FINSCHEDULEDETAILS" columnName="ProfitFraction" />
		<dropColumn tableName="FINSCHEDULEDETAILS_TEMP" columnName="ProfitFraction" />
		<dropColumn tableName="FINSCHEDULEDETAILS_PA" columnName="ProfitFraction" />
		<dropColumn tableName="FINSCHEDULEDETAILS_LOG" columnName="ProfitFraction" />
		<dropColumn tableName="REJECTFINSCHEDULEDETAILS"
			columnName="ProfitFraction" />
		<dropColumn tableName="WIFFINSCHEDULEDETAILS" columnName="ProfitFraction" />
		<dropColumn tableName="WIFFINSCHEDULEDETAILS_TEMP"
			columnName="ProfitFraction" />
	</changeSet>

	<changeSet id="24" author="Siva">
		<addColumn tableName="FINSCHEDULEDETAILS">
			<column name="ProfitFraction" type="decimal(13,9)" />
		</addColumn>
		<addColumn tableName="FINSCHEDULEDETAILS_TEMP">
			<column name="ProfitFraction" type="decimal(13,9)" />
		</addColumn>
		<addColumn tableName="FINSCHEDULEDETAILS_PA">
			<column name="ProfitFraction" type="decimal(13,9)" />
		</addColumn>
		<addColumn tableName="FINSCHEDULEDETAILS_LOG">
			<column name="ProfitFraction" type="decimal(13,9)" />
		</addColumn>
		<addColumn tableName="REJECTFINSCHEDULEDETAILS">
			<column name="ProfitFraction" type="decimal(13,9)" />
		</addColumn>
		<addColumn tableName="WIFFINSCHEDULEDETAILS">
			<column name="ProfitFraction" type="decimal(13,9)" />
		</addColumn>
		<addColumn tableName="WIFFINSCHEDULEDETAILS_TEMP">
			<column name="ProfitFraction" type="decimal(13,9)" />
		</addColumn>
	</changeSet>
 
	<changeSet id="25" author="Sai">
		<addColumn tableName="rmtfinancetypes">
			<column name="id" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>
	<changeSet id="26" author="Siva">
		<sql>
			UPDATE FINSCHEDULEDETAILS SET ProfitFraction = 0;
			UPDATE FINSCHEDULEDETAILS_TEMP SET ProfitFraction = 0;
			UPDATE FINSCHEDULEDETAILS_PA SET ProfitFraction = 0;
			UPDATE FINSCHEDULEDETAILS_LOG SET ProfitFraction = 0;
			UPDATE REJECTFINSCHEDULEDETAILS SET ProfitFraction = 0;
			UPDATE WIFFINSCHEDULEDETAILS SET ProfitFraction = 0;
			UPDATE WIFFINSCHEDULEDETAILS_TEMP SET ProfitFraction = 0;
		</sql>
	</changeSet>
	
	
<changeSet id="27" author="Durgaprasad G">
	<dropTable tableName="PaymentDeatils"/>
	<dropTable tableName="PaymentInstructions"/>
	<dropTable tableName="PaymentHeader"/>
	<dropTable tableName="PaymentDeatils_Temp"/>
	<dropTable tableName="PaymentInstructions_Temp"/>
	<dropTable tableName="PaymentHeader_Temp"/>
</changeSet>

<changeSet id="28" author="Durgaprasad G">
        <createTable tableName="PaymentHeader">
			<column name="PaymentId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PH_PID" nullable="false"/>
			</column>
			<column name="FinReference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="PaymentType" type="char(1)">
				<constraints nullable="false" />
			</column>
			<column name="PaymentAmount" type="decimal(18,2)">
				<constraints nullable="false" />
			</column>
			<column name="CreatedOn" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="ApprovedOn" type="datetime"/>
			<column name="Status" type="char(1)"/>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	
	<changeSet id="29" author="Durgaprasad G">
		<createTable tableName="PaymentHeader_Temp">
			<column name="PaymentId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PH_TEMP_PID" nullable="false"/>
			</column>
			<column name="FinReference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="PaymentType" type="char(1)">
				<constraints nullable="false" />
			</column>
			<column name="PaymentAmount" type="decimal(18,2)">
				<constraints nullable="false" />
			</column>
			<column name="CreatedOn" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="ApprovedOn" type="datetime"/>
			<column name="Status" type="char(1)"/>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	
	<changeSet id="30" author="Durgaprasad G">
		<createTable tableName="PaymentDeatils">
			<column name="PaymentDetailId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PD_PDID" nullable="false"/>
			</column>
			<column name="PaymentId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="AmountType" type="char(1)" />
			<column name="Amount" type="decimal(18,2)"  />
			<column name="ReferenceId" type="bigint" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	
	<changeSet id="31" author="Durgaprasad G">
		<addForeignKeyConstraint constraintName="FK_PD_PID"
			referencedTableName="PaymentHeader" referencedColumnNames="PaymentId"
			baseTableName="PaymentDeatils" baseColumnNames="PaymentId" />
	</changeSet>
	
	<changeSet id="32" author="Durgaprasad G">
		<createTable tableName="PaymentDeatils_Temp">
			<column name="PaymentDetailId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PD_TEMP_PDID" nullable="false"/>
			</column>
			<column name="PaymentId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="AmountType" type="char(1)" />
			<column name="Amount" type="decimal(18,2)"  />
			<column name="ReferenceId" type="bigint" />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
   </changeSet>		 	

   <changeSet id="33" author="Durgaprasad G">
		<createTable tableName="PaymentInstructions">
			<column name="PaymentInstructionId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PI_PIID" nullable="false"/>
			</column>
			<column name="PaymentId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaymentType" type="char(1)" />
			<column name="PaymentAmount" type="decimal(18,2)"  />
			<column name="PaymentCCy" type="varchar(3)"  />
			<column name="BankCode" type="varchar(8)"  />
			<column name="FavourName" type="varchar(200)"  />
			<column name="FavourNumber" type="nvarchar(100)"  />
			<column name="PayableLoc" type="nvarchar(50)"  />
			<column name="PrintingLoc" type="nvarchar(50)"  />
			<column name="ValueDate" type="datetime"  />
			<column name="PostDate" type="datetime"  />
			<column name="BankBranchID" type="bigInt"  />
			<column name="AcctHolderName" type="nvarchar(200)"  />
			<column name="AccountNo" type="varchar(100)"  />
			<column name="PhoneCountryCode" type="varchar(5)"  />
			<column name="PhoneNumber" type="varchar(12)"  />
			<column name="Clearingdate" type="datetime"  />
			<column name="Remarks" type="varchar(100)"  />
			<column name="Active" type="Char(1)"  />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	
	<changeSet id="34" author="Durgaprasad G">
		<addForeignKeyConstraint constraintName="FK_PI_PID"
			referencedTableName="PaymentHeader" referencedColumnNames="PaymentId"
			baseTableName="PaymentInstructions" baseColumnNames="PaymentId" />
	</changeSet>
	
	<changeSet id="35" author="Durgaprasad G">
		<createTable tableName="PaymentInstructions_Temp">
			<column name="PaymentInstructionId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PI_TEMP_PIID" nullable="false"/>
			</column>
			<column name="PaymentId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaymentType" type="char(1)" />
			<column name="PaymentAmount" type="decimal(18,2)"  />
			<column name="PaymentCCy" type="varchar(3)"  />
			<column name="BankCode" type="varchar(8)"  />
			<column name="FavourName" type="varchar(200)"  />
			<column name="FavourNumber" type="nvarchar(100)"  />
			<column name="PayableLoc" type="nvarchar(50)"  />
			<column name="PrintingLoc" type="nvarchar(50)"  />
			<column name="ValueDate" type="datetime"  />
			<column name="PostDate" type="datetime"  />
			<column name="BankBranchID" type="bigInt"  />
			<column name="AcctHolderName" type="nvarchar(200)"  />
			<column name="AccountNo" type="varchar(100)"  />
			<column name="PhoneCountryCode" type="varchar(5)"  />
			<column name="PhoneNumber" type="varchar(12)"  />
			<column name="Clearingdate" type="datetime"  />
			<column name="Remarks" type="varchar(100)"  />
			<column name="Active" type="Char(1)"  />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
			
	<changeSet id="36" author="SreeRavali">
		<addColumn tableName="Restructure">
			<column name="effectiveRate" type="decimal(13,9)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="37" author="SreeRavali">
		<addColumn tableName="Restructure_Temp">
			<column name="effectiveRate" type="decimal(13,9)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="38" author="Durgaprasad G">
		<dropTable tableName="PaymentInstructions"/>
		<dropTable tableName="PaymentInstructions_Temp"/>
	</changeSet>
	
	<changeSet id="39" author="Durgaprasad G">
		<createTable tableName="PaymentInstructions">
			<column name="PaymentInstructionId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PI_PIID" nullable="false"/>
			</column>
			<column name="PaymentId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaymentType" type="varchar(8)" />
			<column name="PaymentAmount" type="decimal(18,2)"  />
			<column name="PaymentCCy" type="varchar(3)"  />
			<column name="BankCode" type="varchar(8)"  />
			<column name="FavourName" type="varchar(200)"  />
			<column name="FavourNumber" type="nvarchar(100)"  />
			<column name="PayableLoc" type="nvarchar(50)"  />
			<column name="PrintingLoc" type="nvarchar(50)"  />
			<column name="ValueDate" type="datetime"  />
			<column name="PostDate" type="datetime"  />
			<column name="BankBranchID" type="bigInt"  />
			<column name="AcctHolderName" type="nvarchar(200)"  />
			<column name="AccountNo" type="varchar(100)"  />
			<column name="PhoneCountryCode" type="varchar(5)"  />
			<column name="PhoneNumber" type="varchar(12)"  />
			<column name="Clearingdate" type="datetime"  />
			<column name="Remarks" type="varchar(100)"  />
			<column name="Active" type="Char(1)"  />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	
	<changeSet id="40" author="Durgaprasad G">
		<addForeignKeyConstraint constraintName="FK_PI_PID"
			referencedTableName="PaymentHeader" referencedColumnNames="PaymentId"
			baseTableName="PaymentInstructions" baseColumnNames="PaymentId" />
	</changeSet>
	
	<changeSet id="41" author="Durgaprasad G">
		<createTable tableName="PaymentInstructions_Temp">
			<column name="PaymentInstructionId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PI_TEMP_PIID" nullable="false"/>
			</column>
			<column name="PaymentId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaymentType" type="varchar(8)" />
			<column name="PaymentAmount" type="decimal(18,2)"  />
			<column name="PaymentCCy" type="varchar(3)"  />
			<column name="BankCode" type="varchar(8)"  />
			<column name="FavourName" type="varchar(200)"  />
			<column name="FavourNumber" type="nvarchar(100)"  />
			<column name="PayableLoc" type="nvarchar(50)"  />
			<column name="PrintingLoc" type="nvarchar(50)"  />
			<column name="ValueDate" type="datetime"  />
			<column name="PostDate" type="datetime"  />
			<column name="BankBranchID" type="bigInt"  />
			<column name="AcctHolderName" type="nvarchar(200)"  />
			<column name="AccountNo" type="varchar(100)"  />
			<column name="PhoneCountryCode" type="varchar(5)"  />
			<column name="PhoneNumber" type="varchar(12)"  />
			<column name="Clearingdate" type="datetime"  />
			<column name="Remarks" type="varchar(100)"  />
			<column name="Active" type="Char(1)"  />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="21" author="murthy.y">
   		 <renameColumn columnDataType="decimal(18,2)" newColumnName="MIG_ADV_EMI_BILLED_PRINCOMP" oldColumnName="MIG_ADV_EMI_BILLED_PRIN_COMP" tableName="CF_CONTROL_DUMP"/>
   		 <renameColumn columnDataType="decimal(18,2)" newColumnName="MIG_ADV_EMI_BILLED_PRINCOMP" oldColumnName="MIG_ADV_EMI_BILLED_PRIN_COMP" tableName="CF_CONTROL_DUMP_LOG"/>
	</changeSet>
	<changeSet id="22" author="murthy.y">
		<modifyDataType tableName="CF_CONTROL_DUMP" columnName="NPA_STAGEID" newDataType="varchar(8)" />
		<modifyDataType tableName="CF_CONTROL_DUMP_LOG" columnName="NPA_STAGEID" newDataType="varchar(8)" />
	</changeSet>
	
		<changeSet id="43" author="Durgaprasad G">
	 <createView viewName="PAYMENTDEATILS_VIEW" replaceIfExists="true">
	     SELECT	 T1.PaymentDetailId, T1.PaymentId, T1.AmountType, T1.Amount, T1.ReferenceId,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM     PaymentDeatils_Temp  T1 
		UNION ALL
		SELECT	 T1.PaymentDetailId, T1.PaymentId, T1.AmountType, T1.Amount, T1.ReferenceId,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM     PAYMENTDEATILS  T1  
		WHERE NOT EXISTS ( SELECT 1  FROM PaymentDeatils_Temp WHERE PaymentDetailId = T1.PaymentDetailId)
	 </createView>
	</changeSet>
	
	<changeSet id="44" author="Durga Prasad D">
		<addColumn tableName="FinReceiptHeader_Temp">
			<column name="totFeeAmount" type="decimal(18,2)" />
		</addColumn>
		<addColumn tableName="FinReceiptHeader">
			<column name="totFeeAmount" type="decimal(18,2)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="45" author="Durga Prasad D">
	 <sql>
	 UPDATE FinReceiptHeader_TEMP SET totFeeAmount = 0 WHERE totFeeAmount IS NULL;
	 UPDATE FinReceiptHeader SET totFeeAmount = 0 WHERE totFeeAmount IS NULL;
	 </sql>
	</changeSet>
	
	<changeSet id="46" author="Durga Prasad D">
		<createView viewName="finreceiptheader_view"
			replaceIfExists="true">
  	SELECT     T1.ReceiptID, T1.ReceiptDate, T1.ReceiptType,T1.RecAgainst,T1.Reference, T1.ReceiptPurpose, 
				 T1.ReceiptMode, T1.ExcessAdjustTo,T1.AllocationType,T1.ReceiptAmount,T1.EffectSchdMethod, 
				 T1.ReceiptModeStatus, T1.Version, T1.LastMntBy, T1.LastMntOn,T1.RecordStatus,T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
				 T2.FinType,  T2.FinBranch, T3.CustCIF , 	T3.CustShrtName, T2.FinCcy, T1.RealizationDate,
				 T1.CancelReason, T4.FinTypeDesc,  T6.BranchDesc FinBranchDesc, T5.CcyDesc FinCcyDesc, T7.RejectDesc CancelReasonDesc, T2.FinIsActive, T1.WaviedAmt, T1.TotFeeAmount
							FROM         FinReceiptHeader_Temp T1 INNER JOIN
				       FinanceMain T2 ON T1.Reference = T2.FinReference INNER JOIN
				       Customers T3 ON T2.CustId = T3.CustId INNER JOIN
				       RMTFinanceTypes T4 ON T2.FinType = T4.FinType INNER JOIN
				       RMTCurrencies T5 ON T2.FinCcy = T5.CcyCode INNER JOIN
				       RMTBranches T6 ON T2.FinBranch = T6.BranchCode LEFT JOIN
				       BMTRejectCodes T7 ON T1.CancelReason = T7.RejectCode
				UNION ALL
				 SELECT     T1.ReceiptID, T1.ReceiptDate, T1.ReceiptType,T1.RecAgainst,T1.Reference, T1.ReceiptPurpose, 
				 T1.ReceiptMode, T1.ExcessAdjustTo,T1.AllocationType,T1.ReceiptAmount,T1.EffectSchdMethod, 
				 T1.ReceiptModeStatus, T1.Version, T1.LastMntBy, T1.LastMntOn,T1.RecordStatus,T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
				 T2.FinType,  T2.FinBranch, T3.CustCIF , 	T3.CustShrtName, T2.FinCcy, T1.RealizationDate,
				 T1.CancelReason, T4.FinTypeDesc,  T6.BranchDesc FinBranchDesc, T5.CcyDesc FinCcyDesc, T7.RejectDesc CancelReasonDesc, T2.FinIsActive, T1.WaviedAmt, T1.TotFeeAmount
							FROM         FinReceiptHeader T1 INNER JOIN
				       FinanceMain T2 ON T1.Reference = T2.FinReference INNER JOIN
				       Customers T3 ON T2.CustId = T3.CustId INNER JOIN
				       RMTFinanceTypes T4 ON T2.FinType = T4.FinType INNER JOIN
				       RMTCurrencies T5 ON T2.FinCcy = T5.CcyCode INNER JOIN
				       RMTBranches T6 ON T2.FinBranch = T6.BranchCode LEFT JOIN
				       BMTRejectCodes T7 ON T1.CancelReason = T7.RejectCode
						WHERE     NOT EXISTS
				                          (SELECT     1
				                            FROM          FinReceiptHeader_TEMP 
				                            WHERE      ReceiptID = T1.ReceiptID)
		</createView>
	</changeSet>
	<changeSet id="47" author="murthy.y">
		<createView viewName="INT_ALM_VIEW" replaceIfExists="true">
			SELECT SUBSTR(FM.FINREFERENCE, 7, LENGTH(FM.FINREFERENCE)) AGREEMENTID,
			  FM.FINREFERENCE AGREEMENTNO,
			  FM.FINTYPE PRODUCTFLAG,
			    	CASE WHEN FM.CLOSINGSTATUS='W' THEN 'WRITEOFF' ELSE 'REGULAR' END NPA_STAGEID,
			  (FP.TOTALPRIBAL+FP.TOTALPFTBAL)/CCYMINORCCYUNITS INSTLAMT,
			  FP.TOTALPRIBAL /CCYMINORCCYUNITS PRINCOMP,
			  FP.TOTALPFTBAL /CCYMINORCCYUNITS INTCOMP,
			  FP.FIRSTREPAYDATE DUEDATE,
			  FP.PFTACCRUED/CCYMINORCCYUNITS ACCRUEDAMT,
			  FP.PFTACCRUED/CCYMINORCCYUNITS CUMULATIVE_ACCRUAL_AMT,
			  CASE
			    WHEN (SELECT COUNT(RH.REFERENCE) EMIADV
			      FROM FINRECEIPTDETAIL RD
			      INNER JOIN FINRECEIPTHEADER RH
			      ON RH.RECEIPTID  =RH.RECEIPTID
			      WHERE PAYMENTTYPE='EMIINADV'
			      AND RH.REFERENCE = FM.FINREFERENCE) > 0
			    THEN 'Y'
			    ELSE 'N'
			  END ADVFLAG
			FROM FINANCEMAIN FM
			INNER JOIN FINPFTDETAILS FP ON FP.FINREFERENCE=FM.FINREFERENCE
			INNER JOIN RMTCURRENCIES RC ON RC.CCYCODE=FM.FINCCY
			LEFT JOIN FINPROVISIONS PR ON PR.FINREFERENCE = FM.FINREFERENCE
		</createView>
	</changeSet>
	<changeSet id="48" author="murthy.y">
		<createView viewName="INT_CF_CONTROL_VIEW" replaceIfExists="true">
			 SELECT 
				PD.PFTACCRUED/100 ACCRUED_AMOUNT,
				COALESCE(EA.AMOUNT,0)/100 ADVANCE_EMI,
				0 ADVANCE_EMI_BILLED,
				SUBSTR(FM.FINREFERENCE, 7, LENGTH(FM.FINREFERENCE)) AGREEMENTID,
				FM.FINAPPROVEDDATE AGREEMENTDATE,
				FM.FINREFERENCE  AGREEMENTNO,
				FM.FINAMOUNT/100 AMTFIN,
				FM.FINASSETVALUE/100 ASSETCOST,
				'' ASSETDESC,
				TOTALPFTSCHD-TOTALPFTPAID-PFTACCRUED/100 BALANCE_UMFC,
				0 BOUNCE_CHARGES_DUE,
				0 BOUNCE_CHARGES_RECEIVED,
				LB.BANKREFNO BRANCHID,
				LB.BRANCHDESC BRANCH_NAME, 
				PS.REPAYAMOUNT BULK_REFUND,
				0 CHASISNUM,
				0 CLOSED_CAN_ADV_EMI,
				0 CLOS_CAN_ADV_EMI_INTCOMP,
				0 CLOS_CAN_ADV_EMI_PRINCOMP,
				FM. MATURITYDATE CLOSUREDATE,
				FM.DUEBUCKET/100 CURRENT_BUCKET,
				LC.CUSTID CUSTOMERID,
				LC.CUSTSHRTNAME CUSTOMERNAME,
				FM.DUEBUCKET  DERIVED_BUCKET,
				DD.DISBDATE DISBURSALDATE,
				DD.DISBAMOUNT/100 DISBURSED_AMOUNT,
				CASE WHEN FM.FINASSETVALUE = FINCURRASSETVALUE THEN 'FD' ELSE 'PD' END DISB_STATUS,
				PD.CURODDAYS DPD,
				cast(FM.EFFECTIVERATEOFRETURN as number(10,7)) EFFECTIVE_RATE,
				(PD.ODPRINCIPAL+PD.ODPROFIT)/100 EMI_DUE,
				PFT.WAIVEDAMOUNT EMI_INTEREST_WAIVED,
				0 PRINCIPAL_AT_TERM,
				0 EMI_IN_ADVANCE_BILLED,
				0 EMI_IN_ADVANCE_RECEIVED_MAKER,
				EA.BALANCEAMT EMI_IN_ADVANCE_UNBILLED,
				0 EMI_IN_ADV_BILLED_INTCOMP,
				0 EMI_IN_ADV_BILLED_PRINCOMP,
				0 EMI_IN_ADV_UNBILLED_INTCOMP,
				0 EMI_IN_ADV_UNBILLED_PRINCOMP,
				PD.TOTALPFTBAL + PD.TOTALPRIBAL/100 EMI_OS,
				PRI.WAIVEDAMOUNT/100 EMI_PRINCIPAL_WAIVED,
				PD.TOTALPFTPAID+PD.TOTALPRIPAID/100 EMI_RECEIVED,
				'' ENGINENUM,
				PD.FIRSTREPAYDATE FIRST_DUE_DATE,
				OD.FINODSCHDDATE FIRST_REPAYDUE_DATE,
				cast(FM.REPAYPROFITRATE as number(10,7)) FLAT_RATE,
				FD.PAIDAMOUNT/100 FORECLOSURE_CHARGES_DUE,
				0 FORECLOSURE_CHARGES_RECEIVED,
				SUBSTR(AP.PAYMENTTYPE,0,1) INSTRUMENT,
				0 INSUR_PAID,
				0 INSUR_PAYABLE,
				0 INSUR_RECEIVABLE,
				0 INSUR_RECEIVED,
				0 INSUR_RENEW_CHARGE,
				0 INSUR_RENEW_CHARGE_RECD,
				PD.TOTALPFTBAL/100 INTEREST_BALANCE,
				PD.TDSCHDPFTBAL/100  INTEREST_DUE,
				PD.TOTALPFTBAL/100  INTEREST_OS,
				PD.TOTALPFTPAID/100  INTEREST_RECEIVED,
				0 INVOICEAMT,
				FM.FIRSTREPAY/100 LOAN_EMI,
				CASE FM.FINISACTIVE WHEN 1 THEN 'A' ELSE 'C' END LOAN_STATUS,
				'' LOCAL_OUTSTATION_FLAG,
				CHRG.TOTPENALTYBAL/100 LPP_CHARGES_RECEIVABLE,
				CHRG.TOTPENALTYPAID/100 LPP_CHARGES_RECEIVED,
				'' MAKE,
				FM.MATURITYDATE MATURITY_DATE,
				0 MIGRATED_ADVANCE_EMI,
				0 MIGRATED_ADVANCE_EMI_BILLED,
				0 MIGRATED_ADVANCE_EMI_UNBILLED,
				0 MIG_ADV_EMI_BILLED_INTCOMP,
				0 MIG_ADV_EMI_BILLED_PRINCOMP,
				0 MIG_ADV_EMI_UNBILLED_INTCOMP,
				0 MIG_ADV_EMI_UNBILLED_PRINCOMP,
				0 MIG_DIFFERENCE_PAID,
				0 MIG_DIFFERENCE_PAYABLE,
				0 MIG_DIFFERENCE_RECEIVABLE,
				0 MIG_DIFFERENCE_RECEIVED,
				EAE.AMOUNT/100 NET_EXCESS_ADJUSTED,
				EAE.UTILISEDAMT/100 NET_EXCESS_RECEIVED,
				ECAE.NO_OF_ADVANCE_EMIS NO_OF_ADVANCE_EMIS,
				(PD.NOINST - PD.NOPAIDINST)  NO_OF_EMI_OS, 
				(PD.NOINST - PD.NOPAIDINST - PD.NOODINST) NO_OF_UNBILLED_EMI,
				CASE WHEN FM.CLOSINGSTATUS='W' THEN 'WRITEOFF' ELSE 'REGULAR' END NPA_STAGEID,
				0 PDC_SWAP_CHARGES_RECEIVABLE,
				0 PDC_SWAP_CHARGES_RECEIVED,
				0 PRINCIPAL_BALANCE,
				PD.ODPRINCIPAL/100 PRINCIPAL_DUE,
				PD.TOTALPRIBAL/100 PRINCIPAL_OS,
				PD.TOTALPRIPAID/100 PRINCIPAL_RECEIVED,
				PRI.WAIVEDAMOUNT/100 PRINCIPAL_WAIVED,
				FT.FINCATEGORY PRODUCTFLAG,
				'' REGDNUM,
				0 REPO_CHARGES_RECEIVABLE,
				0 REPO_CHARGES_RECEIVED,
				'' REPO_DATE,
				'' ROUNDING_DIFF_RECEIVABLE,
				'' ROUNDING_DIFF_RECEIVED,
				ROUND(MONTHS_BETWEEN (FM.MATURITYDATE, FM.FINSTARTDATE)) SANCTIONED_TENURE,
				COALESCE(PR.PROMOTIONCODE, '0') SCHEMEID, 
				FT.FINTYPEDESC SCHEME_NAME,
				0 SECURITY_DEPOSIT,
				0 SECURITY_DEPOSIT_ADJUSTED,
				0 SOH_BALANCE,
				0 SOLD_SEIZE_PAID,
				0 SOLD_SEIZE_PAYABLE,
				0 SOLD_SEIZE_RECEIVABLE,
				0 SOLD_SEIZE_RECEIVED,
				'' SUPPLIERDESC,
				PD.TOTALPFTBAL/100 TOTAL_INTEREST,
				(WD.WRITTENOFFPRI+WD.WRITTENOFFPFT)/100 WRITEOFF_DUE,
				WP.WRITEOFFPAYAMOUNT/100 WRITEOFF_RECEIVED
				FROM FINANCEMAIN FM 
				INNER JOIN RMTFINANCETYPES FT ON FT.FINTYPE = FM.FINTYPE 
				LEFT JOIN PROMOTIONS PR ON  PR.FINTYPE = FT.FINTYPE
				LEFT JOIN FINEXCESSAMOUNT EA ON EA.FINREFERENCE = FM.FINREFERENCE AND EA.AMOUNTTYPE = 'A'
				LEFT JOIN FINEXCESSAMOUNT EAE ON EAE.FINREFERENCE = FM.FINREFERENCE AND EAE.AMOUNTTYPE = 'E'
				LEFT JOIN (SELECT count(*) NO_OF_ADVANCE_EMIS, T2.FINREFERENCE  FROM FINEXCESSMOVEMENT T1 INNER JOIN FINEXCESSAMOUNT T2 ON T1.EXCESSID = T2.EXCESSID
				WHERE  TRANTYPE = 'C' AND AMOUNTTYPE = 'A'
				GROUP BY T2.FINREFERENCE) ECAE ON ECAE.FINREFERENCE = FM.FINREFERENCE
				INNER JOIN FINPFTDETAILS PD ON PD.FINREFERENCE = FM.FINREFERENCE 
				INNER JOIN CUSTOMERS LC ON LC.CUSTID = FM.CUSTID
				INNER JOIN RMTBRANCHES LB ON LB.BRANCHCODE = FM.FINBRANCH
				LEFT JOIN (SELECT FINREFERENCE, SUM(REPAYAMOUNT) REPAYAMOUNT FROM FINREPAYHEADER WHERE FINEVENT= 'PartialSettlement' GROUP BY FINREFERENCE) PS ON PS.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT FINREFERENCE, SUM(REPAYAMOUNT) REPAYAMOUNT FROM FINREPAYHEADER WHERE FINEVENT= 'EarlySettlement' GROUP BY FINREFERENCE) ES ON ES.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN FINDISBURSEMENTDETAILS DD ON DD.FINREFERENCE = FM.FINREFERENCE AND DISBDATE = FM.FINSTARTDATE AND DD.DISBSEQ = 1 
				LEFT JOIN FINADVANCEPAYMENTS AP ON AP.FINREFERENCE = FM.FINREFERENCE AND AP.DISBSEQ = DD.DISBSEQ 
				LEFT JOIN (SELECT REFERENCE, SUM(WAIVEDAMOUNT) WAIVEDAMOUNT FROM RECEIPTALLOCATIONDETAIL PFT LEFT JOIN FINRECEIPTHEADER RH ON RH.RECEIPTID  = PFT.RECEIPTID AND RH.ALLOCATIONTYPE = 'PRI' GROUP BY REFERENCE) PRI ON PRI.REFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT REFERENCE, SUM(WAIVEDAMOUNT) WAIVEDAMOUNT FROM RECEIPTALLOCATIONDETAIL PFT LEFT JOIN FINRECEIPTHEADER RH ON RH.RECEIPTID  = PFT.RECEIPTID AND RH.ALLOCATIONTYPE = 'PFT' GROUP BY REFERENCE) PFT ON PFT.REFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT FINREFERENCE, SUM(TOTPENALTYBAL) TOTPENALTYBAL, SUM(TOTPENALTYPAID) TOTPENALTYPAID FROM FINODDETAILS GROUP BY FINREFERENCE) CHRG ON CHRG.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT FINREFERENCE, SUM(PAIDAMOUNT) PAIDAMOUNT FROM FINFEEDETAIL WHERE FINEVENT= 'EarlySettlement' GROUP BY FINREFERENCE) FD ON FD.FINREFERENCE = FM.FINREFERENCE 
				LEFT JOIN FINWRITEOFFDETAIL WD ON WD.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT FINREFERENCE, SUM(WRITEOFFPAYAMOUNT)  WRITEOFFPAYAMOUNT FROM FINWRITEOFFPAYMENT GROUP BY FINREFERENCE) WP ON WP.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN FINODDETAILS OD ON OD.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN FINPROVISIONS PR ON PR.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN NPABUCKETS NPB ON NPB.BUCKETID = PR.NPABUCKETID
		</createView>
	</changeSet>
	
	<changeSet id="49" author="Durgaprasad G">
	 	<dropTable tableName="PaymentInstructions"/>
	 	<dropTable tableName="PaymentInstructions_Temp"/>
	</changeSet>
	
   <changeSet id="50" author="Durgaprasad G">
		<createTable tableName="PaymentInstructions">
			<column name="PaymentInstructionId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PI_PIID" nullable="false"/>
			</column>
			<column name="PaymentId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PostDate" type="datetime"  />
			<column name="PaymentType" type="varchar(8)" />
			<column name="PaymentAmount" type="decimal(18,2)"  />
			<column name="PatnerBankId" type="bigInt"  />
			<column name="Remarks" type="varchar(100)"  />
			<column name="BankBranchID" type="bigInt"  />
			<column name="FavourName" type="varchar(200)"  />
			<column name="FavourNumber" type="nvarchar(100)"  />
			<column name="IssuingBank" type="varchar(8)"  />
			<column name="PayableLoc" type="nvarchar(50)"  />
			<column name="PrintingLoc" type="nvarchar(50)"  />
			<column name="AcctHolderName" type="nvarchar(200)"  />
			<column name="AccountNo" type="varchar(100)"  />
			<column name="PhoneCountryCode" type="varchar(5)"  />
			<column name="PhoneNumber" type="varchar(12)"  />
			<column name="ValueDate" type="datetime"  />
			<column name="Clearingdate" type="datetime"  />
			<column name="PaymentCCy" type="varchar(3)"  />
			<column name="Active" type="Char(1)"  />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	
	<changeSet id="51" author="Durgaprasad G">
		<addForeignKeyConstraint constraintName="FK_PI_PID"
			referencedTableName="PaymentHeader" referencedColumnNames="PaymentId"
			baseTableName="PaymentInstructions" baseColumnNames="PaymentId" />
	</changeSet>
	
	<changeSet id="52" author="Durgaprasad G">
		<createTable tableName="PaymentInstructions_Temp">
			<column name="PaymentInstructionId" type="bigint">
				<constraints primaryKey="true" primaryKeyName="PK_PI_TEMP_PIID" nullable="false"/>
			</column>
			<column name="PaymentId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PostDate" type="datetime"  />
			<column name="PaymentType" type="varchar(8)" />
			<column name="PaymentAmount" type="decimal(18,2)"  />
			<column name="PatnerBankId" type="bigInt"  />
			<column name="Remarks" type="varchar(100)"  />
			<column name="BankBranchID" type="bigInt"  />
			<column name="FavourName" type="varchar(200)"  />
			<column name="FavourNumber" type="nvarchar(100)"  />
			<column name="IssuingBank" type="varchar(8)"  />
			<column name="PayableLoc" type="nvarchar(50)"  />
			<column name="PrintingLoc" type="nvarchar(50)"  />
			<column name="AcctHolderName" type="nvarchar(200)"  />
			<column name="AccountNo" type="varchar(100)"  />
			<column name="PhoneCountryCode" type="varchar(5)"  />
			<column name="PhoneNumber" type="varchar(12)"  />
			<column name="ValueDate" type="datetime"  />
			<column name="Clearingdate" type="datetime"  />
			<column name="PaymentCCy" type="varchar(3)"  />
			<column name="Active" type="Char(1)"  />
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	
	<changeSet id="53" author="Manoj.P">
		<sql>
			update data_engine_config set Name = 'POSIDEX_CUSTOMER_UPDATE_RESPONSE', CRONEXPRESSION ='0 01 22 * * ?'  where Name = 'POSIDEX_CUSTOMER_UPDATEREQUEST';
			update data_engine_config set Name = 'POSIDEX_CUSTOMER_UPDATE_REQUEST'  where Name = 'POSIDEX_UPDATE_EODREQUEST';
		</sql>
	</changeSet>
	
	<changeSet id="54" author="Durgaprasad G">
	 <createView viewName="PAYMENTINSTRUCTIONS_VIEW" replaceIfExists="true">
  		SELECT	 T1.PaymentInstructionId, T1.PaymentId, T1.PaymentType, T1.PaymentAmount, T1.Remarks, T1.IssuingBank, T1.PatnerBankId,
				 T1.FavourName, T1.FavourNumber, T1.PayableLoc, T1.PrintingLoc, T1.ValueDate, T1.PostDate,
				 T1.BankBranchID, T1.AcctHolderName, T1.AccountNo, T1.PhoneCountryCode, T1.PhoneNumber, 
				 T1.Clearingdate, T1.Active, T1.PaymentCCy,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM     PaymentInstructions_Temp  T1 
		UNION ALL
		SELECT	 T1.PaymentInstructionId, T1.PaymentId, T1.PaymentType, T1.PaymentAmount, T1.Remarks, T1.IssuingBank, T1.PatnerBankId,
				 T1.FavourName, T1.FavourNumber, T1.PayableLoc, T1.PrintingLoc, T1.ValueDate, T1.PostDate,
				 T1.BankBranchID, T1.AcctHolderName, T1.AccountNo, T1.PhoneCountryCode, T1.PhoneNumber, 
				 T1.Clearingdate, T1.Active, T1.PaymentCCy,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM     PaymentInstructions  T1  
		WHERE NOT EXISTS ( SELECT 1  FROM PaymentInstructions_Temp WHERE PaymentInstructionId = T1.PaymentInstructionId)
	 </createView>
	</changeSet>
	
	<changeSet id="55" author="Durgaprasad G">
		<dropColumn columnName="PatnerBankId" tableName="PaymentInstructions" />
		<dropColumn columnName="PatnerBankId" tableName="PaymentInstructions_Temp" />
	</changeSet>
	
	<changeSet id="56" author="Durgaprasad G">
		<addColumn tableName="PaymentInstructions">
			<column name="PatnerBankId" type="bigInt"  />
		</addColumn>
		<addColumn tableName="PaymentInstructions_Temp">
			<column name="PatnerBankId" type="bigInt"  />
		</addColumn>
	</changeSet>
	
	<changeSet id="57" author="Durgaprasad G">
		<dropColumn columnName="PatnerBankId" tableName="PaymentInstructions" />
		<dropColumn columnName="PatnerBankId" tableName="PaymentInstructions_Temp" />
	</changeSet>
	
	<changeSet id="58" author="Durgaprasad G">
		<addColumn tableName="PaymentInstructions">
			<column name="PartnerBankId" type="bigInt"  />
		</addColumn>
		<addColumn tableName="PaymentInstructions_Temp">
			<column name="PartnerBankId" type="bigInt"  />
		</addColumn>
	</changeSet>
	
	<changeSet id="59" author="Durgaprasad G">
	 <createView viewName="PAYMENTINSTRUCTIONS_VIEW" replaceIfExists="true">
  		SELECT	 T1.PaymentInstructionId, T1.PaymentId, T1.PaymentType, T1.PaymentAmount, T1.Remarks, T1.IssuingBank, T1.PartnerBankId,
				 T1.FavourName, T1.FavourNumber, T1.PayableLoc, T1.PrintingLoc, T1.ValueDate, T1.PostDate,
				 T1.BankBranchID, T1.AcctHolderName, T1.AccountNo, T1.PhoneCountryCode, T1.PhoneNumber, 
				 T1.Clearingdate, T1.Active, T1.PaymentCCy,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM     PaymentInstructions_Temp  T1 
		UNION ALL
		SELECT	 T1.PaymentInstructionId, T1.PaymentId, T1.PaymentType, T1.PaymentAmount, T1.Remarks, T1.IssuingBank, T1.PartnerBankId,
				 T1.FavourName, T1.FavourNumber, T1.PayableLoc, T1.PrintingLoc, T1.ValueDate, T1.PostDate,
				 T1.BankBranchID, T1.AcctHolderName, T1.AccountNo, T1.PhoneCountryCode, T1.PhoneNumber, 
				 T1.Clearingdate, T1.Active, T1.PaymentCCy,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM     PaymentInstructions  T1  
		WHERE NOT EXISTS ( SELECT 1  FROM PaymentInstructions_Temp WHERE PaymentInstructionId = T1.PaymentInstructionId)
	 </createView>
	</changeSet>
	<changeSet id="54" author="Manoj.p">
		<createView viewName="INT_POSIDEX_CUST_VIEW" replaceIfExists="true">
					SELECT C.CUSTID CUSTOMER_NO,
				  '' SOURCE_SYS_ID,
				  C.CUSTFNAME FIRST_NAME,
				  C.CUSTMNAME MIDDLE_NAME,
				  C.CUSTLNAME LAST_NAME,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN CUSTDOB
				    ELSE NULL
				  END DOB,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN CDPAN.CUSTDOCTITLE
				    ELSE ''
				  END PAN,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN CDDLN.CUSTDOCTITLE
				    ELSE ''
				  END DRIVING_LICENSE_NUMBER,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN CDVTR.CUSTDOCTITLE
				    ELSE ''
				  END VOTER_ID,
				  CASE
				    WHEN C.CUSTCTGCODE='CORP'
				    THEN CUSTDOB
				    ELSE NULL
				  END DATE_OF_INCORPORATION,
				  CASE
				    WHEN C.CUSTCTGCODE='CORP'
				    THEN CDTAN.CUSTDOCTITLE
				    ELSE ''
				  END TAN_NO,
				  '' PROCESS_TYPE,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN 'I'
				    ELSE 'C'
				  END APPLICANT_TYPE,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN CAST(EMPNAME AS VARCHAR(105))
				    ELSE NULL
				  END EMPOYER_NAME,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN CUSTMOTHERMAIDEN
				    ELSE ''
				  END FATHER_NAME,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN CDPPT.CUSTDOCTITLE
				    ELSE ''
				  END PASSPORT_NO,
				  '' ACCOUNT_NUMBER,
				  '' CREDIT_CARD_NUMBER,
				  'N' PROCESS_FLAG,
				  '' ERROR_CODE,
				  '' ERROR_DESC,
				  C.CUSTCIF CUSTOMER_ID,
				  '' SOURCE_SYSTEM,
				  CAST(NULL AS NUMERIC(18,0)) PSX_BATCH_ID,
				  '' UCIN_FLAG,
				  CAST(NULL AS NUMERIC(18,0)) EOD_BATCH_ID,
				  SYSDATE INSERT_TS,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN CUSTGENDERCODE
				    ELSE ''
				  END GENDER,
				  CASE
				    WHEN C.CUSTCTGCODE='RETAIL'
				    THEN CDADR.CUSTDOCTITLE
				    ELSE ''
				  END AADHAR_NO,
				  CASE
				    WHEN C.CUSTCTGCODE='CORP'
				    THEN CDCIN.CUSTDOCTITLE
				    ELSE ''
				  END CIN,
				  CASE
				    WHEN C.CUSTCTGCODE='CORP'
				    THEN CDDIN.CUSTDOCTITLE
				    ELSE ''
				  END DIN,
				  CASE
				    WHEN C.CUSTCTGCODE='CORP'
				    THEN CDRGNO.CUSTDOCTITLE
				    ELSE ''
				  END REGISTRATION_NO,
				  CASE
				    WHEN C.CUSTCTGCODE='CORP'
				    THEN CDCANO.CUSTDOCTITLE
				    ELSE ''
				  END CA_NUMBER,
				  'CF' SEGMENT
				  
				FROM CUSTOMERS C
				LEFT JOIN CUSTOMERDOCUMENTS CDPAN ON CDPAN.CUSTID = C.CUSTID AND CDPAN.CUSTDOCCATEGORY='03'
				LEFT JOIN CUSTOMERDOCUMENTS CDDLN ON CDDLN.CUSTID = C.CUSTID AND CDDLN.CUSTDOCCATEGORY='04'
				LEFT JOIN CUSTOMERDOCUMENTS CDVTR ON CDVTR.CUSTID = C.CUSTID AND CDVTR.CUSTDOCCATEGORY='05'
				LEFT JOIN CUSTOMERDOCUMENTS CDTAN ON CDTAN.CUSTID = C.CUSTID AND CDTAN.CUSTDOCCATEGORY='15'
				LEFT JOIN CUSTOMERDOCUMENTS CDPPT ON CDPPT.CUSTID = C.CUSTID AND CDPPT.CUSTDOCCATEGORY='02'
				LEFT JOIN CUSTOMERDOCUMENTS CDADR ON CDADR.CUSTID = C.CUSTID AND CDADR.CUSTDOCCATEGORY='01'
				LEFT JOIN CUSTOMERDOCUMENTS CDCIN ON CDCIN.CUSTID = C.CUSTID AND CDCIN.CUSTDOCCATEGORY='16'
				LEFT JOIN CUSTOMERDOCUMENTS CDDIN ON CDDIN.CUSTID = C.CUSTID AND CDDIN.CUSTDOCCATEGORY='17'
				LEFT JOIN CUSTOMERDOCUMENTS CDRGNO ON CDRGNO.CUSTID = C.CUSTID AND CDRGNO.CUSTDOCCATEGORY='18'
				LEFT JOIN CUSTOMERDOCUMENTS CDCANO ON CDCANO.CUSTID  = C.CUSTID AND CDCANO.CUSTDOCCATEGORY='19'
				LEFT JOIN CUSTEMPLOYEEDETAIL CE ON CE.CUSTID = C.CUSTID LEFT JOIN CUSTOMERADDRESSES CA ON CA.CUSTID = C.CUSTID AND CUSTADDRPRIORITY=5
				WHERE C.CUSTADDLVAR1 IS NULL
		</createView>
	</changeSet>
	
	<changeSet id="60" author="Manoj.P">
		<createView viewName="INT_POSIDEX_CUST_LOAN_VIEW" replaceIfExists="true">
			SELECT C.CUSTID CUSTOMER_NO,
    '' SOURCE_SYS_ID,
    'CF' SEGMENT,
    FM.FINREFERENCE DEAL_ID,
    FM.FINREFERENCE LAN_NO,
    '' CUSTOMER_TYPE,
    SUBSTR(FM.FINREFERENCE, 7, LENGTH(FM.FINREFERENCE)) APPLN_NO,
    FM.FINTYPE PRODUCT_CODE,
    '' PROCESS_TYPE,
    'N' PROCESS_FLAG,
    '' ERROR_CODE,
    '' ERROR_DESC,
    0 PSX_BATCH_ID,
    0 PSX_ID,
    C.CUSTCIF CUSTOMER_ID,
    '' SOURCE_SYSTEM,
    0 EOD_BATCH_ID,
    FM.LASTMNTON FIN_LASTMNTON
  FROM FINANCEMAIN FM
  INNER JOIN CUSTOMERS C
  ON C.CUSTID = FM.CUSTID
		</createView>
	</changeSet>
	
	<changeSet id="61" author="Manoj.P">
		<createView viewName="INT_POSIDEX_CUST_ADDR_VIEW" replaceIfExists="true">
		SELECT C.CUSTID CUSTOMER_NO,
		  '' SOURCE_SYS_ID,
		  'CF' SEGMENT,
		  '' ADDRESS_TYPE,
		  CA.CUSTADDRHNBR ADDRESS_1,
		  CA.CUSTFLATNBR ADDRESS_2,
		   CA.CUSTADDRLINE1 ADDRESS_3,
		   CA.CUSTADDRPROVINCE STATE,
		   CA.CUSTADDRCITY CITY,
		   CA.CUSTADDRZIP PIN,
		     CAST(CPLND1.PHONECOUNTRYCODE+CPLND1.PHONEAREACODE+CPLND1.PHONENUMBER AS VARCHAR(48)) LANDLINE_1,
			  CAST(CPLND2.PHONECOUNTRYCODE+CPLND2.PHONEAREACODE+CPLND2.PHONENUMBER AS VARCHAR(48)) LANDLINE_2,
			    CAST(CPMOB.PHONECOUNTRYCODE +CPMOB.PHONEAREACODE+CPMOB.PHONENUMBER AS   VARCHAR(105)) MOBILE,
				 CA.CUSTADDRSTREET AREA,
			 CA.CUSTADDRLINE1 LANDMARK,
		
		   '' STD,	 
		   '' PROCESS_TYPE,
		   CEM.CUSTEMAIL EMAIL,
		   'N' PROCESS_FLAG,
		    '' ERROR_CODE,
		  '' ERROR_DESC,
		  C.CUSTCIF CUSTOMER_ID,
		  '' SOURCE_SYSTEM,
		   CAST(NULL AS NUMERIC(18,0)) PSX_BATCH_ID,
		  CAST(NULL AS NUMERIC(18,0)) EOD_BATCH_ID
		FROM CUSTOMERS C
		LEFT JOIN CUSTOMERADDRESSES CA ON CA.CUSTID = C.CUSTID AND CUSTADDRPRIORITY=5
		LEFT JOIN CUSTOMERPHONENUMBERS CPLND1 ON CPLND1.PHONECUSTID = C.CUSTID AND CPLND1.PHONETYPECODE='HOME'
		LEFT JOIN CUSTOMERPHONENUMBERS CPLND2 ON CPLND2.PHONECUSTID = C.CUSTID AND CPLND2.PHONETYPECODE='MOBILE2'
		LEFT JOIN CUSTOMERPHONENUMBERS CPMOB ON CPMOB.PHONECUSTID = C.CUSTID AND CPMOB.PHONETYPECODE='MOBILE1'
		LEFT JOIN CUSTOMEREMAILS CEM ON CEM.CUSTID = C.CUSTID AND CEM.CUSTEMAILPRIORITY=5
		WHERE C.CUSTADDLVAR1 IS NULL		
		</createView>
	</changeSet>
	<changeSet id="62" author="murthy.y">
		<createView viewName="INT_CF_CONTROL_VIEW" replaceIfExists="true">
			SELECT 
				PD.PFTACCRUED/100 ACCRUED_AMOUNT,
				COALESCE(EA.AMOUNT,0)/100 ADVANCE_EMI,
				0 ADVANCE_EMI_BILLED,
				SUBSTR(FM.FINREFERENCE, 7, LENGTH(FM.FINREFERENCE)) AGREEMENTID,
				FM.FINAPPROVEDDATE AGREEMENTDATE,
				FM.FINREFERENCE  AGREEMENTNO,
				FM.FINAMOUNT/100 AMTFIN,
				FM.FINASSETVALUE/100 ASSETCOST,
				'' ASSETDESC,
				TOTALPFTSCHD-TOTALPFTPAID-PFTACCRUED/100 BALANCE_UMFC,
				0 BOUNCE_CHARGES_DUE,
				0 BOUNCE_CHARGES_RECEIVED,
				LB.BANKREFNO BRANCHID,
				LB.BRANCHDESC BRANCH_NAME, 
				PS.REPAYAMOUNT BULK_REFUND,
				0 CHASISNUM,
				0 CLOSED_CAN_ADV_EMI,
				0 CLOS_CAN_ADV_EMI_INTCOMP,
				0 CLOS_CAN_ADV_EMI_PRINCOMP,
				FM. MATURITYDATE CLOSUREDATE,
				FM.DUEBUCKET/100 CURRENT_BUCKET,
				LC.CUSTID CUSTOMERID,
				LC.CUSTSHRTNAME CUSTOMERNAME,
				FM.DUEBUCKET  DERIVED_BUCKET,
				DD.DISBDATE DISBURSALDATE,
				DD.DISBAMOUNT/100 DISBURSED_AMOUNT,
				CASE WHEN FM.FINASSETVALUE = FINCURRASSETVALUE THEN 'FD' ELSE 'PD' END DISB_STATUS,
				PD.CURODDAYS DPD,
				cast(FM.EFFECTIVERATEOFRETURN as number(10,7)) EFFECTIVE_RATE,
				(PD.ODPRINCIPAL+PD.ODPROFIT)/100 EMI_DUE,
				PFT.WAIVEDAMOUNT EMI_INTEREST_WAIVED,
				0 PRINCIPAL_AT_TERM,
				0 EMI_IN_ADVANCE_BILLED,
				0 EMI_IN_ADVANCE_RECEIVED_MAKER,
				EA.BALANCEAMT EMI_IN_ADVANCE_UNBILLED,
				0 EMI_IN_ADV_BILLED_INTCOMP,
				0 EMI_IN_ADV_BILLED_PRINCOMP,
				0 EMI_IN_ADV_UNBILLED_INTCOMP,
				0 EMI_IN_ADV_UNBILLED_PRINCOMP,
				PD.TOTALPFTBAL + PD.TOTALPRIBAL/100 EMI_OS,
				PRI.WAIVEDAMOUNT/100 EMI_PRINCIPAL_WAIVED,
				PD.TOTALPFTPAID+PD.TOTALPRIPAID/100 EMI_RECEIVED,
				'' ENGINENUM,
				PD.FIRSTREPAYDATE FIRST_DUE_DATE,
				OD.FINODSCHDDATE FIRST_REPAYDUE_DATE,
				cast(FM.REPAYPROFITRATE as number(10,7)) FLAT_RATE,
				FD.PAIDAMOUNT/100 FORECLOSURE_CHARGES_DUE,
				0 FORECLOSURE_CHARGES_RECEIVED,
				SUBSTR(AP.PAYMENTTYPE,0,1) INSTRUMENT,
				0 INSUR_PAID,
				0 INSUR_PAYABLE,
				0 INSUR_RECEIVABLE,
				0 INSUR_RECEIVED,
				0 INSUR_RENEW_CHARGE,
				0 INSUR_RENEW_CHARGE_RECD,
				PD.TOTALPFTBAL/100 INTEREST_BALANCE,
				PD.TDSCHDPFTBAL/100  INTEREST_DUE,
				PD.TOTALPFTBAL/100  INTEREST_OS,
				PD.TOTALPFTPAID/100  INTEREST_RECEIVED,
				0 INVOICEAMT,
				FM.FIRSTREPAY/100 LOAN_EMI,
				CASE FM.FINISACTIVE WHEN 1 THEN 'A' ELSE 'C' END LOAN_STATUS,
				'' LOCAL_OUTSTATION_FLAG,
				CHRG.TOTPENALTYBAL/100 LPP_CHARGES_RECEIVABLE,
				CHRG.TOTPENALTYPAID/100 LPP_CHARGES_RECEIVED,
				'' MAKE,
				FM.MATURITYDATE MATURITY_DATE,
				0 MIGRATED_ADVANCE_EMI,
				0 MIGRATED_ADVANCE_EMI_BILLED,
				0 MIGRATED_ADVANCE_EMI_UNBILLED,
				0 MIG_ADV_EMI_BILLED_INTCOMP,
				0 MIG_ADV_EMI_BILLED_PRINCOMP,
				0 MIG_ADV_EMI_UNBILLED_INTCOMP,
				0 MIG_ADV_EMI_UNBILLED_PRINCOMP,
				0 MIG_DIFFERENCE_PAID,
				0 MIG_DIFFERENCE_PAYABLE,
				0 MIG_DIFFERENCE_RECEIVABLE,
				0 MIG_DIFFERENCE_RECEIVED,
				EAE.AMOUNT/100 NET_EXCESS_ADJUSTED,
				EAE.UTILISEDAMT/100 NET_EXCESS_RECEIVED,
				ECAE.NO_OF_ADVANCE_EMIS NO_OF_ADVANCE_EMIS,
				(PD.NOINST - PD.NOPAIDINST)  NO_OF_EMI_OS, 
				(PD.NOINST - PD.NOPAIDINST - PD.NOODINST) NO_OF_UNBILLED_EMI,
				CASE WHEN FM.CLOSINGSTATUS='W' THEN 'WRITEOFF' ELSE 'REGULAR' END NPA_STAGEID,
				0 PDC_SWAP_CHARGES_RECEIVABLE,
				0 PDC_SWAP_CHARGES_RECEIVED,
				0 PRINCIPAL_BALANCE,
				PD.ODPRINCIPAL/100 PRINCIPAL_DUE,
				PD.TOTALPRIBAL/100 PRINCIPAL_OS,
				PD.TOTALPRIPAID/100 PRINCIPAL_RECEIVED,
				PRI.WAIVEDAMOUNT/100 PRINCIPAL_WAIVED,
				FT.FINCATEGORY PRODUCTFLAG,
				'' REGDNUM,
				0 REPO_CHARGES_RECEIVABLE,
				0 REPO_CHARGES_RECEIVED,
				'' REPO_DATE,
				'' ROUNDING_DIFF_RECEIVABLE,
				'' ROUNDING_DIFF_RECEIVED,
				ROUND(MONTHS_BETWEEN (FM.MATURITYDATE, FM.FINSTARTDATE)) SANCTIONED_TENURE,
				COALESCE(PR.PROMOTIONCODE, '0') SCHEMEID, 
				FT.FINTYPEDESC SCHEME_NAME,
				0 SECURITY_DEPOSIT,
				0 SECURITY_DEPOSIT_ADJUSTED,
				0 SOH_BALANCE,
				0 SOLD_SEIZE_PAID,
				0 SOLD_SEIZE_PAYABLE,
				0 SOLD_SEIZE_RECEIVABLE,
				0 SOLD_SEIZE_RECEIVED,
				'' SUPPLIERDESC,
				PD.TOTALPFTBAL/100 TOTAL_INTEREST,
				(WD.WRITTENOFFPRI+WD.WRITTENOFFPFT)/100 WRITEOFF_DUE,
				WP.WRITEOFFPAYAMOUNT/100 WRITEOFF_RECEIVED,
        FM.LASTREPAYDATE
				FROM FINANCEMAIN FM 
				INNER JOIN RMTFINANCETYPES FT ON FT.FINTYPE = FM.FINTYPE 
				LEFT JOIN PROMOTIONS PR ON  PR.FINTYPE = FT.FINTYPE
				LEFT JOIN FINEXCESSAMOUNT EA ON EA.FINREFERENCE = FM.FINREFERENCE AND EA.AMOUNTTYPE = 'A'
				LEFT JOIN FINEXCESSAMOUNT EAE ON EAE.FINREFERENCE = FM.FINREFERENCE AND EAE.AMOUNTTYPE = 'E'
				LEFT JOIN (SELECT count(*) NO_OF_ADVANCE_EMIS, T2.FINREFERENCE  FROM FINEXCESSMOVEMENT T1 INNER JOIN FINEXCESSAMOUNT T2 ON T1.EXCESSID = T2.EXCESSID
				WHERE  TRANTYPE = 'C' AND AMOUNTTYPE = 'A'
				GROUP BY T2.FINREFERENCE) ECAE ON ECAE.FINREFERENCE = FM.FINREFERENCE
				INNER JOIN FINPFTDETAILS PD ON PD.FINREFERENCE = FM.FINREFERENCE 
				INNER JOIN CUSTOMERS LC ON LC.CUSTID = FM.CUSTID
				INNER JOIN RMTBRANCHES LB ON LB.BRANCHCODE = FM.FINBRANCH
				LEFT JOIN (SELECT FINREFERENCE, SUM(REPAYAMOUNT) REPAYAMOUNT FROM FINREPAYHEADER WHERE FINEVENT= 'PartialSettlement' GROUP BY FINREFERENCE) PS ON PS.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT FINREFERENCE, SUM(REPAYAMOUNT) REPAYAMOUNT FROM FINREPAYHEADER WHERE FINEVENT= 'EarlySettlement' GROUP BY FINREFERENCE) ES ON ES.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN FINDISBURSEMENTDETAILS DD ON DD.FINREFERENCE = FM.FINREFERENCE AND DISBDATE = FM.FINSTARTDATE AND DD.DISBSEQ = 1 
				LEFT JOIN FINADVANCEPAYMENTS AP ON AP.FINREFERENCE = FM.FINREFERENCE AND AP.DISBSEQ = DD.DISBSEQ 
				LEFT JOIN (SELECT REFERENCE, SUM(WAIVEDAMOUNT) WAIVEDAMOUNT FROM RECEIPTALLOCATIONDETAIL PFT LEFT JOIN FINRECEIPTHEADER RH ON RH.RECEIPTID  = PFT.RECEIPTID AND RH.ALLOCATIONTYPE = 'PRI' GROUP BY REFERENCE) PRI ON PRI.REFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT REFERENCE, SUM(WAIVEDAMOUNT) WAIVEDAMOUNT FROM RECEIPTALLOCATIONDETAIL PFT LEFT JOIN FINRECEIPTHEADER RH ON RH.RECEIPTID  = PFT.RECEIPTID AND RH.ALLOCATIONTYPE = 'PFT' GROUP BY REFERENCE) PFT ON PFT.REFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT FINREFERENCE, SUM(TOTPENALTYBAL) TOTPENALTYBAL, SUM(TOTPENALTYPAID) TOTPENALTYPAID FROM FINODDETAILS GROUP BY FINREFERENCE) CHRG ON CHRG.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT FINREFERENCE, SUM(PAIDAMOUNT) PAIDAMOUNT FROM FINFEEDETAIL WHERE FINEVENT= 'EarlySettlement' GROUP BY FINREFERENCE) FD ON FD.FINREFERENCE = FM.FINREFERENCE 
				LEFT JOIN FINWRITEOFFDETAIL WD ON WD.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN (SELECT FINREFERENCE, SUM(WRITEOFFPAYAMOUNT)  WRITEOFFPAYAMOUNT FROM FINWRITEOFFPAYMENT GROUP BY FINREFERENCE) WP ON WP.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN FINODDETAILS OD ON OD.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN FINPROVISIONS PR ON PR.FINREFERENCE = FM.FINREFERENCE
				LEFT JOIN NPABUCKETS NPB ON NPB.BUCKETID = PR.NPABUCKETID
		</createView>
	</changeSet>
	<changeSet id="63" author="murthy.y">
		<sql>
			update DATA_ENGINE_CONFIG set FILENAMEFORMAT = '_${CLIENT_CODE},${ddMM},.${SEQ_DATE_FILE}' where Name = 'DISB_HDFC_EXPORT';
		</sql>
	</changeSet>
	<changeSet id="64" author="Durgaprasad g">
		<createView viewName="PaymentDeatils_AView" replaceIfExists="true">
		SELECT	 PaymentDetailId, PaymentId, AmountType, Amount, Referenceid,
				 Version, LastMntBy, LastMntOn, RecordStatus, RoleCode, NextRoleCode,
				 TaskId, NextTaskId, RecordType, WorkflowId
		FROM     PaymentDeatils
		</createView>
	</changeSet>
</databaseChangeLog>