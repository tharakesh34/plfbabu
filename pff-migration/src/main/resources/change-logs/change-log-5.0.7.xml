<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />

	 <changeSet id="pre_run_for_pgp" author="Adarsh" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>

	<changeSet id="1" author="Saikiran.v">
		<addColumn tableName="RMTFinanceTypes">
			<column name="AllowDrawingPower" type="boolean" />
		</addColumn>
	</changeSet>
	<changeSet id="2" author="Saikiran.v">
		<addColumn tableName="RMTFinanceTypes_temp">
			<column name="AllowDrawingPower" type="boolean" />
		</addColumn>
	</changeSet>
	<changeSet id="3" author="Saikiran.v">
		<sql>
			<![CDATA[
				UPDATE RMTFinanceTypes Set AllowDrawingPower = 0;
				UPDATE RMTFinanceTypes_Temp Set AllowDrawingPower = 0;
			
			]]>
		</sql>
	</changeSet>

	<changeSet id="4" author="Saikiran.v" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_RMTFINANCETYPES_AlwDP DEFAULT 0 FOR AllowDrawingPower;
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_RMTFINANCETYPES_TEMP_AlwDP DEFAULT 0 FOR AllowDrawingPower;
			]]>
		</sql>
	</changeSet>

	<changeSet id="4" author="Saikiran.v" dbms="postgresql, oracle">
		<addDefaultValue columnName="AllowDrawingPower" tableName="RMTFinanceTypes" defaultValue="0" />
		<addDefaultValue columnName="AllowDrawingPower" tableName="RMTFinanceTypes_Temp" defaultValue="0" />
	</changeSet>

<changeSet id="5_pre" author="Saikiran.v" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_aview');
					
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="5" author="Saikiran.v">
		<createView viewName="rmtfinancetypes_aview" replaceIfExists="true">
		SELECT t1.fintype,
			t1.fincategory,
			t1.fintypedesc,
			t1.finccy,
			t1.findayscaltype,
			t1.finactype,
			t1.fincontingentactype,
			t1.finisgenref,
			t1.finmaxamount,
			t1.finminamount,
			t1.finisopennewfinac,
			t1.findftstmtfrq,
			t1.finisalwmd,
			t1.finschdmthd,
			t1.finisalwgrace,
			t1.finhistretension,
			t1.equalrepayment,
			t1.finratetype,
			t1.finbaserate,
			t1.finsplrate,
			t1.finintrate,
			t1.finminrate,
			t1.finmaxrate,
			t1.findftintfrq,
			t1.finisintcpz,
			t1.fincpzfrq,
			t1.finisrvwalw,
			t1.finrvwfrq,
			t1.fingrcratetype,
			t1.fingrcbaserate,
			t1.fingrcsplrate,
			t1.fingrcintrate,
			t1.fingrcminrate,
			t1.fingrcmaxrate,
			t1.fingrcdftintfrq,
			t1.fingrcisintcpz,
			t1.fingrccpzfrq,
			t1.fingrcisrvwalw,
			t1.fingrcrvwfrq,
			t1.finminterm,
			t1.finmaxterm,
			t1.findftterms,
			t1.finrpyfrq,
			t1.finrepaymethod,
			t1.finisalwpartialrpy,
			t1.finisalwdifferment,
			t1.finmaxdifferment,
			t1.finisalwearlyrpy,
			t1.finisalwearlysettle,
			t1.finodrpytries,
			t1.finearlypayrule,
			t1.finearlysettlerule,
			t1.findepositrestrictedto,
			t1.finaebuyorinception,
			t1.finaesellormaturity,
			t1.finisactive,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.stepfinance,
			t1.steppingmandatory,
			t1.alwmanualsteps,
			t1.alwdsteppolicies,
			t1.dftsteppolicy,
			t4.actypedesc  lovdescfincontingentactypename,
			t5.actypedesc  lovdescfinactypename,
			t1.finisdwpayrequired,
			t1.finrvwrateapplfor,
			t1.finalwratechangeanydate,
			t1.finisintcpzatgrcend,
			t1.finelgrulecode,
			t1.limitelgrulecode,
			t1.finschcalcodeonrvw,
			t1.alwplandeferment,
			t1.plandefercount,
			t1.finassettype,
			t1.pftpayactype,
			t1.finisopenpftpayacc,
			t31.actypedesc  lovdescpftpayactypename,
			t1.finisalwgrcrepay,
			t1.fingrcschdmthd,
			t1.fingrcmargin,
			t1.finmargin,
			t1.finscheduleon,
			t1.fingrcscheduleon,
			t1.fincommitmentreq,
			t1.fincollateralreq,
			t1.findepreciationreq,
			t1.findepreciationfrq,
			t1.finbankcontingentactype,
			t1.finprovisionactype,
			t38.actypedesc  lovdescfinbankcontactypename,
			t39.actypedesc  lovdescfinprovisionactypename,
			t1.allowriainvestment,
			t1.overridelimit,
			t1.limitrequired,
			t1.fincommitmentovrride,
			t1.fincollateralovrride,
			t1.finpftunchanged,
			t1.applyodpenalty,
			t1.odincgrcdays,
			t1.odchargetype,
			t1.odgracedays,
			t1.odchargecalon,
			t1.odchargeamtorperc,
			t1.odallowwaiver,
			t1.odmaxwaiverperc,
			t1.findivision,
			t48.divisioncodedesc  lovdescfindivisionname,
			t48.entitycode  lovdescentitycode,
			t1.finsuspactype,
			t49.actypedesc  lovdescfinsuspactypename,
			t1.product,
			t1.startdate,
			t1.enddate,
			t1.allowdownpaypgm,
			t1.remarks,
			t1.alwearlypaymethods,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.alwadvancerent,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.rolloverfinance,
			t1.rolloverfrq,
			t1.downpayrule,
			t59.rulecode  downpayrulecode,
			t59.rulecodedesc  downpayruledesc,
			t1.finsusptrigger,
			t1.finsuspremarks,
			t1.alwmultipartydisb,
			t1.collateraltype,
			t1.tdsapplicable,
			t1.manualschedule,
			t1.applygrcpricing,
			t1.grcpricingmethod,
			t1.applyrpypricing,
			t1.rpypricingmethod,
			t1.rpyhierarchy,
			t67.rulecode  grcpricingmethoddesc,
			t68.rulecode  rpypricingmethoddesc,
			t1.droplineod,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.finrepaypftonfrq,
			t1.alwbpi,
			t1.bpitreatment,
			t1.pftdueschon,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.fddlockperiod,
			t1.alwdrpymethods,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.roundingmode,
			t1.roundingtarget,
			t1.frequencydays,
			t1.quickdisb,
			t1.alwreage,
			t1.alwunplanemiholiday,
			t1.alwmaxdisbcheckreq,
			t1.fintypedesc  lovdescpromofintypedesc,
			t1.profitcenterid,
			t69.profitcentercode,
			t69.profitcenterdesc,
			t1.productcategory,
			t2.productdesc  fincategorydesc,
			t1.developerfinance,
			t1.costoffunds,
			t1.chequecapturereq,
			t1.finltvcheck,
			t1.partiallysecured,
			t1.alwadvemi,
			t1.advemiminterms,
			t1.advemimaxterms,
			t1.advemidftterms,
			t1.advemischdmthd,
			t1.bpipftdaysbasis,
			t1.eligibilitymethods,
			t1.alwhybridrate,
			t1.fixedratetenor,
			t1.odmincapamount,
			t1.odrulecode,
			t1.alwzerointacc,
			t1.autorejectiondays,
			t1.taxnomand,
			t1.putcallrequired,
			t1.grcadvintersetreq,
			t1.grcadvtype,
			t1.grcadvminterms,
			t1.grcadvmaxterms,
			t1.grcadvdefaultterms,
			t1.advintersetreq,
			t1.advtype,
			t1.advminterms,
			t1.advmaxterms,
			t1.advdefaultterms,
			t1.advstage,
			t1.dsfreq,
			t1.cashcollateralreq,
			t1.tdsallowtomodify,
			t1.tdsapplicableto,
			t1.alwvan,
			t1.vanallocationmethod,
			t1.AllowDrawingPower
		   FROM rmtfinancetypes t1
			 LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
			 LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
			 LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
			 LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
			 LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
			 LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
			 LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
			 LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
			 LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			 LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			 LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			 LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
</createView>
	</changeSet>

	<changeSet id="5_post" author="ADARSH" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_aview');
					
			]]>
		</sql>
	</changeSet>
	
	
	<changeSet id="6_pre" author="Saikiran.v" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_orgview');
					
			]]>
		</sql>
	</changeSet>

	<changeSet id="6" author="Saikiran.v">
		<createView viewName="rmtfinancetypes_orgview " replaceIfExists="true">	 
		SELECT t1.fintype,
			t1.fincategory,
			t1.fintypedesc,
			t1.finccy,
			t1.findayscaltype,
			t1.finactype,
			t1.fincontingentactype,
			t1.finisgenref,
			t1.finmaxamount,
			t1.finminamount,
			t1.finisopennewfinac,
			t1.finisalwmd,
			t1.finschdmthd,
			t1.finisalwgrace,
			t1.equalrepayment,
			t1.finratetype,
			t1.finbaserate,
			t1.finsplrate,
			t1.finintrate,
			t1.finminrate,
			t1.finmaxrate,
			t1.findftintfrq,
			t1.finisintcpz,
			t1.fincpzfrq,
			t1.finisrvwalw,
			t1.finrvwfrq,
			t1.fingrcratetype,
			t1.fingrcbaserate,
			t1.fingrcsplrate,
			t1.fingrcintrate,
			t1.fingrcminrate,
			t1.fingrcmaxrate,
			t1.fingrcdftintfrq,
			t1.fingrcisintcpz,
			t1.fingrccpzfrq,
			t1.fingrcisrvwalw,
			t1.fingrcrvwfrq,
			t1.finminterm,
			t1.finmaxterm,
			t1.findftterms,
			t1.finrpyfrq,
			t1.finrepaymethod,
			t1.finisalwdifferment,
			t1.finmaxdifferment,
			t1.finisactive,
			t1.stepfinance,
			t1.steppingmandatory,
			t1.alwmanualsteps,
			t1.alwdsteppolicies,
			t1.dftsteppolicy,
			t1.finisdwpayrequired,
			t1.finrvwrateapplfor,
			t1.finalwratechangeanydate,
			t1.finisintcpzatgrcend,
			t1.finschcalcodeonrvw,
			t1.alwplandeferment,
			t1.plandefercount,
			t1.pftpayactype,
			t1.finisopenpftpayacc,
			t1.finisalwgrcrepay,
			t1.fingrcschdmthd,
			t1.fingrcmargin,
			t1.finmargin,
			t1.fincommitmentreq,
			t1.fincollateralreq,
			t1.findepreciationreq,
			t1.findepreciationfrq,
			t1.finbankcontingentactype,
			t1.finprovisionactype,
			t1.allowriainvestment,
			t1.overridelimit,
			t1.limitrequired,
			t1.fincommitmentovrride,
			t1.fincollateralovrride,
			t1.finrepaypftonfrq,
			t1.finpftunchanged,
			t1.applyodpenalty,
			t1.odincgrcdays,
			t1.odchargetype,
			t1.odgracedays,
			t1.odchargecalon,
			t1.odchargeamtorperc,
			t1.odallowwaiver,
			t1.odmaxwaiverperc,
			t1.findivision,
			t3.divisioncodedesc  lovdescfindivisionname,
			t1.finsuspactype,
			t1.product,
			t1.startdate,
			t1.enddate,
			t1.allowdownpaypgm,
			t1.fintypedesc  lovdescpromofintypedesc,
			t1.remarks,
			t4.policydesc  lovdescdftsteppolicyname,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.alwadvancerent,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.rolloverfinance,
			t1.rolloverfrq,
			t1.downpayrule,
			t1.alwmultipartydisb,
			t1.collateraltype,
			t1.tdsapplicable,
			t5.rulecode  downpayrulecode,
			t5.rulecodedesc  downpayruledesc,
			t1.applygrcpricing,
			t1.applyrpypricing,
			t6.rulecode  grcpricingmethoddesc,
			t7.rulecode  rpypricingmethoddesc,
			t1.droplineod,
			t1.droppingmethod,
			t1.ratechganyday,
			t4.steptype  dftsteppolicytype,
			t1.manualschedule,
			t1.alwbpi,
			t1.bpitreatment,
			t1.pftdueschon,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.fddlockperiod,
			t1.alwdrpymethods,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.roundingmode,
			t1.roundingtarget,
			t1.frequencydays,
			t1.quickdisb,
			t1.alwreage,
			t1.alwunplanemiholiday,
			t1.alwmaxdisbcheckreq,
			t1.productcategory,
			t1.rpyhierarchy,
			t1.developerfinance,
			t3.entitycode  lovdescentitycode,
			t8.entitydesc  lovdescentitydesc,
			t1.costoffunds,
			t1.chequecapturereq,
			t1.finltvcheck,
			t1.partiallysecured,
			t1.alwadvemi,
			t1.advemiminterms,
			t1.advemimaxterms,
			t1.advemidftterms,
			t1.advemischdmthd,
			t1.bpipftdaysbasis,
			t1.eligibilitymethods,
			t1.alwhybridrate,
			t1.fixedratetenor,
			t1.odmincapamount,
			t1.odrulecode,
			t1.alwzerointacc,
			t1.finisalwpartialrpy,
			t1.autorejectiondays,
			t1.taxnomand,
			t1.putcallrequired,
			t1.grcadvintersetreq,
			t1.grcadvtype,
			t1.grcadvminterms,
			t1.grcadvmaxterms,
			t1.grcadvdefaultterms,
			t1.advintersetreq,
			t1.advtype,
			t1.advminterms,
			t1.advmaxterms,
			t1.advdefaultterms,
			t1.advstage,
			t1.dsfreq,
			t1.cashcollateralreq,
			t1.alwearlypaymethods,
			t1.tdsallowtomodify,
			t1.tdsapplicableto,
			t1.alwvan,
			t1.vanallocationmethod,
			t1.AllowDrawingPower
		   FROM rmtfinancetypes t1
			 JOIN smtdivisiondetail t3 ON t1.findivision = t3.divisioncode
			 LEFT JOIN steppolicyheader t4 ON t1.dftsteppolicy = t4.policycode
			 LEFT JOIN rules t5 ON t1.downpayrule = t5.ruleid
			 LEFT JOIN rules t6 ON t1.grcpricingmethod = t6.ruleid
			 LEFT JOIN rules t7 ON t1.rpypricingmethod = t7.ruleid
			 LEFT JOIN entity t8 ON t3.entitycode = t8.entitycode	 
</createView>
	</changeSet>

		<changeSet id="6_post" author="ADARSH" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_aview');
					
			]]>
		</sql>
	</changeSet>

	
		<changeSet id="7_pre" author="Saikiran.v" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_view');
					
			]]>
		</sql>
	</changeSet>
	<changeSet id="7" author="Saikiran.v">
		<createView viewName="rmtfinancetypes_view " replaceIfExists="true">	 	 
	
			 SELECT t1.fintype,
				t1.fincategory,
				t1.fintypedesc,
				t1.finccy,
				t1.findayscaltype,
				t1.finactype,
				t1.fincontingentactype,
				t1.finisgenref,
				t1.finmaxamount,
				t1.finminamount,
				t1.finisopennewfinac,
				t1.findftstmtfrq,
				t1.finisalwmd,
				t1.finschdmthd,
				t1.finisalwgrace,
				t1.finhistretension,
				t1.equalrepayment,
				t1.finratetype,
				t1.finbaserate,
				t1.finsplrate,
				t1.finintrate,
				t1.finminrate,
				t1.finmaxrate,
				t1.findftintfrq,
				t1.finisintcpz,
				t1.fincpzfrq,
				t1.finisrvwalw,
				t1.finrvwfrq,
				t1.fingrcratetype,
				t1.fingrcbaserate,
				t1.fingrcsplrate,
				t1.fingrcintrate,
				t1.fingrcminrate,
				t1.fingrcmaxrate,
				t1.fingrcdftintfrq,
				t1.fingrcisintcpz,
				t1.fingrccpzfrq,
				t1.fingrcisrvwalw,
				t1.fingrcrvwfrq,
				t1.finminterm,
				t1.finmaxterm,
				t1.findftterms,
				t1.finrpyfrq,
				t1.finrepaymethod,
				t1.finisalwpartialrpy,
				t1.finisalwdifferment,
				t1.finmaxdifferment,
				t1.finisalwearlyrpy,
				t1.finisalwearlysettle,
				t1.finodrpytries,
				t1.finearlypayrule,
				t1.finearlysettlerule,
				t1.findepositrestrictedto,
				t1.finaebuyorinception,
				t1.finaesellormaturity,
				t1.finisactive,
				t1.version,
				t1.lastmntby,
				t1.lastmnton,
				t1.recordstatus,
				t1.rolecode,
				t1.nextrolecode,
				t1.taskid,
				t1.nexttaskid,
				t1.recordtype,
				t1.workflowid,
				t1.stepfinance,
				t1.steppingmandatory,
				t1.alwmanualsteps,
				t1.alwdsteppolicies,
				t1.dftsteppolicy,
				t4.actypedesc  lovdescfincontingentactypename,
				t5.actypedesc  lovdescfinactypename,
				t1.finisdwpayrequired,
				t1.finrvwrateapplfor,
				t1.finalwratechangeanydate,
				t1.finisintcpzatgrcend,
				t1.finelgrulecode,
				t1.limitelgrulecode,
				t1.finschcalcodeonrvw,
				t1.alwplandeferment,
				t1.plandefercount,
				t1.finassettype,
				t1.pftpayactype,
				t1.finisopenpftpayacc,
				t31.actypedesc  lovdescpftpayactypename,
				t1.finisalwgrcrepay,
				t1.fingrcschdmthd,
				t1.fingrcmargin,
				t1.finmargin,
				t1.finscheduleon,
				t1.fingrcscheduleon,
				t1.fincommitmentreq,
				t1.fincollateralreq,
				t1.findepreciationreq,
				t1.findepreciationfrq,
				t1.finbankcontingentactype,
				t1.finprovisionactype,
				t38.actypedesc  lovdescfinbankcontactypename,
				t39.actypedesc  lovdescfinprovisionactypename,
				t1.allowriainvestment,
				t1.overridelimit,
				t1.limitrequired,
				t1.fincommitmentovrride,
				t1.fincollateralovrride,
				t1.finpftunchanged,
				t1.applyodpenalty,
				t1.odincgrcdays,
				t1.odchargetype,
				t1.odgracedays,
				t1.odchargecalon,
				t1.odchargeamtorperc,
				t1.odallowwaiver,
				t1.odmaxwaiverperc,
				t1.findivision,
				t48.divisioncodedesc  lovdescfindivisionname,
				t48.entitycode  lovdescentitycode,
				t1.finsuspactype,
				t49.actypedesc  lovdescfinsuspactypename,
				t1.product,
				t1.startdate,
				t1.enddate,
				t1.allowdownpaypgm,
				t1.fintypedesc  lovdescpromofintypedesc,
				t1.remarks,
				t1.alwearlypaymethods,
				t1.pastduepftcalmthd,
				t1.pastduepftmargin,
				t1.alwadvancerent,
				t1.grcadvbaserate,
				t1.grcadvmargin,
				t1.grcadvpftrate,
				t1.rpyadvbaserate,
				t1.rpyadvmargin,
				t1.rpyadvpftrate,
				t1.rolloverfinance,
				t1.rolloverfrq,
				t1.downpayrule,
				t59.rulecode  downpayrulecode,
				t59.rulecodedesc  downpayruledesc,
				t1.finsusptrigger,
				t1.finsuspremarks,
				t1.alwmultipartydisb,
				t1.collateraltype,
				t1.tdsapplicable,
				t1.manualschedule,
				t1.applygrcpricing,
				t1.grcpricingmethod,
				t1.applyrpypricing,
				t1.rpypricingmethod,
				t1.rpyhierarchy,
				t67.rulecode  grcpricingmethoddesc,
				t68.rulecode  rpypricingmethoddesc,
				t1.droplineod,
				t1.droppingmethod,
				t1.ratechganyday,
				t1.finrepaypftonfrq,
				t1.alwbpi,
				t1.bpitreatment,
				t1.pftdueschon,
				t1.planemihalw,
				t1.planemihmethod,
				t1.planemihmaxperyear,
				t1.planemihmax,
				t1.planemihlockperiod,
				t1.planemicpz,
				t1.unplanemihlockperiod,
				t1.unplanemicpz,
				t1.reagecpz,
				t1.fddlockperiod,
				t1.alwdrpymethods,
				t1.maxunplannedemi,
				t1.maxreageholidays,
				t1.roundingmode,
				t1.roundingtarget,
				t1.frequencydays,
				t1.quickdisb,
				t1.alwmaxdisbcheckreq,
				t1.alwreage,
				t1.alwunplanemiholiday,
				t1.profitcenterid,
				t69.profitcentercode,
				t69.profitcenterdesc,
				t1.productcategory,
				t2.productdesc  fincategorydesc,
				t1.developerfinance,
				t1.costoffunds,
				t1.chequecapturereq,
				t1.finltvcheck,
				t1.partiallysecured,
				t1.alwadvemi,
				t1.advemiminterms,
				t1.advemimaxterms,
				t1.advemidftterms,
				t1.advemischdmthd,
				t1.bpipftdaysbasis,
				t1.eligibilitymethods,
				t1.alwhybridrate,
				t1.fixedratetenor,
				t1.odmincapamount,
				t1.odrulecode,
				t1.alwzerointacc,
				t1.autorejectiondays,
				t1.taxnomand,
				t1.putcallrequired,
				t1.grcadvintersetreq,
				t1.grcadvtype,
				t1.grcadvminterms,
				t1.grcadvmaxterms,
				t1.grcadvdefaultterms,
				t1.advintersetreq,
				t1.advtype,
				t1.advminterms,
				t1.advmaxterms,
				t1.advdefaultterms,
				t1.advstage,
				t1.dsfreq,
				t1.cashcollateralreq,
				t1.tdsallowtomodify,
				t1.tdsapplicableto,
				t1.alwvan,
				t1.vanallocationmethod,
				t1.AllowDrawingPower
			   FROM rmtfinancetypes_temp t1
				 LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
				 LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
				 LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
				 LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
				 LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
				 LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
				 LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
				 LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
				 LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
				 LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
				 LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
				 LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
			UNION ALL
			 SELECT t1.fintype,
				t1.fincategory,
				t1.fintypedesc,
				t1.finccy,
				t1.findayscaltype,
				t1.finactype,
				t1.fincontingentactype,
				t1.finisgenref,
				t1.finmaxamount,
				t1.finminamount,
				t1.finisopennewfinac,
				t1.findftstmtfrq,
				t1.finisalwmd,
				t1.finschdmthd,
				t1.finisalwgrace,
				t1.finhistretension,
				t1.equalrepayment,
				t1.finratetype,
				t1.finbaserate,
				t1.finsplrate,
				t1.finintrate,
				t1.finminrate,
				t1.finmaxrate,
				t1.findftintfrq,
				t1.finisintcpz,
				t1.fincpzfrq,
				t1.finisrvwalw,
				t1.finrvwfrq,
				t1.fingrcratetype,
				t1.fingrcbaserate,
				t1.fingrcsplrate,
				t1.fingrcintrate,
				t1.fingrcminrate,
				t1.fingrcmaxrate,
				t1.fingrcdftintfrq,
				t1.fingrcisintcpz,
				t1.fingrccpzfrq,
				t1.fingrcisrvwalw,
				t1.fingrcrvwfrq,
				t1.finminterm,
				t1.finmaxterm,
				t1.findftterms,
				t1.finrpyfrq,
				t1.finrepaymethod,
				t1.finisalwpartialrpy,
				t1.finisalwdifferment,
				t1.finmaxdifferment,
				t1.finisalwearlyrpy,
				t1.finisalwearlysettle,
				t1.finodrpytries,
				t1.finearlypayrule,
				t1.finearlysettlerule,
				t1.findepositrestrictedto,
				t1.finaebuyorinception,
				t1.finaesellormaturity,
				t1.finisactive,
				t1.version,
				t1.lastmntby,
				t1.lastmnton,
				t1.recordstatus,
				t1.rolecode,
				t1.nextrolecode,
				t1.taskid,
				t1.nexttaskid,
				t1.recordtype,
				t1.workflowid,
				t1.stepfinance,
				t1.steppingmandatory,
				t1.alwmanualsteps,
				t1.alwdsteppolicies,
				t1.dftsteppolicy,
				t4.actypedesc  lovdescfincontingentactypename,
				t5.actypedesc  lovdescfinactypename,
				t1.finisdwpayrequired,
				t1.finrvwrateapplfor,
				t1.finalwratechangeanydate,
				t1.finisintcpzatgrcend,
				t1.finelgrulecode,
				t1.limitelgrulecode,
				t1.finschcalcodeonrvw,
				t1.alwplandeferment,
				t1.plandefercount,
				t1.finassettype,
				t1.pftpayactype,
				t1.finisopenpftpayacc,
				t31.actypedesc  lovdescpftpayactypename,
				t1.finisalwgrcrepay,
				t1.fingrcschdmthd,
				t1.fingrcmargin,
				t1.finmargin,
				t1.finscheduleon,
				t1.fingrcscheduleon,
				t1.fincommitmentreq,
				t1.fincollateralreq,
				t1.findepreciationreq,
				t1.findepreciationfrq,
				t1.finbankcontingentactype,
				t1.finprovisionactype,
				t38.actypedesc  lovdescfinbankcontactypename,
				t39.actypedesc  lovdescfinprovisionactypename,
				t1.allowriainvestment,
				t1.overridelimit,
				t1.limitrequired,
				t1.fincommitmentovrride,
				t1.fincollateralovrride,
				t1.finpftunchanged,
				t1.applyodpenalty,
				t1.odincgrcdays,
				t1.odchargetype,
				t1.odgracedays,
				t1.odchargecalon,
				t1.odchargeamtorperc,
				t1.odallowwaiver,
				t1.odmaxwaiverperc,
				t1.findivision,
				t48.divisioncodedesc  lovdescfindivisionname,
				t48.entitycode  lovdescentitycode,
				t1.finsuspactype,
				t49.actypedesc  lovdescfinsuspactypename,
				t1.product,
				t1.startdate,
				t1.enddate,
				t1.allowdownpaypgm,
				t1.fintypedesc  lovdescpromofintypedesc,
				t1.remarks,
				t1.alwearlypaymethods,
				t1.pastduepftcalmthd,
				t1.pastduepftmargin,
				t1.alwadvancerent,
				t1.grcadvbaserate,
				t1.grcadvmargin,
				t1.grcadvpftrate,
				t1.rpyadvbaserate,
				t1.rpyadvmargin,
				t1.rpyadvpftrate,
				t1.rolloverfinance,
				t1.rolloverfrq,
				t1.downpayrule,
				t59.rulecode  downpayrulecode,
				t59.rulecodedesc  downpayruledesc,
				t1.finsusptrigger,
				t1.finsuspremarks,
				t1.alwmultipartydisb,
				t1.collateraltype,
				t1.tdsapplicable,
				t1.manualschedule,
				t1.applygrcpricing,
				t1.grcpricingmethod,
				t1.applyrpypricing,
				t1.rpypricingmethod,
				t1.rpyhierarchy,
				t67.rulecode  grcpricingmethoddesc,
				t68.rulecode  rpypricingmethoddesc,
				t1.droplineod,
				t1.droppingmethod,
				t1.ratechganyday,
				t1.finrepaypftonfrq,
				t1.alwbpi,
				t1.bpitreatment,
				t1.pftdueschon,
				t1.planemihalw,
				t1.planemihmethod,
				t1.planemihmaxperyear,
				t1.planemihmax,
				t1.planemihlockperiod,
				t1.planemicpz,
				t1.unplanemihlockperiod,
				t1.unplanemicpz,
				t1.reagecpz,
				t1.fddlockperiod,
				t1.alwdrpymethods,
				t1.maxunplannedemi,
				t1.maxreageholidays,
				t1.roundingmode,
				t1.roundingtarget,
				t1.frequencydays,
				t1.quickdisb,
				t1.alwmaxdisbcheckreq,
				t1.alwreage,
				t1.alwunplanemiholiday,
				t1.profitcenterid,
				t69.profitcentercode,
				t69.profitcenterdesc,
				t1.productcategory,
				t2.productdesc  fincategorydesc,
				t1.developerfinance,
				t1.costoffunds,
				t1.chequecapturereq,
				t1.finltvcheck,
				t1.partiallysecured,
				t1.alwadvemi,
				t1.advemiminterms,
				t1.advemimaxterms,
				t1.advemidftterms,
				t1.advemischdmthd,
				t1.bpipftdaysbasis,
				t1.eligibilitymethods,
				t1.alwhybridrate,
				t1.fixedratetenor,
				t1.odmincapamount,
				t1.odrulecode,
				t1.alwzerointacc,
				t1.autorejectiondays,
				t1.taxnomand,
				t1.putcallrequired,
				t1.grcadvintersetreq,
				t1.grcadvtype,
				t1.grcadvminterms,
				t1.grcadvmaxterms,
				t1.grcadvdefaultterms,
				t1.advintersetreq,
				t1.advtype,
				t1.advminterms,
				t1.advmaxterms,
				t1.advdefaultterms,
				t1.advstage,
				t1.dsfreq,
				t1.cashcollateralreq,
				t1.tdsallowtomodify,
				t1.tdsapplicableto,
				t1.alwvan,
				t1.vanallocationmethod,
				t1.AllowDrawingPower
			   FROM rmtfinancetypes t1
				 LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
				 LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
				 LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
				 LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
				 LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
				 LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
				 LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
				 LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
				 LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
				 LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
				 LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
				 LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
			  WHERE NOT (EXISTS ( SELECT 1  expr1
					   FROM rmtfinancetypes_temp
					  WHERE rmtfinancetypes_temp.fintype = t1.fintype))				  
		  </createView>
	</changeSet>

	
	<changeSet id="7_post" author="ADARSH" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_view');
					
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="8.0" author="meena.a">
		<sql>
			<![CDATA[
				INSERT INTO SMTparameters (SysParmCode, SysParmDesc, SysParmType, SysParmMaint, SysParmValue, SysParmLength, SysParmDec, SysParmList, SysParmValdMod, SysParmDescription, Version, LastMntBy, LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NexttaskId, RecordType, WorkflowId) VALUES ('USR_ACCT_LOCK_DAYS', 'Numbre of days to auto lock the user account when the user is not login from the N number of days.', 'int', '0', '25', 2, 0, NULL, NULL, '', 1, 1000, CURRENT_TIMESTAMP,'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SMTparameters (SysParmCode, SysParmDesc, SysParmType, SysParmMaint, SysParmValue, SysParmLength, SysParmDec, SysParmList, SysParmValdMod, SysParmDescription, Version, LastMntBy, LastMntOn, RecordStatus, RoleCode, NextRoleCode, TaskId, NexttaskId, RecordType, WorkflowId) VALUES ('USR_ACCT_LOCK_CRON_EXPRESSION', 'Cron Expression for user account locking Job.', 'String', '0', '0 0 5 1/1 * ? *', 20, 0, NULL, NULL, '', 1, 1000, CURRENT_TIMESTAMP,'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="8.1" author="meena.a">
		<addColumn tableName="SecUsers">
			<column name="AccountLockedOn" type="datetime" />
			<column name="AccountUnLockedOn" type="datetime" />
		</addColumn>
	</changeSet>

	<changeSet id="8.2" author="meena.a">
		<addColumn tableName="SecUsers_temp">
			<column name="AccountLockedOn" type="datetime" />
			<column name="AccountUnLockedOn" type="datetime" />
		</addColumn>
	</changeSet>

	<changeSet id="8.3" author="meena.a">
		<sql>
			<![CDATA[
				update SMTparameters set SysParmMaint = 1 where SysParmCode = 'USR_ACCT_LOCK_DAYS';
			]]>
		</sql>
	</changeSet>

	<!-- GST Waiver Changes Start -->

	<changeSet author="Kesav" id="11">
		<comment>New columns added for GST Waivers</comment>
		<addColumn tableName="FinRepayScheduleDetail_Temp">
			<column name="PenaltyWaiverCGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="PenaltyWaiverSGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="PenaltyWaiverUGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="PenaltyWaiverIGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="12">
		<comment>New columns added for GST Waivers</comment>
		<addColumn tableName="FinRepayScheduleDetail">
			<column name="PenaltyWaiverCGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="PenaltyWaiverSGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="PenaltyWaiverUGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="PenaltyWaiverIGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="13">
		<comment>WaivedGST columns added for GST Waivers</comment>
		<addColumn tableName="ReceiptAllocationDetail">
			<column name="WaivedGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="14">
		<comment>WaivedGST columns added for GST Waivers</comment>
		<addColumn tableName="ReceiptAllocationDetail_Temp">
			<column name="WaivedGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet id="15" author="Kesav">
		<comment> WaivedGST column added for GST Waivers</comment>
		<createView viewName="ReceiptAllocationDetail_Aview" replaceIfExists="true">
			SELECT 		T1.receiptallocationid, T1.receiptid, T1.allocationid, T1.allocationtype, T1.allocationto, T1.paidamount, T1.waivedamount, COALESCE(T3.feetypedesc, T5.feetypedesc) AS typedesc, 
						T1.paidgst, T1.WaivedGST
			FROM 		ReceiptAllocationDetail T1
			LEFT JOIN   finfeedetail T2 ON T1.allocationto = T2.feeid AND T1.allocationtype = 'FEE'
			LEFT JOIN   feetypes T3 ON T2.feetypeid = T3.feetypeid
			LEFT JOIN   manualadvise T4 ON T1.allocationto = T4.adviseid AND T1.allocationtype = 'MANADV'
			LEFT JOIN   feetypes T5 ON T4.feetypeid = T5.feetypeid			
     	</createView>
	</changeSet>

	<changeSet id="16" author="Kesav">
		<comment> WaivedGST column added for GST Waivers</comment>
		<createView viewName="ReceiptAllocationDetail_View" replaceIfExists="true">
			SELECT 		T1.receiptallocationid, T1.receiptid, T1.allocationid, T1.allocationtype, T1.allocationto, T1.paidamount, T1.waivedamount, COALESCE(T3.feetypedesc, T5.feetypedesc) AS typedesc, 
						T1.paidgst, T1.waivedreqamount, T1.waiveraccepted, T1.totaldue, T1.WaivedGST
			FROM 		ReceiptAllocationDetail_Temp T1
			LEFT JOIN 	finfeedetail_temp T2 ON T1.allocationto = T2.feeid AND T1.allocationtype = 'FEE'
			LEFT JOIN 	feetypes T3 ON T2.feetypeid = T3.feetypeid
			LEFT JOIN 	manualadvise T4 ON T1.allocationto = T4.adviseid AND T1.allocationtype = 'MANADV'
			LEFT JOIN 	feetypes T5 ON T4.feetypeid = T5.feetypeid
			
			UNION ALL
			
			SELECT 		T1.receiptallocationid, T1.receiptid, T1.allocationid, T1.allocationtype, T1.allocationto, T1.paidamount, T1.waivedamount, COALESCE(T3.feetypedesc, T5.feetypedesc) AS typedesc, 
						T1.paidgst, T1.waivedreqamount, T1.waiveraccepted, T1.totaldue, T1.WaivedGST
			FROM 		ReceiptAllocationDetail T1
			LEFT JOIN 	finfeedetail T2 ON T1.allocationto = T2.feeid AND T1.allocationtype = 'FEE'
			LEFT JOIN 	feetypes T3 ON T2.feetypeid = T3.feetypeid
			LEFT JOIN 	manualadvise T4 ON T1.allocationto = T4.adviseid AND T1.allocationtype = 'MANADV'
			LEFT JOIN 	feetypes T5 ON T4.feetypeid = T5.feetypeid
			
			WHERE NOT (EXISTS ( SELECT 1 FROM ReceiptAllocationDetail_temp WHERE ReceiptAllocationDetail_temp.receiptid = T1.receiptid))			
     	</createView>
	</changeSet>

	<changeSet author="Kesav" id="17">
		<comment>WaivedCGST, Waived1SGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<addColumn tableName="ManualAdvise_Temp">
			<column name="WaivedCGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedSGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedIGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedUGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="18">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<addColumn tableName="ManualAdvise">
			<column name="WaivedCGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedSGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedIGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedUGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="19">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<addColumn tableName="ManualAdviseMovements_Temp">
			<column name="WaivedCGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedSGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedIGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedUGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="20">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<addColumn tableName="ManualAdviseMovements">
			<column name="WaivedCGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedSGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedIGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedUGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet id="21_pre" author="Kesav" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'manualadvise_aview');
					select deps_save_and_drop_dependencies ('plf', 'manualadvise_lview');
					select deps_save_and_drop_dependencies ('plf', 'manualadvise_tview');
					select deps_save_and_drop_dependencies ('plf', 'manualadvise_view');
					select deps_save_and_drop_dependencies ('plf', 'manualadvisemovements_aview');
					select deps_save_and_drop_dependencies ('plf', 'manualadvisemovements_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="21" author="Kesav">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<createView viewName="ManualAdvise_AView" replaceIfExists="true">
			SELECT  	T1.adviseid, T1.advisetype, T1.finreference, T1.feetypeid, T1.sequence, T1.adviseamount, T1.paidamount, T1.waivedamount, T1.remarks, T1.valuedate, T1.postdate, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T2.feetypedesc, T2.feetypecode, T1.bounceid, T1.receiptid, T3.bouncecode, T1.reservedamt, T1.balanceamt, 
						T3.reason AS bouncecodedesc, COALESCE(T2.taxapplicable, 0) AS taxapplicable, T2.taxcomponent, T1.paidcgst, T1.paidsgst, T1.paidigst, T1.paidugst,
						T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST
			FROM 		ManualAdvise T1
			LEFT JOIN 	feetypes T2 ON T1.feetypeid = T2.feetypeid
			LEFT JOIN 	bouncereasons T3 ON T1.bounceid = T3.bounceid			
     	</createView>
	</changeSet>
	<changeSet id="22" author="Kesav">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<createView viewName="ManualAdvise_LView" replaceIfExists="true">
			SELECT 		T1.adviseid, T1.advisetype, T1.finreference, T1.feetypeid, T1.sequence, T1.adviseamount, T1.paidamount, T1.waivedamount, T1.remarks, T1.valuedate, T1.postdate, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T2.feetypedesc, T2.feetypecode, T1.bounceid, T1.receiptid, T3.bouncecode, T1.reservedamt, T1.balanceamt, T3.reason AS bouncecodedesc, COALESCE(T2.taxapplicable, 0) AS taxapplicable, 
						T2.taxcomponent, T1.paidcgst, T1.paidsgst, T1.paidigst, T1.paidugst, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST
			FROM 		ManualAdvise T1
			LEFT JOIN 	feetypes T2 ON T1.feetypeid = T2.feetypeid
			LEFT JOIN 	bouncereasons T3 ON T1.bounceid = T3.bounceid			
     	</createView>
	</changeSet>

	<changeSet id="23" author="Kesav">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<createView viewName="ManualAdvise_TView" replaceIfExists="true">
			SELECT 		T1.adviseid, T1.advisetype, T1.finreference, T1.feetypeid, T1.sequence, T1.adviseamount, T1.paidamount, T1.waivedamount, T1.remarks, T1.valuedate, T1.postdate, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, T2.feetypedesc, T2.feetypecode, 
						T1.bounceid, T1.receiptid, T3.bouncecode, T1.reservedamt, T1.balanceamt, T3.reason AS bouncecodedesc, COALESCE(T2.taxapplicable, 0) AS taxapplicable, T2.taxcomponent, 
						T1.paidcgst, T1.paidsgst, T1.paidigst, T1.paidugst, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST
			FROM 		ManualAdvise_temp T1
			LEFT JOIN 	feetypes T2 ON T1.feetypeid = T2.feetypeid
			LEFT JOIN 	bouncereasons T3 ON T1.bounceid = T3.bounceid			
     	</createView>
	</changeSet>
	<changeSet id="24" author="Kesav">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<createView viewName="ManualAdvise_View" replaceIfExists="true">
			SELECT  	T1.adviseid, T1.advisetype, T1.finreference, T1.feetypeid, T1.sequence, T1.adviseamount, T1.paidamount, T1.waivedamount, T1.remarks, T1.valuedate, T1.postdate, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, T2.feetypedesc, T2.feetypecode, 
						T1.bounceid, T1.receiptid, T3.bouncecode, T1.reservedamt, T1.balanceamt, T3.reason AS bouncecodedesc, COALESCE(T2.taxapplicable, 0) AS taxapplicable, T2.taxcomponent, 
						T1.paidcgst, T1.paidsgst, T1.paidigst, T1.paidugst, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST
			FROM 		ManualAdvise_temp T1
			LEFT JOIN 	feetypes T2 ON T1.feetypeid = T2.feetypeid
			LEFT JOIN 	bouncereasons T3 ON T1.bounceid = T3.bounceid
			
			UNION ALL
			
			SELECT  	T1.adviseid, T1.advisetype, T1.finreference, T1.feetypeid, T1.sequence, T1.adviseamount, T1.paidamount, T1.waivedamount, T1.remarks, T1.valuedate, T1.postdate, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, T2.feetypedesc, T2.feetypecode, 
						T1.bounceid, T1.receiptid, T3.bouncecode, T1.reservedamt, T1.balanceamt, T3.reason AS bouncecodedesc, COALESCE(T2.taxapplicable, 0) AS taxapplicable, T2.taxcomponent, 
						T1.paidcgst, T1.paidsgst, T1.paidigst, T1.paidugst, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST
			FROM 		ManualAdvise T1
			LEFT JOIN 	feetypes T2 ON T1.feetypeid = T2.feetypeid
			LEFT JOIN 	bouncereasons T3 ON T1.bounceid = T3.bounceid
			WHERE NOT (EXISTS ( SELECT 1 FROM ManualAdvise_temp WHERE ManualAdvise_temp.adviseid = T1.adviseid))			
     	</createView>
	</changeSet>

	<changeSet id="25" author="Kesav">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<createView viewName="ManualAdvisemovements_AView" replaceIfExists="true">
			SELECT  	T1.movementid, T1.adviseid, T1.movementdate, T1.movementamount, T1.paidamount, T1.waivedamount, T1.status, T1.receiptid, T1.receiptseqid, 
						T1.paidcgst, T1.paidsgst, T1.paidigst, T1.paidugst, 
						T2.advisetype, T3.feetypecode, COALESCE(T3.taxapplicable, 0) AS taxapplicable, T3.taxcomponent, T3.feetypedesc, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST
			FROM 		ManualAdvisemovements T1
			JOIN 		ManualAdvise T2 ON T1.adviseid = T2.adviseid
			LEFT JOIN 	feetypes T3 ON T2.feetypeid = T3.feetypeid
     	</createView>
	</changeSet>

	<changeSet id="26" author="Kesav">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST columns added for GST Waivers</comment>
		<createView viewName="ManualAdvisemovements_TView" replaceIfExists="true">
			SELECT  	T1.movementid, T1.adviseid, T1.movementdate, T1.movementamount, T1.paidamount, T1.waivedamount, T1.status, T1.receiptid, T1.receiptseqid, 
						T1.paidcgst, T1.paidsgst, T1.paidigst, T1.paidugst, 
						T2.advisetype, T3.feetypecode, COALESCE(T3.taxapplicable, 0) AS taxapplicable, T3.taxcomponent, T3.feetypedesc, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST
			FROM 		ManualAdvisemovements_temp T1
			JOIN 		ManualAdvise T2 ON T1.adviseid = T2.adviseid
			LEFT JOIN 	feetypes T3 ON T2.feetypeid = T3.feetypeid			
     	</createView>
	</changeSet>

	<changeSet id="21_post" author="Kesav" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'manualadvise_aview');
					select deps_restore_dependencies ('plf', 'manualadvise_lview');
					select deps_restore_dependencies ('plf', 'manualadvise_tview');
					select deps_restore_dependencies ('plf', 'manualadvise_view');
					select deps_restore_dependencies ('plf', 'manualadvisemovements_aview');
					select deps_restore_dependencies ('plf', 'manualadvisemovements_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="27" author="Kesav">
		<comment>LPP Waiver GST accounting Configuration parameters</comment>
		<sql>
			insert into BMTAMOUNTCODES values('LATEPAY',0,'LPP_CGST_W','Penalty charge CGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
			insert into BMTAMOUNTCODES
			values('LATEPAY',0,'LPP_SGST_W','Penalty charge SGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
			insert into BMTAMOUNTCODES
			values('LATEPAY',0,'LPP_IGST_W','Penalty charge IGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
			insert into BMTAMOUNTCODES
			values('LATEPAY',0,'LPP_UGST_W','Penalty charge UGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
		</sql>
	</changeSet>

	<changeSet id="28" author="Kesav">
		<comment>Bounce Waiver GST accounting Configuration parameters</comment>
		<sql>
			insert into BMTAMOUNTCODES values('REPAY',0,'bounceCharge_CGST_W','Bounce charge CGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
			insert into BMTAMOUNTCODES
			values('REPAY',0,'bounceCharge_SGST_W','Bounce charge SGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
			insert into BMTAMOUNTCODES
			values('REPAY',0,'bounceCharge_IGST_W','Bounce charge IGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
			insert into BMTAMOUNTCODES
			values('REPAY',0,'bounceCharge_UGST_W','Bounce charge UGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);

			insert into BMTAMOUNTCODES values('EARLYSTL',0,'bounceCharge_CGST_W','Bounce charge CGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
			insert into BMTAMOUNTCODES
			values('EARLYSTL',0,'bounceCharge_SGST_W','Bounce charge SGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
			insert into BMTAMOUNTCODES
			values('EARLYSTL',0,'bounceCharge_IGST_W','Bounce charge IGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
			insert into BMTAMOUNTCODES
			values('EARLYSTL',0,'bounceCharge_UGST_W','Bounce charge UGST
			Waived',1,1,1000,Current_TimeStamp,'Approved',null,null,null,null,null,0);
		</sql>
	</changeSet>

	<changeSet author="Kesav" id="29">
		<comment>waivedGST column added for GST Waivers</comment>
		<addColumn tableName="FinFeeDetail">
			<column name="WaivedGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="30">
		<comment>waivedGST column added for GST Waivers</comment>
		<addColumn tableName="FinFeeDetail_Temp">
			<column name="WaivedGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="31">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST, WaivedTGST columns added for GST Waivers</comment>
		<addColumn tableName="FinTaxDetails">
			<column name="WaivedCGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedSGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedIGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedUGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedTGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="32">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST, WaivedTGST columns added for GST Waivers</comment>
		<addColumn tableName="FinTaxDetails_Temp">
			<column name="WaivedCGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedSGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedIGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedUGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
			<column name="WaivedTGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="33">
		<comment>waivedGST column added for GST Waivers</comment>
		<addColumn tableName="WIFFinFeeDetail">
			<column name="WaivedGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="34">
		<comment>waivedGST column added for GST Waivers</comment>
		<addColumn tableName="WIFFinFeeDetail_Temp">
			<column name="WaivedGST" type="decimal(18,0)" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet id="35_pre" author="Kesav" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'finfeedetail_aview');
					select deps_save_and_drop_dependencies ('plf', 'finfeedetail_tview');
					select deps_save_and_drop_dependencies ('plf', 'finfeedetail_view');
					select deps_save_and_drop_dependencies ('plf', 'fintaxdetails_aview');
					select deps_save_and_drop_dependencies ('plf', 'fintaxdetails_tview');
					select deps_save_and_drop_dependencies ('plf', 'fintaxdetails_view');
					select deps_save_and_drop_dependencies ('plf', 'wiffinfeedetail_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="35" author="Kesav">
		<comment>WaivedGST column added for GST Waivers</comment>
		<createView viewName="FinFeeDetail_Aview" replaceIfExists="true">
			SELECT  	t1.feeid, t1.finreference, t1.originationfee, t1.finevent, t1.feetypeid, t1.feeseq, t1.feeorder, t1.calculatedamount, t1.actualamount, t1.waivedamount, t1.paidamount, 
						t1.feeschedulemethod, t1.terms, t1.remainingfee, t1.paymentref, t1.calculationtype, t1.rulecode, t1.fixedamount, t1.percentage, t1.calculateon, t1.alwdeviation, t1.maxwaiverperc, 
						t1.alwmodifyfee, t1.alwmodifyfeeschdmthd, t1.vasreference, t1.taxapplicable, t1.taxcomponent, t1.paidamountoriginal, t1.paidamountgst, t1.netamountoriginal, t1.netamountgst, 
						t1.netamount, t1.remainingfeeoriginal, t1.remainingfeegst, t1.actualamountoriginal, t1.actualamountgst, t1.feeamz, 
						t1.version, t1.lastmntby, t1.lastmnton, t1.recordstatus, t1.rolecode, t1.nextrolecode, t1.taskid, t1.nexttaskid, t1.recordtype, t1.transactionid, t1.workflowid, 
						t2.feetypecode, t2.feetypedesc, t1.status, t1.refundable, t1.instructionuid, t1.actpercentage, T1.WaivedGST
			FROM 		finfeedetail t1
			LEFT JOIN 	feetypes t2 ON t1.feetypeid = t2.feetypeid				
     	</createView>
	</changeSet>

	<changeSet id="36" author="Kesav">
		<comment>WaivedGST column added for GST Waivers</comment>
		<createView viewName="finfeedetail_tview" replaceIfExists="true">
			SELECT 		t1.feeid, t1.finreference, t1.originationfee, t1.finevent, t1.feetypeid, t1.feeseq, t1.feeorder, t1.calculatedamount, t1.actualamount, t1.waivedamount, t1.paidamount, t1.feeschedulemethod,
						t1.terms, t1.remainingfee, t1.paymentref, t1.calculationtype, t1.rulecode, t1.fixedamount, t1.percentage, t1.calculateon, t1.alwdeviation, t1.maxwaiverperc, t1.alwmodifyfee, 
						t1.alwmodifyfeeschdmthd, t1.vasreference, t1.status, t1.taxapplicable, t1.taxcomponent, t1.paidamountoriginal, t1.paidamountgst, t1.netamountoriginal, t1.netamountgst, t1.netamount, 
						t1.remainingfeeoriginal, t1.remainingfeegst, t1.actualamountoriginal, t1.actualamountgst, t1.feeamz, 
						t1.version, t1.lastmntby, t1.lastmnton, t1.recordstatus, t1.rolecode, t1.nextrolecode, t1.taskid, t1.nexttaskid, t1.recordtype, t1.transactionid, t1.workflowid, 
						t2.feetypecode, t2.feetypedesc, t1.refundable, t1.instructionuid, t1.actpercentage, T1.WaivedGST
			FROM 		finfeedetail_temp t1
			LEFT JOIN 	feetypes t2 ON t1.feetypeid = t2.feetypeid				
     	</createView>
	</changeSet>

	<changeSet id="37" author="Kesav">
		<comment>WaivedGST column added for GST Waivers</comment>
		<createView viewName="finfeedetail_view" replaceIfExists="true">
			SELECT 		t1.feeid, t1.finreference, t1.originationfee, t1.finevent, t1.feetypeid, t1.feeseq, t1.feeorder, t1.calculatedamount, t1.actualamount, t1.waivedamount, t1.paidamount, 
						t1.feeschedulemethod, t1.terms, t1.remainingfee, t1.paymentref, t1.calculationtype, t1.rulecode, t1.fixedamount, t1.percentage, t1.calculateon, t1.alwdeviation, t1.maxwaiverperc, 
						t1.alwmodifyfee, t1.alwmodifyfeeschdmthd, t1.vasreference, t1.status, t1.taxapplicable, t1.taxcomponent, t1.paidamountoriginal, t1.paidamountgst, t1.netamountoriginal, 
						t1.netamountgst, t1.netamount, t1.remainingfeeoriginal, t1.remainingfeegst, t1.actualamountoriginal, t1.actualamountgst, t1.feeamz, 
						t1.version, t1.lastmntby, t1.lastmnton, t1.recordstatus, t1.rolecode, t1.nextrolecode, t1.taskid, t1.nexttaskid, t1.recordtype, t1.transactionid, t1.workflowid, 
						t2.feetypecode, t2.feetypedesc, t1.refundable, t1.instructionuid, t1.actpercentage, T1.WaivedGST
			FROM 		finfeedetail_temp t1
			LEFT JOIN 	feetypes t2 ON t1.feetypeid = t2.feetypeid
			
			UNION ALL
			
			SELECT 		t1.feeid, t1.finreference, t1.originationfee, t1.finevent, t1.feetypeid, t1.feeseq, t1.feeorder, t1.calculatedamount, t1.actualamount, t1.waivedamount, t1.paidamount, 
						t1.feeschedulemethod, t1.terms, t1.remainingfee, t1.paymentref, t1.calculationtype, t1.rulecode, t1.fixedamount, t1.percentage, t1.calculateon, t1.alwdeviation, t1.maxwaiverperc, 
						t1.alwmodifyfee, t1.alwmodifyfeeschdmthd, t1.vasreference, t1.status, t1.taxapplicable, t1.taxcomponent, t1.paidamountoriginal, t1.paidamountgst, t1.netamountoriginal, 
						t1.netamountgst, t1.netamount, t1.remainingfeeoriginal, t1.remainingfeegst, t1.actualamountoriginal, t1.actualamountgst, t1.feeamz, 
						t1.version, t1.lastmntby, t1.lastmnton, t1.recordstatus, t1.rolecode, t1.nextrolecode, t1.taskid, t1.nexttaskid, t1.recordtype, t1.transactionid, t1.workflowid, 
						t2.feetypecode, t2.feetypedesc, t1.refundable, t1.instructionuid, t1.actpercentage, T1.WaivedGST
			FROM 		finfeedetail t1
			LEFT JOIN 	feetypes t2 ON t1.feetypeid = t2.feetypeid
			
			WHERE NOT (EXISTS ( SELECT 1 FROM finfeedetail_temp WHERE finfeedetail_temp.feeid = t1.feeid))				
     	</createView>
	</changeSet>

	<changeSet id="38" author="Kesav">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST, WaivedTGST columns added for GST Waivers</comment>
		<createView viewName="fintaxdetails_aview" replaceIfExists="true">
			SELECT 		T1.fintaxid, T1.feeid, T1.paidcgst, T1.paidigst, T1.paidugst, T1.paidsgst, T1.paidtgst, T1.netcgst, T1.netigst, T1.netugst, T1.netsgst, T1.nettgst, T1.remfeecgst, T1.remfeeigst,T1.remfeeugst, T1.remfeesgst, T1.remfeetgst, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T1.actualcgst, T1.actualigst, T1.actualugst, T1.actualsgst, T1.actualtgst, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST, T1.WaivedTGST
			FROM 		fintaxdetails T1
			LEFT JOIN 	finfeedetail T2 ON T1.feeid = T2.feeid			
     	</createView>
	</changeSet>

	<changeSet id="39" author="Kesav">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST, WaivedTGST columns added for GST Waivers</comment>
		<createView viewName="fintaxdetails_tview" replaceIfExists="true">
			SELECT 		T1.fintaxid, T1.feeid, T1.paidcgst, T1.paidigst, T1.paidugst, T1.paidsgst, T1.paidtgst, T1.netcgst, T1.netigst, T1.netugst, T1.netsgst, T1.nettgst, T1.remfeecgst, T1.remfeeigst, T1.remfeeugst, T1.remfeesgst, T1.remfeetgst, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T1.actualcgst, T1.actualigst, T1.actualugst, T1.actualsgst, T1.actualtgst, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST, T1.WaivedTGST
			FROM 		fintaxdetails_temp T1
			LEFT JOIN 	finfeedetail T2 ON T1.feeid = T2.feeid			
     	</createView>
	</changeSet>

	<changeSet id="40" author="Kesav">
		<comment>WaivedCGST, WaivedSGST, WaivedUGST, WaivedIGST, WaivedTGST columns added for GST Waivers</comment>
		<createView viewName="fintaxdetails_view" replaceIfExists="true">
			SELECT 		T1.fintaxid, T1.feeid, T1.paidcgst, T1.paidigst, T1.paidugst, T1.paidsgst, T1.paidtgst, T1.netcgst, T1.netigst, T1.netugst, T1.netsgst, T1.nettgst, T1.remfeecgst, T1.remfeeigst, T1.remfeeugst, T1.remfeesgst, T1.remfeetgst, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T1.actualcgst, T1.actualigst, T1.actualugst, T1.actualsgst, T1.actualtgst, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST, T1.WaivedTGST
			FROM 		fintaxdetails_temp T1
			LEFT JOIN 	finfeedetail T2 ON T1.feeid = T2.feeid
			
			UNION ALL
			
			SELECT 		T1.fintaxid, T1.feeid, T1.paidcgst, T1.paidigst, T1.paidugst, T1.paidsgst, T1.paidtgst, T1.netcgst, T1.netigst, T1.netugst, T1.netsgst, T1.nettgst, T1.remfeecgst, T1.remfeeigst, T1.remfeeugst, T1.remfeesgst, T1.remfeetgst, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T1.actualcgst, T1.actualigst, T1.actualugst, T1.actualsgst, T1.actualtgst, T1.WaivedCGST, T1.WaivedSGST, T1.WaivedUGST, T1.WaivedIGST, T1.WaivedTGST
			FROM 		fintaxdetails T1
			LEFT JOIN 	finfeedetail T2 ON T1.feeid = T2.feeid
			WHERE NOT (EXISTS ( SELECT 1 FROM fintaxdetails_temp WHERE fintaxdetails_temp.feeid = T1.feeid AND fintaxdetails_temp.fintaxid = T1.fintaxid))				
     	</createView>
	</changeSet>

	<changeSet id="41" author="Kesav">
		<comment>WaivedGST column added for GST Waivers</comment>
		<createView viewName="Wiffinfeedetail_View" replaceIfExists="true">
			SELECT 		T1.feeid, T1.finreference, T1.feeseq, T1.originationfee, T1.finevent, T1.feetypeid, T1.feeorder, T1.calculatedamount, T1.actualamount, T1.waivedamount, T1.paidamount, 
						T1.feeschedulemethod, T1.terms, T1.remainingfee, T1.paymentref, T1.calculationtype, T1.rulecode, T1.fixedamount, T1.percentage, T1.calculateon, T1.alwdeviation, T1.maxwaiverperc, 
						T1.alwmodifyfee, T1.alwmodifyfeeschdmthd, T1.vasreference, T1.status, T1.taxapplicable, T1.taxcomponent, T1.paidamountoriginal, T1.paidamountgst, T1.netamountoriginal, 
						T1.netamountgst, T1.netamount, T1.remainingfeeoriginal, T1.remainingfeegst, T1.actualamountoriginal, T1.actualamountgst, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T2.feetypecode, T2.feetypedesc, T1.refundable, T1.instructionuid, T1.WaivedGST
			FROM 		wiffinfeedetail_temp T1
			LEFT JOIN 	feetypes T2 ON T1.feetypeid = T2.feetypeid
			
			UNION ALL
			 
			SELECT 		T1.feeid, T1.finreference, T1.feeseq, T1.originationfee, T1.finevent, T1.feetypeid, T1.feeorder, T1.calculatedamount, T1.actualamount, T1.waivedamount, T1.paidamount, 
						T1.feeschedulemethod, T1.terms, T1.remainingfee, T1.paymentref, T1.calculationtype, T1.rulecode, T1.fixedamount, T1.percentage, T1.calculateon, T1.alwdeviation, T1.maxwaiverperc, 
						T1.alwmodifyfee, T1.alwmodifyfeeschdmthd, T1.vasreference, T1.status, T1.taxapplicable, T1.taxcomponent, T1.paidamountoriginal, T1.paidamountgst, T1.netamountoriginal, 
						T1.netamountgst, T1.netamount, T1.remainingfeeoriginal, T1.remainingfeegst, T1.actualamountoriginal, T1.actualamountgst, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T2.feetypecode, T2.feetypedesc, T1.refundable, T1.instructionuid, T1.WaivedGST
			FROM 		wiffinfeedetail T1
			LEFT JOIN 	feetypes T2 ON T1.feetypeid = T2.feetypeid
			
			WHERE NOT (EXISTS ( SELECT 1 FROM wiffinfeedetail_temp WHERE wiffinfeedetail_temp.finreference = T1.finreference AND wiffinfeedetail_temp.originationfee = T1.originationfee AND wiffinfeedetail_temp.finevent = T1.finevent AND wiffinfeedetail_temp.feetypeid = T1.feetypeid))				
     	</createView>
	</changeSet>

	<changeSet id="35_post" author="Kesav" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'finfeedetail_aview');
					select deps_restore_dependencies ('plf', 'finfeedetail_tview');
					select deps_restore_dependencies ('plf', 'finfeedetail_view');
					select deps_restore_dependencies ('plf', 'fintaxdetails_aview');
					select deps_restore_dependencies ('plf', 'fintaxdetails_tview');
					select deps_restore_dependencies ('plf', 'fintaxdetails_view');
					select deps_restore_dependencies ('plf', 'wiffinfeedetail_view');
			]]>
		</sql>
	</changeSet>

	<changeSet author="Kesav" id="42">
		<comment>ReferenceId column added for Receipt Fees</comment>
		<addColumn tableName="FinFeeDetail">
			<column name="ReferenceId" type="bigint" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="43">
		<comment>ReferenceId column added for Receipt Fees</comment>
		<addColumn tableName="FinFeeDetail_Temp">
			<column name="ReferenceId" type="bigint" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="44">
		<comment>ReferenceId column added for Receipt Fees</comment>
		<addColumn tableName="WIFFinFeeDetail">
			<column name="ReferenceId" type="bigint" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet author="Kesav" id="45">
		<comment>ReferenceId column added for Receipt Fees</comment>
		<addColumn tableName="WIFFinFeeDetail_Temp">
			<column name="ReferenceId" type="bigint" defaultValue="0">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet id="46_pre" author="Kesav" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'finfeedetail_aview');
					select deps_save_and_drop_dependencies ('plf', 'finfeedetail_tview');
					select deps_save_and_drop_dependencies ('plf', 'finfeedetail_view');
					select deps_save_and_drop_dependencies ('plf', 'wiffinfeedetail_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="46" author="Kesav">
		<comment>ReferenceId column added for Receipt Fees</comment>
		<createView viewName="FinFeeDetail_Aview" replaceIfExists="true">
			SELECT  	t1.feeid, t1.finreference, t1.originationfee, t1.finevent, t1.feetypeid, t1.feeseq, t1.feeorder, t1.calculatedamount, t1.actualamount, t1.waivedamount, t1.paidamount, 
						t1.feeschedulemethod, t1.terms, t1.remainingfee, t1.paymentref, t1.calculationtype, t1.rulecode, t1.fixedamount, t1.percentage, t1.calculateon, t1.alwdeviation, t1.maxwaiverperc, 
						t1.alwmodifyfee, t1.alwmodifyfeeschdmthd, t1.vasreference, t1.taxapplicable, t1.taxcomponent, t1.paidamountoriginal, t1.paidamountgst, t1.netamountoriginal, t1.netamountgst, 
						t1.netamount, t1.remainingfeeoriginal, t1.remainingfeegst, t1.actualamountoriginal, t1.actualamountgst, t1.feeamz, 
						t1.version, t1.lastmntby, t1.lastmnton, t1.recordstatus, t1.rolecode, t1.nextrolecode, t1.taskid, t1.nexttaskid, t1.recordtype, t1.transactionid, t1.workflowid, 
						t2.feetypecode, t2.feetypedesc, t1.status, t1.refundable, t1.instructionuid, t1.actpercentage, T1.WaivedGST, T1.ReferenceId
			FROM 		finfeedetail t1
			LEFT JOIN 	feetypes t2 ON t1.feetypeid = t2.feetypeid				
     	</createView>
	</changeSet>

	<changeSet id="47" author="Kesav">
		<comment>ReferenceId column added for Receipt Fees</comment>
		<createView viewName="finfeedetail_tview" replaceIfExists="true">
			SELECT 		t1.feeid, t1.finreference, t1.originationfee, t1.finevent, t1.feetypeid, t1.feeseq, t1.feeorder, t1.calculatedamount, t1.actualamount, t1.waivedamount, t1.paidamount, t1.feeschedulemethod,
						t1.terms, t1.remainingfee, t1.paymentref, t1.calculationtype, t1.rulecode, t1.fixedamount, t1.percentage, t1.calculateon, t1.alwdeviation, t1.maxwaiverperc, t1.alwmodifyfee, 
						t1.alwmodifyfeeschdmthd, t1.vasreference, t1.status, t1.taxapplicable, t1.taxcomponent, t1.paidamountoriginal, t1.paidamountgst, t1.netamountoriginal, t1.netamountgst, t1.netamount, 
						t1.remainingfeeoriginal, t1.remainingfeegst, t1.actualamountoriginal, t1.actualamountgst, t1.feeamz, 
						t1.version, t1.lastmntby, t1.lastmnton, t1.recordstatus, t1.rolecode, t1.nextrolecode, t1.taskid, t1.nexttaskid, t1.recordtype, t1.transactionid, t1.workflowid, 
						t2.feetypecode, t2.feetypedesc, t1.refundable, t1.instructionuid, t1.actpercentage, T1.WaivedGST, T1.ReferenceId
			FROM 		finfeedetail_temp t1
			LEFT JOIN 	feetypes t2 ON t1.feetypeid = t2.feetypeid				
     	</createView>
	</changeSet>

	<changeSet id="48" author="Kesav">
		<comment>ReferenceId column added for Receipt Fees</comment>
		<createView viewName="finfeedetail_view" replaceIfExists="true">
			SELECT 		t1.feeid, t1.finreference, t1.originationfee, t1.finevent, t1.feetypeid, t1.feeseq, t1.feeorder, t1.calculatedamount, t1.actualamount, t1.waivedamount, t1.paidamount, 
						t1.feeschedulemethod, t1.terms, t1.remainingfee, t1.paymentref, t1.calculationtype, t1.rulecode, t1.fixedamount, t1.percentage, t1.calculateon, t1.alwdeviation, t1.maxwaiverperc, 
						t1.alwmodifyfee, t1.alwmodifyfeeschdmthd, t1.vasreference, t1.status, t1.taxapplicable, t1.taxcomponent, t1.paidamountoriginal, t1.paidamountgst, t1.netamountoriginal, 
						t1.netamountgst, t1.netamount, t1.remainingfeeoriginal, t1.remainingfeegst, t1.actualamountoriginal, t1.actualamountgst, t1.feeamz, 
						t1.version, t1.lastmntby, t1.lastmnton, t1.recordstatus, t1.rolecode, t1.nextrolecode, t1.taskid, t1.nexttaskid, t1.recordtype, t1.transactionid, t1.workflowid, 
						t2.feetypecode, t2.feetypedesc, t1.refundable, t1.instructionuid, t1.actpercentage, T1.WaivedGST, T1.ReferenceId
			FROM 		finfeedetail_temp t1
			LEFT JOIN 	feetypes t2 ON t1.feetypeid = t2.feetypeid
			
			UNION ALL
			
			SELECT 		t1.feeid, t1.finreference, t1.originationfee, t1.finevent, t1.feetypeid, t1.feeseq, t1.feeorder, t1.calculatedamount, t1.actualamount, t1.waivedamount, t1.paidamount, 
						t1.feeschedulemethod, t1.terms, t1.remainingfee, t1.paymentref, t1.calculationtype, t1.rulecode, t1.fixedamount, t1.percentage, t1.calculateon, t1.alwdeviation, t1.maxwaiverperc, 
						t1.alwmodifyfee, t1.alwmodifyfeeschdmthd, t1.vasreference, t1.status, t1.taxapplicable, t1.taxcomponent, t1.paidamountoriginal, t1.paidamountgst, t1.netamountoriginal, 
						t1.netamountgst, t1.netamount, t1.remainingfeeoriginal, t1.remainingfeegst, t1.actualamountoriginal, t1.actualamountgst, t1.feeamz, 
						t1.version, t1.lastmntby, t1.lastmnton, t1.recordstatus, t1.rolecode, t1.nextrolecode, t1.taskid, t1.nexttaskid, t1.recordtype, t1.transactionid, t1.workflowid, 
						t2.feetypecode, t2.feetypedesc, t1.refundable, t1.instructionuid, t1.actpercentage, T1.WaivedGST, T1.ReferenceId
			FROM 		finfeedetail t1
			LEFT JOIN 	feetypes t2 ON t1.feetypeid = t2.feetypeid
			
			WHERE NOT (EXISTS ( SELECT 1 FROM finfeedetail_temp WHERE finfeedetail_temp.feeid = t1.feeid))				
     	</createView>
	</changeSet>

	<changeSet id="49" author="Kesav">
		<comment>ReferenceId column added for Receipt Fees</comment>
		<createView viewName="Wiffinfeedetail_View" replaceIfExists="true">
			SELECT 		T1.feeid, T1.finreference, T1.feeseq, T1.originationfee, T1.finevent, T1.feetypeid, T1.feeorder, T1.calculatedamount, T1.actualamount, T1.waivedamount, T1.paidamount, 
						T1.feeschedulemethod, T1.terms, T1.remainingfee, T1.paymentref, T1.calculationtype, T1.rulecode, T1.fixedamount, T1.percentage, T1.calculateon, T1.alwdeviation, T1.maxwaiverperc, 
						T1.alwmodifyfee, T1.alwmodifyfeeschdmthd, T1.vasreference, T1.status, T1.taxapplicable, T1.taxcomponent, T1.paidamountoriginal, T1.paidamountgst, T1.netamountoriginal, 
						T1.netamountgst, T1.netamount, T1.remainingfeeoriginal, T1.remainingfeegst, T1.actualamountoriginal, T1.actualamountgst, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T2.feetypecode, T2.feetypedesc, T1.refundable, T1.instructionuid, T1.WaivedGST, T1.ReferenceId
			FROM 		wiffinfeedetail_temp T1
			LEFT JOIN 	feetypes T2 ON T1.feetypeid = T2.feetypeid
			
			UNION ALL
			 
			SELECT 		T1.feeid, T1.finreference, T1.feeseq, T1.originationfee, T1.finevent, T1.feetypeid, T1.feeorder, T1.calculatedamount, T1.actualamount, T1.waivedamount, T1.paidamount, 
						T1.feeschedulemethod, T1.terms, T1.remainingfee, T1.paymentref, T1.calculationtype, T1.rulecode, T1.fixedamount, T1.percentage, T1.calculateon, T1.alwdeviation, T1.maxwaiverperc, 
						T1.alwmodifyfee, T1.alwmodifyfeeschdmthd, T1.vasreference, T1.status, T1.taxapplicable, T1.taxcomponent, T1.paidamountoriginal, T1.paidamountgst, T1.netamountoriginal, 
						T1.netamountgst, T1.netamount, T1.remainingfeeoriginal, T1.remainingfeegst, T1.actualamountoriginal, T1.actualamountgst, 
						T1.version, T1.lastmntby, T1.lastmnton, T1.recordstatus, T1.rolecode, T1.nextrolecode, T1.taskid, T1.nexttaskid, T1.recordtype, T1.workflowid, 
						T2.feetypecode, T2.feetypedesc, T1.refundable, T1.instructionuid, T1.WaivedGST, T1.ReferenceId
			FROM 		wiffinfeedetail T1
			LEFT JOIN 	feetypes T2 ON T1.feetypeid = T2.feetypeid
			
			WHERE NOT (EXISTS ( SELECT 1 FROM wiffinfeedetail_temp WHERE wiffinfeedetail_temp.finreference = T1.finreference AND wiffinfeedetail_temp.originationfee = T1.originationfee AND wiffinfeedetail_temp.finevent = T1.finevent AND wiffinfeedetail_temp.feetypeid = T1.feetypeid))				
     	</createView>
	</changeSet>

	<changeSet id="46_post" author="Kesav" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'finfeedetail_aview');
					select deps_restore_dependencies ('plf', 'finfeedetail_tview');
					select deps_restore_dependencies ('plf', 'finfeedetail_view');
					select deps_restore_dependencies ('plf', 'wiffinfeedetail_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="50" author="Kesav">
		<sql>
		 	<![CDATA[
			    delete from plf.SMTPARAMETERS where sysparmcode='ALW_PROFIT_SCHD_INVOICE';
				INSERT INTO SMTPARAMETERS Values('ALW_PROFIT_SCHD_INVOICE','Allow Profit Schedule Invoice','String', 0, 'N', 1, 0, NULL, NULL,'Allow Profit Schedule Invoice',1,  1000,CURRENT_TIMESTAMP,'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<!-- GST Waiver Changes END -->

	<changeSet id="51" author="Durga Prasad G">
		<sql>
		 	<![CDATA[
				Update ERRORDETAILS set MESSAGE= '{0} Creation rejected, Reason: {1} ' Where Code ='99014';
			]]>
		</sql>
	</changeSet> 

	<changeSet id="52" author="Manoj.P">
		<addColumn tableName="ReportConfiguration">
			<column name="scheduleReq" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="53" author="Manoj.P">
		<sql>
                   <![CDATA[
                          Update ReportConfiguration set scheduleReq=0;
                    ]]>
		</sql>
	</changeSet>
	<!-- 5.0.7 is Under QC please use 5.0.5 -->
</databaseChangeLog>