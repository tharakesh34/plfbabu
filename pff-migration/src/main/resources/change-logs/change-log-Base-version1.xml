<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />
	
	<changeSet id="pre_run_for_pgp" author="Jayant" runAlways="true" dbms="postgresql" >
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>	
	</changeSet>
	
	<!-- <changeSet id="1" author="Prakash">
     <addColumn tableName="FinJointAccountDetails">
     	<column name="AuthoritySignatory" type="Boolean"/>
     	<column name="Sequence" type="Number(10,0)"/>
     </addColumn>
    </changeSet> -->
     
     <changeSet id="2" author="Prakash">
     <addColumn tableName="FinJointAccountDetails_Temp">
     	<column name="AuthoritySignatory" type="Boolean"/>
     	<column name="Sequence" type="Number(10,0)"/>
     </addColumn>
     </changeSet>
     
     <changeSet id="3" author="Prakash">
     <createView viewName="finjointaccountdetails_view" replaceIfExists="true">
		     	SELECT t1.jointaccountid,t1.finreference,t1.custcif,t1.includerepay,t1.repayaccountid,t1.CatOfcoApplicant,t1.AuthoritySignatory,t1.Sequence,
		    t1.version,t1.lastmntby,t1.lastmnton,t1.recordstatus,t1.rolecode,t1.nextrolecode,t1.taskid,t1.nexttaskid,
		    t1.recordtype,t1.workflowid,t2.usrlogin,t2.usrfname,t2.usrmname,t2.usrlname,t3.custshrtname AS lovdesccifname,t3.custid
		   FROM finjointaccountdetails_temp t1
		     JOIN secusers t2 ON t1.lastmntby = t2.usrid
		     JOIN customers t3 ON t1.custcif = t3.custcif
		UNION ALL
		 SELECT t1.jointaccountid,t1.finreference,t1.custcif,t1.includerepay,t1.repayaccountid,t1.CatOfcoApplicant,t1.AuthoritySignatory,t1.Sequence,
		    t1.version,t1.lastmntby,t1.lastmnton,t1.recordstatus,t1.rolecode,t1.nextrolecode,t1.taskid,t1.nexttaskid,
		    t1.recordtype,t1.workflowid,t2.usrlogin,t2.usrfname,t2.usrmname,t2.usrlname,t3.custshrtname AS lovdesccifname,t3.custid
		   FROM finjointaccountdetails t1
		     JOIN secusers t2 ON t1.lastmntby = t2.usrid
		     JOIN customers t3 ON t1.custcif = t3.custcif
		  WHERE NOT (EXISTS ( SELECT 1
		           FROM finjointaccountdetails_temp
		          WHERE finjointaccountdetails_temp.jointaccountid = t1.jointaccountid))
     </createView>
     </changeSet>
    
     <changeSet id="4" author="Prakash">
     <createView viewName="finjointaccountdetails_Tview" replaceIfExists="true">
		     	SELECT t1.jointaccountid,t1.finreference,t1.custcif,t1.includerepay,t1.repayaccountid,t1.CatOfcoApplicant,t1.AuthoritySignatory,t1.Sequence,
		    t1.version,t1.lastmntby,t1.lastmnton,t1.recordstatus,t1.rolecode,t1.nextrolecode,t1.taskid,t1.nexttaskid,
		    t1.recordtype,t1.workflowid,t2.usrlogin,t2.usrfname,t2.usrmname,t2.usrlname,t3.custshrtname AS lovdesccifname,t3.custid
		   FROM finjointaccountdetails_temp t1
		     JOIN secusers t2 ON t1.lastmntby = t2.usrid
		     JOIN customers t3 ON t1.custcif = t3.custcif
		
     </createView>
     </changeSet>
     
     <changeSet id="5" author="Prakash">
     <createView viewName="finjointaccountdetails_Aview" replaceIfExists="true">
		     	SELECT t1.jointaccountid,t1.finreference,t1.custcif,t1.includerepay,t1.repayaccountid,t1.CatOfcoApplicant,t1.AuthoritySignatory,t1.Sequence,
		    t1.version,t1.lastmntby,t1.lastmnton,t1.recordstatus,t1.rolecode,t1.nextrolecode,t1.taskid,t1.nexttaskid,
		    t1.recordtype,t1.workflowid,t2.usrlogin,t2.usrfname,t2.usrmname,t2.usrlname,t3.custshrtname AS lovdesccifname,t3.custid
		   FROM finjointaccountdetails t1
		     JOIN secusers t2 ON t1.lastmntby = t2.usrid
		     JOIN customers t3 ON t1.custcif = t3.custcif
		
     </createView>
     </changeSet>
     
     <changeSet id="6" author="Prakash">
     <sql>
     	delete from plf.BMTLovFIELDCODE where fieldcode = 'cofco-app' ;
     </sql>
	</changeSet>
	<changeSet id="8" author="Durga Prasad D">
		<sql>
		delete from bmtlovfieldcode where fieldCode = 'PUR_LOAN';
		insert into bmtlovfieldcode values('PUR_LOAN', 'Purpose Of Loan', 'String', 1, 1, 1, 1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0);

		delete from rmtlovfielddetail where fieldCode = 'PUR_LOAN';
		update seqrmtlovfielddetail set seqno = (Select Max(fieldcodeid) from rmtlovfielddetail);
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'),'BT', 'Balance Transfer',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'),'LC', 'Loan Consolidation',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'),'CPP', 'Office/Commercial Property Purchase',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'),'BSEXON', 'Business Expansion - Online',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);										  
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'), 'WC', 'Working Capital',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);										  
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'),'BREX', 'Branch Expansion',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);										  
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'),'BSEXOF', 'Business Expansion - Offline',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);										  
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'),'INVP', 'Inventory Purchase',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);											  
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'),'MACPUR', 'Machinery purchase',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);		  
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='PUR_LOAN'),'OTHERS', 'Others',1,1,1007, CURRENT_TIMESTAMP, 'Approved','','','','','',0, 0);	
		update seqrmtlovfielddetail set seqno = (Select Max(fieldcodeid) from rmtlovfielddetail);
		</sql>
	</changeSet>
	
	<changeSet id="9" author="Prakash">
		<sql>
		delete from rmtlovfielddetail where fieldCode = 'CAT_COAPP';
		update seqrmtlovfielddetail set seqno = (Select Max(fieldcodeid) from rmtlovfielddetail);
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='CAT_COAPP'),'Husband','Husband',1,1,1000,current_timestamp,'Approved','','','','','',0,0,'');
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='CAT_COAPP'),'Wife','Wife',1,1,1000,current_timestamp,'Approved','','','','','',0,0,'');
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='CAT_COAPP'),'Mother','Mother',1,1,1000,current_timestamp,'Approved','','','','','',0,0,'');
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='CAT_COAPP'),'Father','Father',1,1,1000,current_timestamp,'Approved','','','','','',0,0,'');										  
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='CAT_COAPP'),'Son','Son',1,1,1000,current_timestamp,'Approved','','','','','',0,0,'');										  
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='CAT_COAPP'),'Daughter','Daughter',1,1,1000,current_timestamp,'Approved','','','','','',0,0,'');										  
		insert into rmtlovfielddetail values((Select Max(fieldcodeid)+1 from rmtlovfielddetail),(Select fieldcode from bmtlovfieldcode where fieldcode='CAT_COAPP'),'Self','Self',1,1,1000,current_timestamp,'Approved','','','','','',0,0,'');										  
		update seqrmtlovfielddetail set seqno = (Select Max(fieldcodeid) from rmtlovfielddetail);
		</sql>
	</changeSet>
	 
     
<changeSet id="6" author="Amit">
	<addColumn tableName="BMTDocumentTypes">
		<column name="DocIsPdfExtRequired" type="boolean" />
		<column name="DocIsPasswordProtected" type="boolean" />
		<column name="PdfMappingRef" type="NUMBER(19,0)" />
	</addColumn>
	<addColumn tableName="BMTDocumentTypes_temp">
		<column name="DocIsPdfExtRequired" type="boolean" />
		<column name="DocIsPasswordProtected" type="boolean" />
		<column name="PdfMappingRef" type="NUMBER(19,0)" />
	</addColumn>
</changeSet>	
  <changeSet id="7" author="Amit" >
	<createView viewName="BMTDocumentTypes_View" replaceIfExists="true">
		  	SELECT DocTypeCode ,
           DocTypeDesc ,
           DocIsMandatory ,
           DocTypeIsActive ,
           DocIsCustDoc ,
           Version ,
           LastMntBy ,
           LastMntOn ,
           RecordStatus ,
           RoleCode ,
           NextRoleCode ,
           TaskId ,
           NextTaskId ,
           RecordType ,
           WorkflowId ,
           DocExpDateIsMand ,
           DocIssueDateMand ,
           DocIdNumMand ,
           DocIssuedAuthorityMand,
           DocIsPdfExtRequired,
           DocIsPasswordProtected,
           PdfMappingRef 
     FROM BMTDocumentTypes_Temp 
   UNION ALL 
   SELECT DocTypeCode ,
           DocTypeDesc ,
           DocIsMandatory ,
           DocTypeIsActive ,
           DocIsCustDoc ,
           Version ,
           LastMntBy ,
           LastMntOn ,
           RecordStatus ,
           RoleCode ,
           NextRoleCode ,
           TaskId ,
           NextTaskId ,
           RecordType ,
           WorkflowId ,
           DocExpDateIsMand ,
           DocIssueDateMand ,
           DocIdNumMand ,
           DocIssuedAuthorityMand,
           DocIsPdfExtRequired,
           DocIsPasswordProtected,
           PdfMappingRef  
     FROM BMTDocumentTypes 
     WHERE NOT EXISTS ( SELECT 1 
                        FROM BMTDocumentTypes_Temp 
                          WHERE DocTypeCode = BMTDocumentTypes.DocTypeCode )
	</createView>
</changeSet>
  
  <changeSet id="8" author="Amit" >
	<createView viewName="BMTDOCUMENTTYPES_AVIEW" replaceIfExists="true">
		  	SELECT DocTypeCode ,
          DocTypeDesc ,
          DocIsMandatory ,
          DocTypeIsActive ,
          DocIsCustDoc ,
          Version ,
          LastMntBy ,
          LastMntOn ,
          RecordStatus ,
          RoleCode ,
          NextRoleCode ,
          TaskId ,
          NextTaskId ,
          RecordType ,
          WorkflowId ,
          DocExpDateIsMand ,
          DocIssueDateMand ,
          DocIdNumMand ,
          DocIssuedAuthorityMand,
           DocIsPdfExtRequired,
           DocIsPasswordProtected,
           PdfMappingRef   
     FROM BMTDocumentTypes
	</createView>
</changeSet>

<changeSet id="9" author="Amit">
		<sql>		
	Update BMTDOCUMENTTYPES set DOCISPDFEXTREQUIRED=0 , DOCISPASSWORDPROTECTED=0 , PDFMAPPINGREF=0;
	Update BMTDOCUMENTTYPES_Temp set DOCISPDFEXTREQUIRED=0 , DOCISPASSWORDPROTECTED=0 , PDFMAPPINGREF=0;
		</sql>
	</changeSet>
	
	<changeSet id="10" author="Amit">
	<sql>
		INSERT INTO SecRights SELECT (select (SeqNo+1) from
		SeqSecRights),3,'DocumentTypeDialog_mappingRef','DocumentTypeDialog',0,1000,current_timestamp,'Approved','
		',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;

		Update SeqSecRights set seqno = (select max(rightid)+1 from SecRights);

		INSERT INTO SecGroupRights SELECT (select (SeqNo+1) from
		SeqSecGroupRights ), (select GrpID from SecGroups where
		GrpCode ='DOCUMENTTYPE_MAKER'), (select RightID from SecRights WHERE
		RightName='DocumentTypeDialog_mappingRef'),1,0,10000,current_timestamp,'Approved','
		',' ',' ',' ',' ',0 FROM SeqSecGroupRights;

		Update SeqSecGroupRights set seqno = (select max(grprightid)+1 from
		SecGroupRights);
	</sql>
</changeSet>

	<changeSet id="11" author="Amit">
		<sql>
			INSERT INTO SecRights SELECT (select (SeqNo+1) from
			SeqSecRights),3,'DocumentTypeDialog_docIsPasswordProtected','DocumentTypeDialog',0,1000,current_timestamp,'Approved','
			',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;

			Update SeqSecRights set seqno = (select max(rightid)+1 from SecRights);

			INSERT INTO SecGroupRights SELECT (select (SeqNo+1) from
			SeqSecGroupRights ), (select GrpID from SecGroups where
			GrpCode ='DOCUMENTTYPE_MAKER'), (select RightID from SecRights WHERE
			RightName='DocumentTypeDialog_docIsPasswordProtected'),1,0,10000,current_timestamp,'Approved','
			',' ',' ',' ',' ',0 FROM SeqSecGroupRights;

			Update SeqSecGroupRights set seqno = (select max(grprightid)+1 from
			SecGroupRights);
		</sql>
	</changeSet>

	<changeSet id="12" author="Amit">
		<sql>
			INSERT INTO SecRights SELECT (select (SeqNo+1) from
			SeqSecRights),3,'DocumentTypeDialog_docIsPdfExtRequired','DocumentTypeDialog',0,1000,current_timestamp,'Approved','
			',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;

			Update SeqSecRights set seqno = (select max(rightid)+1 from SecRights);

			INSERT INTO SecGroupRights SELECT (select (SeqNo+1) from
			SeqSecGroupRights ), (select GrpID from SecGroups where
			GrpCode ='DOCUMENTTYPE_MAKER'), (select RightID from SecRights WHERE
			RightName='DocumentTypeDialog_docIsPdfExtRequired'),1,0,10000,current_timestamp,'Approved','
			',' ',' ',' ',' ',0 FROM SeqSecGroupRights;

			Update SeqSecGroupRights set seqno = (select max(grprightid)+1 from
			SecGroupRights)
		</sql>
	</changeSet>
	
	<changeSet id="13" author="Amit" >
		<createTable tableName="DocumentDataConfig">
			<column name="Type" type="VARCHAR2(50)"/>
			<column name="Year" type="VARCHAR2(50)"/>
			<column name="Label" type="VARCHAR2(50)"/>
			<column name="LabelText" type="VARCHAR2(250)"/>
			<column name="LabelValueType" type="VARCHAR2(50)" />
			<column name="DefaultValue" type="VARCHAR2(50)"/>
			<column name="FormulaExecutionType" type="VARCHAR2(50)"/>
			<column name="IndexOf" type="VARCHAR2(50)"/>
			<column name="ExternalRef" type="VARCHAR2(250)" />
			<column name="MappingValue" type="NUMBER(19,0)" />
			<column name="IsActive" type="NUMBER(1,0)"  defaultValue="1"/>
			<column name="Formula" type="VARCHAR2(500)" />
		</createTable>
   </changeSet>
	
<changeSet id="14" author="Amit">
		<sql>		
	Insert into DOCUMENTDATACONFIG (TYPE,YEAR,LABEL,LABELTEXT,LABELVALUETYPE,DEFAULTVALUE,FORMULAEXECUTIONTYPE,INDEXOF,EXTERNALREF,MAPPINGVALUE,ISACTIVE,FORMULA) values ('ITR-4','2015-16','13','Repairs to machinery','int','-1','horizontal','0','repairsToMachinery',1,1,null);
	Insert into DOCUMENTDATACONFIG (TYPE,YEAR,LABEL,LABELTEXT,LABELVALUETYPE,DEFAULTVALUE,FORMULAEXECUTIONTYPE,INDEXOF,EXTERNALREF,MAPPINGVALUE,ISACTIVE,FORMULA) values ('ITR-4','2015-16',' ',' ','Double','-1',' ','0','totalIndirectExpenses',1,1,'rents+powerNFuel+repairsToMachinery');
	Insert into DOCUMENTDATACONFIG (TYPE,YEAR,LABEL,LABELTEXT,LABELVALUETYPE,DEFAULTVALUE,FORMULAEXECUTIONTYPE,INDEXOF,EXTERNALREF,MAPPINGVALUE,ISACTIVE,FORMULA) values ('ITR-4','2015-16','10','Power and fuel','int','-1','horizontal','0','powerNFuel',1,1,null);
	Insert into DOCUMENTDATACONFIG (TYPE,YEAR,LABEL,LABELTEXT,LABELVALUETYPE,DEFAULTVALUE,FORMULAEXECUTIONTYPE,INDEXOF,EXTERNALREF,MAPPINGVALUE,ISACTIVE,FORMULA) values ('ITR-4','2015-16','11','Rents','int','-1','horizontal','0','rents',1,1,null);
		</sql>
	</changeSet>
	
	<changeSet id="15" author="Amit">
		<createTable tableName="DocumentDataMapping">
			<column name="MappingId" type="NUMBER(19,0)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="Type" type="VARCHAR2(50)" />
		</createTable>
	</changeSet>
	
	<changeSet id="16" author="Amit">
		<sql>		
	Insert into DOCUMENTDATAMAPPING (MAPPINGID,TYPE) values (1,'ITR4');
	Insert into DOCUMENTDATAMAPPING (MAPPINGID,TYPE) values (2,'ITR5');
	Insert into DOCUMENTDATAMAPPING (MAPPINGID,TYPE) values (3,'ST3');	
	</sql>
	</changeSet>

	<changeSet id="17" author="Amit">
		<createView viewName="CustomerDocuments_AView"
			replaceIfExists="true">
 SELECT t1.custid,
    t1.custdoctype,
    t2.doctypedesc  lovdesccustdoccategory,
    t1.custdoctitle,
    t1.custdocsysname,
    t1.custdocrcvdon,
    t1.custdocexpdate,
    t1.custdocissuedon,
    t1.custdocissuedcountry,
    t3.countrydesc  lovdesccustdocissuedcountry,
    t1.custdocisverified,
    t1.custdocverifiedby,
    t1.custdocisacrive,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.custdocname,
    t1.custdoccategory,
    t1.custdocimage,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.docexpdateismand,
    t2.docissuedatemand,
    t2.docidnummand,
    t2.docissuedauthoritymand,
    t2.docismandatory,
    t1.docrefid,
    t1.docpurpose,
    t1.docuri,
	t2.docispdfextrequired,
	t2.docispasswordprotected,
	t2.pdfmappingref
   FROM plf.customerdocuments t1
     JOIN bmtdocumenttypes t2 ON t1.custdoccategory = t2.doctypecode
     JOIN bmtcountries t3 ON t1.custdocissuedcountry = t3.countrycode
	 	</createView>
	</changeSet>
	
	 <changeSet id="18" author="Amit" >
	<createView viewName="CustomerDocuments_View" replaceIfExists="true">
 SELECT t1.custid,
    t1.custdoctype,
    t2.doctypedesc  lovdesccustdoccategory,
    t1.custdoctitle,
    t1.custdocsysname,
    t1.custdocrcvdon,
    t1.custdocexpdate,
    t1.custdocissuedon,
    t1.custdocissuedcountry,
    t3.countrydesc  lovdesccustdocissuedcountry,
    t1.custdocisverified,
    t1.custdocverifiedby,
    t1.custdocisacrive,
    t1.docpurpose,
    t1.docuri,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.custdocname,
    t1.custdoccategory,
    t1.custdocimage,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.docexpdateismand,
    t2.docissuedatemand,
    t2.docidnummand,
    t2.docissuedauthoritymand,
    t2.docismandatory,
    t1.docrefid,
	t2.docispdfextrequired,
	t2.docispasswordprotected,
	t2.pdfmappingref
   FROM plf.customerdocuments_temp t1
     JOIN bmtdocumenttypes t2 ON t1.custdoccategory = t2.doctypecode
     JOIN bmtcountries t3 ON t1.custdocissuedcountry = t3.countrycode
UNION ALL
 SELECT t1.custid,
    t1.custdoctype,
    t2.doctypedesc  lovdesccustdoccategory,
    t1.custdoctitle,
    t1.custdocsysname,
    t1.custdocrcvdon,
    t1.custdocexpdate,
    t1.custdocissuedon,
    t1.custdocissuedcountry,
    t3.countrydesc  lovdesccustdocissuedcountry,
    t1.custdocisverified,
    t1.custdocverifiedby,
    t1.custdocisacrive,
    t1.docpurpose,
    t1.docuri,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.custdocname,
    t1.custdoccategory,
    t1.custdocimage,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.docexpdateismand,
    t2.docissuedatemand,
    t2.docidnummand,
    t2.docissuedauthoritymand,
    t2.docismandatory,
    t1.docrefid,
	t2.docispdfextrequired,
	t2.docispasswordprotected,
	t2.pdfmappingref
   FROM customerdocuments t1
     JOIN bmtdocumenttypes t2 ON t1.custdoccategory = t2.doctypecode
     JOIN bmtcountries t3 ON t1.custdocissuedcountry = t3.countrycode
  WHERE NOT (EXISTS ( SELECT 1
           FROM customerdocuments_temp
          WHERE customerdocuments_temp.custid = t1.custid AND customerdocuments_temp.custdoccategory = t1.custdoccategory))
		  </createView>
</changeSet>

<changeSet id="19" author="Amit">
		<sql>
Insert into DOCUMENTDATACONFIG (TYPE,YEAR,LABEL,LABELTEXT,LABELVALUETYPE,DEFAULTVALUE,FORMULAEXECUTIONTYPE,INDEXOF,EXTERNALREF,MAPPINGVALUE,ISACTIVE,FORMULA) values ('ST-3','2016-2017',' ','Actual date of filing','String',null,'horizontal','0','Actual date of filing',3,1,null);
Insert into DOCUMENTDATACONFIG (TYPE,YEAR,LABEL,LABELTEXT,LABELVALUETYPE,DEFAULTVALUE,FORMULAEXECUTIONTYPE,INDEXOF,EXTERNALREF,MAPPINGVALUE,ISACTIVE,FORMULA) values ('ST-3','2016-2017',' ','No of days beyond due date','int','-1','horizontal','0','No of days beyond due date',3,1,null);
Insert into DOCUMENTDATACONFIG (TYPE,YEAR,LABEL,LABELTEXT,LABELVALUETYPE,DEFAULTVALUE,FORMULAEXECUTIONTYPE,INDEXOF,EXTERNALREF,MAPPINGVALUE,ISACTIVE,FORMULA) values ('ST-3','2016-2017',' ','Due date for filing of this return','String',null,'horizontal','0','Due date for filing of this return',3,1,null);
	</sql>
	</changeSet>
	 <changeSet id="20" author="Surekha">
     <createView viewName="rmtlovfielddetail_view" replaceIfExists="true">
		     
		     SELECT t1.fieldcodeid,t1.fieldcode,t2.fieldcodedesc AS lovdescfieldcodename,t1.fieldcodevalue,t1.valuedesc,t1.isactive,
		    t1.version,t1.lastmntby,t1.systemdefault,t1.lastmnton,t1.recordstatus,t1.rolecode,t1.nextrolecode,t1.taskid,t1.recordtype,
		    t1.workflowid,t1.nexttaskid
		   FROM rmtlovfielddetail_temp t1
		     JOIN bmtlovfieldcode t2 ON t1.fieldcode = t2.fieldcode
		UNION ALL
		 SELECT t1.fieldcodeid,t1.fieldcode,t2.fieldcodedesc AS lovdescfieldcodename,t1.fieldcodevalue,t1.valuedesc,t1.isactive,
		    t1.version,t1.lastmntby,t1.systemdefault,t1.lastmnton,t1.recordstatus,t1.rolecode,t1.nextrolecode,t1.taskid,t1.recordtype,
		    t1.workflowid,t1.nexttaskid
		   FROM rmtlovfielddetail t1
		     JOIN bmtlovfieldcode t2 ON t1.fieldcode = t2.fieldcode
		  WHERE NOT (EXISTS ( SELECT 1
		           FROM rmtlovfielddetail_temp
		          WHERE rmtlovfielddetail_temp.fieldcodeid = t1.fieldcodeid))
		          
   </createView>
     </changeSet>
     <changeSet id="21" author="Surekha">
     <createView viewName="rmtlovfielddetail_Aview" replaceIfExists="true">
		     
		     SELECT t1.fieldcodeid,t1.fieldcode,t2.fieldcodedesc AS lovdescfieldcodename,t1.fieldcodevalue,t1.valuedesc,t1.isactive,
		    t1.version,t1.lastmntby,t1.systemdefault,t1.lastmnton,t1.recordstatus,t1.rolecode,t1.nextrolecode,t1.taskid,t1.recordtype,
		    t1.workflowid,t1.nexttaskid
		   FROM rmtlovfielddetail t1
		     JOIN bmtlovfieldcode t2 ON t1.fieldcode = t2.fieldcode
		
   </createView>
     </changeSet>
     <changeSet id="22" author="Surekha">
     	<dropColumn tableName="RMTLovFieldDetail" columnName="CatOfcoApplicant"/>
     </changeSet>
      <changeSet id="23" author="Surekha">
     	<dropColumn tableName="RMTLovFieldDetail_Temp" columnName="CatOfcoApplicant"/>
     </changeSet>
      <changeSet id="24" author="Surekha">
     <sql>
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_AccountNumber','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_dealerName','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_dealerFax','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_dealerAddress1','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_dealerAddress2','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_dealerAddress3','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_dealerAddress4','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_dealerCountry','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_dealerProvince','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_PaymentMode','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_Emirates','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_Email','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_AccountingTreatment','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_CommisionPaidAt','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_CalculationRule','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_PoBox','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_SellerType','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_dealerCity','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_ZipCode','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_VASM_Active','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_AccountNumber','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_dealerName','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialo_SOPTg_dealerFax','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_dealerAddress1','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_dealerAddress2','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_dealerAddress3','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_dealerAddress4','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_dealerCountry','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_dealerProvince','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_PaymentMode','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_Emirates','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_Email','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_AccountingTreatment','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_CommisionPaidAt','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_CalculationRule','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_PoBox','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_SellerType','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_dealerCity','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_ZipCode','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'VehicleDealerDialog_SOPT_Active','VehicleDealerDialog',0,1000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
	</sql>
	</changeSet>	
	<changeSet id="25" author="Surekha">
	<sql>
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_AccountNumber'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_dealerName'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_dealerFax'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_dealerAddress1'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_dealerAddress2'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_dealerAddress3'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_dealerAddress4'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_dealerCountry'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_dealerProvince'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_PaymentMode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_Emirates'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_Email'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_AccountingTreatment'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_CommisionPaidAt'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_CalculationRule'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_PoBox'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_SellerType'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_dealerCity'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_ZipCode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_VASM_Active'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_AccountNumber'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_dealerName'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialo_SOPTg_dealerFax'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_dealerAddress1'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_dealerAddress2'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_dealerAddress3'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_dealerAddress4'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_dealerCountry'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_dealerProvince'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_PaymentMode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_Emirates'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_Email'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_AccountingTreatment'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_CommisionPaidAt'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_CalculationRule'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_PoBox'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_SellerType'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_dealerCity'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_ZipCode'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='DEALER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='VehicleDealerDialog_SOPT_Active'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
	</sql>
	</changeSet>

	<changeSet id="26" author="Prakash" dbms="postgresql">
		<createSequence sequenceName="seqmailtemplate"
			startValue="1" maxValue="9999999999" cycle="false" incrementBy="1" />
	</changeSet>

	<!-- <changeSet id="27" author="Durga Prasad D">
		<sql>
			insert into ErrorDetails values('90403','EN','E','Update loan service is not applicable for Approved loans.','test','Approved','','','','','',0,current_timestamp,1000,0);
			insert into ErrorDetails values('90404','EN','E','Update loan failed, Disbursement instructions already exists.','test','Approved','','','','','',0,current_timestamp,1000,0);
			insert into ErrorDetails values('90405','EN','E','Update loan failed, Mandate details already exists.','test','Approved','','','','','',0,current_timestamp,1000,0);
		</sql>
	</changeSet> -->
	<changeSet id="28" author="Surekha">
		<dropForeignKeyConstraint baseTableName="CUSTOMERS" constraintName="FK_CUSTS_RELATIONSHIPOFFICERS"/>
	</changeSet>
	<changeSet id="28" author="Durga Prasad D" dbms="postgresql">
		<createTable tableName="InterfaceLogDetails">
			<column name="InterfaceSeqId" type="bigint" >
				<constraints primaryKey="true" nullable="false"/>
			</column>
			<column name="ServiceName" type="nvarchar(100)">
				<constraints nullable="false"/>
			</column>
			<column name="Reference" type="nvarchar(20)">
				<constraints nullable="false"/>
			</column>
			<column name="EndPoint" type="nvarchar(200)"/>
			<column name="Request" type="nvarchar(65535)"/>
			<column name="Response" type="nvarchar(65535)" />
			<column name="ReqSentOn" type="datetime"/>
			<column name="RespReceivedOn" type="datetime"/>
			<column name="Status" type="nvarchar(200)"/>
			<column name="ErrorCode" type="nvarchar(10)"/>
			<column name="ErrorDesc" type="nvarchar(200)"/>
		</createTable>
	</changeSet>
	<changeSet id="28" author="Durga Prasad D" dbms="oracle">
		<createTable tableName="InterfaceLogDetails">
			<column name="InterfaceSeqId" type="bigint" >
				<constraints primaryKey="true" nullable="false"/>
			</column>
			<column name="ServiceName" type="nvarchar(100)">
				<constraints nullable="false"/>
			</column>
			<column name="Reference" type="nvarchar(20)">
				<constraints nullable="false"/>
			</column>
			<column name="EndPoint" type="nvarchar(200)"/>
			<column name="Request" type="nvarchar(1000)"/>
			<column name="Response" type="nvarchar(1000)" />
			<column name="ReqSentOn" type="datetime"/>
			<column name="RespReceivedOn" type="datetime"/>
			<column name="Status" type="nvarchar(200)"/>
			<column name="ErrorCode" type="nvarchar(10)"/>
			<column name="ErrorDesc" type="nvarchar(200)"/>
		</createTable>
	</changeSet>
	
	<changeSet id="29" author="Amit">
     <addColumn tableName="CustomerDocuments">
     	<column name="PdfPassWord" type="nvarchar(200)"/>
     </addColumn>
    </changeSet>
    
    <changeSet id="30" author="Amit">
     <addColumn tableName="CustomerDocuments_Temp">
     	<column name="PdfPassWord" type="nvarchar(200)"/>
     </addColumn>
    </changeSet>
	
	<changeSet id="31" author="Amit">
		<createView viewName="CustomerDocuments_AView"
			replaceIfExists="true">
			 SELECT t1.custid,
    t1.custdoctype,
    t2.doctypedesc AS lovdesccustdoccategory,
    t1.custdoctitle,
    t1.custdocsysname,
    t1.custdocrcvdon,
    t1.custdocexpdate,
    t1.custdocissuedon,
    t1.custdocissuedcountry,
    t3.countrydesc AS lovdesccustdocissuedcountry,
    t1.custdocisverified,
    t1.custdocverifiedby,
    t1.custdocisacrive,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.custdocname,
    t1.custdoccategory,
    t1.custdocimage,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.docexpdateismand,
    t2.docissuedatemand,
    t2.docidnummand,
    t2.docissuedauthoritymand,
    t2.docismandatory,
    t1.docrefid,
    t1.docpurpose,
    t1.docuri,
    t2.docispdfextrequired,
    t2.docispasswordprotected,
    t2.pdfmappingref,
    t1.pdfpassword
   FROM customerdocuments t1
     JOIN bmtdocumenttypes t2 ON t1.custdoccategory = t2.doctypecode
     JOIN bmtcountries t3 ON t1.custdocissuedcountry = t3.countrycode
			</createView>
			</changeSet>
	
	<changeSet id="32" author="Amit">
		<createView viewName="CustomerDocuments_View"
			replaceIfExists="true">
			 SELECT t1.custid,
    t1.custdoctype,
    t2.doctypedesc AS lovdesccustdoccategory,
    t1.custdoctitle,
    t1.custdocsysname,
    t1.custdocrcvdon,
    t1.custdocexpdate,
    t1.custdocissuedon,
    t1.custdocissuedcountry,
    t3.countrydesc AS lovdesccustdocissuedcountry,
    t1.custdocisverified,
    t1.custdocverifiedby,
    t1.custdocisacrive,
    t1.docpurpose,
    t1.docuri,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.custdocname,
    t1.custdoccategory,
    t1.custdocimage,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.docexpdateismand,
    t2.docissuedatemand,
    t2.docidnummand,
    t2.docissuedauthoritymand,
    t2.docismandatory,
    t1.docrefid,
    t2.docispdfextrequired,
    t2.docispasswordprotected,
    t2.pdfmappingref,
    t1.pdfpassword
   FROM customerdocuments_temp t1
     JOIN bmtdocumenttypes t2 ON t1.custdoccategory = t2.doctypecode
     JOIN bmtcountries t3 ON t1.custdocissuedcountry = t3.countrycode
UNION ALL
 SELECT t1.custid,
    t1.custdoctype,
    t2.doctypedesc AS lovdesccustdoccategory,
    t1.custdoctitle,
    t1.custdocsysname,
    t1.custdocrcvdon,
    t1.custdocexpdate,
    t1.custdocissuedon,
    t1.custdocissuedcountry,
    t3.countrydesc AS lovdesccustdocissuedcountry,
    t1.custdocisverified,
    t1.custdocverifiedby,
    t1.custdocisacrive,
    t1.docpurpose,
    t1.docuri,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.custdocname,
    t1.custdoccategory,
    t1.custdocimage,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.docexpdateismand,
    t2.docissuedatemand,
    t2.docidnummand,
    t2.docissuedauthoritymand,
    t2.docismandatory,
    t1.docrefid,
    t2.docispdfextrequired,
    t2.docispasswordprotected,
    t2.pdfmappingref,
    t1.pdfpassword
   FROM customerdocuments t1
     JOIN bmtdocumenttypes t2 ON t1.custdoccategory = t2.doctypecode
     JOIN bmtcountries t3 ON t1.custdocissuedcountry = t3.countrycode
  WHERE NOT (EXISTS ( SELECT 1
           FROM customerdocuments_temp
          WHERE customerdocuments_temp.custid = t1.custid AND customerdocuments_temp.custdoccategory = t1.custdoccategory))
			</createView>
			</changeSet>
	<changeSet id="33" author="Durga Prasad D" dbms="postgresql">
		<sql>
			drop table InterfaceLogDetails cascade;
		</sql>
		<createTable tableName="InterfaceLogDetails">
			<column name="SeqId" type="bigint" autoIncrement="true" startWith="1">
				<constraints primaryKey="true" nullable="false"/>
			</column>
			<column name="ServiceName" type="nvarchar(100)">
				<constraints nullable="false"/>
			</column>
			<column name="Reference" type="nvarchar(20)">
				<constraints nullable="false"/>
			</column>
			<column name="EndPoint" type="nvarchar(200)"/>
			<column name="Request" type="nvarchar(65535)"/>
			<column name="Response" type="nvarchar(65535)" />
			<column name="ReqSentOn" type="datetime"/>
			<column name="RespReceivedOn" type="datetime"/>
			<column name="Status" type="nvarchar(200)"/>
			<column name="ErrorCode" type="nvarchar(10)"/>
			<column name="ErrorDesc" type="nvarchar(200)"/>
		</createTable>
	</changeSet>
	<changeSet id="33" author="Durga Prasad D" dbms="oracle">
		<sql>
			drop table InterfaceLogDetails;
		</sql>
		<createTable tableName="InterfaceLogDetails">
			<column name="SeqId" type="bigint" autoIncrement="true" startWith="1">
				<constraints primaryKey="true" nullable="false"/>
			</column>
			<column name="ServiceName" type="nvarchar(100)">
				<constraints nullable="false"/>
			</column>
			<column name="Reference" type="nvarchar(20)">
				<constraints nullable="false"/>
			</column>
			<column name="EndPoint" type="nvarchar(200)"/>
			<column name="Request" type="nvarchar(1000)"/>
			<column name="Response" type="nvarchar(1000)" />
			<column name="ReqSentOn" type="datetime"/>
			<column name="RespReceivedOn" type="datetime"/>
			<column name="Status" type="nvarchar(200)"/>
			<column name="ErrorCode" type="nvarchar(10)"/>
			<column name="ErrorDesc" type="nvarchar(200)"/>
		</createTable>
	</changeSet>
<!-- <changeSet id="34" author="Amit">
	<sql>
		INSERT INTO SecRights SELECT (select (SeqNo+1) from
		SeqSecRights),3,'CustomerDocumentDialog_pdfPassword','CustomerDocumentDialog',0,1000,current_timestamp,'Approved','
		',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;

		Update SeqSecRights set seqno = (select max(rightid)+1 from SecRights);

		INSERT INTO SecGroupRights SELECT (select (SeqNo+1) from
		SeqSecGroupRights), (select GrpID from SecGroups where
		GrpCode ='DOCUMENTTYPE_MAKER'), (select RightID from SecRights WHERE
		RightName='CustomerDocumentDialog_pdfPassword'),1,0,10000,current_timestamp,'Approved','
		',' ',' ',' ',' ',0 FROM SeqSecGroupRights;

		Update SeqSecGroupRights set seqno = (select max(grprightid)+1 from
		SecGroupRights);
	</sql>
	</changeSet>
 -->	
 <changeSet id="35" author="Jayant" dbms="postgresql">
		<createSequence sequenceName="seqdisbursementrequests" cycle="false" startValue="1" incrementBy="1" minValue="1"/>
	</changeSet>
	<changeSet id="36" author="Jayant" dbms="postgresql">
		<sql>
			alter table disbursement_requests alter column id set default nextval('seqdisbursementrequests');
		</sql>
	</changeSet>
	<changeSet id="37" author="Jayant" dbms="postgresql">
		<modifyDataType tableName="interfacelogdetails" columnName="request" newDataType="citext"/>
	</changeSet>
	<changeSet id="38" author="Jayant" dbms="postgresql">
		<modifyDataType tableName="interfacelogdetails" columnName="response" newDataType="citext"/>
	</changeSet>
 <changeSet id="39" author="Amit">
		<sql>
			drop table DOCUMENTDATACONFIG;
		</sql>
	</changeSet>
		<changeSet id="40" author="Amit">
		<createTable tableName="DOCUMENTDATACONFIG">
			<column name="Year" type="nvarchar(50)"/>
			<column name="Label" type="nvarchar(50)"/>
			<column name="LabelText" type="nvarchar(250)"/>
			<column name="LabelValueType" type="nvarchar(50)"/>
			<column name="DefaultValue" type="nvarchar(50)" />
			<column name="FormulaExecutionType" type="nvarchar(50)"/>
			<column name="IndexOf" type="nvarchar(50)"/>
			<column name="ExternalRef" type="nvarchar(250)"/>
			<column name="MappingValue" type="NUMBER(19,0)"/>
			<column name="IsActive" type="NUMBER(1,0)" defaultValue="1"/>
			<column name="Formula" type="nvarchar(500)"/>
			<column name="DateFormat" type="nvarchar(100)"/>
		</createTable>
	</changeSet>
	
	<changeSet id="41" author="Amit">
	<sql>
Insert into DOCUMENTDATACONFIG 
values ('2015-16','3c','Total of current assets, loans and advances (av + biv)','int','-1','horizontal','0','BALCURASSET',1,1,null, null);

Insert into DOCUMENTDATACONFIG 
values ('2015-16','iE','Total (iA + iB + iC + iD)','int','-1','horizontal','0','BALCURLIAB',1,1,null, null);

Insert into DOCUMENTDATACONFIG 
values ('2015-16','iA','Sundry Creditors','int','-1','horizontal','0','SUNDRCREDY1',1,1,null, null);

Insert into DOCUMENTDATACONFIG 
values ('2015-16','diii','Total (iE + iiE )','int','-1','horizontal','0','PROVY1',1,1,null, null);

Insert into DOCUMENTDATACONFIG 
values ('2016-2017',' ','No of days beyond due date','int','-1','horizontal','0','NOOFDAYSBEYONDDUE',3,1,null,null);

Insert into DOCUMENTDATACONFIG 
values ('2016-2017',' ','Due date for filing of this return','Date',null,'horizontal','0','DUEDATEFORFILINRET',3,1,null,'dd/MM/yyyy');

Insert into DOCUMENTDATACONFIG 
values ('2016-2017',' ','Actual date of filing','Date',null,'horizontal','0','ACTUALDATEOFFILNG',3,1,null,'dd/MM/yyyy');
	</sql>
	</changeSet>
	
	<changeSet id="42" author="Amit">
		<sql>
			drop table DocumentDataMapping;
		</sql>
	</changeSet>
	<changeSet id="43" author="Amit">
		<createTable tableName="DocumentDataMapping">
			<column name="MappingId" type="NUMBER(19,0)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="Type" type="VARCHAR2(50)" >
			<constraints primaryKey="false" nullable="false" />
			</column>
			<column name="TypeDescription" type="VARCHAR2(200)" />
		</createTable>
	</changeSet>
	
	<changeSet id="44" author="Amit">
	<sql>
Insert into DOCUMENTDATAMAPPING values (1,'ITR4','ITR-4 Form Description');
Insert into DOCUMENTDATAMAPPING values (2,'ITR5','ITR-5 Form Description');
Insert into DOCUMENTDATAMAPPING values (3,'ST3','Form for Return of Service Tax');
	</sql>
 </changeSet>
 
 	 <changeSet id="45" author="Ganesh.p">
	<sql>
		Delete from ErrorDetails where ErrorCode = '90406';
		INSERT INTO ErrorDetails VALUES('90406','EN','E','{0} must be provided for {1}.','test','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
	</sql>
	</changeSet>
	
	<changeSet id="46" author="Ganesh.p">
	<sql>
		Delete from ErrorDetails where ErrorCode = '90407';
		INSERT INTO ErrorDetails VALUES('90407','EN','E','uploaded document {0} is not supported.','test','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
	</sql>
	</changeSet>
	
	 <changeSet id="47" author="Ganesh.p">
     <addColumn tableName="Customers">
     	<column name="CustsourceId" type="nvarchar(10)"/>
     </addColumn>
    </changeSet>
	
	<changeSet id="48" author="Ganesh.p">
     <addColumn tableName="Customers_Temp">
     	<column name="CustsourceId" type="nvarchar(10)"/>
     </addColumn>
    </changeSet>
	
	<changeSet id="49" author="Ganesh.p" dbms="postgresql">
		 <sql>
		 	drop view customers_aview cascade;
		 </sql>
	</changeSet>

	<changeSet id="50" author="Ganesh.p">
		<createView viewName="customers_aview" replaceIfExists="true">
 	SELECT t1.custid,
    t1.custcif,
    t1.custcorebank,
    t1.custctgcode,
    t1.custtypecode,
    t1.custsalutationcode,
    t1.custfname,
    t1.custmname,
    t1.custlname,
    t1.custshrtname,
    t1.custfnamelcllng,
    t1.custmnamelcllng,
    t1.custlnamelcllng,
    t1.custshrtnamelcllng,
    t1.custdftbranch,
    t1.custgendercode,
    t1.custdob,
    t1.custpob,
    t1.custcob,
    t1.custpassportno,
    t1.custmothermaiden,
    t1.custisminor,
    t1.custreferedby,
    t1.custdsa,
    t1.custdsadept,
    t1.custro1,
    t1.custro2,
    t1.custgroupid,
    t1.custsts,
    t1.custstschgdate,
    t1.custgroupsts,
    t1.custisblocked,
    t1.custisactive,
    t1.custisclosed,
    t1.custinactivereason,
    t1.custisdecease,
    t1.custisdormant,
    t1.custisdelinquent,
    t1.custistradefincust,
    t1.custtradelicencenum,
    t1.custtradelicenceexpiry,
    t1.custpassportexpiry,
    t1.custvisanum,
    t1.custvisaexpiry,
    t1.custisstaff,
    t1.custstaffid,
    t1.custindustry,
    t1.custsector,
    t1.custsubsector,
    t1.custprofession,
    t1.custtotalincome,
    t1.custmaritalsts,
    t1.custempsts,
    t1.custsegment,
    t1.custsubsegment,
    t1.custisblacklisted,
    t1.custblrsncode,
    t1.custisrejected,
    t1.custrejectedrsn,
    t1.custbaseccy,
    t1.custlng,
    t1.custparentcountry,
    t1.custresdcountry,
    t1.custriskcountry,
    t1.custnationality,
    t1.custclosedon,
    t1.custstmtfrq,
    t1.custisstmtcombined,
    t1.custstmtlastdate,
    t1.custstmtnextdate,
    t1.custstmtdispatchmode,
    t1.custfirstbusinessdate,
    t1.custaddlvar81,
    t1.custaddlvar82,
    t1.custaddlvar83,
    t1.custaddlvar84,
    t1.custaddlvar85,
    t1.custaddlvar86,
    t1.custaddlvar87,
    t1.custaddlvar88,
    t1.custaddlvar89,
    t1.custaddldate1,
    t1.custaddldate2,
    t1.custaddldate3,
    t1.custaddldate4,
    t1.custaddldate5,
    t1.custaddlvar1,
    t1.custaddlvar2,
    t1.custaddlvar3,
    t1.custaddlvar4,
    t1.custaddlvar5,
    t1.custaddlvar6,
    t1.custaddlvar7,
    t1.custaddlvar8,
    t1.custaddlvar9,
    t1.custaddlvar10,
    t1.custaddlvar11,
    t1.custaddldec1,
    t1.custaddldec2,
    t1.custaddldec3,
    t1.custaddldec4,
    t1.custaddldec5,
    t1.custaddlint1,
    t1.custaddlint2,
    t1.custaddlint3,
    t1.custaddlint4,
    t1.custaddlint5,
	t1.CustsourceId,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.custtypedesc AS lovdesccusttypecodename,
    t3.maritalstsdesc AS lovdesccustmaritalstsname,
    t4.empstsdesc AS lovdesccustempstsname,
    t6.custstsdescription AS lovdesccuststsname,
    t7.industrydesc AS lovdesccustindustryname,
    t8.sectordesc AS lovdesccustsectorname,
    t9.subsectordesc AS lovdesccustsubsectorname,
    t10.professiondesc AS lovdesccustprofessionname,
    t11.countrydesc AS lovdesccustcobname,
    t20.segmentdesc AS lovdesccustsegmentname,
    t12.nationalitydesc AS lovdesccustnationalityname,
    t13.genderdesc AS lovdesccustgendercodename,
    t14.deptdesc AS lovdesccustdsadeptname,
    t15.rofficerdesc AS lovdesccustro1name,
    t16.grpstsdescription AS lovdesccustgroupstsname,
    t17.branchdesc AS lovdesccustdftbranchname,
    t18.custctgdesc AS lovdesccustctgcodename,
    t2.custtypectg AS lovdesccustctgtype,
    t19.saluationdesc AS lovdesccustsalutationcodename,
    t21.countrydesc AS lovdesccustparentcountryname,
    t22.countrydesc AS lovdesccustresdcountryname,
    t23.countrydesc AS lovdesccustriskcountryname,
    t24.rofficerdesc AS lovdesccustro2name,
    t25.blrsndesc AS lovdesccustblrsncodename,
    t26.rejectdesc AS lovdesccustrejectedrsnname,
    t27.custgrpdesc AS lovdesccustgroupidname,
    t28.subsegmentdesc AS lovdesccustsubsegmentname,
    t29.lngdesc AS lovdesccustlngname,
    t30.dispatchmodedesc AS lovdescdispatchmodedescname,
    t1.dedupfound,
    t1.skipdedup,
    t1.custtotalexpense,
    t1.custblacklistdate,
    t1.noofdependents,
    t1.custcrcpr,
    t1.jointcust,
    t1.jointcustname,
    t1.jointcustdob,
    t27.custgrpcode AS lovdesccustgroupcode,
    t1.custrelation,
    t1.contactpersonname,
    t1.phonenumber,
    t1.emailid,
    t1.salariedcustomer,
    t31.targetdesc AS lovdesctargetname,
    t1.custsuspsts,
    t1.custsuspdate,
    t1.custsusptrigger,
    COALESCE(t32.roledesc, fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage
   FROM customers t1
     LEFT JOIN rmtcusttypes t2 ON t1.custtypecode = t2.custtypecode
     LEFT JOIN bmtmaritalstatuscodes t3 ON t1.custmaritalsts = t3.maritalstscode
     LEFT JOIN bmtempstscodes t4 ON t1.custempsts = t4.empstscode
     LEFT JOIN bmtcuststatuscodes t6 ON t1.custsts = t6.custstscode
     LEFT JOIN bmtindustries t7 ON t1.custindustry = t7.industrycode
     LEFT JOIN bmtsectors t8 ON t1.custsector = t8.sectorcode
     LEFT JOIN bmtsubsectors t9 ON t1.custsector = t9.sectorcode AND t1.custsubsector = t9.subsectorcode
     LEFT JOIN bmtprofessions t10 ON t1.custprofession = t10.professioncode
     LEFT JOIN bmtcountries t11 ON t1.custcob = t11.countrycode
     LEFT JOIN bmtnationalitycodes t12 ON t1.custnationality = t12.nationalitycode
     LEFT JOIN bmtgenders t13 ON t1.custgendercode = t13.gendercode
     LEFT JOIN bmtdepartments t14 ON t1.custdsadept = t14.deptcode
     LEFT JOIN relationshipofficers t15 ON t1.custro1 = t15.rofficercode
     LEFT JOIN bmtgrpstatuscodes t16 ON t1.custgroupsts = t16.grpstscode
     LEFT JOIN rmtbranches t17 ON t1.custdftbranch = t17.branchcode
     LEFT JOIN bmtcustcategories t18 ON t1.custctgcode = t18.custctgcode
     LEFT JOIN bmtsalutations t19 ON t1.custsalutationcode = t19.salutationcode
     LEFT JOIN bmtsegments t20 ON t1.custsegment = t20.segmentcode
     LEFT JOIN bmtcountries t21 ON t1.custparentcountry = t21.countrycode
     LEFT JOIN bmtcountries t22 ON t1.custresdcountry = t22.countrycode
     LEFT JOIN bmtcountries t23 ON t1.custriskcountry = t23.countrycode
     LEFT JOIN relationshipofficers t24 ON t1.custro2 = t24.rofficercode
     LEFT JOIN bmtblacklistrsncodes t25 ON t1.custblrsncode = t25.blrsncode
     LEFT JOIN bmtrejectcodes t26 ON t1.custrejectedrsn = t26.rejectcode
     LEFT JOIN customergroups t27 ON t1.custgroupid = t27.custgrpid
     LEFT JOIN bmtsubsegments t28 ON t1.custsubsegment = t28.subsegmentcode
     LEFT JOIN bmtlanguage t29 ON t1.custlng = t29.lngcode
     LEFT JOIN bmtdispatchmodes t30 ON t1.custstmtdispatchmode = t30.dispatchmodecode
     LEFT JOIN targetdetails t31 ON t1.custaddlvar82 = t31.targetcode
     LEFT JOIN secroles t32 ON t1.nextrolecode = t32.rolecd
	</createView>
	</changeSet>
	
	<changeSet id="51" author="Ganesh.p" dbms="postgresql">
		 <sql>
		 	drop view customers_view cascade;
		 </sql>
	</changeSet>
	
	<changeSet id="52" author="Ganesh.p">
		<createView viewName="customers_view" replaceIfExists="true">
			SELECT t1.custid,
    t1.custcif,
    t1.custcorebank,
    t1.custctgcode,
    t1.custtypecode,
    t1.custsalutationcode,
    t1.custfname,
    t1.custmname,
    t1.custlname,
    t1.custshrtname,
    t1.custfnamelcllng,
    t1.custmnamelcllng,
    t1.custlnamelcllng,
    t1.custshrtnamelcllng,
    t1.custdftbranch,
    t1.custgendercode,
    t1.custdob,
    t1.custpob,
    t1.custcob,
    t1.custpassportno,
    t1.custmothermaiden,
    t1.custisminor,
    t1.custreferedby,
    t1.custdsa,
    t1.custdsadept,
    t1.custro1,
    t1.custro2,
    t1.custgroupid,
    t1.custsts,
    t1.custstschgdate,
    t1.custgroupsts,
    t1.custisblocked,
    t1.custisactive,
    t1.custisclosed,
    t1.custinactivereason,
    t1.custisdecease,
    t1.custisdormant,
    t1.custisdelinquent,
    t1.custistradefincust,
    t1.custtradelicencenum,
    t1.custtradelicenceexpiry,
    t1.custpassportexpiry,
    t1.custvisanum,
    t1.custvisaexpiry,
    t1.custisstaff,
    t1.custstaffid,
    t1.custindustry,
    t1.custsector,
    t1.custsubsector,
    t1.custprofession,
    t1.custtotalincome,
    t1.custmaritalsts,
    t1.custempsts,
    t1.custsegment,
    t1.custsubsegment,
    t1.custisblacklisted,
    t1.custblrsncode,
    t1.custisrejected,
    t1.custrejectedrsn,
    t1.custbaseccy,
    t1.custlng,
    t1.custparentcountry,
    t1.custresdcountry,
    t1.custriskcountry,
    t1.custnationality,
    t1.custclosedon,
    t1.custstmtfrq,
    t1.custisstmtcombined,
    t1.custstmtlastdate,
    t1.custstmtnextdate,
    t1.custstmtdispatchmode,
    t1.custfirstbusinessdate,
    t1.custaddlvar81,
    t1.custaddlvar82,
    t1.custaddlvar83,
    t1.custaddlvar84,
    t1.custaddlvar85,
    t1.custaddlvar86,
    t1.custaddlvar87,
    t1.custaddlvar88,
    t1.custaddlvar89,
    t1.custaddldate1,
    t1.custaddldate2,
    t1.custaddldate3,
    t1.custaddldate4,
    t1.custaddldate5,
    t1.custaddlvar1,
    t1.custaddlvar2,
    t1.custaddlvar3,
    t1.custaddlvar4,
    t1.custaddlvar5,
    t1.custaddlvar6,
    t1.custaddlvar7,
    t1.custaddlvar8,
    t1.custaddlvar9,
    t1.custaddlvar10,
    t1.custaddlvar11,
    t1.custaddldec1,
    t1.custaddldec2,
    t1.custaddldec3,
    t1.custaddldec4,
    t1.custaddldec5,
    t1.custaddlint1,
    t1.custaddlint2,
    t1.custaddlint3,
    t1.custaddlint4,
    t1.custaddlint5,
	t1.CustsourceId,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.custtypedesc AS lovdesccusttypecodename,
    t3.maritalstsdesc AS lovdesccustmaritalstsname,
    t4.empstsdesc AS lovdesccustempstsname,
    t6.custstsdescription AS lovdesccuststsname,
    t7.industrydesc AS lovdesccustindustryname,
    t8.sectordesc AS lovdesccustsectorname,
    t9.subsectordesc AS lovdesccustsubsectorname,
    t10.professiondesc AS lovdesccustprofessionname,
    t11.countrydesc AS lovdesccustcobname,
    t20.segmentdesc AS lovdesccustsegmentname,
    t12.nationalitydesc AS lovdesccustnationalityname,
    t13.genderdesc AS lovdesccustgendercodename,
    t14.deptdesc AS lovdesccustdsadeptname,
    t15.rofficerdesc AS lovdesccustro1name,
    t16.grpstsdescription AS lovdesccustgroupstsname,
    t17.branchdesc AS lovdesccustdftbranchname,
    t18.custctgdesc AS lovdesccustctgcodename,
    t2.custtypectg AS lovdesccustctgtype,
    t19.saluationdesc AS lovdesccustsalutationcodename,
    t21.countrydesc AS lovdesccustparentcountryname,
    t22.countrydesc AS lovdesccustresdcountryname,
    t23.countrydesc AS lovdesccustriskcountryname,
    t24.rofficerdesc AS lovdesccustro2name,
    t25.blrsndesc AS lovdesccustblrsncodename,
    t26.rejectdesc AS lovdesccustrejectedrsnname,
    t27.custgrpdesc AS lovdesccustgroupidname,
    t28.subsegmentdesc AS lovdesccustsubsegmentname,
    t29.lngdesc AS lovdesccustlngname,
    t30.dispatchmodedesc AS lovdescdispatchmodedescname,
    t1.dedupfound,
    t1.skipdedup,
    t1.custtotalexpense,
    t1.custblacklistdate,
    t1.noofdependents,
    t1.custcrcpr,
    t1.jointcust,
    t1.jointcustname,
    t1.jointcustdob,
    t27.custgrpcode AS lovdesccustgroupcode,
    t1.custrelation,
    t1.contactpersonname,
    t1.phonenumber,
    t1.emailid,
    t1.salariedcustomer,
    t31.targetdesc AS lovdesctargetname,
    t1.custsuspsts,
    t1.custsuspdate,
    t1.custsusptrigger,
    COALESCE(t32.roledesc, fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage
   FROM customers_temp t1
     LEFT JOIN rmtcusttypes t2 ON t1.custtypecode = t2.custtypecode
     LEFT JOIN bmtmaritalstatuscodes t3 ON t1.custmaritalsts = t3.maritalstscode
     LEFT JOIN bmtempstscodes t4 ON t1.custempsts = t4.empstscode
     LEFT JOIN bmtcuststatuscodes t6 ON t1.custsts = t6.custstscode
     LEFT JOIN bmtindustries t7 ON t1.custindustry = t7.industrycode
     LEFT JOIN bmtsectors t8 ON t1.custsector = t8.sectorcode
     LEFT JOIN bmtsubsectors t9 ON t1.custsector = t9.sectorcode AND t1.custsubsector = t9.subsectorcode
     LEFT JOIN bmtprofessions t10 ON t1.custprofession = t10.professioncode
     LEFT JOIN bmtcountries t11 ON t1.custcob = t11.countrycode
     LEFT JOIN bmtnationalitycodes t12 ON t1.custnationality = t12.nationalitycode
     LEFT JOIN bmtgenders t13 ON t1.custgendercode = t13.gendercode
     LEFT JOIN bmtdepartments t14 ON t1.custdsadept = t14.deptcode
     LEFT JOIN relationshipofficers t15 ON t1.custro1 = t15.rofficercode
     LEFT JOIN bmtgrpstatuscodes t16 ON t1.custgroupsts = t16.grpstscode
     LEFT JOIN rmtbranches t17 ON t1.custdftbranch = t17.branchcode
     LEFT JOIN bmtcustcategories t18 ON t1.custctgcode = t18.custctgcode
     LEFT JOIN bmtsalutations t19 ON t1.custsalutationcode = t19.salutationcode
     LEFT JOIN bmtsegments t20 ON t1.custsegment = t20.segmentcode
     LEFT JOIN bmtcountries t21 ON t1.custparentcountry = t21.countrycode
     LEFT JOIN bmtcountries t22 ON t1.custresdcountry = t22.countrycode
     LEFT JOIN bmtcountries t23 ON t1.custriskcountry = t23.countrycode
     LEFT JOIN relationshipofficers t24 ON t1.custro2 = t24.rofficercode
     LEFT JOIN bmtblacklistrsncodes t25 ON t1.custblrsncode = t25.blrsncode
     LEFT JOIN bmtrejectcodes t26 ON t1.custrejectedrsn = t26.rejectcode
     LEFT JOIN customergroups t27 ON t1.custgroupid = t27.custgrpid
     LEFT JOIN bmtsubsegments t28 ON t1.custsubsegment = t28.subsegmentcode
     LEFT JOIN bmtlanguage t29 ON t1.custlng = t29.lngcode
     LEFT JOIN bmtdispatchmodes t30 ON t1.custstmtdispatchmode = t30.dispatchmodecode
     LEFT JOIN targetdetails t31 ON t1.custaddlvar82 = t31.targetcode
     LEFT JOIN secroles t32 ON t1.nextrolecode = t32.rolecd
UNION ALL
 SELECT t1.custid,
    t1.custcif,
    t1.custcorebank,
    t1.custctgcode,
    t1.custtypecode,
    t1.custsalutationcode,
    t1.custfname,
    t1.custmname,
    t1.custlname,
    t1.custshrtname,
    t1.custfnamelcllng,
    t1.custmnamelcllng,
    t1.custlnamelcllng,
    t1.custshrtnamelcllng,
    t1.custdftbranch,
    t1.custgendercode,
    t1.custdob,
    t1.custpob,
    t1.custcob,
    t1.custpassportno,
    t1.custmothermaiden,
    t1.custisminor,
    t1.custreferedby,
    t1.custdsa,
    t1.custdsadept,
    t1.custro1,
    t1.custro2,
    t1.custgroupid,
    t1.custsts,
    t1.custstschgdate,
    t1.custgroupsts,
    t1.custisblocked,
    t1.custisactive,
    t1.custisclosed,
    t1.custinactivereason,
    t1.custisdecease,
    t1.custisdormant,
    t1.custisdelinquent,
    t1.custistradefincust,
    t1.custtradelicencenum,
    t1.custtradelicenceexpiry,
    t1.custpassportexpiry,
    t1.custvisanum,
    t1.custvisaexpiry,
    t1.custisstaff,
    t1.custstaffid,
    t1.custindustry,
    t1.custsector,
    t1.custsubsector,
    t1.custprofession,
    t1.custtotalincome,
    t1.custmaritalsts,
    t1.custempsts,
    t1.custsegment,
    t1.custsubsegment,
    t1.custisblacklisted,
    t1.custblrsncode,
    t1.custisrejected,
    t1.custrejectedrsn,
    t1.custbaseccy,
    t1.custlng,
    t1.custparentcountry,
    t1.custresdcountry,
    t1.custriskcountry,
    t1.custnationality,
    t1.custclosedon,
    t1.custstmtfrq,
    t1.custisstmtcombined,
    t1.custstmtlastdate,
    t1.custstmtnextdate,
    t1.custstmtdispatchmode,
    t1.custfirstbusinessdate,
    t1.custaddlvar81,
    t1.custaddlvar82,
    t1.custaddlvar83,
    t1.custaddlvar84,
    t1.custaddlvar85,
    t1.custaddlvar86,
    t1.custaddlvar87,
    t1.custaddlvar88,
    t1.custaddlvar89,
    t1.custaddldate1,
    t1.custaddldate2,
    t1.custaddldate3,
    t1.custaddldate4,
    t1.custaddldate5,
    t1.custaddlvar1,
    t1.custaddlvar2,
    t1.custaddlvar3,
    t1.custaddlvar4,
    t1.custaddlvar5,
    t1.custaddlvar6,
    t1.custaddlvar7,
    t1.custaddlvar8,
    t1.custaddlvar9,
    t1.custaddlvar10,
    t1.custaddlvar11,
    t1.custaddldec1,
    t1.custaddldec2,
    t1.custaddldec3,
    t1.custaddldec4,
    t1.custaddldec5,
    t1.custaddlint1,
    t1.custaddlint2,
    t1.custaddlint3,
    t1.custaddlint4,
    t1.custaddlint5,
	t1.CustsourceId,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.custtypedesc AS lovdesccusttypecodename,
    t3.maritalstsdesc AS lovdesccustmaritalstsname,
    t4.empstsdesc AS lovdesccustempstsname,
    t6.custstsdescription AS lovdesccuststsname,
    t7.industrydesc AS lovdesccustindustryname,
    t8.sectordesc AS lovdesccustsectorname,
    t9.subsectordesc AS lovdesccustsubsectorname,
    t10.professiondesc AS lovdesccustprofessionname,
    t11.countrydesc AS lovdesccustcobname,
    t20.segmentdesc AS lovdesccustsegmentname,
    t12.nationalitydesc AS lovdesccustnationalityname,
    t13.genderdesc AS lovdesccustgendercodename,
    t14.deptdesc AS lovdesccustdsadeptname,
    t15.rofficerdesc AS lovdesccustro1name,
    t16.grpstsdescription AS lovdesccustgroupstsname,
    t17.branchdesc AS lovdesccustdftbranchname,
    t18.custctgdesc AS lovdesccustctgcodename,
    t2.custtypectg AS lovdesccustctgtype,
    t19.saluationdesc AS lovdesccustsalutationcodename,
    t21.countrydesc AS lovdesccustparentcountryname,
    t22.countrydesc AS lovdesccustresdcountryname,
    t23.countrydesc AS lovdesccustriskcountryname,
    t24.rofficerdesc AS lovdesccustro2name,
    t25.blrsndesc AS lovdesccustblrsncodename,
    t26.rejectdesc AS lovdesccustrejectedrsnname,
    t27.custgrpdesc AS lovdesccustgroupidname,
    t28.subsegmentdesc AS lovdesccustsubsegmentname,
    t29.lngdesc AS lovdesccustlngname,
    t30.dispatchmodedesc AS lovdescdispatchmodedescname,
    t1.dedupfound,
    t1.skipdedup,
    t1.custtotalexpense,
    t1.custblacklistdate,
    t1.noofdependents,
    t1.custcrcpr,
    t1.jointcust,
    t1.jointcustname,
    t1.jointcustdob,
    t27.custgrpcode AS lovdesccustgroupcode,
    t1.custrelation,
    t1.contactpersonname,
    t1.phonenumber,
    t1.emailid,
    t1.salariedcustomer,
    t31.targetdesc AS lovdesctargetname,
    t1.custsuspsts,
    t1.custsuspdate,
    t1.custsusptrigger,
    COALESCE(t32.roledesc,fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage
   FROM customers t1
     LEFT JOIN rmtcusttypes t2 ON t1.custtypecode = t2.custtypecode
     LEFT JOIN bmtmaritalstatuscodes t3 ON t1.custmaritalsts = t3.maritalstscode
     LEFT JOIN bmtempstscodes t4 ON t1.custempsts = t4.empstscode
     LEFT JOIN bmtcuststatuscodes t6 ON t1.custsts = t6.custstscode
     LEFT JOIN bmtindustries t7 ON t1.custindustry = t7.industrycode
     LEFT JOIN bmtsectors t8 ON t1.custsector = t8.sectorcode
     LEFT JOIN bmtsubsectors t9 ON t1.custsector = t9.sectorcode AND t1.custsubsector = t9.subsectorcode
     LEFT JOIN bmtprofessions t10 ON t1.custprofession = t10.professioncode
     LEFT JOIN bmtcountries t11 ON t1.custcob = t11.countrycode
     LEFT JOIN bmtnationalitycodes t12 ON t1.custnationality = t12.nationalitycode
     LEFT JOIN bmtgenders t13 ON t1.custgendercode = t13.gendercode
     LEFT JOIN bmtdepartments t14 ON t1.custdsadept = t14.deptcode
     LEFT JOIN relationshipofficers t15 ON t1.custro1 = t15.rofficercode
     LEFT JOIN bmtgrpstatuscodes t16 ON t1.custgroupsts = t16.grpstscode
     LEFT JOIN rmtbranches t17 ON t1.custdftbranch = t17.branchcode
     LEFT JOIN bmtcustcategories t18 ON t1.custctgcode = t18.custctgcode
     LEFT JOIN bmtsalutations t19 ON t1.custsalutationcode = t19.salutationcode
     LEFT JOIN bmtsegments t20 ON t1.custsegment = t20.segmentcode
     LEFT JOIN bmtcountries t21 ON t1.custparentcountry = t21.countrycode
     LEFT JOIN bmtcountries t22 ON t1.custresdcountry = t22.countrycode
     LEFT JOIN bmtcountries t23 ON t1.custriskcountry = t23.countrycode
     LEFT JOIN relationshipofficers t24 ON t1.custro2 = t24.rofficercode
     LEFT JOIN bmtblacklistrsncodes t25 ON t1.custblrsncode = t25.blrsncode
     LEFT JOIN bmtrejectcodes t26 ON t1.custrejectedrsn = t26.rejectcode
     LEFT JOIN customergroups t27 ON t1.custgroupid = t27.custgrpid
     LEFT JOIN bmtsubsegments t28 ON t1.custsubsegment = t28.subsegmentcode
     LEFT JOIN bmtlanguage t29 ON t1.custlng = t29.lngcode
     LEFT JOIN bmtdispatchmodes t30 ON t1.custstmtdispatchmode = t30.dispatchmodecode
     LEFT JOIN targetdetails t31 ON t1.custaddlvar82 = t31.targetcode
     LEFT JOIN secroles t32 ON t1.nextrolecode = t32.rolecd
  WHERE NOT (EXISTS ( SELECT 1 AS expr1
           FROM customers_temp
          WHERE customers_temp.custid = t1.custid))
		</createView>
	</changeSet>
	
	<changeSet id="53" author="Ganesh.p" dbms="postgresql">
		 <sql>
		 	drop view customers_tview cascade;
		 </sql>
	</changeSet>
	
	<changeSet id="54" author="Ganesh.p">
		<createView viewName="customers_tview" replaceIfExists="true">
	 SELECT t1.custid,
    t1.custcif,
    t1.custcorebank,
    t1.custctgcode,
    t1.custtypecode,
    t1.custsalutationcode,
    t1.custfname,
    t1.custmname,
    t1.custlname,
    t1.custshrtname,
    t1.custfnamelcllng,
    t1.custmnamelcllng,
    t1.custlnamelcllng,
    t1.custshrtnamelcllng,
    t1.custdftbranch,
    t1.custgendercode,
    t1.custdob,
    t1.custpob,
    t1.custcob,
    t1.custpassportno,
    t1.custmothermaiden,
    t1.custisminor,
    t1.custreferedby,
    t1.custdsa,
    t1.custdsadept,
    t1.custro1,
    t1.custro2,
    t1.custgroupid,
    t1.custsts,
    t1.custstschgdate,
    t1.custgroupsts,
    t1.custisblocked,
    t1.custisactive,
    t1.custisclosed,
    t1.custinactivereason,
    t1.custisdecease,
    t1.custisdormant,
    t1.custisdelinquent,
    t1.custistradefincust,
    t1.custtradelicencenum,
    t1.custtradelicenceexpiry,
    t1.custpassportexpiry,
    t1.custvisanum,
    t1.custvisaexpiry,
    t1.custisstaff,
    t1.custstaffid,
    t1.custindustry,
    t1.custsector,
    t1.custsubsector,
    t1.custprofession,
    t1.custtotalincome,
    t1.custmaritalsts,
    t1.custempsts,
    t1.custsegment,
    t1.custsubsegment,
    t1.custisblacklisted,
    t1.custblrsncode,
    t1.custisrejected,
    t1.custrejectedrsn,
    t1.custbaseccy,
    t1.custlng,
    t1.custparentcountry,
    t1.custresdcountry,
    t1.custriskcountry,
    t1.custnationality,
    t1.custclosedon,
    t1.custstmtfrq,
    t1.custisstmtcombined,
    t1.custstmtlastdate,
    t1.custstmtnextdate,
    t1.custstmtdispatchmode,
    t1.custfirstbusinessdate,
    t1.custaddlvar81,
    t1.custaddlvar82,
    t1.custaddlvar83,
    t1.custaddlvar84,
    t1.custaddlvar85,
    t1.custaddlvar86,
    t1.custaddlvar87,
    t1.custaddlvar88,
    t1.custaddlvar89,
    t1.custaddldate1,
    t1.custaddldate2,
    t1.custaddldate3,
    t1.custaddldate4,
    t1.custaddldate5,
    t1.custaddlvar1,
    t1.custaddlvar2,
    t1.custaddlvar3,
    t1.custaddlvar4,
    t1.custaddlvar5,
    t1.custaddlvar6,
    t1.custaddlvar7,
    t1.custaddlvar8,
    t1.custaddlvar9,
    t1.custaddlvar10,
    t1.custaddlvar11,
    t1.custaddldec1,
    t1.custaddldec2,
    t1.custaddldec3,
    t1.custaddldec4,
    t1.custaddldec5,
    t1.custaddlint1,
    t1.custaddlint2,
    t1.custaddlint3,
    t1.custaddlint4,
    t1.custaddlint5,
	t1.CustsourceId,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.custtypedesc AS lovdesccusttypecodename,
    t3.maritalstsdesc AS lovdesccustmaritalstsname,
    t4.empstsdesc AS lovdesccustempstsname,
    t6.custstsdescription AS lovdesccuststsname,
    t7.industrydesc AS lovdesccustindustryname,
    t8.sectordesc AS lovdesccustsectorname,
    t9.subsectordesc AS lovdesccustsubsectorname,
    t10.professiondesc AS lovdesccustprofessionname,
    t11.countrydesc AS lovdesccustcobname,
    t20.segmentdesc AS lovdesccustsegmentname,
    t12.nationalitydesc AS lovdesccustnationalityname,
    t13.genderdesc AS lovdesccustgendercodename,
    t14.deptdesc AS lovdesccustdsadeptname,
    t15.rofficerdesc AS lovdesccustro1name,
    t16.grpstsdescription AS lovdesccustgroupstsname,
    t17.branchdesc AS lovdesccustdftbranchname,
    t18.custctgdesc AS lovdesccustctgcodename,
    t2.custtypectg AS lovdesccustctgtype,
    t19.saluationdesc AS lovdesccustsalutationcodename,
    t21.countrydesc AS lovdesccustparentcountryname,
    t22.countrydesc AS lovdesccustresdcountryname,
    t23.countrydesc AS lovdesccustriskcountryname,
    t24.rofficerdesc AS lovdesccustro2name,
    t25.blrsndesc AS lovdesccustblrsncodename,
    t26.rejectdesc AS lovdesccustrejectedrsnname,
    t27.custgrpdesc AS lovdesccustgroupidname,
    t28.subsegmentdesc AS lovdesccustsubsegmentname,
    t29.lngdesc AS lovdesccustlngname,
    t30.dispatchmodedesc AS lovdescdispatchmodedescname,
    t1.dedupfound,
    t1.skipdedup,
    t1.custtotalexpense,
    t1.custblacklistdate,
    t1.noofdependents,
    t1.custcrcpr,
    t1.jointcust,
    t1.jointcustname,
    t1.jointcustdob,
    t27.custgrpcode AS lovdesccustgroupcode,
    t1.contactpersonname,
    t1.phonenumber,
    t1.emailid,
    t1.salariedcustomer,
    t31.targetdesc AS lovdesctargetname,
    t1.custrelation,
    t1.custsuspsts,
    t1.custsuspdate,
    t1.custsusptrigger,
    COALESCE(t32.roledesc, fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage
   FROM customers_temp t1
  		   LEFT JOIN rmtcusttypes t2 ON t1.custtypecode = t2.custtypecode
     LEFT JOIN bmtmaritalstatuscodes t3 ON t1.custmaritalsts = t3.maritalstscode
     LEFT JOIN bmtempstscodes t4 ON t1.custempsts = t4.empstscode
     LEFT JOIN bmtcuststatuscodes t6 ON t1.custsts = t6.custstscode
     LEFT JOIN bmtindustries t7 ON t1.custindustry = t7.industrycode
     LEFT JOIN bmtsectors t8 ON t1.custsector = t8.sectorcode
     LEFT JOIN bmtsubsectors t9 ON t1.custsector = t9.sectorcode AND t1.custsubsector = t9.subsectorcode
     LEFT JOIN bmtprofessions t10 ON t1.custprofession = t10.professioncode
     LEFT JOIN bmtcountries t11 ON t1.custcob = t11.countrycode
     LEFT JOIN bmtnationalitycodes t12 ON t1.custnationality = t12.nationalitycode
     LEFT JOIN bmtgenders t13 ON t1.custgendercode = t13.gendercode
     LEFT JOIN bmtdepartments t14 ON t1.custdsadept = t14.deptcode
     LEFT JOIN relationshipofficers t15 ON t1.custro1 = t15.rofficercode
     LEFT JOIN bmtgrpstatuscodes t16 ON t1.custgroupsts = t16.grpstscode
     LEFT JOIN rmtbranches t17 ON t1.custdftbranch = t17.branchcode
     LEFT JOIN bmtcustcategories t18 ON t1.custctgcode = t18.custctgcode
     LEFT JOIN bmtsalutations t19 ON t1.custsalutationcode = t19.salutationcode
     LEFT JOIN bmtsegments t20 ON t1.custsegment = t20.segmentcode
     JOIN bmtcountries t21 ON t1.custparentcountry = t21.countrycode
     LEFT JOIN bmtcountries t22 ON t1.custresdcountry = t22.countrycode
     LEFT JOIN bmtcountries t23 ON t1.custriskcountry = t23.countrycode
     LEFT JOIN relationshipofficers t24 ON t1.custro2 = t24.rofficercode
     LEFT JOIN bmtblacklistrsncodes t25 ON t1.custblrsncode = t25.blrsncode
     LEFT JOIN bmtrejectcodes t26 ON t1.custrejectedrsn = t26.rejectcode
     LEFT JOIN customergroups t27 ON t1.custgroupid = t27.custgrpid
     LEFT JOIN bmtsubsegments t28 ON t1.custsubsegment = t28.subsegmentcode
     LEFT JOIN bmtlanguage t29 ON t1.custlng = t29.lngcode
     LEFT JOIN bmtdispatchmodes t30 ON t1.custstmtdispatchmode = t30.dispatchmodecode
     LEFT JOIN targetdetails t31 ON t1.custaddlvar82 = t31.targetcode
     LEFT JOIN secroles t32 ON t1.nextrolecode = t32.rolecd
		</createView>
	</changeSet>
	
	<changeSet id="55" author="Durga Prasad D">
		<sql>
			insert into ErrorDetails values('90408','EN','E','Customer document with category: {0} is not allowed in update loan.','test','Approved','','','','','',0,current_timestamp,1000,0);
		</sql>
	</changeSet>
	<changeSet id="56" author="Jayant">
		<createTable tableName="ReasonTypes">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="Code" type="VARCHAR(8)">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Description" type="VARCHAR(50)"/>
			<column name="Version" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="LastMntBy" type="BIGINT"/>
			<column name="LastMntOn" type="DATETIME"/>
			<column name="RecordStatus" type="VARCHAR(50)"/>
			<column name="RoleCode" type="VARCHAR(100)"/>
			<column name="NextRoleCode" type="VARCHAR(200)"/>
			<column name="TaskId" type="VARCHAR(50)"/>
			<column name="NextTaskId" type="VARCHAR(200)"/>
			<column name="RecordType" type="VARCHAR(50)"/>
			<column name="WorkFlowId" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet id="57" author="Jayant">
		<createTable tableName="ReasonCategory">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="Code" type="VARCHAR(8)">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Description" type="VARCHAR(50)"/>
			<column name="Version" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="LastMntBy" type="BIGINT"/>
			<column name="LastMntOn" type="DATETIME"/>
			<column name="RecordStatus" type="VARCHAR(50)"/>
			<column name="RoleCode" type="VARCHAR(100)"/>
			<column name="NextRoleCode" type="VARCHAR(200)"/>
			<column name="TaskId" type="VARCHAR(50)"/>
			<column name="NextTaskId" type="VARCHAR(200)"/>
			<column name="RecordType" type="VARCHAR(50)"/>
			<column name="WorkFlowId" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet id="58" author="Jayant">
		<createTable tableName="Reasons">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="ReasonTypeId" type="BIGINT">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="ReasonCategoryId" type="BIGINT">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Code" type="VARCHAR(8)">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Description" type="VARCHAR(50)"/>
			<column name="Version" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="LastMntBy" type="BIGINT"/>
			<column name="LastMntOn" type="DATETIME"/>
			<column name="RecordStatus" type="VARCHAR(50)"/>
			<column name="RoleCode" type="VARCHAR(100)"/>
			<column name="NextRoleCode" type="VARCHAR(200)"/>
			<column name="TaskId" type="VARCHAR(50)"/>
			<column name="NextTaskId" type="VARCHAR(200)"/>
			<column name="RecordType" type="VARCHAR(50)"/>
			<column name="WorkFlowId" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet id="59" author="Jayant">
		<createTable tableName="ReasonTypes_Temp">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="Code" type="VARCHAR(8)">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Description" type="VARCHAR(50)"/>
			<column name="Version" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="LastMntBy" type="BIGINT"/>
			<column name="LastMntOn" type="DATETIME"/>
			<column name="RecordStatus" type="VARCHAR(50)"/>
			<column name="RoleCode" type="VARCHAR(100)"/>
			<column name="NextRoleCode" type="VARCHAR(200)"/>
			<column name="TaskId" type="VARCHAR(50)"/>
			<column name="NextTaskId" type="VARCHAR(200)"/>
			<column name="RecordType" type="VARCHAR(50)"/>
			<column name="WorkFlowId" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet id="60" author="Jayant">
		<createTable tableName="ReasonCategory_Temp">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="Code" type="VARCHAR(8)">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Description" type="VARCHAR(50)"/>
			<column name="Version" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="LastMntBy" type="BIGINT"/>
			<column name="LastMntOn" type="DATETIME"/>
			<column name="RecordStatus" type="VARCHAR(50)"/>
			<column name="RoleCode" type="VARCHAR(100)"/>
			<column name="NextRoleCode" type="VARCHAR(200)"/>
			<column name="TaskId" type="VARCHAR(50)"/>
			<column name="NextTaskId" type="VARCHAR(200)"/>
			<column name="RecordType" type="VARCHAR(50)"/>
			<column name="WorkFlowId" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet id="61" author="Jayant">
		<createTable tableName="Reasons_Temp">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="ReasonTypeId" type="BIGINT">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="ReasonCategoryId" type="BIGINT">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Code" type="VARCHAR(8)">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Description" type="VARCHAR(50)"/>
			<column name="Version" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="LastMntBy" type="BIGINT"/>
			<column name="LastMntOn" type="DATETIME"/>
			<column name="RecordStatus" type="VARCHAR(50)"/>
			<column name="RoleCode" type="VARCHAR(100)"/>
			<column name="NextRoleCode" type="VARCHAR(200)"/>
			<column name="TaskId" type="VARCHAR(50)"/>
			<column name="NextTaskId" type="VARCHAR(200)"/>
			<column name="RecordType" type="VARCHAR(50)"/>
			<column name="WorkFlowId" type="BIGINT"/>
		</createTable>
	</changeSet>

<changeSet id="62" author="Haritha">
	<sql>
		INSERT INTO SecGroups SELECT (select (SeqNo+1) from SeqSecGroups), 'REASONCATEGORY_VIEW', 'Allow to view ReasonCategory', 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
		INSERT INTO SecGroups SELECT (select (SeqNo+2) from SeqSecGroups), 'REASONCATEGORY_MAKER', 'WF Maker for ReasonCategory', 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
		INSERT INTO SecGroups SELECT (select (SeqNo+3) from SeqSecGroups), 'REASONCATEGORY_APPROVER', 'WF Approver for ReasonCategory', 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
		
		
		INSERT INTO SecRights SELECT (select (SeqNo+3) from SeqSecRights),0,'menuItem_ApplicationMaster_ReasonCategory','MENU',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+4) from SeqSecRights),0,'menuItem_ApplicationMaster_ReasonCategoryEnquiry','MENU',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+5) from SeqSecRights),2,'button_ReasonCategoryList_PrintList','ReasonCategoryList',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+6) from SeqSecRights),2,'button_ReasonCategoryList_NewReasonCategory','ReasonCategoryList',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+7) from SeqSecRights),2,'button_ReasonCategoryDialog_btnNew','ReasonCategoryDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+8) from SeqSecRights),2,'button_ReasonCategoryDialog_btnEdit','ReasonCategoryDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+9) from SeqSecRights),2,'button_ReasonCategoryDialog_btnDelete','ReasonCategoryDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+10) from SeqSecRights),2,'button_ReasonCategoryDialog_btnSave','ReasonCategoryDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+10+1) from SeqSecRights),3,'ReasonCategoryDialog_Id','ReasonCategoryDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+10+2) from SeqSecRights),3,'ReasonCategoryDialog_Code','ReasonCategoryDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+10+3) from SeqSecRights),3,'ReasonCategoryDialog_Description','ReasonCategoryDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		
		
		INSERT INTO SecGroupRights SELECT (select (SeqNo+1) from SeqSecGroupRights), (select (SeqNo+1) from SeqSecGroups), (select max(RightID) from SecRights WHERE RightName='menuCat_ApplicationMasterEnquiry'),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+2) from SeqSecGroupRights), (select (SeqNo+1) from SeqSecGroups), (select (SeqNo+4) from SeqSecRights),1,0,10000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+17) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+3) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+18) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+6) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+19) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+9) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+20) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+20+1) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+1) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+20+2) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+2) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+20+3) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+3) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+25+3) from SeqSecGroupRights), (select (SeqNo+3) from SeqSecGroups), (select (SeqNo+3) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+26+3) from SeqSecGroupRights), (select (SeqNo+3) from SeqSecGroups), (select (SeqNo+10) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		update SeqSecGroupRights set SeqNo = (SeqNo+26+3) ;
		
		
		INSERT INTO SecRoleGroups SELECT (select (SeqNo+1) from SeqSecRoleGroups), (select (SeqNo+2) from SeqSecGroups), (select roleid from SecRoles where RoleCd='MSTGRP1_MAKER'), 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRoleGroups WHERE 0=0;
		
		INSERT INTO SecRoleGroups SELECT (select (SeqNo+2) from SeqSecRoleGroups), (select (SeqNo+3) from SeqSecGroups), (select roleid from SecRoles where RoleCd='MSTGRP1_APPROVER'), 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRoleGroups WHERE 0=0;
		update SeqSecRoleGroups set SeqNo = (SeqNo+2) ;
		
		update SeqSecGroups set SeqNo = (SeqNo+3) ;
		
		update SeqSecRights set SeqNo = (SeqNo+10+3) ;
  </sql>
	
</changeSet>
<changeSet id="63" author="Haritha" >
	<createView viewName="ReasonCategory_AView" replaceIfExists="true">
SELECT		T1.Id, T1.Code, T1.Description		
			, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
FROM    	ReasonCategory  T1 
</createView>
</changeSet>
<changeSet id="64" author="Haritha">
	<createView viewName="ReasonCategory_View" replaceIfExists="true">

			SELECT		T1.Id, T1.Code, T1.Description		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	ReasonCategory_Temp  T1 
			UNION ALL
			
			SELECT		T1.Id, T1.Code, T1.Description		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	ReasonCategory  T1 
			WHERE     NOT EXISTS (SELECT 1 FROM ReasonCategory_TEMP WHERE Id = T1.Id)
</createView>
</changeSet>
	<changeSet id="65" author="Haritha">
		<createTable tableName="SeqReasonCategory">
			<column name="SeqNo" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="66" author="Haritha">
	<sql>
	
		INSERT INTO SecGroups SELECT (select (SeqNo+1) from SeqSecGroups), 'REASONTYPES_VIEW', 'Allow to view ReasonTypes', 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
		INSERT INTO SecGroups SELECT (select (SeqNo+2) from SeqSecGroups), 'REASONTYPES_MAKER', 'WF Maker for ReasonTypes', 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
		INSERT INTO SecGroups SELECT (select (SeqNo+3) from SeqSecGroups), 'REASONTYPES_APPROVER', 'WF Approver for ReasonTypes', 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
		
		INSERT INTO SecRights SELECT (select (SeqNo+3) from SeqSecRights),0,'menuItem_ApplicationMaster_ReasonTypes','MENU',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+4) from SeqSecRights),0,'menuItem_ApplicationMaster_ReasonTypesEnquiry','MENU',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+5) from SeqSecRights),2,'button_ReasonTypesList_PrintList','ReasonTypesList',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+6) from SeqSecRights),2,'button_ReasonTypesList_NewReasonTypes','ReasonTypesList',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+7) from SeqSecRights),2,'button_ReasonTypesDialog_btnNew','ReasonTypesDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+8) from SeqSecRights),2,'button_ReasonTypesDialog_btnEdit','ReasonTypesDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+9) from SeqSecRights),2,'button_ReasonTypesDialog_btnDelete','ReasonTypesDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+10) from SeqSecRights),2,'button_ReasonTypesDialog_btnSave','ReasonTypesDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+10+1) from SeqSecRights),3,'ReasonTypesDialog_Id','ReasonTypesDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+10+2) from SeqSecRights),3,'ReasonTypesDialog_Code','ReasonTypesDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		INSERT INTO SecRights SELECT (select (SeqNo+10+3) from SeqSecRights),3,'ReasonTypesDialog_Description','ReasonTypesDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
		
		INSERT INTO SecGroupRights SELECT (select (SeqNo+2) from SeqSecGroupRights), (select (SeqNo+1) from SeqSecGroups), (select (SeqNo+4) from SeqSecRights),1,0,10000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+17) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+3) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+18) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+6) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+19) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+9) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+20) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+20+1) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+1) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+20+2) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+2) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+20+3) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+3) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+25+3) from SeqSecGroupRights), (select (SeqNo+3) from SeqSecGroups), (select (SeqNo+3) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		INSERT INTO SecGroupRights SELECT (select (SeqNo+26+3) from SeqSecGroupRights), (select (SeqNo+3) from SeqSecGroups), (select (SeqNo+10) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
		
		update SeqSecGroupRights set SeqNo = (SeqNo+26+3) ;
		
		INSERT INTO SecRoleGroups SELECT (select (SeqNo+1) from SeqSecRoleGroups), (select (SeqNo+2) from SeqSecGroups), (select roleid from SecRoles where RoleCd='MSTGRP1_MAKER'), 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRoleGroups WHERE 0=0;
		INSERT INTO SecRoleGroups SELECT (select (SeqNo+2) from SeqSecRoleGroups), (select (SeqNo+3) from SeqSecGroups), (select roleid from SecRoles where RoleCd='MSTGRP1_APPROVER'), 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRoleGroups WHERE 0=0;
		
		update SeqSecRoleGroups set SeqNo = (SeqNo+2) ;
		update SeqSecGroups set SeqNo = (SeqNo+3) ;
		update SeqSecRights set SeqNo = (SeqNo+10+3) ;
	
	</sql>
	</changeSet>
	<changeSet id="67" author="Haritha">
	<createView viewName="ReasonTypes_AView" replaceIfExists="true">
		SELECT		T1.Id, T1.Code, T1.Description		
				, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
	FROM    	ReasonTypes  T1 
   </createView>
</changeSet>
	<changeSet id="68" author="Haritha">
		<createView viewName="ReasonTypes_View" replaceIfExists="true">
			    SELECT		T1.Id, T1.Code, T1.Description		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	ReasonTypes_Temp  T1 
			UNION ALL
			
			SELECT		T1.Id, T1.Code, T1.Description		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	ReasonTypes  T1 
			WHERE     NOT EXISTS (SELECT 1 FROM ReasonTypes_TEMP WHERE Id = T1.Id)
		</createView>
	
	</changeSet>
	<changeSet id="69" author="Haritha">
		<createTable tableName="SeqReasonTypes">
			<column name="SeqNo" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="70" author="Haritha">
		   <sql>
			INSERT INTO SecGroups SELECT (select (SeqNo+1) from SeqSecGroups), 'REASONCODE_VIEW', 'Allow to view ReasonCode', 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
			INSERT INTO SecGroups SELECT (select (SeqNo+2) from SeqSecGroups), 'REASONCODE_MAKER', 'WF Maker for ReasonCode', 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
			INSERT INTO SecGroups SELECT (select (SeqNo+3) from SeqSecGroups), 'REASONCODE_APPROVER', 'WF Approver for ReasonCode', 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
			
			
			INSERT INTO SecRights SELECT (select (SeqNo+3) from SeqSecRights),0,'menuItem_ApplicationMaster_ReasonCode','MENU',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+4) from SeqSecRights),0,'menuItem_ApplicationMaster_ReasonCodeEnquiry','MENU',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+5) from SeqSecRights),2,'button_ReasonCodeList_PrintList','ReasonCodeList',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+6) from SeqSecRights),2,'button_ReasonCodeList_NewReasonCode','ReasonCodeList',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+7) from SeqSecRights),2,'button_ReasonCodeDialog_btnNew','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+8) from SeqSecRights),2,'button_ReasonCodeDialog_btnEdit','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+9) from SeqSecRights),2,'button_ReasonCodeDialog_btnDelete','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10) from SeqSecRights),2,'button_ReasonCodeDialog_btnSave','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+1) from SeqSecRights),3,'ReasonCodeDialog_Id','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+2) from SeqSecRights),3,'ReasonCodeDialog_ReasonTypeID','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+3) from SeqSecRights),3,'ReasonCodeDialog_ReasonCategoryID','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+4) from SeqSecRights),3,'ReasonCodeDialog_Code','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+5) from SeqSecRights),3,'ReasonCodeDialog_Description','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+6) from SeqSecRights),3,'ReasonCodeDialog_Active','ReasonCodeDialog',0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			
			
			INSERT INTO SecGroupRights SELECT (select (SeqNo+1) from SeqSecGroupRights), (select (SeqNo+1) from SeqSecGroups), (select max(RightID) from SecRights WHERE RightName='menuCat_ApplicationMasterEnquiry'),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+2) from SeqSecGroupRights), (select (SeqNo+1) from SeqSecGroups), (select (SeqNo+4) from SeqSecRights),1,0,10000,current_timestamp,' ',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+17) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+3) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+18) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+6) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+19) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+9) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20+1) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+1) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20+2) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+2) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20+3) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+3) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20+4) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+4) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20+5) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+5) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20+6) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+6) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+25+6) from SeqSecGroupRights), (select (SeqNo+3) from SeqSecGroups), (select (SeqNo+3) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+26+6) from SeqSecGroupRights), (select (SeqNo+3) from SeqSecGroups), (select (SeqNo+10) from SeqSecRights),1,0,10000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			
			update SeqSecGroupRights set SeqNo = (SeqNo+26+6) ;
			
			INSERT INTO SecRoleGroups SELECT (select (SeqNo+1) from SeqSecRoleGroups), (select (SeqNo+2) from SeqSecGroups), (select roleid from SecRoles where RoleCd='MSTGRP1_MAKER'), 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRoleGroups WHERE 0=0;
			INSERT INTO SecRoleGroups SELECT (select (SeqNo+2) from SeqSecRoleGroups), (select (SeqNo+3) from SeqSecGroups), (select roleid from SecRoles where RoleCd='MSTGRP1_APPROVER'), 0,1000,current_timestamp,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRoleGroups WHERE 0=0;
			
			update SeqSecRoleGroups set SeqNo = (SeqNo+2) ;
			update SeqSecGroups set SeqNo = (SeqNo+3) ;
			update SeqSecRights set SeqNo = (SeqNo+10+6) ;
		 </sql>
	</changeSet>
	<changeSet id="71" author="Jayant">
		<dropTable tableName="Reasons"/>
		<createTable tableName="Reasons">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="ReasonTypeId" type="BIGINT">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="ReasonCategoryId" type="BIGINT">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Code" type="VARCHAR(8)">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Description" type="VARCHAR(50)"/>
			<column name="Active" type="BOOLEAN">
				<constraints nullable="false"/>
			</column>
			<column name="Version" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="LastMntBy" type="BIGINT"/>
			<column name="LastMntOn" type="DATETIME"/>
			<column name="RecordStatus" type="VARCHAR(50)"/>
			<column name="RoleCode" type="VARCHAR(100)"/>
			<column name="NextRoleCode" type="VARCHAR(200)"/>
			<column name="TaskId" type="VARCHAR(50)"/>
			<column name="NextTaskId" type="VARCHAR(200)"/>
			<column name="RecordType" type="VARCHAR(50)"/>
			<column name="WorkFlowId" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet id="72" author="Jayant">
		<dropTable tableName="Reasons_Temp"/>
		<createTable tableName="Reasons_Temp">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="ReasonTypeId" type="BIGINT">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="ReasonCategoryId" type="BIGINT">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Code" type="VARCHAR(8)">
				<constraints nullable="false" unique="true"/>
			</column>
			<column name="Description" type="VARCHAR(50)"/>
			<column name="Active" type="BOOLEAN">
				<constraints nullable="false"/>
			</column>
			<column name="Version" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="LastMntBy" type="BIGINT"/>
			<column name="LastMntOn" type="DATETIME"/>
			<column name="RecordStatus" type="VARCHAR(50)"/>
			<column name="RoleCode" type="VARCHAR(100)"/>
			<column name="NextRoleCode" type="VARCHAR(200)"/>
			<column name="TaskId" type="VARCHAR(50)"/>
			<column name="NextTaskId" type="VARCHAR(200)"/>
			<column name="RecordType" type="VARCHAR(50)"/>
			<column name="WorkFlowId" type="BIGINT"/>
		</createTable>
	</changeSet>
	<changeSet id="73" author="Haritha">
		<createView viewName="Reasons_AView" replaceIfExists="true">
			SELECT		T1.Id, T1.ReasonTypeID, T1.ReasonCategoryID, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons  T1 

         </createView>
	</changeSet>
	<changeSet id="74" author="Haritha">
		<createView viewName="Reasons_View" replaceIfExists="true">
	        			SELECT		T1.Id, T1.ReasonTypeID, T1.ReasonCategoryID, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons_Temp  T1 
			UNION ALL
			
			SELECT		T1.Id, T1.ReasonTypeID, T1.ReasonCategoryID, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons  T1 
			WHERE     NOT EXISTS (SELECT 1 FROM Reasons_TEMP WHERE Id = T1.Id)
	        			
	     </createView>
	</changeSet>

	<changeSet id="75" author="Haritha">
		<createTable tableName="SeqReasons">
			<column name="SeqNo" type="bigint" />
		</createTable>

	</changeSet>
	<changeSet id="76" author="Jayant">
		<createView viewName="LIMITHEADER_VIEW" replaceIfExists="true">
			 SELECT     T1.HeaderId, T1.RuleCode, T1.RuleValue,T8.QueryDesc , T1.CustomerGroup,T3.CustGrpCode  , T3.CustGrpDesc GroupName, T3.CustGrpRO1, T1.CustomerId, T4.CustCIF,
T4.CustShrtName, 
                      T4.CustFName CustFName, T4.CustMName CustMName,T4.CustLName CustFullName, T4.CustCoreBank, T4.CustSalutationCode, T4.CustDftBranch, 
                      T4.lovDescCustDftBranchName CustDftBranchName, T1.ResponsibleBranch, T5.BranchDesc ResponsibleBranchName, T1.LimitCcy,
T1.LimitExpiryDate, 
                      T1.LimitRvwDate, T1.LimitStructureCode, T6.StructureName,T6.ShowLimitsIn, T1.LimitSetupRemarks,T1.Rebuild,T1.Active, T1.Version, T1.CreatedBy, T1.CreatedOn, T1.LastMntBy, T1.
LastMntOn, T2.UsrLogin, 
                      T2.UsrFName, T2.UsrMName, T2.UsrLName, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.
WorkflowId
FROM          LimitHeader_Temp T1 INNER JOIN
                       LimitStructure T6 ON T1.LimitStructureCode = T6.StructureCode LEFT OUTER JOIN
                       RMTBranches T5 ON T1.ResponsibleBranch = T5.BranchCode LEFT OUTER JOIN
                       CustomerGroups T3 ON T1.CustomerGroup = T3.CustGrpID LEFT OUTER JOIN
                       Customers_AView T4 ON T1.CustomerId = T4.CustID  LEFT OUTER JOIN
                       SecUsers T2 ON T1.LastMntBy = T2.UsrID LEFT OUTER JOIN
					   LimitParams T8 ON T1.RuleCode = T8.QueryCode 

UNION ALL 
SELECT     T1.HeaderId, T1.RuleCode, T1.RuleValue, T8.QueryDesc ,T1.CustomerGroup, T3.CustGrpCode  , T3.CustGrpDesc GroupName, T3.CustGrpRO1, T1.CustomerId,T4.CustCIF, 
T4.CustShrtName, 
                      T4.CustFName CustFName,T4.CustMName CustMName,T4.CustLName CustFullName, T4.CustCoreBank, T4.CustSalutationCode, T4.CustDftBranch, 
                      T4.lovDescCustDftBranchName CustDftBranchName, T1.ResponsibleBranch, T5.BranchDesc ResponsibleBranchName,  T1.LimitCcy,T1.LimitExpiryDate, 
                      T1.LimitRvwDate, T1.LimitStructureCode, T6.StructureName, T6.ShowLimitsIn,T1.LimitSetupRemarks,T1.Rebuild,T1.Active,T1.Version, T1.CreatedBy, T1.CreatedOn, T1.LastMntBy, T1.
LastMntOn, T2.UsrLogin, 
                      T2.UsrFName, T2.UsrMName, T2.UsrLName, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.
WorkflowId
FROM          LimitHeader T1 INNER JOIN
                       LimitStructure T6 ON T1.LimitStructureCode = T6.StructureCode LEFT OUTER JOIN
                       RMTBranches T5 ON T1.ResponsibleBranch = T5.BranchCode LEFT OUTER JOIN
                       CustomerGroups T3 ON T1.CustomerGroup = T3.CustGrpID LEFT OUTER JOIN
                       Customers_AView T4 ON T1.CustomerId = T4.CustID LEFT OUTER JOIN
                       SecUsers T2 ON T1.LastMntBy = T2.UsrID LEFT OUTER JOIN
					   LimitParams T8 ON T1.RuleCode = T8.QueryCode

WHERE     NOT EXISTS
                          (SELECT     1
                            FROM          LimitHeader_Temp
                            WHERE      HeaderId = T1.HeaderId)
		</createView>
	</changeSet>
	<changeSet id="77" author="Jayant">
		<createView viewName="LIMITHEADER_AVIEW" replaceIfExists="true">
			 SELECT     T1.HeaderId, T1.RuleCode, T1.RuleValue, T8.QueryDesc ,T1.CustomerGroup,T3.CustGrpCode  , T3.CustGrpDesc GroupName, T3.CustGrpRO1, 
			 T1.CustomerId,T4.CustCIF, T4.CustShrtName, 
                      T4.CustFName CustFName,T4.CustMName CustMName, T4.CustLName CustFullName, T4.CustCoreBank, T4.CustSalutationCode, T4.CustDftBranch, 
                      T4.lovDescCustDftBranchName CustDftBranchName, T1.ResponsibleBranch, T5.BranchDesc ResponsibleBranchName, T1.LimitCcy,T1.LimitExpiryDate, 
                      T1.LimitRvwDate, T1.LimitStructureCode, T6.StructureName,T6.ShowLimitsIn, T1.LimitSetupRemarks, T1.Rebuild,T1.Active, T1.Version, 
					  T1.CreatedBy, T1.CreatedOn, T1.LastMntBy, T1.LastMntOn, T2.UsrLogin,T2.UsrFName, T2.UsrMName, T2.UsrLName, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
					  FROM          LimitHeader T1 INNER JOIN
                       LimitStructure T6 ON T1.LimitStructureCode = T6.StructureCode LEFT OUTER JOIN
                       RMTBranches T5 ON T1.ResponsibleBranch = T5.BranchCode LEFT OUTER JOIN
                       CustomerGroups T3 ON T1.CustomerGroup = T3.CustGrpID LEFT OUTER JOIN
                       Customers_AView T4 ON T1.CustomerId = T4.CustID LEFT OUTER JOIN
                       SecUsers T2 ON T1.LastMntBy = T2.UsrID LEFT OUTER JOIN
					   LimitParams T8 ON T1.RuleCode = T8.QueryCode
		</createView>
	</changeSet>
	<changeSet id="78" author="Jayant">
		<createView viewName="LIMITHEADER_TVIEW" replaceIfExists="true">
			SELECT     T1.HeaderId, T1.RuleCode, T1.RuleValue, T8.QueryDesc ,T1.CustomerGroup,T3.CustGrpCode  , T3.CustGrpDesc GroupName, T3.CustGrpRO1, T1.CustomerId,T4.CustCIF, 
			T4.CustShrtName, T4.CustFName CustFName, T4.CustMName CustMName,T4.CustLName CustFullName, T4.CustCoreBank, T4.CustSalutationCode, T4.CustDftBranch, 
            T4.lovDescCustDftBranchName CustDftBranchName, T1.ResponsibleBranch, T5.BranchDesc ResponsibleBranchName, T1.LimitCcy,T1.LimitExpiryDate, 
            T1.LimitRvwDate, T1.LimitStructureCode, T6.StructureName, T6.ShowLimitsIn,T1.LimitSetupRemarks,T1.Rebuild,T1.Active,  T1.Version, T1.CreatedBy, T1.CreatedOn, T1.LastMntBy, 
            T1.LastMntOn, T2.UsrLogin,T2.UsrFName, T2.UsrMName, T2.UsrLName, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM          LimitHeader_Temp T1 INNER JOIN
             LimitStructure T6 ON T1.LimitStructureCode = T6.StructureCode LEFT OUTER JOIN
             RMTBranches T5 ON T1.ResponsibleBranch = T5.BranchCode LEFT OUTER JOIN
             CustomerGroups T3 ON T1.CustomerGroup = T3.CustGrpID LEFT OUTER JOIN
             Customers_AView T4 ON T1.CustomerId = T4.CustID LEFT OUTER JOIN
             SecUsers T2 ON T1.LastMntBy = T2.UsrID LEFT OUTER JOIN
			 LimitParams T8 ON T1.RuleCode = T8.QueryCode
		</createView>
	</changeSet>  
	<changeSet id="79" author="Jayant">
		<renameColumn tableName="Reasons" oldColumnName="reasonTypeID" newColumnName="reasonTypeCode"/>
	</changeSet>
	<changeSet id="80" author="Jayant">
		<renameColumn tableName="Reasons" oldColumnName="reasonCategoryID" newColumnName="reasonCategoryCode"/>
	</changeSet>
	<changeSet id="81" author="Jayant">
		<renameColumn tableName="Reasons_Temp" oldColumnName="reasonTypeID" newColumnName="reasonTypeCode"/>
	</changeSet>
	<changeSet id="82" author="Jayant"> 
		<renameColumn tableName="Reasons_Temp" oldColumnName="reasonCategoryID" newColumnName="reasonCategoryCode"/>
	</changeSet>
	<changeSet id="83" author="Jayant" dbms="postgresql">
		<sql>
			drop view reasons_view cascade;
			drop view reasons_aview cascade;
		</sql>
	</changeSet>
	<changeSet id="84" author="Jayant">
		<modifyDataType tableName="Reasons" columnName="reasonCategoryCode" newDataType="VARCHAR(20)"/>
	</changeSet>
	<changeSet id="85" author="Jayant">
		<modifyDataType tableName="Reasons_Temp" columnName="reasonCategoryCode" newDataType="VARCHAR(20)"/>
	</changeSet>
	<changeSet id="86" author="Jayant">
		<modifyDataType tableName="Reasons" columnName="reasonTypeCode" newDataType="VARCHAR(20)"/>
	</changeSet>
	<changeSet id="87" author="Jayant">
		<modifyDataType tableName="Reasons_Temp" columnName="reasonTypeCode" newDataType="VARCHAR(20)"/>
	</changeSet>
	<changeSet id="88" author="Haritha" dbms="postgresql">
		<createView viewName="Reasons_AView" replaceIfExists="true">
			SELECT		T1.Id, T1.ReasonTypeCode, T1.ReasonCategoryCode, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons AS T1 

         </createView>
	</changeSet>
	<changeSet id="88" author="Haritha" dbms="oracle">
		<createView viewName="Reasons_AView" replaceIfExists="true">
			SELECT		T1.Id, T1.ReasonTypeCode, T1.ReasonCategoryCode, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons  T1 

         </createView>
	</changeSet>
	<changeSet id="89" author="Haritha">
		<createView viewName="Reasons_View" replaceIfExists="true">
	        			SELECT		T1.Id, T1.ReasonTypeCode, T1.ReasonCategoryCode, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons_Temp  T1 
			UNION ALL
			
			SELECT		T1.Id, T1.ReasonTypeCode, T1.ReasonCategoryCode, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons  T1 
			WHERE     NOT EXISTS (SELECT 1 FROM Reasons_TEMP WHERE Id = T1.Id)
	        			
	     </createView>
	</changeSet>
	<changeSet id="90.1" author="Jayant" dbms="postgresql">
		<dropUniqueConstraint tableName="reasons" uniqueColumns="code" constraintName="reasons_code_key"/>
	</changeSet>
	<changeSet id="90.2" author="Jayant" dbms="postgresql">
		<dropUniqueConstraint tableName="reasons" uniqueColumns="reasoncategorycode" constraintName="reasons_reasoncategoryid_key"/>
	</changeSet>
	<changeSet id="90.3" author="Jayant" dbms="postgresql">
		<dropUniqueConstraint tableName="reasons" uniqueColumns="reasontypecode" constraintName="reasons_reasontypeid_key"/>
	</changeSet>
	<changeSet id="91.1" author="Jayant" dbms="postgresql">
		<dropUniqueConstraint tableName="reasons_temp" uniqueColumns="code" constraintName="reasons_temp_code_key"/>
	</changeSet>
	<changeSet id="91.2" author="Jayant" dbms="postgresql">
		<sql>
			alter table reasons_temp drop constraint reasons_temp_reasoncategoryid_key;
		</sql>
	</changeSet>
	<changeSet id="91.3" author="Jayant" dbms="postgresql">
		<dropUniqueConstraint tableName="reasons_temp" uniqueColumns="reasontypecode" constraintName="reasons_temp_reasontypeid_key"/>
	</changeSet>
	<changeSet id="90.1" author="Jayant" dbms="oracle">
		<dropUniqueConstraint tableName="reasons" uniqueColumns="code" constraintName="SYS_C00353452"/>
	</changeSet>
	<changeSet id="90.2" author="Jayant" dbms="oracle">
		<dropUniqueConstraint tableName="reasons" uniqueColumns="reasoncategorycode" constraintName="SYS_C00353451"/>
	</changeSet>
	<changeSet id="90.3" author="Jayant" dbms="oracle">
		<dropUniqueConstraint tableName="reasons" uniqueColumns="reasontypecode" constraintName="SYS_C00353450"/>
	</changeSet>
	<changeSet id="91.1" author="Jayant" dbms="oracle">
		<dropUniqueConstraint tableName="reasons_temp" uniqueColumns="code" constraintName="SYS_C00353462"/>
	</changeSet>
	<changeSet id="91.2" author="Jayant" dbms="oracle">
		<dropUniqueConstraint tableName="reasons_temp" uniqueColumns="reasoncategorycode" constraintName="SYS_C00353461"/>
	</changeSet>
	<changeSet id="91.3" author="Jayant" dbms="oracle">
		<dropUniqueConstraint tableName="reasons_temp" uniqueColumns="reasontypecode" constraintName="SYS_C00353460"/>
	</changeSet>
	<changeSet id="92" author="Jayant">
		<addUniqueConstraint tableName="reasons" columnNames="code,reasoncategorycode,reasontypecode" constraintName="UK_RSN_CODECTGTYPE"/>
		<addUniqueConstraint tableName="reasons_temp" columnNames="code,reasoncategorycode,reasontypecode" constraintName="UK_RSN_T_CODECTGTYPE"/>
	</changeSet>
	<changeSet id="93" author="Jayant">
		<sql>
			delete from ErrorDetails where ErrorCode = '90403';
			insert into ErrorDetails values('90409','EN','E','No loans are available or It may Approved with this reference.','test','Approved','','','','','',0,current_timestamp,1000,0);
		</sql>
	</changeSet>
	<changeSet id="93" author="Durgaprasad.g">
		<createTable tableName="ReasonHeader">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true" primaryKeyName="PK_RH_ID"/>
			</column>
			<column name="Module" type="VARCHAR(50)">
				<constraints nullable="false"/>
			</column>
			<column name="Reference" type="VARCHAR(50)">
				<constraints nullable="false"/>
			</column>
			<column name="Remarks" type="VARCHAR(1000)"/>
			<column name="Activity" type="VARCHAR(100)">
				<constraints nullable="false"/>
			</column>
			<column name="ToUser" type="BIGINT"/>
			<column name="LogTime" type="DATETIME"/>
		</createTable>
	</changeSet>
	
	<changeSet id="94" author="Durgaprasad.g">
		<createTable tableName="ReasonDetails">
			<column name="HeaderId" type="BIGINT" >
				<constraints nullable="false" />
			</column>
			<column name="ReasonId" type="BIGINT" >
				<constraints nullable="false"/>
			</column>
		</createTable>
	</changeSet>
	
	<changeSet id="95" author="Durgaprasad.g">
	  <addForeignKeyConstraint constraintName="FK_RH_ID" referencedTableName="ReasonHeader" baseColumnNames="HeaderId" baseTableName="ReasonDetails" referencedColumnNames="Id"/>
	</changeSet>
	
	<changeSet id="96" author="Durgaprasad.g">
		<createTable tableName="SeqReasonHeader">
			<column name="SeqNo" type="BIGINT" >
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="97" author="Durgaprasad.g">
	<sql>
		Insert into SeqReasonHeader Values (0);
	</sql>
	</changeSet>
	
	<changeSet id="98" author="Jayant" dbms="postgresql">
		<sql>
			drop view reasons_view cascade;
			drop view reasons_aview cascade;
		</sql>
	</changeSet>
	<changeSet id="99" author="Jayant">
		<renameColumn tableName="Reasons" oldColumnName="reasonTypeCode" newColumnName="reasonTypeID"/>
	</changeSet>
	<changeSet id="100" author="Jayant">
		<renameColumn tableName="Reasons" oldColumnName="reasonCategoryCode" newColumnName="reasonCategoryID"/>
	</changeSet>
	<changeSet id="101" author="Jayant">
		<renameColumn tableName="Reasons_Temp" oldColumnName="reasonTypeCode" newColumnName="reasonTypeID"/>
	</changeSet>
	<changeSet id="102" author="Jayant"> 
		<renameColumn tableName="Reasons_Temp" oldColumnName="reasonCategoryCode" newColumnName="reasonCategoryID"/>
	</changeSet>
	
	<changeSet id="103" author="Jayant">
		<modifyDataType tableName="Reasons" columnName="reasonTypeID" newDataType="BIGINT"/>
	</changeSet>
	<changeSet id="104" author="Jayant">
		<modifyDataType tableName="Reasons_Temp" columnName="reasonTypeID" newDataType="BIGINT"/>
	</changeSet>
	<changeSet id="105" author="Jayant">
		<modifyDataType tableName="Reasons" columnName="reasonCategoryID" newDataType="BIGINT"/>
	</changeSet>
	<changeSet id="106" author="Jayant">
		<modifyDataType tableName="Reasons_Temp" columnName="reasonCategoryID" newDataType="BIGINT"/>
	</changeSet>
	<changeSet id="107" author="Haritha">
		<createView viewName="Reasons_AView" replaceIfExists="true">
			SELECT		T1.Id, T1.ReasonTypeID, T1.ReasonCategoryID, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons T1 

         </createView>
	</changeSet>

	<changeSet id="108" author="Haritha">
		<createView viewName="Reasons_View" replaceIfExists="true">
	        			SELECT		T1.Id, T1.ReasonTypeID, T1.ReasonCategoryID, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons_Temp  T1 
			UNION ALL
			
			SELECT		T1.Id, T1.ReasonTypeID, T1.ReasonCategoryID, T1.Code, T1.Description, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	Reasons  T1 
			WHERE     NOT EXISTS (SELECT 1 FROM Reasons_TEMP WHERE Id = T1.Id)
	        			
	     </createView>
	</changeSet>
	
	<changeSet id="109" author="dURGAPRASAD.G">
		<dropTable tableName="ReasonDetails" />
		<dropTable tableName="ReasonHeader" />
	</changeSet>
	
	<changeSet id="110" author="Durgaprasad.g">
		<createTable tableName="ReasonHeader">
			<column name="Id" type="BIGINT" >
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="Module" type="VARCHAR(50)">
				<constraints nullable="false"/>
			</column>
			<column name="Reference" type="VARCHAR(50)">
				<constraints nullable="false"/>
			</column>
			<column name="Remarks" type="VARCHAR(1000)"/>
			<column name="Rolecode" type="VARCHAR(200)"/>
			<column name="Activity" type="VARCHAR(100)">
				<constraints nullable="false"/>
			</column>
			<column name="ToUser" type="BIGINT"/>
			<column name="LogTime" type="DATETIME"/>
		</createTable>
	</changeSet>
	
	<changeSet id="111" author="Durgaprasad.g">
		<createTable tableName="ReasonDetails">
			<column name="HeaderId" type="BIGINT" >
				<constraints nullable="false" />
			</column>
			<column name="ReasonId" type="BIGINT" >
				<constraints nullable="false"/>
			</column>
			 
		</createTable>
	</changeSet>

		<changeSet id="112" author="Durgaprasad.g">
	  <addForeignKeyConstraint constraintName="FK_RH_ID" referencedTableName="ReasonHeader" baseColumnNames="HeaderId" baseTableName="ReasonDetails" referencedColumnNames="Id"/>
	</changeSet>
 </databaseChangeLog>