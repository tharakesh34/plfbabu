<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />
	
	<changeSet id="07" author="DurgaprasadG">
	<sql>
		<![CDATA[
			Insert into VASPRODUCTCATEGORY 
			(PRODUCTCTG,PRODUCTCTGDESC,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID,ACTIVE) values 
			('INSURANC','Insurance',1,1000,CURRENT_TIMESTAMP,'Approved',null,null,null,null,null,0,1);
			
			Insert into AMTVEHICLEDEALER  values ((Select Max(Dealerid)+1 from AmtVehicledealer),'BAJAJ FINANCE LTD.',5,1000,CURRENT_TIMESTAMP,'Approved',null,null,null,null,null,0,'2039574151','2039574151','Regional Office, DNBS, fourth floor.','opp. Mumbai Central Station.','VASM','Byculla, Mumbai â€“ 400 008',null,'IN','MH','BHA','wecare@bajajfinserv.in','411014',null,null,null,null,null,0,'#','400008',1,'5','BLPPG2117B',null,'VASI','GL1');
			
			Delete from VASPRODUCTTYPE Where PRODUCTTYPE = 'INSURANC';
			Insert into VASPRODUCTTYPE 
			(PRODUCTTYPE,PRODUCTTYPEDESC,PRODUCTCTG,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID,ACTIVE) values 
			('INSURANC','Insurance','INSURANC',1,1000,CURRENT_TIMESTAMP,'Approved',null,null,null,null,null,0,1);
			
			Insert into VASSTRUCTURE 
			(PRODUCTCODE,PRODUCTDESC,RECAGAINST,FEEACCRUED,FEEACCOUNTING,ACCRUALACCOUNTING,RECURRINGTYPE,FREELOCKPERIOD,PREVALIDATIONREQ,POSTVALIDATIONREQ,REMARKS,ACTIVE,VERSION,LASTMNTBY,LASTMNTON,RECORDSTATUS,ROLECODE,NEXTROLECODE,TASKID,NEXTTASKID,RECORDTYPE,WORKFLOWID,PRODUCTTYPE,VASFEE,ALLOWFEETOMODIFY,MANUFACTURERID,PREVALIDATION,POSTVALIDATION,FEETYPE,FLPCALCULATEDON,SHORTCODE)
			 values ('VASINS','VAS Insurence','Finance',1,25,21,1,0,1,1,'VAS Insurence configuration.',1,37,1000,CURRENT_TIMESTAMP,'Approved',null,null,null,null,null,0,'INSURANC',50000,1,(Select DEALERID from AmtVehicledealer Where DEALERNAME= 'BAJAJ FINANCE LTD.'),' 
			//Applicant values
			var customer = fd.getCustomerDetails().getCustomer();
			
			var applicantVal = "";
			applicantVal = applicantVal.concat(customer.getCustCIF()).concat("|").concat(customer.getCustShrtName()).concat("|").concat(customer.getLovDescCustGenderCodeName()).concat("|").concat(customer.getCustDOB()).concat("|").concat(customer.getCustomerAge());
			defaults.add("HIDDEN_APP_VALUES",applicantVal );
			 
			//Co Applicant List values
			var coAppCifValues = "";
			var coApplicantValues = "";
			var jountAcctDetList = fd.getJountAccountDetailList();
			 
			for (var i = 0; i < jountAcctDetList.length ; i++) {
			    if(coAppCifValues.length > 0){
			      coApplicantValues = coApplicantValues.concat("^^");
			      coAppCifValues = coAppCifValues.concat(",");
			     }
			    var model = jountAcctDetList.get(i);
			    var customerDetail = model.getCustomerDetails();
			    var customer = customerDetail.getCustomer();
			  coApplicantValues = coApplicantValues.concat(customer.getCustCIF()).concat("|").concat(customer.getCustShrtName()).concat("|").concat(customer.getLovDescCustGenderCodeName()).concat("|").concat(customer.getCustDOB()).concat("|").concat(customer.getCustomerAge());
			    coAppCifValues = coAppCifValues.concat(customer.getCustCIF());
			}
			 
			defaults.add("CUSTCOAPPCIF",coAppCifValues);
			defaults.add("HIDDEN_CO_APP_VAL",coApplicantValues);
			
			defaults.add("AGEN1","0");
			defaults.add("AGEN2","0");
			
			','
			//If the applicant type is CO-Applicant and CUSTCOAPPCIF is not selcted the add the error
			if (APPLICANTTYPE=== ''CO-APPLICANT'' ) {
			      
			    if (CUSTCOAPPCIF=== ''#'') {
			       errors.add("CUSTCOAPPCIF",''Please select Co Applicants from the list.'');
			      }
			}
			
			//Nominee details1
			if (AGEN1< 18 ) {
			      
			    if (APOINTEENAMEN1=== '''') {
			       errors.add("APOINTEENAMEN1",''Apointee Name1 is mandatory.'');
			     }
			     if (APONTEE1RELATION=== '''') {
			       errors.add("APONTEE1RELATION",''Relation is mandatory.'');
			     }
			     if (APPOINTEEN1DOB=== null) {
			       errors.add("APPOINTEEN1DOB",''DOB is mandatory.'');
			     }
			     if (APONTEEN1AGE=== '''') {
			       errors.add("APONTEEN1AGE",''AGE is mandatory.'');
			     }
			     if (APOINTEEN1ADDRESS=== '''') {
			       errors.add("APOINTEEN1ADDRESS",''Address is mandatory.'');
			     }
			    if (APOINTEE1MOBILENUM=== '''') {
			       errors.add("APOINTEE1MOBILENUM",''Mobile Number is mandatory.'');
			     }
			}
			
			
			//Nominee details2
			if ((DOBN2 !== null) && (AGEN2< 18) ) {
			      
			    if (APOINTEENAMEN2=== '''') {
			       errors.add("APOINTEENAMEN2",''Apointee Name2 is mandatory.'');
			     }
			     if (APONTEE2RELATION=== '''') {
			       errors.add("APONTEE2RELATION",''Relation is mandatory.'');
			     }
			     if (APPOINTEEN2DOB=== null) {
			       errors.add("APPOINTEEN2DOB",''DOB is mandatory.'');
			     }
			     if (APONTEEN2AGE=== '''') {
			       errors.add("APONTEEN2AGE",''AGE is mandatory.'');
			     }
			     if (APOINTEEN2ADDRESS=== '''') {
			       errors.add("APOINTEEN2ADDRESS",''Address is mandatory.'');
			     }
			     if (APOINTEE2MOBILENUM=== '''') {
			       errors.add("APOINTEE2MOBILENUM",''Mobile Number is mandatory.'');
			     }
			}
			
			',2,'I','VS5');
			Update SeqAmtVehicledealer set SeqNo = (Select Max(Dealerid)+1 from AmtVehicledealer);
			]]>
 </sql>
</changeSet>
</databaseChangeLog>
