<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />

	<changeSet id="1" author="lakshmi.n" dbms="postgresql">
		<addColumn tableName="amtvehicledealer_temp">
			<column name="productctg" type="citext" />
		</addColumn>
		<addColumn tableName="amtvehicledealer">
			<column name="productctg" type="citext" />
		</addColumn>

		<addForeignKeyConstraint constraintName="fk_vpc_temp_productctg"
			referencedTableName="vasproductcategory" baseColumnNames="productctg"
			baseTableName="amtvehicledealer_temp" referencedColumnNames="productctg" />

		<addForeignKeyConstraint constraintName="fk_vpc_productctg"
			referencedTableName="vasproductcategory" baseColumnNames="productctg"
			baseTableName="amtvehicledealer" referencedColumnNames="productctg" />
	</changeSet>

	<changeSet id="2" author="lakshmi.n">
		<createView viewName="amtvehicledealer_aview"
			replaceIfExists="true">
		SELECT t1.dealerid,
	    t1.dealertype,
	    t1.dealername,
	    t1.dealertelephone,
	    t1.dealerfax,
	    t1.dealeraddress1,
	    t1.dealeraddress2,
	    t1.dealeraddress3,
	    t1.dealeraddress4,
	    t1.dealercountry,
	    t5.countrydesc AS lovdesccountry,
	    t1.dealerprovince,
	    t4.cpprovincename AS lovdescprovince,
	    t1.dealercity,
	    t3.pccityname AS lovdesccity,
	    t1.email,
	    t1.pobox,
	    t1.zipcode,
	    t1.pannumber,
	    t1.taxnumber,
	    t1.productctg,
	    t10.productctgdesc,
	    t1.active,
	    t1.emirates,
	    t1.commisionpaidat,
	    t1.calculationrule,
	    t7.rulecodedesc AS calruledesc,
	    t1.paymentmode,
	    t1.accountnumber,
	    t1.accountingsetid,
	    t8.accountsetcode AS accountingsetcode,
	    t8.accountsetcodename AS accountingsetdesc,
	    t9.cpprovincename AS emiratesdescription,
	    t1.sellertype,
	    t1.version,
	    t1.lastmntby,
	    t1.lastmnton,
	    t1.recordstatus,
	    t1.rolecode,
	    t1.nextrolecode,
	    t1.taskid,
	    t1.nexttaskid,
	    t1.recordtype,
	    t1.workflowid
	    FROM amtvehicledealer t1
	    LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity AND t1.dealercity = t3.pccity
	    LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
	    LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
	    LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
	    LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
	    LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
	    LEFT JOIN vasproductcategory t10 ON t1.productctg = t10.productctg 
		</createView>
	</changeSet>

	<changeSet id="3" author="lakshmi.n">
		<createView viewName="amtvehicledealer_view"
			replaceIfExists="true">
		SELECT t1.dealerid,
	    t1.dealertype,
	    t1.dealername,
	    t1.dealertelephone,
	    t1.dealerfax,
	    t1.dealeraddress1,
	    t1.dealeraddress2,
	    t1.dealeraddress3,
	    t1.dealeraddress4,
	    t1.dealercountry,
	    t5.countrydesc AS lovdesccountry,
	    t1.dealerprovince,
	    t4.cpprovincename AS lovdescprovince,
	    t1.dealercity,
	    t3.pccityname AS lovdesccity,
	    t1.email,
	    t1.pobox,
	    t1.zipcode,
	    t1.pannumber,
	    t1.taxnumber,
	    t1.productctg,
	    t10.productctgdesc,
	    t1.active,
	    t1.emirates,
	    t1.commisionpaidat,
	    t1.calculationrule,
	    t7.rulecodedesc AS calruledesc,
	    t1.paymentmode,
	    t1.accountnumber,
	    t1.accountingsetid,
	    t8.accountsetcode AS accountingsetcode,
	    t8.accountsetcodename AS accountingsetdesc,
	    t9.cpprovincename AS emiratesdescription,
	    t1.sellertype,
	    t1.version,
	    t1.lastmntby,
	    t1.lastmnton,
	    t1.recordstatus,
	    t1.rolecode,
	    t1.nextrolecode,
	    t1.taskid,
	    t1.nexttaskid,
	    t1.recordtype,
	    t1.workflowid
	    FROM amtvehicledealer_temp t1
	    LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity
	    LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
	    LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
	    LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
	    LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
	    LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
	    LEFT JOIN vasproductcategory t10 ON t1.productctg = t10.productctg
		 UNION ALL
	    SELECT t1.dealerid,
	    t1.dealertype,
	    t1.dealername,
	    t1.dealertelephone,
	    t1.dealerfax,
	    t1.dealeraddress1,
	    t1.dealeraddress2,
	    t1.dealeraddress3,
	    t1.dealeraddress4,
	    t1.dealercountry,
	    t5.countrydesc AS lovdesccountry,
	    t1.dealerprovince,
	    t4.cpprovincename AS lovdescprovince,
	    t1.dealercity,
	    t3.pccityname AS lovdesccity,
	    t1.email,
	    t1.pobox,
	    t1.zipcode,
	    t1.pannumber,
	    t1.taxnumber,
	    t1.productctg,
	    t10.productctgdesc,
	    t1.active,
	    t1.emirates,
	    t1.commisionpaidat,
	    t1.calculationrule,
	    t7.rulecodedesc AS calruledesc,
	    t1.paymentmode,
	    t1.accountnumber,
	    t1.accountingsetid,
	    t8.accountsetcode AS accountingsetcode,
	    t8.accountsetcodename AS accountingsetdesc,
	    t9.cpprovincename AS emiratesdescription,
	    t1.sellertype,
	    t1.version,
	    t1.lastmntby,
	    t1.lastmnton,
	    t1.recordstatus,
	    t1.rolecode,
	    t1.nextrolecode,
	    t1.taskid,
	    t1.nexttaskid,
	    t1.recordtype,
	    t1.workflowid
	    FROM amtvehicledealer t1
	    LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity AND t1.dealercity = t3.pccity
	    LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
	    LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
	    LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
	    LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
	    LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
	    LEFT JOIN vasproductcategory t10 ON t1.productctg = t10.productctg
	    WHERE NOT (EXISTS ( SELECT 1
	           FROM amtvehicledealer_temp
	          WHERE amtvehicledealer_temp.dealerid = t1.dealerid))
		</createView>
	</changeSet>
	<changeSet id="4" author="lakshmi.n">
		<sql>
	<![CDATA[
	Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VehicleDealerDialog_PanNumber', 'VehicleDealerDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);

	Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VehicleDealerDialog_TaxNumber', 'VehicleDealerDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);

	Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VehicleDealerDialog_ProductCtg', 'VehicleDealerDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);

	Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='DEALER_MAKER'),(select RightId from secRights where RightName='VehicleDealerDialog_PanNumber'),1,0,1000,current_timestamp, 'Approved','','','','','',0);

	Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='DEALER_MAKER'),(select RightId from secRights where RightName='VehicleDealerDialog_TaxNumber'),1,0,1000,current_timestamp, 'Approved','','','','','',0);

	Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='DEALER_MAKER'),(select RightId from secRights where RightName='VehicleDealerDialog_ProductCtg'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
	]]>
		</sql>
	</changeSet>
	<changeSet id="5" author="lakshmi.n">
		<createView viewName="amtvehicledealer_aview"
			replaceIfExists="true">
		SELECT t1.dealerid,
	    t1.dealertype,
	    t1.dealername,
	    t1.dealertelephone,
	    t1.dealerfax,
	    t1.dealeraddress1,
	    t1.dealeraddress2,
	    t1.dealeraddress3,
	    t1.dealeraddress4,
	    t1.dealercountry,
	    t5.countrydesc AS lovdesccountry,
	    t1.dealerprovince,
	    t4.cpprovincename AS lovdescprovince,
	    t4.taxstatecode,
	    t1.dealercity,
	    t3.pccityname AS lovdesccity,
	    t1.email,
	    t1.pobox,
	    t1.zipcode,
	    t1.pannumber,
	    t1.taxnumber,
	    t1.productctg,
	    t10.productctgdesc,
	    t1.active,
	    t1.emirates,
	    t1.commisionpaidat,
	    t1.calculationrule,
	    t7.rulecodedesc AS calruledesc,
	    t1.paymentmode,
	    t1.accountnumber,
	    t1.accountingsetid,
	    t8.accountsetcode AS accountingsetcode,
	    t8.accountsetcodename AS accountingsetdesc,
	    t9.cpprovincename AS emiratesdescription,
	    t1.sellertype,
	    t1.version,
	    t1.lastmntby,
	    t1.lastmnton,
	    t1.recordstatus,
	    t1.rolecode,
	    t1.nextrolecode,
	    t1.taskid,
	    t1.nexttaskid,
	    t1.recordtype,
	    t1.workflowid
	    FROM amtvehicledealer t1
	    LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity AND t1.dealercity = t3.pccity
	    LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
	    LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
	    LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
	    LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
	    LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
	    LEFT JOIN vasproductcategory t10 ON t1.productctg = t10.productctg 
		</createView>
	</changeSet>

	<changeSet id="6" author="lakshmi.n">
		<createView viewName="amtvehicledealer_view"
			replaceIfExists="true">
		SELECT t1.dealerid,
	    t1.dealertype,
	    t1.dealername,
	    t1.dealertelephone,
	    t1.dealerfax,
	    t1.dealeraddress1,
	    t1.dealeraddress2,
	    t1.dealeraddress3,
	    t1.dealeraddress4,
	    t1.dealercountry,
	    t5.countrydesc AS lovdesccountry,
	    t1.dealerprovince,
	    t4.cpprovincename AS lovdescprovince,
	    t4.taxstatecode,
	    t1.dealercity,
	    t3.pccityname AS lovdesccity,
	    t1.email,
	    t1.pobox,
	    t1.zipcode,
	    t1.pannumber,
	    t1.taxnumber,
	    t1.productctg,
	    t10.productctgdesc,
	    t1.active,
	    t1.emirates,
	    t1.commisionpaidat,
	    t1.calculationrule,
	    t7.rulecodedesc AS calruledesc,
	    t1.paymentmode,
	    t1.accountnumber,
	    t1.accountingsetid,
	    t8.accountsetcode AS accountingsetcode,
	    t8.accountsetcodename AS accountingsetdesc,
	    t9.cpprovincename AS emiratesdescription,
	    t1.sellertype,
	    t1.version,
	    t1.lastmntby,
	    t1.lastmnton,
	    t1.recordstatus,
	    t1.rolecode,
	    t1.nextrolecode,
	    t1.taskid,
	    t1.nexttaskid,
	    t1.recordtype,
	    t1.workflowid
	    FROM amtvehicledealer_temp t1
	    LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity
	    LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
	    LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
	    LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
	    LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
	    LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
	    LEFT JOIN vasproductcategory t10 ON t1.productctg = t10.productctg
		 UNION ALL
	    SELECT t1.dealerid,
	    t1.dealertype,
	    t1.dealername,
	    t1.dealertelephone,
	    t1.dealerfax,
	    t1.dealeraddress1,
	    t1.dealeraddress2,
	    t1.dealeraddress3,
	    t1.dealeraddress4,
	    t1.dealercountry,
	    t5.countrydesc AS lovdesccountry,
	    t1.dealerprovince,
	    t4.cpprovincename AS lovdescprovince,
	    t4.taxstatecode,
	    t1.dealercity,
	    t3.pccityname AS lovdesccity,
	    t1.email,
	    t1.pobox,
	    t1.zipcode,
	    t1.pannumber,
	    t1.taxnumber,
	    t1.productctg,
	    t10.productctgdesc,
	    t1.active,
	    t1.emirates,
	    t1.commisionpaidat,
	    t1.calculationrule,
	    t7.rulecodedesc AS calruledesc,
	    t1.paymentmode,
	    t1.accountnumber,
	    t1.accountingsetid,
	    t8.accountsetcode AS accountingsetcode,
	    t8.accountsetcodename AS accountingsetdesc,
	    t9.cpprovincename AS emiratesdescription,
	    t1.sellertype,
	    t1.version,
	    t1.lastmntby,
	    t1.lastmnton,
	    t1.recordstatus,
	    t1.rolecode,
	    t1.nextrolecode,
	    t1.taskid,
	    t1.nexttaskid,
	    t1.recordtype,
	    t1.workflowid
	    FROM amtvehicledealer t1
	    LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity AND t1.dealercity = t3.pccity
	    LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
	    LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
	    LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
	    LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
	    LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
	    LEFT JOIN vasproductcategory t10 ON t1.productctg = t10.productctg
	    WHERE NOT (EXISTS ( SELECT 1
	           FROM amtvehicledealer_temp
	          WHERE amtvehicledealer_temp.dealerid = t1.dealerid))
		</createView>
	</changeSet>
	<changeSet id="7" author="lakshmi.n">
		<createView viewName="amtvehicledealer_aview"
			replaceIfExists="true">
		SELECT t1.dealerid,
	    t1.dealertype,
	    t1.dealername,
	    t1.dealertelephone,
	    t1.dealerfax,
	    t1.dealeraddress1,
	    t1.dealeraddress2,
	    t1.dealeraddress3,
	    t1.dealeraddress4,
	    t1.dealercountry,
	    t5.countrydesc AS lovdesccountry,
	    t1.dealerprovince,
	    t4.cpprovincename AS lovdescprovince,
	    t1.dealercity,
	    t3.pccityname AS lovdesccity,
	    t1.email,
	    t1.pobox,
	    t1.zipcode,
	    t1.pannumber,
	    t1.taxnumber,
	    t1.productctg,
	    t10.productctgdesc,
	    t1.active,
	    t1.emirates,
	    t1.commisionpaidat,
	    t1.calculationrule,
	    t7.rulecodedesc AS calruledesc,
	    t1.paymentmode,
	    t1.accountnumber,
	    t1.accountingsetid,
	    t8.accountsetcode AS accountingsetcode,
	    t8.accountsetcodename AS accountingsetdesc,
	    t9.cpprovincename AS emiratesdescription,
	    t1.sellertype,
	    t1.version,
	    t1.lastmntby,
	    t1.lastmnton,
	    t1.recordstatus,
	    t1.rolecode,
	    t1.nextrolecode,
	    t1.taskid,
	    t1.nexttaskid,
	    t1.recordtype,
	    t1.workflowid
	    FROM amtvehicledealer t1
	    LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity AND t1.dealercity = t3.pccity
	    LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
	    LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
	    LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
	    LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
	    LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
	    LEFT JOIN vasproductcategory t10 ON t1.productctg = t10.productctg 
		</createView>
	</changeSet>

	<changeSet id="8" author="lakshmi.n">
		<createView viewName="amtvehicledealer_view"
			replaceIfExists="true">
		SELECT t1.dealerid,
	    t1.dealertype,
	    t1.dealername,
	    t1.dealertelephone,
	    t1.dealerfax,
	    t1.dealeraddress1,
	    t1.dealeraddress2,
	    t1.dealeraddress3,
	    t1.dealeraddress4,
	    t1.dealercountry,
	    t5.countrydesc AS lovdesccountry,
	    t1.dealerprovince,
	    t4.cpprovincename AS lovdescprovince,
	    t1.dealercity,
	    t3.pccityname AS lovdesccity,
	    t1.email,
	    t1.pobox,
	    t1.zipcode,
	    t1.pannumber,
	    t1.taxnumber,
	    t1.productctg,
	    t10.productctgdesc,
	    t1.active,
	    t1.emirates,
	    t1.commisionpaidat,
	    t1.calculationrule,
	    t7.rulecodedesc AS calruledesc,
	    t1.paymentmode,
	    t1.accountnumber,
	    t1.accountingsetid,
	    t8.accountsetcode AS accountingsetcode,
	    t8.accountsetcodename AS accountingsetdesc,
	    t9.cpprovincename AS emiratesdescription,
	    t1.sellertype,
	    t1.version,
	    t1.lastmntby,
	    t1.lastmnton,
	    t1.recordstatus,
	    t1.rolecode,
	    t1.nextrolecode,
	    t1.taskid,
	    t1.nexttaskid,
	    t1.recordtype,
	    t1.workflowid
	    FROM amtvehicledealer_temp t1
	    LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity
	    LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
	    LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
	    LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
	    LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
	    LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
	    LEFT JOIN vasproductcategory t10 ON t1.productctg = t10.productctg
		 UNION ALL
	    SELECT t1.dealerid,
	    t1.dealertype,
	    t1.dealername,
	    t1.dealertelephone,
	    t1.dealerfax,
	    t1.dealeraddress1,
	    t1.dealeraddress2,
	    t1.dealeraddress3,
	    t1.dealeraddress4,
	    t1.dealercountry,
	    t5.countrydesc AS lovdesccountry,
	    t1.dealerprovince,
	    t4.cpprovincename AS lovdescprovince,
	    t1.dealercity,
	    t3.pccityname AS lovdesccity,
	    t1.email,
	    t1.pobox,
	    t1.zipcode,
	    t1.pannumber,
	    t1.taxnumber,
	    t1.productctg,
	    t10.productctgdesc,
	    t1.active,
	    t1.emirates,
	    t1.commisionpaidat,
	    t1.calculationrule,
	    t7.rulecodedesc AS calruledesc,
	    t1.paymentmode,
	    t1.accountnumber,
	    t1.accountingsetid,
	    t8.accountsetcode AS accountingsetcode,
	    t8.accountsetcodename AS accountingsetdesc,
	    t9.cpprovincename AS emiratesdescription,
	    t1.sellertype,
	    t1.version,
	    t1.lastmntby,
	    t1.lastmnton,
	    t1.recordstatus,
	    t1.rolecode,
	    t1.nextrolecode,
	    t1.taskid,
	    t1.nexttaskid,
	    t1.recordtype,
	    t1.workflowid
	    FROM amtvehicledealer t1
	    LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity AND t1.dealercity = t3.pccity
	    LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
	    LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
	    LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
	    LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
	    LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
	    LEFT JOIN vasproductcategory t10 ON t1.productctg = t10.productctg
	    WHERE NOT (EXISTS ( SELECT 1
	           FROM amtvehicledealer_temp
	          WHERE amtvehicledealer_temp.dealerid = t1.dealerid))
		</createView>
	</changeSet>
	
	<changeSet id="9" author="saikiran.v">
			<sql>
				<![CDATA[
					Insert Into secGroups values((Select MAX(GrpID)+1 From secGroups),'VASPROVIDERACCDETAIL_MAKER','WF Maker for VAS Provider Account Details',0 ,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGroups values((Select MAX(GrpID)+1 From secGroups),'VASPROVIDERACCDETAIL_APPROVER','WF Approver for VAS Provider Account Details',0,1000,current_timestamp, 'Approved','','','','','',0);
					INSERT INTO SecRights VALUES ((Select MAX(RightID)+1 From SecRights), 0, 'menuItem_SystemMaster_VASProviderAccDetail', 'MENU',  1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					INSERT INTO SecRights VALUES ((Select MAX(RightID)+1 From SecRights), 0, 'menuItem_SystemMaster_VASProviderAccDetailEnquiry', 'MENU',  1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 2, 'button_VASProviderAccDetailList_NewVASProviderAccDetail', 'VASProviderAccDetailList', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 2, 'button_VASProviderAccDetailDialog_btnEdit', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 2, 'button_VASProviderAccDetailDialog_btnDelete', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 2, 'button_VASProviderAccDetailDialog_btnSave', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_Id', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_EntityCode', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_ProviderId', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_PaymentMode', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_BankCode', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_BankBranchID', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_IFSCCode', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_MICRCode', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_AccountNumber', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_ReceivableAdjustment', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASProviderAccDetailDialog_ReconciliationAmount', 'VASProviderAccDetailDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='menuItem_SystemMaster_VASProviderAccDetail'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='menuItem_SystemMaster_VASProviderAccDetailEnquiry'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='button_VASProviderAccDetailDialog_btnSave'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='button_VASProviderAccDetailDialog_btnEdit'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='button_VASProviderAccDetailDialog_btnDelete'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='button_VASProviderAccDetailList_NewVASProviderAccDetail'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_Id'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_EntityCode'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_ProviderId'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_PaymentMode'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_BankCode'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_BankBranchID'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_IFSCCode'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_MICRCode'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_AccountNumber'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_ReceivableAdjustment'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_MAKER'),(select RightId from secRights where RightName='VASProviderAccDetailDialog_ReconciliationAmount'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_APPROVER'),(select RightId from secRights where RightName='menuItem_SystemMaster_VASProviderAccDetail'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_APPROVER'),(select RightId from secRights where RightName='menuItem_SystemMaster_VASProviderAccDetailEnquiry'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASPROVIDERACCDETAIL_APPROVER'),(select RightId from secRights where RightName='button_VASProviderAccDetailDialog_btnSave'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
					Insert into secRoleGroups values((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='VASPROVIDERACCDETAIL_MAKER'),(select RoleID from secRoles where RoleCd='MSTGRP1_MAKER'),0,1000,current_timestamp,'Approved','','','','','',0);
					Insert into secRoleGroups values((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='VASPROVIDERACCDETAIL_APPROVER'),(select RoleID from secRoles where RoleCd='MSTGRP1_APPROVER'),0,1000,current_timestamp,'Approved','','','','','',0);
				]]>
			</sql>
	</changeSet>
	
	
<changeSet id="10" author="Durga Prasad G">
	 <addColumn tableName="EXTENDEDFIELDDETAIL">
	 	<column name="ValFromScript" type="boolean" defaultValue="0"/>
	 </addColumn>
	 <addColumn tableName="EXTENDEDFIELDDETAIL_TEMP">
	 	<column name="ValFromScript" type="boolean" defaultValue="0"/>
	 </addColumn>
</changeSet>

<changeSet id="11" author="Durga Prasad G">
	<createView viewName="EXTENDEDFIELDDETAIL_VIEW" replaceIfExists="true">
			SELECT t1.moduleid,
		    t1.fieldname,
		    t2.modulename AS lovdescmodulename,
		    t2.submodulename AS lovdescsubmodulename,
		    t1.fieldtype,
		    t1.fieldlength,
		    t1.fieldprec,
		    t1.fieldlabel,
		    t1.fieldmandatory,
		    t1.fieldconstraint,
		    t1.fieldseqorder,
		    t1.fieldlist,
		    t1.fielddefaultvalue,
		    t1.fieldminvalue,
		    t1.fieldmaxvalue,
		    t1.fieldunique,
		    t1.extendedtype,
		    t1.filters,
		    t1.version,
		    t1.lastmntby,
		    t1.lastmnton,
		    t1.recordstatus,
		    t1.rolecode,
		    t1.nextrolecode,
		    t1.taskid,
		    t1.nexttaskid,
		    t1.recordtype,
		    t1.workflowid,
		    t1.multiline,
		    t1.parenttag,
		    t1.inputelement,
		    t1.editable,
		    t1.allowinrule,
		    t1.scriptlet,
		    t1.visible,
		    t1.ValFromScript
		    FROM extendedfielddetail_temp t1
		    JOIN extendedfieldheader_temp t2 ON t1.moduleid = t2.moduleid
		    UNION ALL
		    SELECT t1.moduleid,
		    t1.fieldname,
		    t2.modulename AS lovdescmodulename,
		    t2.submodulename AS lovdescsubmodulename,
		    t1.fieldtype,
		    t1.fieldlength,
		    t1.fieldprec,
		    t1.fieldlabel,
		    t1.fieldmandatory,
		    t1.fieldconstraint,
		    t1.fieldseqorder,
		    t1.fieldlist,
		    t1.fielddefaultvalue,
		    t1.fieldminvalue,
		    t1.fieldmaxvalue,
		    t1.fieldunique,
		    t1.extendedtype,
		    t1.filters,
		    t1.version,
		    t1.lastmntby,
		    t1.lastmnton,
		    t1.recordstatus,
		    t1.rolecode,
		    t1.nextrolecode,
		    t1.taskid,
		    t1.nexttaskid,
		    t1.recordtype,
		    t1.workflowid,
		    t1.multiline,
		    t1.parenttag,
		    t1.inputelement,
		    t1.editable,
		    t1.allowinrule,
		    t1.scriptlet,
		    t1.visible,
		    t1.ValFromScript
		   FROM extendedfielddetail t1
		     JOIN extendedfieldheader t2 ON t1.moduleid = t2.moduleid
		  WHERE NOT (EXISTS ( SELECT 1
		           FROM extendedfielddetail_temp
		          WHERE extendedfielddetail_temp.moduleid = t1.moduleid AND extendedfielddetail_temp.fieldname = t1.fieldname))
	</createView>
</changeSet>

<changeSet id="12" author="Durgaprasad G">
	<createView viewName="EXTENDEDFIELDDETAIL_AVIEW" replaceIfExists="true">
					SELECT t1.moduleid,
				    t1.fieldname,
				    t2.modulename AS lovdescmodulename,
				    t2.submodulename AS lovdescsubmodulename,
				    t1.fieldtype,
				    t1.fieldlength,
				    t1.fieldprec,
				    t1.fieldlabel,
				    t1.fieldmandatory,
				    t1.fieldconstraint,
				    t1.fieldseqorder,
				    t1.fieldlist,
				    t1.fielddefaultvalue,
				    t1.fieldminvalue,
				    t1.fieldmaxvalue,
				    t1.fieldunique,
				    t1.extendedtype,
				    t1.filters,
				    t1.version,
				    t1.lastmntby,
				    t1.lastmnton,
				    t1.recordstatus,
				    t1.rolecode,
				    t1.nextrolecode,
				    t1.taskid,
				    t1.nexttaskid,
				    t1.recordtype,
				    t1.workflowid,
				    t1.multiline,
				    t1.parenttag,
				    t1.inputelement,
				    t1.editable,
				    t1.allowinrule,
				    t1.scriptlet,
				    t1.visible,
				    t1.valFromScript
				   FROM extendedfielddetail t1
				     JOIN extendedfieldheader t2 ON t1.moduleid = t2.moduleid
	</createView>
</changeSet> 

<changeSet id="13" author="Saikiran.v">

	<createTable tableName="VASProviderAccDetail">
			<column name="Id" type="bigint">
			</column>
			<column name="EntityCode" type="VARCHAR(8)">
				<constraints nullable="false" />
			</column>
			<column name="ProviderId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaymentMode" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="BankBranchID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="IFSCCode" type="Varchar(20)">
			</column>
			<column name="MICRCode" type="Varchar(20)">
			</column>
			<column name="AccountNumber" type="Varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="ReceivableAdjustment" type="boolean">
			</column>
			<column name="ReconciliationAmount" type="number(3,0)">
					<constraints nullable="false" />
			</column>
			<column name="Active" type="boolean">
			</column>
			<column name="version" type="int" />
			<column name="lastmntby" type="bigint" />
			<column name="lastmnton" type="datetime" />
			<column name="recordstatus" type="varchar(50)" />
			<column name="rolecode" type="varchar(100)" />
			<column name="nextrolecode" type="varchar(200)" />
			<column name="taskid" type="varchar(50)" />
			<column name="nexttaskid" type="varchar(200)" />
			<column name="recordtype" type="varchar(50)" />
			<column name="workflowid" type="bigint">
				<constraints nullable="false" />
			</column>
	</createTable>
	<createTable tableName="VASProviderAccDetail_Temp">
			<column name="Id" type="bigint">
			</column>
			<column name="EntityCode" type="VARCHAR(8)">
				<constraints nullable="false" />
			</column>
			<column name="ProviderId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="PaymentMode" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="BankBranchID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="IFSCCode" type="Varchar(20)">
			</column>
			<column name="MICRCode" type="Varchar(20)">
			</column>
			<column name="AccountNumber" type="Varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="ReceivableAdjustment" type="boolean">
			</column>
			<column name="ReconciliationAmount" type="number(3,0)">
					<constraints nullable="false" />
			</column>
			<column name="Active" type="boolean">
			</column>
			<column name="version" type="int" />
			<column name="lastmntby" type="bigint" />
			<column name="lastmnton" type="datetime" />
			<column name="recordstatus" type="varchar(50)" />
			<column name="rolecode" type="varchar(100)" />
			<column name="nextrolecode" type="varchar(200)" />
			<column name="taskid" type="varchar(50)" />
			<column name="nexttaskid" type="varchar(200)" />
			<column name="recordtype" type="varchar(50)" />
			<column name="workflowid" type="bigint">
				<constraints nullable="false" />
			</column>
	</createTable>
</changeSet> 
<changeSet id="14" author="saikiran.v">
	<addColumn tableName="VASProviderAccDetail" >
		<column name="BankCode" type="Varchar(8)">
			<constraints nullable="false" />
		</column>
	</addColumn>
	<addColumn tableName="VASProviderAccDetail_Temp" >
		<column name="BankCode" type="Varchar(8)">
			<constraints nullable="false" />
		</column>
	</addColumn>
</changeSet>
<changeSet id="16" author="saikiran.v">
				<createView viewName="VASProviderAccDetail_AView"
			replaceIfExists="true">
		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T1.BankCode,T3.BANKNAME, T1.BankBranchID, T4.BRANCHDESC, T1.AccountNumber, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail T1
				inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BMTBANKDETAIL T3 on T3.BANKCODE = T1.BankCode
				inner join 
				BANKBRANCHES T4 on T4.BANKBRANCHID = T1.BankBranchID
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		</createView>
	</changeSet>
	<changeSet id="17" author="saikiran.v">
		<createView viewName="VASProviderAccDetail_View"
				replaceIfExists="true">
		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T1.BankCode,T3.BANKNAME, T1.BankBranchID, T4.BRANCHDESC, T1.AccountNumber, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail_Temp T1 
				inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BMTBANKDETAIL T3 on T3.BANKCODE = T1.BankCode
				inner join 
				BANKBRANCHES T4 on T4.BANKBRANCHID = T1.BankBranchID
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		UNION ALL
		
		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T1.BankCode,T3.BANKNAME, T1.BankBranchID, T4.BRANCHDESC, T1.AccountNumber, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail T1 
		inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BMTBANKDETAIL T3 on T3.BANKCODE = T1.BankCode
				inner join 
				BANKBRANCHES T4 on T4.BANKBRANCHID = T1.BankBranchID
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		WHERE     NOT EXISTS (SELECT 1 FROM VASProviderAccDetail_TEMP WHERE Id = T1.Id)
		</createView>
	</changeSet>
	 
	
<changeSet id="10" author="lakshmi.n">
	<addColumn tableName="VASSTRUCTURE_TEMP">
		<column name="feetype" type="bigint"/>
		<column name="flpcalculatedon" type="varchar(10)" />
		<column name="shortcode" type="varchar(3)"/>
	</addColumn>
	<addColumn tableName="VASSTRUCTURE">
		<column name="feetype" type="bigint"/>
		<column name="flpcalculatedon" type="varchar(10)" />
		<column name="shortcode" type="varchar(3)"/>
	</addColumn>

	<addForeignKeyConstraint constraintName="fk_vasstr_temp_feetype"
		referencedTableName="FeeTypes" baseColumnNames="feetype"
		baseTableName="VASSTRUCTURE_TEMP" referencedColumnNames="FEETYPEID" />

	<addForeignKeyConstraint constraintName="fk_vasstr_feetype"
		referencedTableName="FeeTypes" baseColumnNames="feetype"
		baseTableName="VASSTRUCTURE" referencedColumnNames="FEETYPEID" />
</changeSet> 
<changeSet id="11" author="lakshmi.n">
	<createView viewName="VASSTRUCTURE_AVIEW" replaceIfExists="true">
	SELECT    T1.ProductCode, T1.ProductDesc, T1.RecAgainst, T1.FeeAccrued, T1.FeeAccounting, T1.AccrualAccounting,
          T1.RecurringType, T1.FreeLockPeriod, T1.Active, T1.PreValidationReq, T1.PostValidationReq, T1.Remarks,
          T1.ProductType, T1.VasFee, T1.AllowFeeToModify, T1.ManufacturerId, T1.PreValidation, T1.PostValidation,
          T1.feetype, T1.flpcalculatedon, T1.shortcode,
          T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId,
          T1.NextTaskId, T1.RecordType, T1.WorkflowId,  T2.AccountSetCodeName FeeAccountingName,
          T3.AccountSetCodeName AccrualAccountingName,T2.AccountSetCode FeeAccountingDesc
          ,T3.AccountSetCode AccrualAccountingDesc,T4.ProductTypeDesc , T5.DealerName ManufacturerName, T6.ProductCtg,T6.ProductCtgDesc ProductCategory
          ,T7.FEETYPECODE , T7.FEETYPEDESC
          FROM   VasStructure T1 LEFT OUTER JOIN
          RMTAccountingSet T2 ON T1.FeeAccounting = T2.AccountSetid LEFT OUTER JOIN
          RMTAccountingSet T3 ON T1.AccrualAccounting = T3.AccountSetid 	INNER JOIN
		  VasProductType T4 ON T1.ProductType = T4.ProductType INNER JOIN
          VasProductCategory T6 ON T6.ProductCtg = T4.ProductCtg INNER JOIN
          AMTVehicleDealer T5 ON T1.ManufacturerId = T5.DealerId left join 
	      FeeTypes T7 on T1.feetype = T7.FEETYPEID
	</createView>
</changeSet>
<changeSet id="12" author="lakshmi.n">
	<createView viewName="VASSTRUCTURE_VIEW" replaceIfExists="true">
	 	  SELECT    T1.ProductCode, T1.ProductDesc, T1.RecAgainst, T1.FeeAccrued, T1.FeeAccounting, T1.AccrualAccounting,
          T1.RecurringType, T1.FreeLockPeriod, T1.Active, T1.PreValidationReq, T1.PostValidationReq, T1.Remarks,
          T1.ProductType, T1.VasFee, T1.AllowFeeToModify, T1.ManufacturerId,  T1.PreValidation, T1.PostValidation,
          T1.feetype, T1.flpcalculatedon, T1.shortcode,
          T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId,
          T1.NextTaskId, T1.RecordType, T1.WorkflowId,  T2.AccountSetCodeName FeeAccountingName,
          T3.AccountSetCodeName AccrualAccountingName,T2.AccountSetCode FeeAccountingDesc
          ,T3.AccountSetCode AccrualAccountingDesc,T4.ProductTypeDesc , T5.DealerName ManufacturerName, T6.ProductCtg,T6.ProductCtgDesc ProductCategory
          ,T7.FEETYPECODE , T7.FEETYPEDESC
          FROM   VasStructure_Temp T1 LEFT OUTER JOIN
          RMTAccountingSet T2 ON T1.FeeAccounting = T2.AccountSetid LEFT OUTER JOIN
          RMTAccountingSet T3 ON T1.AccrualAccounting = T3.AccountSetid 	INNER JOIN
		  VasProductType T4 ON T1.ProductType = T4.ProductType INNER JOIN
          VasProductCategory T6 ON T6.ProductCtg = T4.ProductCtg INNER JOIN
          AMTVehicleDealer T5 ON T1.ManufacturerId = T5.DealerId left join
           FeeTypes T7 on T1.feetype = T7.FEETYPEID	  

			UNION ALL
		  SELECT    T1.ProductCode, T1.ProductDesc, T1.RecAgainst, T1.FeeAccrued, T1.FeeAccounting, T1.AccrualAccounting,
          T1.RecurringType, T1.FreeLockPeriod, T1.Active, T1.PreValidationReq, T1.PostValidationReq, T1.Remarks,
          T1.ProductType, T1.VasFee, T1.AllowFeeToModify, T1.ManufacturerId,  T1.PreValidation, T1.PostValidation,
          T1.feetype, T1.flpcalculatedon, T1.shortcode,
          T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId,
          T1.NextTaskId, T1.RecordType, T1.WorkflowId,  T2.AccountSetCodeName FeeAccountingName,
          T3.AccountSetCodeName AccrualAccountingName,T2.AccountSetCode FeeAccountingDesc
          ,T3.AccountSetCode AccrualAccountingDesc,T4.ProductTypeDesc , T5.DealerName ManufacturerName,T6.ProductCtg, T6.ProductCtgDesc ProductCategory
          ,T7.FEETYPECODE , T7.FEETYPEDESC
          FROM   VasStructure T1 LEFT OUTER JOIN
          RMTAccountingSet T2 ON T1.FeeAccounting = T2.AccountSetid LEFT OUTER JOIN
          RMTAccountingSet T3 ON T1.AccrualAccounting = T3.AccountSetid 	INNER JOIN
		  VasProductType T4 ON T1.ProductType = T4.ProductType INNER JOIN
          VasProductCategory T6 ON T6.ProductCtg = T4.ProductCtg INNER JOIN
          AMTVehicleDealer T5 ON T1.ManufacturerId = T5.DealerId left join
          FeeTypes T7 on T1.feetype = T7.FEETYPEID	    
		WHERE NOT (EXISTS(SELECT 1 FROM VasStructure_Temp WHERE ProductCode = T1.ProductCode))
	</createView>
</changeSet>
<changeSet id="13" author="lakshmi.n">
	<sql>
	<![CDATA[
	Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASConfigurationDialog_CancellationFeeType', 'VASConfigurationDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);

	Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASConfigurationDialog_FLPCalculatedOn', 'VASConfigurationDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);

	Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASConfigurationDialog_ShortCode', 'VASConfigurationDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);

	Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASCONFIGURATION_MAKER'),(select RightId from secRights where RightName='VASConfigurationDialog_CancellationFeeType'),1,0,1000,current_timestamp, 'Approved','','','','','',0);

	Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASCONFIGURATION_MAKER'),(select RightId from secRights where RightName='VASConfigurationDialog_FLPCalculatedOn'),1,0,1000,current_timestamp, 'Approved','','','','','',0);

	Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASCONFIGURATION_MAKER'),(select RightId from secRights where RightName='VASConfigurationDialog_ShortCode'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
	]]>
	</sql>
</changeSet>


<changeSet id="14.2" author="Durgaprasad G" dbms="oracle,postgresql">
		<createSequence sequenceName="seqVASProviderAccDetail" startValue="1" maxValue="9223372036854775807" incrementBy="1" />
</changeSet>

<changeSet id="14.3" author="Durgaprasad G" dbms="mssql">
	<createTable tableName="seqVASProviderAccDetail">
		<column name="SeqNo" type="bigint" autoIncrement="true"/>
		<column name="Value" type="int"/>
	</createTable>
</changeSet>


	<changeSet id="15.1" author="saikiran.v">
		<comment></comment>
		<createView viewName="VASProviderAccDetail_AView"
			replaceIfExists="true">
		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T1.BankCode,T3.BANKNAME, T1.BankBranchID, T4.BRANCHDESC,T4.MICR MicrCode,T4.IFSC IfscCode, T1.AccountNumber, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail T1
				inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BMTBANKDETAIL T3 on T3.BANKCODE = T1.BankCode
				inner join 
				BANKBRANCHES T4 on T4.BANKBRANCHID = T1.BankBranchID 
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		</createView>
	</changeSet>
	<changeSet id="16.1" author="saikiran.v">
		<comment>Vas Provider End ::</comment>
		<createView viewName="VASProviderAccDetail_View"
			replaceIfExists="true">
		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T1.BankCode,T3.BANKNAME, T1.BankBranchID, T4.BRANCHDESC,T4.MICR MicrCode,T4.IFSC IfscCode, T1.AccountNumber, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail_Temp T1 
				inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BMTBANKDETAIL T3 on T3.BANKCODE = T1.BankCode
				inner join 
				BANKBRANCHES T4 on T4.BANKBRANCHID = T1.BankBranchID
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		UNION ALL
		
		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T1.BankCode,T3.BANKNAME, T1.BankBranchID, T4.BRANCHDESC,T4.MICR MicrCode,T4.IFSC IfscCode, T1.AccountNumber, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail T1 
		inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BMTBANKDETAIL T3 on T3.BANKCODE = T1.BankCode
				inner join 
				BANKBRANCHES T4 on T4.BANKBRANCHID = T1.BankBranchID
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		WHERE     NOT EXISTS (SELECT 1 FROM VASProviderAccDetail_TEMP WHERE Id = T1.Id)
		</createView>
	</changeSet>
	
	<changeSet id="18.1.0" author="Durgaprasad G">
		<dropView viewName="VASProviderAccDetail_View"/>
		<dropView viewName="VASProviderAccDetail_AView"/>
	</changeSet>
	
	<changeSet author="saikiran.v" id="18.1">
		<sql>
			ALTER TABLE VASProviderAccDetail DROP COLUMN
			ReconciliationAmount;
			ALTER TABLE VASProviderAccDetail_temp DROP
			COLUMN ReconciliationAmount;
		</sql>
	</changeSet>
	<changeSet author="Saikiran.v" id="19.1">
		<addColumn tableName="VASProviderAccDetail">
			<column name="ReconciliationAmount" type="decimal(18,2)" />
		</addColumn>
		<addColumn tableName="VASProviderAccDetail_temp">
			<column name="ReconciliationAmount" type="decimal(18,2)" />
		</addColumn>
	</changeSet>


	<changeSet author="saikiran.v" id="20.1">
		<sql>
			ALTER TABLE VASProviderAccDetail DROP COLUMN IFSCCode;
			ALTER TABLE
			VASProviderAccDetail_temp DROP COLUMN IFSCCode;

			ALTER TABLE
			VASProviderAccDetail DROP COLUMN MICRCode;
			ALTER TABLE
			VASProviderAccDetail_temp DROP COLUMN MICRCode;

		</sql>
	</changeSet>
	<changeSet author="saikiran.v" id="21.1">
		<sql>
			ALTER TABLE VASProviderAccDetail DROP COLUMN BANKCODE;
			ALTER TABLE
			VASProviderAccDetail_temp DROP COLUMN BANKCODE;
		</sql>
	</changeSet>

	<changeSet id="22.1" author="saikiran.v">
		<createView viewName="VASProviderAccDetail_View"
			replaceIfExists="true">
		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T3.BankCode,T4.BANKNAME, T1.BankBranchID, T3.BRANCHDESC, T1.AccountNumber,T3.MICR MicrCode,T3.IFSC IfscCode, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail_Temp T1 
				inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BANKBRANCHES T3 on T3.BANKBRANCHID = T1.BankBranchID
				left join 
				BMTBANKDETAIL T4 on T4.BANKCODE = T3.BankCode
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		UNION ALL
		
		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T3.BankCode,T4.BANKNAME, T1.BankBranchID, T3.BRANCHDESC, T1.AccountNumber,T3.MICR MicrCode,T3.IFSC IfscCode, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail T1 
				inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BANKBRANCHES T3 on T3.BANKBRANCHID = T1.BankBranchID
				left join 
				BMTBANKDETAIL T4 on T4.BANKCODE = T3.BankCode
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		WHERE     NOT EXISTS (SELECT 1 FROM VASProviderAccDetail_TEMP WHERE Id = T1.Id)
		</createView>
	</changeSet>

	<changeSet id="23.1" author="saikiran.v">
		<comment></comment>
		<createView viewName="VASProviderAccDetail_AView"
			replaceIfExists="true">
		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T3.BankCode,T4.BANKNAME, T1.BankBranchID, T3.BRANCHDESC, T1.AccountNumber,T3.MICR MicrCode,T3.IFSC IfscCode, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail T1
				inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BANKBRANCHES T3 on T3.BANKBRANCHID = T1.BankBranchID
				left join 
				BMTBANKDETAIL T4 on T4.BANKCODE = T3.BankCode
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		</createView>
	</changeSet>
	<changeSet id="24.1" author="saikiran.v">
		<sql>
			ALTER TABLE VASProviderAccDetail ADD CONSTRAINT fk_VASPrvdrAccDtl
			PRIMARY
			KEY (ProviderId,EntityCode,PaymentMode);
		</sql>
	</changeSet>


	<changeSet id="saikiran.v" author="25.3.0.">
		<dropView viewName="VASPROVIDERACCDETAIL_AVIEW"/>
		<dropView viewName="VASPROVIDERACCDETAIL_VIEW"/>
	</changeSet>

	<changeSet author="saikiran.v" id="25.1">
		<sql>
			ALTER TABLE VASProviderAccDetail DROP COLUMN AccountNumber;
			ALTER
			TABLE VASProviderAccDetail_temp DROP COLUMN AccountNumber;
		</sql>
	</changeSet>
	<changeSet author="Saikiran.v" id="26.1">
		<addColumn tableName="VASProviderAccDetail">
			<column name="AccountNumber" type="Varchar(50)" />
		</addColumn>
		<addColumn tableName="VASProviderAccDetail_temp">
			<column name="AccountNumber" type="Varchar(50)" />
		</addColumn>
	</changeSet>
	<changeSet id="27" author="saikiran.v">
		<sql>
			ALTER TABLE VASProviderAccDetail_temp ADD CONSTRAINT
			fk_VASPrvdrAccDtl_t
			PRIMARY
			KEY (ProviderId,EntityCode,PaymentMode);
		</sql>
	</changeSet>
	
	<changeSet id="28" author="Durgaprasad.g">
		<createView viewName="VASPROVIDERACCDETAIL_AVIEW" replaceIfExists="true">
	 		SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T3.BankCode,T4.BANKNAME, T1.BankBranchID, T3.BRANCHDESC, T1.AccountNumber,T3.MICR MicrCode,T3.IFSC IfscCode, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
					, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM    	VASProviderAccDetail T1
				inner join
				Entity T2 on T2.ENTITYCODE = T1.EntityCode 
				inner join 
				BANKBRANCHES T3 on T3.BANKBRANCHID = T1.BankBranchID
				left join 
				BMTBANKDETAIL T4 on T4.BANKCODE = T3.BankCode
				inner join 
				AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
		</createView>
	</changeSet>
	
	<changeSet id="29" author="Durgaprasad G">
		<createView viewName="VASPROVIDERACCDETAIL_VIEW" replaceIfExists="true">
			SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T3.BankCode,T4.BANKNAME, T1.BankBranchID, T3.BRANCHDESC, T1.AccountNumber,T3.MICR MicrCode,T3.IFSC IfscCode, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	VASProviderAccDetail_Temp T1 
					inner join
					Entity T2 on T2.ENTITYCODE = T1.EntityCode 
					inner join 
					BANKBRANCHES T3 on T3.BANKBRANCHID = T1.BankBranchID
					left join 
					BMTBANKDETAIL T4 on T4.BANKCODE = T3.BankCode
					inner join 
					AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
			UNION ALL
			
			SELECT		T1.Id, T1.ProviderId,T5.DEALERNAME AS providerDesc, T1.EntityCode, T2.ENTITYDESC, T1.PaymentMode,T3.BankCode,T4.BANKNAME, T1.BankBranchID, T3.BRANCHDESC, T1.AccountNumber,T3.MICR MicrCode,T3.IFSC IfscCode, T1.ReceivableAdjustment, T1.ReconciliationAmount, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	VASProviderAccDetail T1 
					inner join
					Entity T2 on T2.ENTITYCODE = T1.EntityCode 
					inner join 
					BANKBRANCHES T3 on T3.BANKBRANCHID = T1.BankBranchID
					left join 
					BMTBANKDETAIL T4 on T4.BANKCODE = T3.BankCode
					inner join 
					AMTVEHICLEDEALER T5 on T5.DEALERID =T1.ProviderId
			WHERE     NOT EXISTS (SELECT 1 FROM VASProviderAccDetail_TEMP WHERE Id = T1.Id)
		</createView>
	</changeSet>
	
	<changeSet id="30" author="DurgaPrasad G">
		<sql>
			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO= (SELECT MAX(Grprightid) FROM SECGROUPRIGHTS);		
		
			Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASConfigurationDialog_ModeOfPayment', 'VASConfigurationDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
			Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASConfigurationDialog_AllowFeeType', 'VASConfigurationDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
			Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASConfigurationDialog_MedicalApplicable', 'VASConfigurationDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
	
			Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASCONFIGURATION_MAKER'),(select RightId from secRights where RightName='VASConfigurationDialog_ModeOfPayment'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
			Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASCONFIGURATION_MAKER'),(select RightId from secRights where RightName='VASConfigurationDialog_AllowFeeType'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
			Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASCONFIGURATION_MAKER'),(select RightId from secRights where RightName='VASConfigurationDialog_MedicalApplicable'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
		
			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO= (SELECT MAX(Grprightid) FROM SECGROUPRIGHTS);	
		</sql>
	</changeSet>
	
	<changeSet id="31" author="DurgaPrasad G">
		<sql>
			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO= (SELECT MAX(Grprightid) FROM SECGROUPRIGHTS);		
		
			Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASConfigurationDialog_btnUplaod', 'VASConfigurationDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
			Insert into SecRights Values((Select MAX(RightID)+1 From SecRights), 3, 'VASConfigurationDialog_FileImport', 'VASConfigurationDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
	
			Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASCONFIGURATION_MAKER'),(select RightId from secRights where RightName='VASConfigurationDialog_btnUplaod'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
			Insert Into secGrouprights values((select MAX(GrpRightID)+1 From secGrouprights),(select GrpId from SecGroups where Grpcode='VASCONFIGURATION_MAKER'),(select RightId from secRights where RightName='VASConfigurationDialog_FileImport'),1,0,1000,current_timestamp, 'Approved','','','','','',0);
		
			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO= (SELECT MAX(Grprightid) FROM SECGROUPRIGHTS);	
		</sql>
	</changeSet> 

<changeSet id="32" author="Durgaprasad G">
<comment>New Columns added for Direct Selling Agent </comment>
  <createView viewName="amtvehicledealer_aview" replaceIfExists="true" > 
	      SELECT 
			    t1.dealerid,
			    t1.dealertype,
			    t1.dealername,
			    t1.dealertelephone,
			    t1.dealerfax,
			    t1.dealeraddress1,
			    t1.dealeraddress2,
			    t1.dealeraddress3,
			    t1.dealeraddress4,
			    t1.dealercountry,
			    t5.countrydesc AS lovdesccountry,
			    t1.dealerprovince,
			    t4.cpprovincename AS lovdescprovince,
			    t1.dealercity,
			    t3.pccityname AS lovdesccity,
			    t1.email,
			    t1.pobox,
			    t1.zipcode,
			    t1.active,
			    t1.emirates,
			    t1.commisionpaidat,
			    t1.calculationrule,
			    t7.rulecodedesc AS calruledesc,
			    t1.paymentmode,
			    t1.accountnumber,
			    t1.accountingsetid,
			    t8.accountsetcode AS accountingsetcode,
			    t8.accountsetcodename AS accountingsetdesc,
			    t9.cpprovincename AS emiratesdescription,
			    t1.sellertype,
			    t1.PANNumber,
			    t1.UIDNumber,
			    t1.TaxNumber,
			    t1.AccountNo,
			    t1.AccountType,
			    t1.FromProvince,
				t10.cpprovincename as fromprovinceName,
			    t1.ToProvince,
				t11.cpprovincename as toprovinceName,
			    t1.BankBranchID,
			    t12.branchcode as bankBranchCode,
				t12.branchdesc as bankBranchCodeName,
				t12.IFSC as branchIFSCCode,
			    t12.MICR as branchMICRCode,
			    t12.city as branchCity,
			    t13.bankname as bankName,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.code,
			     t1.productctg,
       			 t14.productctgdesc,
                  t1.shortcode
			   FROM amtvehicledealer t1
			     LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity AND t1.dealercity = t3.pccity
			     LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
			     LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
			     LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
			     LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
			     LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
			     LEFT JOIN rmtcountryvsprovince t10 ON t1.FromProvince = t10.cpprovince
			     LEFT JOIN rmtcountryvsprovince t11 ON t1.ToProvince = t11.cpprovince
			     LEFT JOIN BankBranches t12 ON t1.BankBranchID = t12.BankBranchID
			     INNER JOIN BMTBankDetail t13 ON t12.bankcode = t13.bankcode
			     LEFT JOIN vasproductcategory t14 ON t1.productctg = t14.productctg
   </createView>
</changeSet>
	
<changeSet id="33" author="Durgaprasad G">
	<comment>New Columns added for Direct Selling Agent </comment>
		<createView viewName="amtvehicledealer_view" replaceIfExists="true" > 
			    Select t1.dealerid,
			    t1.dealertype,
			    t1.dealername,
			    t1.dealertelephone,
			    t1.dealerfax,
			    t1.dealeraddress1,
			    t1.dealeraddress2,
			    t1.dealeraddress3,
			    t1.dealeraddress4,
			    t1.dealercountry,
			    t5.countrydesc AS lovdesccountry,
			    t1.dealerprovince,
			    t4.cpprovincename AS lovdescprovince,
			    t1.dealercity,
			    t3.pccityname AS lovdesccity,
			    t1.email,
			    t1.pobox,
			    t1.zipcode,
			    t1.active,
			    t1.emirates,
			    t1.commisionpaidat,
			    t1.calculationrule,
			    t7.rulecodedesc AS calruledesc,
			    t1.paymentmode,
			    t1.accountnumber,
			    t1.accountingsetid,
			    t8.accountsetcode AS accountingsetcode,
			    t8.accountsetcodename AS accountingsetdesc,
			    t9.cpprovincename AS emiratesdescription,
			    t1.sellertype,
			    t1.PANNumber,
			    t1.UIDNumber,
			    t1.TaxNumber,
			    t1.AccountNo,
			    t1.AccountType,
			    t1.FromProvince,
				t10.cpprovincename as fromprovinceName,
			    t1.ToProvince,
				t11.cpprovincename as toprovinceName, 
			    t1.BankBranchID,
			    t12.branchcode as bankBranchCode,
				t12.branchdesc as bankBranchCodeName,
				t12.IFSC as branchIFSCCode,
			    t12.MICR as branchMICRCode,
			    t12.city as branchCity,
			    t13.bankname as bankName,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.code,
			     t1.productctg,
       			 t14.productctgdesc,
                 t1.shortcode
			   FROM amtvehicledealer_temp t1
			     LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity
			     LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
			     LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
			     LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
			     LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
			     LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
			     LEFT JOIN rmtcountryvsprovince t10 ON t1.FromProvince = t10.cpprovince
			     LEFT JOIN rmtcountryvsprovince t11 ON t1.ToProvince = t11.cpprovince
			     LEFT JOIN BankBranches t12 ON t1.BankBranchID = t12.BankBranchID
			     INNER JOIN BMTBankDetail t13 ON t12.bankcode = t13.bankcode
			      LEFT JOIN vasproductcategory t14 ON t1.productctg = t14.productctg
			     
			UNION ALL
			SELECT 
			    t1.dealerid,
			    t1.dealertype,
			    t1.dealername,
			    t1.dealertelephone,
			    t1.dealerfax,
			    t1.dealeraddress1,
			    t1.dealeraddress2,
			    t1.dealeraddress3,
			    t1.dealeraddress4,
			    t1.dealercountry,
			    t5.countrydesc AS lovdesccountry,
			    t1.dealerprovince,
			    t4.cpprovincename AS lovdescprovince,
			    t1.dealercity,
			    t3.pccityname AS lovdesccity,
			    t1.email,
			    t1.pobox,
			    t1.zipcode,
			    t1.active,
			    t1.emirates,
			    t1.commisionpaidat,
			    t1.calculationrule,
			    t7.rulecodedesc AS calruledesc,
			    t1.paymentmode,
			    t1.accountnumber,
			    t1.accountingsetid,
			    t8.accountsetcode AS accountingsetcode,
			    t8.accountsetcodename AS accountingsetdesc,
			    t9.cpprovincename AS emiratesdescription,
			    t1.sellertype,
			    t1.PANNumber,
			    t1.UIDNumber,
			    t1.TaxNumber,
			    t1.AccountNo,
			    t1.AccountType,
			    t1.FromProvince,
				t10.cpprovincename as fromprovinceName,
			    t1.ToProvince,
				t11.cpprovincename as toprovinceName,
			    t1.BankBranchID,
			    t12.branchcode as bankBranchCode,
				t12.branchdesc as bankBranchCodeName,
				t12.IFSC as branchIFSCCode,
			    t12.MICR as branchMICRCode,
			    t12.city as branchCity,
			    t13.bankname as bankName,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.code,
			     t1.productctg,
       			 t14.productctgdesc,
                  t1.shortcode
			   FROM amtvehicledealer t1
			     LEFT JOIN rmtprovincevscity t3 ON t1.dealercountry = t3.pccountry AND t1.dealerprovince = t3.pcprovince AND t1.dealercity = t3.pccity AND t1.dealercity = t3.pccity
			     LEFT JOIN rmtcountryvsprovince t4 ON t1.dealercountry = t4.cpcountry AND t1.dealerprovince = t4.cpprovince
			     LEFT JOIN bmtcountries t5 ON t1.dealercountry = t5.countrycode
			     LEFT JOIN rules t7 ON t1.calculationrule = t7.rulecode AND t7.ruleevent = 'ADDDBS'
			     LEFT JOIN rmtaccountingset t8 ON t1.accountingsetid = t8.accountsetid
			     LEFT JOIN rmtcountryvsprovince t9 ON t1.emirates = t9.cpprovince
			     LEFT JOIN rmtcountryvsprovince t10 ON t1.FromProvince = t10.cpprovince
			     LEFT JOIN rmtcountryvsprovince t11 ON t1.ToProvince = t11.cpprovince
			     LEFT JOIN BankBranches t12 ON t1.BankBranchID = t12.BankBranchID
			     INNER JOIN BMTBankDetail t13 ON t12.bankcode = t13.bankcode
			     LEFT JOIN vasproductcategory t14 ON t1.productctg = t14.productctg
			     
			 WHERE NOT (EXISTS ( SELECT 1
			           FROM amtvehicledealer_temp
			          WHERE amtvehicledealer_temp.dealerid = t1.dealerid))
			 </createView>
	</changeSet>
	
	<changeSet id="34" author="Durga Prasad G">
	 	<sql>
			Update EXTENDEDFIELDDETAIL set ValFromScript = 0 Where ValFromScript is NULL;
			Update EXTENDEDFIELDDETAIL_TEMP set ValFromScript = 0 Where ValFromScript is NULL;
	 	</sql>
	</changeSet>
</databaseChangeLog>
