<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="1" author="shinde.b">
		<createTable tableName="cluster_hierarchy_temp">
			<column name="entity" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="clusterType" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="seqOrder" type="int">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="2_pre" author="shinde.b" dbms="postgresql">
		<modifyDataType tableName="cluster_hierarchy_temp" columnName="entity" newDataType="citext" />
	</changeSet>

	<changeSet id="2" author="shinde.b">
		<addPrimaryKey tableName="cluster_hierarchy_temp" columnNames="entity, clusterType" />
		<addUniqueConstraint tableName="cluster_hierarchy_temp" columnNames="entity, clusterType, seqOrder" />
		<addForeignKeyConstraint constraintName="fk_clustr_hierarchy_t_entity" referencedTableName="entity"
			baseColumnNames="entity" baseTableName="cluster_hierarchy_temp" referencedColumnNames="entitycode" />
	</changeSet>

	<changeSet id="3" author="shinde.b">
		<createTable tableName="cluster_hierarchy">
			<column name="entity" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="clusterType" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="seqOrder" type="int">
				<constraints nullable="false" />
			</column>
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="4_pre" author="shinde.b" dbms="postgresql">
		<modifyDataType tableName="cluster_hierarchy" columnName="entity" newDataType="citext" />
	</changeSet>

	<changeSet id="4" author="shinde.b">
		<addPrimaryKey tableName="cluster_hierarchy" columnNames="entity, clusterType" />
		<addUniqueConstraint tableName="cluster_hierarchy" columnNames="entity, clusterType, seqOrder" />
		<addForeignKeyConstraint constraintName="fk_clustr_hierarchy_entity" referencedTableName="entity"
			baseColumnNames="entity" baseTableName="cluster_hierarchy" referencedColumnNames="entitycode" />
	</changeSet>

	<changeSet id="5" author="shinde.b">
		<createView viewName="cluster_hierarchy_aview" replaceIfExists="true">
			SELECT
			  T1.Entity,
			  T2.EntityDesc,
			  T1.ClusterType,
			  T1.seqOrder,
			  T1.Version ,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM
			  cluster_hierarchy T1
			  INNER JOIN Entity T2 ON T2.EntityCode =  T1.Entity
    	 </createView>
	</changeSet>

	<changeSet id="6" author="shinde.b">
		<createView viewName="cluster_hierarchy_view" replaceIfExists="true">
			SELECT
			  T1.Entity,
			  T2.EntityDesc,
			  T1.ClusterType,
			  T1.seqOrder ,
			  T1.Version ,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM
			  cluster_hierarchy_temp T1
			 INNER JOIN Entity T2 ON T2.EntityCode =  T1.Entity
			UNION ALL
			SELECT
			  T1.Entity,
			  T2.EntityDesc,
			  T1.ClusterType,
			  T1.seqOrder ,
			  T1.Version ,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM
			  cluster_hierarchy T1
			  INNER JOIN Entity T2 ON T2.EntityCode =  T1.Entity
			WHERE
			  NOT EXISTS
			  (
			    SELECT
			      1
			    FROM
			      cluster_hierarchy_temp
			    WHERE
			      Entity = T1.Entity
			  )
		</createView>
	</changeSet>

	<changeSet id="7" author="shinde.b">
		<createView viewName="cluster_hierarchy_lview" replaceIfExists="true">
			select distinct * from (
			SELECT
			  T1.Entity,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM
			  cluster_hierarchy_temp T1
			UNION ALL
			SELECT
			  T1.Entity,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM
			  cluster_hierarchy T1
			WHERE
			  NOT EXISTS
			  (
			    SELECT
			      1
			    FROM
			      cluster_hierarchy_temp
			    WHERE
			      Entity = T1.Entity
			  ))T
		</createView>
	</changeSet>

	<changeSet id="8" author="Satish.n">
		<createSequence sequenceName="SeqClusters" />
	</changeSet>

	<changeSet id="9" author="Satish.n">
		<createTable tableName="clusters_temp">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="code" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="entity" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="clusterType" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="name" type="varchar(50)" />
			<column name="parent" type="bigint" />
			<column name="parentType" type="varchar(20)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="10_Pre" author="shinde.b" dbms="postgresql">
		<modifyDataType tableName="clusters_temp" columnName="entity" newDataType="citext" />
	</changeSet>

	<changeSet id="10" author="shinde.b">
		<addPrimaryKey tableName="clusters_temp" columnNames="Id" />
		<addUniqueConstraint columnNames="entity, code" tableName="clusters_temp" />
		<addUniqueConstraint columnNames="entity, parent, name" tableName="clusters_temp" />
		<addForeignKeyConstraint constraintName="fk_clusters_t_entity_ctype" referencedTableName="cluster_hierarchy"
			baseColumnNames="entity, clusterType" baseTableName="clusters_Temp" referencedColumnNames="entity, clusterType" />
	</changeSet>

	<changeSet id="11" author="Satish.n">
		<createTable tableName="clusters">
			<column name="Id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="code" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="entity" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="clusterType" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="name" type="varchar(50)" />
			<column name="parent" type="bigint" />
			<column name="parentType" type="varchar(20)" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="12_pre" author="shinde.b" dbms="postgresql">
		<modifyDataType tableName="clusters" columnName="entity" newDataType="citext" />
	</changeSet>

	<changeSet id="12" author="shinde.b">
		<addPrimaryKey tableName="clusters" columnNames="Id" />
		<addUniqueConstraint columnNames="entity, code" tableName="clusters" />
		<addUniqueConstraint columnNames="entity, parent, name" tableName="clusters" />
		<addForeignKeyConstraint constraintName="fk_clusters_entity_ctype" referencedTableName="cluster_hierarchy"
			baseColumnNames="entity, clusterType" baseTableName="clusters" referencedColumnNames="entity, clusterType" />
	</changeSet>

	<changeSet id="13" author="Satish.n">
		<createView viewName="clusters_aView" replaceIfExists="true">
			SELECT
			  T1.Id,
			  T1.Entity,
			  T2.EntityDesc,
			  T1.Code,
			  T1.ClusterType,
			  T1.Name,
			  T1.Parent,
			  T3.Code ParentCode,
			  T3.Name ParentName,
			  T1.ParentType ,
			  T1.Version ,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM
			  Clusters T1
			  INNER JOIN Entity T2 ON T2.EntityCode =  T1.Entity
			  LEFT JOIN Clusters T3 ON T3.Id =  T1.Parent
		</createView>
	</changeSet>

	<changeSet id="14" author="Satish.n">
		<createView viewName="clusters_view" replaceIfExists="true">
			SELECT
				  T1.Id,
				  T1.Entity,
				  T2.EntityDesc,
				  T1.Code,
				  T1.ClusterType,
				  T1.Name,
				  T1.Parent,
				  T3.Code ParentCode,
				  T3.Name ParentName,
				  T1.ParentType ,
				  T1.Version ,
				  T1.LastMntBy,
				  T1.LastMntOn,
				  T1.RecordStatus,
				  T1.RoleCode,
				  T1.NextRoleCode,
				  T1.TaskId,
				  T1.NextTaskId,
				  T1.RecordType,
				  T1.WorkflowId
				FROM
				  clusters_Temp T1
				  INNER JOIN Entity T2 ON T2.EntityCode =  T1.Entity
				   LEFT JOIN Clusters T3 ON T3.Id =  T1.Parent
				UNION ALL
				SELECT
				  T1.Id,
				  T1.Entity,
				  T2.EntityDesc,
				  T1.Code,
				  T1.ClusterType,
				  T1.Name,
				  T1.Parent,
				  T3.Code ParentCode,
				  T3.Name ParentName,
				  T1.ParentType ,
				  T1.Version ,
				  T1.LastMntBy,
				  T1.LastMntOn,
				  T1.RecordStatus,
				  T1.RoleCode,
				  T1.NextRoleCode,
				  T1.TaskId,
				  T1.NextTaskId,
				  T1.RecordType,
				  T1.WorkflowId
				FROM
				  Clusters T1
				  INNER JOIN Entity T2 ON T2.EntityCode =  T1.Entity
				   LEFT JOIN Clusters T3 ON T3.Id =  T1.Parent
				WHERE
				  NOT EXISTS
				  (
				    SELECT
				      1
				    FROM
				      clusters_TEMP
				    WHERE
				      Id = T1.Id
				  )
		</createView>
	</changeSet>

	<changeSet id="15" author="shinde.b">
		<sql>
			<![CDATA[
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecRoles set SeqNo = (Select max(RoleId)  from SecRoles);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights);
				Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId) from SecRoleGroups);
				
				INSERT INTO SecRoles  VALUES ((select max(roleid)+1 from secroles),1,'CLUSTER_HIERARCHY_VIEW','Role for Cluster Hierarch enquiry','',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				INSERT INTO SecRoles  VALUES ((select max(roleid)+1 from secroles),1,'CLUSTER_HIERARCHY_MAKER','Role for Cluster Hierarch maker','',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				INSERT INTO SecRoles  VALUES ((select max(roleid)+1 from secroles),1,'CLUSTER_HIERARCHY_APPROVER','Role for Cluster Hierarch approver','',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				
				INSERT INTO SecRoles  VALUES ((select max(roleid)+1 from secroles),1,'CLUSTER_VIEW','Role for Cluster enquiry','',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				INSERT INTO SecRoles  VALUES ((select max(roleid)+1 from secroles),1,'CLUSTER_MAKER','Role for Cluster maker','',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				INSERT INTO SecRoles  VALUES ((select max(roleid)+1 from secroles),1,'CLUSTER_APPROVER','Role for Cluster approver','',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CLUSTER_HIERARCHY_VIEW','Group for Cluster Hierarch enquiry', 1, 1000, CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CLUSTER_HIERARCHY_MAKER','Group for Cluster Hierarch maker', 1, 1000, CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CLUSTER_HIERARCHY_APPROVER','Group for Cluster Hierarch approver', 1, 1000, CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CLUSTER_VIEW','Group for Cluster enquiry', 1, 1000, CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CLUSTER_MAKER','Group for Cluster maker', 1, 1000, CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CLUSTER_APPROVER','Group for Cluster approver', 1, 1000, CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
				
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),0,'menuItem_ClusterHierarchey','MENU',0,1000,current_timestamp,'Approved','',' ','',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),0,'menuItem_ClusterHierarcheyEnquiry','MENU',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_ClusterHierarcheyList_PrintList','ClusterHierarcheyList',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_ClusterHierarcheyList_NewClusterHierarchey','ClusterHierarcheyList',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_ClusterHierarcheyDialog_btnNew','ClusterHierarcheyDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_ClusterHierarcheyDialog_btnEdit','ClusterHierarcheyDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_ClusterHierarcheyDialog_btnDelete','ClusterHierarcheyDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_ClusterHierarcheyDialog_btnSave','ClusterHierarcheyDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'ClusterHierarcheyDialog_Entity','ClusterHierarcheyDialog',0,1000,current_timestamp,'Approved','','',' ',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'ClusterHierarcheyDialog_ClusterType','ClusterHierarcheyDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'ClusterHierarcheyDialog_seqOrder','ClusterHierarcheyDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_VIEW'), (Select RightID from SecRights where RightName = 'menuItem_ClusterHierarcheyEnquiry'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_VIEW'), (Select RightID from SecRights where RightName = 'button_ClusterHierarcheyList_PrintList'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_MAKER'), (Select RightID from SecRights where RightName = 'menuItem_ClusterHierarchey'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterHierarcheyList_PrintList'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterHierarcheyList_NewClusterHierarchey'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterHierarcheyDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterHierarcheyDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterHierarcheyDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_MAKER'), (Select RightID from SecRights where RightName = 'ClusterHierarcheyDialog_Entity'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_MAKER'), (Select RightID from SecRights where RightName = 'ClusterHierarcheyDialog_ClusterType'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				
                INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_MAKER'), (Select RightID from SecRights where RightName = 'ClusterHierarcheyDialog_seqOrder'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_APPROVER'), (Select RightID from SecRights where RightName = 'menuItem_ClusterHierarchey'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_APPROVER'), (Select RightID from SecRights where RightName = 'button_ClusterHierarcheyList_PrintList'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_HIERARCHY_APPROVER'), (Select RightID from SecRights where RightName = 'button_ClusterHierarcheyDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				
				
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 0,'menuItem_Cluster','MENU',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 0,'menuItem_ClusterEnquiry','MENU',0,1000,current_timestamp,'Approved','',' ',' ','',' ',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 2,'button_ClusterList_PrintList','ClusterList',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 2,'button_ClusterList_NewCluster','ClusterList',0,1000,current_timestamp,'Approved','' ,' ',' ',' ','',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 2,'button_ClusterDialog_btnNew','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ','',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 2,'button_ClusterDialog_btnEdit','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ','',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 2,'button_ClusterDialog_btnDelete','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ','',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 2,'button_ClusterDialog_btnSave','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ','',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 3,'ClusterDialog_ClusterId','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 3,'ClusterDialog_Entity','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 3,'ClusterDialog_Code','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 3,'ClusterDialog_ClusterType','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 3,'ClusterDialog_Name','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 3,'ClusterDialog_Parent','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				INSERT INTO SecRights values((SELECT max(RightId) + 1 from SecRights), 3,'ClusterDialog_ParentType','ClusterDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_VIEW'), (Select RightID from SecRights where RightName = 'menuItem_ClusterEnquiry'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_VIEW'), (Select RightID from SecRights where RightName = 'button_ClusterList_PrintList'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'menuItem_Cluster'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterList_PrintList'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterList_NewCluster'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'button_ClusterDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'ClusterDialog_Entity'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'ClusterDialog_Code'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'ClusterDialog_ClusterType'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'ClusterDialog_Name'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'ClusterDialog_Parent'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_MAKER'), (Select RightID from SecRights where RightName = 'ClusterDialog_ParentType'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_APPROVER'), (Select RightID from SecRights where RightName = 'menuItem_Cluster'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_APPROVER'), (Select RightID from SecRights where RightName = 'button_ClusterList_PrintList'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CLUSTER_APPROVER'), (Select RightID from SecRights where RightName = 'button_ClusterDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
				
				
				INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='CLUSTER_HIERARCHY_VIEW'), (Select  RoleID  From SecRoles Where RoleCd='CLUSTER_HIERARCHY_VIEW'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
				INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='CLUSTER_HIERARCHY_MAKER'), (Select  RoleID  From SecRoles Where RoleCd='CLUSTER_HIERARCHY_MAKER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
				INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='CLUSTER_HIERARCHY_APPROVER'), (Select  RoleID  From SecRoles Where RoleCd='CLUSTER_HIERARCHY_APPROVER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
				
				INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='CLUSTER_VIEW'), (Select  RoleID  From SecRoles Where RoleCd='CLUSTER_VIEW'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
				INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='CLUSTER_MAKER'), (Select  RoleID  From SecRoles Where RoleCd='CLUSTER_MAKER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
				INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='CLUSTER_APPROVER'), (Select  RoleID  From SecRoles Where RoleCd='CLUSTER_APPROVER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
				
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecRoles set SeqNo = (Select max(RoleId)  from SecRoles);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId)  from SecGroupRights);
				Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId)  from SecRoleGroups);
			]]>
		</sql>
	</changeSet>

	<changeSet id="16" author="Amannullah.m">
		<sql>
			UPDATE SeqWorkFlowDetails SET SEQNO= (SELECT MAX(WorkflowId)+1 FROM workflowdetails);
		</sql>
		<insert tableName="WorkFlowDetails">
			<column name="WorkFlowId" valueComputed="(select max(WorkFlowId) + 1 from WorkFlowDetails)" />
			<column name="WorkFlowType">CLUSTER_HIERARCHY</column>
			<column name="WorkFlowSubType">CLUSTER_HIERARCHY</column>
			<column name="WorkFlowDesc">Cluster Hierarchy Workflow</column>
			<column name="JsonDesign" type="nclob"><![CDATA[NULL]]></column>
			<column name="SvgDesign" type="nclob"><![CDATA[NULL]]></column>
			<column name="WorkFlowXml" type="clob"><![CDATA[NULL]]></column>
			<column name="WorkFlowRoles">CLUSTER_HIERARCHY_MAKER;CLUSTER_HIERARCHY_APPROVER</column>
			<column name="FirstTaskOwner">CLUSTER_HIERARCHY_MAKER</column>
			<column name="WorkFlowActive">1</column>
			<column name="Version">5</column>
			<column name="LastMntBy">1000</column>
			<column name="LastMntOn" valueDate="current_timestamp" />
			<column name="RecordStatus">Null</column>
			<column name="RoleCode">Null</column>
			<column name="NextRoleCode">Null</column>
			<column name="TaskId">Null</column>
			<column name="NextTaskId">Null</column>
			<column name="RecordType">NULL</column>
		</insert>
	</changeSet>

	<changeSet id="17" author="Amanullah.m">
		<update tableName="WORKFLOWDETAILS">
			<column name="JSONDESIGN" type="NCLOB"><![CDATA[{"resourceId":969,"properties":{"process_id":"CLUSTER_HIERARCHY","name":"CLUSTER_HIERARCHY","documentation":"Cluster Hierarchy Workflow","category":"","listenerclass":"","listenerentitytype":""},"stencil":{"id":"BPMNDiagram"},"childShapes":[{"resourceId":"startEvent1","properties":{"overrideid":"","name":"Start"},"stencil":{"id":"StartNoneEvent"},"childShapes":[],"outgoing":[{"resourceId":"sid-74F252CD-466F-40FD-B3CB-46F431838C52"}],"bounds":{"lowerRight":{"x":105,"y":175},"upperLeft":{"x":75,"y":145}},"dockers":[]},{"resourceId":"sid-8376E442-6C90-4BA5-9679-76832BFFBCFE","properties":{"overrideid":"","name":"Maker","usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"user","assignee":{"email":"CLUSTER_HIERARCHY_MAKER","firstName":"CLUSTER_HIERARCHY_MAKER","fullName":"CLUSTER_HIERARCHY_MAKER","id":"CLUSTER_HIERARCHY_MAKER","roledesc":"Role for Cluster Hierarch maker","$$hashKey":"object:5013"}}}},"additionalforms":"","formkeydefinition":"","allowrevert":"","prioritydefinition":"Role Queue","baseactor":"","duedatedefinition":"","multiinstance_type":"None","isforcompensation":"false"},"stencil":{"id":"UserTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-FB18F2FF-C83A-4B86-82F8-9F75AF6F5DFC"},{"resourceId":"sid-309125B0-5FC7-4336-B75B-943B19A0695E"}],"bounds":{"lowerRight":{"x":295,"y":200},"upperLeft":{"x":195,"y":120}},"dockers":[]},{"resourceId":"sid-74F252CD-466F-40FD-B3CB-46F431838C52","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-8376E442-6C90-4BA5-9679-76832BFFBCFE"}],"bounds":{"lowerRight":{"x":194.3515625,"y":160},"upperLeft":{"x":105.53125,"y":160}},"dockers":[{"x":15,"y":15},{"x":50,"y":40}],"target":{"resourceId":"sid-8376E442-6C90-4BA5-9679-76832BFFBCFE"}},{"resourceId":"sid-AE50420B-9BC2-4564-9F3A-EBCC6B8607E0","properties":{"overrideid":"","name":"Approver","usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"user","assignee":{"email":"CLUSTER_HIERARCHY_APPROVER","firstName":"CLUSTER_HIERARCHY_APPROVER","fullName":"CLUSTER_HIERARCHY_APPROVER","id":"CLUSTER_HIERARCHY_APPROVER","roledesc":"Role for Cluster Hierarch approver","$$hashKey":"object:6190"}}}},"additionalforms":"","formkeydefinition":"","allowrevert":"","prioritydefinition":"Role Queue","baseactor":"","duedatedefinition":"","multiinstance_type":"None","isforcompensation":"false"},"stencil":{"id":"UserTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-1959D581-E09E-4A89-9605-F58226759DFA"}],"bounds":{"lowerRight":{"x":535,"y":200},"upperLeft":{"x":435,"y":120}},"dockers":[]},{"resourceId":"sid-8C9DB173-3F79-4961-9A45-9BF082A188FA","properties":{"overrideid":"","name":"Reject","rerunnable":true,"servicetaskexpression":"doReject","isforcompensation":"false","multiinstance_type":"None","parameters":""},"stencil":{"id":"rejectTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-140C3E87-AC95-4CB3-A7A3-C5129EE28FFD"}],"bounds":{"lowerRight":{"x":655,"y":380},"upperLeft":{"x":555,"y":300}},"dockers":[]},{"resourceId":"sid-881A751D-7F58-4AB7-A917-3F94333E751D","properties":{"overrideid":"","name":"Approve","rerunnable":true,"servicetaskexpression":"doApprove","isforcompensation":"false","multiinstance_type":"None","parameters":""},"stencil":{"id":"approveTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-E59CF2A4-FD0E-438A-82B8-199C8EF0FF6F"}],"bounds":{"lowerRight":{"x":940,"y":200},"upperLeft":{"x":840,"y":120}},"dockers":[]},{"resourceId":"sid-0D2F11AC-5514-467D-A7DB-E06A355935A4","properties":{"overrideid":"","name":"Approved"},"stencil":{"id":"EndNoneEvent"},"childShapes":[],"outgoing":[],"bounds":{"lowerRight":{"x":904,"y":283},"upperLeft":{"x":876,"y":255}},"dockers":[]},{"resourceId":"sid-12906A00-9679-4401-B7FD-604F520BF9BB","properties":{"overrideid":"","name":"Rejected"},"stencil":{"id":"EndNoneEvent"},"childShapes":[],"outgoing":[],"bounds":{"lowerRight":{"x":748,"y":354},"upperLeft":{"x":720,"y":326}},"dockers":[]},{"resourceId":"sid-140C3E87-AC95-4CB3-A7A3-C5129EE28FFD","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-12906A00-9679-4401-B7FD-604F520BF9BB"}],"bounds":{"lowerRight":{"x":719.8984375,"y":340},"upperLeft":{"x":655.3828125,"y":340}},"dockers":[{"x":50,"y":40},{"x":14,"y":14}],"target":{"resourceId":"sid-12906A00-9679-4401-B7FD-604F520BF9BB"}},{"resourceId":"sid-E59CF2A4-FD0E-438A-82B8-199C8EF0FF6F","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-0D2F11AC-5514-467D-A7DB-E06A355935A4"}],"bounds":{"lowerRight":{"x":890,"y":254.375},"upperLeft":{"x":890,"y":200.171875}},"dockers":[{"x":50,"y":40},{"x":14,"y":14}],"target":{"resourceId":"sid-0D2F11AC-5514-467D-A7DB-E06A355935A4"}},{"resourceId":"sid-8DD10A02-C503-4046-BCED-363CB48D47CD","properties":{"overrideid":"","name":"","sequencefloworder":""},"stencil":{"id":"ExclusiveGateway"},"childShapes":[],"outgoing":[{"resourceId":"sid-A72E7B39-F92C-4846-903F-D51DB5001D26"},{"resourceId":"sid-BB98FABB-54FB-49F5-B598-BB30D09F97D9"},{"resourceId":"sid-A6AC48CB-BC3C-4D46-8FD7-74672EAFEDF0"}],"bounds":{"lowerRight":{"x":625,"y":180},"upperLeft":{"x":585,"y":140}},"dockers":[]},{"resourceId":"sid-1959D581-E09E-4A89-9605-F58226759DFA","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-8DD10A02-C503-4046-BCED-363CB48D47CD"}],"bounds":{"lowerRight":{"x":584.7304773585561,"y":160.41381940812678},"upperLeft":{"x":535.8945226414439,"y":160.21118059187322}},"dockers":[{"x":50,"y":40},{"x":20.5,"y":20.5}],"target":{"resourceId":"sid-8DD10A02-C503-4046-BCED-363CB48D47CD"}},{"resourceId":"sid-FB18F2FF-C83A-4B86-82F8-9F75AF6F5DFC","properties":{"overrideid":"","name":"Submit","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Submitted'"}},"defaultflow":"false","action":"Submit","state":"Submitted","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-AE50420B-9BC2-4564-9F3A-EBCC6B8607E0"}],"bounds":{"lowerRight":{"x":434.40716552734375,"y":160},"upperLeft":{"x":295.8111572265625,"y":160}},"dockers":[{"x":50,"y":40},{"x":15.671875,"y":40}],"target":{"resourceId":"sid-AE50420B-9BC2-4564-9F3A-EBCC6B8607E0"}},{"resourceId":"sid-A72E7B39-F92C-4846-903F-D51DB5001D26","properties":{"overrideid":"","name":"Approve","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Approved'"}},"defaultflow":"false","action":"Approve","state":"Approved","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-881A751D-7F58-4AB7-A917-3F94333E751D"}],"bounds":{"lowerRight":{"x":839.5458999818455,"y":160.46503940846986},"upperLeft":{"x":625.3925765806545,"y":160.08867152903014}},"dockers":[{"x":20.5,"y":20.5},{"x":50,"y":40}],"target":{"resourceId":"sid-881A751D-7F58-4AB7-A917-3F94333E751D"}},{"resourceId":"sid-BB98FABB-54FB-49F5-B598-BB30D09F97D9","properties":{"overrideid":"","name":"Reject","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Rejected'"}},"defaultflow":"false","action":"Reject","state":"Rejected","mandatenotes":true,"capturereasons":false,"typeofreason":"Reject","constraint":"","reason":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-8C9DB173-3F79-4961-9A45-9BF082A188FA"}],"bounds":{"lowerRight":{"x":605.4444801204861,"y":299.73437887952525},"upperLeft":{"x":605.1121605045139,"y":180.43163674547478}},"dockers":[{"x":20.5,"y":20.5},{"x":50,"y":40}],"target":{"resourceId":"sid-8C9DB173-3F79-4961-9A45-9BF082A188FA"}},{"resourceId":"sid-309125B0-5FC7-4336-B75B-943B19A0695E","properties":{"overrideid":"","name":"Cancel","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Cancelled'"}},"defaultflow":"false","action":"Cancel","state":"Cancelled","mandatenotes":true,"capturereasons":false,"typeofreason":"Reject","constraint":"","showdiamondmarker":false,"reason":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-8C9DB173-3F79-4961-9A45-9BF082A188FA"}],"bounds":{"lowerRight":{"x":554.7213046008977,"y":340},"upperLeft":{"x":244.5615422237089,"y":200.99446286099658}},"dockers":[{"x":49.5615422237089,"y":33.32595048132879},{"x":244.5615422237089,"y":340},{"x":50,"y":40}],"target":{"resourceId":"sid-8C9DB173-3F79-4961-9A45-9BF082A188FA"}},{"resourceId":"sid-A6AC48CB-BC3C-4D46-8FD7-74672EAFEDF0","properties":{"overrideid":"","name":"Resubmit","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Resubmitted'"}},"defaultflow":"false","action":"Resubmit","state":"Resubmitted","mandatenotes":true,"capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-8376E442-6C90-4BA5-9679-76832BFFBCFE"}],"bounds":{"lowerRight":{"x":605.5,"y":139.0859375},"upperLeft":{"x":245,"y":60}},"dockers":[{"x":20.5,"y":20.5},{"x":605.5,"y":60},{"x":245,"y":60},{"x":50,"y":40}],"target":{"resourceId":"sid-8376E442-6C90-4BA5-9679-76832BFFBCFE"}}],"bounds":{"lowerRight":{"x":1200,"y":1050},"upperLeft":{"x":0,"y":0}},"stencilset":{"url":"stencilsets/bpmn2.0/bpmn2.0.json","namespace":"http://b3mn.org/stencilset/bpmn2.0#"},"ssextensions":[]}]]></column>
			<column name="WORKFLOWXML" type="CLOB"><![CDATA[<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://activiti.org/test"><process id="CLUSTER_HIERARCHY" name="CLUSTER_HIERARCHY" isExecutable="true"><documentation>Cluster Hierarchy Workflow</documentation><startEvent id="startEvent1" name="Start"/><userTask id="sid-8376E442-6C90-4BA5-9679-76832BFFBCFE" name="Maker" activiti:actor="CLUSTER_HIERARCHY_MAKER" activiti:assignmentLevel="Role Queue"/><sequenceFlow id="sid-74F252CD-466F-40FD-B3CB-46F431838C52" sourceRef="startEvent1" targetRef="sid-8376E442-6C90-4BA5-9679-76832BFFBCFE" representsUserAction="false" mandateNotes="false" captureReasons="false"/><userTask id="sid-AE50420B-9BC2-4564-9F3A-EBCC6B8607E0" name="Approver" activiti:actor="CLUSTER_HIERARCHY_APPROVER" activiti:assignmentLevel="Role Queue"/><serviceTask id="sid-8C9DB173-3F79-4961-9A45-9BF082A188FA" name="Reject" activiti:operation="doReject" activiti:rerunnable="true"/><serviceTask id="sid-881A751D-7F58-4AB7-A917-3F94333E751D" name="Approve" activiti:operation="doApprove" activiti:rerunnable="true"/><endEvent id="sid-0D2F11AC-5514-467D-A7DB-E06A355935A4" name="Approved"/><endEvent id="sid-12906A00-9679-4401-B7FD-604F520BF9BB" name="Rejected"/><sequenceFlow id="sid-140C3E87-AC95-4CB3-A7A3-C5129EE28FFD" sourceRef="sid-8C9DB173-3F79-4961-9A45-9BF082A188FA" targetRef="sid-12906A00-9679-4401-B7FD-604F520BF9BB" representsUserAction="false" mandateNotes="false" captureReasons="false"/><sequenceFlow id="sid-E59CF2A4-FD0E-438A-82B8-199C8EF0FF6F" sourceRef="sid-881A751D-7F58-4AB7-A917-3F94333E751D" targetRef="sid-0D2F11AC-5514-467D-A7DB-E06A355935A4" representsUserAction="false" mandateNotes="false" captureReasons="false"/><exclusiveGateway id="sid-8DD10A02-C503-4046-BCED-363CB48D47CD"/><sequenceFlow id="sid-1959D581-E09E-4A89-9605-F58226759DFA" sourceRef="sid-AE50420B-9BC2-4564-9F3A-EBCC6B8607E0" targetRef="sid-8DD10A02-C503-4046-BCED-363CB48D47CD" representsUserAction="false" mandateNotes="false" captureReasons="false"/><sequenceFlow id="sid-FB18F2FF-C83A-4B86-82F8-9F75AF6F5DFC" name="Submit" sourceRef="sid-8376E442-6C90-4BA5-9679-76832BFFBCFE" targetRef="sid-AE50420B-9BC2-4564-9F3A-EBCC6B8607E0" action="Submit" state="Submitted" representsUserAction="true" mandateNotes="false" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Submitted'</conditionExpression></sequenceFlow><sequenceFlow id="sid-A72E7B39-F92C-4846-903F-D51DB5001D26" name="Approve" sourceRef="sid-8DD10A02-C503-4046-BCED-363CB48D47CD" targetRef="sid-881A751D-7F58-4AB7-A917-3F94333E751D" action="Approve" state="Approved" representsUserAction="true" mandateNotes="false" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Approved'</conditionExpression></sequenceFlow><sequenceFlow id="sid-BB98FABB-54FB-49F5-B598-BB30D09F97D9" name="Reject" sourceRef="sid-8DD10A02-C503-4046-BCED-363CB48D47CD" targetRef="sid-8C9DB173-3F79-4961-9A45-9BF082A188FA" action="Reject" state="Rejected" representsUserAction="true" mandateNotes="true" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Rejected'</conditionExpression></sequenceFlow><sequenceFlow id="sid-309125B0-5FC7-4336-B75B-943B19A0695E" name="Cancel" sourceRef="sid-8376E442-6C90-4BA5-9679-76832BFFBCFE" targetRef="sid-8C9DB173-3F79-4961-9A45-9BF082A188FA" action="Cancel" state="Cancelled" representsUserAction="true" mandateNotes="true" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Cancelled'</conditionExpression></sequenceFlow><sequenceFlow id="sid-A6AC48CB-BC3C-4D46-8FD7-74672EAFEDF0" name="Resubmit" sourceRef="sid-8DD10A02-C503-4046-BCED-363CB48D47CD" targetRef="sid-8376E442-6C90-4BA5-9679-76832BFFBCFE" action="Resubmit" state="Resubmitted" representsUserAction="true" mandateNotes="true" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Resubmitted'</conditionExpression></sequenceFlow></process><bpmndi:BPMNDiagram id="BPMNDiagram_CLUSTER_HIERARCHY"><bpmndi:BPMNPlane bpmnElement="CLUSTER_HIERARCHY" id="BPMNPlane_CLUSTER_HIERARCHY"><bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1"><omgdc:Bounds height="30.0" width="30.0" x="75.0" y="145.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-8376E442-6C90-4BA5-9679-76832BFFBCFE" id="BPMNShape_sid-8376E442-6C90-4BA5-9679-76832BFFBCFE"><omgdc:Bounds height="80.0" width="100.0" x="195.0" y="120.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-AE50420B-9BC2-4564-9F3A-EBCC6B8607E0" id="BPMNShape_sid-AE50420B-9BC2-4564-9F3A-EBCC6B8607E0"><omgdc:Bounds height="80.0" width="100.0" x="435.0" y="120.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-8C9DB173-3F79-4961-9A45-9BF082A188FA" id="BPMNShape_sid-8C9DB173-3F79-4961-9A45-9BF082A188FA"><omgdc:Bounds height="80.0" width="100.0" x="555.0" y="300.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-881A751D-7F58-4AB7-A917-3F94333E751D" id="BPMNShape_sid-881A751D-7F58-4AB7-A917-3F94333E751D"><omgdc:Bounds height="80.0" width="100.0" x="840.0" y="120.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-0D2F11AC-5514-467D-A7DB-E06A355935A4" id="BPMNShape_sid-0D2F11AC-5514-467D-A7DB-E06A355935A4"><omgdc:Bounds height="28.0" width="28.0" x="876.0" y="255.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-12906A00-9679-4401-B7FD-604F520BF9BB" id="BPMNShape_sid-12906A00-9679-4401-B7FD-604F520BF9BB"><omgdc:Bounds height="28.0" width="28.0" x="720.0" y="326.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-8DD10A02-C503-4046-BCED-363CB48D47CD" id="BPMNShape_sid-8DD10A02-C503-4046-BCED-363CB48D47CD"><omgdc:Bounds height="40.0" width="40.0" x="585.0" y="140.0"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement="sid-74F252CD-466F-40FD-B3CB-46F431838C52" id="BPMNEdge_sid-74F252CD-466F-40FD-B3CB-46F431838C52"><omgdi:waypoint x="105.0" y="160.0"/><omgdi:waypoint x="195.0" y="160.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-140C3E87-AC95-4CB3-A7A3-C5129EE28FFD" id="BPMNEdge_sid-140C3E87-AC95-4CB3-A7A3-C5129EE28FFD"><omgdi:waypoint x="655.0" y="340.0"/><omgdi:waypoint x="720.0" y="340.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-BB98FABB-54FB-49F5-B598-BB30D09F97D9" id="BPMNEdge_sid-BB98FABB-54FB-49F5-B598-BB30D09F97D9"><omgdi:waypoint x="605.4469273743017" y="179.55307262569832"/><omgdi:waypoint x="605.1114206128134" y="300.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-309125B0-5FC7-4336-B75B-943B19A0695E" id="BPMNEdge_sid-309125B0-5FC7-4336-B75B-943B19A0695E"><omgdi:waypoint x="244.5615422237089" y="200.0"/><omgdi:waypoint x="244.5615422237089" y="340.0"/><omgdi:waypoint x="555.0" y="340.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-A72E7B39-F92C-4846-903F-D51DB5001D26" id="BPMNEdge_sid-A72E7B39-F92C-4846-903F-D51DB5001D26"><omgdi:waypoint x="624.5334507042254" y="160.46654929577466"/><omgdi:waypoint x="840.0" y="160.08787346221442"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-E59CF2A4-FD0E-438A-82B8-199C8EF0FF6F" id="BPMNEdge_sid-E59CF2A4-FD0E-438A-82B8-199C8EF0FF6F"><omgdi:waypoint x="890.0" y="200.0"/><omgdi:waypoint x="890.0" y="255.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-FB18F2FF-C83A-4B86-82F8-9F75AF6F5DFC" id="BPMNEdge_sid-FB18F2FF-C83A-4B86-82F8-9F75AF6F5DFC"><omgdi:waypoint x="295.0" y="160.0"/><omgdi:waypoint x="435.0" y="160.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-A6AC48CB-BC3C-4D46-8FD7-74672EAFEDF0" id="BPMNEdge_sid-A6AC48CB-BC3C-4D46-8FD7-74672EAFEDF0"><omgdi:waypoint x="605.5" y="140.5"/><omgdi:waypoint x="605.5" y="60.0"/><omgdi:waypoint x="245.0" y="60.0"/><omgdi:waypoint x="245.0" y="120.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-1959D581-E09E-4A89-9605-F58226759DFA" id="BPMNEdge_sid-1959D581-E09E-4A89-9605-F58226759DFA"><omgdi:waypoint x="535.0" y="160.20746887966806"/><omgdi:waypoint x="585.4166666666666" y="160.41666666666666"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>]]></column>
			<where>workflowtype='CLUSTER_HIERARCHY'and workflowactive=1</where>
		</update>
	</changeSet>

	<changeSet id="18" author="Amanullah.m">
		<sql>
			UPDATE SeqWorkFlowDetails SET SEQNO= (SELECT MAX(WorkflowId)+1 FROM workflowdetails);
		</sql>
	</changeSet>

	<changeSet id="19" author="Amanullah.m">
		<sql>
			UPDATE SeqWorkFlowDetails SET SEQNO= (SELECT MAX(WorkflowId)+1 FROM workflowdetails);
		</sql>
		<insert tableName="WorkFlowDetails">
			<column name="WorkFlowId" valueComputed="(select max(WorkFlowId) + 1 from WorkFlowDetails)" />
			<column name="WorkFlowType">CLUSTERS</column>
			<column name="WorkFlowSubType">CLUSTER_HIERARCHY</column>
			<column name="WorkFlowDesc">Cluster Hierarchy Workflow</column>
			<column name="JsonDesign" type="nclob"><![CDATA[NULL]]></column>
			<column name="SvgDesign" type="nclob"><![CDATA[NULL]]></column>
			<column name="WorkFlowXml" type="clob"><![CDATA[NULL]]></column>
			<column name="WorkFlowRoles">CLUSTER_MAKER;CLUSTER_APPROVER</column>
			<column name="FirstTaskOwner">CLUSTER_MAKER</column>
			<column name="WorkFlowActive">1</column>
			<column name="Version">5</column>
			<column name="LastMntBy">1000</column>
			<column name="LastMntOn" valueDate="current_timestamp" />
			<column name="RecordStatus">Null</column>
			<column name="RoleCode">Null</column>
			<column name="NextRoleCode">Null</column>
			<column name="TaskId">Null</column>
			<column name="NextTaskId">Null</column>
			<column name="RecordType">NULL</column>
		</insert>
	</changeSet>

	<changeSet id="20" author="Amanullah.m">
		<update tableName="WORKFLOWDETAILS">
			<column name="JSONDESIGN" type="NCLOB"><![CDATA[{"resourceId":"canvas","properties":{"process_id":"CLUSTERS","name":"CLUSTERS","documentation":"Clusters_Workflow","category":"","listenerclass":"","listenerentitytype":""},"stencil":{"id":"BPMNDiagram"},"childShapes":[{"resourceId":"startEvent1","properties":{"overrideid":"","name":"Start"},"stencil":{"id":"StartNoneEvent"},"childShapes":[],"outgoing":[{"resourceId":"sid-1ECFD3BF-6C57-4630-9CA3-1DA3629A6886"}],"bounds":{"lowerRight":{"x":119.03004823467553,"y":173.70673097956737},"upperLeft":{"x":89.03004823467553,"y":143.70673097956737}},"dockers":[]},{"resourceId":"sid-F6E93EEA-F708-491D-ADC8-AB271F45B758","properties":{"overrideid":"","name":"Maker","usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"user","assignee":{"email":"CLUSTER_MAKER","firstName":"CLUSTER_MAKER","fullName":"CLUSTER_MAKER","id":"CLUSTER_MAKER","roledesc":"Role for Cluster maker","$$hashKey":"object:8868"}}}},"additionalforms":"","formkeydefinition":"","allowrevert":"","prioritydefinition":"Role Queue","baseactor":"","duedatedefinition":"","multiinstance_type":"None","isforcompensation":"false"},"stencil":{"id":"UserTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-49E8BC23-1882-4AA6-A8A5-D008C1056667"},{"resourceId":"sid-2250C9DB-2AF8-4073-BE20-861B78B6F3DA"}],"bounds":{"lowerRight":{"x":263.22175509690516,"y":198.7067309795674},"upperLeft":{"x":163.22175509690518,"y":118.70673097956741}},"dockers":[]},{"resourceId":"sid-FE95DAF5-F881-4DEB-826E-5CD2914B566F","properties":{"overrideid":"","name":"Approver","usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"user","assignee":{"email":"CLUSTER_APPROVER","firstName":"CLUSTER_APPROVER","fullName":"CLUSTER_APPROVER","id":"CLUSTER_APPROVER","roledesc":"Role for Cluster approver","$$hashKey":"object:10125"}}}},"additionalforms":"","formkeydefinition":"","allowrevert":"","prioritydefinition":"Role Queue","baseactor":"","duedatedefinition":"","multiinstance_type":"None","isforcompensation":"false"},"stencil":{"id":"UserTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-FFD0A79C-7C1A-4A23-8ACC-341AC2CB192C"}],"bounds":{"lowerRight":{"x":485.79687568359395,"y":198.7067309795674},"upperLeft":{"x":385.79687568359395,"y":118.7067309795674}},"dockers":[]},{"resourceId":"sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767","properties":{"overrideid":"","name":"","sequencefloworder":""},"stencil":{"id":"ExclusiveGateway"},"childShapes":[],"outgoing":[{"resourceId":"sid-A97D50C8-C1FE-46DE-96BA-48D7E5CF2DDC"},{"resourceId":"sid-9FCFC0CF-1ABA-4C29-94AC-59C9A981DFDF"},{"resourceId":"sid-0BB7400B-2040-4045-BAA5-E4B56D22BD5B"}],"bounds":{"lowerRight":{"x":610.0000000000009,"y":178.70673097956737},"upperLeft":{"x":570.0000000000009,"y":138.70673097956737}},"dockers":[]},{"resourceId":"sid-FFD0A79C-7C1A-4A23-8ACC-341AC2CB192C","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767"}],"bounds":{"lowerRight":{"x":569.5578056039496,"y":159.13904587466538},"upperLeft":{"x":486.3502149683324,"y":158.8701192094694}},"dockers":[{"x":50,"y":40},{"x":20.5,"y":20.5}],"target":{"resourceId":"sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767"}},{"resourceId":"sid-9E46C723-1A4B-4A14-ADC0-DB3D1E3C88B6","properties":{"overrideid":"","name":"Approved"},"stencil":{"id":"EndNoneEvent"},"childShapes":[],"outgoing":[],"bounds":{"lowerRight":{"x":918.3004823467552,"y":235.7367792142429},"upperLeft":{"x":890.3004823467552,"y":207.7367792142429}},"dockers":[]},{"resourceId":"sid-35F214EA-C941-4A18-A8D7-FCD8CC2B6011","properties":{"overrideid":"","name":"Rejected"},"stencil":{"id":"EndNoneEvent"},"childShapes":[],"outgoing":[],"bounds":{"lowerRight":{"x":829.2704341120799,"y":306.2518033315806},"upperLeft":{"x":801.2704341120799,"y":278.2518033315807}},"dockers":[]},{"resourceId":"sid-1ECFD3BF-6C57-4630-9CA3-1DA3629A6886","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-F6E93EEA-F708-491D-ADC8-AB271F45B758"}],"bounds":{"lowerRight":{"x":162.49924639659858,"y":158.7067309795674},"upperLeft":{"x":119.30265579353704,"y":158.7067309795674}},"dockers":[{"x":15.000000000000002,"y":15},{"x":42.302391334118965,"y":40.000000000000014}],"target":{"resourceId":"sid-F6E93EEA-F708-491D-ADC8-AB271F45B758"}},{"resourceId":"sid-D2409A9D-5FD1-4616-B72E-5AEB0B19AFFA","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-9E46C723-1A4B-4A14-ADC0-DB3D1E3C88B6"}],"bounds":{"lowerRight":{"x":904.3004823467552,"y":207.06451541667067},"upperLeft":{"x":813.9497145834117,"y":173.12428571176383}},"dockers":[{"x":60.88147250375778,"y":54.41755473219642},{"x":904.3004823467552,"y":173.12428571176383},{"x":14,"y":14}],"target":{"resourceId":"sid-9E46C723-1A4B-4A14-ADC0-DB3D1E3C88B6"}},{"resourceId":"sid-FF38638B-2E5E-4802-A5F5-0D68E1E61F74","properties":{"overrideid":"","name":"Approve","rerunnable":true,"servicetaskexpression":"doApprove","isforcompensation":"false","multiinstance_type":"None","parameters":""},"stencil":{"id":"approveTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-D2409A9D-5FD1-4616-B72E-5AEB0B19AFFA"}],"bounds":{"lowerRight":{"x":813.4979179129089,"y":198.7067309795674},"upperLeft":{"x":713.4979179129089,"y":118.70673097956741}},"dockers":[]},{"resourceId":"sid-13579F37-5326-4168-AAC2-1C06003F43CD","properties":{"overrideid":"","name":"Reject","rerunnable":true,"servicetaskexpression":"doReject","isforcompensation":"false","multiinstance_type":"None","parameters":""},"stencil":{"id":"rejectTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-148440E5-7616-4BAB-9A2B-20A92F4643CB"}],"bounds":{"lowerRight":{"x":640.000000000001,"y":332.2518033315806},"upperLeft":{"x":540.000000000001,"y":252.25180333158065}},"dockers":[]},{"resourceId":"sid-148440E5-7616-4BAB-9A2B-20A92F4643CB","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-35F214EA-C941-4A18-A8D7-FCD8CC2B6011"}],"bounds":{"lowerRight":{"x":801.0709946133253,"y":292.2518033315806},"upperLeft":{"x":640.2779074620182,"y":292.2518033315806}},"dockers":[{"x":50,"y":39.99999999999997},{"x":14,"y":14}],"target":{"resourceId":"sid-35F214EA-C941-4A18-A8D7-FCD8CC2B6011"}},{"resourceId":"sid-49E8BC23-1882-4AA6-A8A5-D008C1056667","properties":{"overrideid":"","name":"Submit","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Submitted'"}},"defaultflow":"false","action":"Submit","state":"Submitted","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-FE95DAF5-F881-4DEB-826E-5CD2914B566F"}],"bounds":{"lowerRight":{"x":385.239133990464,"y":158.7067309795674},"upperLeft":{"x":263.77949679003507,"y":158.7067309795674}},"dockers":[{"x":49.999999999999986,"y":39.99999999999999},{"x":50,"y":39.99999999999999}],"target":{"resourceId":"sid-FE95DAF5-F881-4DEB-826E-5CD2914B566F"}},{"resourceId":"sid-2250C9DB-2AF8-4073-BE20-861B78B6F3DA","properties":{"overrideid":"","name":"Cancel","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Cancelled'"}},"defaultflow":"false","action":"Cancel","state":"Cancelled","mandatenotes":true,"capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-13579F37-5326-4168-AAC2-1C06003F43CD"}],"bounds":{"lowerRight":{"x":539.5246058647058,"y":292.25180333158073},"upperLeft":{"x":213.22175509690516,"y":199.35292433407133}},"dockers":[{"x":49.999999999999986,"y":39.99999999999999},{"x":213.22175509690516,"y":292.25180333158073},{"x":37.52405856019527,"y":40.000000000000085}],"target":{"resourceId":"sid-13579F37-5326-4168-AAC2-1C06003F43CD"}},{"resourceId":"sid-A97D50C8-C1FE-46DE-96BA-48D7E5CF2DDC","properties":{"overrideid":"","name":"Approve","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Approved'"}},"defaultflow":"false","action":"Approve","state":"Approved","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-FF38638B-2E5E-4802-A5F5-0D68E1E61F74"}],"bounds":{"lowerRight":{"x":713.1031229232203,"y":159.20673097956737},"upperLeft":{"x":610.1570751582227,"y":159.20673097956737}},"dockers":[{"x":20.5,"y":20.5},{"x":26.258683352866456,"y":40.49999999999996}],"target":{"resourceId":"sid-FF38638B-2E5E-4802-A5F5-0D68E1E61F74"}},{"resourceId":"sid-9FCFC0CF-1ABA-4C29-94AC-59C9A981DFDF","properties":{"overrideid":"","name":"Resubmit","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Resubmitted'"}},"defaultflow":"false","action":"Resubmit","state":"Resubmitted","mandatenotes":true,"capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-F6E93EEA-F708-491D-ADC8-AB271F45B758"}],"bounds":{"lowerRight":{"x":590.5000000000009,"y":138.2798648206959},"upperLeft":{"x":213.22175509690516,"y":43.26860060067894}},"dockers":[{"x":20.5,"y":20.5},{"x":590.5000000000009,"y":43.26860060067894},{"x":213.22175509690516,"y":43.26860060067894},{"x":49.99999999999997,"y":40.500000000000014}],"target":{"resourceId":"sid-F6E93EEA-F708-491D-ADC8-AB271F45B758"}},{"resourceId":"sid-0BB7400B-2040-4045-BAA5-E4B56D22BD5B","properties":{"overrideid":"","name":"Reject","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Rejected'"}},"defaultflow":"false","action":"Reject","state":"Rejected","mandatenotes":true,"capturereasons":false,"typeofreason":"Reject","constraint":"","reason":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-13579F37-5326-4168-AAC2-1C06003F43CD"}],"bounds":{"lowerRight":{"x":590.4259294016338,"y":251.75405453875328},"upperLeft":{"x":590.152195598368,"y":178.91618721739263}},"dockers":[{"x":20.5,"y":20.5},{"x":50,"y":39.99999999999997}],"target":{"resourceId":"sid-13579F37-5326-4168-AAC2-1C06003F43CD"}}],"bounds":{"lowerRight":{"x":1200,"y":1050},"upperLeft":{"x":0,"y":0}},"stencilset":{"url":"stencilsets/bpmn2.0/bpmn2.0.json","namespace":"http://b3mn.org/stencilset/bpmn2.0#"},"ssextensions":[]}]]></column>
			<column name="WORKFLOWXML" type="CLOB"><![CDATA[<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://activiti.org/test"><process id="CLUSTERS" name="CLUSTERS" isExecutable="true"><documentation>Clusters_Workflow</documentation><startEvent id="startEvent1" name="Start"/><userTask id="sid-F6E93EEA-F708-491D-ADC8-AB271F45B758" name="Maker" activiti:actor="CLUSTER_MAKER" activiti:assignmentLevel="Role Queue"/><userTask id="sid-FE95DAF5-F881-4DEB-826E-5CD2914B566F" name="Approver" activiti:actor="CLUSTER_APPROVER" activiti:assignmentLevel="Role Queue"/><exclusiveGateway id="sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767"/><sequenceFlow id="sid-FFD0A79C-7C1A-4A23-8ACC-341AC2CB192C" sourceRef="sid-FE95DAF5-F881-4DEB-826E-5CD2914B566F" targetRef="sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767" representsUserAction="false" mandateNotes="false" captureReasons="false"/><endEvent id="sid-9E46C723-1A4B-4A14-ADC0-DB3D1E3C88B6" name="Approved"/><endEvent id="sid-35F214EA-C941-4A18-A8D7-FCD8CC2B6011" name="Rejected"/><sequenceFlow id="sid-1ECFD3BF-6C57-4630-9CA3-1DA3629A6886" sourceRef="startEvent1" targetRef="sid-F6E93EEA-F708-491D-ADC8-AB271F45B758" representsUserAction="false" mandateNotes="false" captureReasons="false"/><sequenceFlow id="sid-D2409A9D-5FD1-4616-B72E-5AEB0B19AFFA" sourceRef="sid-FF38638B-2E5E-4802-A5F5-0D68E1E61F74" targetRef="sid-9E46C723-1A4B-4A14-ADC0-DB3D1E3C88B6" representsUserAction="false" mandateNotes="false" captureReasons="false"/><serviceTask id="sid-FF38638B-2E5E-4802-A5F5-0D68E1E61F74" name="Approve" activiti:operation="doApprove" activiti:rerunnable="true"/><serviceTask id="sid-13579F37-5326-4168-AAC2-1C06003F43CD" name="Reject" activiti:operation="doReject" activiti:rerunnable="true"/><sequenceFlow id="sid-148440E5-7616-4BAB-9A2B-20A92F4643CB" sourceRef="sid-13579F37-5326-4168-AAC2-1C06003F43CD" targetRef="sid-35F214EA-C941-4A18-A8D7-FCD8CC2B6011" representsUserAction="false" mandateNotes="false" captureReasons="false"/><sequenceFlow id="sid-49E8BC23-1882-4AA6-A8A5-D008C1056667" name="Submit" sourceRef="sid-F6E93EEA-F708-491D-ADC8-AB271F45B758" targetRef="sid-FE95DAF5-F881-4DEB-826E-5CD2914B566F" action="Submit" state="Submitted" representsUserAction="true" mandateNotes="false" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Submitted'</conditionExpression></sequenceFlow><sequenceFlow id="sid-2250C9DB-2AF8-4073-BE20-861B78B6F3DA" name="Cancel" sourceRef="sid-F6E93EEA-F708-491D-ADC8-AB271F45B758" targetRef="sid-13579F37-5326-4168-AAC2-1C06003F43CD" action="Cancel" state="Cancelled" representsUserAction="true" mandateNotes="true" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Cancelled'</conditionExpression></sequenceFlow><sequenceFlow id="sid-A97D50C8-C1FE-46DE-96BA-48D7E5CF2DDC" name="Approve" sourceRef="sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767" targetRef="sid-FF38638B-2E5E-4802-A5F5-0D68E1E61F74" action="Approve" state="Approved" representsUserAction="true" mandateNotes="false" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Approved'</conditionExpression></sequenceFlow><sequenceFlow id="sid-9FCFC0CF-1ABA-4C29-94AC-59C9A981DFDF" name="Resubmit" sourceRef="sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767" targetRef="sid-F6E93EEA-F708-491D-ADC8-AB271F45B758" action="Resubmit" state="Resubmitted" representsUserAction="true" mandateNotes="true" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Resubmitted'</conditionExpression></sequenceFlow><sequenceFlow id="sid-0BB7400B-2040-4045-BAA5-E4B56D22BD5B" name="Reject" sourceRef="sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767" targetRef="sid-13579F37-5326-4168-AAC2-1C06003F43CD" action="Reject" state="Rejected" representsUserAction="true" mandateNotes="true" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Rejected'</conditionExpression></sequenceFlow></process><bpmndi:BPMNDiagram id="BPMNDiagram_CLUSTERS"><bpmndi:BPMNPlane bpmnElement="CLUSTERS" id="BPMNPlane_CLUSTERS"><bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1"><omgdc:Bounds height="30.0" width="30.0" x="89.03004823467553" y="143.70673097956737"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-F6E93EEA-F708-491D-ADC8-AB271F45B758" id="BPMNShape_sid-F6E93EEA-F708-491D-ADC8-AB271F45B758"><omgdc:Bounds height="79.99999999999999" width="99.99999999999997" x="163.22175509690518" y="118.70673097956741"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-FE95DAF5-F881-4DEB-826E-5CD2914B566F" id="BPMNShape_sid-FE95DAF5-F881-4DEB-826E-5CD2914B566F"><omgdc:Bounds height="80.0" width="100.0" x="385.79687568359395" y="118.7067309795674"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767" id="BPMNShape_sid-3167C17F-9BAF-48D4-8CE5-DECEA931C767"><omgdc:Bounds height="40.0" width="40.0" x="570.0000000000009" y="138.70673097956737"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-9E46C723-1A4B-4A14-ADC0-DB3D1E3C88B6" id="BPMNShape_sid-9E46C723-1A4B-4A14-ADC0-DB3D1E3C88B6"><omgdc:Bounds height="28.0" width="28.0" x="890.3004823467552" y="207.7367792142429"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-35F214EA-C941-4A18-A8D7-FCD8CC2B6011" id="BPMNShape_sid-35F214EA-C941-4A18-A8D7-FCD8CC2B6011"><omgdc:Bounds height="27.999999999999943" width="28.0" x="801.2704341120799" y="278.2518033315807"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-FF38638B-2E5E-4802-A5F5-0D68E1E61F74" id="BPMNShape_sid-FF38638B-2E5E-4802-A5F5-0D68E1E61F74"><omgdc:Bounds height="79.99999999999999" width="100.0" x="713.4979179129089" y="118.70673097956741"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-13579F37-5326-4168-AAC2-1C06003F43CD" id="BPMNShape_sid-13579F37-5326-4168-AAC2-1C06003F43CD"><omgdc:Bounds height="79.99999999999997" width="100.0" x="540.000000000001" y="252.25180333158065"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement="sid-148440E5-7616-4BAB-9A2B-20A92F4643CB" id="BPMNEdge_sid-148440E5-7616-4BAB-9A2B-20A92F4643CB"><omgdi:waypoint x="640.000000000001" y="292.2518033315806"/><omgdi:waypoint x="801.2704341120799" y="292.2518033315807"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-1ECFD3BF-6C57-4630-9CA3-1DA3629A6886" id="BPMNEdge_sid-1ECFD3BF-6C57-4630-9CA3-1DA3629A6886"><omgdi:waypoint x="119.03004823467553" y="158.70673097956737"/><omgdi:waypoint x="163.22175509690518" y="158.7067309795674"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-2250C9DB-2AF8-4073-BE20-861B78B6F3DA" id="BPMNEdge_sid-2250C9DB-2AF8-4073-BE20-861B78B6F3DA"><omgdi:waypoint x="213.22175509690516" y="198.7067309795674"/><omgdi:waypoint x="213.22175509690516" y="292.25180333158073"/><omgdi:waypoint x="540.000000000001" y="292.25180333158073"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-9FCFC0CF-1ABA-4C29-94AC-59C9A981DFDF" id="BPMNEdge_sid-9FCFC0CF-1ABA-4C29-94AC-59C9A981DFDF"><omgdi:waypoint x="590.5000000000009" y="139.20673097956737"/><omgdi:waypoint x="590.5000000000009" y="43.26860060067894"/><omgdi:waypoint x="213.22175509690516" y="43.26860060067894"/><omgdi:waypoint x="213.22175509690516" y="118.70673097956741"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-D2409A9D-5FD1-4616-B72E-5AEB0B19AFFA" id="BPMNEdge_sid-D2409A9D-5FD1-4616-B72E-5AEB0B19AFFA"><omgdi:waypoint x="813.4979179129089" y="173.12428571176383"/><omgdi:waypoint x="904.3004823467552" y="173.12428571176383"/><omgdi:waypoint x="904.3004823467552" y="207.7367792142429"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-A97D50C8-C1FE-46DE-96BA-48D7E5CF2DDC" id="BPMNEdge_sid-A97D50C8-C1FE-46DE-96BA-48D7E5CF2DDC"><omgdi:waypoint x="609.5000000000009" y="159.20673097956737"/><omgdi:waypoint x="713.4979179129089" y="159.20673097956737"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-0BB7400B-2040-4045-BAA5-E4B56D22BD5B" id="BPMNEdge_sid-0BB7400B-2040-4045-BAA5-E4B56D22BD5B"><omgdi:waypoint x="590.4283262679533" y="178.27840471161505"/><omgdi:waypoint x="590.1503249962329" y="252.25180333158065"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-49E8BC23-1882-4AA6-A8A5-D008C1056667" id="BPMNEdge_sid-49E8BC23-1882-4AA6-A8A5-D008C1056667"><omgdi:waypoint x="263.22175509690516" y="158.7067309795674"/><omgdi:waypoint x="385.79687568359395" y="158.7067309795674"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-FFD0A79C-7C1A-4A23-8ACC-341AC2CB192C" id="BPMNEdge_sid-FFD0A79C-7C1A-4A23-8ACC-341AC2CB192C"><omgdi:waypoint x="485.79687568359395" y="158.8683308186816"/><omgdi:waypoint x="570.4351504708858" y="159.14188145045225"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>]]></column>
			<where>workflowtype='CLUSTERS'and workflowactive=1</where>
		</update>
	</changeSet>

	<changeSet id="21" author="Amanullah.m">
		<sql>
			UPDATE SeqWorkFlowDetails SET SEQNO= (SELECT MAX(WorkflowId)+1 FROM workflowdetails);
		</sql>
	</changeSet>

	<changeSet id="22" author="amanullah.m">
		<addColumn tableName="RMTBranches">
			<column name="entity" type="varchar(8)" />
		</addColumn>
		<addColumn tableName="RMTBranches">
			<column name="clusterId" type="bigint" />
		</addColumn>

		<addColumn tableName="RMTBranches_Temp">
			<column name="entity" type="varchar(8)" />
		</addColumn>
		<addColumn tableName="RMTBranches_Temp">
			<column name="clusterId" type="bigint" />
		</addColumn>
	</changeSet>

	<changeSet id="23_pre" author="amanullah.m" dbms="postgresql">
		<modifyDataType tableName="RMTBranches" columnName="entity" newDataType="citext" />
		<modifyDataType tableName="RMTBranches_Temp" columnName="entity" newDataType="citext" />
	</changeSet>

	<changeSet id="23" author="amanullah.m">
		<addForeignKeyConstraint constraintName="fk_branches_entity" referencedTableName="entity"
			baseColumnNames="entity" baseTableName="RMTBranches" referencedColumnNames="entitycode" />

		<addForeignKeyConstraint constraintName="fk_branches_temp_entity" referencedTableName="entity"
			baseColumnNames="entity" baseTableName="RMTBranches_Temp" referencedColumnNames="entitycode" />

		<addForeignKeyConstraint constraintName="fk_branches_clusterid" referencedTableName="clusters"
			baseColumnNames="clusterId" baseTableName="RMTBranches" referencedColumnNames="Id" />

		<addForeignKeyConstraint constraintName="fk_branches_temp_clusterid" referencedTableName="clusters"
			baseColumnNames="clusterId" baseTableName="RMTBranches_Temp" referencedColumnNames="Id" />
	</changeSet>

	<changeSet id="24" author="amanullah.m">
		<createView viewName="rmtbranches_view" replaceIfExists="true">
			 SELECT t1.branchcode,
			    t1.branchdesc,
			    t1.branchaddrline1,
			    t1.branchaddrline2,
			    t1.branchpobox,
			    t1.branchcity,
			    t4.pccityname lovdescbranchcityname,
			    t1.branchprovince,
			    t3.cpprovincename lovdescbranchprovincename,
			    t1.branchcountry,
			    t2.countrydesc lovdescbranchcountryname,
			    t1.branchfax,
			    t1.branchtel,
			    t1.branchswiftbankcde,
			    t1.branchswiftcountry,
			    t1.branchswiftloccode,
			    t1.branchswiftbrncde,
			    t1.branchsortcode,
			    t1.branchisactive,
			    t1.newbranchcode,
			    t6.branchdesc newbranchdesc,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.minibranch,
			    t1.branchtype,
			    t1.parentbranch,
			    t1.pincode,
			    t1.region,
			    t1.bankrefno,
			    t1.branchaddrhnbr,
			    t1.branchflatnbr,
			    t1.branchaddrstreet,
			    t7.branchdesc parentbranchdesc,
			    t5.countrydesc lovdescbranchswiftcountryname,
			    t8.areaname pinareadesc,
			    t1.entity,
			    t10.entitydesc,
			    t1.clusterId,
			    t9.code clustercode,
			    t9.name clustername
			   FROM rmtbranches_temp t1
			     LEFT JOIN bmtcountries t2 ON t1.branchcountry = t2.countrycode
			     LEFT JOIN rmtcountryvsprovince t3 ON t1.branchcountry = t3.cpcountry AND t1.branchprovince = t3.cpprovince
			     LEFT JOIN rmtprovincevscity t4 ON t1.branchcountry = t4.pccountry AND t1.branchprovince = t4.pcprovince AND t1.branchcity = t4.pccity
			     LEFT JOIN bmtcountries t5 ON t1.branchswiftcountry = t5.countrycode
			     LEFT JOIN rmtbranches t6 ON t1.newbranchcode = t6.branchcode
			     LEFT JOIN rmtbranches t7 ON t1.parentbranch = t6.branchcode
			     LEFT JOIN pincodes t8 ON t8.pincode = t1.pincode
			     LEFT JOIN clusters t9 ON t9.Id = t1.clusterId
			     LEFT JOIN entity t10 ON t10.entitycode = t1.entity
			UNION ALL
			 SELECT t1.branchcode,
			    t1.branchdesc,
			    t1.branchaddrline1,
			    t1.branchaddrline2,
			    t1.branchpobox,
			    t1.branchcity,
			    t4.pccityname lovdescbranchcityname,
			    t1.branchprovince,
			    t3.cpprovincename lovdescbranchprovincename,
			    t1.branchcountry,
			    t2.countrydesc lovdescbranchcountryname,
			    t1.branchfax,
			    t1.branchtel,
			    t1.branchswiftbankcde,
			    t1.branchswiftcountry,
			    t1.branchswiftloccode,
			    t1.branchswiftbrncde,
			    t1.branchsortcode,
			    t1.branchisactive,
			    t1.newbranchcode,
			    t6.branchdesc  newbranchdesc,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.minibranch,
			    t1.branchtype,
			    t1.parentbranch,
			    t1.pincode,
			    t1.region,
			    t1.bankrefno,
			    t1.branchaddrhnbr,
			    t1.branchflatnbr,
			    t1.branchaddrstreet,
			    t7.branchdesc parentbranchdesc,
			    t5.countrydesc lovdescbranchswiftcountryname,
			    t8.areaname pinareadesc,
			    t1.entity,
			    t10.entitydesc,
			    t1.clusterId,
			    t9.code clustercode,
			    t9.name clustername
			   FROM rmtbranches t1
			     LEFT JOIN bmtcountries t2 ON t1.branchcountry = t2.countrycode
			     LEFT JOIN rmtcountryvsprovince t3 ON t1.branchcountry = t3.cpcountry AND t1.branchprovince = t3.cpprovince
			     LEFT JOIN rmtprovincevscity t4 ON t1.branchcountry = t4.pccountry AND t1.branchprovince = t4.pcprovince AND t1.branchcity = t4.pccity
			     LEFT JOIN bmtcountries t5 ON t1.branchswiftcountry = t5.countrycode
			     LEFT JOIN rmtbranches t6 ON t1.newbranchcode = t6.branchcode
			     LEFT JOIN rmtbranches t7 ON t1.parentbranch = t6.branchcode
			     LEFT JOIN pincodes t8 ON t8.pincode = t1.pincode
			     LEFT JOIN clusters t9 ON t9.Id = t1.clusterId
			     LEFT JOIN entity t10 ON t10.entitycode = t1.entity
			  WHERE NOT (EXISTS ( SELECT 1
			          FROM rmtbranches_temp
			          WHERE rmtbranches_temp.branchcode = t1.branchcode));
		</createView>
	</changeSet>

	<changeSet id="25" author="amanullah.m">
		<createView viewName="rmtbranches_aview" replaceIfExists="true">
			SELECT t1.branchcode,
		    t1.branchdesc,
		    t1.branchaddrline1,
		    t1.branchaddrline2,
		    t1.branchpobox,
		    t1.branchcity,
		    t4.pccityname AS lovdescbranchcityname,
		    t1.branchprovince,
		    t3.cpprovincename AS lovdescbranchprovincename,
		    t1.branchcountry,
		    t2.countrydesc AS lovdescbranchcountryname,
		    t1.branchfax,
		    t1.branchtel,
		    t1.branchswiftbankcde,
		    t1.branchswiftcountry,
		    t1.branchswiftloccode,
		    t1.branchswiftbrncde,
		    t1.branchsortcode,
		    t1.branchisactive,
		    t1.newbranchcode,
		    t6.branchdesc AS newbranchdesc,
		    t1.version,
		    t1.lastmntby,
		    t1.lastmnton,
		    t1.recordstatus,
		    t1.rolecode,
		    t1.nextrolecode,
		    t1.taskid,
		    t1.nexttaskid,
		    t1.recordtype,
		    t1.workflowid,
		    t1.minibranch,
		    t1.branchtype,
		    t1.parentbranch,
		    t1.pincode,
		    t1.region,
		    t1.bankrefno,
		    t1.branchaddrhnbr,
		    t1.branchflatnbr,
		    t1.branchaddrstreet,
		    t7.branchdesc AS parentbranchdesc,
		    t5.countrydesc  lovdescbranchswiftcountryname,
		    t8.areaname pinareadesc,
		    t1.entity,
		    t10.entitydesc,
		    t1.clusterId,
		    t9.code clustercode,
		    t9.name clustername
		   FROM rmtbranches t1
		     LEFT JOIN bmtcountries t2 ON t1.branchcountry = t2.countrycode
		     LEFT JOIN rmtcountryvsprovince t3 ON t1.branchcountry = t3.cpcountry AND t1.branchprovince = t3.cpprovince
		     LEFT JOIN rmtprovincevscity t4 ON t1.branchcountry = t4.pccountry AND t1.branchprovince = t4.pcprovince AND t1.branchcity = t4.pccity
		     LEFT JOIN bmtcountries t5 ON t1.branchswiftcountry = t5.countrycode
		     LEFT JOIN rmtbranches t6 ON t1.newbranchcode = t6.branchcode
		     LEFT JOIN rmtbranches t7 ON t1.parentbranch = t6.branchcode
		     LEFT JOIN pincodes t8 ON t8.pincode = t1.pincode
		     LEFT JOIN clusters t9 ON t9.Id = t1.clusterId
			 LEFT JOIN entity t10 ON t10.entitycode = t1.entity
		</createView>
	</changeSet>

	<changeSet id="26" author="shinde.b">
		<createTable tableName="business_vertical">
			<column name="id" type="bigint" />
			<column name="code" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="varchar(50)">
				<constraints nullable="false" />
			</column>
			<column name="active" type="boolean" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="26.1" author="shinde.b" dbms="mssql">
		<sql>
	    	<![CDATA[
		     	ALTER TABLE business_vertical ALTER COLUMN id BIGINT NOT NULL;
		   ]]>
		</sql>
	</changeSet>

	<changeSet id="27" author="shinde.b">
		<addPrimaryKey tableName="business_vertical" columnNames="id" />
		<addUniqueConstraint tableName="business_vertical" columnNames="code" />
	</changeSet>

	<changeSet id="28" author="shinde.b">
		<createSequence sequenceName="Seqbusiness_vertical" />
	</changeSet>

	<changeSet id="29" author="shinde.b">
		<createTable tableName="business_vertical_temp">
			<column name="id" type="bigint" />
			<column name="code" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="varchar(50)">
				<constraints nullable="false" />
			</column>
			<column name="active" type="boolean" />
			<column name="Version" type="int" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="29.1" author="shinde.b" dbms="mssql">
		<sql>
    	<![CDATA[
	      ALTER TABLE business_vertical_temp ALTER COLUMN id BIGINT NOT NULL;
	   ]]>
		</sql>
	</changeSet>

	<changeSet id="30" author="shinde.b">
		<addPrimaryKey tableName="business_vertical_temp" columnNames="id" />
		<addUniqueConstraint tableName="business_vertical_temp" columnNames="code" />
	</changeSet>

	<changeSet id="31" author="shinde.b">
		<sql>
    <![CDATA[
			Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
			Update SeqSecGroups set SeqNo = (Select max(GrpId) from SecGroups);
			Update SeqSecRoles set SeqNo = (Select max(RoleId) from SecRoles);
			Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights);
			Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId) from SecRoleGroups);
							
			INSERT INTO SecRoles  VALUES ((select max(roleid)+1 from secroles),1,'BUSINESS_VERTICAL_VIEW','Role for Business Vertical enquiry','',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
			INSERT INTO SecRoles  VALUES ((select max(roleid)+1 from secroles),1,'BUSINESS_VERTICAL_MAKER','Role for Business Vertical maker','',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
			INSERT INTO SecRoles  VALUES ((select max(roleid)+1 from secroles),1,'BUSINESS_VERTICAL_APPROVER','Role for Business Vertical approver','',1,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
						
			INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'BUSINESS_VERTICAL_VIEW','Group for Business Vertical enquiry', 1, 1000, CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
			INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'BUSINESS_VERTICAL_MAKER','Group for Business Vertical maker', 1, 1000, CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
			INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'BUSINESS_VERTICAL_APPROVER','Group for Business Vertical approver', 1, 1000, CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0) ;
						
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),0,'menuItem_BusinessVertical','MENU',0,1000,current_timestamp,'Approved','',' ','',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),0,'menuItem_BusinessVerticalEnquiry','MENU',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_BusinessVerticalList_PrintList','BusinessVerticalList',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_BusinessVerticalList_NewBusinessVertical','BusinessVerticalList',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_BusinessVerticalDialog_btnNew','BusinessVerticalDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);		
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_BusinessVerticalDialog_btnEdit','BusinessVerticalDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);				
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_BusinessVerticalDialog_btnDelete','BusinessVerticalDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);    
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_BusinessVerticalDialog_btnSave','BusinessVerticalDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'BusinessVerticalDialog_Id','BusinessVerticalDialog',0,1000,current_timestamp,'Approved','','',' ',' ',' ',0);				
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'BusinessVerticalDialog_Code','BusinessVerticalDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'BusinessVerticalDialog_Description','BusinessVerticalDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_VIEW'), (Select RightID from SecRights where RightName = 'menuItem_BusinessVerticalEnquiry'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_VIEW'), (Select RightID from SecRights where RightName = 'button_BusinessVerticalList_PrintList'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
										
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_MAKER'), (Select RightID from SecRights where RightName = 'menuItem_BusinessVertical'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );	
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_MAKER'), (Select RightID from SecRights where RightName = 'button_BusinessVerticalList_PrintList'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_MAKER'), (Select RightID from SecRights where RightName = 'button_BusinessVerticalList_NewBusinessVertical'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );				
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_MAKER'), (Select RightID from SecRights where RightName = 'button_BusinessVerticalDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );				
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_MAKER'), (Select RightID from SecRights where RightName = 'button_BusinessVerticalDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_MAKER'), (Select RightID from SecRights where RightName = 'button_BusinessVerticalDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_MAKER'), (Select RightID from SecRights where RightName = 'BusinessVerticalDialog_Id'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_MAKER'), (Select RightID from SecRights where RightName = 'BusinessVerticalDialog_Code'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_MAKER'), (Select RightID from SecRights where RightName = 'BusinessVerticalDialog_Description'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
											
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_APPROVER'), (Select RightID from SecRights where RightName = 'menuItem_BusinessVertical'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );			
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_APPROVER'), (Select RightID from SecRights where RightName = 'button_BusinessVerticalList_PrintList'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );		
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BUSINESS_VERTICAL_APPROVER'), (Select RightID from SecRights where RightName = 'button_BusinessVerticalDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
					
		
		   INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='BUSINESS_VERTICAL_VIEW'), (Select  RoleID  From SecRoles Where RoleCd='BUSINESS_VERTICAL_VIEW'),0,1000,CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0); 
		   INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='BUSINESS_VERTICAL_MAKER'), (Select  RoleID  From SecRoles Where RoleCd='BUSINESS_VERTICAL_MAKER'),0,1000,CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
	       INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1 From SecRoleGroups),(Select GrpId  From SecGroups Where GrpCode='BUSINESS_VERTICAL_APPROVER'), (Select  RoleID  From SecRoles Where RoleCd='BUSINESS_VERTICAL_APPROVER'),0,1000,CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
					
			Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
			Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
			Update SeqSecRoles set SeqNo = (Select max(RoleId)  from SecRoles);
			Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId)  from SecGroupRights);
			Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId)  from SecRoleGroups);
        ]]>
		</sql>
	</changeSet>

	<changeSet id="32" author="shinde.b">
		<createView viewName="business_vertical_AView" replaceIfExists="true">
			SELECT T1.id,
			  T1.code,
			  T1.description,
			  T1.Version,
			  T1.Active,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM business_vertical T1  
     	</createView>
	</changeSet>

	<changeSet id="33" author="shinde.b">
		<createView viewName="business_vertical_View" replaceIfExists="true">
			SELECT T1.id,
			  T1.code,
			  T1.description,
			  T1.Version,
			  T1.Active,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM business_vertical_Temp T1
			UNION ALL
			SELECT T1.id,
			  T1.code,
			  T1.description ,
			  T1.Version,
			  T1.active,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM business_vertical T1
			WHERE NOT EXISTS
			  (SELECT 1 FROM business_vertical_TEMP WHERE id = T1.id
			  )
     	</createView>
	</changeSet>

	<changeSet id="34" author="shinde.b">
		<createView viewName="business_vertical_View" replaceIfExists="true">
			SELECT T1.id,
			  T1.code,
			  T1.description,
			  T1.active,
			  T1.Version ,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM business_vertical_Temp T1
			UNION ALL
			SELECT T1.id,
			  T1.code,
			  T1.description,
			  T1.active,
			  T1.Version,
			  T1.LastMntBy,
			  T1.LastMntOn,
			  T1.RecordStatus,
			  T1.RoleCode,
			  T1.NextRoleCode,
			  T1.TaskId,
			  T1.NextTaskId,
			  T1.RecordType,
			  T1.WorkflowId
			FROM business_vertical T1
			WHERE NOT EXISTS
			  (SELECT 1 FROM business_vertical_TEMP WHERE id = T1.id
			  )
     	</createView>
	</changeSet>

	<changeSet id="35" author="shinde.b">
		<sql>
			UPDATE SeqWorkFlowDetails SET SEQNO= (SELECT MAX(WorkflowId)+1 FROM workflowdetails);
		</sql>
	</changeSet>

	<changeSet id="36" author="shinde.b">
		<sql>
			update workflowdetails set WorkFlowActive='0' where WorkFlowType='BUSINESS_VERTICAL';
		</sql>
		<insert tableName="WorkFlowDetails">
			<column name="WorkFlowId" valueComputed="(select max(Seqno) + 1 from SeqWorkFlowDetails)" />
			<column name="WorkFlowType">BUSINESS_VERTICAL</column>
			<column name="WorkFlowSubType">BUSINESS VERTICAL</column>
			<column name="WorkFlowDesc">BUSINESS VERTICAL</column>
			<column name="JsonDesign" type="nclob"><![CDATA[NULL]]></column>
			<column name="SvgDesign" type="nclob"><![CDATA[NULL]]></column>
			<column name="WorkFlowXml" type="clob"><![CDATA[NULL]]></column>
			<column name="WorkFlowRoles">BUSINESS_VERTICAL_MAKER;BUSINESS_VERTICAL_APPROVER</column>
			<column name="FirstTaskOwner">BUSINESS_VERTICAL_MAKER</column>
			<column name="WorkFlowActive">1</column>
			<column name="Version">0</column>
			<column name="LastMntBy">1000</column>
			<column name="LastMntOn" valueDate="current_timestamp" />
			<column name="RecordStatus">Null</column>
			<column name="RoleCode"></column>
			<column name="NextRoleCode"></column>
			<column name="TaskId"></column>
			<column name="NextTaskId"></column>
			<column name="RecordType">NULL</column>
		</insert>
	</changeSet>

	<changeSet id="37" author="shinde.b">
		<update tableName="WORKFLOWDETAILS">
			<column name="JSONDESIGN" type="NCLOB"><![CDATA[{"resourceId":972,"properties":{"process_id":"BUSINESS_VERTICAL","name":"BUSINESS VERTICAL","documentation":"BUSINESS VERTICAL","category":"","listenerclass":"","listenerentitytype":""},"stencil":{"id":"BPMNDiagram"},"childShapes":[{"resourceId":"startEvent1","properties":{"overrideid":"","name":"Start"},"stencil":{"id":"StartNoneEvent"},"childShapes":[],"outgoing":[{"resourceId":"sid-F1726C95-6FC4-41F6-A606-628745FF1CC7"}],"bounds":{"lowerRight":{"x":130,"y":193},"upperLeft":{"x":100,"y":163}},"dockers":[]},{"resourceId":"sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A","properties":{"overrideid":"","name":"BUSINESS_VERTICAL_MAKER","usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"user","assignee":{"email":"BUSINESS_VERTICAL_MAKER","firstName":"BUSINESS_VERTICAL_MAKER","fullName":"BUSINESS_VERTICAL_MAKER","id":"BUSINESS_VERTICAL_MAKER","roledesc":"BUSINESS_VERTICAL_MAKER","$$hashKey":"object:1661"}}}},"additionalforms":"","formkeydefinition":"","allowrevert":"","prioritydefinition":"Role Queue","baseactor":"","duedatedefinition":"","multiinstance_type":"None","isforcompensation":"false"},"stencil":{"id":"UserTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-82FDE93D-95BC-4E00-A55B-718A5D25FEDB"},{"resourceId":"sid-C26B2B78-DBBD-45BE-B763-29E6A472C95B"}],"bounds":{"lowerRight":{"x":275,"y":218},"upperLeft":{"x":175,"y":138}},"dockers":[]},{"resourceId":"sid-F1726C95-6FC4-41F6-A606-628745FF1CC7","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A"}],"bounds":{"lowerRight":{"x":174.15625,"y":178},"upperLeft":{"x":130.609375,"y":178}},"dockers":[{"x":15,"y":15},{"x":50,"y":40}],"target":{"resourceId":"sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A"}},{"resourceId":"sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9","properties":{"overrideid":"","name":"BUSINESS_VERTICAL_MAKERAPPROVER","usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"user","assignee":{"email":"BUSINESS_VERTICAL_APPROVER","firstName":"BUSINESS_VERTICAL_APPROVER","fullName":"BUSINESS_VERTICAL_APPROVER","id":"BUSINESS_VERTICAL_APPROVER","roledesc":"BUSINESS_VERTICAL_APPROVER","$$hashKey":"object:3388"}}}},"additionalforms":"","formkeydefinition":"","allowrevert":"","prioritydefinition":"Role Queue","baseactor":"","duedatedefinition":"","multiinstance_type":"None","isforcompensation":"false"},"stencil":{"id":"UserTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-3C3691EF-730A-4E3E-99E3-83651E707101"},{"resourceId":"sid-6DB38466-9E31-44A9-BF69-AEA3777F24E3"},{"resourceId":"sid-04CBFDD1-C23A-4C1A-94BF-B4E4BE3E9856"}],"bounds":{"lowerRight":{"x":490,"y":218},"upperLeft":{"x":390,"y":138}},"dockers":[]},{"resourceId":"sid-00D7C88A-415D-4BD1-A323-30016866EDE0","properties":{"overrideid":"","name":"Approved"},"stencil":{"id":"EndNoneEvent"},"childShapes":[],"outgoing":[],"bounds":{"lowerRight":{"x":793,"y":192},"upperLeft":{"x":765,"y":164}},"dockers":[]},{"resourceId":"sid-3929C71A-633C-4217-9680-05303AC9926A","properties":{"overrideid":"","name":"Approve","rerunnable":true,"servicetaskexpression":"doApprove","isforcompensation":"false","multiinstance_type":"None","parameters":""},"stencil":{"id":"approveTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-52C88A90-C7C8-4AD1-8CF3-A87D0FE3FDFA"}],"bounds":{"lowerRight":{"x":670,"y":221},"upperLeft":{"x":570,"y":141}},"dockers":[]},{"resourceId":"sid-52C88A90-C7C8-4AD1-8CF3-A87D0FE3FDFA","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-00D7C88A-415D-4BD1-A323-30016866EDE0"}],"bounds":{"lowerRight":{"x":764.3361154517764,"y":180.04363543305237},"upperLeft":{"x":670.6873220482236,"y":178.27667706694763}},"dockers":[{"x":50,"y":40},{"x":14,"y":14}],"target":{"resourceId":"sid-00D7C88A-415D-4BD1-A323-30016866EDE0"}},{"resourceId":"sid-64FF0A8B-D77D-4F96-9275-64DFE2974C46","properties":{"overrideid":"","name":"Rejected"},"stencil":{"id":"EndNoneEvent"},"childShapes":[],"outgoing":[],"bounds":{"lowerRight":{"x":613,"y":343},"upperLeft":{"x":585,"y":315}},"dockers":[]},{"resourceId":"sid-99E53802-1AB2-4D93-B143-B766DCB92775","properties":{"overrideid":"","name":"Reject","rerunnable":true,"servicetaskexpression":"doReject","isforcompensation":"false","multiinstance_type":"None","parameters":""},"stencil":{"id":"rejectTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-A52415E7-25A5-42D5-B8E4-64F6A8E82B9C"}],"bounds":{"lowerRight":{"x":490,"y":369},"upperLeft":{"x":390,"y":289}},"dockers":[]},{"resourceId":"sid-A52415E7-25A5-42D5-B8E4-64F6A8E82B9C","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-64FF0A8B-D77D-4F96-9275-64DFE2974C46"}],"bounds":{"lowerRight":{"x":584.3359375,"y":329},"upperLeft":{"x":490.6875,"y":329}},"dockers":[{"x":50,"y":40},{"x":14,"y":14}],"target":{"resourceId":"sid-64FF0A8B-D77D-4F96-9275-64DFE2974C46"}},{"resourceId":"sid-C26B2B78-DBBD-45BE-B763-29E6A472C95B","properties":{"overrideid":"","name":"Reject","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Rejected'"}},"defaultflow":"false","action":"Reject","state":"Rejected","mandatenotes":true,"capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-99E53802-1AB2-4D93-B143-B766DCB92775"}],"bounds":{"lowerRight":{"x":389.7379150390625,"y":329},"upperLeft":{"x":225,"y":218.51953125}},"dockers":[{"x":50,"y":40},{"x":225,"y":329},{"x":32.34375,"y":40}],"target":{"resourceId":"sid-99E53802-1AB2-4D93-B143-B766DCB92775"}},{"resourceId":"sid-82FDE93D-95BC-4E00-A55B-718A5D25FEDB","properties":{"overrideid":"","name":"Submit","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus =='Submitted'"}},"defaultflow":"false","action":"Submit","state":"Submitted","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9"}],"bounds":{"lowerRight":{"x":389.44921875,"y":178},"upperLeft":{"x":275.55078125,"y":178}},"dockers":[{"x":50,"y":40},{"x":50,"y":40}],"target":{"resourceId":"sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9"}},{"resourceId":"sid-04CBFDD1-C23A-4C1A-94BF-B4E4BE3E9856","properties":{"overrideid":"","name":"Resubmit","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Resubmitted'"}},"defaultflow":"false","action":"Resubmit","state":"Resubmitted","mandatenotes":true,"capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A"}],"bounds":{"lowerRight":{"x":449.7379150390625,"y":137.34375},"upperLeft":{"x":212.34375,"y":37}},"dockers":[{"x":59.7379150390625,"y":37},{"x":449.7379150390625,"y":37},{"x":212.34375,"y":37},{"x":37.34375,"y":37}],"target":{"resourceId":"sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A"}},{"resourceId":"sid-3C3691EF-730A-4E3E-99E3-83651E707101","properties":{"overrideid":"","name":"Approve","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Approved'"}},"defaultflow":"false","action":"Approve","state":"Approved","mandatenotes":"false","capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-3929C71A-633C-4217-9680-05303AC9926A"}],"bounds":{"lowerRight":{"x":569.30029296875,"y":178},"upperLeft":{"x":490.169921875,"y":178}},"dockers":[{"x":50,"y":40},{"x":27.34375,"y":37}],"target":{"resourceId":"sid-3929C71A-633C-4217-9680-05303AC9926A"}},{"resourceId":"sid-6DB38466-9E31-44A9-BF69-AEA3777F24E3","properties":{"overrideid":"","name":"Reject","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus=='Rejected'"}},"defaultflow":"false","action":"Reject","state":"Rejected","mandatenotes":true,"capturereasons":"false","typeofreason":"","constraint":"","showdiamondmarker":false},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-99E53802-1AB2-4D93-B143-B766DCB92775"}],"bounds":{"lowerRight":{"x":435.34375,"y":288.0044642424724},"upperLeft":{"x":435.34375,"y":218.978403583672}},"dockers":[{"x":45.34375,"y":22.94232456978682},{"x":45.34375,"y":9.689836150490635}],"target":{"resourceId":"sid-99E53802-1AB2-4D93-B143-B766DCB92775"}}],"bounds":{"lowerRight":{"x":1200,"y":1050},"upperLeft":{"x":0,"y":0}},"stencilset":{"url":"stencilsets/bpmn2.0/bpmn2.0.json","namespace":"http://b3mn.org/stencilset/bpmn2.0#"},"ssextensions":[]}]]></column>
			<column name="WORKFLOWXML" type="CLOB"><![CDATA[<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://activiti.org/test"><process id="BUSINESS_VERTICAL" name="BUSINESS VERTICAL" isExecutable="true"><documentation>BUSINESS VERTICAL</documentation><startEvent id="startEvent1" name="Start"/><userTask id="sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A" name="BUSINESS_VERTICAL_MAKER" activiti:actor="BUSINESS_VERTICAL_MAKER" activiti:assignmentLevel="Role Queue"/><sequenceFlow id="sid-F1726C95-6FC4-41F6-A606-628745FF1CC7" sourceRef="startEvent1" targetRef="sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A" representsUserAction="false" mandateNotes="false" captureReasons="false"/><userTask id="sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9" name="BUSINESS_VERTICAL_MAKERAPPROVER" activiti:actor="BUSINESS_VERTICAL_APPROVER" activiti:assignmentLevel="Role Queue"/><endEvent id="sid-00D7C88A-415D-4BD1-A323-30016866EDE0" name="Approved"/><serviceTask id="sid-3929C71A-633C-4217-9680-05303AC9926A" name="Approve" activiti:operation="doApprove" activiti:rerunnable="true"/><sequenceFlow id="sid-52C88A90-C7C8-4AD1-8CF3-A87D0FE3FDFA" sourceRef="sid-3929C71A-633C-4217-9680-05303AC9926A" targetRef="sid-00D7C88A-415D-4BD1-A323-30016866EDE0" representsUserAction="false" mandateNotes="false" captureReasons="false"/><endEvent id="sid-64FF0A8B-D77D-4F96-9275-64DFE2974C46" name="Rejected"/><serviceTask id="sid-99E53802-1AB2-4D93-B143-B766DCB92775" name="Reject" activiti:operation="doReject" activiti:rerunnable="true"/><sequenceFlow id="sid-A52415E7-25A5-42D5-B8E4-64F6A8E82B9C" sourceRef="sid-99E53802-1AB2-4D93-B143-B766DCB92775" targetRef="sid-64FF0A8B-D77D-4F96-9275-64DFE2974C46" representsUserAction="false" mandateNotes="false" captureReasons="false"/><sequenceFlow id="sid-C26B2B78-DBBD-45BE-B763-29E6A472C95B" name="Reject" sourceRef="sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A" targetRef="sid-99E53802-1AB2-4D93-B143-B766DCB92775" action="Reject" state="Rejected" representsUserAction="true" mandateNotes="true" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Rejected'</conditionExpression></sequenceFlow><sequenceFlow id="sid-82FDE93D-95BC-4E00-A55B-718A5D25FEDB" name="Submit" sourceRef="sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A" targetRef="sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9" action="Submit" state="Submitted" representsUserAction="true" mandateNotes="false" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus =='Submitted'</conditionExpression></sequenceFlow><sequenceFlow id="sid-04CBFDD1-C23A-4C1A-94BF-B4E4BE3E9856" name="Resubmit" sourceRef="sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9" targetRef="sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A" action="Resubmit" state="Resubmitted" representsUserAction="true" mandateNotes="true" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Resubmitted'</conditionExpression></sequenceFlow><sequenceFlow id="sid-3C3691EF-730A-4E3E-99E3-83651E707101" name="Approve" sourceRef="sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9" targetRef="sid-3929C71A-633C-4217-9680-05303AC9926A" action="Approve" state="Approved" representsUserAction="true" mandateNotes="false" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Approved'</conditionExpression></sequenceFlow><sequenceFlow id="sid-6DB38466-9E31-44A9-BF69-AEA3777F24E3" name="Reject" sourceRef="sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9" targetRef="sid-99E53802-1AB2-4D93-B143-B766DCB92775" action="Reject" state="Rejected" representsUserAction="true" mandateNotes="true" captureReasons="false"><conditionExpression xsi:type="tFormalExpression">vo.recordStatus=='Rejected'</conditionExpression></sequenceFlow></process><bpmndi:BPMNDiagram id="BPMNDiagram_BUSINESS_VERTICAL"><bpmndi:BPMNPlane bpmnElement="BUSINESS_VERTICAL" id="BPMNPlane_BUSINESS_VERTICAL"><bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1"><omgdc:Bounds height="30.0" width="30.0" x="100.0" y="163.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A" id="BPMNShape_sid-C29B5867-27A4-44AF-97CB-7C5E90540F6A"><omgdc:Bounds height="80.0" width="100.0" x="175.0" y="138.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9" id="BPMNShape_sid-62CABBB4-D66B-40F1-A898-54D56D6A8AB9"><omgdc:Bounds height="80.0" width="100.0" x="390.0" y="138.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-00D7C88A-415D-4BD1-A323-30016866EDE0" id="BPMNShape_sid-00D7C88A-415D-4BD1-A323-30016866EDE0"><omgdc:Bounds height="28.0" width="28.0" x="765.0" y="164.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-3929C71A-633C-4217-9680-05303AC9926A" id="BPMNShape_sid-3929C71A-633C-4217-9680-05303AC9926A"><omgdc:Bounds height="80.0" width="100.0" x="570.0" y="141.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-64FF0A8B-D77D-4F96-9275-64DFE2974C46" id="BPMNShape_sid-64FF0A8B-D77D-4F96-9275-64DFE2974C46"><omgdc:Bounds height="28.0" width="28.0" x="585.0" y="315.0"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="sid-99E53802-1AB2-4D93-B143-B766DCB92775" id="BPMNShape_sid-99E53802-1AB2-4D93-B143-B766DCB92775"><omgdc:Bounds height="80.0" width="100.0" x="390.0" y="289.0"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement="sid-3C3691EF-730A-4E3E-99E3-83651E707101" id="BPMNEdge_sid-3C3691EF-730A-4E3E-99E3-83651E707101"><omgdi:waypoint x="490.0" y="178.0"/><omgdi:waypoint x="570.0" y="178.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-04CBFDD1-C23A-4C1A-94BF-B4E4BE3E9856" id="BPMNEdge_sid-04CBFDD1-C23A-4C1A-94BF-B4E4BE3E9856"><omgdi:waypoint x="449.7379150390625" y="138.0"/><omgdi:waypoint x="449.7379150390625" y="37.0"/><omgdi:waypoint x="212.34375" y="37.0"/><omgdi:waypoint x="212.34375" y="138.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-6DB38466-9E31-44A9-BF69-AEA3777F24E3" id="BPMNEdge_sid-6DB38466-9E31-44A9-BF69-AEA3777F24E3"><omgdi:waypoint x="435.34375" y="218.0"/><omgdi:waypoint x="435.34375" y="289.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-82FDE93D-95BC-4E00-A55B-718A5D25FEDB" id="BPMNEdge_sid-82FDE93D-95BC-4E00-A55B-718A5D25FEDB"><omgdi:waypoint x="275.0" y="178.0"/><omgdi:waypoint x="390.0" y="178.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-A52415E7-25A5-42D5-B8E4-64F6A8E82B9C" id="BPMNEdge_sid-A52415E7-25A5-42D5-B8E4-64F6A8E82B9C"><omgdi:waypoint x="490.0" y="329.0"/><omgdi:waypoint x="585.0" y="329.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-F1726C95-6FC4-41F6-A606-628745FF1CC7" id="BPMNEdge_sid-F1726C95-6FC4-41F6-A606-628745FF1CC7"><omgdi:waypoint x="130.0" y="178.0"/><omgdi:waypoint x="175.0" y="178.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-C26B2B78-DBBD-45BE-B763-29E6A472C95B" id="BPMNEdge_sid-C26B2B78-DBBD-45BE-B763-29E6A472C95B"><omgdi:waypoint x="225.0" y="218.0"/><omgdi:waypoint x="225.0" y="329.0"/><omgdi:waypoint x="390.0" y="329.0"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="sid-52C88A90-C7C8-4AD1-8CF3-A87D0FE3FDFA" id="BPMNEdge_sid-52C88A90-C7C8-4AD1-8CF3-A87D0FE3FDFA"><omgdi:waypoint x="670.0" y="180.0566037735849"/><omgdi:waypoint x="765.0024913248707" y="178.26410393726658"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>]]></column>
			<where>workflowtype='BUSINESS_VERTICAL'and workflowactive=1
			</where>
		</update>
	</changeSet>

	<changeSet id="38" author="shinde.b">
		<sql>
			UPDATE SeqWorkFlowDetails SET SEQNO= (SELECT MAX(WorkflowId)+1 FROM workflowdetails);
		</sql>
	</changeSet>

	<changeSet id="39" author="shinde.b">
		<sql>
			UPDATE SeqWorkFlowDetails SET SEQNO= (SELECT MAX(WorkflowId)+1 FROM workflowdetails);
		</sql>
	</changeSet>

	<changeSet id="40" author="shinde.b">
		<createTable tableName="secusr_reporting_managers">
			<column name="id" type="bigint" />
			<column name="usrid" type="bigint" />
			<column name="businessvertical" type="bigint" />
			<column name="product" type="varchar(8)" />
			<column name="fintype" type="varchar(8)" />
			<column name="branch" type="varchar(8)" />
			<column name="reportingto" type="bigint" />
			<column name="version" type="int" />
			<column name="lastmntby" type="bigint" />
			<column name="lastmnton" type="datetime" />
			<column name="recordstatus" type="varchar(50)" />
			<column name="rolecode" type="varchar(100)" />
			<column name="nextrolecode" type="varchar(200)" />
			<column name="taskid" type="varchar(50)" />
			<column name="nexttaskid" type="varchar(200)" />
			<column name="recordtype" type="varchar(50)" />
			<column name="workflowid" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="40.1" author="shinde.b" dbms="mssql">
		<sql>
    	<![CDATA[
	       ALTER TABLE secusr_reporting_managers ALTER COLUMN id BIGINT NOT NULL;
	   ]]>
		</sql>
	</changeSet>

	<changeSet id="41" author="shinde.b" dbms="postgresql">
		<modifyDataType tableName="secusr_reporting_managers" columnName="product" newDataType="citext" />
		<modifyDataType tableName="secusr_reporting_managers" columnName="fintype" newDataType="citext" />
		<modifyDataType tableName="secusr_reporting_managers" columnName="branch" newDataType="citext" />
	</changeSet>

	<changeSet id="41.1" author="shinde.b">
		<sql>
	<![CDATA[
	       ALTER TABLE secusr_reporting_managers ALTER COLUMN branch TYPE VARCHAR(12);
	   ]]>
		</sql>
	</changeSet>
	<changeSet id="41.2" author="shinde.b" dbms="postgresql">
		<modifyDataType tableName="secusr_reporting_managers" columnName="branch" newDataType="citext" />
	</changeSet>

	<changeSet id="42" author="shinde.b">
		<addPrimaryKey tableName="secusr_reporting_managers" columnNames="id" />
		<addForeignKeyConstraint constraintName="fk_reportmng_usrid" referencedTableName="secusers"
			baseColumnNames="usrid" baseTableName="secusr_reporting_managers" referencedColumnNames="usrid" />
		<addForeignKeyConstraint constraintName="fk_reportmng_bsnverticalid" referencedTableName="business_vertical"
			baseColumnNames="businessvertical" baseTableName="secusr_reporting_managers" referencedColumnNames="id" />
		<addForeignKeyConstraint constraintName="fk_reportmng_prdcode" referencedTableName="bmtproduct"
			baseColumnNames="product" baseTableName="secusr_reporting_managers" referencedColumnNames="productcode" />
		<addForeignKeyConstraint constraintName="fk_reportmng_fintype" referencedTableName="rmtfinancetypes"
			baseColumnNames="fintype" baseTableName="secusr_reporting_managers" referencedColumnNames="fintype" />
		<addForeignKeyConstraint constraintName="fk_reportmng_branchcode" referencedTableName="rmtbranches"
			baseColumnNames="branch" baseTableName="secusr_reporting_managers" referencedColumnNames="branchcode" />
		<addForeignKeyConstraint constraintName="fk_reportmng_repotingto" referencedTableName="secusers"
			baseColumnNames="reportingto" baseTableName="secusr_reporting_managers" referencedColumnNames="usrid" />
	</changeSet>

	<changeSet id="43" author="shinde.b">
		<createTable tableName="secusr_reporting_managers_temp">
			<column name="id" type="bigint" />
			<column name="usrid" type="bigint" />
			<column name="businessvertical" type="bigint" />
			<column name="product" type="varchar(8)" />
			<column name="fintype" type="varchar(8)" />
			<column name="branch" type="varchar(8)" />
			<column name="reportingto" type="bigint" />
			<column name="version" type="int" />
			<column name="lastmntby" type="bigint" />
			<column name="lastmnton" type="datetime" />
			<column name="recordstatus" type="varchar(50)" />
			<column name="rolecode" type="varchar(100)" />
			<column name="nextrolecode" type="varchar(200)" />
			<column name="taskid" type="varchar(50)" />
			<column name="nexttaskid" type="varchar(200)" />
			<column name="recordtype" type="varchar(50)" />
			<column name="workflowid" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="43.1" author="shinde.b" dbms="mssql">
		<sql>
    	<![CDATA[
	  ALTER TABLE secusr_reporting_managers_temp ALTER COLUMN id BIGINT NOT NULL;
	   ]]>
		</sql>
	</changeSet>

	<changeSet id="44" author="shinde.b" dbms="postgresql">
		<modifyDataType tableName="secusr_reporting_managers_temp" columnName="product" newDataType="citext" />
		<modifyDataType tableName="secusr_reporting_managers_temp" columnName="fintype" newDataType="citext" />
		<modifyDataType tableName="secusr_reporting_managers_temp" columnName="branch" newDataType="citext" />
	</changeSet>

	<changeSet id="44.1" author="shinde.b" dbms="mssql">
		<sql>
    	<![CDATA[
	  		ALTER TABLE secusr_reporting_managers_temp ALTER COLUMN usrid BIGINT NOT NULL;
	   ]]>
		</sql>
	</changeSet>

	<changeSet id="44.2" author="shinde.b">
		<sql>
	<![CDATA[
	       ALTER TABLE secusr_reporting_managers_temp ALTER COLUMN branch TYPE VARCHAR(12);
	   ]]>
		</sql>
	</changeSet>

	<changeSet id="44.3" author="shinde.b" dbms="postgresql">
		<modifyDataType tableName="secusr_reporting_managers_temp" columnName="branch" newDataType="citext" />
	</changeSet>

	<changeSet id="45" author="shinde.b">
		<addPrimaryKey tableName="secusr_reporting_managers_temp" columnNames="id, usrid" />
		<addForeignKeyConstraint constraintName="fk_reportmng_usrid_t" referencedTableName="secusers"
			baseColumnNames="usrid" baseTableName="secusr_reporting_managers_temp" referencedColumnNames="usrid" />
		<addForeignKeyConstraint constraintName="fk_reportmng_bsnverticalid_t" referencedTableName="business_vertical"
			baseColumnNames="businessvertical" baseTableName="secusr_reporting_managers_temp" referencedColumnNames="id" />
		<addForeignKeyConstraint constraintName="fk_reportmng_prdcode_t" referencedTableName="bmtproduct"
			baseColumnNames="product" baseTableName="secusr_reporting_managers_temp" referencedColumnNames="productcode" />
		<addForeignKeyConstraint constraintName="fk_reportmng_fintype_t" referencedTableName="rmtfinancetypes"
			baseColumnNames="fintype" baseTableName="secusr_reporting_managers_temp" referencedColumnNames="fintype" />
		<addForeignKeyConstraint constraintName="fk_reportmng_branchcode_t" referencedTableName="rmtbranches"
			baseColumnNames="branch" baseTableName="secusr_reporting_managers_temp" referencedColumnNames="branchcode" />
		<addForeignKeyConstraint constraintName="fk_reportmng_repotingto_t" referencedTableName="secusers"
			baseColumnNames="reportingto" baseTableName="secusr_reporting_managers_temp" referencedColumnNames="usrid" />
	</changeSet>

	<changeSet id="46" author="shinde.b">
		<createSequence sequenceName="SeqReportingManager" />
	</changeSet>

	<changeSet id="47" author="shinde.b">
		<sql>
			 <![CDATA[
					INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_ReportingManagerDialog_btnDelete','ReportingManagerDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				    INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_ReportingManagerDialog_btnSave','ReportingManagerDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				    INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'ReportingManagerDialog_userid','ReportingManagerDialog',0,1000,current_timestamp,'Approved','','',' ',' ',' ',0);
				    INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'ReportingManagerDialog_businessverticalid','ReportingManagerDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				    INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'ReportingManagerDialog_product','ReportingManagerDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
				    INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'ReportingManagerDialog_loantype','ReportingManagerDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);		
				    INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'ReportingManagerDialog_branch','ReportingManagerDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);		
				    INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'ReportingManagerDialog_reportingto','ReportingManagerDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="48" author="shinde.b">
		<addColumn tableName="secusers">
			<column name="businessvertical" type="bigint">
				<constraints nullable="true" />
			</column>
		</addColumn>
		<addColumn tableName="secusers_temp">
			<column name="businessvertical" type="bigint">
				<constraints nullable="true" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet id="49" author="shinde.b">
		<addColumn tableName="secusers_rtemp">
			<column name="businessvertical" type="bigint">
				<constraints nullable="true" />
			</column>
		</addColumn>
	</changeSet>

	<changeSet id="50" author="shinde.b">
		<createView viewName="secusers_aview" replaceIfExists="true">
			SELECT t1.usrid,
			t1.usrlogin,
			t1.usrpwd,
			t1.userstaffid,
			t1.usrfname,
			t1.usrmname,
			t1.usrlname,
			t1.usrmobile,
			t1.usremail,
			t1.usrenabled,
			t1.usrcansignonfrom,
			t1.usrcansignonto,
			t1.usrcanoverridelimits,
			t1.usracexp,
			t1.usracexpdt,
			t1.pwdexpdt,
			t1.usraclocked,
			t1.usrlanguage,
			t5.lngdesc lovdescusrlanguage,
			t1.usrdftappid,
			t2.appcode lovdescusrdftappcode,
			t2.appdescription lovdescusrdftappcodename,
			t1.usrbranchcode,
			t4.branchdesc lovdescusrbranchcodename,
			t1.usrdeptcode,
			t3.deptdesc lovdescusrdeptcodename,
			t1.usrtoken,
			t1.usrismultibranch,
			t1.usrinvldlogintries,
			t1.usrdesg,
			t6.desgdesc lovdescusrdesg,
			t1.businessvertical,
			t7.code businessVerticalCode,
			t7.Description businessVerticalDesc,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.usrdftappcode,
			t1.authtype,
			t1.usertype
			  FROM secusers t1
			 LEFT JOIN ptapplicationdetails t2 ON t1.usrdftappid = t2.appid
			 LEFT JOIN bmtdepartments t3 ON t1.usrdeptcode = t3.deptcode
			 LEFT JOIN rmtbranches t4 ON t1.usrbranchcode = t4.branchcode
			 LEFT JOIN bmtlanguage t5 ON t1.usrlanguage = t5.lngcode
			 LEFT JOIN bmtdesignations t6 ON t1.usrdesg = t6.desgcode
			LEFT JOIN business_vertical t7 ON t7.id = t1.businessvertical
		</createView>
	</changeSet>

	<changeSet id="51" author="shinde.b">
		<createView viewName="secusers_view" replaceIfExists="true">
			SELECT t1.usrid,
			t1.usrlogin,
			t1.usrpwd,
			t1.userstaffid,
			t1.usrfname,
			t1.usrmname,
			t1.usrlname,
			t1.usrmobile,
			t1.usremail,
			t1.usrenabled,
			t1.usrcansignonfrom,
			t1.usrcansignonto,
			t1.usrcanoverridelimits,
			t1.usracexp,
			t1.usracexpdt,
			t1.pwdexpdt,
			t1.usraclocked,
			t1.usrlanguage,
			t5.lngdesc lovdescusrlanguage,
			t1.usrdftappid,
			t2.appcode lovdescusrdftappcode,
			t2.appdescription lovdescusrdftappcodename,
			t1.usrbranchcode,
			t4.branchdesc lovdescusrbranchcodename,
			t1.usrdeptcode,
			t3.deptdesc lovdescusrdeptcodename,
			t1.usrtoken,
			t1.usrismultibranch,
			t1.usrinvldlogintries,
			t1.usrdesg,
			t6.desgdesc lovdescusrdesg,
			t1.businessvertical,
		    t7.code businessVerticalCode,
		    t7.Description businessVerticalDesc,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.usrdftappcode,
			t1.authtype,
			t1.usertype
			  FROM secusers_temp t1
			 LEFT JOIN ptapplicationdetails t2 ON t1.usrdftappid = t2.appid
			 LEFT JOIN bmtdepartments t3 ON t1.usrdeptcode = t3.deptcode
			 LEFT JOIN rmtbranches t4 ON t1.usrbranchcode = t4.branchcode
			 LEFT JOIN bmtlanguage t5 ON t1.usrlanguage = t5.lngcode
			 LEFT JOIN bmtdesignations t6 ON t1.usrdesg = t6.desgcode
			 LEFT JOIN business_vertical t7 ON t7.id = t1.businessvertical
				UNION ALL
				 SELECT t1.usrid,
			t1.usrlogin,
			t1.usrpwd,
			t1.userstaffid,
			t1.usrfname,
			t1.usrmname,
			t1.usrlname,
			t1.usrmobile,
			t1.usremail,
			t1.usrenabled,
			t1.usrcansignonfrom,
			t1.usrcansignonto,
			t1.usrcanoverridelimits,
			t1.usracexp,
			t1.usracexpdt,
			t1.pwdexpdt,
			t1.usraclocked,
			t1.usrlanguage,
			t5.lngdesc lovdescusrlanguage,
			t1.usrdftappid,
			t2.appcode lovdescusrdftappcode,
			t2.appdescription lovdescusrdftappcodename,
			t1.usrbranchcode,
			t4.branchdesc lovdescusrbranchcodename,
			t1.usrdeptcode,
			t3.deptdesc lovdescusrdeptcodename,
			t1.usrtoken,
			t1.usrismultibranch,
			t1.usrinvldlogintries,
			t1.usrdesg,
			t6.desgdesc lovdescusrdesg,
			t1.businessvertical,
			t7.code businessVerticalCode,
			t7.Description businessVerticalDesc,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.usrdftappcode,
			t1.authtype,
			t1.usertype
			  FROM secusers t1
			 LEFT JOIN ptapplicationdetails t2 ON t1.usrdftappid = t2.appid
			 LEFT JOIN bmtdepartments t3 ON t1.usrdeptcode = t3.deptcode
			 LEFT JOIN rmtbranches t4 ON t1.usrbranchcode = t4.branchcode
			 LEFT JOIN bmtlanguage t5 ON t1.usrlanguage = t5.lngcode
			 LEFT JOIN bmtdesignations t6 ON t1.usrdesg = t6.desgcode
			                        LEFT JOIN business_vertical t7 ON t7.id = t1.businessvertical
				  WHERE NOT (EXISTS ( SELECT 1
						   FROM secusers_temp
						  WHERE secusers_temp.usrid = t1.usrid))
		</createView>
	</changeSet>

	<changeSet id="52" author="shinde.b">
		<createView viewName="secusers_rview" replaceIfExists="true">
			 SELECT t1.usrid,
				t1.usrlogin,
				t1.usrpwd,
				t1.userstaffid,
				t1.usrfname,
				t1.usrmname,
				t1.usrlname,
				t1.usrmobile,
				t1.usremail,
				t1.usrenabled,
				t1.usrcansignonfrom,
				t1.usrcansignonto,
				t1.usrcanoverridelimits,
				t1.usracexp,
				t1.usracexpdt,
				t1.pwdexpdt,
				t1.usraclocked,
				t1.usrlanguage,
				t5.lngdesc lovdescusrlanguage,
				t1.usrdftappid,
				t2.appcode lovdescusrdftappcode,
				t2.appdescription lovdescusrdftappcodename,
				t1.usrbranchcode,
				t4.branchdesc lovdescusrbranchcodename,
				t1.usrdeptcode,
				t3.deptdesc lovdescusrdeptcodename,
				t1.usrtoken,
				t1.usrismultibranch,
				t1.usrinvldlogintries,
				t1.usrdesg,
				t6.desgdesc lovdescusrdesg,
				t1.businessvertical,
				t7.code businessVerticalCode,
				t7.Description businessVerticalDesc,
				t1.version,
				t1.lastmntby,
				t1.lastmnton,
				t1.recordstatus,
				t1.rolecode,
				t1.nextrolecode,
				t1.taskid,
				t1.nexttaskid,
				t1.recordtype,
				t1.workflowid,
				t1.usrdftappcode,
				t1.authtype,
				t1.usertype
			   FROM secusers_rtemp t1
				 JOIN ptapplicationdetails t2 ON t1.usrdftappid = t2.appid
				 JOIN bmtdepartments t3 ON t1.usrdeptcode = t3.deptcode
				 JOIN rmtbranches t4 ON t1.usrbranchcode = t4.branchcode
				 JOIN bmtlanguage t5 ON t1.usrlanguage = t5.lngcode
				 JOIN bmtdesignations t6 ON t1.usrdesg = t6.desgcode
			                             JOIN business_vertical t7 ON t7.id = t1.businessvertical
			UNION ALL
			 SELECT t1.usrid,
				t1.usrlogin,
				t1.usrpwd,
				t1.userstaffid,
				t1.usrfname,
				t1.usrmname,
				t1.usrlname,
				t1.usrmobile,
				t1.usremail,
				t1.usrenabled,
				t1.usrcansignonfrom,
				t1.usrcansignonto,
				t1.usrcanoverridelimits,
				t1.usracexp,
				t1.usracexpdt,
				t1.pwdexpdt,
				t1.usraclocked,
				t1.usrlanguage,
				t5.lngdesc lovdescusrlanguage,
				t1.usrdftappid,
				t2.appcode lovdescusrdftappcode,
				t2.appdescription lovdescusrdftappcodename,
				t1.usrbranchcode,
				t4.branchdesc lovdescusrbranchcodename,
				t1.usrdeptcode,
				t3.deptdesc lovdescusrdeptcodename,
				t1.usrtoken,
				t1.usrismultibranch,
				t1.usrinvldlogintries,
				t1.usrdesg,
				t6.desgdesc lovdescusrdesg,
				t1.businessvertical,
				t7.code businessVerticalCode,
				t7.Description businessVerticalDesc,
				t1.version,
				t1.lastmntby,
				t1.lastmnton,
				t1.recordstatus,
				t1.rolecode,
				t1.nextrolecode,
				t1.taskid,
				t1.nexttaskid,
				t1.recordtype,
				t1.workflowid,
				t1.usrdftappcode,
				t1.authtype,
				t1.usertype
			   FROM secusers t1
				 JOIN ptapplicationdetails t2 ON t1.usrdftappid = t2.appid
				 JOIN bmtdepartments t3 ON t1.usrdeptcode = t3.deptcode
				 JOIN rmtbranches t4 ON t1.usrbranchcode = t4.branchcode
				 JOIN bmtlanguage t5 ON t1.usrlanguage = t5.lngcode
				 JOIN bmtdesignations t6 ON t1.usrdesg = t6.desgcode
			                             JOIN business_vertical t7 ON t7.id = t1.businessvertical
			  WHERE NOT (EXISTS ( SELECT 1
					   FROM secusers_rtemp
					  WHERE secusers_rtemp.usrid = t1.usrid))
		</createView>
	</changeSet>

	<changeSet id="53" author="shinde.b">
		<createView viewName="secusr_reporting_managers_aviw" replaceIfExists="true">
			SELECT rm.id,
			  rm.usrid,
			  rm.businessvertical,
			  bv.Code BusinessVerticalCode,
			  bv.Description BusinessVerticalDesc,
			  rm.product,
			  p.productDesc,
			  rm.fintype,
			  ft.fintypedesc,
			  rm.branch,
			  b.branchDesc,
			  rm.reportingto,
			  t3.usrlogin  reportingToUserName,
			  rm.Version ,
			  rm.LastMntBy,
			  rm.LastMntOn,
			  rm.RecordStatus,
			  rm.RoleCode,
			  rm.NextRoleCode,
			  rm.TaskId,
			  rm.NextTaskId,
			  rm.RecordType,
			  rm.WorkflowId
			FROM secusr_reporting_managers rm
			LEFT JOIN business_vertical bv ON bv.id=rm.businessvertical
			LEFT JOIN bmtproduct p ON p.productCode=rm.product
			LEFT JOIN rmtbranches b ON b.branchCode=rm.branch
			LEFT JOIN rmtfinancetypes ft ON ft.finType=rm.finType
			LEFT JOIN secusers t3 ON t3.usrid=rm.reportingto
		</createView>
	</changeSet>

	<changeSet id="54" author="shinde.b">
		<createView viewName="secusr_reporting_managers_view" replaceIfExists="true">
			SELECT rm.id,
			  rm.usrid,
			  rm.businessvertical,
			  bv.Code BusinessVerticalCode,
			  bv.Description BusinessVerticalDesc,
			  rm.product,
			  p.productDesc,
			  rm.fintype,
			  ft.fintypedesc,
			  rm.branch,
			  b.branchDesc,
			  rm.reportingto,
			  t3.usrlogin  reportingToUserName,
			  rm.Version ,
			  rm.LastMntBy,
			  rm.LastMntOn,
			  rm.RecordStatus,
			  rm.RoleCode,
			  rm.NextRoleCode,
			  rm.TaskId,
			  rm.NextTaskId,
			  rm.RecordType,
			  rm.WorkflowId
			FROM secusr_reporting_managers_temp rm
			LEFT JOIN business_vertical bv ON bv.id=rm.businessvertical
			LEFT JOIN bmtproduct p ON p.productCode=rm.product
			LEFT JOIN rmtbranches b ON b.branchCode=rm.branch
			LEFT JOIN rmtfinancetypes ft ON ft.finType=rm.finType
			LEFT JOIN secusers t3 ON t3.usrid=rm.reportingto
			UNION ALL
			SELECT rm.id,
			  rm.usrid,
			  rm.businessvertical,
			  bv.Code BusinessVerticalCode,
			  bv.Description BusinessVerticalDesc,
			  rm.product,
			  p.productDesc,
			  rm.fintype,
			  ft.fintypedesc,
			  rm.branch,
			  b.branchDesc,
			  rm.reportingto,
			  t3.usrlogin  reportingToUserName,
			  rm.Version ,
			  rm.LastMntBy,
			  rm.LastMntOn,
			  rm.RecordStatus,
			  rm.RoleCode,
			  rm.NextRoleCode,
			  rm.TaskId,
			  rm.NextTaskId,
			  rm.RecordType,
			  rm.WorkflowId
			FROM secusr_reporting_managers rm
			LEFT JOIN business_vertical bv ON bv.id=rm.businessvertical
			LEFT JOIN bmtproduct p ON p.productCode=rm.product
			LEFT JOIN rmtbranches b ON b.branchCode=rm.branch
			LEFT JOIN rmtfinancetypes ft ON ft.finType=rm.finType
			LEFT JOIN secusers t3 ON t3.usrid=rm.reportingto
			WHERE  NOT EXISTS (SELECT 1 FROM secusr_reporting_managers_temp WHERE id = rm.id)
      </createView>
	</changeSet>

	<changeSet id="55" author="amanullah.m">
		<createTable tableName="SecUserAccess">
			<column name="usrId" type="bigint" />
			<column name="division" type="varchar(8)" />
			<column name="branch" type="varchar(8)" />
			<column name="accessType" type="varchar(8)" />
			<column name="entity" type="varchar(8)" />
			<column name="clusterId" type="bigint" />
			<column name="clusterType" type="varchar(8)" />
			<column name="parentCluster" type="bigint" />
			<column name="ParentClusterType" type="varchar(8)" />
			<column name="version" type="int" />
			<column name="lastmntby" type="bigint" />
			<column name="lastmnton" type="datetime" />
			<column name="recordstatus" type="varchar(50)" />
			<column name="rolecode" type="varchar(100)" />
			<column name="nextrolecode" type="varchar(200)" />
			<column name="taskid" type="varchar(50)" />
			<column name="nexttaskid" type="varchar(200)" />
			<column name="recordtype" type="varchar(50)" />
			<column name="workflowid" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="56" author="shinde.b">
		<sql>
       <![CDATA[
			Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
			Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
			Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights);
			
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_SecurityUserDialog_RM_btnDelete','SecurityUserDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_SecurityUserDialog_RM_btnSave','SecurityUserDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),2,'button_SecurityUserDialog_RM_btnNew','SecurityUserDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0); 
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'SecurityUserDialog_RM_Businessvertical','SecurityUserDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'SecurityUserDialog_RM_productcode','SecurityUserDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'SecurityUserDialog_RM_fintype','SecurityUserDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);		
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'SecurityUserDialog_RM_branchcode','SecurityUserDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);		
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'SecurityUserDialog_RM_reportingto','SecurityUserDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'SecurityUserDialog_CH_Div_Branch','SecurityUserDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'BranchDialog_Entity','BranchDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
            INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3,'BranchDialog_ClusterType','BranchDialog',0,1000,current_timestamp,'Approved','',' ',' ',' ',' ',0);
			
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSER_MAKER'), (Select RightID from SecRights where RightName = 'button_SecurityUserDialog_RM_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSER_MAKER'), (Select RightID from SecRights where RightName = 'button_SecurityUserDialog_RM_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSER_MAKER'), (Select RightID from SecRights where RightName = 'button_SecurityUserDialog_RM_btnNew'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSER_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_Businessvertical'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSER_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_productcode'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSER_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_fintype'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSER_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_branchcode'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSER_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_reportingto'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSER_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_CH_Div_Branch'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
							
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSERS_MAKER'), (Select RightID from SecRights where RightName = 'button_SecurityUserDialog_RM_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSERS_MAKER'), (Select RightID from SecRights where RightName = 'button_SecurityUserDialog_RM_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSERS_MAKER'), (Select RightID from SecRights where RightName = 'button_SecurityUserDialog_RM_btnNew'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSERS_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_Businessvertical'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSERS_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_productcode'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSERS_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_fintype'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSERS_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_branchcode'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSERS_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_RM_reportingto'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );			
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'SECURITYUSERS_MAKER'), (Select RightID from SecRights where RightName = 'SecurityUserDialog_CH_Div_Branch'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			
			INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BRANCH_MAKER'), (Select RightID from SecRights where RightName = 'BranchDialog_Entity'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
            INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'BRANCH_MAKER'), (Select RightID from SecRights where RightName = 'BranchDialog_ClusterType'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			
			Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
			Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
			Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights);
       ]]>
		</sql>
	</changeSet>

	<changeSet id="57" author="amanullah.m">
		<createTable tableName="user_hierarchy">
			<column name="Id" type="bigint" autoIncrement="true" />
			<column name="userId" type="bigint" />
			<column name="business_vertical" type="bigint" />
			<column name="product" type="varchar(8)" />
			<column name="Fin_Type" type="varchar(8)" />
			<column name="branch" type="varchar(8)" />
			<column name="reporting_To" type="bigint" />
			<column name="depth" type="int" />
			<column name="version" type="int" />
			<column name="lastmntby" type="bigint" />
			<column name="lastmnton" type="datetime" />
			<column name="recordstatus" type="varchar(50)" />
			<column name="rolecode" type="varchar(100)" />
			<column name="nextrolecode" type="varchar(200)" />
			<column name="taskid" type="varchar(50)" />
			<column name="nexttaskid" type="varchar(200)" />
			<column name="recordtype" type="varchar(50)" />
			<column name="workflowid" type="bigint" />
		</createTable>
	</changeSet>

	<changeSet id="58" author="amanullah.m">
		<addPrimaryKey tableName="user_hierarchy" columnNames="Id" constraintName="pk_user_hierarchy" />
		<createIndex tableName="user_hierarchy" indexName="ix_uh_bv_p_ft_b_rt">
			<column name="business_vertical" />
			<column name="product" />
			<column name="Fin_Type" />
			<column name="branch" />
			<column name="reporting_To" />
		</createIndex>
	</changeSet>

	<changeSet id="59" author="amanullah.m">
		<createView viewName="FinanceEnquiry_Hierarchy_View" replaceIfExists="true">
			SELECT T1.FinReference,
			  T1.FinBranch,
			  T1.FinType,
			  T1.FinCcy,
			  T1.ScheduleMethod,
			  T1.ProfitDaysBasis,
			  T1.FinStartDate,
			  T1.CalTerms NumberOfTerms,
			  T1.CustID,
			  T1.FinAmount,
			  T1.GrcPeriodEndDate,
			  T1.MaturityDate,
			  T1.FinRepaymentAmount,
			  T1.FinIsActive,
			  T1.AllowGrcPeriod,
			  T1.DownPayment,
			  T1.MigratedFinance,
			  T1.LastRepayDate,
			  T1.LastRepayPftDate,
			  T1.FinCurrAssetvalue,
			  T1.Blacklisted,
			  T1.FeeChargeAmt,
			  T1.ClosingStatus,
			  T1.GraceTerms,
			  T1.AlwMultiDisb,
			  T1.Defferments,
			  T1.FinStatus,
			  T1.MandateID,
			  T1.FinRepayMethod,
			  T1.FINASSETVALUE,
			  T1.InsuranceAmt,
			  (T1.FinCurrAssetvalue+ T1.FeeChargeAmt+T1.InsuranceAmt+T1.TotalCpz) FinancingAmount,
			  T1.TotalCpz,
			  (T1.FinCurrAssetvalue+T1.TotalCpz- T1.FinRepaymentAmount+ T1.FeeChargeAmt+T1.InsuranceAmt) CurFinAmount,
			  T2.FinTypeDesc LovDescFinTypeName,
			  T2.FinScheduleOn LovDescFinScheduleOn,
			  T2.FinDivision lovDescFinDivision,
			  T2.FinCategory lovDescProductCodeName,
			  T2.FinIsAlwDifferment lovDescFinAlwDeferment,
			  T3.CustCIF LovDescCustCIF,
			  T3.CustShrtName LovDescCustShrtName,
			  T4.BranchDesc LovDescFinBranchName,
			  T5.CustTypeCtg,
			  COALESCE(T9.NOINST,0) NOINST
			  --T1.PROMOTIONSEQID ,
			  --T1.PromotionCode,
			  --T2.FinTypeClassification,
			  --T1.AutoIncGrcEndDate,
			  --T1.EndGrcPeriodAftrFullDisb,
			  --T1.AlwUnderConstruction,
			  --T1.AlwFlexi,
			  --T1.DropLineCalcOn,
			  --T1.AlwStrtPrdHday,
			  --T1.StrtPrdHdays,
			  --T1.StrtprdCpzMethod,
			  --T1.FlexiType
			FROM FinanceMain T1 
			INNER JOIN RMTFinanceTypes T2 ON T1.FinType = T2.FinType 
			INNER JOIN Customers T3 ON T1.CustID = T3.CustID
			INNER JOIN RMTBranches T4 ON T1.FinBranch = T4.BranchCode
			INNER JOIN RMTCustTypes T5 ON T3.CustTypeCode = T5.CustTypeCode
			LEFT JOIN FinPftDetails T9 ON T1.FinReference = T9.FinReference
			inner join USER_HIERARCHY H on T1.INITIATEUSER = H.UserId 
			inner join SecUsers u on u.UsrId = H.UserId
			and U.BusinessVertical = COALESCE(H.Business_Vertical, U.BusinessVertical) 
			and T1.FINCATEGORY = COALESCE(H.Product, T1.FINCATEGORY) 
			and T1.FinType = COALESCE(H.Fin_Type, T1.FinType) 
			and T1.FINBRANCH = COALESCE(H.Branch, T1.FINBRANCH)
		</createView>
	</changeSet>

	<changeSet id="60" author="amanullah.m">
		<createView viewName="FinanceEnquiry_Hierarchy_TView" replaceIfExists="true">
			SELECT T1.FinReference,
			  T1.FinBranch,
			  T1.FinType,
			  T1.FinCcy,
			  T1.ScheduleMethod,
			  T1.ProfitDaysBasis,
			  T1.FinStartDate,
			  T1.CalTerms NumberOfTerms,
			  T1.CustID,
			  T1.FinAmount,
			  T1.GrcPeriodEndDate,
			  T1.MaturityDate,
			  T1.FinRepaymentAmount,
			  T1.FinIsActive,
			  T1.AllowGrcPeriod,
			  T1.DownPayment,
			  T1.MigratedFinance,
			  T1.LastRepayDate,
			  T1.LastRepayPftDate,
			  T1.FinCurrAssetvalue,
			  T1.Blacklisted,
			  T1.FeeChargeAmt,
			  T1.ClosingStatus,
			  T1.GraceTerms,
			  T1.AlwMultiDisb,
			  T1.Defferments,
			  T1.FinStatus ,
			  T1.MandateID,
			  T1.FinRepayMethod,
			  T1.FINASSETVALUE,
			  (T1.FinCurrAssetvalue+T1.TotalCpz+ T1.FeeChargeAmt+T1.InsuranceAmt) FinancingAmount,
			  T1.TotalCpz,
			  (T1.FinCurrAssetvalue+T1.TotalCpz- T1.FinRepaymentAmount+ T1.FeeChargeAmt+T1.InsuranceAmt) CurFinAmount,
			  T2.FinTypeDesc LovDescFinTypeName,
			  T2.FinScheduleOn LovDescFinScheduleOn,
			  T2.FinDivision lovDescFinDivision,
			  T2.FinCategory lovDescProductCodeName,
			  T2.FinIsAlwDifferment lovDescFinAlwDeferment,
			  T3.CustCIF LovDescCustCIF,
			  T3.CustShrtName LovDescCustShrtName,
			  T4.BranchDesc LovDescFinBranchName,
			  T5.CustTypeCtg,
			  COALESCE(T9.NOINST,0) NOINST
			--  T1.PROMOTIONSEQID ,
			--  T1.PromotionCode ,
			--  T2.FinTypeClassification,
			--  T1.AutoIncGrcEndDate,
			--  T1.EndGrcPeriodAftrFullDisb,
			--  T1.AlwUnderConstruction,
			--  T1.AlwFlexi,
			--  T1.DropLineCalcOn,
			--  T1.AlwStrtPrdHday,
			--  T1.StrtPrdHdays,
			--  T1.StrtprdCpzMethod
			FROM FinanceMain_Temp T1 
			INNER JOIN RMTFinanceTypes T2 ON T1.FinType = T2.FinType 
			INNER JOIN Customers T3 ON T1.CustID = T3.CustID
			INNER JOIN RMTBranches T4 ON T1.FinBranch = T4.BranchCode
			INNER JOIN RMTCustTypes T5 ON T3.CustTypeCode = T5.CustTypeCode
			LEFT JOIN FinPftDetails T9 ON T1.FinReference = T9.FinReference
			inner join USER_HIERARCHY H on T1.INITIATEUSER = H.UserId 
			inner join SecUsers u on u.UsrId = H.UserId
			and U.BusinessVertical = COALESCE(H.Business_Vertical, U.BusinessVertical) 
			and T1.FINCATEGORY = COALESCE(H.Product, T1.FINCATEGORY) 
			and T1.FinType = COALESCE(H.Fin_Type, T1.FinType) 
			and T1.FINBRANCH = COALESCE(H.Branch, T1.FINBRANCH)
		</createView>
	</changeSet>

	<changeSet id="61" author="shinde.b">
		<createView viewName="userhierarchy_view" replaceIfExists="true">
			SELECT u.usrId userId,
			  u.usrLogin userName,
			  bv.Code BusinessVerticalCode,
			  bv.Description BusinessVerticalDesc,
			  h.product,
			  p.productDesc,
			  ft.fintype,
			  ft.fintypedesc,
			  h.branch,
			  b.branchDesc,
			  h.reporting_to,
			  rt.usrlogin reportingToUserName
			FROM SecUsers u
			LEFT JOIN User_hierarchy h ON u.usrId = h.userId
			LEFT JOIN business_vertical bv ON bv.id=h.business_vertical
			LEFT JOIN bmtproduct p ON p.productCode=h.product
			LEFT JOIN rmtbranches b ON b.branchCode=h.branch
			LEFT JOIN rmtfinancetypes ft ON ft.finType=h.fin_Type
			LEFT JOIN secusers rt ON rt.usrid=h.reporting_to
		</createView>
	</changeSet>

</databaseChangeLog>
