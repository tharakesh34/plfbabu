<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
<property name="call.concatenate" value="+" dbms="mssql" />
<property name="call.concatenate" value="||" dbms="oracle" />
<property name="call.maindb" value="PLF.." dbms="mssql"/>
<property name="call.maindb" value="PLF." dbms="oracle"/>

	<changeSet id="pre_run_for_pgp" author="Kesav" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plfaudit,public,pg_catalog;
		</sql>
	</changeSet>

	<!-- Entity -->
	<changeSet id="1" author="Kesav">
		<addColumn tableName="AdtEntity">
			<column name="GSTINAvailable" type="boolean" defaultValue="0"/>
		</addColumn>
	</changeSet>
	
	<!-- TAXDETAIL -->
	<changeSet id="2" author="Kesav">
		<addColumn tableName="AdtTAXDETAIL">
			<column name="hsnNumber" type="varchar(100)"/>
			<column name="natureService" type="varchar(100)"/>
		</addColumn>
	</changeSet>
	<changeSet id="3" author="Jayant" dbms="postgresql">
		<sql>
			select deps_save_and_drop_dependencies('plfaudit','adtfeetypes');
		</sql>
	</changeSet>
	<changeSet id="4" author="Jayant">
		<modifyDataType tableName="adtfeetypes" columnName="TaxApplicable" newDataType="boolean"/>
	</changeSet>
	<changeSet id="5" author="Jayant" dbms="postgresql">
		<sql>
			select deps_restore_dependencies('plfaudit','adtfeetypes');
		</sql>
	</changeSet>
	
	<changeSet author="Kesav" id="6">
		<comment> new columns added for GST calculations</comment>
		<addColumn tableName="AdtManualAdvise">
			<column name="PaidCgst" type="decimal(18,0)" defaultValue="0"/>
			<column name="PaidSgst" type="decimal(18,0)" defaultValue="0"/>
			<column name="PaidUgst" type="decimal(18,0)" defaultValue="0"/>
			<column name="PaidIgst" type="decimal(18,0)" defaultValue="0"/>
		</addColumn>
	</changeSet>
	
	<changeSet id="7" author="Kesav">
		<comment> Old fields updated </comment>
		<sql>
			Update AdtManualAdvise set PaidCgst = 0 where PaidCgst is null; 
			Update AdtManualAdvise set PaidSgst = 0 where PaidSgst is null; 
			Update AdtManualAdvise set PaidUgst = 0 where PaidUgst is null; 
			Update AdtManualAdvise set PaidIgst = 0 where PaidIgst is null; 
		</sql>
	</changeSet>
	
	<changeSet id="8" author="Kesav">
		<addColumn tableName="AdtBounceReasons">
			<column name="TaxApplicable" type="boolean"  defaultValue="0" />
			<column name="TaxComponent" type="Char(1)"/>
		</addColumn>
	</changeSet>
	
	<changeSet id="9" author="Kesav">
		<comment> Old fields updated </comment>
		<sql>
			Update AdtBounceReasons set TaxApplicable = 0 where TaxApplicable is null; 
		</sql>
	</changeSet>
	
</databaseChangeLog>
