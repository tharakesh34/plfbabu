<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />
	
	<changeSet id="01" author="Irfan">
<renameColumn tableName="RMTACCOUNTTYPES" oldColumnName="gSTApplicable" newColumnName="taxApplicable"/>
<renameColumn tableName="RMTACCOUNTTYPES" oldColumnName="hSNNumber" newColumnName="aCCADDLVAR1"/>
<renameColumn tableName="RMTACCOUNTTYPES" oldColumnName="natureService" newColumnName="aCCADDLVAR2"/>
<renameColumn tableName="RMTACCOUNTTYPES" oldColumnName="revChrgApplicable" newColumnName="aCCADDLCHAR1"/>
<renameColumn tableName="RMTACCOUNTTYPES_TEMP" oldColumnName="gSTApplicable" newColumnName="taxApplicable"/>
<renameColumn tableName="RMTACCOUNTTYPES_TEMP" oldColumnName="hSNNumber" newColumnName="aCCADDLVAR1"/>
<renameColumn tableName="RMTACCOUNTTYPES_TEMP" oldColumnName="natureService" newColumnName="aCCADDLVAR2"/>
<renameColumn tableName="RMTACCOUNTTYPES_TEMP" oldColumnName="revChrgApplicable" newColumnName="aCCADDLCHAR1"/>
</changeSet>
<changeSet id="02" author="Irfan">
<addColumn tableName="RMTACCOUNTTYPES">
	<column name="aCCADDLVAR3" type="varchar(50)"/>
	<column name="aCCADDLVAR4" type="varchar(50)"/>
</addColumn>
<addColumn tableName="RMTACCOUNTTYPES_TEMP">
	<column name="aCCADDLVAR3" type="varchar(50)"/>
	<column name="aCCADDLVAR4" type="varchar(50)"/>
</addColumn>

</changeSet>

<changeSet id="03" author="Irfan">
	<createView viewName="RMTACCOUNTTYPES_VIEW" replaceIfExists="true">
	
	SELECT    T1.AcType, T1.AcTypeDesc,  T1.AcPurpose, T1.AcHeadCode, T1.InternalAc, T1.CustSysAc, 
			  T1.AcLmtCategory, T1.AcTypeIsActive,T1.ProfitCenterID,T1.CostCenterID, T1.TaxApplicable,  T1.ACCADDLVAR1, T1.ACCADDLVAR2, T1.ACCADDLCHAR1,
			  T1.ACCADDLVAR3, T1.ACCADDLVAR4, T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode,
			 T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T1.AssertOrLiability,
			 T1.OnBalanceSheet,T1.AllowOverDraw,T1.AcTypeGrpId,T2.GroupCode,T2.GroupDescription,T2.AcctTypeLevel,
			 T4.ProfitCenterCode,T4.ProfitCenterDesc,T3.CostCenterCode,T3.CostCenterDesc
			 FROM         RMTAccountTypes_Temp T1 Left Join
									AccountTypeGroup T2 ON T1.AcTypeGrpId=T2.GroupId INNER JOIN
											ProfitCenters T4 ON T1.ProfitCenterID = T4.ProfitCenterID
											LEFT JOIN
											CostCenters T3 ON T1.CostCenterID = T3.CostCenterID 
			 UNION ALL
			SELECT    T1.AcType, T1.AcTypeDesc,  T1.AcPurpose, T1.AcHeadCode, T1.InternalAc, T1.CustSysAc, 
			T1.AcLmtCategory, T1.AcTypeIsActive, T1.ProfitCenterID,T1.CostCenterID, T1.TaxApplicable,  T1.ACCADDLVAR1, T1.ACCADDLVAR2, T1.ACCADDLCHAR1,
			 T1.ACCADDLVAR3, T1.ACCADDLVAR4,T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode,
			 T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T1.AssertOrLiability,
			 T1.OnBalanceSheet,T1.AllowOverDraw,T1.AcTypeGrpId,T2.GroupCode,T2.GroupDescription,T2.AcctTypeLevel,
			 T4.ProfitCenterCode,T4.ProfitCenterDesc,T3.CostCenterCode,T3.CostCenterDesc
			 FROM         RMTAccountTypes T1 Left Join
									AccountTypeGroup T2 ON T1.AcTypeGrpId=T2.GroupId INNER JOIN
											ProfitCenters T4 ON T1.ProfitCenterID = T4.ProfitCenterID
											LEFT JOIN
											CostCenters T3 ON T1.CostCenterID = T3.CostCenterID 
			 WHERE     (NOT EXISTS
			 (SELECT     1 Expr1
			 FROM          RMTAccountTypes_Temp
			 WHERE      (AcType = T1.AcType)))
	
	</createView>

</changeSet>

<changeSet id="04" author="Irfan">
	<createView viewName="RMTACCOUNTTYPES_AVIEW" replaceIfExists="true">
		SELECT    T1.AcType, T1.AcTypeDesc, T1.AcPurpose, T1.AcHeadCode, T1.InternalAc, T1.CustSysAc, 
		T1.AcLmtCategory, T1.AcTypeIsActive, T1.ProfitCenterID, T1.CostCenterID, T1.TaxApplicable,  T1.ACCADDLVAR1, T1.ACCADDLVAR2, T1.ACCADDLCHAR1, 
		T1.ACCADDLVAR3, T1.ACCADDLVAR4, T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode,
					 T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T1.AssertOrLiability,
		       T1.OnBalanceSheet,T1.AllowOverDraw,T1.AcTypeGrpId,T2.GroupCode,T2.GroupDescription,T2.AcctTypeLevel,
		       T4.ProfitCenterCode,T4.ProfitCenterDesc,T3.CostCenterCode,T3.CostCenterDesc
					 FROM         RMTAccountTypes T1 Left Join
											AccountTypeGroup T2 ON T1.AcTypeGrpId=T2.GroupId 
											INNER JOIN
											ProfitCenters T4 ON T1.ProfitCenterID = T4.ProfitCenterID
											LEFT JOIN
											CostCenters T3 ON T1.CostCenterID = T3.CostCenterID
	
	</createView>

</changeSet>
	
</databaseChangeLog>