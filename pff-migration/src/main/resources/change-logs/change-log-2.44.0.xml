<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />



	<changeSet author="DurgaPrasad G" id="02">
		<sql>
			UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE
			GRPCODE='CL_ORIGINATION_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_AssetTypeAssignmentDialog_btnDelete'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS);

		</sql>
	</changeSet>
	<changeSet id="1" author="Subbarao">
		<sql>
			INSERT into SecGroups VALUES ((Select MAX(GrpID)+1 From SecGroups), 'PFSPARAMETER_MAKER', 'WF Maker for System Parameter', 0, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL,0);
			INSERT into SecGroups VALUES ((Select MAX(GrpID)+1 From SecGroups), 'PFSPARAMETER_APPROVER', 'WF Approver for System Parameter', 0, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL,0);
			
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='PFSPARAMETER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='PFSParameterDialog_sysParmDescription'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='PFSPARAMETER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='PFSParameterDialog_sysParmValue'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='PFSPARAMETER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_PFSParameterDialog_btnEdit'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='PFSPARAMETER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_PFSParameterDialog_btnSave'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='PFSPARAMETER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menuCat_SolutionFactory'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='PFSPARAMETER_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='menuItem_SolutionFactory_PFSParameter'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='PFSPARAMETER_APPROVER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_PFSParameterDialog_btnSave'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			
			
			INSERT INTO secRoleGroups Values((Select max(RoleGrpID)+1 from secRoleGroups),(Select GrpID from SecGroups where GrpCode = 'PFSPARAMETER_MAKER'),(Select RoleID from secRoles where RoleCd = 'MSTGRP1_MAKER'), 0, 1000, CURRENT_TIMESTAMP, null, null,null,null,null,null,0);
			INSERT INTO secRoleGroups Values((Select max(RoleGrpID)+1 from secRoleGroups),(Select GrpID from SecGroups where GrpCode = 'PFSPARAMETER_APPROVER'),(Select RoleID from secRoles where RoleCd = 'MSTGRP1_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, null, null,null,null,null,null,0);
		</sql>
	</changeSet>
	<changeSet id="4" author="satish">
	<sql>
insert into SMTparameters values('EOD_THREAD_COUNT','Number of Threads','int',0,1,1,0,null,null,'Number of Threads',1,1000,
CURRENT_TIMESTAMP,'Approved','','','','','',0 );

update SeqSecRoles set seqno=(select MAX(RoleID) from SecRoles);
update seqSecGroups set seqno=(select MAX(GrpID) from SecGroups);
update seqSecRights set seqno=(select MAX(RIGHTID) from SecRights);
update SeqSecRoleGroups set seqno=(select MAX(RoleGrpID) from SecRoleGroups);
update seqSecGroupRights set seqno=(select MAX(GrpRIGHTID) from SecGroupRights);

INSERT INTO SecGroups SELECT (select (SeqNo+5) from SeqSecGroups), 'EOD', 'Eed of day', 0,1000,'2016-10-18 01:16:33',' ',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
INSERT INTO SecRights SELECT (select (SeqNo+1) from SeqSecRights),0,'menuItem_EOD_CustomerEOD','MENU',0,1000,'2016-10-18 01:16:33',' ',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
INSERT INTO SecGroupRights SELECT (select MAX(GrpRIGHTID)+1 from SecGroupRights),(select grpid from secgroups where GrpCode='EOD'), (select RightID from SecRights where RightName='menuItem_EOD_CustomerEOD'),1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
INSERT INTO SecRoles SELECT (select MAX(RoleID)+1 from SecRoles),1,'EOD','End of day','',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SeqSecRoles WHERE 0=0;
INSERT INTO SecRoleGroups SELECT (select MAX(RoleGrpID)+1 from SecRoleGroups),(select grpid from secgroups where GrpCode='EOD'), (select RoleID from SecRoles where RoleCd='EOD'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SeqSecRoleGroups WHERE 0=0;

update SeqSecRoles set seqno=(select MAX(RoleID) from SecRoles);
update seqSecGroups set seqno=(select MAX(GrpID) from SecGroups);
update seqSecRights set seqno=(select MAX(RIGHTID) from SecRights);
update SeqSecRoleGroups set seqno=(select MAX(RoleGrpID) from SecRoleGroups);
update seqSecGroupRights set seqno=(select MAX(GrpRIGHTID) from SecGroupRights);
	
	</sql>
	</changeSet>
	
	<changeSet id="5" author="durgaPrasadG">
		<addColumn tableName="SecUsers">
			<column name="AuthType" type="char(3)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="6" author="durgaPrasadG">
		<sql>
	   Update SecUsers set Authtype = 'DAO';
		</sql>
	</changeSet>
	
	<changeSet id="7" author="durgaPrasadG">
		<addNotNullConstraint tableName="SecUsers"
			columnName="AuthType" columnDataType="char(3)" />
	</changeSet>
	
	<changeSet id="8" author="satish">
	<dropTable tableName="FinPftDetails_SnapShot" />
	</changeSet>
	<changeSet id="9" author="satish">
		<createTable tableName="FinPftDetails_SnapShot">
			<column name="AppDate" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="FinReference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="CustId" type="bigint" />
			<column name="FinBranch" type="varchar(12)" />
			<column name="FinType" type="varchar(8)">
				<constraints nullable="false" />
			</column>
			<column name="LastMdfDate" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="TotalPftSchd" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TotalPftCpz" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TotalPftPaid" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TotalPftBal" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TotalPftPaidInAdv" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TotalPriPaid" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TotalPriBal" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdSchdPft" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdPftCpz" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdSchdPftPaid" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdSchdPftBal" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdPftAccrued" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdPftAccrueSusp" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdPftAmortized" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdPftAmortizedSusp" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdSchdPri" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdSchdPriPaid" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="TdSchdPriBal" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="AcrTillNBD" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="AcrTillLBD" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="AcrTodayToNBD" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="AmzTillNBD" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="AmzTillLBD" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="AmzTodayToNBD" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="RepayFrq" type="varchar(5)" />
			<column name="CustCIF" type="varchar(20)" />
			<column name="FinCcy" type="char(3)" />
			<column name="FinPurpose" type="varchar(8)" />
			<column name="FinContractDate" type="datetime" />
			<column name="FinApprovedDate" type="datetime" />
			<column name="FinStartDate" type="datetime" />
			<column name="MaturityDate" type="datetime" />
			<column name="FullPaidDate" type="datetime" />
			<column name="FinAmount" type="decimal(18, 0)" />
			<column name="DownPayment" type="decimal(18, 0)" />
			<column name="CurReducingRate" type="decimal(13, 9)" />
			<column name="curFlatRate" type="decimal(13, 9)" />
			<column name="TotalpriSchd" type="decimal(18, 0)" />
			<column name="EarlyPaidAmt" type="decimal(18, 0)" />
			<column name="ODPrincipal" type="decimal(18, 0)" />
			<column name="ODProfit" type="decimal(18, 0)" />
			<column name="PenaltyPaid" type="decimal(18, 0)" />
			<column name="PenaltyDue" type="decimal(18, 0)" />
			<column name="PenaltyWaived" type="decimal(18, 0)" />
			<column name="NSchdDate" type="datetime" />
			<column name="NSchdPri" type="decimal(18, 0)" />
			<column name="NSchdPft" type="decimal(18, 0)" />
			<column name="NSchdPriDue" type="decimal(18, 0)" />
			<column name="NSchdPftDue" type="decimal(18, 0)" />
			<column name="AccruePft" type="decimal(18, 0)" />
			<column name="EarnedPft" type="decimal(18, 0)" />
			<column name="Unearned" type="decimal(18, 0)" />
			<column name="PftInSusp" type="bit">
				<constraints nullable="false" />
			</column>
			<column name="SuspPft" type="decimal(18, 0)" />
			<column name="PftAccrueTsfd" type="decimal(18, 0)" />
			<column name="FinStatus" type="varchar(8)" />
			<column name="FinStsReason" type="varchar(1)" />
			<column name="FinWorstStatus" type="varchar(8)" />
			<column name="AdminPaidAmt" type="decimal(18, 0)" />
			<column name="NOInst" type="bigint" />
			<column name="NOPaidInst" type="bigint" />
			<column name="NOODInst" type="bigint" />
			<column name="FinAccount" type="varchar(50)" />
			<column name="FinAcType" type="varchar(8)" />
			<column name="DisbAccountId" type="varchar(50)" />
			<column name="DisbActCcy" type="char(3)" />
			<column name="RepayAccountId" type="varchar(50)" />
			<column name="FinCustPftAccount" type="varchar(50)" />
			<column name="IncomeAccount" type="varchar(50)" />
			<column name="UEIncomeSuspAccount" type="varchar(50)" />
			<column name="FinCommitmentRef" type="varchar(20)" />
			<column name="FinIsActive" type="bit">
				<constraints nullable="false" />
			</column>
			<column name="NORepayments" type="bigint" />
			<column name="FirstRepayDate" type="datetime" />
			<column name="FirstRepayAmt" type="decimal(18, 0)" />
			<column name="LastRepayAmt" type="decimal(18, 0)" />
			<column name="ODDays" type="int" />
			<column name="FirstODDate" type="datetime" />
			<column name="LastODDate" type="datetime" />
			<column name="ClosingStatus" type="char(1)" />
			<column name="FinCategory" type="varchar(8)" />
			<column name="LastRpySchDate" type="datetime" />
			<column name="NextRpySchDate" type="datetime" />
			<column name="LastRpySchPri" type="decimal(18, 0)" />
			<column name="LastRpySchPft" type="decimal(18, 0)" />
			<column name="LatestRpyDate" type="datetime" />
			<column name="LatestRpyPri" type="decimal(18, 0)" />
			<column name="LatestRpyPft" type="decimal(18, 0)" />
			<column name="LatestWriteOffDate" type="datetime" />
			<column name="TotalWriteoff" type="decimal(18, 0)" />
			<column name="PrvPftAccrueTsfd" type="decimal(18, 0)" />
			<column name="SuspPftAccrueTsfd" type="decimal(18, 0)" />
			<column name="AccumulatedDepPri" type="decimal(18, 0)" />
			<column name="DepreciatePri" type="decimal(18, 0)" />
			<column name="AcrTsfdInSusp" type="decimal(18, 0)">
				<constraints nullable="false" />
			</column>
			<column name="CRBFirstODDate" type="datetime" />
			<column name="CRBLastODDate" type="datetime" />
			<column name="CRBODPrincipal" type="decimal(18, 0)" />
			<column name="CRBODProfit" type="decimal(18, 0)" />
			<column name="CRBODDays" type="int" />
			<column name="CRBODInst" type="int" />
			<column name="TotalAdvPftSchd" type="decimal(18, 0)" />
			<column name="TotalRbtSchd" type="decimal(18, 0)" />
			<column name="TotalPriPaidInAdv" type="decimal(18, 0)" />
			<column name="TdSchdAdvPft" type="decimal(18, 0)" />
			<column name="TdSchdRbt" type="decimal(18, 0)" />
			<column name="TdPftAmortizedNormal" type="decimal(18, 0)" />
			<column name="TdPftAmortizedPD" type="decimal(18, 0)" />
			<column name="AmzTillLBDNormal" type="decimal(18, 0)" />
			<column name="AmzTillLBDPD" type="decimal(18, 0)" />
			<column name="AmzTillLBDPIS" type="decimal(18, 0)" />
			<column name="InsPaidAmt" type="decimal(18, 0)" />
			<column name="InsCal" type="decimal(18, 0)" />
		</createTable>
	</changeSet>
	<changeSet id="10" author="satish">
		<addPrimaryKey columnNames="AppDate, FinReference" constraintName="PK_FinPftDetails_SnapShot" tableName="FinPftDetails_SnapShot" />
	</changeSet>
	<changeSet id="11" author="Satish">
		<createTable tableName="FinanceRateReview">
			<column name="FinReference" type="varchar(50)">
				<constraints nullable="false" />
			</column>
			<column name="RateType" type="varchar(50)">
				<constraints nullable="false" />
			</column>
			<column name="Currency" type="varchar(3)" />
			<column name="ValueDate" type="datetime" />
			<column name="EffectiveDate" type="datetime" />
			<column name="EventFromDate" type="datetime" />
			<column name="EventToDate" type="datetime" />
			<column name="RecalFromdate" type="datetime" />
			<column name="RecalToDate" type="datetime" />
			<column name="EMIAmount" type="decimal(18, 0)" />
		</createTable>
	</changeSet>
	<changeSet id="12" author="satish">
		<createTable tableName="CustomerQueuing">
			<column name="CustID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="EodDate" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="ThreadId" type="varchar(50)" />
			<column name="StartTime" type="datetime" />
			<column name="EndTime" type="datetime" />
			<column name="Progress" type="varchar(15)" />
			<column name="ErrorLog" type="varchar(2000)" />
			<column name="Status" type="varchar(15)" />
		</createTable>
	</changeSet>
	<changeSet id="13" author="satish">
		<createTable tableName="CustomerQueuing_Log">
			<column name="CustID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="EodDate" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="ThreadId" type="varchar(50)" />
			<column name="StartTime" type="datetime" />
			<column name="EndTime" type="datetime" />
			<column name="Progress" type="varchar(15)" />
			<column name="ErrorLog" type="varchar(2000)" />
			<column name="Status" type="varchar(15)" />
		</createTable>
	</changeSet>
	<changeSet id="14" author="satish">
		<createTable tableName="CustomerDates">
			<column name="CustID" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="AppDate" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="ValueDate" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="NextBusinessDate" type="datetime">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="15" author="satish">
		<createTable tableName="EodDetails">
			<column name="ProcessDate" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="StatTime" type="datetime" />
			<column name="EndTime" type="datetime" />
			<column name="Status" type="varchar(15)" />
		</createTable>
	</changeSet>
		<changeSet id="16" author="Pruthvi">
		<sql>
	update reportlist set ReportFileName='ReportList08'
where code='OriginationFinanceMain';

update reportlist set ReportHeading='Customers',ModuleType='Customer Enquiry'
where code='Customer';

update reportlist set ModuleType='Customer Enquiry'
where code='Mandate';

update reportlist set ModuleType='Customer Enquiry'
where code='Beneficiary';
	</sql>
	</changeSet>
	
		<changeSet id="17" author="Pruthvi">
		<sql>  		 
update reportlist set ReportHeading='Overdue Interest'
where code='LTPPENQ';
			</sql>
	</changeSet>
			<changeSet id="18" author="Pruthvi">
	<createView viewName="FINANCEENQUIRY_TVIEW" replaceIfExists="true">
		SELECT     T1.FinReference, T1.FinBranch, T1.FinType, T1.FinCcy, T1.ScheduleMethod, T1.ProfitDaysBasis, T1.FinStartDate, T1.CalTerms NumberOfTerms, T1.CustID, T1.FinAmount, 
                      T1.GrcPeriodEndDate, T1.MaturityDate, T1.FinRepaymentAmount, T1.FinIsActive, T1.AllowGrcPeriod,T1.DownPayment, 
                      T1.MigratedFinance,T1.LastRepayDate, T1.LastRepayPftDate,
                      T5.FinTypeDesc LovDescFinTypeName, T6.CustCIF LovDescCustCIF, T6.CustShrtName LovDescCustShrtName, T7.BranchDesc LovDescFinBranchName, 
                      T1.Blacklisted, T5.FinScheduleOn LovDescFinScheduleOn, T1.FeeChargeAmt, T1.ClosingStatus, T8.CustTypeCtg, 
                      T1.GraceTerms, T5.FinDivision lovDescFinDivision, T5.FinCategory lovDescProductCodeName, 
                      T1.AlwMultiDisb, T5.FinIsAlwDifferment lovDescFinAlwDeferment,T1.Defferments,
                       (T1.FinAmount-T1.DownPayment+ T1.FeeChargeAmt+T1.InsuranceAmt) FinancingAmount,
                      (T1.FinAmount-T1.DownPayment- T1.FinRepaymentAmount+ T1.FeeChargeAmt+T1.InsuranceAmt) CurFinAmount,
                      T1.FinStatus ,T1.MandateID,T1.FinRepayMethod
FROM          FinanceMain_Temp T1 INNER JOIN
                       RMTFinanceTypes T5 ON T1.FinType = T5.FinType INNER JOIN
                       Customers T6 ON T1.CustID = T6.CustID INNER JOIN
                       RMTBranches T7 ON T1.FinBranch = T7.BranchCode INNER JOIN
                       RMTCustTypes T8 ON T6.CustTypeCode = T8.CustTypeCode
		</createView>
		</changeSet>
		

	<changeSet id="19" author="durgaPrasadG">
		<addColumn tableName="SecUsers_RTemp">
			<column name="AuthType" type="char(3)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="20" author="durgaPrasadG">
		<sql>
	   Update SecUsers_RTemp set Authtype = 'DAO';
		</sql>
	</changeSet>
	
	<changeSet id="21" author="durgaPrasadG">
		<addNotNullConstraint tableName="SecUsers_RTemp"
			columnName="AuthType" columnDataType="char(3)" />
	</changeSet>
	
	<changeSet id="22" author="durgaPrasadG">
		<addColumn tableName="SecUsers_Temp">
			<column name="AuthType" type="char(3)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="23" author="durgaPrasadG">
		<sql>
	   Update SecUsers_Temp set Authtype = 'DAO';
		</sql>
	</changeSet>
	
	<changeSet id="24" author="durgaPrasadG">
		<addNotNullConstraint tableName="SecUsers_Temp"
			columnName="AuthType" columnDataType="char(3)" />
	</changeSet>
	


<changeSet id="25" author="durgaPrasadG">
	<createView viewName="SecUsers_View" replaceIfExists="true">
		SELECT T1.UsrID , T1.UsrLogin ,  T1.UsrPwd ,  T1.UserStaffID , T1.UsrFName ,  T1.UsrMName , T1.UsrLName , T1.UsrMobile ,  T1.UsrEmail ,   T1.UsrEnabled ,
		  T1.UsrCanSignonFrom ,   T1.UsrCanSignonTo ,  T1.UsrCanOverrideLimits ,  T1.UsrAcExp ,  T1.UsrAcExpDt ,  T1.UsrCredentialsExp ,  T1.UsrAcLocked ,
		  T1.UsrLanguage ,  T5.LngDesc LovDescUsrLanguage  , T1.UsrDftAppId ,   T2.AppCode LovDescUsrDftAppCode  , T2.AppDescription LovDescUsrDftAppCodeName  , 
          T1.UsrBranchCode ,   T4.BranchDesc LovDescUsrBranchCodeName  ,   T1.UsrDeptCode ,  T3.DeptDesc LovDescUsrDeptCodeName  , T1.UsrToken , 
          T1.UsrIsMultiBranch ,  T1.UsrInvldLoginTries ,  T1.UsrDesg , T6.DesgDesc LovDescUsrDesg  , T1.Version ,
		  T1.LastMntBy ,T1.LastMntOn ,  T1.RecordStatus , T1.RoleCode , T1.NextRoleCode ,  T1.TaskId , T1.NextTaskId ,  
		  T1.RecordType , T1.WorkflowId ,T1.UsrDftAppCode, T1.AuthType 
     FROM SecUsers_Temp T1
            LEFT OUTER JOIN PTApplicationDetails T2   ON T1.UsrDftAppId = T2.AppID
            LEFT OUTER JOIN BMTDepartments T3   ON T1.UsrDeptCode = T3.DeptCode
            LEFT OUTER JOIN RMTBranches T4   ON T1.UsrBranchCode = T4.BranchCode
            LEFT OUTER JOIN BMTLanguage T5   ON T1.UsrLanguage = T5.LngCode
            LEFT OUTER JOIN BMTDesignations T6   ON T1.UsrDesg = T6.DesgCode
   UNION ALL 
   SELECT T1.UsrID ,
          T1.UsrLogin ,  T1.UsrPwd , T1.UserStaffID , T1.UsrFName , T1.UsrMName , T1.UsrLName , T1.UsrMobile ,
          T1.UsrEmail , T1.UsrEnabled ,  T1.UsrCanSignonFrom ,  T1.UsrCanSignonTo ,  T1.UsrCanOverrideLimits ,  T1.UsrAcExp ,
		  T1.UsrAcExpDt , T1.UsrCredentialsExp , T1.UsrAcLocked ,  T1.UsrLanguage , T5.LngDesc LovDescUsrLanguage  , T1.UsrDftAppId ,
          T2.AppCode LovDescUsrDftAppCode  ,  T2.AppDescription LovDescUsrDftAppCodeName  , T1.UsrBranchCode ,  T4.BranchDesc LovDescUsrBranchCodeName  , 
          T1.UsrDeptCode ,T3.Deptdesc LovDescUsrDeptCodeName  , T1.UsrToken , T1.UsrIsMultiBranch , T1.UsrInvldLoginTries ,  T1.UsrDesg , 
          T6.DesgDesc LovDescUsrDesg  , T1.Version , T1.LastMntBy ,T1.LastMntOn , T1.RecordStatus , T1.RoleCode , T1.NextRoleCode ,
		  T1.TaskId , T1.NextTaskId ,T1.RecordType ,  T1.WorkflowId ,   T1.UsrDftAppCode, T1.AuthType 
     FROM SecUsers T1
            LEFT OUTER JOIN PTApplicationDetails T2   ON T1.UsrDftAppId = T2.AppID
            LEFT OUTER JOIN BMTDepartments T3   ON T1.UsrDeptCode = T3.DeptCode
            LEFT OUTER JOIN RMTBranches T4   ON T1.UsrBranchCode = T4.BranchCode
            LEFT OUTER JOIN BMTLanguage T5   ON T1.UsrLanguage = T5.LngCode
            LEFT OUTER JOIN BMTDesignations T6   ON T1.UsrDesg = T6.DesgCode
     WHERE NOT EXISTS ( SELECT 1  FROM SecUsers_Temp   WHERE UsrID = T1.UsrID )
		</createView>
</changeSet>


<changeSet id="26" author="durgaPrasadG">
	<createView viewName="SecUsers_RView" replaceIfExists="true">
		SELECT T1.UsrID ,
          T1.UsrLogin ,
          T1.UsrPwd ,
          T1.UserStaffID ,
          T1.UsrFName ,
          T1.UsrMName ,
          T1.UsrLName ,
          T1.UsrMobile ,
          T1.UsrEmail ,
          T1.UsrEnabled ,
          T1.UsrCanSignonFrom ,
          T1.UsrCanSignonTo ,
          T1.UsrCanOverrideLimits ,
          T1.UsrAcExp ,
          T1.UsrAcExpDt ,
          T1.UsrCredentialsExp ,
          T1.UsrAcLocked ,
          T1.UsrLanguage ,
          T5.LngDesc LovDescUsrLanguage  ,
          T1.UsrDftAppId ,
          T2.AppCode LovDescUsrDftAppCode  ,
          T2.AppDescription LovDescUsrDftAppCodeName  ,
          T1.UsrBranchCode ,
          T4.BranchDesc LovDescUsrBranchCodeName  ,
          T1.UsrDeptCode ,
          T3.DeptDesc LovDescUsrDeptCodeName  ,
          T1.UsrToken ,
          T1.UsrIsMultiBranch ,
          T1.UsrInvldLoginTries ,
          T1.UsrDesg ,
          T6.DesgDesc LovDescUsrDesg  ,
          T1.Version ,
          T1.LastMntBy ,
          T1.LastMntOn ,
          T1.RecordStatus ,
          T1.RoleCode ,
          T1.NextRoleCode ,
          T1.TaskId ,
          T1.NextTaskId ,
          T1.RecordType ,
          T1.WorkflowId ,
          T1.UsrDftAppCode,
		  T1.AuthType 		  
     FROM SecUsers_RTemp T1
            JOIN PTApplicationDetails T2   ON T1.UsrDftAppId = T2.AppID
           JOIN BMTDepartments T3   ON T1.UsrDeptCode = T3.DeptCode
            JOIN RMTBranches T4   ON T1.UsrBranchCode = T4.BranchCode
            JOIN BMTLanguage T5   ON T1.UsrLanguage = T5.LngCode
            JOIN BMTDesignations T6   ON T1.UsrDesg = T6.DesgCode
   UNION ALL 
   SELECT T1.UsrID ,
          T1.UsrLogin ,
          T1.UsrPwd ,
          T1.UserStaffID ,
          T1.UsrFName ,
          T1.UsrMName ,
          T1.UsrLName ,
          T1.UsrMobile ,
          T1.UsrEmail ,
          T1.UsrEnabled ,
          T1.UsrCanSignonFrom ,
          T1.UsrCanSignonTo ,
          T1.UsrCanOverrideLimits ,
          T1.UsrAcExp ,
          T1.UsrAcExpDt ,
          T1.UsrCredentialsExp ,
          T1.UsrAcLocked ,
          T1.UsrLanguage ,
          T5.LngDesc LovDescUsrLanguage  ,
          T1.UsrDftAppId ,
          T2.AppCode LovDescUsrDftAppCode  ,
          T2.AppDescription LovDescUsrDftAppCodeName  ,
          T1.UsrBranchCode ,
          T4.BranchDesc LovDescUsrBranchCodeName  ,
          T1.UsrDeptCode ,
          T3.DeptDesc LovDescUsrDeptCodeName  ,
          T1.UsrToken ,
          T1.UsrIsMultiBranch ,
          T1.UsrInvldLoginTries ,
          T1.UsrDesg ,
          T6.DesgDesc LovDescUsrDesg  ,
          T1.Version ,
          T1.LastMntBy ,
          T1.LastMntOn ,
          T1.RecordStatus ,
          T1.RoleCode ,
          T1.NextRoleCode ,
          T1.TaskId ,
          T1.NextTaskId ,
          T1.RecordType ,
          T1.WorkflowId ,
          T1.UsrDftAppCode,
		  T1.AuthType 		  
     FROM SecUsers T1
            JOIN PTApplicationDetails T2   ON T1.UsrDftAppId = T2.AppID
            JOIN BMTDepartments T3   ON T1.UsrDeptCode = T3.DeptCode
            JOIN RMTBranches T4   ON T1.UsrBranchCode = T4.BranchCode
            JOIN BMTLanguage T5   ON T1.UsrLanguage = T5.LngCode
            JOIN BMTDesignations T6   ON T1.UsrDesg = T6.DesgCode
     WHERE NOT EXISTS ( SELECT 1   FROM SecUsers_RTemp  WHERE UsrID = T1.UsrID )
		</createView>
</changeSet>


<changeSet id="27" author="durgaPrasadG">
	<createView viewName="SecUsers_AView" replaceIfExists="true">
		SELECT T1.UsrID ,
          T1.UsrLogin ,
          T1.UsrPwd ,
          T1.UserStaffID ,
          T1.UsrFName ,
          T1.UsrMName ,
          T1.UsrLName ,
          T1.UsrMobile ,
          T1.UsrEmail ,
          T1.UsrEnabled ,
          T1.UsrCanSignonFrom ,
          T1.UsrCanSignonTo ,
          T1.UsrCanOverrideLimits ,
          T1.UsrAcExp ,
          T1.UsrAcExpDt ,
          T1.UsrCredentialsExp ,
          T1.UsrAcLocked ,
          T1.UsrLanguage ,
          T5.LngDesc LovDescUsrLanguage  ,
          T1.UsrDftAppId ,
          T2.AppCode LovDescUsrDftAppCode  ,
          T2.AppDescription LovDescUsrDftAppCodeName  ,
          T1.UsrBranchCode ,
          T4.BranchDesc LovDescUsrBranchCodeName  ,
          T1.UsrDeptCode ,
          T3.DeptDesc LovDescUsrDeptCodeName  ,
          T1.UsrToken ,
          T1.UsrIsMultiBranch ,
          T1.UsrInvldLoginTries ,
          T1.UsrDesg ,
          T6.DesgDesc LovDescUsrDesg  ,
          T1.Version ,
          T1.LastMntBy ,
          T1.LastMntOn ,
          T1.RecordStatus ,
          T1.RoleCode ,
          T1.NextRoleCode ,
          T1.TaskId ,
          T1.NextTaskId ,
          T1.RecordType ,
          T1.WorkflowId ,
          T1.UsrDftAppCode,
		  T1.AuthType 			  
     FROM SecUsers T1
           LEFT OUTER JOIN PTApplicationDetails T2   ON T1.UsrDftAppId = T2.AppID
            LEFT OUTER JOIN BMTDepartments T3   ON T1.UsrDeptCode = T3.DeptCode
            LEFT OUTER JOIN RMTBranches T4   ON T1.UsrBranchCode = T4.BranchCode
            LEFT OUTER JOIN BMTLanguage T5   ON T1.UsrLanguage = T5.LngCode
            LEFT OUTER JOIN BMTDesignations T6   ON T1.UsrDesg = T6.DesgCode
		</createView>
</changeSet>

</databaseChangeLog>
