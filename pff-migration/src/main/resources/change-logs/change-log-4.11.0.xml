<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value="" dbms="oracle" />
	<property name="add.schema" value="" dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PLFAVANSEQC.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()" dbms="postgresql" />


	 <changeSet id="pre_run_for_pgp" author="Jayant" runAlways="true"
		dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>

	<changeSet id="1" author="Siva">
		<addColumn tableName="finscheduledetails">
			<column name="RecalLock" type="boolean" defaultValueBoolean="false" />
		</addColumn>
		<addColumn tableName="finscheduledetails_log">
			<column name="RecalLock" type="boolean" defaultValueBoolean="false" />
		</addColumn>
		<addColumn tableName="finscheduledetails_pa">
			<column name="RecalLock" type="boolean" defaultValueBoolean="false" />
		</addColumn>
		<addColumn tableName="finscheduledetails_temp">
			<column name="RecalLock" type="boolean" defaultValueBoolean="false" />
		</addColumn>
		<addColumn tableName="rejectfinscheduledetails">
			<column name="RecalLock" type="boolean" defaultValueBoolean="false" />
		</addColumn>
		<addColumn tableName="wiffinscheduledetails">
			<column name="RecalLock" type="boolean" defaultValueBoolean="false" />
		</addColumn>
		<addColumn tableName="wiffinscheduledetails_temp">
			<column name="RecalLock" type="boolean" defaultValueBoolean="false" />
		</addColumn>
	</changeSet>
	<changeSet id="2" author="Siva">
		<createView viewName="FINSCHEDULEDETAILS_AVIEW"
			replaceIfExists="true">
			SELECT     T1.FinReference, T1.SchSeq, T1.SchDate, T1.PftOnSchDate, T1.RepayOnSchDate, T1.CpzOnSchDate, T1.RvwOnSchDate, T1.DisbOnSchDate, 
					   T1.DownpaymentOnSchDate, T1.BalanceForPftCal, T1.BaseRate, T1.SplRate, T1.ActRate, T1.NoOfDays, T1.DayFactor, T1.ProfitCalc, T1.ProfitSchd, 
					   T1.PrincipalSchd, T1.RepayAmount, T1.ProfitBalance, T1.DisbAmount, T1.CpzAmount, T1.DownPaymentAmount,  
					   T1.ClosingBalance, T1.ProfitFraction, T1.PrvRepayAmount, T1.SchdPftPaid, T1.SchPftPaid, T1.SchdPriPaid, T1.SchPriPaid, 
					   T1.Specifier, T1.DefSchdDate, T1.SchdMethod, T1.MrgRate, 
					   T1.CalOnIndRate,T1.FeeChargeAmt, T1.CalculatedRate, T1.EarlyPaidBal, T1.EarlyPaid, T1.RefundOrWaiver, T1.WriteoffPrincipal, 
					   T1.WriteoffProfit, T1.OrgPft, T1.OrgPri, T1.OrgEndBal, T1.OrgPlanPft, T1.FeeSchd, T1.SchdFeePaid, T1.SchdFeeOS, T1.InsSchd, T1. SchdInsPaid, 
					   T1.AdvPftRate , T1.AdvProfit ,  T1.AdvRepayAmount , T1.AdvBaseRate , T1.AdvMargin , T1.AdvCalRate, T1.SuplRent ,  T1.IncrCost ,  T1.SuplRentPaid ,  T1.IncrCostPaid ,
					   T1.RolloverOnSchDate,  T1.RolloverAmount,  T1.RolloverAmountPaid, T1.TDSAmount, T1.TDSPaid,
					   T1.PftDaysBasis,T1.WriteoffIns,T1.WriteoffIncrCost,T1.WriteoffSuplRent,T1.WriteoffSchFee,T1.InsuranceAmt, T1.InstNumber, T1.BpiOrHoliday, T1.FrqDate,T1.PresentmentId,
					   T1.PartialPaidAmt, T1.FeeTax	,T1.RecalLock
			FROM       FinScheduleDetails  T1	
		</createView>
	</changeSet>

	<changeSet id="3" author="siva">
		<createView viewName="FINSCHEDULEDETAILS_TVIEW"
			replaceIfExists="true">
			SELECT     T1.FinReference, T1.SchSeq, T1.SchDate, T1.PftOnSchDate, T1.RepayOnSchDate, T1.CpzOnSchDate, T1.RvwOnSchDate, T1.DisbOnSchDate, 
					   T1.DownpaymentOnSchDate, T1.BalanceForPftCal, T1.BaseRate, T1.SplRate, T1.ActRate, T1.NoOfDays, T1.DayFactor, T1.ProfitCalc, T1.ProfitSchd, 
					   T1.PrincipalSchd, T1.RepayAmount, T1.ProfitBalance, T1.DisbAmount, T1.CpzAmount, T1.DownPaymentAmount,  
					   T1.ClosingBalance, T1.ProfitFraction, T1.PrvRepayAmount, T1.SchdPftPaid, T1.SchPftPaid, T1.SchdPriPaid, T1.SchPriPaid, 
					   T1.Specifier, T1.DefSchdDate, T1.SchdMethod, T1.MrgRate, 
					   T1.CalOnIndRate,T1.FeeChargeAmt, T1.CalculatedRate, T1.EarlyPaidBal, T1.EarlyPaid, T1.RefundOrWaiver, T1.WriteoffPrincipal, 
					   T1.WriteoffProfit, T1.OrgPft, T1.OrgPri, T1.OrgEndBal, T1.OrgPlanPft, T1.FeeSchd, T1.SchdFeePaid, T1.SchdFeeOS, T1.InsSchd, T1. SchdInsPaid, 
					   T1.AdvPftRate , T1.AdvProfit ,  T1.AdvRepayAmount , T1.AdvBaseRate , T1.AdvMargin , T1.AdvCalRate, T1.SuplRent ,  T1.IncrCost ,  T1.SuplRentPaid ,  T1.IncrCostPaid ,
					   T1.RolloverOnSchDate,  T1.RolloverAmount,  T1.RolloverAmountPaid, T1.TDSAmount, T1.TDSPaid,
					   T1.PftDaysBasis,T1.WriteoffIns,T1.WriteoffIncrCost,T1.WriteoffSuplRent,T1.WriteoffSchFee,T1.InsuranceAmt, T1.InstNumber, T1.BpiOrHoliday, T1.FrqDate,T1.PresentmentId,
					   T1.PartialPaidAmt, T1.FeeTax,T1.RecalLock	
			FROM       FinScheduleDetails_Temp  T1
		</createView>
	</changeSet>
	<changeSet id="4" author="Siva">
		<createView viewName="WIFFinScheduleDetails_View"
			replaceIfExists="true">
		 SELECT     T1.FinReference, T1.SchSeq, T1.SchDate, T1.PftOnSchDate, T1.RepayOnSchDate, T1.CpzOnSchDate, T1.RvwOnSchDate, T1.DisbOnSchDate, 
                     T1.DownpaymentOnSchDate, T1.BalanceForPftCal, T1.BaseRate, T1.SplRate, T1.ActRate, T1.NoOfDays, T1.DayFactor, T1.ProfitCalc, T1.ProfitSchd, 
                      T1.PrincipalSchd, T1.RepayAmount, T1.ProfitBalance, T1.DisbAmount, T1.CpzAmount, T1.DownPaymentAmount,  
                      T1.ClosingBalance, T1.ProfitFraction, T1.PrvRepayAmount, T1.SchdPftPaid, T1.SchPftPaid, T1.SchdPriPaid, T1.SchPriPaid, 
                      T1.Specifier, T1.DefSchdDate, T1.SchdMethod, T1.MrgRate, 
                      T1.CalOnIndRate,T1.FeeChargeAmt, T1.CalculatedRate, T1.OrgPft, T1.OrgPri, T1.OrgEndBal, T1.OrgPlanPft, T1.FeeSchd, T1.SchdFeePaid, T1.SchdFeeOS, T1.InsSchd, T1. SchdInsPaid, 
                       T1.AdvPftRate , T1.AdvProfit ,  T1.AdvRepayAmount , T1.AdvBaseRate , T1.AdvMargin , T1.AdvCalRate, T1.SuplRent ,  T1.IncrCost ,  T1.SuplRentPaid ,  T1.IncrCostPaid ,
                       T1.RolloverOnSchDate,  T1.RolloverAmount,  T1.RolloverAmountPaid, T1.TDSAmount,
                       T1.PftDaysBasis,T1.InsuranceAmt, T1.InstNumber, T1.BpiOrHoliday, T1.FrqDate,T1.RecalLock

	FROM         WIFFinScheduleDetails_Temp T1
	UNION ALL
			SELECT     T1.FinReference, T1.SchSeq, T1.SchDate, T1.PftOnSchDate, T1.RepayOnSchDate, T1.CpzOnSchDate, T1.RvwOnSchDate, T1.DisbOnSchDate, 
                     T1.DownpaymentOnSchDate, T1.BalanceForPftCal, T1.BaseRate, T1.SplRate, T1.ActRate, T1.NoOfDays, T1.DayFactor, T1.ProfitCalc, T1.ProfitSchd, 
                      T1.PrincipalSchd, T1.RepayAmount, T1.ProfitBalance, T1.DisbAmount, T1.CpzAmount, T1.DownPaymentAmount,  
                      T1.ClosingBalance, T1.ProfitFraction, T1.PrvRepayAmount, T1.SchdPftPaid, T1.SchPftPaid, T1.SchdPriPaid, T1.SchPriPaid, 
                      T1.Specifier, T1.DefSchdDate, T1.SchdMethod, T1.MrgRate, 
                      T1.CalOnIndRate,T1.FeeChargeAmt, T1.CalculatedRate, T1.OrgPft, T1.OrgPri, T1.OrgEndBal, T1.OrgPlanPft, T1.FeeSchd, T1.SchdFeePaid, T1.SchdFeeOS, T1.InsSchd, T1. SchdInsPaid, 
                       T1.AdvPftRate , T1.AdvProfit ,  T1.AdvRepayAmount , T1.AdvBaseRate , T1.AdvMargin , T1.AdvCalRate, T1.SuplRent ,  T1.IncrCost ,  T1.SuplRentPaid ,  T1.IncrCostPaid ,
                       T1.RolloverOnSchDate,  T1.RolloverAmount,  T1.RolloverAmountPaid, T1.TDSAmount,
                       T1.PftDaysBasis,T1.InsuranceAmt, T1.InstNumber, T1.BpiOrHoliday, T1.FrqDate,T1.RecalLock

	FROM         WIFFinScheduleDetails T1
	WHERE     NOT EXISTS
                          (SELECT     1
                            FROM          WIFFinScheduleDetails_Temp
                            WHERE      FinReference = T1.FinReference)
	
		</createView>
	</changeSet>

	<changeSet id="5" author="Siva">
		<createView viewName="WIFFINSCHEDULEDETAILS_TVIEW"
			replaceIfExists="true">
			SELECT     T1.FinReference, T1.SchSeq, T1.SchDate, T1.PftOnSchDate, T1.RepayOnSchDate, T1.CpzOnSchDate, T1.RvwOnSchDate, T1.DisbOnSchDate, 
					   T1.DownpaymentOnSchDate, T1.BalanceForPftCal, T1.BaseRate, T1.SplRate, T1.ActRate, T1.NoOfDays, T1.DayFactor, T1.ProfitCalc, T1.ProfitSchd, 
					   T1.PrincipalSchd, T1.RepayAmount, T1.ProfitBalance, T1.DisbAmount, T1.CpzAmount, T1.DownPaymentAmount,  
					   T1.ClosingBalance, T1.ProfitFraction, T1.PrvRepayAmount, T1.SchdPftPaid, T1.SchPftPaid, T1.SchdPriPaid, T1.SchPriPaid, 
					   T1.Specifier, T1.DefSchdDate, T1.SchdMethod, T1.MrgRate,  
					   T1.CalOnIndRate,T1.FeeChargeAmt, T1.CalculatedRate, T1.OrgPft, T1.OrgPri, T1.OrgEndBal, T1.OrgPlanPft, T1.FeeSchd, T1.SchdFeePaid, T1.SchdFeeOS, T1.InsSchd, T1. SchdInsPaid, 
					   T1.AdvPftRate , T1.AdvProfit ,  T1.AdvRepayAmount , T1.AdvBaseRate , T1.AdvMargin , T1.AdvCalRate, T1.SuplRent ,  T1.IncrCost ,  T1.SuplRentPaid ,  T1.IncrCostPaid ,
					   T1.RolloverOnSchDate,  T1.RolloverAmount,  T1.RolloverAmountPaid, T1.TDSAmount, T1.TDSPaid,
					   T1.PftDaysBasis,T1.InsuranceAmt, T1.InstNumber, T1.BpiOrHoliday, T1.FrqDate, T1.FeeTax,T1.RecalLock
			FROM       WIFFinScheduleDetails_Temp T1

		</createView>
	</changeSet>
 	<changeSet id="6" author="Siva">
		<createView viewName="FINSCHEDULEDETAILS_VIEW" replaceIfExists="true">
			SELECT     T1.FinReference, T1.SchSeq, T1.SchDate, T1.PftOnSchDate, T1.RepayOnSchDate, T1.CpzOnSchDate, T1.RvwOnSchDate, T1.DisbOnSchDate, 
					   T1.DownpaymentOnSchDate, T1.BalanceForPftCal, T1.BaseRate, T1.SplRate, T1.ActRate, T1.NoOfDays, T1.DayFactor, T1.ProfitCalc, T1.ProfitSchd, 
					   T1.PrincipalSchd, T1.RepayAmount, T1.ProfitBalance, T1.DisbAmount, T1.CpzAmount, T1.DownPaymentAmount,  
					   T1.ClosingBalance, T1.ProfitFraction, T1.PrvRepayAmount, T1.SchdPftPaid, T1.SchPftPaid, T1.SchdPriPaid, T1.SchPriPaid, 
					   T1.Specifier, T1.DefSchdDate, T1.SchdMethod, T1.MrgRate, 
					   T1.CalOnIndRate,T1.FeeChargeAmt, T1.CalculatedRate, T1.EarlyPaidBal, T1.EarlyPaid, T1.RefundOrWaiver, T1.WriteoffPrincipal, 
					   T1.WriteoffProfit, T1.OrgPft, T1.OrgPri, T1.OrgEndBal, T1.OrgPlanPft, T1.FeeSchd, T1.SchdFeePaid, T1.SchdFeeOS, T1.InsSchd, T1. SchdInsPaid, 
					   T1.AdvPftRate , T1.AdvProfit ,  T1.AdvRepayAmount , T1.AdvBaseRate , T1.AdvMargin , T1.AdvCalRate, T1.SuplRent ,  T1.IncrCost ,  T1.SuplRentPaid ,  T1.IncrCostPaid ,
					   T1.RolloverOnSchDate,  T1.RolloverAmount,  T1.RolloverAmountPaid, T1.TDSAmount, T1.TDSPaid,
					   T1.PftDaysBasis,T1.WriteoffIns,T1.WriteoffIncrCost,T1.WriteoffSuplRent,T1.WriteoffSchFee,T1.InsuranceAmt, T1.InstNumber, T1.BpiOrHoliday, T1.FrqDate,T1.PresentmentId,
					   T1.PartialPaidAmt, T1.FeeTax	,T1.RecalLock
			FROM       FinScheduleDetails_Temp  T1
		
			UNION ALL
		
			SELECT     T1.FinReference, T1.SchSeq, T1.SchDate, T1.PftOnSchDate, T1.RepayOnSchDate, T1.CpzOnSchDate, T1.RvwOnSchDate, T1.DisbOnSchDate, 
					   T1.DownpaymentOnSchDate, T1.BalanceForPftCal, T1.BaseRate, T1.SplRate, T1.ActRate, T1.NoOfDays, T1.DayFactor, T1.ProfitCalc, T1.ProfitSchd, 
					   T1.PrincipalSchd, T1.RepayAmount, T1.ProfitBalance, T1.DisbAmount, T1.CpzAmount, T1.DownPaymentAmount,  
					   T1.ClosingBalance, T1.ProfitFraction, T1.PrvRepayAmount, T1.SchdPftPaid, T1.SchPftPaid, T1.SchdPriPaid, T1.SchPriPaid, 
					   T1.Specifier, T1.DefSchdDate, T1.SchdMethod, T1.MrgRate, 
					   T1.CalOnIndRate,T1.FeeChargeAmt, T1.CalculatedRate, T1.EarlyPaidBal, T1.EarlyPaid, T1.RefundOrWaiver, T1.WriteoffPrincipal, 
					   T1.WriteoffProfit, T1.OrgPft, T1.OrgPri, T1.OrgEndBal, T1.OrgPlanPft, T1.FeeSchd, T1.SchdFeePaid, T1.SchdFeeOS, T1.InsSchd, T1. SchdInsPaid, 
					   T1.AdvPftRate , T1.AdvProfit ,  T1.AdvRepayAmount , T1.AdvBaseRate , T1.AdvMargin , T1.AdvCalRate, T1.SuplRent ,  T1.IncrCost ,  T1.SuplRentPaid ,  T1.IncrCostPaid ,
					   T1.RolloverOnSchDate,  T1.RolloverAmount,  T1.RolloverAmountPaid, T1.TDSAmount, T1.TDSPaid,
					   T1.PftDaysBasis,T1.WriteoffIns,T1.WriteoffIncrCost,T1.WriteoffSuplRent,T1.WriteoffSchFee,T1.InsuranceAmt, T1.InstNumber, T1.BpiOrHoliday, T1.FrqDate,T1.PresentmentId,
					   T1.PartialPaidAmt, T1.FeeTax,T1.RecalLock
			FROM       FinScheduleDetails  T1
		
			WHERE      NOT EXISTS (SELECT 1 FROM FinScheduleDetails_Temp  WHERE FinReference = T1.FinReference)
		</createView>
	</changeSet>
<changeSet id="7.1" author="siva">
<comment>128207 : Only DR Patch</comment>
	<createView viewName="finodcrecovery_view" replaceIfExists="true">
	SELECT t1.finreference,
    t1.schdate AS finodschddate,
    t1.schdfor AS finodfor,
    t3.valuedate AS movementdate,
    t1.repayschid AS seqno,
    t1.dayslate AS oddays,
    t1.principalschdbal + t1.profitschdbal AS fincurodamt,
    t1.principalschdbal AS fincurodpri,
    t1.profitschdbal AS fincurodpft,
    t5.odchargetype AS penaltytype,
    t5.odchargecalon AS penaltycalon,
    t5.odchargeamtorperc AS penaltyamtperc,
    t1.penaltyamt AS penalty,
    t1.maxwaiver,
    t1.waivedamt,
    t1.penaltypaynow AS penaltypaid,
    t1.penaltyamt - t1.penaltypaynow - t1.waivedamt AS penaltybal,
    0 AS rcdcandel,
    t4.custcif AS lovdesccustcif,
    t4.custshrtname AS lovdesccustshrtname,
    t2.finstartdate AS lovdescfinstartdate,
    t2.maturitydate AS lovdescmaturitydate,
    t2.finamount AS lovdescfinamount,
    t2.finamount - t2.finrepaymentamount AS lovdesccurfinamt,
    t2.finccy,
    t5.fincurodpri AS lovdesccurschpridue,
    t5.fincurodpft AS lovdesccurschpftdue,
    t5.totpenaltyamt AS lovdesctotovrduechrg,
    t5.totwaived AS lovdesctotovrduechrgwaived,
    t5.totpenaltypaid AS lovdesctotovrduechrgpaid
   FROM finrepayscheduledetail t1
     JOIN financemain t2 ON t1.finreference = t2.finreference
     JOIN customers t4 ON t4.custid = t2.custid
     JOIN finrepayheader t3 ON t1.repayid = t3.repayid
	  JOIN finreceiptDetail t6 ON t6.ReceiptSeqID = t3.ReceiptSeqID AND t6.Status NOT IN('C','B')
     JOIN finoddetails t5 ON t1.finreference = t5.finreference AND t1.schdate = t5.finodschddate
	</createView>
</changeSet>
	<changeSet id="8.1" author="Nagewar.p">
	<sql>
	delete from errordetails where code='99027';
		INSERT INTO errordetails(
	code, language, severity, message, recordstatus, workflowid, lastmntby, version)
	VALUES ('99027', 'EN', 'E', 'Service request number is already cancelled with {0}.', 'Approved' ,0, 1000, 0);
	</sql>
</changeSet>

<changeSet id="9" author="Vinay">
	<sql>
		delete from REPORTLIST where code='ReasonCategory';
		Insert into REPORTLIST values ('ReasonCategory','ReasonCategory','listheader_Code.label,listheader_Description.label','code,description','String,String',null,'ReportList02','Reason Category','Application Masters',0,1000,CURRENT_TIMESTAMP,'Approved',null,null,null,null,null,0,'0');
		
		delete from REPORTLIST where code='ReasonCode';
		Insert into REPORTLIST values ('ReasonCode','ReasonCode','listheader_ReasonTypeID.label,listheader_ReasonCategoryID.label,listheader_Code.label,listheader_Description.label,listheader_Active.label',
		'ReasonTypeCode,ReasonCategoryCode,code,description,active','String,String,String,String,boolean',null,'ReportList05','Reason Code','Application Masters',0,1000,CURRENT_TIMESTAMP,'Approved',null,null,null,null,null,0,'0');
		
		delete from REPORTLIST where code='LoanPurpose';
		Insert into REPORTLIST values ('LoanPurpose','LoanPurpose','listheader_LoanPurposeCode.label,listheader_LoanPurposeDesc.label,listheader_LoanPurposeIsActive.label','loanPurposeCode,loanPurposeDesc,loanPurposeIsActive','String,String,boolean',null,'ReportList03','Reason Category','Application Masters',0,1000,CURRENT_TIMESTAMP,'Approved',null,null,null,null,null,0,'0');
		
		delete from REPORTLIST where code='GSTRULE';
		Insert into REPORTLIST values ('GSTRULE','GSTRULE','listheader_RuleEvent.label,listheader_RuleCode.label,listheader_RuleCodeDesc.label','ruleCode,ruleCodeDesc,ruleEvent','String,String,String',' ','ReportList03','GST Rules','Rules Factory',1,1001,null,'Approved',' ',' ',' ',' ',' ',0,'0');
		
		delete from REPORTLIST where code='QueryCategory';
		Insert into REPORTLIST values ('QueryCategory','QueryCategory','listheader_Code.label,listheader_Description.label,listheader_Active.label','code,description,active','String,String,Boolean',' ','ReportList03','Query Category Type','Application Masters',1,1001,null,'Approved',' ',' ',' ',' ',' ',0,'0');
		
		delete from REPORTLIST where code='InterfaceMapping';
		Insert into REPORTLIST values ('InterfaceMapping','InterfaceMapping','listheader_InterfaceName.label,listheader_InterfaceField.label','interfaceName,interfaceField','String,String',' ','ReportList02','Interface Mapping','Application Masters',1,1001,null,'Approved',' ',' ',' ',' ',' ',0,'0');
		
		update REPORTLIST set moduletype='Customer Masters' where code='Gender';
		
		update REPORTLIST set reportheading='Sourcing Officers' ,moduletype='Application Masters' where code='VehicleDealer';
		
		update REPORTLIST set reportheading='Lookup Values' where code='LovFieldDetail';
		
		update REPORTLIST set moduletype='Entity Masters' where code='Entity';
		
		update REPORTLIST set moduletype='Customer Masters' where code='Gender';		
		
		update REPORTLIST set fieldvalues='code,description,module,categorizationName,severity,active' where code='ManualDeviation';
		
		update reportlist set  reportheading='Manual Advise' where code='ManualAdvise';
	</sql>
</changeSet>

	<changeSet id="10" author="siva">
		<sql>
			Insert into bmtamountcodes values('INSTDATE','0','ae_instcpz','Installment Capitalization Amount','1','1','1000',Current_timestamp,'Approved','','','','','',0);
			Insert into bmtamountcodes values('INSTDATE','0','ae_instTds','Installment TDS Amount','1','1','1000',Current_timestamp,'Approved','','','','','',0);
		</sql>
	</changeSet>

<changeSet id="11_Pre" author="Jayant">
	<sql>
		select deps_save_and_drop_dependencies('plf','fintypeexpenses');
		select deps_save_and_drop_dependencies('plf','fintypeexpenses_temp');
	</sql>
</changeSet>
<changeSet id="11" author="Vinay">
	<modifyDataType tableName="FinTypeExpenses" columnName="AmortReq" newDataType="boolean"/>
	<modifyDataType tableName="FinTypeExpenses_Temp" columnName="AmortReq" newDataType="boolean"/>
</changeSet>
<changeSet id="11_Post" author="Jayant">
	<sql>
		select deps_restore_dependencies('plf','fintypeexpenses');
		select deps_restore_dependencies('plf','fintypeexpenses_temp');
	</sql>
</changeSet>
<changeSet id="12.0" author="Vinay">
	<createView viewName="WIFFinanceMain_View" replaceIfExists="true">
		SELECT t1.finreference,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finisactive,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t15.custcif AS lovdesccustcif,
    t7.fintypedesc AS lovdescfintypename,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t1.mindownpayperc,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t1.recaltype,
    t1.finassetvalue,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.repaymargin,
    t1.grcmargin,
    t1.depreciationfrq,
    t1.fincommitmentref,
    t1.fincurrassetvalue,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.downpaybank,
    t1.downpaysupl,
    t7.findivision AS lovdescfindivisionname,
    t1.graceterms,
    t14.facilitytype,
    t15.custshrtname AS lovdesccustshrtname,
    t16.branchdesc AS lovdescfinbranchname,
    t1.totalgrossgrcpft,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t7.product AS lovdescfinproduct,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.feeaccountid,
    t1.tdsapplicable,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.feechargeamt,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t1.grcmaxamount,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedtenorrate,
    t1.fixedratetenor
   FROM wiffinancemain_temp t1
     LEFT JOIN wifindicativetermdetail_temp t14 ON t14.finreference = t1.finreference
     LEFT JOIN customers t15 ON t15.custid = t1.custid
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t16 ON t1.finbranch = t16.branchcode
UNION ALL
 SELECT t1.finreference,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finisactive,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t15.custcif AS lovdesccustcif,
    t7.fintypedesc AS lovdescfintypename,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t1.mindownpayperc,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t1.recaltype,
    t1.finassetvalue,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.repaymargin,
    t1.grcmargin,
    t1.depreciationfrq,
    t1.fincommitmentref,
    t1.fincurrassetvalue,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.downpaybank,
    t1.downpaysupl,
    t7.findivision AS lovdescfindivisionname,
    t1.graceterms,
    t14.facilitytype,
    t15.custshrtname AS lovdesccustshrtname,
    t16.branchdesc AS lovdescfinbranchname,
    t1.totalgrossgrcpft,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t7.product AS lovdescfinproduct,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.feeaccountid,
    t1.tdsapplicable,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.feechargeamt,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t1.grcmaxamount,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedtenorrate,
    t1.fixedratetenor
   FROM wiffinancemain t1
     LEFT JOIN wifindicativetermdetail_temp t14 ON t14.finreference = t1.finreference
     LEFT JOIN customers t15 ON t15.custid = t1.custid
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t16 ON t1.finbranch = t16.branchcode
  WHERE NOT (EXISTS ( SELECT 1 AS expr1
           FROM wiffinancemain_temp
          WHERE wiffinancemain_temp.finreference = t1.finreference))
	</createView>
</changeSet>

<changeSet id="13.0" author="Vinay">
	<createView viewName="WIFFinScheduleDetails_View" replaceIfExists="true">
		SELECT t1.finreference,
    t1.schseq,
    t1.schdate,
    t1.pftonschdate,
    t1.repayonschdate,
    t1.cpzonschdate,
    t1.rvwonschdate,
    t1.disbonschdate,
    t1.downpaymentonschdate,
    t1.balanceforpftcal,
    t1.baserate,
    t1.splrate,
    t1.actrate,
    t1.noofdays,
    t1.dayfactor,
    t1.profitcalc,
    t1.profitschd,
    t1.principalschd,
    t1.repayamount,
    t1.profitbalance,
    t1.disbamount,
    t1.cpzamount,
    t1.downpaymentamount,
    t1.closingbalance,
    t1.profitfraction,
    t1.prvrepayamount,
    t1.schdpftpaid,
    t1.schpftpaid,
    t1.schdpripaid,
    t1.schpripaid,
    t1.specifier,
    t1.defschddate,
    t1.schdmethod,
    t1.mrgrate,
    t1.calonindrate,
    t1.feechargeamt,
    t1.calculatedrate,
    t1.orgpft,
    t1.orgpri,
    t1.orgendbal,
    t1.orgplanpft,
    t1.feeschd,
    t1.schdfeepaid,
    t1.schdfeeos,
    t1.insschd,
    t1.schdinspaid,
    t1.advpftrate,
    t1.advprofit,
    t1.advrepayamount,
    t1.advbaserate,
    t1.advmargin,
    t1.advcalrate,
    t1.suplrent,
    t1.incrcost,
    t1.suplrentpaid,
    t1.incrcostpaid,
    t1.rolloveronschdate,
    t1.rolloveramount,
    t1.rolloveramountpaid,
    t1.tdsamount,
    t1.pftdaysbasis,
    t1.insuranceamt,
    t1.instnumber,
    t1.bpiorholiday,
    t1.frqdate,
    t1.recallock,
    t1.tdspaid
   FROM wiffinscheduledetails_temp t1
UNION ALL
 SELECT t1.finreference,
    t1.schseq,
    t1.schdate,
    t1.pftonschdate,
    t1.repayonschdate,
    t1.cpzonschdate,
    t1.rvwonschdate,
    t1.disbonschdate,
    t1.downpaymentonschdate,
    t1.balanceforpftcal,
    t1.baserate,
    t1.splrate,
    t1.actrate,
    t1.noofdays,
    t1.dayfactor,
    t1.profitcalc,
    t1.profitschd,
    t1.principalschd,
    t1.repayamount,
    t1.profitbalance,
    t1.disbamount,
    t1.cpzamount,
    t1.downpaymentamount,
    t1.closingbalance,
    t1.profitfraction,
    t1.prvrepayamount,
    t1.schdpftpaid,
    t1.schpftpaid,
    t1.schdpripaid,
    t1.schpripaid,
    t1.specifier,
    t1.defschddate,
    t1.schdmethod,
    t1.mrgrate,
    t1.calonindrate,
    t1.feechargeamt,
    t1.calculatedrate,
    t1.orgpft,
    t1.orgpri,
    t1.orgendbal,
    t1.orgplanpft,
    t1.feeschd,
    t1.schdfeepaid,
    t1.schdfeeos,
    t1.insschd,
    t1.schdinspaid,
    t1.advpftrate,
    t1.advprofit,
    t1.advrepayamount,
    t1.advbaserate,
    t1.advmargin,
    t1.advcalrate,
    t1.suplrent,
    t1.incrcost,
    t1.suplrentpaid,
    t1.incrcostpaid,
    t1.rolloveronschdate,
    t1.rolloveramount,
    t1.rolloveramountpaid,
    t1.tdsamount,
    t1.pftdaysbasis,
    t1.insuranceamt,
    t1.instnumber,
    t1.bpiorholiday,
    t1.frqdate,
    t1.recallock,
    t1.tdspaid
   FROM wiffinscheduledetails t1
  WHERE NOT (EXISTS ( SELECT 1
           FROM wiffinscheduledetails_temp
          WHERE wiffinscheduledetails_temp.finreference = t1.finreference))
	</createView>
</changeSet>

<changeSet id="14" author="Vinay">
	<sql>
		update reportlist set fieldlabels='listheader_BounceCode.label,listheader_ReasonType.label,listheader_Category.label,listheader_ReturnCode.label,listheader_Active.label' where code='BounceReason';
	</sql>
</changeSet>

<changeSet id="15" author="Vinay">
		<createSequence sequenceName="SeqFinTypeExpense" startValue="1" maxValue="9223372036854775807" incrementBy="1" />
</changeSet>

<changeSet id="16_Pre" author="Jayant">
	<sql>
		select deps_save_and_drop_dependencies('plf','fintypeexpenses');
		select deps_save_and_drop_dependencies('plf','fintypeexpenses_temp');
	</sql>
</changeSet>
<changeSet id="16" author="Vinay">
	<modifyDataType tableName="FinTypeExpenses" columnName="taxapplicable" newDataType="boolean"/>
	<modifyDataType tableName="FinTypeExpenses_Temp" columnName="taxapplicable" newDataType="boolean"/>
</changeSet>
<changeSet id="16_Post" author="Jayant">
	<sql>
		select deps_restore_dependencies('plf','fintypeexpenses');
		select deps_restore_dependencies('plf','fintypeexpenses_temp');
	</sql>
</changeSet>
<changeSet id="17_Pre" author="Jayant">
	<sql>
		select deps_save_and_drop_dependencies('plf','fintypeexpenses');
		select deps_save_and_drop_dependencies('plf','fintypeexpenses_temp');
	</sql>
</changeSet>
<changeSet id="17" author="Vinay">
	<modifyDataType tableName="FinTypeExpenses" columnName="Active" newDataType="boolean"/>
	<modifyDataType tableName="FinTypeExpenses_Temp" columnName="Active" newDataType="boolean"/>
</changeSet>
<changeSet id="17_Post" author="Jayant">
	<sql>
		select deps_restore_dependencies('plf','fintypeexpenses');
		select deps_restore_dependencies('plf','fintypeexpenses_temp');
	</sql>
</changeSet>
</databaseChangeLog>