<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />
	
	<changeSet id="01" author="Surekha">
		<createTable tableName="PinCodes">
			<column name="PinCodeId" type="bigint">
				<constraints primaryKey="true" nullable="false"/>
			</column>
			<column name="PinCode" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="City" type="varchar(8)" >
				<constraints nullable="false" />
			</column>
			<column name="Active" type="boolean"/>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="02" author="Surekha">
		<createTable tableName="PinCodes_Temp">
			<column name="PinCodeId" type="bigint">
				<constraints primaryKey="true" nullable="false"/>
			</column>
			<column name="PinCode" type="varchar(10)">
				<constraints nullable="false" />
			</column>
			<column name="City" type="varchar(8)" >
				<constraints nullable="false" />
			</column>
			<column name="Active" type="boolean"/>
			<column name="Version" type="int" defaultValue="0" />
			<column name="LastMntBy" type="bigint" />
			<column name="LastMntOn" type="datetime" />
			<column name="RecordStatus" type="varchar(50)" />
			<column name="RoleCode" type="varchar(100)" />
			<column name="NextRoleCode" type="varchar(200)" />
			<column name="TaskId" type="varchar(50)" />
			<column name="NextTaskId" type="varchar(200)" />
			<column name="RecordType" type="varchar(50)" />
			<column name="WorkflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="03" author="Surekha">
		 <createTable tableName="SeqPinCodes">
			<column name="SeqNo" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="04" author="Surekha">
		<sql>
			insert into SeqPinCodes values (0);
		</sql>
	</changeSet>
	<changeSet id="05" author="Surekha">
		<createView viewName="PinCodes_View" replaceIfExists="true">
			SELECT		T1.PinCodeId, T1.PinCode, T1.City,T2.PCCityName, T1.Active		
			, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	PinCodes_Temp  T1 INNER JOIN
						RMTPROVINCEVSCITY  T2 ON T1.City=T2.PCCity
			UNION ALL
			
			SELECT		T1.PinCodeId, T1.PinCode, T1.City, T2.PCCityName, T1.Active		
						, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	PinCodes  T1 INNER JOIN
						RMTPROVINCEVSCITY  T2 ON T1.City=T2.PCCity
			WHERE     NOT EXISTS (SELECT 1 FROM PinCodes_TEMP WHERE PinCodeId = T1.PinCodeId)
		</createView>
	</changeSet>
	<changeSet id="06" author="Surekha">
		<createView viewName="PinCodes_AView" replaceIfExists="true">
			SELECT		T1.PinCodeId, T1.PinCode, T1.City,T2.PCCityName, T1.Active		
			, T1.Version , T1.LastMntBy, T1.LastMntOn,T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
			FROM    	PinCodes  T1 INNER JOIN
						RMTPROVINCEVSCITY  T2 ON T1.City=T2.PCCity
		</createView>
	</changeSet>
	
	<changeSet id="07"  author="Surekha">
		<sql>
		
			Update SeqSecGroups Set SeqNo = (Select MAX(GrpID) + 1 from SecGroups);
			Update SeqSecRights Set SeqNo = (Select MAX(RightID) + 1 from SecRights);
			Update SeqSecGroupRights Set SeqNo = (Select MAX(GrpRightID) + 1 from SecGroupRights);
			Update SeqSecRoleGroups Set SeqNo = (Select MAX(RoleGrpID) + 1 from SecRoleGroups);
			
			INSERT INTO SecGroups SELECT (select (SeqNo+1) from SeqSecGroups), 'PINCODE_VIEW', 'Allow to view PinCode', 0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
			INSERT INTO SecGroups SELECT (select (SeqNo+2) from SeqSecGroups), 'PINCODE_MAKER', 'WF Maker for PinCode', 0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
			INSERT INTO SecGroups SELECT (select (SeqNo+3) from SeqSecGroups), 'PINCODE_APPROVER', 'WF Approver for PinCode', 0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroups WHERE 0=0;
			
			INSERT INTO SecRights SELECT (select (SeqNo+3) from SeqSecRights),0,'menuItem_master_PinCode','MENU',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+4) from SeqSecRights),0,'menuItem_master_PinCodeEnquiry','MENU',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+5) from SeqSecRights),2,'button_PinCodeList_PrintList','PinCodeList',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+6) from SeqSecRights),2,'button_PinCodeList_NewPinCode','PinCodeList',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+7) from SeqSecRights),2,'button_PinCodeDialog_btnNew','PinCodeDialog',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+8) from SeqSecRights),2,'button_PinCodeDialog_btnEdit','PinCodeDialog',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+9) from SeqSecRights),2,'button_PinCodeDialog_btnDelete','PinCodeDialog',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10) from SeqSecRights),2,'button_PinCodeDialog_btnSave','PinCodeDialog',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+1) from SeqSecRights),3,'PinCodeDialog_PinCodeId','PinCodeDialog',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+2) from SeqSecRights),3,'PinCodeDialog_PinCode','PinCodeDialog',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+3) from SeqSecRights),3,'PinCodeDialog_City','PinCodeDialog',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			INSERT INTO SecRights SELECT (select (SeqNo+10+4) from SeqSecRights),3,'PinCodeDialog_Active','PinCodeDialog',0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRights WHERE 0=0;
			
			INSERT INTO SecGroupRights SELECT (select (SeqNo+15) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+3) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+16) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+6) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+17) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+9) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+18) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+19) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+1) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+2) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20+1) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+3) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+20+2) from SeqSecGroupRights), (select (SeqNo+2) from SeqSecGroups), (select (SeqNo+10+4) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			
			INSERT INTO SecGroupRights SELECT (select (SeqNo+23) from SeqSecGroupRights), (select (SeqNo+3) from SeqSecGroups), (select (SeqNo+3) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			INSERT INTO SecGroupRights SELECT (select (SeqNo+24) from SeqSecGroupRights), (select (SeqNo+3) from SeqSecGroups), (select (SeqNo+10) from SeqSecRights),1,0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecGroupRights WHERE 0=0;
			
			INSERT INTO SecRoleGroups SELECT (select (SeqNo+1) from SeqSecRoleGroups), (select (SeqNo+2) from SeqSecGroups), (select roleid from SecRoles where RoleCd='MSTGRP1_MAKER'), 0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRoleGroups WHERE 0=0;
			INSERT INTO SecRoleGroups SELECT (select (SeqNo+2) from SeqSecRoleGroups), (select (SeqNo+3) from SeqSecGroups), (select roleid from SecRoles where RoleCd='MSTGRP1_APPROVER'), 0,1000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0 FROM SeqSecRoleGroups WHERE 0=0;
			
			INSERT INTO PTMenuDetails SELECT (select (SeqNo+1) from SeqPTMenuDetails),(SELECT AppID FROM PTApplicationDetails WHERE AppCode='PFS'),'PinCode','menu_Item_PinCode','/WEB-INF/pages/ApplicationMaster/PinCode/PinCodeList.zul',0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0,'menuItem_master_PinCode' FROM SeqPTMenuDetails WHERE 0=0;
			INSERT INTO PTMenuDetails SELECT (select (SeqNo+2) from SeqPTMenuDetails),(SELECT AppID FROM PTApplicationDetails WHERE AppCode='PFS'),'PinCodeEnquiry','menu_Item_PinCodeEnquiry?enqiryModule=Y" ','/WEB-INF/pages/ApplicationMaster/PinCode/PinCodeEnquiryList.zul',0,10000,CURRENT_TIMESTAMP,'Approved',' ',' ',' ',' ',' ',0,'menuItem_master_PinCode' FROM SeqPTMenuDetails WHERE 0=0;
			
			Update SeqSecGroups Set SeqNo = (Select MAX(GrpID) + 1 from SecGroups);
			Update SeqSecRights Set SeqNo = (Select MAX(RightID) + 1 from SecRights);
			Update SeqSecGroupRights Set SeqNo = (Select MAX(GrpRightID) + 1 from SecGroupRights);
			Update SeqSecRoleGroups Set SeqNo = (Select MAX(RoleGrpID) + 1 from SecRoleGroups);
		</sql>
	</changeSet>
	<changeSet id="08" author="Surekha">
		<sql>
			INSERT INTO ReportList Values('PinCode','PinCode','listheader_PinCode.label,listheader_City.label,listheader_Active.label,label.RecordStatus,label.RecordType,','pinCode,city,active,recordStatus,recordType','String,String,boolean,String,String','','ReportList05','Pin Code','Application Master',1,1000,CURRENT_TIMESTAMP,'Approved','','','','','',0,0);
		</sql>
	</changeSet>
	<changeSet id="09" author="Surekha">
		<sql>
			update REPORTLIST set FieldValues='pinCode,pCCityName,active,recordStatus,recordType' where code='PinCode';
		</sql>
	</changeSet>
	<changeSet id="10" author="Surekha">
		<addColumn tableName="PartnerBanks">
			<column name="fileName" type="varchar(30)"/>
		</addColumn>
	</changeSet>
	<changeSet id="11" author="Surekha">
		<addColumn tableName="PartnerBanks_temp">
			<column name="fileName" type="varchar(30)"/>
		</addColumn>
	</changeSet>
	<changeSet id="12" author="Surekha">
		<createView viewName="PARTNERBANKS_VIEW" replaceIfExists="true">
			 SELECT 		T1.PartnerBankId, T1.PartnerBankCode, T1.PartnerBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, 
						T1.AccountNo, T1.AcType, T1.AlwFileDownload, T1.AlwDisb, T1.AlwPayment, T1.AlwReceipt, T1.InFavourLength, T1.Active, T1.Version , T1.LastMntBy, T1.LastMntOn,
						T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T2.BankName BankCodeName,T3.BranchDesc BankBranchCodeName,
						T4.AcTypeDesc AcTypeName,T1.HostGLCode, T1.ProfitCenterID, T1.CostCenterID, T1.FileName
			FROM    	PARTNERBANKS_Temp  T1 INNER JOIN
						BMTBANKDETAIL T2  on T1.BANKCODE=T2.BANKCODE inner join
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode and T1.bankcode=T3.bankcode INNER JOIN
						RMTAccountTypes T4 ON T1.AcType = T4.AcType
			UNION ALL
			SELECT 		T1.PartnerBankId, T1.PartnerBankCode, T1.PartnerBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode,
						T1.AccountNo, T1.AcType, T1.AlwFileDownload, T1.AlwDisb, T1.AlwPayment, T1.AlwReceipt, T1.InFavourLength, T1.Active, T1.Version , T1.LastMntBy, T1.LastMntOn, 
						T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T2.BankName BankCodeName,T3.BranchDesc BankBranchCodeName,
						T4.AcTypeDesc AcTypeName,T1.HostGLCode, T1.ProfitCenterID, T1.CostCenterID, T1.FileName
			FROM    	PartnerBanks  T1 INNER JOIN
			            BMTBankDetail T2  ON T1.BankCode=T2.BankCode INNER JOIN
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode and T1.bankcode=T3.bankcode INNER JOIN
						RMTAccountTypes T4 ON T1.AcType = T4.AcType						
			WHERE     	NOT EXISTS (SELECT 1 FROM PartnerBanks_TEMP WHERE PartnerBankId = T1.PartnerBankId)
		</createView>
	</changeSet>
	<changeSet id="13" author="Surekha">
		<createView viewName="PARTNERBANKS_AVIEW" replaceIfExists="true">
			 SELECT 		T1.PartnerBankId, T1.PartnerBankCode, T1.PartnerBankName, T1.BankCode, T1.BankBranchCode, T1.BranchMICRCode, T1.BranchIFSCCode, T1.BranchCity, T1.UtilityCode, 
						T1.AccountNo, T1.AcType, T1.AlwFileDownload, T1.AlwDisb, T1.AlwPayment, T1.AlwReceipt, T1.InFavourLength, T1.Active, T1.Version , T1.LastMntBy, T1.LastMntOn,
						T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,T2.BankName BankCodeName,T3.BranchDesc BankBranchCodeName,
						T4.AcTypeDesc AcTypeName,T1.HostGLCode, T1.ProfitCenterID, T1.CostCenterID, T1.FileName
			FROM    	PARTNERBANKS  T1 INNER JOIN
						BMTBANKDETAIL T2  on T1.BANKCODE=T2.BANKCODE inner join
						BankBranches T3  ON T1.BankBranchCode = T3.BranchCode and T1.bankcode=T3.bankcode INNER JOIN
						RMTAccountTypes T4 ON T1.AcType = T4.AcType
		</createView>
	</changeSet>
	<changeSet id="14" author="Siva">
		<sql>
			INSERT INTO ErrorDetails VALUES('90323','EN','E','VAS Fee Details not found. Please contact system Administrator.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90324','EN','E','VAS created against Finance record is in maintenance. Not allowed to do VAS Cancellation.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
			INSERT INTO ErrorDetails VALUES('90325','EN','E','Payments were already done for the Finance. Not allowed to do VAS Cancellation.','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
		</sql>
	</changeSet>
	<changeSet id="15" author="Manoj.p">
	<sql>
		update data_engine_config set uploadpath = '/opt/PFF/disbursement/response/stp' where name = 'DISB_HDFC_IMPORT';
		update DATA_ENGINE_CONFIG set FILEPREFIXNAME = '${CLIENT_CODE}', FILENAMEFORMAT = '${ddmm},.${SEQ_DATE_FILE}' where Name = 'DISB_HDFC_EXPORT';
		DELETE FROM  SMTPARAMETERS WHERE SYSPARMCODE IN ('GROUP_ID', 'CLIENT_CODE');
		update partnerbanks set FILENAME = 'FCAT_BF1C' where PARTNERBANKCODE = 'HDFC';
	</sql>	
	</changeSet>
	
	<changeSet id="16" author="Siva">
		<addColumn tableName="FINFEEDETAIL">
			<column name="Status" type="varchar(1)"/>
		</addColumn>
		<addColumn tableName="FINFEEDETAIL_TEMP">
			<column name="Status" type="varchar(1)"/>
		</addColumn>
		<addColumn tableName="FINFEEDETAIL_PA">
			<column name="Status" type="varchar(1)"/>
		</addColumn>
		<addColumn tableName="REJECTFINFEEDETAIL">
			<column name="Status" type="varchar(1)"/>
		</addColumn>
		<addColumn tableName="WIFFINFEEDETAIL">
			<column name="Status" type="varchar(1)"/>
		</addColumn>
		<addColumn tableName="WIFFINFEEDETAIL_TEMP">
			<column name="Status" type="varchar(1)"/>
		</addColumn>
	</changeSet>
	<changeSet id="17" author="Siva">
		<createView viewName="FINFEEDETAIL_TVIEW" replaceIfExists="true">
			  SELECT  T1.FeeID, T1.FinReference, T1.OriginationFee, T1.FinEvent, T1.FeeTypeID, T1.FeeSeq, T1.FeeOrder, T1.CalculatedAmount, T1.ActualAmount, T1.WaivedAmount, T1.PaidAmount,
					T1.FeeScheduleMethod, T1.Terms, T1.RemainingFee, T1.PaymentRef, T1.CalculationType, T1.RuleCode, T1.FixedAmount, T1.Percentage, T1.CalculateOn,
					T1.AlwDeviation, T1.MaxWaiverPerc, T1.AlwModifyFee, T1.AlwModifyFeeSchdMthd, T1.Version, T1.LastMntBy,
					T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
					T2.FeeTypeCode, T2.FeeTypeDesc, T1.VasReference, T1.Status
			FROM    FinFeeDetail_Temp T1 LEFT JOIN 
					FeeTypes T2 ON T1.FeeTypeID = T2.FeeTypeID
		</createView>
	</changeSet>
	<changeSet id="18" author="Siva">
		<createView viewName="FINFEEDETAIL_VIEW" replaceIfExists="true">
			    SELECT 	T1.FeeID, T1.FinReference, T1.OriginationFee, T1.FinEvent, T1.FeeTypeID, T1.FeeSeq, T1.FeeOrder, 
					T1.CalculatedAmount, T1.ActualAmount, T1.WaivedAmount, T1.PaidAmount,
					T1.FeeScheduleMethod, T1.Terms, T1.RemainingFee, T1.PaymentRef, T1.CalculationType, T1.RuleCode, T1.FixedAmount, T1.Percentage, 
					T1.CalculateOn,
					T1.AlwDeviation, T1.MaxWaiverPerc, T1.AlwModifyFee, T1.AlwModifyFeeSchdMthd, T1.Version, T1.LastMntBy,
					T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
					T2.FeeTypeCode, T2.FeeTypeDesc, T1.VasReference, T1.Status
		FROM        FinFeeDetail_Temp T1 LEFT JOIN 
					FeeTypes T2 ON T1.FeeTypeID = T2.FeeTypeID
		UNION ALL
		SELECT      T1.FeeID, T1.FinReference, T1.OriginationFee, T1.FinEvent, T1.FeeTypeID, T1.FeeSeq, T1.FeeOrder, T1.CalculatedAmount, T1.ActualAmount, 
					T1.WaivedAmount, T1.PaidAmount,
					T1.FeeScheduleMethod, T1.Terms, T1.RemainingFee, T1.PaymentRef, T1.CalculationType, T1.RuleCode, T1.FixedAmount, T1.Percentage, T1.CalculateOn,
					T1.AlwDeviation, T1.MaxWaiverPerc, T1.AlwModifyFee, T1.AlwModifyFeeSchdMthd, T1.Version, T1.LastMntBy,
					T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
					T2.FeeTypeCode, T2.FeeTypeDesc, T1.VasReference, T1.Status
		FROM        FinFeeDetail T1 LEFT JOIN 
					FeeTypes T2 ON T1.FeeTypeID = T2.FeeTypeID
		WHERE     	NOT EXISTS
                          (SELECT     1
                            FROM          FinFeeDetail_Temp
                            WHERE      FeeID = T1.FeeID)
		</createView>
	</changeSet>
	<changeSet id="19" author="Siva">
		<createView viewName="WIFFINFEEDETAIL_VIEW" replaceIfExists="true">
			     SELECT  T1.FeeID, T1.FinReference, T1.FeeSeq, T1.OriginationFee, T1.FinEvent, T1.FeeTypeID, T1.FeeOrder, T1.CalculatedAmount, T1.ActualAmount, T1.WaivedAmount, T1.PaidAmount,
           		T1.FeeScheduleMethod, T1.Terms, T1.RemainingFee, T1.PaymentRef, T1.CalculationType, T1.RuleCode, T1.FixedAmount, T1.Percentage, T1.CalculateOn,
		  		T1.AlwDeviation, T1.MaxWaiverPerc, T1.AlwModifyFee, T1.AlwModifyFeeSchdMthd, T1.Version, T1.LastMntBy,
		   		T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
		   		T2.FeeTypeCode, T2.FeeTypeDesc, T1.VasReference, T1.Status
		FROM    WIFFinFeeDetail_Temp T1 LEFT JOIN 
           		FeeTypes T2 ON T1.FeeTypeID = T2.FeeTypeID
		UNION ALL
		SELECT  T1.FeeID, T1.FinReference, T1.FeeSeq, T1.OriginationFee, T1.FinEvent, T1.FeeTypeID, T1.FeeOrder, T1.CalculatedAmount, T1.ActualAmount, T1.WaivedAmount, T1.PaidAmount,
          		T1.FeeScheduleMethod, T1.Terms, T1.RemainingFee, T1.PaymentRef, T1.CalculationType, T1.RuleCode, T1.FixedAmount, T1.Percentage, T1.CalculateOn,
		   		T1.AlwDeviation, T1.MaxWaiverPerc, T1.AlwModifyFee, T1.AlwModifyFeeSchdMthd, T1.Version, T1.LastMntBy,
		   		T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,
		   		T2.FeeTypeCode, T2.FeeTypeDesc, T1.VasReference, T1.Status
		FROM      WIFFinFeeDetail T1 LEFT JOIN 
           		FeeTypes T2 ON T1.FeeTypeID = T2.FeeTypeID
		WHERE     NOT EXISTS
                          (SELECT     1
                            FROM          WIFFinFeeDetail_Temp
                            WHERE      FinReference = T1.FinReference AND OriginationFee = T1.OriginationFee
							AND FinEvent = T1.FinEvent AND FeeTypeID = T1.FeeTypeID)
		</createView>
	</changeSet>
	
	<changeSet id="20" author="Manoj.P">
	<sql>
		update data_engine_table set RECORDLENGTH = 16 where  name = 'MANDATE_RESPONSE';
		update data_engine_table set RECORDLENGTH = 16 where  configid in (select id from data_engine_config where name = 'DISB_HDFC_IMPORT');
		update data_engine_table set RECORDLENGTH = 16 where  configid in (select id from data_engine_config where name = 'DISB_OTHER_IMPORT');
		update partnerbanks set filename = 'FCAT_BAFLTD_BF1C' where  partnerbankcode = 'HDFC'
	</sql>	 
	</changeSet>
	
	<changeSet id="21" author="Manoj.p">
		<dropTable tableName="DEDUP_EOD_CUST_DEMO_DTL"/>
	</changeSet>
	
	<changeSet id="22" author="Manoj.p">
	<createTable tableName="PSX_DEDUP_EOD_CUST_DEMO_DTL">
			<column name="BATCHID" type="decimal(12,0)">
				<constraints nullable="false" />
			</column>
			<column name="CUSTOMER_NO" type="decimal(8,0)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="SOURCE_SYS_ID" type="varchar(5)" />
			<column name="FIRST_NAME" type="varchar(90)" />
			<column name="MIDDLE_NAME" type="varchar(90)" />
			<column name="LAST_NAME" type="varchar(90)" />
			<column name="DOB" type="datetime" />
			<column name="PAN" type="varchar(30)" />
			<column name="DRIVING_LICENSE_NUMBER" type="varchar(45)" />
			<column name="VOTER_ID" type="varchar(20)" />
			<column name="DATE_OF_INCORPORATION" type="datetime" />
			<column name="TAN_NO" type="varchar(15)" />
			<column name="PROCESS_TYPE" type="varchar(2)" >
			<constraints nullable="false" />
			</column>
			<column name="APPLICANT_TYPE" type="varchar(1)" >
				<constraints nullable="false" />
			</column>
			<column name="EMPOYER_NAME" type="varchar(105)" />
			<column name="FATHER_NAME" type="varchar(105)" />
			<column name="PASSPORT_NO" type="varchar(45)" />
			<column name="ACCOUNT_NUMBER" type="varchar(20)" />
			<column name="CREDIT_CARD_NUMBER" type="varchar(60)" />
			<column name="PROCESS_FLAG" type="varchar(1)">
				<constraints nullable="false" />
			</column>
			<column name="ERROR_CODE" type="varchar(1)" />
			<column name="ERROR_DESC" type="varchar(100)" />
			<column name="CUSTOMER_ID" type="varchar(20)">
				<constraints nullable="false" />
			 </column>
			<column name="SOURCE_SYSTEM" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="PSX_BATCH_ID" type="decimal(18,0)" />
			<column name="UCIN_FLAG" type="varchar(10)" />
			<column name="EOD_BATCH_ID" type="decimal(18,0)" />
			<column name="INSERT_TS" type="datetime">
				<constraints nullable="false" />
			 </column>
			<column name="GENDER" type="varchar(20)" />
			<column name="AADHAR_NO" type="varchar(16)" />
			<column name="CIN" type="varchar(100)" />
			<column name="DIN" type="varchar(20)" />
			<column name="REGISTRATION_NO" type="varchar(20)" />
			<column name="CA_NUMBER" type="varchar(100)" />
			<column name="SEGMENT" type="varchar(5)">
				<constraints nullable="false" />
			</column>	
		</createTable>
		
		</changeSet>
		
	<changeSet id="23" author="Manoj.p">
		<dropTable tableName="PSX_DEDUP_EOD_CUST_DEMO_DTL"/>
	</changeSet>
	
	<changeSet id="24" author="Manoj.p">
		<createTable tableName="PSX_DEDUP_EOD_CUST_DEMO_DTL">
			<column name="BATCHID" type="decimal(12,0)">
				<constraints nullable="false" />
			</column>
			<column name="CUSTOMER_NO" type="decimal(8,0)"/>
			<column name="SOURCE_SYS_ID" type="varchar(5)" />
			<column name="FIRST_NAME" type="varchar(90)" />
			<column name="MIDDLE_NAME" type="varchar(90)" />
			<column name="LAST_NAME" type="varchar(90)" />
			<column name="DOB" type="datetime" />
			<column name="PAN" type="varchar(30)" />
			<column name="DRIVING_LICENSE_NUMBER" type="varchar(45)" />
			<column name="VOTER_ID" type="varchar(20)" />
			<column name="DATE_OF_INCORPORATION" type="datetime" />
			<column name="TAN_NO" type="varchar(15)" />
			<column name="PROCESS_TYPE" type="varchar(2)" >
			<constraints nullable="false" />
			</column>
			<column name="APPLICANT_TYPE" type="varchar(1)" >
				<constraints nullable="false" />
			</column>
			<column name="EMPOYER_NAME" type="varchar(105)" />
			<column name="FATHER_NAME" type="varchar(105)" />
			<column name="PASSPORT_NO" type="varchar(45)" />
			<column name="ACCOUNT_NUMBER" type="varchar(20)" />
			<column name="CREDIT_CARD_NUMBER" type="varchar(60)" />
			<column name="PROCESS_FLAG" type="varchar(1)">
				<constraints nullable="false" />
			</column>
			<column name="ERROR_CODE" type="varchar(1)" />
			<column name="ERROR_DESC" type="varchar(100)" />
			<column name="CUSTOMER_ID" type="varchar(20)">
				<constraints nullable="false" />
			 </column>
			<column name="SOURCE_SYSTEM" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="PSX_BATCH_ID" type="decimal(18,0)" />
			<column name="UCIN_FLAG" type="varchar(10)" />
			<column name="EOD_BATCH_ID" type="decimal(18,0)" />
			<column name="INSERT_TS" type="datetime">
				<constraints nullable="false" />
			 </column>
			<column name="GENDER" type="varchar(20)" />
			<column name="AADHAR_NO" type="varchar(16)" />
			<column name="CIN" type="varchar(100)" />
			<column name="DIN" type="varchar(20)" />
			<column name="REGISTRATION_NO" type="varchar(20)" />
			<column name="CA_NUMBER" type="varchar(100)" />
			<column name="SEGMENT" type="varchar(5)">
				<constraints nullable="false" />
			</column>	
		</createTable>
		</changeSet>
		
		<changeSet id="25" author="Manoj.P">
			<dropTable tableName="DEDUP_EOD_CUST_ADDR_DTL"/>
		</changeSet>
		
		<changeSet id="26" author="Manoj.P">
			<createTable tableName="PSX_DEDUP_EOD_CUST_ADDR_DTL">
			<column name="BATCHID" type="decimal(12,0)">
				<constraints nullable="false"/>
			</column>
			<column name="CUSTOMER_NO" type="decimal(8,0)"/>
			<column name="SOURCE_SYS_ID" type="varchar(5)">
				<constraints nullable="false"/>
			</column>
			<column name="SEGMENT" type="varchar(5)">
				<constraints nullable="false"/>
			</column>	
			<column name="ADDRESS_TYPE" type="varchar(24)">
				<constraints nullable="false"/>
			</column>		
			<column name="ADDRESS_1" type="varchar(255)" >
				<constraints nullable="false"/>
			</column>	
			<column name="ADDRESS_2" type="varchar(255)" />
			<column name="ADDRESS_3" type="varchar(255)" />
			<column name="STATE" type="varchar(100)">
				<constraints nullable="false"/>
			</column>
			<column name="CITY" type="varchar(105)">
				<constraints nullable="false" />
			</column>	
			<column name="PIN" type="varchar(24)">
				<constraints nullable="false"/>
			</column>	
			<column name="LANDLINE_1" type="varchar(48)" />
			<column name="LANDLINE_2" type="varchar(48)" />
			<column name="MOBILE" type="varchar(105)" />
			<column name="AREA" type="varchar(120)" />
			<column name="LANDMARK" type="varchar(105)" />
			<column name="STD" type="varchar(48)" />
			<column name="PROCESS_TYPE" type="varchar(2)">
				<constraints nullable="false"/>
			</column>
			<column name="EMAIL" type="varchar(105)" />
			<column name="PROCESS_FLAG" type="varchar(1)">
				<constraints nullable="false"/>
			</column>
			<column name="ERROR_CODE" type="varchar(1)" />
			<column name="ERROR_DESC" type="varchar(100)" />
			<column name="CUSTOMER_ID" type="varchar(20)">
				<constraints nullable="false"/>
			</column>	
			<column name="SOURCE_SYSTEM" type="varchar(20)">
				<constraints nullable="false"/>
			</column>	
			<column name="PSX_BATCH_ID" type="decimal(18,0)" />
			<column name="EOD_BATCH_ID" type="decimal(18,0)" />
		</createTable>
		</changeSet>
		
		<changeSet id="27" author="Manoj.P">
			<dropTable tableName="DEDUP_EOD_CUST_LOAN_DTL"/>
		</changeSet>
		
		<changeSet id="28" author="Manoj.P">
			<createTable tableName="PSX_DEDUP_EOD_CUST_LOAN_DTL">
			<column name="BATCHID" type="decimal(12,0)">
				<constraints nullable="false" />
			</column>
			<column name="CUSTOMER_NO" type="decimal(8,0)" />
			<column name="SOURCE_SYS_ID" type="varchar(5)" >
				<constraints nullable="false"/>
			</column>	
			<column name="SEGMENT" type="varchar(5)">
				<constraints nullable="false"/>
			</column>	
			<column name="DEAL_ID" type="varchar(20)" />
			<column name="LAN_NO" type="varchar(20)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="CUSTOMER_TYPE" type="varchar(1)">
				<constraints nullable="false"/>
			</column>	
			<column name="APPLN_NO" type="decimal(10,0)">
				<constraints nullable="false"/>
			</column>
			<column name="PRODUCT_CODE" type="varchar(10)">
				<constraints nullable="false"/>
			</column>	
			<column name="PROCESS_TYPE" type="varchar(2)">
				<constraints nullable="false"/>
			</column>	
			<column name="PROCESS_FLAG" type="varchar(1)">
				<constraints nullable="false"/>
			</column>		
			<column name="ERROR_CODE" type="varchar(1)" />
			<column name="ERROR_DESC" type="varchar(100)" />
			<column name="PSX_BATCH_ID" type="decimal(18,0)" />
			<column name="PSX_ID" type="decimal(12,0)" />
			<column name="CUSTOMER_ID" type="varchar(20)">
				<constraints nullable="false"/>
			</column>
			<column name="SOURCE_SYSTEM" type="varchar(20)">
				<constraints nullable="false"/>
			</column>	
			<column name="EOD_BATCH_ID" type="decimal(18,0)" />
		</createTable>
		
		</changeSet>
		
		<changeSet id="29" author="Manoj.P">
			<dropTable tableName="DEDUP_EOD_CUST_REP_DTL"/>
		</changeSet>
		
		<changeSet id="30" author="Manoj.P">
		<createTable tableName="DEDUP_EOD_CUST_REP_DTL">
			<column name="BATCHID" type="decimal(12,0)">
				<constraints nullable="false" />
			</column>
			<column name="SOURCE_SYS_ID" type="varchar(5)" >
				<constraints nullable="false"/>
			</column>	
			<column name="CUSTOMER_ID" type="varchar(20)">
				<constraints nullable="false"/>
			</column>
			<column name="FILLER_STRING_1" type="varchar(255)">
				<constraints nullable="false"/>
			</column>
			<column name="FILLER_STRING_2" type="varchar(255)" />
			<column name="FILLER_STRING_3" type="varchar(255)" />
			<column name="FILLER_STRING_4" type="varchar(255)" />
			<column name="FILLER_STRING_5" type="varchar(255)" />
			<column name="FILLER_DATE_1" type="datetime" />
			<column name="FILLER_DATE_2" type="datetime" />
			<column name="FILLER_NUMBER_1" type="decimal(16,0)"/>
			<column name="FILLER_NUMBER_2" type="decimal(16,0)"/>
			<column name="FILLER_NUMBER_3" type="decimal(16,0)"/>
			<column name="FILLER_NUMBER_4" type="decimal(16,0)"/>
			<column name="FILLER_NUMBER_5" type="decimal(16,0)"/>
			<column name="PSX_BATCH_ID" type="decimal(18,0)" />
			<column name="PSX_ID" type="decimal(12,0)" />
			<column name="SOURCE_SYSTEM" type="varchar(20)"/>
			<column name="EOD_BATCH_ID" type="decimal(18,0)" />
			<column name="FILLER_STRING_6" type="varchar(255)" />
			<column name="FILLER_STRING_7" type="varchar(4000)" />
			<column name="FILLER_STRING_8" type="varchar(255)" />
			<column name="PROCESS_TYPE" type="varchar(2)"/>
			<column name="FILLER_STRING_9" type="varchar(255)"/>
		</createTable>
	</changeSet>
	
	<changeSet id="31" author="Durgaprasasd g">
		 <sql>
		    Update SeqSecGroups Set SeqNo = (Select MAX(GrpID) + 1 from SecGroups);
			Update SeqSecRights Set SeqNo = (Select MAX(RightID) + 1 from SecRights);
			Update SeqSecGroupRights Set SeqNo = (Select MAX(GrpRightID) + 1 from SecGroupRights);
			Update SeqSecRoleGroups Set SeqNo = (Select MAX(RoleGrpID) + 1 from SecRoleGroups);
			
			Delete from SecGroupRights where GrpID In (Select GrpID from SecGroups where GrpCode = 'PAYMENTINSTRUCTIONS_ENQUIRY');
			Delete from SecRoleGroups where GrpID IN (Select GrpId from SecGroups WHERE GrpCode = 'PAYMENTINSTRUCTIONS_ENQUIRY') And RoleID IN (Select RoleID from SecRoles WHERE RoleCd = 'MSTGRP1_MAKER');
			Delete from SecGroups where GrpCode = 'PAYMENTINSTRUCTIONS_ENQUIRY';
			INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'PAYMENTINSTRUCTIONS_ENQUIRY','WF Enquiry for PaymentInstructions', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL,0);
			
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'PAYMENTINSTRUCTIONS_ENQUIRY'), (Select RightID from SecRights where RightName = 'menuCat_payment_PaymentInstructions'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			
			Delete from SecGroupRights where RightID In (Select RightID from SecRights where RightName = 'menuItem_payment_PaymentInstructionsEnquiry');
			Delete from SecRights where RightName = 'menuItem_payment_PaymentInstructionsEnquiry';
			Insert into SecRights Values((Select max(RightID) + 1 from SecRights), 0, 'menuItem_payment_PaymentInstructionsEnquiry', 'MENU', 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			Insert into secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'PAYMENTINSTRUCTIONS_ENQUIRY'), (Select RightID from SecRights where RightName = 'menuItem_payment_PaymentInstructionsEnquiry'), 1, 1, 1000, CURRENT_TIMESTAMP, null, null, null, null, null, null, 0 );
			
			INSERT INTO SecRoleGroups values ((SELECT MAX(RoleGrpID) + 1 from SecRoleGroups), (Select MAX(GrpId) from SecGroups WHERE GrpCode = 'PAYMENTINSTRUCTIONS_ENQUIRY'), (Select MAX(RoleID) from SecRoles WHERE RoleCd = 'MSTGRP1_APPROVER'), 0, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			INSERT INTO SecRoleGroups values ((SELECT MAX(RoleGrpID) + 1 from SecRoleGroups), (Select MAX(GrpId) from SecGroups WHERE GrpCode = 'PAYMENTINSTRUCTIONS_ENQUIRY'), (Select MAX(RoleID) from SecRoles WHERE RoleCd = 'MSTGRP1_MAKER'), 0, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			
			Update SeqSecGroups Set SeqNo = (Select MAX(GrpID) + 1 from SecGroups);
			Update SeqSecRights Set SeqNo = (Select MAX(RightID) + 1 from SecRights);
			Update SeqSecGroupRights Set SeqNo = (Select MAX(GrpRightID) + 1 from SecGroupRights);
			Update SeqSecRoleGroups Set SeqNo = (Select MAX(RoleGrpID) + 1 from SecRoleGroups);
		 </sql>
	</changeSet>
	
	<changeSet author="Manoj.P" id="31">
		<addPrimaryKey tableName="ALM"
			constraintName="PK_ALM_FINREF"
			columnNames="AGREEMENTNO" />
	</changeSet>
	
	<changeSet id="32" author="Durgaprasad.g">
		 <renameTable newTableName="PaymentDetails_Temp" oldTableName="PaymentDeatils_Temp"/>
		 <renameTable newTableName="PaymentDetails" oldTableName="PAYMENTDEATILS"/>
		 <renameTable newTableName="SeqPaymentDetails" oldTableName="SeqPaymentDeatils"/>
	</changeSet>
	
	<changeSet id="33" author="Durgaprasad g">
		<createView viewName="PaymentHeader_View" replaceIfExists="true">
		 SELECT	 T1.PaymentId, T1.FinReference, T1.PaymentType, T1.PaymentAmount, T1.CreatedOn,  T1.ApprovedOn, T1.Status, 
				 T1.VERSION, T1.LASTMNTBY, T1.LASTMNTON, T1.RECORDSTATUS, T1.ROLECODE, T1.NEXTROLECODE,
				 T1.TASKID, T1.NEXTTASKID, T1.RECORDTYPE, T1.WORKFLOWID, PIT.PAYMENTTYPE PaymentInstrType
		 FROM     PAYMENTHEADER_TEMP  T1 LEFT OUTER JOIN PAYMENTINSTRUCTIONS_TEMP PIT
         ON T1.PaymentId = PIT.PaymentId
    
		UNION ALL
		SELECT	 T1.PaymentId, T1.FinReference, T1.PaymentType, T1.PaymentAmount, T1.CreatedOn,  T1.ApprovedOn, T1.Status,
				 T1.VERSION, T1.LASTMNTBY, T1.LASTMNTON, T1.RECORDSTATUS, T1.ROLECODE, T1.NEXTROLECODE,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,  PI.PAYMENTTYPE PaymentInstrType
		FROM     PAYMENTHEADER  T1   LEFT OUTER JOIN PAYMENTINSTRUCTIONS PI
         ON T1.PaymentId = PI.PaymentId
		WHERE NOT EXISTS ( SELECT 1  FROM PaymentHeader_Temp WHERE PaymentId = T1.PaymentId)
		
		</createView>
	</changeSet>
	
	<changeSet id="34" author="Durgaprasad g">
		<createView viewName="PaymentHeader_AView" replaceIfExists="true">
		SELECT	 T1.PaymentId, T1.FinReference, T1.PaymentType, T1.PaymentAmount, T1.CreatedOn,  T1.ApprovedOn, T1.Status,
				 T1.VERSION, T1.LASTMNTBY, T1.LASTMNTON, T1.RECORDSTATUS, T1.ROLECODE, T1.NEXTROLECODE,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId,  PI.PAYMENTTYPE PaymentInstrType
		FROM     PAYMENTHEADER  T1   LEFT OUTER JOIN PAYMENTINSTRUCTIONS PI
         ON T1.PaymentId = PI.PaymentId
		 
		</createView>
	</changeSet>

	<changeSet id="35" author="Durgaprasad g">
		<createView viewName="PaymentDetails_View" replaceIfExists="true">
		SELECT	 T1.PaymentDetailId, T1.PaymentId, T1.AmountType, T1.Amount, T1.ReferenceId,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM     PaymentDetails_Temp  T1 
		UNION ALL
		SELECT	 T1.PaymentDetailId, T1.PaymentId, T1.AmountType, T1.Amount, T1.ReferenceId,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM     PaymentDetails  T1  
		WHERE NOT EXISTS ( SELECT 1  FROM PaymentDetails_Temp WHERE PaymentDetailId = T1.PaymentDetailId)
		</createView>
	</changeSet>
	
	<changeSet id="36" author="Durgaprasad g">
		<createView viewName="PaymentDetails_AView" replaceIfExists="true">
		SELECT	 T1.PaymentDetailId, T1.PaymentId, T1.AmountType, T1.Amount, T1.ReferenceId,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId
		FROM     PaymentDetails  T1  
		</createView>
	</changeSet>
	
	<changeSet id="37" author="Durgaprasad g">
		<createView viewName="PaymentInstructions_View" replaceIfExists="true">
		SELECT	 T1.PAYMENTINSTRUCTIONID, T1.PAYMENTID, T1.PAYMENTTYPE, T1.PAYMENTAMOUNT, T1.REMARKS, T1.PARTNERBANKID,
				 T1.IssuingBank, T1.FavourName, T1.FavourNumber, T1.PayableLoc, T1.PrintingLoc, T1.ValueDate, T1.PostDate,
				 T1.BankBranchID, T1.AcctHolderName, T1.AccountNo, T1.PhoneCountryCode, T1.PhoneNumber, 
				 T1.Clearingdate, T1.Active, T1.PaymentCCy,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TASKID, T1.NEXTTASKID, T1.RECORDTYPE, T1.WORKFLOWID,
				 T5.PARTNERBANKCODE, T5.PARTNERBANKNAME,
				 T3.BANKCODE BRANCHBANKCODE,T3.BRANCHCODE BANKBRANCHCODE, T3.IFSC BANKBRANCHIFSC, T3.CITY,
				 T4.BANKNAME ISSUINGBANKNAME, 
				 T6.PcCityName PCCityName, T3.BranchDesc, T2.BankName
				 FROM     PaymentInstructions_Temp  T1 LEFT OUTER JOIN
				 BANKBRANCHES T3 ON T1.BANKBRANCHID = T3.BANKBRANCHID  LEFT OUTER JOIN
				 BMTBANKDETAIL T2 ON T2.BANKCODE = T3.BANKCODE LEFT OUTER JOIN		 
				 BMTBANKDETAIL T4  ON T1.ISSUINGBANK = T4.BANKCODE	LEFT OUTER JOIN
				 PARTNERBANKS T5 ON T5.PARTNERBANKID=T1.PARTNERBANKID LEFT OUTER JOIN
				 RMTPROVINCEVSCITY T6 ON T6.PCCITY = T3.CITY   
		UNION ALL
				SELECT	 T1.PAYMENTINSTRUCTIONID, T1.PAYMENTID, T1.PAYMENTTYPE, T1.PAYMENTAMOUNT, T1.REMARKS, T1.PARTNERBANKID,
				 T1.IssuingBank, T1.FavourName, T1.FavourNumber, T1.PayableLoc, T1.PrintingLoc, T1.ValueDate, T1.PostDate,
				 T1.BankBranchID, T1.AcctHolderName, T1.AccountNo, T1.PhoneCountryCode, T1.PhoneNumber, 
				 T1.Clearingdate, T1.Active, T1.PaymentCCy,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TASKID, T1.NEXTTASKID, T1.RECORDTYPE, T1.WORKFLOWID,
				 T5.PARTNERBANKCODE, T5.PARTNERBANKNAME,
				 T3.BANKCODE BRANCHBANKCODE,T3.BRANCHCODE BANKBRANCHCODE, T3.IFSC BANKBRANCHIFSC, T3.CITY,
				 T4.BANKNAME ISSUINGBANKNAME, 
				 T6.PcCityName PCCityName, T3.BranchDesc, T2.BankName
				 FROM  PaymentInstructions  T1 LEFT OUTER JOIN
				 BANKBRANCHES T3 ON T1.BANKBRANCHID = T3.BANKBRANCHID  LEFT OUTER JOIN
				 BMTBANKDETAIL T2 ON T2.BANKCODE = T3.BANKCODE LEFT OUTER JOIN		 
				 BMTBANKDETAIL T4  ON T1.ISSUINGBANK = T4.BANKCODE	LEFT OUTER JOIN
				 PARTNERBANKS T5 ON T5.PARTNERBANKID=T1.PARTNERBANKID LEFT OUTER JOIN
				 RMTPROVINCEVSCITY T6 ON T6.PCCITY = T3.CITY 
				WHERE NOT EXISTS ( SELECT 1  FROM PaymentInstructions_Temp WHERE PaymentInstructionId = T1.PaymentInstructionId)
		</createView>
	</changeSet>
	
	<changeSet id="38" author="Durgaprasad g">
		<createView viewName="PaymentInstructions_AView" replaceIfExists="true">
		SELECT	 T1.PAYMENTINSTRUCTIONID, T1.PAYMENTID, T1.PAYMENTTYPE, T1.PAYMENTAMOUNT, T1.REMARKS, T1.PARTNERBANKID,
				 T1.IssuingBank, T1.FavourName, T1.FavourNumber, T1.PayableLoc, T1.PrintingLoc, T1.ValueDate, T1.PostDate,
				 T1.BankBranchID, T1.AcctHolderName, T1.AccountNo, T1.PhoneCountryCode, T1.PhoneNumber, 
				 T1.Clearingdate, T1.Active, T1.PaymentCCy,
				 T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode,
				 T1.TASKID, T1.NEXTTASKID, T1.RECORDTYPE, T1.WORKFLOWID,
				 T5.PARTNERBANKCODE, T5.PARTNERBANKNAME,
				 T3.BANKCODE BRANCHBANKCODE,T3.BRANCHCODE BANKBRANCHCODE, T3.IFSC BANKBRANCHIFSC, T3.CITY,
				 T4.BANKNAME ISSUINGBANKNAME, 
				 T6.PcCityName PCCityName, T3.BranchDesc, T2.BankName
				 FROM  PaymentInstructions  T1 LEFT OUTER JOIN
				 BANKBRANCHES T3 ON T1.BANKBRANCHID = T3.BANKBRANCHID  LEFT OUTER JOIN
				 BMTBANKDETAIL T2 ON T2.BANKCODE = T3.BANKCODE LEFT OUTER JOIN		 
				 BMTBANKDETAIL T4  ON T1.ISSUINGBANK = T4.BANKCODE	LEFT OUTER JOIN
				 PARTNERBANKS T5 ON T5.PARTNERBANKID=T1.PARTNERBANKID LEFT OUTER JOIN
				 RMTPROVINCEVSCITY T6 ON T6.PCCITY = T3.CITY 
		</createView>
	</changeSet>
	
	<changeSet author="Manoj.P" id="39">
	<dropPrimaryKey constraintName="PK_PSX_DEDUP_EOD_CUST_LOAN_DTL"
		tableName="PSX_DEDUP_EOD_CUST_LOAN_DTL" />
	</changeSet>


	<changeSet author="Manoj.P" id="40">
		<addPrimaryKey columnNames="LAN_NO, CUSTOMER_TYPE"
			constraintName="PK_LANNO_CUSTTYPE" tableName="PSX_DEDUP_EOD_CUST_LOAN_DTL" />
	</changeSet>
	
	
	<changeSet author="Manoj.P" id="41">
	<dropPrimaryKey constraintName="PK_LANNO_CUSTTYPE"
		tableName="PSX_DEDUP_EOD_CUST_LOAN_DTL" />
	</changeSet>
	
	<changeSet author="Manoj.P" id="42">
	<addNotNullConstraint columnDataType="decimal(8,0)"
		columnName="CUSTOMER_NO" tableName="PSX_DEDUP_EOD_CUST_LOAN_DTL" />
</changeSet>
	
	
	<changeSet author="Manoj.P" id="43">
		<addPrimaryKey columnNames="CUSTOMER_NO,LAN_NO,CUSTOMER_TYPE"
			constraintName="PK_CU_LN_CT" tableName="PSX_DEDUP_EOD_CUST_LOAN_DTL" />
	</changeSet>
</databaseChangeLog>