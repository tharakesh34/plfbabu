<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value="" dbms="oracle" />
	<property name="add.schema" value="" dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PLFAVANSEQC.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="Adarsh" runAlways="true"
		dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>

	<changeSet id="01" author="Durgaprasad G">
		<addColumn tableName="FINANCEMAIN">
			<column name="SanBsdSchdle" type="boolean" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="02" author="Durgaprasad G">
		<addColumn tableName="FINANCEMAIN">
			<column name="PromotionSeqID" type="bigint" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="03" author="Durgaprasad G">
		<addColumn tableName="FINANCEMAIN_PA">
			<column name="SanBsdSchdle" type="boolean" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="04" author="Durgaprasad G">
		<addColumn tableName="FINANCEMAIN_PA">
			<column name="PromotionSeqID" type="bigint" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="05" author="Durgaprasad G">
		<addColumn tableName="FINANCEMAIN_TEMP">
			<column name="SanBsdSchdle" type="boolean" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="06" author="Durgaprasad G">
		<addColumn tableName="FINANCEMAIN_TEMP">
			<column name="PromotionSeqID" type="bigint" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="07" author="Durgaprasad G">
		<createView viewName="financemain_aview" replaceIfExists="true">
			SELECT t1.finreference,
		    t1.investmentref,
		    t1.numberofterms,
		    t1.grcperiodenddate,
		    t1.allowgrcperiod,
		    t1.gracebaserate,
		    t1.gracespecialrate,
		    t1.grcpftrate,
		    t1.grcpftfrq,
		    t1.nextgrcpftdate,
		    t1.allowgrcpftrvw,
		    t1.grcpftrvwfrq,
		    t1.nextgrcpftrvwdate,
		    t1.allowgrccpz,
		    t1.grccpzfrq,
		    t1.nextgrccpzdate,
		    t1.repaybaserate,
		    t1.repayspecialrate,
		    t1.repayprofitrate,
		    t1.repayfrq,
		    t1.nextrepaydate,
		    t1.repaypftfrq,
		    t1.nextrepaypftdate,
		    t1.allowrepayrvw,
		    t1.repayrvwfrq,
		    t1.nextrepayrvwdate,
		    t1.allowrepaycpz,
		    t1.repaycpzfrq,
		    t1.nextrepaycpzdate,
		    t1.maturitydate,
		    t1.cpzatgraceend,
		    t1.downpayment,
		    t1.graceflatamount,
		    t1.reqrepayamount,
		    t1.totalprofit,
		    t1.totalcpz,
		    t1.totalgrosspft,
		    t1.totalgrossgrcpft,
		    t1.totalgracepft,
		    t1.totalgracecpz,
		    t1.grcratebasis,
		    t1.repayratebasis,
		    t1.fintype,
		    t1.finremarks,
		    t1.finccy,
		    t1.schedulemethod,
		    t1.profitdaysbasis,
		    t1.reqmaturity,
		    t1.calterms,
		    t1.calmaturity,
		    t1.firstrepay,
		    t1.lastrepay,
		    t1.finstartdate,
		    t1.finamount,
		    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
		    t1.finrepaymentamount,
		    t1.custid,
		    t1.defferments,
		    t1.plandefercount,
		    t1.finbranch,
		    t1.finsourceid,
		    t1.alloweddefrpychange,
		    t1.availeddefrpychange,
		    t1.alloweddeffrqchange,
		    t1.availeddeffrqchange,
		    t1.recaltype,
		    t1.finassetvalue,
		    t1.disbaccountid,
		    t1.repayaccountid,
		    t1.finisactive,
		    t1.limitvalid,
		    t1.overridelimit,
		    t1.securitydeposit,
		    t1.version,
		    t1.lastmntby,
		    t1.lastmnton,
		    t1.recordstatus,
		    t1.rolecode,
		    t1.nextrolecode,
		    t1.taskid,
		    t1.nexttaskid,
		    t1.recordtype,
		    t1.workflowid,
		    t7.fintypedesc AS lovdescfintypename,
		    t7.finmaxamount AS lovdescfinmaxamt,
		    t7.finminamount AS lovdescfinminamount,
		    t1.mindownpayperc,
		    t7.finisalwdifferment AS lovdescfinalwdeferment,
		    t7.finisdwpayrequired AS lovdescdwnpayreq,
		    t7.finmaxdifferment AS lovdescfinmaxdifferment,
		    t12.branchdesc AS lovdescfinbranchname,
		    t12.branchprovince AS finbranchprovincecode,
		    t1.lastrepaydate,
		    t1.lastrepaypftdate,
		    t1.lastrepayrvwdate,
		    t1.lastrepaycpzdate,
		    t1.allowgrcrepay,
		    t1.grcschdmthd,
		    t1.grcmargin,
		    t1.repaymargin,
		    t1.fincurrassetvalue,
		    t1.fincommitmentref,
		    t1.finlimitref,
		    t1.depreciationfrq,
		    t1.fincontractdate,
		    t1.nextdepdate,
		    t1.lastdepdate,
		    t1.finaccount,
		    t1.fincustpftaccount,
		    t17.acrtilllbd AS lovdescaccruedtilllbd,
		    t7.finrvwrateapplfor,
		    t1.totalrepayamt,
		    t1.closingstatus,
		    t1.finapproveddate,
		    t1.feechargeamt,
		    t1.blacklisted,
		    t1.finrepaypftonfrq,
		    t1.anualizedpercrate,
		    t1.effectiverateofreturn,
		    t1.migratedfinance,
		    t1.schedulemaintained,
		    t1.scheduleregenerated,
		    t1.finpurpose,
		    t39.loanpurposedesc AS lovdescfinpurposename,
		    t1.finstatus,
		    t1.finstsreason,
		    t1.initiateuser,
		    t1.bankname,
		    t1.iban,
		    t1.accounttype,
		    t1.ddareferenceno,
		    t7.finscheduleon AS lovdescfinscheduleon,
		    t1.custdsr,
		    t1.jointaccount,
		    t1.jointcustid,
		    t1.downpaybank,
		    t1.downpaysupl,
		    t1.downpayaccount,
		    t1.securitycollateral,
		    t1.approved,
		    t1.discrepancy,
		    t1.limitapproved,
		    t1.graceterms,
		    t7.findivision AS lovdescfindivision,
		    t1.rcdmaintainsts,
		    t1.finrepaymethod,
		    t1.grcprofitdaysbasis,
		    t1.stepfinance,
		    t1.steptype,
		    t1.steppolicy,
		    t1.alwmanualsteps,
		    t1.noofsteps,
		    t1.linkedfinref,
		    t1.nextuserid,
		    t1.priority,
		    t24.policydesc AS lovdescsteppolicyname,
		    t1.grcminrate,
		    t1.grcmaxrate,
		    t1.rpyminrate,
		    t1.rpymaxrate,
		    t1.deviationapproval,
		    t1.manualschedule,
		    t1.takeoverfinance,
		    t1.grcadvbaserate,
		    t1.grcadvmargin,
		    t1.grcadvpftrate,
		    t1.rpyadvbaserate,
		    t1.rpyadvmargin,
		    t1.rpyadvpftrate,
		    t1.supplementrent,
		    t1.increasedcost,
		    t1.creditinsamt,
		    t1.rolloverfrq,
		    t1.nextrolloverdate,
		    t27.custstsdescription,
		    t1.shariastatus,
		    t1.initiatedate,
		    t1.finpreapprovedref,
		    t1.mmaid,
		    t1.accountsofficer,
		    t1.feeaccountid,
		    t1.fincancelac,
		    t28.dealername AS lovdescaccountsofficer,
		    t28.dealercity AS lovdescsourcecity,
		    t1.dsacode,
		    t30.rofficerdesc AS dsacodedesc,
		    t1.tdsapplicable,
		    t1.mandateid,
		    t1.droplinefrq,
		    t1.firstdroplinedate,
		    t1.pftservicingodlimit,
		    t1.insuranceamt,
		    t1.deductinsdisb,
		    t1.alwbpi,
		    t1.bpitreatment,
		    t1.planemihalw,
		    t1.planemihmethod,
		    t1.planemihmaxperyear,
		    t1.planemihmax,
		    t1.planemihlockperiod,
		    t1.planemicpz,
		    t1.calroundingmode,
		    t1.alwmultidisb,
		    t1.applicationno,
		    t1.referralid,
		    t33.rofficerdesc AS referraliddesc,
		    t1.dmacode,
		    t34.rofficerdesc AS dmacodedesc,
		    t1.salesdepartment,
		    t35.gendeptdesc AS salesdepartmentdesc,
		    t1.quickdisb,
		    t1.wifreference,
		    t1.unplanemihlockperiod,
		    t1.unplanemicpz,
		    t1.reagecpz,
		    t1.maxunplannedemi,
		    t1.maxreageholidays,
		    t1.availedunplanemi,
		    t1.availedreageh,
		    t1.bpiamount,
		    t1.deductfeedisb,
		    t1.rvwrateapplfor,
		    t1.schcalonrvw,
		    t1.pastduepftcalmthd,
		    t1.pastduepftmargin,
		    t1.droppingmethod,
		    t1.ratechganyday,
		    t1.promotioncode,
		    t1.restructureloan,
		    t1.oldfinreference,
		    t1.reagebucket,
		    t1.fincategory,
		    t1.productcategory,
		    t1.roundingtarget,
		    t36.entitycode AS lovdescentitycode,
		    t1.eligibilitymethod,
		    t38.fieldcodevalue AS loveligibilitymethod,
		    t38.valuedesc AS lovdesceligibilitymethod,
		    t1.employeename,
		    t37.rofficerdesc AS employeenamedesc,
		    t1.samplingrequired,
		    t1.legalrequired,
		    t1.grcmaxamount,
		    t1.connector,
		    t40.dealername AS connectorcode,
		    t40.dealercity AS connectordesc,
		    t1.advanceemi,
		    t1.advemiterms,
		    t1.bpipftdaysbasis,
		    t1.fixedratetenor,
		    t1.fixedtenorrate,
		    t12.branchtel AS finbranchcontact,
		    t1.processattributes,
		    t1.businessvertical,
		    bv.code AS businessverticalcode,
		    bv.description AS businessverticaldesc,
		    t1.grcadvtype,
		    t1.grcadvterms,
		    t1.advtype,
		    t1.advterms,
		    t1.advstage,
		    t1.tdspercentage,
		    t1.tdsstartdate,
		    t1.tdsenddate,
		    t1.tdslimitamt,
		    t1.vanreq,
		    t1.vancode,
		    t1.allowdrawingpower,
		    t1.allowrevolving,
		    t1.sanbsdschdle,
			t1.PromotionSeqID
		   FROM financemain t1
		     JOIN rmtfinancetypes t7 ON t1.fintype =  t7.fintype
		     LEFT JOIN rmtbranches t12 ON t1.finbranch =  t12.branchcode
		     LEFT JOIN finpftdetails t17 ON t17.finreference =  t1.finreference
		     LEFT JOIN steppolicyheader t24 ON t1.steppolicy =  t24.policycode
		     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus =  t27.custstscode
		     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
		     LEFT JOIN relationshipofficers t30 ON t1.dsacode =  t30.rofficercode
		     LEFT JOIN relationshipofficers t33 ON t1.referralid =  t33.rofficercode
		     LEFT JOIN relationshipofficers t34 ON t1.dmacode =  t34.rofficercode
		     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment =  t35.gendepartment
		     LEFT JOIN smtdivisiondetail t36 ON t7.findivision =  t36.divisioncode
		     LEFT JOIN relationshipofficers t37 ON t1.employeename =  t37.rofficercode
		     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode =  'ELGMETHOD'
		     LEFT JOIN loanpurposes t39 ON t1.finpurpose =  t39.loanpurposecode
		     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
		     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
		</createView>
	</changeSet>

	<changeSet id="08" author="Durgaprasad G">
		<createView viewName="financemain_tview" replaceIfExists="true">
				SELECT t1.finreference,
			    t1.investmentref,
			    t1.numberofterms,
			    t1.grcperiodenddate,
			    t1.allowgrcperiod,
			    t1.gracebaserate,
			    t1.gracespecialrate,
			    t1.grcpftrate,
			    t1.grcpftfrq,
			    t1.nextgrcpftdate,
			    t1.allowgrcpftrvw,
			    t1.grcpftrvwfrq,
			    t1.nextgrcpftrvwdate,
			    t1.allowgrccpz,
			    t1.grccpzfrq,
			    t1.nextgrccpzdate,
			    t1.repaybaserate,
			    t1.repayspecialrate,
			    t1.repayprofitrate,
			    t1.repayfrq,
			    t1.nextrepaydate,
			    t1.repaypftfrq,
			    t1.nextrepaypftdate,
			    t1.allowrepayrvw,
			    t1.repayrvwfrq,
			    t1.nextrepayrvwdate,
			    t1.allowrepaycpz,
			    t1.repaycpzfrq,
			    t1.nextrepaycpzdate,
			    t1.maturitydate,
			    t1.cpzatgraceend,
			    t1.downpayment,
			    t1.graceflatamount,
			    t1.reqrepayamount,
			    t1.totalprofit,
			    t1.totalcpz,
			    t1.totalgrosspft,
			    t1.totalgrossgrcpft,
			    t1.totalgracepft,
			    t1.totalgracecpz,
			    t1.grcratebasis,
			    t1.repayratebasis,
			    t1.fintype,
			    t1.finremarks,
			    t1.finccy,
			    t1.schedulemethod,
			    t1.profitdaysbasis,
			    t1.reqmaturity,
			    t1.calterms,
			    t1.calmaturity,
			    t1.firstrepay,
			    t1.lastrepay,
			    t1.finstartdate,
			    t1.finamount,
			    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
			    t1.finrepaymentamount,
			    t1.custid,
			    t1.defferments,
			    t1.plandefercount,
			    t1.finbranch,
			    t1.finsourceid,
			    t1.alloweddefrpychange,
			    t1.availeddefrpychange,
			    t1.alloweddeffrqchange,
			    t1.availeddeffrqchange,
			    t1.recaltype,
			    t1.finassetvalue,
			    t1.disbaccountid,
			    t1.repayaccountid,
			    t1.finisactive,
			    t1.limitvalid,
			    t1.overridelimit,
			    t1.securitydeposit,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t7.fintypedesc AS lovdescfintypename,
			    t7.finmaxamount AS lovdescfinmaxamt,
			    t7.finminamount AS lovdescfinminamount,
			    t1.mindownpayperc,
			    t7.finisalwdifferment AS lovdescfinalwdeferment,
			    t7.finisdwpayrequired AS lovdescdwnpayreq,
			    t7.finmaxdifferment AS lovdescfinmaxdifferment,
			    t12.branchdesc AS lovdescfinbranchname,
			    t12.branchprovince AS finbranchprovincecode,
			    t1.lastrepaydate,
			    t1.lastrepaypftdate,
			    t1.lastrepayrvwdate,
			    t1.lastrepaycpzdate,
			    t1.allowgrcrepay,
			    t1.grcschdmthd,
			    t1.grcmargin,
			    t1.repaymargin,
			    t1.fincurrassetvalue,
			    t1.fincommitmentref,
			    t1.finlimitref,
			    t1.depreciationfrq,
			    t1.fincontractdate,
			    t1.nextdepdate,
			    t1.lastdepdate,
			    t1.finaccount,
			    t1.fincustpftaccount,
			    t17.acrtilllbd AS lovdescaccruedtilllbd,
			    t7.finrvwrateapplfor,
			    t1.totalrepayamt,
			    t1.closingstatus,
			    t1.finapproveddate,
			    t1.feechargeamt,
			    t1.blacklisted,
			    t1.finrepaypftonfrq,
			    t1.anualizedpercrate,
			    t1.effectiverateofreturn,
			    t1.migratedfinance,
			    t1.schedulemaintained,
			    t1.scheduleregenerated,
			    t1.finpurpose,
			    t39.loanpurposedesc AS lovdescfinpurposename,
			    t1.finstatus,
			    t1.finstsreason,
			    t1.initiateuser,
			    t1.bankname,
			    t1.iban,
			    t1.accounttype,
			    t1.ddareferenceno,
			    t7.finscheduleon AS lovdescfinscheduleon,
			    t1.custdsr,
			    t1.jointaccount,
			    t1.jointcustid,
			    t1.downpaybank,
			    t1.downpaysupl,
			    t1.downpayaccount,
			    t1.securitycollateral,
			    t1.approved,
			    t1.discrepancy,
			    t1.limitapproved,
			    t1.graceterms,
			    t7.findivision AS lovdescfindivision,
			    t1.rcdmaintainsts,
			    t1.finrepaymethod,
			    t1.grcprofitdaysbasis,
			    t1.stepfinance,
			    t1.steptype,
			    t1.steppolicy,
			    t1.alwmanualsteps,
			    t1.noofsteps,
			    t1.linkedfinref,
			    t1.nextuserid,
			    t1.priority,
			    t24.policydesc AS lovdescsteppolicyname,
			    t1.grcminrate,
			    t1.grcmaxrate,
			    t1.rpyminrate,
			    t1.rpymaxrate,
			    t1.deviationapproval,
			    t1.manualschedule,
			    t1.takeoverfinance,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.supplementrent,
			    t1.increasedcost,
			    t1.creditinsamt,
			    t1.rolloverfrq,
			    t1.nextrolloverdate,
			    t27.custstsdescription,
			    t1.shariastatus,
			    t1.initiatedate,
			    t1.finpreapprovedref,
			    t1.mmaid,
			    t1.accountsofficer,
			    t1.feeaccountid,
			    t1.fincancelac,
			    t28.dealername AS lovdescaccountsofficer,
			    t28.dealercity AS lovdescsourcecity,
			    t1.dsacode,
			    t30.rofficerdesc AS dsacodedesc,
			    t1.tdsapplicable,
			    t1.mandateid,
			    t1.droplinefrq,
			    t1.firstdroplinedate,
			    t1.pftservicingodlimit,
			    t1.insuranceamt,
			    t1.deductinsdisb,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.calroundingmode,
			    t1.alwmultidisb,
			    t1.applicationno,
			    t1.referralid,
			    t33.rofficerdesc AS referraliddesc,
			    t1.dmacode,
			    t34.rofficerdesc AS dmacodedesc,
			    t1.salesdepartment,
			    t35.gendeptdesc AS salesdepartmentdesc,
			    t1.quickdisb,
			    t1.wifreference,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.availedunplanemi,
			    t1.availedreageh,
			    t1.bpiamount,
			    t1.deductfeedisb,
			    t1.rvwrateapplfor,
			    t1.schcalonrvw,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.promotioncode,
			    t1.restructureloan,
			    t1.oldfinreference,
			    t1.reagebucket,
			    t1.fincategory,
			    t1.productcategory,
			    t1.roundingtarget,
			    t36.entitycode AS lovdescentitycode,
			    t1.eligibilitymethod,
			    t38.fieldcodevalue AS loveligibilitymethod,
			    t38.valuedesc AS lovdesceligibilitymethod,
			    t1.employeename,
			    t37.rofficerdesc AS employeenamedesc,
			    t1.samplingrequired,
			    t1.legalrequired,
			    t1.grcmaxamount,
			    t1.connector,
			    t40.dealername AS connectorcode,
			    t40.dealercity AS connectordesc,
			    t1.advanceemi,
			    t1.advemiterms,
			    t1.bpipftdaysbasis,
			    t1.fixedratetenor,
			    t1.fixedtenorrate,
			    t12.branchtel AS finbranchcontact,
			    t1.processattributes,
			    t1.businessvertical,
			    bv.code AS businessverticalcode,
			    bv.description AS businessverticaldesc,
			    t1.grcadvtype,
			    t1.grcadvterms,
			    t1.advtype,
			    t1.advterms,
			    t1.advstage,
			    t1.tdspercentage,
			    t1.tdsstartdate,
			    t1.tdsenddate,
			    t1.tdslimitamt,
			    t1.vanreq,
			    t1.vancode,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.sanbsdschdle,
				t1.PromotionSeqID
			   FROM financemain_temp t1
			     JOIN rmtfinancetypes t7 ON t1.fintype =  t7.fintype
			     LEFT JOIN rmtbranches t12 ON t1.finbranch =  t12.branchcode
			     LEFT JOIN finpftdetails t17 ON t17.finreference =  t1.finreference
			     LEFT JOIN steppolicyheader t24 ON t1.steppolicy =  t24.policycode
			     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus =  t27.custstscode
			     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
			     LEFT JOIN relationshipofficers t30 ON t1.dsacode =  t30.rofficercode
			     LEFT JOIN relationshipofficers t33 ON t1.referralid =  t33.rofficercode
			     LEFT JOIN relationshipofficers t34 ON t1.dmacode =  t34.rofficercode
			     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment =  t35.gendepartment
			     LEFT JOIN smtdivisiondetail t36 ON t7.findivision =  t36.divisioncode
			     LEFT JOIN relationshipofficers t37 ON t1.employeename =  t37.rofficercode
			     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode =  'ELGMETHOD'
			     LEFT JOIN loanpurposes t39 ON t1.finpurpose =  t39.loanpurposecode
			     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
			     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
		</createView>
	</changeSet>


	<changeSet id="9.0_pre" author="Durgaprasad G" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'financemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="09" author="Durgaprasad G">
		<createView viewName="financemain_view" replaceIfExists="true">
				SELECT t1.finreference,
			    t1.investmentref,
			    t1.numberofterms,
			    t1.grcperiodenddate,
			    t1.allowgrcperiod,
			    t1.gracebaserate,
			    t1.gracespecialrate,
			    t1.grcpftrate,
			    t1.grcpftfrq,
			    t1.nextgrcpftdate,
			    t1.allowgrcpftrvw,
			    t1.grcpftrvwfrq,
			    t1.nextgrcpftrvwdate,
			    t1.allowgrccpz,
			    t1.grccpzfrq,
			    t1.nextgrccpzdate,
			    t1.repaybaserate,
			    t1.repayspecialrate,
			    t1.repayprofitrate,
			    t1.repayfrq,
			    t1.nextrepaydate,
			    t1.repaypftfrq,
			    t1.nextrepaypftdate,
			    t1.allowrepayrvw,
			    t1.repayrvwfrq,
			    t1.nextrepayrvwdate,
			    t1.allowrepaycpz,
			    t1.repaycpzfrq,
			    t1.nextrepaycpzdate,
			    t1.maturitydate,
			    t1.cpzatgraceend,
			    t1.downpayment,
			    t1.graceflatamount,
			    t1.reqrepayamount,
			    t1.totalprofit,
			    t1.totalcpz,
			    t1.totalgrosspft,
			    t1.totalgrossgrcpft,
			    t1.totalgracepft,
			    t1.totalgracecpz,
			    t1.grcratebasis,
			    t1.repayratebasis,
			    t1.fintype,
			    t1.finremarks,
			    t1.finccy,
			    t1.schedulemethod,
			    t1.profitdaysbasis,
			    t1.reqmaturity,
			    t1.calterms,
			    t1.calmaturity,
			    t1.firstrepay,
			    t1.lastrepay,
			    t1.finstartdate,
			    t1.finamount,
			    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
			    t1.finrepaymentamount,
			    t1.custid,
			    t1.defferments,
			    t1.plandefercount,
			    t1.finbranch,
			    t1.finsourceid,
			    t1.alloweddefrpychange,
			    t1.availeddefrpychange,
			    t1.alloweddeffrqchange,
			    t1.availeddeffrqchange,
			    t1.recaltype,
			    t1.finassetvalue,
			    t1.disbaccountid,
			    t1.repayaccountid,
			    t1.finisactive,
			    t1.limitvalid,
			    t1.overridelimit,
			    t1.securitydeposit,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t7.fintypedesc AS lovdescfintypename,
			    t7.finmaxamount AS lovdescfinmaxamt,
			    t7.finminamount AS lovdescfinminamount,
			    t1.mindownpayperc,
			    t7.finisalwdifferment AS lovdescfinalwdeferment,
			    t7.finisdwpayrequired AS lovdescdwnpayreq,
			    t7.finmaxdifferment AS lovdescfinmaxdifferment,
			    t12.branchdesc AS lovdescfinbranchname,
			    t12.branchprovince AS finbranchprovincecode,
			    t1.lastrepaydate,
			    t1.lastrepaypftdate,
			    t1.lastrepayrvwdate,
			    t1.lastrepaycpzdate,
			    t1.allowgrcrepay,
			    t1.grcschdmthd,
			    t1.grcmargin,
			    t1.repaymargin,
			    t1.fincurrassetvalue,
			    t1.fincommitmentref,
			    t1.finlimitref,
			    t1.depreciationfrq,
			    t1.fincontractdate,
			    t1.nextdepdate,
			    t1.lastdepdate,
			    t1.finaccount,
			    t1.fincustpftaccount,
			    t17.acrtilllbd AS lovdescaccruedtilllbd,
			    t7.finrvwrateapplfor,
			    t1.totalrepayamt,
			    t1.closingstatus,
			    t1.finapproveddate,
			    t1.feechargeamt,
			    t1.blacklisted,
			    t1.finrepaypftonfrq,
			    t1.anualizedpercrate,
			    t1.effectiverateofreturn,
			    t1.migratedfinance,
			    t1.schedulemaintained,
			    t1.scheduleregenerated,
			    t1.finpurpose,
			    t39.loanpurposedesc AS lovdescfinpurposename,
			    t1.finstatus,
			    t1.finstsreason,
			    t1.initiateuser,
			    t1.bankname,
			    t1.iban,
			    t1.accounttype,
			    t1.ddareferenceno,
			    t7.finscheduleon AS lovdescfinscheduleon,
			    t1.custdsr,
			    t1.jointaccount,
			    t1.jointcustid,
			    t1.downpaybank,
			    t1.downpaysupl,
			    t1.downpayaccount,
			    t1.securitycollateral,
			    t1.approved,
			    t1.discrepancy,
			    t1.limitapproved,
			    t1.graceterms,
			    t7.findivision AS lovdescfindivision,
			    t1.rcdmaintainsts,
			    t1.finrepaymethod,
			    t1.grcprofitdaysbasis,
			    t1.stepfinance,
			    t1.steptype,
			    t1.steppolicy,
			    t1.alwmanualsteps,
			    t1.noofsteps,
			    t1.linkedfinref,
			    t1.nextuserid,
			    t1.priority,
			    t24.policydesc AS lovdescsteppolicyname,
			    t1.grcminrate,
			    t1.grcmaxrate,
			    t1.rpyminrate,
			    t1.rpymaxrate,
			    t1.deviationapproval,
			    t1.manualschedule,
			    t1.takeoverfinance,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.supplementrent,
			    t1.increasedcost,
			    t1.creditinsamt,
			    t1.rolloverfrq,
			    t1.nextrolloverdate,
			    t27.custstsdescription,
			    t1.shariastatus,
			    t1.initiatedate,
			    t1.finpreapprovedref,
			    t1.mmaid,
			    t1.accountsofficer,
			    t1.feeaccountid,
			    t1.fincancelac,
			    t28.dealername AS lovdescaccountsofficer,
			    t28.dealercity AS lovdescsourcecity,
			    t1.dsacode,
			    t30.rofficerdesc AS dsacodedesc,
			    t1.tdsapplicable,
			    t1.mandateid,
			    t1.droplinefrq,
			    t1.firstdroplinedate,
			    t1.pftservicingodlimit,
			    t1.insuranceamt,
			    t1.deductinsdisb,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.calroundingmode,
			    t1.alwmultidisb,
			    t1.applicationno,
			    t1.referralid,
			    t33.rofficerdesc AS referraliddesc,
			    t1.dmacode,
			    t34.rofficerdesc AS dmacodedesc,
			    t1.salesdepartment,
			    t35.gendeptdesc AS salesdepartmentdesc,
			    t1.quickdisb,
			    t1.wifreference,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.availedunplanemi,
			    t1.availedreageh,
			    t1.bpiamount,
			    t1.deductfeedisb,
			    t1.rvwrateapplfor,
			    t1.schcalonrvw,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.promotioncode,
			    t1.restructureloan,
			    t1.oldfinreference,
			    t1.reagebucket,
			    t1.fincategory,
			    t1.productcategory,
			    t1.roundingtarget,
			    t36.entitycode AS lovdescentitycode,
			    t1.eligibilitymethod,
			    t38.fieldcodevalue AS loveligibilitymethod,
			    t38.valuedesc AS lovdesceligibilitymethod,
			    t1.employeename,
			    t37.rofficerdesc AS employeenamedesc,
			    t1.samplingrequired,
			    t1.legalrequired,
			    t1.grcmaxamount,
			    t1.connector,
			    t40.dealername AS connectorcode,
			    t40.dealercity AS connectordesc,
			    t1.advanceemi,
			    t1.advemiterms,
			    t1.bpipftdaysbasis,
			    t1.fixedratetenor,
			    t1.fixedtenorrate,
			    t12.branchtel AS finbranchcontact,
			    t1.processattributes,
			    t1.businessvertical,
			    bv.code AS businessverticalcode,
			    bv.description AS businessverticaldesc,
			    t1.grcadvtype,
			    t1.grcadvterms,
			    t1.advtype,
			    t1.advterms,
			    t1.advstage,
			    t1.tdspercentage,
			    t1.tdsstartdate,
			    t1.tdsenddate,
			    t1.tdslimitamt,
			    t1.vanreq,
			    t1.vancode,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.sanbsdschdle,
				t1.PromotionSeqID
			   FROM financemain_temp t1
			     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
			     LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
			     LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
			     LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
			     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
			     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
			     LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
			     LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
			     LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
			     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
			     LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
			     LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
			     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
			     LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
			     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
			     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
			UNION ALL
			 SELECT t1.finreference,
			    t1.investmentref,
			    t1.numberofterms,
			    t1.grcperiodenddate,
			    t1.allowgrcperiod,
			    t1.gracebaserate,
			    t1.gracespecialrate,
			    t1.grcpftrate,
			    t1.grcpftfrq,
			    t1.nextgrcpftdate,
			    t1.allowgrcpftrvw,
			    t1.grcpftrvwfrq,
			    t1.nextgrcpftrvwdate,
			    t1.allowgrccpz,
			    t1.grccpzfrq,
			    t1.nextgrccpzdate,
			    t1.repaybaserate,
			    t1.repayspecialrate,
			    t1.repayprofitrate,
			    t1.repayfrq,
			    t1.nextrepaydate,
			    t1.repaypftfrq,
			    t1.nextrepaypftdate,
			    t1.allowrepayrvw,
			    t1.repayrvwfrq,
			    t1.nextrepayrvwdate,
			    t1.allowrepaycpz,
			    t1.repaycpzfrq,
			    t1.nextrepaycpzdate,
			    t1.maturitydate,
			    t1.cpzatgraceend,
			    t1.downpayment,
			    t1.graceflatamount,
			    t1.reqrepayamount,
			    t1.totalprofit,
			    t1.totalcpz,
			    t1.totalgrosspft,
			    t1.totalgrossgrcpft,
			    t1.totalgracepft,
			    t1.totalgracecpz,
			    t1.grcratebasis,
			    t1.repayratebasis,
			    t1.fintype,
			    t1.finremarks,
			    t1.finccy,
			    t1.schedulemethod,
			    t1.profitdaysbasis,
			    t1.reqmaturity,
			    t1.calterms,
			    t1.calmaturity,
			    t1.firstrepay,
			    t1.lastrepay,
			    t1.finstartdate,
			    t1.finamount,
			    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
			    t1.finrepaymentamount,
			    t1.custid,
			    t1.defferments,
			    t1.plandefercount,
			    t1.finbranch,
			    t1.finsourceid,
			    t1.alloweddefrpychange,
			    t1.availeddefrpychange,
			    t1.alloweddeffrqchange,
			    t1.availeddeffrqchange,
			    t1.recaltype,
			    t1.finassetvalue,
			    t1.disbaccountid,
			    t1.repayaccountid,
			    t1.finisactive,
			    t1.limitvalid,
			    t1.overridelimit,
			    t1.securitydeposit,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t7.fintypedesc AS lovdescfintypename,
			    t7.finmaxamount AS lovdescfinmaxamt,
			    t7.finminamount AS lovdescfinminamount,
			    t1.mindownpayperc,
			    t7.finisalwdifferment AS lovdescfinalwdeferment,
			    t7.finisdwpayrequired AS lovdescdwnpayreq,
			    t7.finmaxdifferment AS lovdescfinmaxdifferment,
			    t12.branchdesc AS lovdescfinbranchname,
			    t12.branchprovince AS finbranchprovincecode,
			    t1.lastrepaydate,
			    t1.lastrepaypftdate,
			    t1.lastrepayrvwdate,
			    t1.lastrepaycpzdate,
			    t1.allowgrcrepay,
			    t1.grcschdmthd,
			    t1.grcmargin,
			    t1.repaymargin,
			    t1.fincurrassetvalue,
			    t1.fincommitmentref,
			    t1.finlimitref,
			    t1.depreciationfrq,
			    t1.fincontractdate,
			    t1.nextdepdate,
			    t1.lastdepdate,
			    t1.finaccount,
			    t1.fincustpftaccount,
			    t17.acrtilllbd AS lovdescaccruedtilllbd,
			    t7.finrvwrateapplfor,
			    t1.totalrepayamt,
			    t1.closingstatus,
			    t1.finapproveddate,
			    t1.feechargeamt,
			    t1.blacklisted,
			    t1.finrepaypftonfrq,
			    t1.anualizedpercrate,
			    t1.effectiverateofreturn,
			    t1.migratedfinance,
			    t1.schedulemaintained,
			    t1.scheduleregenerated,
			    t1.finpurpose,
			    t39.loanpurposedesc AS lovdescfinpurposename,
			    t1.finstatus,
			    t1.finstsreason,
			    t1.initiateuser,
			    t1.bankname,
			    t1.iban,
			    t1.accounttype,
			    t1.ddareferenceno,
			    t7.finscheduleon AS lovdescfinscheduleon,
			    t1.custdsr,
			    t1.jointaccount,
			    t1.jointcustid,
			    t1.downpaybank,
			    t1.downpaysupl,
			    t1.downpayaccount,
			    t1.securitycollateral,
			    t1.approved,
			    t1.discrepancy,
			    t1.limitapproved,
			    t1.graceterms,
			    t7.findivision AS lovdescfindivision,
			    t1.rcdmaintainsts,
			    t1.finrepaymethod,
			    t1.grcprofitdaysbasis,
			    t1.stepfinance,
			    t1.steptype,
			    t1.steppolicy,
			    t1.alwmanualsteps,
			    t1.noofsteps,
			    t1.linkedfinref,
			    t1.nextuserid,
			    t1.priority,
			    t24.policydesc AS lovdescsteppolicyname,
			    t1.grcminrate,
			    t1.grcmaxrate,
			    t1.rpyminrate,
			    t1.rpymaxrate,
			    t1.deviationapproval,
			    t1.manualschedule,
			    t1.takeoverfinance,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.supplementrent,
			    t1.increasedcost,
			    t1.creditinsamt,
			    t1.rolloverfrq,
			    t1.nextrolloverdate,
			    t27.custstsdescription,
			    t1.shariastatus,
			    t1.initiatedate,
			    t1.finpreapprovedref,
			    t1.mmaid,
			    t1.accountsofficer,
			    t1.feeaccountid,
			    t1.fincancelac,
			    t28.dealername AS lovdescaccountsofficer,
			    t28.dealercity AS lovdescsourcecity,
			    t1.dsacode,
			    t30.rofficerdesc AS dsacodedesc,
			    t1.tdsapplicable,
			    t1.mandateid,
			    t1.droplinefrq,
			    t1.firstdroplinedate,
			    t1.pftservicingodlimit,
			    t1.insuranceamt,
			    t1.deductinsdisb,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.calroundingmode,
			    t1.alwmultidisb,
			    t1.applicationno,
			    t1.referralid,
			    t33.rofficerdesc AS referraliddesc,
			    t1.dmacode,
			    t34.rofficerdesc AS dmacodedesc,
			    t1.salesdepartment,
			    t35.gendeptdesc AS salesdepartmentdesc,
			    t1.quickdisb,
			    t1.wifreference,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.availedunplanemi,
			    t1.availedreageh,
			    t1.bpiamount,
			    t1.deductfeedisb,
			    t1.rvwrateapplfor,
			    t1.schcalonrvw,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.promotioncode,
			    t1.restructureloan,
			    t1.oldfinreference,
			    t1.reagebucket,
			    t1.fincategory,
			    t1.productcategory,
			    t1.roundingtarget,
			    t36.entitycode AS lovdescentitycode,
			    t1.eligibilitymethod,
			    t38.fieldcodevalue AS loveligibilitymethod,
			    t38.valuedesc AS lovdesceligibilitymethod,
			    t1.employeename,
			    t37.rofficerdesc AS employeenamedesc,
			    t1.samplingrequired,
			    t1.legalrequired,
			    t1.grcmaxamount,
			    t1.connector,
			    t40.dealername AS connectorcode,
			    t40.dealercity AS connectordesc,
			    t1.advanceemi,
			    t1.advemiterms,
			    t1.bpipftdaysbasis,
			    t1.fixedratetenor,
			    t1.fixedtenorrate,
			    t12.branchtel AS finbranchcontact,
			    t1.processattributes,
			    t1.businessvertical,
			    bv.code AS businessverticalcode,
			    bv.description AS businessverticaldesc,
			    t1.grcadvtype,
			    t1.grcadvterms,
			    t1.advtype,
			    t1.advterms,
			    t1.advstage,
			    t1.tdspercentage,
			    t1.tdsstartdate,
			    t1.tdsenddate,
			    t1.tdslimitamt,
			    t1.vanreq,
			    t1.vancode,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.sanbsdschdle,
				t1.PromotionSeqID
			   FROM financemain t1
			     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
			     LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
			     LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
			     LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
			     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
			     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
			     LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
			     LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
			     LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
			     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
			     LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
			     LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
			     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
			     LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
			     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
			     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
			  WHERE NOT (EXISTS ( SELECT 1
			           FROM financemain_temp
			          WHERE financemain_temp.finreference = t1.finreference))
		</createView>
	</changeSet>

	<changeSet id="9.0_post" author="Durgaprasad G" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_view');
			]]>
		</sql>
	</changeSet>


	<changeSet id="10" author="Durgaprasad G">
		<createView viewName="financemaintenance_aview"
			replaceIfExists="true">
			SELECT t1.finreference,
		    t1.finbranch,
		    t1.fintype,
		    t1.finccy,
		    t1.schedulemethod,
		    t1.profitdaysbasis,
		    t1.finstartdate,
		    t1.numberofterms,
		    t1.custid,
		    t1.finamount,
		    t1.maturitydate,
		    t1.finrepaymentamount,
		    t1.finisactive,
		    t1.blacklisted,
		    t1.feechargeamt,
		    t1.insuranceamt,
		    t1.graceterms,
		    t1.allowgrcperiod,
		    t1.grcperiodenddate,
		    t1.alwmultidisb,
		    t1.defferments,
		    t1.nextrolecode,
		    t1.recordstatus,
		    t1.recordtype,
		    t1.allowgrcpftrvw,
		    t1.allowrepayrvw,
		    t1.lastrepaydate,
		    t1.lastrepaypftdate,
		    t1.alloweddefrpychange,
		    t1.availeddefrpychange,
		    t1.migratedfinance,
		    t1.rcdmaintainsts,
		    t1.closingstatus,
		    t1.repayratebasis,
		    t1.manualschedule,
		    t1.takeoverfinance,
		    t1.nextrolloverdate,
		    t1.downpayment,
		    t1.planemihalw,
		    t1.fincurrassetvalue,
		    t1.finassetvalue,
		    t2.custcif AS lovdesccustcif,
		    t3.fincategory AS lovdescproductcodename,
		    t3.finisalwdifferment AS lovdescfinalwdeferment,
		    t4.productcategory,
		    t1.samplingrequired,
		    t1.advanceemi,
		    t1.advemiterms,
		    t1.bpipftdaysbasis AS bpiratebasis,
		    t1.sanbsdschdle,
			t1.PromotionSeqID
		   FROM financemain t1
		     JOIN customers t2 ON t1.custid = t2.custid
		     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
		     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
		</createView>
	</changeSet>

	<changeSet id="11" author="Durgaprasad G" dbms="postgresql,oracle">
		<createView viewName="financemaintenance_view"
			replaceIfExists="true">
					SELECT t1.finreference,
		    t1.finbranch,
		    t1.fintype,
		    t1.finccy,
		    t1.schedulemethod,
		    t1.profitdaysbasis,
		    t1.finstartdate,
		    t1.numberofterms,
		    t1.custid,
		    t1.finamount,
		    t1.maturitydate,
		    t1.finrepaymentamount,
		    t1.finisactive,
		    t1.blacklisted,
		    t1.feechargeamt,
		    t1.insuranceamt,
		    t1.graceterms,
		    t1.allowgrcperiod,
		    t1.grcperiodenddate,
		    t1.alwmultidisb,
		    t1.defferments,
		    t1.nextrolecode,
		    t1.recordstatus,
		    t1.recordtype,
		    t1.allowgrcpftrvw,
		    t1.allowrepayrvw,
		    t1.lastrepaydate,
		    t1.lastrepaypftdate,
		    t1.alloweddefrpychange,
		    t1.availeddefrpychange,
		    t1.rcdmaintainsts,
		    t1.migratedfinance,
		    t1.closingstatus,
		    t1.repayratebasis,
		    t1.manualschedule,
		    t1.fincurrassetvalue,
		    t1.takeoverfinance,
		    t1.nextrolloverdate,
		    t1.availedunplanemi,
		    t1.availedreageh,
		    t1.maxunplannedemi,
		    t1.maxreageholidays,
		    t1.downpayment,
		    t1.planemihalw,
		    t1.calterms,
		    t1.ratechganyday,
		    t1.finassetvalue,
		    t2.custcif AS lovdesccustcif,
		    t3.finisalwdifferment AS lovdescfinalwdeferment,
		    t3.findivision AS lovdescfindivision,
		    t3.fincategory AS lovdescproductcodename,
		    t4.productcategory,
		    COALESCE(t5.roledesc, fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
		    COALESCE(t9.noinst, 0) AS noinst,
		    t1.samplingrequired,
		    t1.advemiterms,
		    t1.sanbsdschdle,
			t1.PromotionSeqID
		   FROM financemain_temp t1
		     JOIN customers t2 ON t1.custid = t2.custid
		     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
		     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
		     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
		     LEFT JOIN finpftdetails t9 ON t1.finreference = t9.finreference
		UNION ALL
		 SELECT t1.finreference,
		    t1.finbranch,
		    t1.fintype,
		    t1.finccy,
		    t1.schedulemethod,
		    t1.profitdaysbasis,
		    t1.finstartdate,
		    t1.numberofterms,
		    t1.custid,
		    t1.finamount,
		    t1.maturitydate,
		    t1.finrepaymentamount,
		    t1.finisactive,
		    t1.blacklisted,
		    t1.feechargeamt,
		    t1.insuranceamt,
		    t1.graceterms,
		    t1.allowgrcperiod,
		    t1.grcperiodenddate,
		    t1.alwmultidisb,
		    t1.defferments,
		    t1.nextrolecode,
		    t1.recordstatus,
		    t1.recordtype,
		    t1.allowgrcpftrvw,
		    t1.allowrepayrvw,
		    t1.lastrepaydate,
		    t1.lastrepaypftdate,
		    t1.alloweddefrpychange,
		    t1.availeddefrpychange,
		    t1.rcdmaintainsts,
		    t1.migratedfinance,
		    t1.closingstatus,
		    t1.repayratebasis,
		    t1.manualschedule,
		    t1.fincurrassetvalue,
		    t1.takeoverfinance,
		    t1.nextrolloverdate,
		    t1.availedunplanemi,
		    t1.availedreageh,
		    t1.maxunplannedemi,
		    t1.maxreageholidays,
		    t1.downpayment,
		    t1.planemihalw,
		    t1.calterms,
		    t1.ratechganyday,
		    t1.finassetvalue,
		    t2.custcif AS lovdesccustcif,
		    t3.finisalwdifferment AS lovdescfinalwdeferment,
		    t3.findivision AS lovdescfindivision,
		    t3.fincategory AS lovdescproductcodename,
		    t4.productcategory,
		    COALESCE(t5.roledesc, fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
		    COALESCE(t9.noinst, 0) AS noinst,
		    t1.samplingrequired,
		    t1.advemiterms,
		    t1.sanbsdschdle,
			t1.PromotionSeqID
		   FROM financemain t1
		     JOIN customers t2 ON t1.custid = t2.custid
		     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
		     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
		     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
		     LEFT JOIN finpftdetails t9 ON t1.finreference = t9.finreference
		  WHERE NOT (EXISTS ( SELECT 1 AS expr1
		           FROM financemain_temp
		          WHERE financemain_temp.finreference = t1.finreference))
		</createView>
	</changeSet>

	<changeSet id="11" author="Durgaprasad G" dbms="mssql">
		<createView viewName="financemaintenance_view"
			replaceIfExists="true">
					SELECT t1.finreference,
		    t1.finbranch,
		    t1.fintype,
		    t1.finccy,
		    t1.schedulemethod,
		    t1.profitdaysbasis,
		    t1.finstartdate,
		    t1.numberofterms,
		    t1.custid,
		    t1.finamount,
		    t1.maturitydate,
		    t1.finrepaymentamount,
		    t1.finisactive,
		    t1.blacklisted,
		    t1.feechargeamt,
		    t1.insuranceamt,
		    t1.graceterms,
		    t1.allowgrcperiod,
		    t1.grcperiodenddate,
		    t1.alwmultidisb,
		    t1.defferments,
		    t1.nextrolecode,
		    t1.recordstatus,
		    t1.recordtype,
		    t1.allowgrcpftrvw,
		    t1.allowrepayrvw,
		    t1.lastrepaydate,
		    t1.lastrepaypftdate,
		    t1.alloweddefrpychange,
		    t1.availeddefrpychange,
		    t1.rcdmaintainsts,
		    t1.migratedfinance,
		    t1.closingstatus,
		    t1.repayratebasis,
		    t1.manualschedule,
		    t1.fincurrassetvalue,
		    t1.takeoverfinance,
		    t1.nextrolloverdate,
		    t1.availedunplanemi,
		    t1.availedreageh,
		    t1.maxunplannedemi,
		    t1.maxreageholidays,
		    t1.downpayment,
		    t1.planemihalw,
		    t1.calterms,
		    t1.ratechganyday,
		    t1.finassetvalue,
		    t2.custcif AS lovdesccustcif,
		    t3.finisalwdifferment AS lovdescfinalwdeferment,
		    t3.findivision AS lovdescfindivision,
		    t3.fincategory AS lovdescproductcodename,
		    t4.productcategory,
		    COALESCE(t5.roledesc, dbo.fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
		    COALESCE(t9.noinst, 0) AS noinst,
		    t1.samplingrequired,
		    t1.advemiterms,
		    t1.sanbsdschdle,
			t1.PromotionSeqID
		   FROM financemain_temp t1
		     JOIN customers t2 ON t1.custid = t2.custid
		     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
		     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
		     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
		     LEFT JOIN finpftdetails t9 ON t1.finreference = t9.finreference
		UNION ALL
		 SELECT t1.finreference,
		    t1.finbranch,
		    t1.fintype,
		    t1.finccy,
		    t1.schedulemethod,
		    t1.profitdaysbasis,
		    t1.finstartdate,
		    t1.numberofterms,
		    t1.custid,
		    t1.finamount,
		    t1.maturitydate,
		    t1.finrepaymentamount,
		    t1.finisactive,
		    t1.blacklisted,
		    t1.feechargeamt,
		    t1.insuranceamt,
		    t1.graceterms,
		    t1.allowgrcperiod,
		    t1.grcperiodenddate,
		    t1.alwmultidisb,
		    t1.defferments,
		    t1.nextrolecode,
		    t1.recordstatus,
		    t1.recordtype,
		    t1.allowgrcpftrvw,
		    t1.allowrepayrvw,
		    t1.lastrepaydate,
		    t1.lastrepaypftdate,
		    t1.alloweddefrpychange,
		    t1.availeddefrpychange,
		    t1.rcdmaintainsts,
		    t1.migratedfinance,
		    t1.closingstatus,
		    t1.repayratebasis,
		    t1.manualschedule,
		    t1.fincurrassetvalue,
		    t1.takeoverfinance,
		    t1.nextrolloverdate,
		    t1.availedunplanemi,
		    t1.availedreageh,
		    t1.maxunplannedemi,
		    t1.maxreageholidays,
		    t1.downpayment,
		    t1.planemihalw,
		    t1.calterms,
		    t1.ratechganyday,
		    t1.finassetvalue,
		    t2.custcif AS lovdesccustcif,
		    t3.finisalwdifferment AS lovdescfinalwdeferment,
		    t3.findivision AS lovdescfindivision,
		    t3.fincategory AS lovdescproductcodename,
		    t4.productcategory,
		    COALESCE(t5.roledesc, dbo.fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
		    COALESCE(t9.noinst, 0) AS noinst,
		    t1.samplingrequired,
		    t1.advemiterms,
		    t1.sanbsdschdle,
			t1.PromotionSeqID
		   FROM financemain t1
		     JOIN customers t2 ON t1.custid = t2.custid
		     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
		     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
		     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
		     LEFT JOIN finpftdetails t9 ON t1.finreference = t9.finreference
		  WHERE NOT (EXISTS ( SELECT 1 AS expr1
		           FROM financemain_temp
		          WHERE financemain_temp.finreference = t1.finreference))
		</createView>
	</changeSet>

	<changeSet id="12" author="Durgaprasad G">
		<sql>
			INSERT INTO bmtintratebasiscodes(
			intratebasiscode,
			intratebasisdesc, intratebasisisactive, version, lastmntby,
			lastmnton, recordstatus, rolecode, nextrolecode, taskid, nexttaskid,
			recordtype, workflowid)
			VALUES ('P/360', 'Periodicity (30D Periods )',
			1, 0, 1000, Current_TimeStamp, 'Approved', null, null, null, null,
			null, 0);
		</sql>
	</changeSet>

	<changeSet id="10" author="satyanarayana.g">
		<addColumn tableName="WIFFINANCEMAIN">
			<column name="AllowDrawingPower" type="boolean" />
			<column name="AllowRevolving" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="11" author="satyanarayana.g">
		<addColumn tableName="WIFFINANCEMAIN_TEMP">
			<column name="AllowDrawingPower" type="boolean" />
			<column name="AllowRevolving" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="12" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE WIFFINANCEMAIN Set AllowDrawingPower = 0  where AllowDrawingPower is null;
				UPDATE WIFFINANCEMAIN Set AllowRevolving = 0 where AllowDrawingPower is null;
				UPDATE WIFFINANCEMAIN_TEMP Set AllowDrawingPower = 0 where AllowDrawingPower is null;
				UPDATE WIFFINANCEMAIN_TEMP Set AllowRevolving = 0 where AllowDrawingPower is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="13.0" author="satyanarayana.g" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE WIFFINANCEMAIN ADD CONSTRAINT DF_WIFFINANCEMAIN_ALWDP DEFAULT 0 FOR ALLOWDRAWINGPOWER;
				ALTER TABLE WIFFINANCEMAIN ADD CONSTRAINT DF_WIFFINANCEMAIN_ALWRNG DEFAULT 0 FOR ALLOWREVOLVING;
				ALTER TABLE WIFFINANCEMAIN_TEMP ADD CONSTRAINT DF_WIFFINANCEMAIN_TEMP_ALWDP DEFAULT 0 FOR ALLOWDRAWINGPOWER;
				ALTER TABLE WIFFINANCEMAIN_TEMP ADD CONSTRAINT DF_WIFFINANCEMAIN_TEMP_ALWRNG DEFAULT 0 FOR ALLOWREVOLVING;
			]]>
		</sql>
	</changeSet>

	<changeSet id="14" author="satyanarayana.g" dbms="postgresql, oracle">
		<addDefaultValue columnName="AllowDrawingPower"
			tableName="WIFFINANCEMAIN" defaultValue="0" />
		<addDefaultValue columnName="AllowRevolving"
			tableName="WIFFINANCEMAIN" defaultValue="0" />
		<addDefaultValue columnName="AllowDrawingPower"
			tableName="WIFFINANCEMAIN_TEMP" defaultValue="0" />
		<addDefaultValue columnName="AllowRevolving"
			tableName="WIFFINANCEMAIN_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="15_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'wiffinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="15" author="satyanarayana.g">
		<createView viewName="WIFFINANCEMAIN_VIEW" replaceIfExists="true">
			SELECT T1.FINREFERENCE,
					T1.NUMBEROFTERMS,
					T1.GRCPERIODENDDATE,
					T1.ALLOWGRCPERIOD,
					T1.GRACEBASERATE,
					T1.GRACESPECIALRATE,
					T1.GRCPFTRATE,
					T1.GRCPFTFRQ,
					T1.NEXTGRCPFTDATE,
					T1.ALLOWGRCPFTRVW,
					T1.GRCPFTRVWFRQ,
					T1.NEXTGRCPFTRVWDATE,
					T1.ALLOWGRCCPZ,
					T1.GRCCPZFRQ,
					T1.NEXTGRCCPZDATE,
					T1.REPAYBASERATE,
					T1.REPAYSPECIALRATE,
					T1.REPAYPROFITRATE,
					T1.REPAYFRQ,
					T1.NEXTREPAYDATE,
					T1.REPAYPFTFRQ,
					T1.NEXTREPAYPFTDATE,
					T1.ALLOWREPAYRVW,
					T1.REPAYRVWFRQ,
					T1.NEXTREPAYRVWDATE,
					T1.ALLOWREPAYCPZ,
					T1.REPAYCPZFRQ,
					T1.NEXTREPAYCPZDATE,
					T1.MATURITYDATE,
					T1.CPZATGRACEEND,
					T1.DOWNPAYMENT,
					T1.GRACEFLATAMOUNT,
					T1.REQREPAYAMOUNT,
					T1.TOTALPROFIT,
					T1.TOTALCPZ,
					T1.TOTALGROSSPFT,
					T1.TOTALGRACEPFT,
					T1.TOTALGRACECPZ,
					T1.GRCRATEBASIS,
					T1.REPAYRATEBASIS,
					T1.FINTYPE,
					T1.FINREMARKS,
					T1.FINCCY,
					T1.SCHEDULEMETHOD,
					T1.PROFITDAYSBASIS,
					T1.REQMATURITY,
					T1.CALTERMS,
					T1.CALMATURITY,
					T1.FIRSTREPAY,
					T1.LASTREPAY,
					T1.FINSTARTDATE,
					T1.FINAMOUNT,
					T1.FINREPAYMENTAMOUNT,
					T1.CUSTID,
					T1.DEFFERMENTS,
					T1.PLANDEFERCOUNT,
					T1.FINISACTIVE,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T15.CUSTCIF   LOVDESCCUSTCIF,
					T7.FINTYPEDESC  LOVDESCFINTYPENAME,
					T1.FINBRANCH,
					T1.FINSOURCEID,
					T1.ALLOWEDDEFRPYCHANGE,
					T1.AVAILEDDEFRPYCHANGE,
					T1.ALLOWEDDEFFRQCHANGE,
					T1.AVAILEDDEFFRQCHANGE,
					T7.FINMAXAMOUNT   LOVDESCFINMAXAMT,
					T7.FINMINAMOUNT   LOVDESCFINMINAMOUNT,
					T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
					T1.MINDOWNPAYPERC,
					T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
					T1.RECALTYPE,
					T1.FINASSETVALUE,
					T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
					T1.LASTREPAYDATE,
					T1.LASTREPAYPFTDATE,
					T1.LASTREPAYRVWDATE,
					T1.LASTREPAYCPZDATE,
					T1.DISBACCOUNTID,
					T1.REPAYACCOUNTID,
					T1.ALLOWGRCREPAY,
					T1.GRCSCHDMTHD,
					T1.REPAYMARGIN,
					T1.GRCMARGIN,
					T1.DEPRECIATIONFRQ,
					T1.FINCOMMITMENTREF,
					T1.FINCURRASSETVALUE,
					T1.FINCONTRACTDATE,
					T1.NEXTDEPDATE,
					T1.LASTDEPDATE,
					T1.FINACCOUNT,
					T1.FINCUSTPFTACCOUNT,
					T7.FINRVWRATEAPPLFOR,
					T1.TOTALREPAYAMT,
					T1.CLOSINGSTATUS,
					T1.FINAPPROVEDDATE,
					T1.FINREPAYPFTONFRQ,
					T1.ANUALIZEDPERCRATE,
					T1.EFFECTIVERATEOFRETURN,
					T1.DOWNPAYBANK,
					T1.DOWNPAYSUPL,
					T7.FINDIVISION  LOVDESCFINDIVISIONNAME,
					T1.GRACETERMS,
					T14.FACILITYTYPE,
					T15.CUSTSHRTNAME  LOVDESCCUSTSHRTNAME,
					T16.BRANCHDESC   LOVDESCFINBRANCHNAME,
					T1.TOTALGROSSGRCPFT,
					T1.GRCPROFITDAYSBASIS,
					T1.STEPFINANCE,
					T1.STEPTYPE,
					T1.STEPPOLICY,
					T1.ALWMANUALSTEPS,
					T1.NOOFSTEPS,
					T1.LINKEDFINREF,
					T7.PRODUCT  LOVDESCFINPRODUCT,
					T1.GRCMINRATE,
					T1.GRCMAXRATE,
					T1.RPYMINRATE,
					T1.RPYMAXRATE,
					T1.MANUALSCHEDULE,
					T1.TAKEOVERFINANCE,
					T1.GRCADVBASERATE,
					T1.GRCADVMARGIN,
					T1.GRCADVPFTRATE,
					T1.RPYADVBASERATE,
					T1.RPYADVMARGIN,
					T1.RPYADVPFTRATE,
					T1.SUPPLEMENTRENT,
					T1.INCREASEDCOST,
					T1.FEEACCOUNTID,
					T1.TDSAPPLICABLE,
					T1.INSURANCEAMT,
					T1.DEDUCTINSDISB,
					T1.ALWBPI,
					T1.BPITREATMENT,
					T1.PLANEMIHALW,
					T1.PLANEMIHMETHOD,
					T1.PLANEMIHMAXPERYEAR,
					T1.PLANEMIHMAX,
					T1.PLANEMIHLOCKPERIOD,
					T1.PLANEMICPZ,
					T1.CALROUNDINGMODE,
					T1.ALWMULTIDISB,
					T1.BPIAMOUNT,
					T1.DEDUCTFEEDISB,
					T1.FEECHARGEAMT,
					T1.RVWRATEAPPLFOR,
					T1.SCHCALONRVW,
					T1.PASTDUEPFTCALMTHD,
					T1.PASTDUEPFTMARGIN,
					T1.DROPPINGMETHOD,
					T1.RATECHGANYDAY,
					T1.FINCATEGORY,
					T1.PRODUCTCATEGORY,
					T1.ROUNDINGTARGET,
					T1.GRCMAXAMOUNT,
					T1.ADVANCEEMI,
					T1.ADVEMITERMS,
					T1.BPIPFTDAYSBASIS,
					T1.FIXEDTENORRATE,
					T1.FIXEDRATETENOR,
					T1.GRCADVTYPE,
					T1.GRCADVTERMS,
					T1.ADVTYPE,
					T1.ADVTERMS,
					T1.ADVSTAGE,
					T1.ALLOWDRAWINGPOWER,
					T1.ALLOWREVOLVING
					FROM WIFFINANCEMAIN_TEMP T1
					LEFT JOIN WIFINDICATIVETERMDETAIL_TEMP T14 ON T14.FINREFERENCE = T1.FINREFERENCE
					LEFT JOIN CUSTOMERS T15 ON T15.CUSTID = T1.CUSTID
					JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
					LEFT JOIN RMTBRANCHES T16 ON T1.FINBRANCH = T16.BRANCHCODE
					UNION ALL
					SELECT T1.FINREFERENCE,
					T1.NUMBEROFTERMS,
					T1.GRCPERIODENDDATE,
					T1.ALLOWGRCPERIOD,
					T1.GRACEBASERATE,
					T1.GRACESPECIALRATE,
					T1.GRCPFTRATE,
					T1.GRCPFTFRQ,
					T1.NEXTGRCPFTDATE,
					T1.ALLOWGRCPFTRVW,
					T1.GRCPFTRVWFRQ,
					T1.NEXTGRCPFTRVWDATE,
					T1.ALLOWGRCCPZ,
					T1.GRCCPZFRQ,
					T1.NEXTGRCCPZDATE,
					T1.REPAYBASERATE,
					T1.REPAYSPECIALRATE,
					T1.REPAYPROFITRATE,
					T1.REPAYFRQ,
					T1.NEXTREPAYDATE,
					T1.REPAYPFTFRQ,
					T1.NEXTREPAYPFTDATE,
					T1.ALLOWREPAYRVW,
					T1.REPAYRVWFRQ,
					T1.NEXTREPAYRVWDATE,
					T1.ALLOWREPAYCPZ,
					T1.REPAYCPZFRQ,
					T1.NEXTREPAYCPZDATE,
					T1.MATURITYDATE,
					T1.CPZATGRACEEND,
					T1.DOWNPAYMENT,
					T1.GRACEFLATAMOUNT,
					T1.REQREPAYAMOUNT,
					T1.TOTALPROFIT,
					T1.TOTALCPZ,
					T1.TOTALGROSSPFT,
					T1.TOTALGRACEPFT,
					T1.TOTALGRACECPZ,
					T1.GRCRATEBASIS,
					T1.REPAYRATEBASIS,
					T1.FINTYPE,
					T1.FINREMARKS,
					T1.FINCCY,
					T1.SCHEDULEMETHOD,
					T1.PROFITDAYSBASIS,
					T1.REQMATURITY,
					T1.CALTERMS,
					T1.CALMATURITY,
					T1.FIRSTREPAY,
					T1.LASTREPAY,
					T1.FINSTARTDATE,
					T1.FINAMOUNT,
					T1.FINREPAYMENTAMOUNT,
					T1.CUSTID,
					T1.DEFFERMENTS,
					T1.PLANDEFERCOUNT,
					T1.FINISACTIVE,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T15.CUSTCIF     LOVDESCCUSTCIF,
					T7.FINTYPEDESC  LOVDESCFINTYPENAME,
					T1.FINBRANCH,
					T1.FINSOURCEID,
					T1.ALLOWEDDEFRPYCHANGE,
					T1.AVAILEDDEFRPYCHANGE,
					T1.ALLOWEDDEFFRQCHANGE,
					T1.AVAILEDDEFFRQCHANGE,
					T7.FINMAXAMOUNT     LOVDESCFINMAXAMT,
					T7.FINMINAMOUNT     LOVDESCFINMINAMOUNT,
					T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
					T1.MINDOWNPAYPERC,
					T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
					T1.RECALTYPE,
					T1.FINASSETVALUE,
					T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
					T1.LASTREPAYDATE,
					T1.LASTREPAYPFTDATE,
					T1.LASTREPAYRVWDATE,
					T1.LASTREPAYCPZDATE,
					T1.DISBACCOUNTID,
					T1.REPAYACCOUNTID,
					T1.ALLOWGRCREPAY,
					T1.GRCSCHDMTHD,
					T1.REPAYMARGIN,
					T1.GRCMARGIN,
					T1.DEPRECIATIONFRQ,
					T1.FINCOMMITMENTREF,
					T1.FINCURRASSETVALUE,
					T1.FINCONTRACTDATE,
					T1.NEXTDEPDATE,
					T1.LASTDEPDATE,
					T1.FINACCOUNT,
					T1.FINCUSTPFTACCOUNT,
					T7.FINRVWRATEAPPLFOR,
					T1.TOTALREPAYAMT,
					T1.CLOSINGSTATUS,
					T1.FINAPPROVEDDATE,
					T1.FINREPAYPFTONFRQ,
					T1.ANUALIZEDPERCRATE,
					T1.EFFECTIVERATEOFRETURN,
					T1.DOWNPAYBANK,
					T1.DOWNPAYSUPL,
					T7.FINDIVISION  LOVDESCFINDIVISIONNAME,
					T1.GRACETERMS,
					T14.FACILITYTYPE,
					T15.CUSTSHRTNAME  LOVDESCCUSTSHRTNAME,
					T16.BRANCHDESC    LOVDESCFINBRANCHNAME,
					T1.TOTALGROSSGRCPFT,
					T1.GRCPROFITDAYSBASIS,
					T1.STEPFINANCE,
					T1.STEPTYPE,
					T1.STEPPOLICY,
					T1.ALWMANUALSTEPS,
					T1.NOOFSTEPS,
					T1.LINKEDFINREF,
					T7.PRODUCT  LOVDESCFINPRODUCT,
					T1.GRCMINRATE,
					T1.GRCMAXRATE,
					T1.RPYMINRATE,
					T1.RPYMAXRATE,
					T1.MANUALSCHEDULE,
					T1.TAKEOVERFINANCE,
					T1.GRCADVBASERATE,
					T1.GRCADVMARGIN,
					T1.GRCADVPFTRATE,
					T1.RPYADVBASERATE,
					T1.RPYADVMARGIN,
					T1.RPYADVPFTRATE,
					T1.SUPPLEMENTRENT,
					T1.INCREASEDCOST,
					T1.FEEACCOUNTID,
					T1.TDSAPPLICABLE,
					T1.INSURANCEAMT,
					T1.DEDUCTINSDISB,
					T1.ALWBPI,
					T1.BPITREATMENT,
					T1.PLANEMIHALW,
					T1.PLANEMIHMETHOD,
					T1.PLANEMIHMAXPERYEAR,
					T1.PLANEMIHMAX,
					T1.PLANEMIHLOCKPERIOD,
					T1.PLANEMICPZ,
					T1.CALROUNDINGMODE,
					T1.ALWMULTIDISB,
					T1.BPIAMOUNT,
					T1.DEDUCTFEEDISB,
					T1.FEECHARGEAMT,
					T1.RVWRATEAPPLFOR,
					T1.SCHCALONRVW,
					T1.PASTDUEPFTCALMTHD,
					T1.PASTDUEPFTMARGIN,
					T1.DROPPINGMETHOD,
					T1.RATECHGANYDAY,
					T1.FINCATEGORY,
					T1.PRODUCTCATEGORY,
					T1.ROUNDINGTARGET,
					T1.GRCMAXAMOUNT,
					T1.ADVANCEEMI,
					T1.ADVEMITERMS,
					T1.BPIPFTDAYSBASIS,
					T1.FIXEDTENORRATE,
					T1.FIXEDRATETENOR,
					T1.GRCADVTYPE,
					T1.GRCADVTERMS,
					T1.ADVTYPE,
					T1.ADVTERMS,
					T1.ADVSTAGE,
					T1.ALLOWDRAWINGPOWER,
					T1.ALLOWREVOLVING
					FROM WIFFINANCEMAIN T1
					LEFT JOIN WIFINDICATIVETERMDETAIL_TEMP T14 ON T14.FINREFERENCE = T1.FINREFERENCE
					LEFT JOIN CUSTOMERS T15 ON T15.CUSTID = T1.CUSTID
					JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
					LEFT JOIN RMTBRANCHES T16 ON T1.FINBRANCH = T16.BRANCHCODE
					WHERE NOT (EXISTS (SELECT 1 FROM WIFFINANCEMAIN_TEMP WHERE WIFFINANCEMAIN_TEMP.FINREFERENCE = T1.FINREFERENCE ))
	</createView>
	</changeSet>

	<changeSet id="15_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'wiffinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="16_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'wiffinancemain_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="16" author="satyanarayana.g">
		<createView viewName="WIFFINANCEMAIN_AVIEW"
			replaceIfExists="true">
			SELECT T1.FINREFERENCE,
					T1.NUMBEROFTERMS,
					T1.GRCPERIODENDDATE,
					T1.ALLOWGRCPERIOD,
					T1.GRACEBASERATE,
					T1.GRACESPECIALRATE,
					T1.GRCPFTRATE,
					T1.GRCPFTFRQ,
					T1.NEXTGRCPFTDATE,
					T1.ALLOWGRCPFTRVW,
					T1.GRCPFTRVWFRQ,
					T1.NEXTGRCPFTRVWDATE,
					T1.ALLOWGRCCPZ,
					T1.GRCCPZFRQ,
					T1.NEXTGRCCPZDATE,
					T1.REPAYBASERATE,
					T1.REPAYSPECIALRATE,
					T1.REPAYPROFITRATE,
					T1.REPAYFRQ,
					T1.NEXTREPAYDATE,
					T1.REPAYPFTFRQ,
					T1.NEXTREPAYPFTDATE,
					T1.ALLOWREPAYRVW,
					T1.REPAYRVWFRQ,
					T1.NEXTREPAYRVWDATE,
					T1.ALLOWREPAYCPZ,
					T1.REPAYCPZFRQ,
					T1.NEXTREPAYCPZDATE,
					T1.MATURITYDATE,
					T1.CPZATGRACEEND,
					T1.DOWNPAYMENT,
					T1.GRACEFLATAMOUNT,
					T1.REQREPAYAMOUNT,
					T1.TOTALPROFIT,
					T1.TOTALCPZ,
					T1.TOTALGROSSPFT,
					T1.TOTALGRACEPFT,
					T1.TOTALGRACECPZ,
					T1.GRCRATEBASIS,
					T1.REPAYRATEBASIS,
					T1.FINTYPE,
					T1.FINREMARKS,
					T1.FINCCY,
					T1.SCHEDULEMETHOD,
					T1.PROFITDAYSBASIS,
					T1.REQMATURITY,
					T1.CALTERMS,
					T1.CALMATURITY,
					T1.FIRSTREPAY,
					T1.LASTREPAY,
					T1.FINSTARTDATE,
					T1.FINAMOUNT,
					T1.FINREPAYMENTAMOUNT,
					T1.CUSTID,
					T1.DEFFERMENTS,
					T1.PLANDEFERCOUNT,
					T1.FINISACTIVE,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T15.CUSTCIF   LOVDESCCUSTCIF,
					T7.FINTYPEDESC  LOVDESCFINTYPENAME,
					T1.FINBRANCH,
					T1.FINSOURCEID,
					T1.ALLOWEDDEFRPYCHANGE,
					T1.AVAILEDDEFRPYCHANGE,
					T1.ALLOWEDDEFFRQCHANGE,
					T1.AVAILEDDEFFRQCHANGE,
					T7.FINMAXAMOUNT        LOVDESCFINMAXAMT,
					T7.FINMINAMOUNT        LOVDESCFINMINAMOUNT,
					T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
					T1.MINDOWNPAYPERC,
					T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
					T1.RECALTYPE,
					T1.FINASSETVALUE,
					T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
					T1.LASTREPAYDATE,
					T1.LASTREPAYPFTDATE,
					T1.LASTREPAYRVWDATE,
					T1.LASTREPAYCPZDATE,
					T1.DISBACCOUNTID,
					T1.REPAYACCOUNTID,
					T1.ALLOWGRCREPAY,
					T1.GRCSCHDMTHD,
					T1.REPAYMARGIN,
					T1.GRCMARGIN,
					T1.DEPRECIATIONFRQ,
					T1.FINCOMMITMENTREF,
					T1.FINCURRASSETVALUE,
					T1.FINCONTRACTDATE,
					T1.NEXTDEPDATE,
					T1.LASTDEPDATE,
					T1.FINACCOUNT,
					T1.FINCUSTPFTACCOUNT,
					T7.FINRVWRATEAPPLFOR,
					T1.TOTALREPAYAMT,
					T1.CLOSINGSTATUS,
					T1.FINAPPROVEDDATE,
					T1.FINREPAYPFTONFRQ,
					T1.ANUALIZEDPERCRATE,
					T1.EFFECTIVERATEOFRETURN,
					T1.DOWNPAYBANK,
					T1.DOWNPAYSUPL,
					T7.FINDIVISION  LOVDESCFINDIVISIONNAME,
					T1.GRACETERMS,
					T14.FACILITYTYPE,
					T15.CUSTSHRTNAME  LOVDESCCUSTSHRTNAME,
					T16.BRANCHDESC    LOVDESCFINBRANCHNAME,
					T1.TOTALGROSSGRCPFT,
					T1.GRCPROFITDAYSBASIS,
					T1.STEPFINANCE,
					T1.STEPTYPE,
					T1.STEPPOLICY,
					T1.ALWMANUALSTEPS,
					T1.NOOFSTEPS,
					T1.LINKEDFINREF,
					T7.PRODUCT  LOVDESCFINPRODUCT,
					T1.GRCMINRATE,
					T1.GRCMAXRATE,
					T1.RPYMINRATE,
					T1.RPYMAXRATE,
					T1.MANUALSCHEDULE,
					T1.TAKEOVERFINANCE,
					T1.GRCADVBASERATE,
					T1.GRCADVMARGIN,
					T1.GRCADVPFTRATE,
					T1.RPYADVBASERATE,
					T1.RPYADVMARGIN,
					T1.RPYADVPFTRATE,
					T1.SUPPLEMENTRENT,
					T1.INCREASEDCOST,
					T1.FEEACCOUNTID,
					T1.TDSAPPLICABLE,
					T1.INSURANCEAMT,
					T1.DEDUCTINSDISB,
					T1.ALWBPI,
					T1.BPITREATMENT,
					T1.PLANEMIHALW,
					T1.PLANEMIHMETHOD,
					T1.PLANEMIHMAXPERYEAR,
					T1.PLANEMIHMAX,
					T1.PLANEMIHLOCKPERIOD,
					T1.PLANEMICPZ,
					T1.CALROUNDINGMODE,
					T1.ALWMULTIDISB,
					T1.BPIAMOUNT,
					T1.DEDUCTFEEDISB,
					T1.FEECHARGEAMT,
					T1.RVWRATEAPPLFOR,
					T1.SCHCALONRVW,
					T1.PASTDUEPFTCALMTHD,
					T1.PASTDUEPFTMARGIN,
					T1.DROPPINGMETHOD,
					T1.RATECHGANYDAY,
					T1.ROUNDINGTARGET,
					T1.GRCMAXAMOUNT,
					T1.ADVANCEEMI,
					T1.ADVEMITERMS,
					T1.BPIPFTDAYSBASIS AS BPIRATEBASIS,
					T1.GRCADVTYPE,
					T1.GRCADVTERMS,
					T1.ADVTYPE,
					T1.ADVTERMS,
					T1.ADVSTAGE,
					T1.ALLOWDRAWINGPOWER,
					T1.ALLOWREVOLVING
					FROM WIFFINANCEMAIN T1
					LEFT JOIN WIFINDICATIVETERMDETAIL_TEMP T14 ON T14.FINREFERENCE = T1.FINREFERENCE
					LEFT JOIN CUSTOMERS T15 ON T15.CUSTID = T1.CUSTID
					JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
					LEFT JOIN RMTBRANCHES T16 ON T1.FINBRANCH = T16.BRANCHCODE
	</createView>
	</changeSet>

	<changeSet id="16_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'wiffinancemain_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="17" author="saikiran.v">
		<sql>
				<![CDATA[
					 update reportfilterfields set fielddbname='FINDIVISION' where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PutCallReport'
					 and fieldid=1); 
				]]>
		</sql>
	</changeSet>
	<changeSet id="18" author="saikiran.v">
		<sql>
				<![CDATA[
					INSERT INTO ErrorDetails VALUES('90498','EN','E','Early Settlement Already initiated','','Approved','','','','','',0,CURRENT_TIMESTAMP,1000,0);
				]]>
		</sql>
	</changeSet>
	<changeSet id="19" author="saikiran.v">
		<sql>
				<![CDATA[
				  	DELETE from SMTparameters WHERE SYSPARMCODE='EXCLUDE_SUB_RECEIPT_MODE_VALUE';
					INSERT INTO SMTparameters  VALUES ('EXCLUDE_SUB_RECEIPT_MODE_VALUE', 'To exclude Sub Receipt Mode Values', 'String', '0', '', 1, 0, NULL, NULL,'To exclude Sub Receipt Mode Values From List', 1, 1000, CURRENT_TIMESTAMP,'Approved', '', '', '', '', '',0);
				]]>
		</sql>
	</changeSet>

	<changeSet id="20" author="Durgaprasad G">
		<createTable tableName="IRRScheduleDetail">
			<column name="FinReference" type="varchar(20)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="SchDate" type="datetime">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="ProfitCalc" type="decimal(18,0)" />
			<column name="PrincipalCalc" type="decimal(18,0)" />
			<column name="RepayAmount" type="decimal(18,0)" />
			<column name="ClosingBalance" type="decimal(18,0)" />
			<column name="GapInterst" type="decimal(18,0)" />
		</createTable>
	</changeSet>

	<changeSet id="21" author="Siva">
		<dropColumn tableName="BMTAEEVENTS" columnName="MANDATORY" />
		<dropColumn tableName="BMTAEEVENTS" columnName="ODAPPLICABLE" />
	</changeSet>

	<changeSet id="22" author="Siva">
		<createTable tableName="CategoryWiseEvents">
			<column name="AEEventCode" type="varchar2(8)">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="CategoryCode" type="char(1)">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="ACTIVE" type="NUMBER(1,0)">
				<constraints nullable="false" />
			</column>
			<column name="MANDATORY" type="NUMBER(1,0)">
				<constraints nullable="false" />
			</column>
			<column name="SeqOrder" type="NUMBER(2,0)">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="23" author="Siva">
		<createView viewName="CategoryWiseEvents_VIEW"
			replaceIfExists="true">
				SELECT            T1.AEEventCode, T1.CategoryCode  , T1.Active ,T1.Mandatory, T1.SeqOrder,T2.AEEventCodeDesc
				FROM        CategoryWiseEvents  T1 INNER JOIN 
				BMTAEEvents T2 ON T1.AEEventCode = T2.AEEventCode
	</createView>
	</changeSet>

	<changeSet id="24" author="Siva">
		<sql>
			INSERT INTO CategoryWiseEvents VALUES('ADDDBSF','F',1,0,1);
			INSERT INTO CategoryWiseEvents VALUES('ADDDBSN','F',1,1,2);
			INSERT
			INTO CategoryWiseEvents VALUES('ADDDBSP','F',1,1,3);
			INSERT INTO
			CategoryWiseEvents VALUES('AMZ','F',1,1,4);
			INSERT INTO
			CategoryWiseEvents VALUES('DEFRPY','F',1,1,5);
			INSERT INTO
			CategoryWiseEvents VALUES('DISBINS','F',1,1,6);
			INSERT INTO
			CategoryWiseEvents VALUES('EARLYPAY','F',1,1,7);
			INSERT INTO
			CategoryWiseEvents VALUES('EARLYSTL','F',1,1,8);
			INSERT INTO
			CategoryWiseEvents VALUES('EMIDAY','F',1,1,9);
			INSERT INTO
			CategoryWiseEvents VALUES('FEEPAY','F',1,1,10);
			INSERT INTO
			CategoryWiseEvents VALUES('INSTDATE','F',1,1,11);
			INSERT INTO
			CategoryWiseEvents VALUES('JVPOST','F',1,0,12);
			INSERT INTO
			CategoryWiseEvents VALUES('LATEPAY','F',1,1,13);
			INSERT INTO
			CategoryWiseEvents VALUES('MANFEE','F',1,1,14);
			INSERT INTO
			CategoryWiseEvents VALUES('PAYMTINS','F',1,1,15);
			INSERT INTO
			CategoryWiseEvents VALUES('RATCHG','F',1,1,16);
			INSERT INTO
			CategoryWiseEvents VALUES('REAGING','F',1,1,17);
			INSERT INTO
			CategoryWiseEvents VALUES('REPAY','F',1,1,18);
			INSERT INTO
			CategoryWiseEvents VALUES('SCDCHG','F',1,1,19);
			INSERT INTO
			CategoryWiseEvents VALUES('VASACRUL','F',1,1,20);
			INSERT INTO
			CategoryWiseEvents VALUES('VASFEE','F',1,1,21);
			INSERT INTO
			CategoryWiseEvents VALUES('WRITEOFF','F',1,1,22);

			INSERT INTO
			CategoryWiseEvents VALUES('ADDDBSF','O',1,0,1);
			INSERT INTO
			CategoryWiseEvents VALUES('ADDDBSN','O',1,1,2);
			INSERT INTO
			CategoryWiseEvents VALUES('ADDDBSP','O',1,1,3);
			INSERT INTO
			CategoryWiseEvents VALUES('AMZ','O',1,1,4);
			INSERT INTO
			CategoryWiseEvents VALUES('AMZPD','O',1,1,5);
			INSERT INTO
			CategoryWiseEvents VALUES('AMZSUSP','O',1,1,6);
			INSERT INTO
			CategoryWiseEvents VALUES('CANFIN','O',1,1,7);
			INSERT INTO
			CategoryWiseEvents VALUES('CMTDISB','O',1,1,8);
			INSERT INTO
			CategoryWiseEvents VALUES('JVPOST','O',1,0,9);
			INSERT INTO
			CategoryWiseEvents VALUES('LATEPAY','O',1,1,10);
			INSERT INTO
			CategoryWiseEvents VALUES('MANFEE','O',1,1,11);
			INSERT INTO
			CategoryWiseEvents VALUES('NORM_PD','O',1,1,12);
			INSERT INTO
			CategoryWiseEvents VALUES('NORM_PIS','O',1,1,13);
			INSERT INTO
			CategoryWiseEvents VALUES('PD_NORM','O',1,1,14);
			INSERT INTO
			CategoryWiseEvents VALUES('PD_PIS','O',1,1,15);
			INSERT INTO
			CategoryWiseEvents VALUES('PIS_NORM','O',1,1,16);
			INSERT INTO
			CategoryWiseEvents VALUES('PIS_PD','O',1,1,17);
			INSERT INTO
			CategoryWiseEvents VALUES('PROVSN','O',1,1,18);
			INSERT INTO
			CategoryWiseEvents VALUES('REPAY','O',1,1,19);
			INSERT INTO
			CategoryWiseEvents VALUES('WRITEBK','O',1,1,20);
			INSERT INTO
			CategoryWiseEvents VALUES('WRITEOFF','O',1,1,21);

			INSERT INTO
			CategoryWiseEvents VALUES('ADDDBSP','C',1,1,1);
			INSERT INTO
			CategoryWiseEvents VALUES('ADDDBSN','C',1,1,2);
			INSERT INTO
			CategoryWiseEvents VALUES('AMZ','C',1,1,3);
			INSERT INTO
			CategoryWiseEvents VALUES('AMZ_MON','C',1,1,4);
			INSERT INTO
			CategoryWiseEvents VALUES('COMPOUND','C',1,1,5);
			INSERT INTO
			CategoryWiseEvents VALUES('DISBINS','C',1,1,6);
			INSERT INTO
			CategoryWiseEvents VALUES('EARLYPAY','C',1,1,7);
			INSERT INTO
			CategoryWiseEvents VALUES('EARLYSTL','C',1,1,8);
			INSERT INTO
			CategoryWiseEvents VALUES('FEEPAY','C',1,1,9);
			INSERT INTO
			CategoryWiseEvents VALUES('LATEPAY','C',1,1,10);
			INSERT INTO
			CategoryWiseEvents VALUES('REPAY','C',1,0,11);
			INSERT INTO
			CategoryWiseEvents VALUES('STAGE','C',1,0,12);
			INSERT INTO
			CategoryWiseEvents VALUES('WRITEBK','C',1,1,13);
			INSERT INTO
			CategoryWiseEvents VALUES('WRITEOFF','C',1,1,14);

		</sql>
	</changeSet>

	<changeSet id="25" author="Siva">
		<sql>
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM
			SECRIGHTS), 0,
			'menuItem_SolutionFactory_CDFinanceType','MENU',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM
			SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE
			GRPCODE='FINANCETYPE_MAKER')
			,(SELECT RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='menuItem_SolutionFactory_CDFinanceType'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM
			SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE
			GRPCODE='FINANCETYPE_APPROVER')
			,(SELECT RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='menuItem_SolutionFactory_CDFinanceType'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
		</sql>
	</changeSet>

	<changeSet id="26" author="Siva">
		<comment>New columns added for CD Schemes in Promotion</comment>
		<addColumn tableName="Promotions">
			<column name="ReferenceID" type="bigint" defaultValue="0" />
			<column name="OpenBalOnPV" type="boolean" defaultValue="0" />
			<column name="Tenor" type="int" defaultValue="0" />
			<column name="AdvEMITerms" type="int" defaultValue="0" />
			<column name="PftDaysBasis" type="varchar(8)" />
			<column name="SubventionMethod" type="varchar(8)" />
			<column name="SubventionRate" type="decimal(13,9)"
				defaultValue="0" />
			<column name="TaxApplicable" type="boolean" defaultValue="0" />
			<column name="CashbackMonth" type="int" defaultValue="0" />
			<column name="SchemeIRR" type="decimal(13,9)" defaultValue="0" />
		</addColumn>
		<addColumn tableName="Promotions_Temp">
			<column name="ReferenceID" type="bigint" defaultValue="0" />
			<column name="OpenBalOnPV" type="boolean" defaultValue="0" />
			<column name="Tenor" type="int" defaultValue="0" />
			<column name="AdvEMITerms" type="int" defaultValue="0" />
			<column name="PftDaysBasis" type="varchar(8)" />
			<column name="SubventionMethod" type="varchar(8)" />
			<column name="SubventionRate" type="decimal(13,9)"
				defaultValue="0" />
			<column name="TaxApplicable" type="boolean" defaultValue="0" />
			<column name="CashbackMonth" type="int" defaultValue="0" />
			<column name="SchemeIRR" type="decimal(13,9)" defaultValue="0" />
		</addColumn>
	</changeSet>
	<changeSet id="26.1" author="Siva">
		<comment>New columns added for CD Schemes in Promotion</comment>
		<addColumn tableName="Promotions">
			<column name="ProductCategory" type="varchar(8)" />
		</addColumn>
		<addColumn tableName="Promotions_Temp">
			<column name="ProductCategory" type="varchar(8)" />
		</addColumn>
	</changeSet>

	<changeSet id="27.1" author="Siva">
		<createView viewName="Promotions_AView" replaceIfExists="true">
			SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionMethod, t1.SubventionRate,
			    t1.TaxApplicable, t1.CashbackMonth, t1.SchemeIRR,t1.ProductCategory
			   FROM promotions t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
		</createView>
	</changeSet>

	<changeSet id="28.1" author="Siva">
		<createView viewName="Promotions_TView" replaceIfExists="true">
			SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionMethod, t1.SubventionRate,
			    t1.TaxApplicable, t1.CashbackMonth, t1.SchemeIRR,t1.ProductCategory
			   FROM promotions_temp t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
		</createView>
	</changeSet>

	<changeSet id="29.1" author="Siva">
		<createView viewName="Promotions_View" replaceIfExists="true">
			SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionMethod, t1.SubventionRate,
			    t1.TaxApplicable, t1.CashbackMonth, t1.SchemeIRR,t1.ProductCategory
			   FROM promotions_temp t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
			UNION ALL
			 SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionMethod, t1.SubventionRate,
			    t1.TaxApplicable, t1.CashbackMonth, t1.SchemeIRR,t1.ProductCategory
			   FROM promotions t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
			  WHERE NOT (EXISTS ( SELECT 1
			           FROM promotions_temp
			          WHERE promotions_temp.promotioncode = t1.promotioncode AND promotions_temp.promotionid = t1.promotionid))
		</createView>
	</changeSet>

	<changeSet id="30" author="Siva">
		<addColumn tableName="FinTypeFees">
			<column name="ReferenceId" type="bigint" defaultValue="0" />
		</addColumn>
		<addColumn tableName="FinTypeFees_Temp">
			<column name="ReferenceId" type="bigint" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="31" author="Siva">
		<createView viewName="FinTypeFees_AView" replaceIfExists="true">
			 SELECT t1.fintype,
			    t1.originationfee,
			    t1.finevent,
			    t1.feetypeid,
			    t1.feeorder,
			    t1.feeschedulemethod,
			    t1.calculationtype,
			    t1.rulecode,
			    t1.amount,
			    t1.percentage,
			    t1.calculateon,
			    t1.alwdeviation,
			    t1.maxwaiverperc,
			    t1.alwmodifyfee,
			    t1.alwmodifyfeeschdmthd,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.moduleid,
			    t1.alwpreincomization,
			    t2.feetypecode,
			    t2.feetypedesc,
			    t2.taxapplicable,
			    t2.taxcomponent,
			    t3.rulecodedesc AS ruledesc,
				t1.ReferenceId
			   FROM fintypefees t1
			     JOIN feetypes t2 ON t1.feetypeid = t2.feetypeid
			     LEFT JOIN rules t3 ON t1.rulecode = t3.rulecode AND t3.rulemodule= 'FEES' AND t1.finevent= t3.ruleevent
		</createView>
	</changeSet>
	<changeSet id="32" author="Siva">
		<createView viewName="FinTypeFees_View" replaceIfExists="true">
			SELECT t1.fintype,
			    t1.originationfee,
			    t1.finevent,
			    t1.feetypeid,
			    t1.feeorder,
			    t1.feeschedulemethod,
			    t1.calculationtype,
			    t1.rulecode,
			    t1.amount,
			    t1.percentage,
			    t1.calculateon,
			    t1.alwdeviation,
			    t1.maxwaiverperc,
			    t1.alwmodifyfee,
			    t1.alwmodifyfeeschdmthd,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.moduleid,
			    t1.alwpreincomization,
			    t2.feetypecode,
			    t2.feetypedesc,
			    t2.taxapplicable,
			    t2.taxcomponent,
			    t3.rulecodedesc AS ruledesc,
				t1.ReferenceId
			   FROM fintypefees_temp t1
			     JOIN feetypes t2 ON t1.feetypeid = t2.feetypeid
			     LEFT JOIN rules t3 ON t1.rulecode= t3.rulecode AND t3.rulemodule= 'FEES' AND t1.finevent= t3.ruleevent
			UNION ALL
			 SELECT t1.fintype,
			    t1.originationfee,
			    t1.finevent,
			    t1.feetypeid,
			    t1.feeorder,
			    t1.feeschedulemethod,
			    t1.calculationtype,
			    t1.rulecode,
			    t1.amount,
			    t1.percentage,
			    t1.calculateon,
			    t1.alwdeviation,
			    t1.maxwaiverperc,
			    t1.alwmodifyfee,
			    t1.alwmodifyfeeschdmthd,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t1.moduleid,
			    t1.alwpreincomization,
			    t2.feetypecode,
			    t2.feetypedesc,
			    t2.taxapplicable,
			    t2.taxcomponent,
			    t3.rulecodedesc AS ruledesc,
				t1.ReferenceId
			   FROM fintypefees t1
			     JOIN feetypes t2 ON t1.feetypeid = t2.feetypeid
			     LEFT JOIN rules t3 ON t1.rulecode= t3.rulecode AND t3.rulemodule= 'FEES' AND t1.finevent= t3.ruleevent
			  WHERE NOT (EXISTS ( SELECT 1
			           FROM fintypefees_temp F
			          WHERE F.fintype= t1.fintype AND F.finevent= t1.finevent AND F.feetypeid = t1.feetypeid AND F.originationfee = t1.originationfee))
		</createView>
	</changeSet>

	<changeSet id="33" author="Siva">
		<createSequence sequenceName="SeqPromotionScheme"
			incrementBy="1" startValue="1" minValue="1" maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="34" author="Siva">
		<sql>

			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM
			SECRIGHTS);
			UPDATE
			SEQSECGROUPS SET SEQNO= (SELECT MAX(GRPID) FROM
			SECGROUPS);
			UPDATE
			SEQSECGROUPRIGHTS SET SEQNO = (SELECT
			MAX(GRPRIGHTID) FROM
			SECGROUPRIGHTS);
			UPDATE SEQSECROLEGROUPS SET
			SEQNO= (SELECT MAX(ROLEGRPID) FROM
			SECROLEGROUPS);

			INSERT INTO
			SECGROUPS SELECT (SELECT MAX(GRPID)+1 FROM
			SECGROUPS),
			'CDSCHEME_MAKER', 'WF Maker for CD Scheme Maker',
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECGROUPS
			WHERE 0=0;
			INSERT INTO SECGROUPS SELECT (SELECT MAX(GRPID)+1 FROM
			SECGROUPS), 'CDSCHEME_APPROVER', 'WF Approver for CD Scheme Maker',
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECGROUPS
			WHERE 0=0;

			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM
			SECRIGHTS), 0,
			'menuItem_SolutionFactory_CDScheme','MENU',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_Tenor','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_AdvEMITerms','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_CashbackMonth','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_SubventionMethod','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_PftDaysBasis','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_SubventionRate','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_SchemeIRR','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_TaxApplicable','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;


			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM
			SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE
			GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_PromotionCode'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_PromotionDesc'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='PromotionDialog_StartDate'),
			1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='PromotionDialog_EndDate'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_ActualInterestRate'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='PromotionDialog_Tenor'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_AdvEMITerms'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_CashbackMonth'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_SubventionMethod'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_PftDaysBasis'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_SubventionRate'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='PromotionDialog_SchemeIRR'),
			1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_TaxApplicable'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='PromotionDialog_Active'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='menuItem_SolutionFactory_CDScheme'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='button_PromotionDialog_btnSave'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);

			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM
			SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE
			GRPCODE='CDSCHEME_APPROVER')
			,(SELECT RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='menuItem_SolutionFactory_CDScheme'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_APPROVER')
			,(SELECT RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='button_PromotionDialog_btnSave'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);

			INSERT INTO
			SecRoleGroups values((Select MAX(RoleGrpID)+1 From
			SecRoleGroups),(Select GrpId From SecGroups Where
			GrpCode='CDSCHEME_MAKER'), (Select RoleID From SecRoles Where
			RoleCd='MSTGRP1_MAKER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ','
			',' ',0);
			INSERT INTO SecRoleGroups values((Select MAX(RoleGrpID)+1
			From
			SecRoleGroups),(Select GrpId From SecGroups Where
			GrpCode='CDSCHEME_APPROVER'), (Select RoleID From SecRoles Where
			RoleCd='MSTGRP1_APPROVER'),0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ','
			',' ',0);

			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM
			SECRIGHTS);
			UPDATE
			SEQSECGROUPS SET SEQNO= (SELECT MAX(GRPID) FROM
			SECGROUPS);
			UPDATE
			SEQSECGROUPRIGHTS SET SEQNO = (SELECT
			MAX(GRPRIGHTID) FROM
			SECGROUPRIGHTS);
			UPDATE SEQSECROLEGROUPS SET
			SEQNO= (SELECT MAX(ROLEGRPID) FROM
			SECROLEGROUPS);

		</sql>
	</changeSet>

	<changeSet id="35" author="Siva">
		<comment>New columns added for CD Schemes in Promotion</comment>
		<addColumn tableName="Promotions">
			<column name="cashBackFromDealer" type="int" defaultValue="0" />
			<column name="cashBackToCustomer" type="int" defaultValue="0" />
		</addColumn>
		<addColumn tableName="Promotions_Temp">
			<column name="cashBackFromDealer" type="int" defaultValue="0" />
			<column name="cashBackToCustomer" type="int" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="36" author="Siva">
		<createView viewName="Promotions_AView" replaceIfExists="true">
			SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionRate,
			    t1.TaxApplicable, t1.cashBackFromDealer, t1.cashBackToCustomer, t2.ProductCategory
			   FROM promotions t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
		</createView>
	</changeSet>

	<changeSet id="37" author="Siva">
		<createView viewName="Promotions_TView" replaceIfExists="true">
			SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionRate,
			    t1.TaxApplicable, t1.cashBackFromDealer, t1.cashBackToCustomer, t2.ProductCategory
			   FROM promotions_temp t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
		</createView>
	</changeSet>

	<changeSet id="38" author="Siva">
		<createView viewName="Promotions_View" replaceIfExists="true">
			SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionRate,
			    t1.TaxApplicable, t1.cashBackFromDealer, t1.cashBackToCustomer, t2.ProductCategory
			   FROM promotions_temp t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
			UNION ALL
			 SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionRate,
			    t1.TaxApplicable, t1.cashBackFromDealer, t1.cashBackToCustomer, t2.ProductCategory
			   FROM promotions t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
			  WHERE NOT (EXISTS ( SELECT 1
			           FROM promotions_temp
			          WHERE promotions_temp.promotioncode = t1.promotioncode AND promotions_temp.promotionid = t1.promotionid))
		</createView>
	</changeSet>

	<changeSet id="39" author="Siva">
		<dropColumn tableName="Promotions" columnName="SubventionMethod" />
		<dropColumn tableName="Promotions" columnName="CashbackMonth" />
		<dropColumn tableName="Promotions" columnName="SchemeIRR" />
		<dropColumn tableName="Promotions" columnName="ProductCategory" />

		<dropColumn tableName="Promotions_Temp" columnName="SubventionMethod" />
		<dropColumn tableName="Promotions_Temp" columnName="CashbackMonth" />
		<dropColumn tableName="Promotions_Temp" columnName="SchemeIRR" />
		<dropColumn tableName="Promotions_Temp" columnName="ProductCategory" />
	</changeSet>

	<changeSet id="40" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE FINANCEMAIN Set PromotionSeqID = 0  where PromotionSeqID is null;
				UPDATE FINANCEMAIN_TEMP Set PromotionSeqID = 0 where PromotionSeqID is null;
				UPDATE FINANCEMAIN_PA Set PromotionSeqID = 0 where PromotionSeqID is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="41" author="satyanarayana.g">
		<addColumn tableName="REJECTFINANCEMAIN">
			<column name="PromotionSeqID" type="bigint" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="42" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE REJECTFINANCEMAIN Set PromotionSeqID = 0  where PromotionSeqID is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="43_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rejectfinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="44" author="satyanarayana.g">
		<createView viewName="REJECTFINANCEMAIN_VIEW"
			replaceIfExists="true">
			SELECT F.FINREFERENCE,
					T.FINCATEGORY  LOVDESCPRODUCTCODENAME,
					F.FINTYPE,
					F.FINBRANCH,
					F.FINSTARTDATE,
					F.MATURITYDATE,
					F.NUMBEROFTERMS,
					F.FINCCY,
					F.FINAMOUNT,
					F.FINAMOUNT - F.DOWNPAYMENT + F.FEECHARGEAMT + F.INSURANCEAMT  FINANCINGAMOUNT,
					F.FEECHARGEAMT,
					F.INSURANCEAMT,
					F.FINAMOUNT - F.DOWNPAYMENT + F.FEECHARGEAMT + F.INSURANCEAMT - F.FINREPAYMENTAMOUNT  CURFINAMOUNT,
					F.DOWNPAYMENT,
					F.FINCURRASSETVALUE,
					F.FINASSETVALUE,
					F.ALLOWDRAWINGPOWER,
					F.PROMOTIONSEQID,
					C.CUSTCIF  LOVDESCCUSTCIF
					FROM REJECTFINANCEMAIN F
					LEFT JOIN CUSTOMERS C ON F.CUSTID = C.CUSTID
					LEFT JOIN RMTFINANCETYPES T ON F.FINTYPE = T.FINTYPE
	</createView>
	</changeSet>

	<changeSet id="44_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rejectfinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="45" author="satyanarayana.g">
		<addColumn tableName="REJECTFINANCEMAIN">
			<column name="SanBsdSchdle" type="boolean" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="46" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE REJECTFINANCEMAIN Set SanBsdSchdle = 0  where SanBsdSchdle is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="47_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rejectfinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="47" author="satyanarayana.g">
		<createView viewName="REJECTFINANCEMAIN_VIEW"
			replaceIfExists="true">
			SELECT F.FINREFERENCE,
					T.FINCATEGORY  LOVDESCPRODUCTCODENAME,
					F.FINTYPE,
					F.FINBRANCH,
					F.FINSTARTDATE,
					F.MATURITYDATE,
					F.NUMBEROFTERMS,
					F.FINCCY,
					F.FINAMOUNT,
					F.FINAMOUNT - F.DOWNPAYMENT + F.FEECHARGEAMT + F.INSURANCEAMT  FINANCINGAMOUNT,
					F.FEECHARGEAMT,
					F.INSURANCEAMT,
					F.FINAMOUNT - F.DOWNPAYMENT + F.FEECHARGEAMT + F.INSURANCEAMT - F.FINREPAYMENTAMOUNT  CURFINAMOUNT,
					F.DOWNPAYMENT,
					F.FINCURRASSETVALUE,
					F.FINASSETVALUE,
					F.ALLOWDRAWINGPOWER,
					F.PROMOTIONSEQID,
					F.SANBSDSCHDLE,
					C.CUSTCIF  LOVDESCCUSTCIF
					FROM REJECTFINANCEMAIN F
					LEFT JOIN CUSTOMERS C ON F.CUSTID = C.CUSTID
					LEFT JOIN RMTFINANCETYPES T ON F.FINTYPE = T.FINTYPE
	</createView>
	</changeSet>

	<changeSet id="47_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rejectfinancemain_view');
			]]>
		</sql>
	</changeSet>


	<changeSet id="48" author="Pruthvi">
		<sql>
		<![CDATA[
			delete from bmtintratebasiscodes where intratebasiscode='P/360';
			INSERT INTO bmtintratebasiscodes(
			intratebasiscode, intratebasisdesc, intratebasisisactive, version, lastmntby, lastmnton, recordstatus, rolecode, nextrolecode, taskid, nexttaskid, recordtype, workflowid)
			VALUES ('P/360', 'Periodicity (30D Periods )', 1, 0, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0)
		]]>
		</sql>
	</changeSet>

	<changeSet id="49" author="Pruthvi">
		<sql>
		<![CDATA[
			INSERT INTO promotions VALUES ((select coalesce(max(promotionid),0 + 1) from promotions), 'ECOMDD', 'ECOM Discounting', 'PTL', '2019-01-01 00:00:00', '2029-12-31 00:00:00', 0, 0,
	   		21.00, null, null, 0.00, 0, 0, 0, 0,0, 0, 0, 0, 1, 1, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0,1001, 1, 15, 4, 'P/360', 21.00, 1, 0, 0);

			INSERT INTO promotions VALUES ((select max(promotionid)+1 from promotions), 'OFFLD', 'OFF-Line Discounting', 'PTL', '2019-01-01 00:00:00', '2029-12-31 00:00:00', 0, 0,
			21.00, null, null, 0.00, 0, 0, 0, 0,
			0, 0, 0, 0, 1, 1, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0,
			1002, 1, 15, 4, 'P/360', 21.00, 1, 0, 0);

			INSERT INTO promotions VALUES ((select max(promotionid)+1 from promotions), 'OFFLXRC', 'OFF-Line Transfer to Customer', 'PTL', '2019-01-01 00:00:00', '2029-12-31 00:00:00', 0, 0,
			21.00, null, null, 0.00, 0, 0, 0, 0,
			0, 0, 0, 0, 1, 1, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0,
			1003, 0, 15, 4, 'P/360', 11.31, 1, 0, 0);

			INSERT INTO promotions VALUES ((select max(promotionid)+1 from promotions), 'OFFLRTN', 'OFF-Line Subvention Retained', 'PTL', '2019-01-01 00:00:00', '2029-12-31 00:00:00', 0, 0,
			21.00, null, null, 0.00, 0, 0, 0, 0,
			0, 0, 0, 0, 1, 1, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0,
			1004, 0, 15, 4, 'P/360', 21.00, 1, 3, 3);
			]]>
		</sql>
	</changeSet>

	<changeSet id="52" author="ADARSH">
		<addColumn tableName="FINANCEMAIN">
			<column name="SvAmount" type="Decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="53" author="ADARSH">
		<addColumn tableName="FINANCEMAIN">
			<column name="CBAmount" type="Decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="56" author="ADARSH">
		<addColumn tableName="FINANCEMAIN_PA">
			<column name="SvAmount" type="Decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="57" author="ADARSH">
		<addColumn tableName="FINANCEMAIN_PA">
			<column name="CBAmount" type="Decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="60" author="ADARSH">
		<addColumn tableName="FINANCEMAIN_TEMP">
			<column name="SvAmount" type="Decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="61" author="ADARSH">
		<addColumn tableName="FINANCEMAIN_TEMP">
			<column name="CBAmount" type="Decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="62" author="ADARSH">
		<createView replaceIfExists="true" viewName="financemain_aview"> SELECT t1.finreference,
    t1.investmentref,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgrossgrcpft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t1.recaltype,
    t1.finassetvalue,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.finisactive,
    t1.limitvalid,
    t1.overridelimit,
    t1.securitydeposit,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t7.fintypedesc AS lovdescfintypename,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t1.mindownpayperc,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t12.branchdesc AS lovdescfinbranchname,
    t12.branchprovince AS finbranchprovincecode,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.grcmargin,
    t1.repaymargin,
    t1.fincurrassetvalue,
    t1.fincommitmentref,
    t1.finlimitref,
    t1.depreciationfrq,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t17.acrtilllbd AS lovdescaccruedtilllbd,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.feechargeamt,
    t1.blacklisted,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.migratedfinance,
    t1.schedulemaintained,
    t1.scheduleregenerated,
    t1.finpurpose,
    t39.loanpurposedesc AS lovdescfinpurposename,
    t1.finstatus,
    t1.finstsreason,
    t1.initiateuser,
    t1.bankname,
    t1.iban,
    t1.accounttype,
    t1.ddareferenceno,
    t7.finscheduleon AS lovdescfinscheduleon,
    t1.custdsr,
    t1.jointaccount,
    t1.jointcustid,
    t1.downpaybank,
    t1.downpaysupl,
    t1.downpayaccount,
    t1.securitycollateral,
    t1.approved,
    t1.discrepancy,
    t1.limitapproved,
    t1.graceterms,
    t7.findivision AS lovdescfindivision,
    t1.rcdmaintainsts,
    t1.finrepaymethod,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t1.nextuserid,
    t1.priority,
    t24.policydesc AS lovdescsteppolicyname,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.deviationapproval,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.creditinsamt,
    t1.rolloverfrq,
    t1.nextrolloverdate,
    t27.custstsdescription,
    t1.shariastatus,
    t1.initiatedate,
    t1.finpreapprovedref,
    t1.mmaid,
    t1.accountsofficer,
    t1.feeaccountid,
    t1.fincancelac,
    t28.dealername AS lovdescaccountsofficer,
    t28.dealercity AS lovdescsourcecity,
    t1.dsacode,
    t30.rofficerdesc AS dsacodedesc,
    t1.tdsapplicable,
    t1.mandateid,
    t1.droplinefrq,
    t1.firstdroplinedate,
    t1.pftservicingodlimit,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.applicationno,
    t1.referralid,
    t33.rofficerdesc AS referraliddesc,
    t1.dmacode,
    t34.rofficerdesc AS dmacodedesc,
    t1.salesdepartment,
    t35.gendeptdesc AS salesdepartmentdesc,
    t1.quickdisb,
    t1.wifreference,
    t1.unplanemihlockperiod,
    t1.unplanemicpz,
    t1.reagecpz,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.promotioncode,
    t1.restructureloan,
    t1.oldfinreference,
    t1.reagebucket,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t36.entitycode AS lovdescentitycode,
    t1.eligibilitymethod,
    t38.fieldcodevalue AS loveligibilitymethod,
    t38.valuedesc AS lovdesceligibilitymethod,
    t1.employeename,
    t37.rofficerdesc AS employeenamedesc,
    t1.samplingrequired,
    t1.legalrequired,
    t1.grcmaxamount,
    t1.connector,
    t40.dealername AS connectorcode,
    t40.dealercity AS connectordesc,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedratetenor,
    t1.fixedtenorrate,
    t12.branchtel AS finbranchcontact,
    t1.processattributes,
    t1.businessvertical,
    bv.code AS businessverticalcode,
    bv.description AS businessverticaldesc,
    t1.grcadvtype,
    t1.grcadvterms,
    t1.advtype,
    t1.advterms,
    t1.advstage,
    t1.tdspercentage,
    t1.tdsstartdate,
    t1.tdsenddate,
    t1.tdslimitamt,
    t1.vanreq,
    t1.vancode,
    t1.allowdrawingpower,
    t1.allowrevolving,
    t1.sanbsdschdle,
	t1.PromotionSeqID,
	t1.SvAmount,
	t1.CBAmount
   FROM financemain t1
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
     LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
     LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
     LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
     LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
     LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
     LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
     LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
     LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical</createView>
	</changeSet>

	<changeSet id="63" author="ADARSH">
		<createView replaceIfExists="true" viewName="financemain_tview">
		SELECT t1.finreference,
    t1.investmentref,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgrossgrcpft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t1.recaltype,
    t1.finassetvalue,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.finisactive,
    t1.limitvalid,
    t1.overridelimit,
    t1.securitydeposit,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t7.fintypedesc AS lovdescfintypename,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t1.mindownpayperc,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t12.branchdesc AS lovdescfinbranchname,
    t12.branchprovince AS finbranchprovincecode,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.grcmargin,
    t1.repaymargin,
    t1.fincurrassetvalue,
    t1.fincommitmentref,
    t1.finlimitref,
    t1.depreciationfrq,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t17.acrtilllbd AS lovdescaccruedtilllbd,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.feechargeamt,
    t1.blacklisted,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.migratedfinance,
    t1.schedulemaintained,
    t1.scheduleregenerated,
    t1.finpurpose,
    t39.loanpurposedesc AS lovdescfinpurposename,
    t1.finstatus,
    t1.finstsreason,
    t1.initiateuser,
    t1.bankname,
    t1.iban,
    t1.accounttype,
    t1.ddareferenceno,
    t7.finscheduleon AS lovdescfinscheduleon,
    t1.custdsr,
    t1.jointaccount,
    t1.jointcustid,
    t1.downpaybank,
    t1.downpaysupl,
    t1.downpayaccount,
    t1.securitycollateral,
    t1.approved,
    t1.discrepancy,
    t1.limitapproved,
    t1.graceterms,
    t7.findivision AS lovdescfindivision,
    t1.rcdmaintainsts,
    t1.finrepaymethod,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t1.nextuserid,
    t1.priority,
    t24.policydesc AS lovdescsteppolicyname,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.deviationapproval,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.creditinsamt,
    t1.rolloverfrq,
    t1.nextrolloverdate,
    t27.custstsdescription,
    t1.shariastatus,
    t1.initiatedate,
    t1.finpreapprovedref,
    t1.mmaid,
    t1.accountsofficer,
    t1.feeaccountid,
    t1.fincancelac,
    t28.dealername AS lovdescaccountsofficer,
    t28.dealercity AS lovdescsourcecity,
    t1.dsacode,
    t30.rofficerdesc AS dsacodedesc,
    t1.tdsapplicable,
    t1.mandateid,
    t1.droplinefrq,
    t1.firstdroplinedate,
    t1.pftservicingodlimit,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.applicationno,
    t1.referralid,
    t33.rofficerdesc AS referraliddesc,
    t1.dmacode,
    t34.rofficerdesc AS dmacodedesc,
    t1.salesdepartment,
    t35.gendeptdesc AS salesdepartmentdesc,
    t1.quickdisb,
    t1.wifreference,
    t1.unplanemihlockperiod,
    t1.unplanemicpz,
    t1.reagecpz,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.promotioncode,
    t1.restructureloan,
    t1.oldfinreference,
    t1.reagebucket,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t36.entitycode AS lovdescentitycode,
    t1.eligibilitymethod,
    t38.fieldcodevalue AS loveligibilitymethod,
    t38.valuedesc AS lovdesceligibilitymethod,
    t1.employeename,
    t37.rofficerdesc AS employeenamedesc,
    t1.samplingrequired,
    t1.legalrequired,
    t1.grcmaxamount,
    t1.connector,
    t40.dealername AS connectorcode,
    t40.dealercity AS connectordesc,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedratetenor,
    t1.fixedtenorrate,
    t12.branchtel AS finbranchcontact,
    t1.processattributes,
    t1.businessvertical,
    bv.code AS businessverticalcode,
    bv.description AS businessverticaldesc,
    t1.grcadvtype,
    t1.grcadvterms,
    t1.advtype,
    t1.advterms,
    t1.advstage,
    t1.tdspercentage,
    t1.tdsstartdate,
    t1.tdsenddate,
    t1.tdslimitamt,
    t1.vanreq,
    t1.vancode,
    t1.allowdrawingpower,
    t1.allowrevolving,
    t1.sanbsdschdle,
	t1.PromotionSeqID,
	t1.SvAmount,
	t1.CBAmount
   FROM financemain_temp t1
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
     LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
     LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
     LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
     LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
     LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
     LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
     LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
     LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical</createView>
	</changeSet>

	<changeSet id="64_pre" author="murthy.y" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="64" author="ADARSH">
		<createView replaceIfExists="true" viewName="financemain_view">SELECT t1.finreference,
    t1.investmentref,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgrossgrcpft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t1.recaltype,
    t1.finassetvalue,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.finisactive,
    t1.limitvalid,
    t1.overridelimit,
    t1.securitydeposit,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t7.fintypedesc AS lovdescfintypename,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t1.mindownpayperc,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t12.branchdesc AS lovdescfinbranchname,
    t12.branchprovince AS finbranchprovincecode,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.grcmargin,
    t1.repaymargin,
    t1.fincurrassetvalue,
    t1.fincommitmentref,
    t1.finlimitref,
    t1.depreciationfrq,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t17.acrtilllbd AS lovdescaccruedtilllbd,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.feechargeamt,
    t1.blacklisted,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.migratedfinance,
    t1.schedulemaintained,
    t1.scheduleregenerated,
    t1.finpurpose,
    t39.loanpurposedesc AS lovdescfinpurposename,
    t1.finstatus,
    t1.finstsreason,
    t1.initiateuser,
    t1.bankname,
    t1.iban,
    t1.accounttype,
    t1.ddareferenceno,
    t7.finscheduleon AS lovdescfinscheduleon,
    t1.custdsr,
    t1.jointaccount,
    t1.jointcustid,
    t1.downpaybank,
    t1.downpaysupl,
    t1.downpayaccount,
    t1.securitycollateral,
    t1.approved,
    t1.discrepancy,
    t1.limitapproved,
    t1.graceterms,
    t7.findivision AS lovdescfindivision,
    t1.rcdmaintainsts,
    t1.finrepaymethod,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t1.nextuserid,
    t1.priority,
    t24.policydesc AS lovdescsteppolicyname,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.deviationapproval,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.creditinsamt,
    t1.rolloverfrq,
    t1.nextrolloverdate,
    t27.custstsdescription,
    t1.shariastatus,
    t1.initiatedate,
    t1.finpreapprovedref,
    t1.mmaid,
    t1.accountsofficer,
    t1.feeaccountid,
    t1.fincancelac,
    t28.dealername AS lovdescaccountsofficer,
    t28.dealercity AS lovdescsourcecity,
    t1.dsacode,
    t30.rofficerdesc AS dsacodedesc,
    t1.tdsapplicable,
    t1.mandateid,
    t1.droplinefrq,
    t1.firstdroplinedate,
    t1.pftservicingodlimit,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.applicationno,
    t1.referralid,
    t33.rofficerdesc AS referraliddesc,
    t1.dmacode,
    t34.rofficerdesc AS dmacodedesc,
    t1.salesdepartment,
    t35.gendeptdesc AS salesdepartmentdesc,
    t1.quickdisb,
    t1.wifreference,
    t1.unplanemihlockperiod,
    t1.unplanemicpz,
    t1.reagecpz,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.promotioncode,
    t1.restructureloan,
    t1.oldfinreference,
    t1.reagebucket,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t36.entitycode AS lovdescentitycode,
    t1.eligibilitymethod,
    t38.fieldcodevalue AS loveligibilitymethod,
    t38.valuedesc AS lovdesceligibilitymethod,
    t1.employeename,
    t37.rofficerdesc AS employeenamedesc,
    t1.samplingrequired,
    t1.legalrequired,
    t1.grcmaxamount,
    t1.connector,
    t40.dealername AS connectorcode,
    t40.dealercity AS connectordesc,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedratetenor,
    t1.fixedtenorrate,
    t12.branchtel AS finbranchcontact,
    t1.processattributes,
    t1.businessvertical,
    bv.code AS businessverticalcode,
    bv.description AS businessverticaldesc,
    t1.grcadvtype,
    t1.grcadvterms,
    t1.advtype,
    t1.advterms,
    t1.advstage,
    t1.tdspercentage,
    t1.tdsstartdate,
    t1.tdsenddate,
    t1.tdslimitamt,
    t1.vanreq,
    t1.vancode,
    t1.allowdrawingpower,
    t1.allowrevolving,
    t1.sanbsdschdle,
	t1.PromotionSeqID,
	t1.SvAmount,
	t1.CBAmount
   FROM financemain_temp t1
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
     LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
     LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
     LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
     LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
     LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
     LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
     LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
     LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
UNION ALL
 SELECT t1.finreference,
    t1.investmentref,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgrossgrcpft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t1.recaltype,
    t1.finassetvalue,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.finisactive,
    t1.limitvalid,
    t1.overridelimit,
    t1.securitydeposit,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t7.fintypedesc AS lovdescfintypename,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t1.mindownpayperc,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t12.branchdesc AS lovdescfinbranchname,
    t12.branchprovince AS finbranchprovincecode,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.grcmargin,
    t1.repaymargin,
    t1.fincurrassetvalue,
    t1.fincommitmentref,
    t1.finlimitref,
    t1.depreciationfrq,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t17.acrtilllbd AS lovdescaccruedtilllbd,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.feechargeamt,
    t1.blacklisted,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.migratedfinance,
    t1.schedulemaintained,
    t1.scheduleregenerated,
    t1.finpurpose,
    t39.loanpurposedesc AS lovdescfinpurposename,
    t1.finstatus,
    t1.finstsreason,
    t1.initiateuser,
    t1.bankname,
    t1.iban,
    t1.accounttype,
    t1.ddareferenceno,
    t7.finscheduleon AS lovdescfinscheduleon,
    t1.custdsr,
    t1.jointaccount,
    t1.jointcustid,
    t1.downpaybank,
    t1.downpaysupl,
    t1.downpayaccount,
    t1.securitycollateral,
    t1.approved,
    t1.discrepancy,
    t1.limitapproved,
    t1.graceterms,
    t7.findivision AS lovdescfindivision,
    t1.rcdmaintainsts,
    t1.finrepaymethod,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t1.nextuserid,
    t1.priority,
    t24.policydesc AS lovdescsteppolicyname,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.deviationapproval,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.creditinsamt,
    t1.rolloverfrq,
    t1.nextrolloverdate,
    t27.custstsdescription,
    t1.shariastatus,
    t1.initiatedate,
    t1.finpreapprovedref,
    t1.mmaid,
    t1.accountsofficer,
    t1.feeaccountid,
    t1.fincancelac,
    t28.dealername AS lovdescaccountsofficer,
    t28.dealercity AS lovdescsourcecity,
    t1.dsacode,
    t30.rofficerdesc AS dsacodedesc,
    t1.tdsapplicable,
    t1.mandateid,
    t1.droplinefrq,
    t1.firstdroplinedate,
    t1.pftservicingodlimit,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.applicationno,
    t1.referralid,
    t33.rofficerdesc AS referraliddesc,
    t1.dmacode,
    t34.rofficerdesc AS dmacodedesc,
    t1.salesdepartment,
    t35.gendeptdesc AS salesdepartmentdesc,
    t1.quickdisb,
    t1.wifreference,
    t1.unplanemihlockperiod,
    t1.unplanemicpz,
    t1.reagecpz,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.promotioncode,
    t1.restructureloan,
    t1.oldfinreference,
    t1.reagebucket,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t36.entitycode AS lovdescentitycode,
    t1.eligibilitymethod,
    t38.fieldcodevalue AS loveligibilitymethod,
    t38.valuedesc AS lovdesceligibilitymethod,
    t1.employeename,
    t37.rofficerdesc AS employeenamedesc,
    t1.samplingrequired,
    t1.legalrequired,
    t1.grcmaxamount,
    t1.connector,
    t40.dealername AS connectorcode,
    t40.dealercity AS connectordesc,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedratetenor,
    t1.fixedtenorrate,
    t12.branchtel AS finbranchcontact,
    t1.processattributes,
    t1.businessvertical,
    bv.code AS businessverticalcode,
    bv.description AS businessverticaldesc,
    t1.grcadvtype,
    t1.grcadvterms,
    t1.advtype,
    t1.advterms,
    t1.advstage,
    t1.tdspercentage,
    t1.tdsstartdate,
    t1.tdsenddate,
    t1.tdslimitamt,
    t1.vanreq,
    t1.vancode,
    t1.allowdrawingpower,
    t1.allowrevolving,
    t1.sanbsdschdle,
	t1.PromotionSeqID,
	t1.SvAmount,
	t1.CBAmount
   FROM financemain t1
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
     LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
     LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
     LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
     LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
     LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
     LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
     LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
     LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
  WHERE NOT (EXISTS ( SELECT 1
           FROM financemain_temp
          WHERE financemain_temp.finreference = t1.finreference))</createView>
	</changeSet>

	<changeSet id="64_post" author="murthy.y" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="65" author="ADARSH">
		<createView replaceIfExists="true" viewName="legaldetails_view">
            SELECT t1.legalid,
    t1.legalreference,
    t1.loanreference,
    t1.collateralreference,
    t1.branch,
    t1.legaldate,
    t1.schedulelevelarea,
    t1.legaldecision,
    t1.legalremarks,
    t1.propertydetailmodt,
    t1.propertydetailecdate,
    t1.ecpropertyownername,
    t1.active,
    t1.module,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.branchdesc,
    t3.finbranch,
    t4.findivision
   FROM legaldetails_temp t1
     JOIN rmtbranches t2 ON t1.branch = t2.branchcode
     JOIN financemain_temp t3 ON t3.finreference = t1.loanreference
     JOIN rmtfinancetypes t4 ON t4.fintype = t3.fintype
UNION ALL
 SELECT t1.legalid,
    t1.legalreference,
    t1.loanreference,
    t1.collateralreference,
    t1.branch,
    t1.legaldate,
    t1.schedulelevelarea,
    t1.legaldecision,
    t1.legalremarks,
    t1.propertydetailmodt,
    t1.propertydetailecdate,
    t1.ecpropertyownername,
    t1.active,
    t1.module,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t2.branchdesc,
    t3.finbranch,
    t4.findivision
   FROM legaldetails t1
     JOIN rmtbranches t2 ON t1.branch = t2.branchcode
     JOIN financemain_view t3 ON t3.finreference = t1.loanreference
     JOIN rmtfinancetypes t4 ON t4.fintype = t3.fintype
  WHERE NOT (EXISTS ( SELECT 1
           FROM legaldetails_temp
          WHERE legaldetails_temp.legalid = t1.legalid))
          </createView>
	</changeSet>

	<changeSet id="66" author="ADARSH">
		<createView replaceIfExists="true" viewName="financemaintenance_aview">
    	SELECT t1.finreference,
    t1.finbranch,
    t1.fintype,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.finstartdate,
    t1.numberofterms,
    t1.custid,
    t1.finamount,
    t1.maturitydate,
    t1.finrepaymentamount,
    t1.finisactive,
    t1.blacklisted,
    t1.feechargeamt,
    t1.insuranceamt,
    t1.graceterms,
    t1.allowgrcperiod,
    t1.grcperiodenddate,
    t1.alwmultidisb,
    t1.defferments,
    t1.nextrolecode,
    t1.recordstatus,
    t1.recordtype,
    t1.allowgrcpftrvw,
    t1.allowrepayrvw,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.migratedfinance,
    t1.rcdmaintainsts,
    t1.closingstatus,
    t1.repayratebasis,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.nextrolloverdate,
    t1.downpayment,
    t1.planemihalw,
    t1.fincurrassetvalue,
    t1.finassetvalue,
    t2.custcif AS lovdesccustcif,
    t3.fincategory AS lovdescproductcodename,
    t3.finisalwdifferment AS lovdescfinalwdeferment,
    t4.productcategory,
    t1.samplingrequired,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis AS bpiratebasis,
    t1.sanbsdschdle,
	t1.PromotionSeqID,
	t1.SvAmount,
	t1.CBAmount 
   FROM financemain t1
     JOIN customers t2 ON t1.custid = t2.custid
     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
     </createView>
	</changeSet>

	<changeSet id="67" author="ADARSH" dbms="postgresql,oracle">
		<createView replaceIfExists="true" viewName="financemaintenance_view">
    	SELECT t1.finreference,
    t1.finbranch,
    t1.fintype,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.finstartdate,
    t1.numberofterms,
    t1.custid,
    t1.finamount,
    t1.maturitydate,
    t1.finrepaymentamount,
    t1.finisactive,
    t1.blacklisted,
    t1.feechargeamt,
    t1.insuranceamt,
    t1.graceterms,
    t1.allowgrcperiod,
    t1.grcperiodenddate,
    t1.alwmultidisb,
    t1.defferments,
    t1.nextrolecode,
    t1.recordstatus,
    t1.recordtype,
    t1.allowgrcpftrvw,
    t1.allowrepayrvw,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.rcdmaintainsts,
    t1.migratedfinance,
    t1.closingstatus,
    t1.repayratebasis,
    t1.manualschedule,
    t1.fincurrassetvalue,
    t1.takeoverfinance,
    t1.nextrolloverdate,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.downpayment,
    t1.planemihalw,
    t1.calterms,
    t1.ratechganyday,
    t1.finassetvalue,
    t2.custcif AS lovdesccustcif,
    t3.finisalwdifferment AS lovdescfinalwdeferment,
    t3.findivision AS lovdescfindivision,
    t3.fincategory AS lovdescproductcodename,
    t4.productcategory,
    COALESCE(t5.roledesc, fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
    COALESCE(t9.noinst, 0) AS noinst,
    t1.samplingrequired,
    t1.advemiterms,
    t1.sanbsdschdle,
	t1.PromotionSeqID,
	t1.SvAmount,
	t1.CBAmount
   FROM financemain_temp t1
     JOIN customers t2 ON t1.custid = t2.custid
     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
     LEFT JOIN finpftdetails t9 ON t1.finreference = t9.finreference
UNION ALL
 SELECT t1.finreference,
    t1.finbranch,
    t1.fintype,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.finstartdate,
    t1.numberofterms,
    t1.custid,
    t1.finamount,
    t1.maturitydate,
    t1.finrepaymentamount,
    t1.finisactive,
    t1.blacklisted,
    t1.feechargeamt,
    t1.insuranceamt,
    t1.graceterms,
    t1.allowgrcperiod,
    t1.grcperiodenddate,
    t1.alwmultidisb,
    t1.defferments,
    t1.nextrolecode,
    t1.recordstatus,
    t1.recordtype,
    t1.allowgrcpftrvw,
    t1.allowrepayrvw,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.rcdmaintainsts,
    t1.migratedfinance,
    t1.closingstatus,
    t1.repayratebasis,
    t1.manualschedule,
    t1.fincurrassetvalue,
    t1.takeoverfinance,
    t1.nextrolloverdate,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.downpayment,
    t1.planemihalw,
    t1.calterms,
    t1.ratechganyday,
    t1.finassetvalue,
    t2.custcif AS lovdesccustcif,
    t3.finisalwdifferment AS lovdescfinalwdeferment,
    t3.findivision AS lovdescfindivision,
    t3.fincategory AS lovdescproductcodename,
    t4.productcategory,
    COALESCE(t5.roledesc, fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
    COALESCE(t9.noinst, 0) AS noinst,
    t1.samplingrequired,
    t1.advemiterms,
    t1.sanbsdschdle,
	t1.PromotionSeqID,
	t1.SvAmount,
	t1.CBAmount
   FROM financemain t1
     JOIN customers t2 ON t1.custid = t2.custid
     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
     LEFT JOIN finpftdetails t9 ON t1.finreference = t9.finreference
  WHERE NOT (EXISTS ( SELECT 1 AS expr1
           FROM financemain_temp
          WHERE financemain_temp.finreference = t1.finreference))
         </createView>
	</changeSet>

	<changeSet id="67" author="ADARSH" dbms="mssql">
		<createView replaceIfExists="true" viewName="financemaintenance_view">
    	SELECT t1.finreference,
    t1.finbranch,
    t1.fintype,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.finstartdate,
    t1.numberofterms,
    t1.custid,
    t1.finamount,
    t1.maturitydate,
    t1.finrepaymentamount,
    t1.finisactive,
    t1.blacklisted,
    t1.feechargeamt,
    t1.insuranceamt,
    t1.graceterms,
    t1.allowgrcperiod,
    t1.grcperiodenddate,
    t1.alwmultidisb,
    t1.defferments,
    t1.nextrolecode,
    t1.recordstatus,
    t1.recordtype,
    t1.allowgrcpftrvw,
    t1.allowrepayrvw,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.rcdmaintainsts,
    t1.migratedfinance,
    t1.closingstatus,
    t1.repayratebasis,
    t1.manualschedule,
    t1.fincurrassetvalue,
    t1.takeoverfinance,
    t1.nextrolloverdate,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.downpayment,
    t1.planemihalw,
    t1.calterms,
    t1.ratechganyday,
    t1.finassetvalue,
    t2.custcif AS lovdesccustcif,
    t3.finisalwdifferment AS lovdescfinalwdeferment,
    t3.findivision AS lovdescfindivision,
    t3.fincategory AS lovdescproductcodename,
    t4.productcategory,
    COALESCE(t5.roledesc, dbo.fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
    COALESCE(t9.noinst, 0) AS noinst,
    t1.samplingrequired,
    t1.advemiterms,
    t1.sanbsdschdle,
	t1.PromotionSeqID,
	t1.SvAmount,
	t1.CBAmount
   FROM financemain_temp t1
     JOIN customers t2 ON t1.custid = t2.custid
     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
     LEFT JOIN finpftdetails t9 ON t1.finreference = t9.finreference
UNION ALL
 SELECT t1.finreference,
    t1.finbranch,
    t1.fintype,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.finstartdate,
    t1.numberofterms,
    t1.custid,
    t1.finamount,
    t1.maturitydate,
    t1.finrepaymentamount,
    t1.finisactive,
    t1.blacklisted,
    t1.feechargeamt,
    t1.insuranceamt,
    t1.graceterms,
    t1.allowgrcperiod,
    t1.grcperiodenddate,
    t1.alwmultidisb,
    t1.defferments,
    t1.nextrolecode,
    t1.recordstatus,
    t1.recordtype,
    t1.allowgrcpftrvw,
    t1.allowrepayrvw,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.rcdmaintainsts,
    t1.migratedfinance,
    t1.closingstatus,
    t1.repayratebasis,
    t1.manualschedule,
    t1.fincurrassetvalue,
    t1.takeoverfinance,
    t1.nextrolloverdate,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.downpayment,
    t1.planemihalw,
    t1.calterms,
    t1.ratechganyday,
    t1.finassetvalue,
    t2.custcif AS lovdesccustcif,
    t3.finisalwdifferment AS lovdescfinalwdeferment,
    t3.findivision AS lovdescfindivision,
    t3.fincategory AS lovdescproductcodename,
    t4.productcategory,
    COALESCE(t5.roledesc, dbo.fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
    COALESCE(t9.noinst, 0) AS noinst,
    t1.samplingrequired,
    t1.advemiterms,
    t1.sanbsdschdle,
	t1.PromotionSeqID,
	t1.SvAmount,
	t1.CBAmount
   FROM financemain t1
     JOIN customers t2 ON t1.custid = t2.custid
     JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
     JOIN bmtproduct t4 ON t3.fincategory = t4.productcode
     LEFT JOIN finpftdetails t9 ON t1.finreference = t9.finreference
  WHERE NOT (EXISTS ( SELECT 1 AS expr1
           FROM financemain_temp
          WHERE financemain_temp.finreference = t1.finreference))
         </createView>
	</changeSet>

	<changeSet id="68" author="ADARSH">
		<createView replaceIfExists="true" viewName="financemain_dataview">
    	SELECT t1.finreference,
    	 t1.fintype,
  		 t2.custcif AS lovdesccustcif,
  		 t1.custid,
   		 t1.closingstatus,
  		 t1.finisactive,
   		 t1.maturitydate,
   		 t1.productCategory
  	 FROM financemain t1
    	JOIN customers t2 ON t1.custid = t2.custid
     	JOIN rmtfinancetypes t3 ON t3.fintype = t1.fintype
  		WHERE t1.closingstatus IS NULL OR t1.closingstatus != 'C'
  		</createView>
	</changeSet>

	<changeSet id="69" author="ADARSH">
		<dropPrimaryKey constraintName="pk_fintypefees"
			tableName="fintypefees" />
	</changeSet>

	<changeSet id="70_pre" author="ADARSH" dbms="mssql">
		<addNotNullConstraint tableName="fintypefees"
			columnName="fintype" columnDataType="varchar(8)" />
		<addNotNullConstraint tableName="fintypefees"
			columnName="originationfee" columnDataType="boolean" />
		<addNotNullConstraint tableName="fintypefees"
			columnName="finevent" columnDataType="varchar(8)" />
		<addNotNullConstraint tableName="fintypefees"
			columnName="feetypeid" columnDataType="bigint" />
		<addNotNullConstraint tableName="fintypefees"
			columnName="moduleid" columnDataType="int" />
		<addNotNullConstraint tableName="fintypefees"
			columnName="referenceid" columnDataType="bigint" />
	</changeSet>

	<changeSet id="70" author="ADARSH">
		<addPrimaryKey
			columnNames="fintype, originationfee, finevent, feetypeid, moduleid, referenceid"
			constraintName="pk_fintypefees" tableName="fintypefees" />
	</changeSet>

	<changeSet id="71" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS">
			<column name="GAPINTAMZ" type="decimal(18,0)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="72" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS">
			<column name="GAPINTAMZLBD" type="decimal(18,0)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="73" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS">
			<column name="PRVMTHGAPINTAMZ" type="decimal(18,0)"
				defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="74" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS">
			<column name="SVAMOUNT" type="decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="75" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS">
			<column name="CBAmount" type="decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="76" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS_SNAPSHOT">
			<column name="GAPINTAMZ" type="decimal(18,0)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="77" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS_SNAPSHOT">
			<column name="GAPINTAMZLBD" type="decimal(18,0)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="78" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS_SNAPSHOT">
			<column name="PRVMTHGAPINTAMZ" type="decimal(18,0)"
				defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="79" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS_SNAPSHOT">
			<column name="SVAMOUNT" type="decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="80" author="ADARSH">
		<addColumn tableName="FINPFTDETAILS_SNAPSHOT">
			<column name="CBAmount" type="decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="81" author="ADARSH">
		<sql>
		<![CDATA[
		UPDATE FINPFTDETAILS SET GapIntAmz=0, GapIntAmzLbd=0, PrvMthGapIntAmz = 0;
	    UPDATE FINPFTDETAILS_SNAPSHOT SET GapIntAmz=0, GapIntAmzLbd=0, PrvMthGapIntAmz =0;
		]]>
		</sql>
	</changeSet>

	<changeSet id="82" author="ADARSH">
		<sql>
		<![CDATA[
		INSERT INTO bmtamountcodes(allowedevent, allowedria, amountcode, amountcodedesc, amountcodeisactive, version, lastmntby, lastmnton, recordstatus, rolecode, nextrolecode, taskid, nexttaskid, recordtype, workflowid) VALUES ('AMZ', 0, 'ae_dGapAmz', 'Gap Interest from Last Posting to Today', 1, 1, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);
		INSERT INTO bmtamountcodes(allowedevent, allowedria, amountcode, amountcodedesc, amountcodeisactive, version, lastmntby, lastmnton, recordstatus, rolecode, nextrolecode, taskid, nexttaskid, recordtype, workflowid) VALUES ('ADDDBSP', 0, 'ae_svAmount', 'Subvention Amount', 1, 1, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);
		INSERT INTO bmtamountcodes(allowedevent, allowedria, amountcode, amountcodedesc, amountcodeisactive, version, lastmntby, lastmnton, recordstatus, rolecode, nextrolecode, taskid, nexttaskid, recordtype, workflowid) VALUES ('ADDDBSP', 0, 'ae_cbAmount', 'Cash Back Amount', 1, 1, 1000, current_timestamp, 'Approved', null, null, null, null, null, 0);
 		]]>
		</sql>
	</changeSet>

	<changeSet id="83" author="satyanarayana.g" dbms="postgresql,oracle">
		<createView viewName="FINANCEMAIN_LVIEW" replaceIfExists="true">
			SELECT T1.FINREFERENCE,
				  T1.INVESTMENTREF,
				  T1.FINTYPE,
				  T1.FINCCY,
				  T1.FINAMOUNT,
				  T1.DOWNPAYMENT,
				  T1.FEECHARGEAMT,
				  T1.SCHEDULEMETHOD,
				  T1.NUMBEROFTERMS,
				  T1.RECORDSTATUS,
				  T1.RECORDTYPE,
				  T1.ROLECODE,
				  T1.NEXTROLECODE,
				  T1.FINBRANCH,
				  T1.FINCONTRACTDATE,
				  T1.LINKEDFINREF,
				  T1.NEXTUSERID,
				  T1.PRIORITY,
				  T1.WORKFLOWID,
				  T1.TASKID,
				  T1.NEXTTASKID,
				  T1.FINPREAPPROVEDREF,
				  T1.RCDMAINTAINSTS,
				  T1.INSURANCEAMT,
				  T1.FINCURRASSETVALUE,
				  T1.CALTERMS,
				  T1.DEVIATIONAPPROVAL,
				  T1.FINPURPOSE,
				  T1.INITIATEDATE,
				  T1.FINASSETVALUE,
				  T2.CUSTCIF        LOVDESCCUSTCIF,
				  T2.CUSTSHRTNAME   LOVDESCCUSTSHRTNAME,
				  T2.CUSTPASSPORTNO  LOVDESCCUSTPASSPORTNO,
				  T2.CUSTDOB         LOVDESCCUSTDOB,
				  T2.CUSTCRCPR       LOVDESCCUSTCRCPR,
				  T2.PHONENUMBER,
				  T3.FINCATEGORY  LOVDESCPRODUCTCODENAME,
				  T3.FINDIVISION  LOVDESCFINDIVISION,
				  T3.PRODUCT      LOVDESCFINPRODUCT,
				  T3.FINTYPEDESC  LOVDESCFINTYPENAME,
				  T1.PRODUCTCATEGORY,
				  COALESCE(T4.ROLEDESC, FN_GET_ROLEDESC(T1.NEXTROLECODE))  LOVDESCREQUESTSTAGE,
				  T1.SAMPLINGREQUIRED,
				  T1.ADVANCEEMI,
				  T1.ADVEMITERMS,
				  T1.BPIPFTDAYSBASIS,
				  T1.GRACETERMS
				FROM FINANCEMAIN_TEMP T1
				JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
				JOIN RMTFINANCETYPES T3 ON T3.FINTYPE = T1.FINTYPE
				LEFT JOIN SECROLES T4 ON T1.NEXTROLECODE = T4.ROLECD
	</createView>
	</changeSet>

	<changeSet id="83" author="satyanarayana.g" dbms="mssql">
		<createView viewName="FINANCEMAIN_LVIEW" replaceIfExists="true">
			SELECT T1.FINREFERENCE,
				  T1.INVESTMENTREF,
				  T1.FINTYPE,
				  T1.FINCCY,
				  T1.FINAMOUNT,
				  T1.DOWNPAYMENT,
				  T1.FEECHARGEAMT,
				  T1.SCHEDULEMETHOD,
				  T1.NUMBEROFTERMS,
				  T1.RECORDSTATUS,
				  T1.RECORDTYPE,
				  T1.ROLECODE,
				  T1.NEXTROLECODE,
				  T1.FINBRANCH,
				  T1.FINCONTRACTDATE,
				  T1.LINKEDFINREF,
				  T1.NEXTUSERID,
				  T1.PRIORITY,
				  T1.WORKFLOWID,
				  T1.TASKID,
				  T1.NEXTTASKID,
				  T1.FINPREAPPROVEDREF,
				  T1.RCDMAINTAINSTS,
				  T1.INSURANCEAMT,
				  T1.FINCURRASSETVALUE,
				  T1.CALTERMS,
				  T1.DEVIATIONAPPROVAL,
				  T1.FINPURPOSE,
				  T1.INITIATEDATE,
				  T1.FINASSETVALUE,
				  T2.CUSTCIF        LOVDESCCUSTCIF,
				  T2.CUSTSHRTNAME   LOVDESCCUSTSHRTNAME,
				  T2.CUSTPASSPORTNO  LOVDESCCUSTPASSPORTNO,
				  T2.CUSTDOB         LOVDESCCUSTDOB,
				  T2.CUSTCRCPR       LOVDESCCUSTCRCPR,
				  T2.PHONENUMBER,
				  T3.FINCATEGORY  LOVDESCPRODUCTCODENAME,
				  T3.FINDIVISION  LOVDESCFINDIVISION,
				  T3.PRODUCT      LOVDESCFINPRODUCT,
				  T3.FINTYPEDESC  LOVDESCFINTYPENAME,
				  T1.PRODUCTCATEGORY,
				  COALESCE(T4.ROLEDESC, dbo.FN_GET_ROLEDESC(T1.NEXTROLECODE))  LOVDESCREQUESTSTAGE,
				  T1.SAMPLINGREQUIRED,
				  T1.ADVANCEEMI,
				  T1.ADVEMITERMS,
				  T1.BPIPFTDAYSBASIS,
				  T1.GRACETERMS
				FROM FINANCEMAIN_TEMP T1
				JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
				JOIN RMTFINANCETYPES T3 ON T3.FINTYPE = T1.FINTYPE
				LEFT JOIN SECROLES T4 ON T1.NEXTROLECODE = T4.ROLECD
	</createView>
	</changeSet>

	<changeSet id="84" author="satyanarayana.g">
		<createView viewName="FINANCEENQUIRY_VIEW" replaceIfExists="true">
			SELECT T1.FINREFERENCE,
				  T1.FINBRANCH,
				  T1.FINTYPE,
				  T1.FINCCY,
				  T1.SCHEDULEMETHOD,
				  T1.PROFITDAYSBASIS,
				  T1.FINSTARTDATE,
				  T1.CALTERMS NUMBEROFTERMS,
				  T1.CUSTID,
				  T1.FINAMOUNT,
				  T1.GRCPERIODENDDATE,
				  T1.MATURITYDATE,
				  T1.FINREPAYMENTAMOUNT,
				  T1.FINISACTIVE,
				  T1.ALLOWGRCPERIOD,
				  T1.DOWNPAYMENT,
				  T1.MIGRATEDFINANCE,
				  T1.LASTREPAYDATE,
				  T1.LASTREPAYPFTDATE,
				  T1.FINCURRASSETVALUE,
				  T1.BLACKLISTED,
				  T1.FEECHARGEAMT,
				  T1.CLOSINGSTATUS,
				  T1.GRACETERMS,
				  T1.ALWMULTIDISB,
				  T1.DEFFERMENTS,
				  T1.FINSTATUS ,
				  T1.MANDATEID,
				  T1.FINREPAYMETHOD,
				  T1.FINASSETVALUE,
				  T1.INSURANCEAMT,
				  T1.SANBSDSCHDLE,
				  T1.PROMOTIONSEQID,
				  T1.SVAMOUNT,
				  T1.CBAMOUNT,
				  (T1.FINCURRASSETVALUE+ T1.FEECHARGEAMT+T1.INSURANCEAMT) FINANCINGAMOUNT,
				  (T1.FINCURRASSETVALUE- T1.FINREPAYMENTAMOUNT+ T1.FEECHARGEAMT+T1.INSURANCEAMT) CURFINAMOUNT,
				  T2.FINTYPEDESC LOVDESCFINTYPENAME,
				  T2.FINSCHEDULEON LOVDESCFINSCHEDULEON,
				  T2.FINDIVISION LOVDESCFINDIVISION,
				  T2.FINCATEGORY LOVDESCPRODUCTCODENAME,
				  T2.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
				  T3.CUSTCIF LOVDESCCUSTCIF,
				  T3.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
				  T4.BRANCHDESC LOVDESCFINBRANCHNAME,
				  T5.CUSTTYPECTG,
				  COALESCE(T9.NOINST,0) NOINST FROM FINANCEMAIN T1
				INNER JOIN RMTFINANCETYPES T2 ON T1.FINTYPE = T2.FINTYPE
				INNER JOIN CUSTOMERS T3 ON T1.CUSTID = T3.CUSTID
				INNER JOIN RMTBRANCHES T4 ON T1.FINBRANCH = T4.BRANCHCODE
				INNER JOIN RMTCUSTTYPES T5 ON T3.CUSTTYPECODE = T5.CUSTTYPECODE
				LEFT JOIN FINPFTDETAILS T9 ON T1.FINREFERENCE = T9.FINREFERENCE
		</createView>
	</changeSet>

	<changeSet id="85" author="Siva">
		<sql>
			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM
			SECRIGHTS);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT
			MAX(GRPRIGHTID) FROM SECGROUPRIGHTS);

			UPDATE SECRIGHTS SET RIGHTNAME =
			'PromotionDialog_CashbackFromDealer' WHERE
			RIGHTNAME =
			'PromotionDialog_CashbackMonth';
			INSERT INTO SECRIGHTS
			SELECT (SELECT
			MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_CashbackToCustomer','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;
			INSERT INTO
			SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,
			'PromotionDialog_OpenBalOnPV','PromotionDialog',0,1000,CURRENT_TIMESTAMP,'
			',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0;

			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM
			SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE
			GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_CashbackToCustomer'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO
			SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),
			(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='CDSCHEME_MAKER') ,(SELECT
			RIGHTID FROM SECRIGHTS WHERE
			RIGHTNAME='PromotionDialog_OpenBalOnPV'), 1,
			0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);

			UPDATE
			SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			UPDATE
			SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM
			SECGROUPRIGHTS);
		</sql>
	</changeSet>

	<changeSet id="86" author="Siva">
		<dropTable tableName="SeqPromotions" />
	</changeSet>
	<changeSet id="87" author="Siva">
		<createSequence sequenceName="SeqPromotions"
			incrementBy="1" startValue="1" minValue="1" maxValue="999999999999999999" />
	</changeSet>

	<changeSet id="88" author="Siva">
		<createView viewName="lmtpromotionworkflowdef_aview"
			replaceIfExists="true">
			 SELECT t1.fintype,
			    t1.fintype AS typecode,
			    t4.fintypedesc AS lovdescfintypename,
			    NULL AS collateraldesc,
			    NULL AS vasproductdesc,
			    NULL AS commitmenttypedesc,
			    t1.fintype AS lovdescpromotioncode,
			    t2.promotiondesc AS lovdescpromotionname,
			    NULL AS lovdescfacilitytypename,
			    t1.screencode,
			    t1.workflowtype,
			    t3.workflowdesc AS lovdescworkflowtypename,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t3.workflowroles AS lovdescworkflowrolesname,
			    t4.fincategory AS lovdescproductcodename,
			    t4.findivision AS lovdescfindivisionname,
			    t3.firsttaskowner AS lovdescfirsttaskowner,
			    t1.modulename,
			    t2.active AS finisactive,
			    t5.productdesc AS lovdescproductname,
			    t4.fintypedesc AS lovdescpromofintypedesc,
			    t4.finassettype,
			    t2.startdate,
			    t2.enddate,
			    t1.finevent,
			    t5.productcategory,
				t2.ReferenceId
			   FROM lmtfinanceworkflowdef t1
			     LEFT JOIN promotions t2 ON t1.fintype = t2.promotioncode
			     JOIN workflowdetails t3 ON t1.workflowtype = t3.workflowtype AND t3.workflowactive = 1
			     JOIN rmtfinancetypes t4 ON t2.fintype = t4.fintype
			     JOIN bmtproduct t5 ON t4.fincategory = t5.productcode
		</createView>
	</changeSet>
	<changeSet id="89" author="Siva">
		<createView viewName="lmtpromotionworkflowdef_view"
			replaceIfExists="true">
			 SELECT t1.fintype,
			    t1.fintype AS typecode,
			    t4.fintypedesc AS lovdescfintypename,
			    NULL AS collateraldesc,
			    NULL AS vasproductdesc,
			    NULL AS commitmenttypedesc,
			    NULL AS lovdescfacilitytypename,
			    t1.screencode,
			    t1.workflowtype,
			    t3.workflowdesc AS lovdescworkflowtypename,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t3.workflowroles AS lovdescworkflowrolesname,
			    t4.fincategory AS lovdescproductcodename,
			    t3.firsttaskowner AS lovdescfirsttaskowner,
			    t1.modulename,
			    t2.active AS finisactive,
			    t2.fintype AS lovdescproductname,
			    t4.finassettype,
			    t1.finevent,
			    t5.productcategory,
				t2.ReferenceId
			   FROM lmtfinanceworkflowdef_temp t1
			     LEFT JOIN promotions t2 ON t1.fintype = t2.promotioncode
			     JOIN workflowdetails t3 ON t1.workflowtype = t3.workflowtype AND t3.workflowactive = 1
			     JOIN rmtfinancetypes t4 ON t2.fintype = t4.fintype
			     JOIN bmtproduct t5 ON t4.fincategory = t5.productcode
			UNION ALL
			 SELECT t1.fintype,
			    t1.fintype AS typecode,
			    t4.fintypedesc AS lovdescfintypename,
			    NULL AS collateraldesc,
			    NULL AS vasproductdesc,
			    NULL AS commitmenttypedesc,
			    NULL AS lovdescfacilitytypename,
			    t1.screencode,
			    t1.workflowtype,
			    t3.workflowdesc AS lovdescworkflowtypename,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t3.workflowroles AS lovdescworkflowrolesname,
			    t4.fincategory AS lovdescproductcodename,
			    t3.firsttaskowner AS lovdescfirsttaskowner,
			    t1.modulename,
			    t2.active AS finisactive,
			    t2.fintype AS lovdescproductname,
			    t4.finassettype,
			    t1.finevent,
			    t5.productcategory,
				t2.ReferenceId
			   FROM lmtfinanceworkflowdef t1
			     LEFT JOIN promotions t2 ON t1.fintype = t2.promotioncode
			     JOIN workflowdetails t3 ON t1.workflowtype = t3.workflowtype AND t3.workflowactive = 1
			     JOIN rmtfinancetypes t4 ON t2.fintype = t4.fintype
			     JOIN bmtproduct t5 ON t4.fincategory = t5.productcode
			  WHERE NOT (EXISTS ( SELECT 1 AS expr1
			           FROM lmtfinanceworkflowdef_temp W
			          WHERE W.fintype = t1.fintype AND W.finevent = t1.finevent AND W.modulename = t1.modulename))
		</createView>
	</changeSet>

	<changeSet id="90" author="Siva">
		<sql>

			DELETE FROM CategoryWiseEvents WHERE CategoryCode = 'C';

			INSERT
			INTO
			CategoryWiseEvents VALUES('ADDDBSP','C',1,1,1);
			INSERT INTO
			CategoryWiseEvents VALUES('DISBINS','C',1,1,2);
			INSERT INTO
			CategoryWiseEvents VALUES('AMZ','C',1,1,3);
			INSERT INTO
			CategoryWiseEvents VALUES('REPAY','C',1,1,4);
			INSERT INTO
			CategoryWiseEvents VALUES('LATEPAY','C',1,1,5);
			INSERT INTO
			CategoryWiseEvents VALUES('EARLYSTL','C',1,1,6);
			INSERT INTO
			CategoryWiseEvents VALUES('INSTDATE','C',1,1,7);
			INSERT INTO
			CategoryWiseEvents VALUES('WRITEOFF','C',1,0,8);
			INSERT INTO
			CategoryWiseEvents VALUES('WRITEBK','C',1,0,9);

		</sql>
	</changeSet>

	<changeSet id="91" author="shahbaj.b">
		<createView viewName="financeenquiry_view" replaceIfExists="true">
		
        SELECT t1.finreference,
        t1.finbranch,
        t1.fintype,
        t1.finccy,
        t1.schedulemethod,
        t1.profitdaysbasis,
        t1.finstartdate,
        t1.calterms AS numberofterms,
        t1.custid,
        t1.finamount,
        t1.grcperiodenddate,
        t1.maturitydate,t1.finrepaymentamount,
        t1.finisactive,
        t1.allowgrcperiod,
        t1.downpayment,
        t1.migratedfinance,
        t1.lastrepaydate,
        t1.lastrepaypftdate,
        t1.fincurrassetvalue,
        t1.blacklisted,
        t1.feechargeamt,
        t1.closingstatus,
        t1.graceterms,
        t1.alwmultidisb,
        t1.defferments,
        t1.finstatus,
        t1.mandateid,
        t1.finrepaymethod,
        t1.finassetvalue,
        t1.insuranceamt,
        t1.fincurrassetvalue + t1.feechargeamt + t1.insuranceamt AS financingamount,
        t1.fincurrassetvalue - t1.finrepaymentamount + t1.feechargeamt + t1.insuranceamt AS curfinamount,
        t2.fintypedesc AS lovdescfintypename,
        t2.finscheduleon AS lovdescfinscheduleon,
        t2.findivision AS lovdescfindivision,
        t2.fincategory AS lovdescproductcodename,
        t2.finisalwdifferment AS lovdescfinalwdeferment,
        t3.custcif AS lovdesccustcif,
        t3.custshrtname AS lovdesccustshrtname,
        t4.branchdesc AS lovdescfinbranchname,
        t5.custtypectg,
        COALESCE(t9.noinst, 0) AS noinst, 
	    t1.svAmount
        FROM financemain t1
        JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
        JOIN customers t3 ON t1.custid = t3.custid
        JOIN rmtbranches t4 ON t1.finbranch = t4.branchcode
        JOIN rmtcusttypes t5 ON t3.custtypecode = t5.custtypecode
        LEFT JOIN finpftdetails t9 ON t1.finreference = t9.finreference
		</createView>
	</changeSet>
	<changeSet id="92" author="shahbaj.b" dbms="postgresql,oracle">
		<createView viewName="financemain_lview" replaceIfExists="true">
	SELECT t1.finreference,
    t1.investmentref,
    t1.fintype,
    t1.finccy,
    t1.finamount,
    t1.downpayment,
    t1.feechargeamt,
    t1.schedulemethod,
    t1.numberofterms,
    t1.recordstatus,
    t1.recordtype,
    t1.rolecode,
    t1.nextrolecode,
    t1.finbranch,
    t1.fincontractdate,
    t1.linkedfinref,
    t1.nextuserid,
    t1.priority,
    t1.workflowid,
    t1.taskid,
    t1.nexttaskid,
    t1.finpreapprovedref,
    t1.rcdmaintainsts,
    t1.insuranceamt,
    t1.fincurrassetvalue,
    t1.calterms,
    t1.deviationapproval,
    t1.finpurpose,
    t1.initiatedate,
    t1.finassetvalue,
    t2.custcif AS lovdesccustcif,
    t2.custshrtname AS lovdesccustshrtname,
    t2.custpassportno AS lovdesccustpassportno,
    t2.custdob AS lovdesccustdob,
    t2.custcrcpr AS lovdesccustcrcpr,
    t2.phonenumber,
    t3.fincategory AS lovdescproductcodename,
    t3.findivision AS lovdescfindivision,
    t3.product AS lovdescfinproduct,
    t3.fintypedesc AS lovdescfintypename,
    COALESCE(t4.roledesc, fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
    t1.samplingrequired,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.graceterms,
	t1.ProductCategory
   FROM financemain_temp t1
     JOIN customers t2 ON t1.custid = t2.custid
     JOIN rmtfinancetypes t3 ON t3.fintype = t1.fintype
     LEFT JOIN secroles t4 ON t1.nextrolecode = t4.rolecd
	</createView>
	</changeSet>

	<changeSet id="92" author="shahbaj.b" dbms="mssql">
		<createView viewName="financemain_lview" replaceIfExists="true">
	SELECT t1.finreference,
    t1.investmentref,
    t1.fintype,
    t1.finccy,
    t1.finamount,
    t1.downpayment,
    t1.feechargeamt,
    t1.schedulemethod,
    t1.numberofterms,
    t1.recordstatus,
    t1.recordtype,
    t1.rolecode,
    t1.nextrolecode,
    t1.finbranch,
    t1.fincontractdate,
    t1.linkedfinref,
    t1.nextuserid,
    t1.priority,
    t1.workflowid,
    t1.taskid,
    t1.nexttaskid,
    t1.finpreapprovedref,
    t1.rcdmaintainsts,
    t1.insuranceamt,
    t1.fincurrassetvalue,
    t1.calterms,
    t1.deviationapproval,
    t1.finpurpose,
    t1.initiatedate,
    t1.finassetvalue,
    t2.custcif AS lovdesccustcif,
    t2.custshrtname AS lovdesccustshrtname,
    t2.custpassportno AS lovdesccustpassportno,
    t2.custdob AS lovdesccustdob,
    t2.custcrcpr AS lovdesccustcrcpr,
    t2.phonenumber,
    t3.fincategory AS lovdescproductcodename,
    t3.findivision AS lovdescfindivision,
    t3.product AS lovdescfinproduct,
    t3.fintypedesc AS lovdescfintypename,
    COALESCE(t4.roledesc, dbo.fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
    t1.samplingrequired,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.graceterms,
	t1.ProductCategory
   FROM financemain_temp t1
     JOIN customers t2 ON t1.custid = t2.custid
     JOIN rmtfinancetypes t3 ON t3.fintype = t1.fintype
     LEFT JOIN secroles t4 ON t1.nextrolecode = t4.rolecd
	</createView>
	</changeSet>

	<changeSet id="93" author="meena.a">
		<comment>extra fields added in Limitdetails</comment>
		<addColumn tableName="Limitdetails">
			<column name="ExternalRef1" type="varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="94" author="meena.a">
		<comment>extra fields added in Limitdetails</comment>
		<addColumn tableName="Limitdetails_temp">
			<column name="ExternalRef1" type="varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="95" author="meena.a">
		<createView viewName="LIMITDETAILS_VIEW" replaceIfExists="true">
			SELECT T1.DETAILID,
					T1.LIMITHEADERID,
					T1.LIMITSTRUCTUREDETAILSID,
					T5.GROUPCODE,
					T3.GROUPNAME,
					T5.LIMITLINE,
					T4.RULECODEDESC LIMITLINEDESC,
					COALESCE(T1.REVOLVING,0)REVOLVING,
					COALESCE(T4.REVOLVING,0) LIMITSTRUCTUREREVOLVING ,
					T1.EXPIRYDATE,
					T1.LIMITSANCTIONED,
					T1.RESERVEDLIMIT,
					T1.UTILISEDLIMIT,
					T1.LIMITCHECK,
					T1.LIMITCHKMETHOD,
					T5.ITEMSEQ,
					T5.ITEMPRIORITY,
					T5.ITEMLEVEL,
					T5.EDITABLE,
					T5.DISPLAYSTYLE,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T2.USRLOGIN,
					T2.USRFNAME,
					T2.USRMNAME,
					T2.USRLNAME,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.NONRVLUTILISED,
					T1.BANKINGARRANGEMENT,
					T1.LIMITCONDITION,
					T1.EXTERNALREF,
					T1.TENOR,
					T1.EXTERNALREF1
					FROM LIMITDETAILS_TEMP T1
					INNER JOIN SECUSERS T2 ON T1.LASTMNTBY = T2.USRID
					INNER JOIN LIMITSTRUCTUREDETAILS T5 ON T1.LIMITSTRUCTUREDETAILSID = T5.LIMITSTRUCTUREDETAILSID
					LEFT OUTER JOIN LIMITGROUP T3 ON T5.GROUPCODE = T3.GROUPCODE
					LEFT OUTER JOIN RULES T4 ON T5.LIMITLINE = T4.RULECODE
					AND RULEMODULE  ='LMTLINE'
					UNION ALL
					SELECT T1.DETAILID,
					T1.LIMITHEADERID,
					T1.LIMITSTRUCTUREDETAILSID,
					T5.GROUPCODE,
					T3.GROUPNAME,
					T5.LIMITLINE,
					T4.RULECODEDESC LIMITLINEDESC,
					COALESCE(T1.REVOLVING,0)REVOLVING,
					COALESCE(T4.REVOLVING,0) LIMITSTRUCTUREREVOLVING,
					T1.EXPIRYDATE,
					T1.LIMITSANCTIONED,
					T1.RESERVEDLIMIT,
					T1.UTILISEDLIMIT,
					T1.LIMITCHECK,
					T1.LIMITCHKMETHOD,
					T5.ITEMSEQ,
					T5.ITEMPRIORITY,
					T5.ITEMLEVEL,
					T5.EDITABLE,
					T5.DISPLAYSTYLE,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T2.USRLOGIN,
					T2.USRFNAME,
					T2.USRMNAME,
					T2.USRLNAME,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.NONRVLUTILISED,
					T1.BANKINGARRANGEMENT,
					T1.LIMITCONDITION,
					T1.EXTERNALREF,
					T1.TENOR,
					T1.EXTERNALREF1
					FROM LIMITDETAILS T1
					INNER JOIN SECUSERS T2 ON T1.LASTMNTBY = T2.USRID
					INNER JOIN LIMITSTRUCTUREDETAILS T5 ON T1.LIMITSTRUCTUREDETAILSID = T5.LIMITSTRUCTUREDETAILSID
					LEFT OUTER JOIN LIMITGROUP T3 ON T5.GROUPCODE = T3.GROUPCODE
					LEFT OUTER JOIN RULES T4 ON T5.LIMITLINE = T4.RULECODE AND RULEMODULE  ='LMTLINE'
					WHERE NOT EXISTS (SELECT 1 FROM LIMITDETAILS_TEMP WHERE DETAILID = T1.DETAILID)
		</createView>
	</changeSet>

	<changeSet id="96_pre" author="murthy.y" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'limitdetails_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="96" author="meena.a">
		<createView viewName="LIMITDETAILS_AVIEW" replaceIfExists="true">
			SELECT T1.DETAILID,
					T1.LIMITHEADERID,
					T1.LIMITSTRUCTUREDETAILSID,
					T5.GROUPCODE,
					T3.GROUPNAME,
					T5.LIMITLINE,
					T4.RULECODEDESC LIMITLINEDESC,
					COALESCE(T1.REVOLVING,0)REVOLVING,
					COALESCE(T4.REVOLVING,0) LIMITSTRUCTUREREVOLVING,
					T1.EXPIRYDATE,
					T1.LIMITSANCTIONED,
					T1.RESERVEDLIMIT,
					T1.UTILISEDLIMIT,
					T1.LIMITCHECK,
					T1.LIMITCHKMETHOD,
					T5.ITEMSEQ,
					T5.ITEMPRIORITY,
					T5.ITEMLEVEL,
					T5.EDITABLE,
					T5.DISPLAYSTYLE,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T2.USRLOGIN,
					T2.USRFNAME,
					T2.USRMNAME,
					T2.USRLNAME,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.NONRVLUTILISED,
					T1.BANKINGARRANGEMENT,
					T1.LIMITCONDITION,
					T1.EXTERNALREF,
					T1.TENOR,
					T1.EXTERNALREF1
					FROM LIMITDETAILS T1
					INNER JOIN SECUSERS T2 ON T1.LASTMNTBY = T2.USRID
					INNER JOIN LIMITSTRUCTUREDETAILS T5 ON T1.LIMITSTRUCTUREDETAILSID = T5.LIMITSTRUCTUREDETAILSID
					LEFT OUTER JOIN LIMITGROUP T3 ON T5.GROUPCODE = T3.GROUPCODE
					LEFT OUTER JOIN RULES T4 ON T5.LIMITLINE = T4.RULECODE AND RULEMODULE  ='LMTLINE'
		</createView>
	</changeSet>

	<changeSet id="96_post" author="murthy.y" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'limitdetails_aview');
				
			]]>
		</sql>
	</changeSet>

	<changeSet id="97" author="meena.a">
		<createView viewName="LIMITDETAILS_TVIEW" replaceIfExists="true">
			SELECT T1.DETAILID,
					T1.LIMITHEADERID,
					T1.LIMITSTRUCTUREDETAILSID,
					T5.GROUPCODE,
					T3.GROUPNAME,
					T5.LIMITLINE,
					T4.RULECODEDESC LIMITLINEDESC,
					COALESCE(T1.REVOLVING,0)REVOLVING,
					COALESCE(T4.REVOLVING,0) LIMITSTRUCTUREREVOLVING,
					T1.EXPIRYDATE,
					T1.LIMITSANCTIONED,
					T1.RESERVEDLIMIT,
					T1.UTILISEDLIMIT,
					T1.LIMITCHECK,
					T1.LIMITCHKMETHOD,
					T5.ITEMSEQ,
					T5.ITEMPRIORITY,
					T5.ITEMLEVEL,
					T5.EDITABLE,
					T5.DISPLAYSTYLE,
					T1.VERSION,
					T1.CREATEDBY,
					T1.CREATEDON,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T2.USRLOGIN,
					T2.USRFNAME,
					T2.USRMNAME,
					T2.USRLNAME,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T1.NONRVLUTILISED,
					T1.BANKINGARRANGEMENT,
					T1.LIMITCONDITION,
					T1.EXTERNALREF,
					T1.TENOR,
					T1.EXTERNALREF1
					FROM LIMITDETAILS_TEMP T1
					INNER JOIN SECUSERS T2 ON T1.LASTMNTBY = T2.USRID
					INNER JOIN LIMITSTRUCTUREDETAILS T5 ON T1.LIMITSTRUCTUREDETAILSID = T5.LIMITSTRUCTUREDETAILSID
					LEFT OUTER JOIN LIMITGROUP T3 ON T5.GROUPCODE = T3.GROUPCODE
					LEFT OUTER JOIN RULES T4 ON T5.LIMITLINE = T4.RULECODE
					AND RULEMODULE  ='LMTLINE'
		</createView>
	</changeSet>

	<changeSet id="98" author="Siva">
		<comment>New columns added for CD Schemes in Promotion</comment>
		<addColumn tableName="Promotions">
			<column name="specialScheme" type="smallint" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="99" author="Siva">
		<comment>New columns added for CD Schemes in Promotion</comment>
		<addColumn tableName="Promotions">
			<column name="remarks" type="varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="100" author="Siva">
		<comment>New columns added for CD Schemes in Promotion</comment>
		<addColumn tableName="Promotions_Temp">
			<column name="specialScheme" type="smallint" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="101" author="Siva">
		<comment>New columns added for CD Schemes in Promotion</comment>
		<addColumn tableName="Promotions_Temp">
			<column name="remarks" type="varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="102" author="Siva">
		<createView viewName="Promotions_AView" replaceIfExists="true">
			SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionRate,
			    t1.TaxApplicable, t1.cashBackFromDealer, t1.cashBackToCustomer, t2.ProductCategory, t1.specialScheme,t1.remarks
			   FROM promotions t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
		</createView>
	</changeSet>

	<changeSet id="103" author="Siva">
		<createView viewName="Promotions_TView" replaceIfExists="true">
			SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionRate,
			    t1.TaxApplicable, t1.cashBackFromDealer, t1.cashBackToCustomer, t2.ProductCategory,t1.specialScheme,t1.remarks
			   FROM promotions_temp t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
		</createView>
	</changeSet>

	<changeSet id="104" author="Siva">
		<createView viewName="Promotions_View" replaceIfExists="true">
			SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionRate,
			    t1.TaxApplicable, t1.cashBackFromDealer, t1.cashBackToCustomer, t2.ProductCategory,t1.specialScheme,t1.remarks
			   FROM promotions_temp t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
			UNION ALL
			 SELECT t1.promotionid,
			    t1.promotioncode,
			    t1.promotiondesc,
			    t1.fintype,
			    t1.startdate,
			    t1.enddate,
			    t1.finisdwpayrequired,
			    t1.downpayrule,
			    t1.actualinterestrate,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finmargin,
			    t1.applyrpypricing,
			    t1.rpypricingmethod,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.finminamount,
			    t1.finmaxamount,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.active,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.finccy,
			    t2.fincategory,
			    t2.fintypedesc,
			    t3.rulecode AS downpayrulecode,
			    t3.rulecodedesc AS downpayruledesc,
			    t4.rulecode AS rpypricingcode,
			    t4.rulecodedesc AS rpypricingdesc,
			    t1.ReferenceID, t1.OpenBalOnPV, t1.Tenor, t1.AdvEMITerms, t1.PftDaysBasis, t1.SubventionRate,
			    t1.TaxApplicable, t1.cashBackFromDealer, t1.cashBackToCustomer, t2.ProductCategory,t1.specialScheme,t1.remarks
			   FROM promotions t1
			     JOIN rmtfinancetypes t2 ON t1.fintype = t2.fintype
			     LEFT JOIN rules t3 ON t1.downpayrule = t3.ruleid
			     LEFT JOIN rules t4 ON t1.rpypricingmethod = t4.ruleid
			  WHERE NOT (EXISTS ( SELECT 1
			           FROM promotions_temp
			          WHERE promotions_temp.promotioncode = t1.promotioncode AND promotions_temp.promotionid = t1.promotionid))
		</createView>
	</changeSet>

	<changeSet id="105" author="Durgaprasad G">
		<sql>
			<![CDATA[
				Delete from SMTParameters where SysParmCode = 'ALLOW_BACK_DATED_ADD_RATE_CHANGE';
				INSERT INTO SMTparameters  VALUES ('ALLOW_BACK_DATED_ADD_RATE_CHANGE', 'Allow back dated add rate chnage.', 'String', '1', 'N', 1, 0, NULL, NULL, 'Allow back dated add rate chnage.', 1, 1000, CURRENT_TIMESTAMP,'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="106" author="Srikanth">
		<sql>
			<![CDATA[
				Delete from SMTParameters where SysParmCode = 'DISB_PARTNERBANK';
				INSERT INTO smtparameters(sysparmcode, sysparmdesc, sysparmtype, sysparmmaint, sysparmvalue, sysparmlength, sysparmdec, sysparmlist, sysparmvaldmod, sysparmdescription, version, lastmntby, lastmnton, recordstatus, rolecode, nextrolecode, taskid, nexttaskid, recordtype, workflowid)
	            VALUES ('DISB_PARTNERBANK', 'Disb PartnerBank Id', 'long', 1, '68', 30, 0,NULL,NULL, 'Disb PartnerBank Id', '1', '1000', Current_TimeStamp, 'Approved',NULL,NULL,NULL,NULL,NULL,'0');
			]]>
		</sql>
	</changeSet>

	<changeSet id="107" author="satyanarayana.g">
		<sql>
			<![CDATA[
				DELETE FROM SMTPARAMETERS WHERE SYSPARMCODE='BR_INRST_RVW_FRQ_FRQDAYVAL_REQ';
			]]>
		</sql>
	</changeSet>

	<changeSet id="108" author="Srikanth" dbms="postgresql">
		<createView viewName="LMTFinanceWorkFlowDef_View"
			replaceIfExists="true">
		SELECT   T1.FinType,T1.FinType TypeCode, T2.FinTypeDesc lovDescFinTypeName , T6.CollateralDesc,T7.ProductDesc VasProductDesc,T8.Description CommitmentTypeDesc,
				T4.FacilityDesc lovDescFacilityTypeName ,
						 T1.ScreenCode, T1.WorkFlowType ,T3.WorkFlowDesc lovDescWorkFlowTypeName, T1.Version,
						 T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, 
				         T1.NextTaskId, T1.RecordType, T1.WorkflowId, T3.WorkFlowRoles LovDescWorkFlowRolesName,
				         T2.FinCategory lovDescProductCodeName,T3.FirstTaskOwner LovDescFirstTaskOwner,
				         T1.ModuleName, 
                 COALESCE(CAST(T2.FinIsActive as smallint), T6.Active,CAST(T7.Active as smallint),CAST(T8.Active as smallint) ) FinIsActive,
                 COALESCE(T2.Product,'') LovDescProductName,T2.FinAssetType,
				         T1.FinEvent, T5.ProductCategory,COALESCE(T9.REFERENCEID,0) REFERENCEID
				FROM     LMTFinanceWorkFlowDef_Temp T1 
						 LEFT JOIN RMTFinanceTypes T2 ON T1.FinType = T2.FinType 
						 INNER JOIN WorkFlowDetails T3 ON T1.WorkFlowType = T3.WorkFlowType
						 AND T3.WorkFlowActive = 1 
						 LEFT JOIN CAFFacilityTypes T4 ON T1.FinType = T4.FacilityType 
						 LEFT JOIN BMTProduct T5 ON T2.FinCategory = T5.ProductCode
						 LEFT JOIN CollateralStructure T6 ON T1.FinType = T6.CollateralType 
						 LEFT JOIN VasStructure T7 ON T1.FinType = T7.ProductCode 
						  LEFT JOIN CommitmentType T8 ON T1.FinType = T8.TypeCode
              LEFT JOIN Promotions T9 ON T9.PromotionCode= T1.Fintype
				UNION ALL
				SELECT   T1.FinType, T1.FinType TypeCode, T2.FinTypeDesc lovDescFinTypeName, T6.CollateralDesc,T7.ProductDesc VasProductDesc,T8.Description CommitmentTypeDesc, T4.FacilityDesc lovDescFacilityTypeName,
						 T1.ScreenCode, T1.WorkFlowType,T3.WorkFlowDesc lovDescWorkFlowTypeName, T1.Version,
						 T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, 
				         T1.NextTaskId, T1.RecordType, T1.WorkflowId, T3.WorkFlowRoles LovDescWorkFlowRolesName,
				         T2.FinCategory lovDescProductCodeName,T3.FirstTaskOwner LovDescFirstTaskOwner,
				         T1.ModuleName,
                COALESCE(CAST(T2.FinIsActive as smallint), T6.Active,CAST(T7.Active as smallint),CAST(T8.Active as smallint) ) FinIsActive,
                 COALESCE(T2.Product,'') LovDescProductName,T2.FinAssetType,
				         T1.FinEvent, T5.ProductCategory,COALESCE(T9.REFERENCEID,0) REFERENCEID
				FROM     LMTFinanceWorkFlowDef  T1 
						 LEFT JOIN RMTFinanceTypes T2 ON T1.FinType = T2.FinType 
						 INNER JOIN WorkFlowDetails T3 ON T1.WorkFlowType = T3.WorkFlowType 
						 AND T3.WorkFlowActive = 1 
						 LEFT JOIN CAFFacilityTypes T4 ON T1.FinType = T4.FacilityType
						 LEFT JOIN BMTProduct T5 ON T2.FinCategory = T5.ProductCode
						  LEFT JOIN CollateralStructure T6 ON T1.FinType = T6.CollateralType 
						 LEFT JOIN VasStructure T7 ON T1.FinType = T7.ProductCode 
						  LEFT JOIN CommitmentType T8 ON T1.FinType = T8.TypeCode
              LEFT JOIN Promotions T9 ON T9.PromotionCode= T1.Fintype
				WHERE    (NOT EXISTS
				                          (SELECT     1 Expr1
				                            FROM          LMTFinanceWorkFlowDef_Temp
				                            WHERE      (FinType = T1.FinType AND FinEvent = T1.FinEvent AND ModuleName = T1.ModuleName)))
		
		</createView>
	</changeSet>

	<changeSet id="108" author="Srikanth" dbms="oracle">
		<createView viewName="LMTFinanceWorkFlowDef_View"
			replaceIfExists="true">		
		SELECT   T1.FinType,T1.FinType TypeCode, T2.FinTypeDesc lovDescFinTypeName , T6.CollateralDesc,T7.ProductDesc VasProductDesc,T8.Description CommitmentTypeDesc,
				T4.FacilityDesc lovDescFacilityTypeName ,
						 T1.ScreenCode, T1.WorkFlowType ,T3.WorkFlowDesc lovDescWorkFlowTypeName, T1.Version,
						 T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, 
				         T1.NextTaskId, T1.RecordType, T1.WorkflowId, T3.WorkFlowRoles LovDescWorkFlowRolesName,
				         T2.FinCategory lovDescProductCodeName,T3.FirstTaskOwner LovDescFirstTaskOwner,
				         T1.ModuleName, 
                 COALESCE(CAST(T2.FinIsActive as number(1)), T6.Active,CAST(T7.Active as number(1)),CAST(T8.Active as number(1)) ) FinIsActive,
                 COALESCE(T2.Product,'') LovDescProductName,T2.FinAssetType,
				         T1.FinEvent, T5.ProductCategory,COALESCE(T9.REFERENCEID,0) REFERENCEID
				FROM     LMTFinanceWorkFlowDef_Temp T1 
						 LEFT JOIN RMTFinanceTypes T2 ON T1.FinType = T2.FinType 
						 INNER JOIN WorkFlowDetails T3 ON T1.WorkFlowType = T3.WorkFlowType
						 AND T3.WorkFlowActive = 1 
						 LEFT JOIN CAFFacilityTypes T4 ON T1.FinType = T4.FacilityType 
						 LEFT JOIN BMTProduct T5 ON T2.FinCategory = T5.ProductCode
						 LEFT JOIN CollateralStructure T6 ON T1.FinType = T6.CollateralType 
						 LEFT JOIN VasStructure T7 ON T1.FinType = T7.ProductCode 
						  LEFT JOIN CommitmentType T8 ON T1.FinType = T8.TypeCode
              LEFT JOIN Promotions T9 ON T9.PromotionCode= T1.Fintype
				UNION ALL
				SELECT   T1.FinType, T1.FinType TypeCode, T2.FinTypeDesc lovDescFinTypeName, T6.CollateralDesc,T7.ProductDesc VasProductDesc,T8.Description CommitmentTypeDesc, T4.FacilityDesc lovDescFacilityTypeName,
						 T1.ScreenCode, T1.WorkFlowType,T3.WorkFlowDesc lovDescWorkFlowTypeName, T1.Version,
						 T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, 
				         T1.NextTaskId, T1.RecordType, T1.WorkflowId, T3.WorkFlowRoles LovDescWorkFlowRolesName,
				         T2.FinCategory lovDescProductCodeName,T3.FirstTaskOwner LovDescFirstTaskOwner,
				         T1.ModuleName,
                COALESCE(CAST(T2.FinIsActive as number(1)), T6.Active,CAST(T7.Active as number(1)),CAST(T8.Active as number(1)) ) FinIsActive,
                 COALESCE(T2.Product,'') LovDescProductName,T2.FinAssetType,
				         T1.FinEvent, T5.ProductCategory,COALESCE(T9.REFERENCEID,0) REFERENCEID
				FROM     LMTFinanceWorkFlowDef  T1 
						 LEFT JOIN RMTFinanceTypes T2 ON T1.FinType = T2.FinType 
						 INNER JOIN WorkFlowDetails T3 ON T1.WorkFlowType = T3.WorkFlowType 
						 AND T3.WorkFlowActive = 1 
						 LEFT JOIN CAFFacilityTypes T4 ON T1.FinType = T4.FacilityType
						 LEFT JOIN BMTProduct T5 ON T2.FinCategory = T5.ProductCode
						  LEFT JOIN CollateralStructure T6 ON T1.FinType = T6.CollateralType 
						 LEFT JOIN VasStructure T7 ON T1.FinType = T7.ProductCode 
						  LEFT JOIN CommitmentType T8 ON T1.FinType = T8.TypeCode
              LEFT JOIN Promotions T9 ON T9.PromotionCode= T1.Fintype
				WHERE    (NOT EXISTS
				                          (SELECT     1 Expr1
				                            FROM          LMTFinanceWorkFlowDef_Temp
				                            WHERE      (FinType = T1.FinType AND FinEvent = T1.FinEvent AND ModuleName = T1.ModuleName)))
		
	</createView>
	</changeSet>

	<changeSet id="108" author="Srikanth" dbms="mssql">
		<createView viewName="LMTFinanceWorkFlowDef_View"
			replaceIfExists="true">
		SELECT   T1.FinType,T1.FinType TypeCode, T2.FinTypeDesc lovDescFinTypeName , T6.CollateralDesc,T7.ProductDesc VasProductDesc,T8.Description CommitmentTypeDesc,
				T4.FacilityDesc lovDescFacilityTypeName ,
						 T1.ScreenCode, T1.WorkFlowType ,T3.WorkFlowDesc lovDescWorkFlowTypeName, T1.Version,
						 T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, 
				         T1.NextTaskId, T1.RecordType, T1.WorkflowId, T3.WorkFlowRoles LovDescWorkFlowRolesName,
				         T2.FinCategory lovDescProductCodeName,T3.FirstTaskOwner LovDescFirstTaskOwner,
				         T1.ModuleName, 
                 COALESCE(CAST(T2.FinIsActive as bit), T6.Active,CAST(T7.Active as bit),CAST(T8.Active as bit) ) FinIsActive,
                 COALESCE(T2.Product,'') LovDescProductName,T2.FinAssetType,
				         T1.FinEvent, T5.ProductCategory,COALESCE(T9.REFERENCEID,0) REFERENCEID
				FROM     LMTFinanceWorkFlowDef_Temp T1 
						 LEFT JOIN RMTFinanceTypes T2 ON T1.FinType = T2.FinType 
						 INNER JOIN WorkFlowDetails T3 ON T1.WorkFlowType = T3.WorkFlowType
						 AND T3.WorkFlowActive = 1 
						 LEFT JOIN CAFFacilityTypes T4 ON T1.FinType = T4.FacilityType 
						 LEFT JOIN BMTProduct T5 ON T2.FinCategory = T5.ProductCode
						 LEFT JOIN CollateralStructure T6 ON T1.FinType = T6.CollateralType 
						 LEFT JOIN VasStructure T7 ON T1.FinType = T7.ProductCode 
						  LEFT JOIN CommitmentType T8 ON T1.FinType = T8.TypeCode
              LEFT JOIN Promotions T9 ON T9.PromotionCode= T1.Fintype
				UNION ALL
				SELECT   T1.FinType, T1.FinType TypeCode, T2.FinTypeDesc lovDescFinTypeName, T6.CollateralDesc,T7.ProductDesc VasProductDesc,T8.Description CommitmentTypeDesc, T4.FacilityDesc lovDescFacilityTypeName,
						 T1.ScreenCode, T1.WorkFlowType,T3.WorkFlowDesc lovDescWorkFlowTypeName, T1.Version,
						 T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, 
				         T1.NextTaskId, T1.RecordType, T1.WorkflowId, T3.WorkFlowRoles LovDescWorkFlowRolesName,
				         T2.FinCategory lovDescProductCodeName,T3.FirstTaskOwner LovDescFirstTaskOwner,
				         T1.ModuleName,
                COALESCE(CAST(T2.FinIsActive as bit), T6.Active,CAST(T7.Active as bit),CAST(T8.Active as bit) ) FinIsActive,
                 COALESCE(T2.Product,'') LovDescProductName,T2.FinAssetType,
				         T1.FinEvent, T5.ProductCategory,COALESCE(T9.REFERENCEID,0) REFERENCEID
				FROM     LMTFinanceWorkFlowDef  T1 
						 LEFT JOIN RMTFinanceTypes T2 ON T1.FinType = T2.FinType 
						 INNER JOIN WorkFlowDetails T3 ON T1.WorkFlowType = T3.WorkFlowType 
						 AND T3.WorkFlowActive = 1 
						 LEFT JOIN CAFFacilityTypes T4 ON T1.FinType = T4.FacilityType
						 LEFT JOIN BMTProduct T5 ON T2.FinCategory = T5.ProductCode
						  LEFT JOIN CollateralStructure T6 ON T1.FinType = T6.CollateralType 
						 LEFT JOIN VasStructure T7 ON T1.FinType = T7.ProductCode 
						  LEFT JOIN CommitmentType T8 ON T1.FinType = T8.TypeCode
              LEFT JOIN Promotions T9 ON T9.PromotionCode= T1.Fintype
				WHERE    (NOT EXISTS
				                          (SELECT     1 Expr1
				                            FROM          LMTFinanceWorkFlowDef_Temp
				                            WHERE      (FinType = T1.FinType AND FinEvent = T1.FinEvent AND ModuleName = T1.ModuleName)))
											
			</createView>
	</changeSet>

	<changeSet id="109" author="Srikanth">
		<createView viewName="LMTFINANCEWORKFLOWDEF_AVIEW"
			replaceIfExists="true">
		SELECT t1.fintype,
				t1.fintype AS typecode,
				t2.fintypedesc AS lovdescfintypename,
				t6.collateraldesc,
				t7.productdesc AS vasproductdesc,
				t8.description AS commitmenttypedesc,
				t1.fintype AS lovdescpromotioncode,
				t2.fintypedesc AS lovdescpromotionname,
				t4.facilitydesc AS lovdescfacilitytypename,
				t1.screencode,
				t1.workflowtype,
				t3.workflowdesc AS lovdescworkflowtypename,
				t1.version,
				t1.lastmntby,
				t1.lastmnton,
				t1.recordstatus,
				t1.rolecode,
				t1.nextrolecode,
				t1.taskid,
				t1.nexttaskid,
				t1.recordtype,
				t1.workflowid,
				t3.workflowroles AS lovdescworkflowrolesname,
				t2.fincategory AS lovdescproductcodename,
				t2.findivision AS lovdescfindivisionname,
				t3.firsttaskowner AS lovdescfirsttaskowner,
				t1.modulename,
				COALESCE(t2.finisactive, t6.active, t7.active, t8.active) AS finisactive,
				COALESCE(t2.product, '') AS lovdescproductname,
				t2.lovdescpromofintypedesc,
				t2.finassettype,
				t2.startdate,
				t2.enddate,
				t1.finevent,
				t5.productcategory,COALESCE(T9.REFERENCEID,0) REFERENCEID
		   FROM lmtfinanceworkflowdef t1
			 LEFT JOIN rmtfinancetypes_aview t2 ON t1.fintype = t2.fintype
			 JOIN workflowdetails t3 ON t1.workflowtype = t3.workflowtype AND t3.workflowactive = 1
			 LEFT JOIN caffacilitytypes t4 ON t1.fintype = t4.facilitytype
			 LEFT JOIN bmtproduct t5 ON t2.fincategory = t5.productcode
			 LEFT JOIN collateralstructure t6 ON t1.fintype = t6.collateraltype
			 LEFT JOIN vasstructure t7 ON t1.fintype = t7.productcode
			 LEFT JOIN commitmenttype t8 ON t1.fintype = t8.typecode
      		 LEFT JOIN Promotions T9 ON T9.PromotionCode= T1.Fintype	
	</createView>
	</changeSet>

	<changeSet id="110" author="Srikanth">
		<createView viewName="LMTFINANCEWORKFLOWDEF_FTVIEW"
			replaceIfExists="true">	
		 SELECT T1.FinType, T2.FinTypeDesc lovDescFinTypeName, T1.ScreenCode,
            T1.WorkFlowType, T5.ProductCategory, T2.FinIsActive, T1.FinEvent,
            T3.FirstTaskOwner LovDescFirstTaskOwner, T2.FinCategory LovdescProductCodeName,
            T1.ModuleName,COALESCE(T6.REFERENCEID,0) REFERENCEID
		    FROM LMTFinanceWorkFlowDef T1
            INNER JOIN RMTFinanceTypes T2   ON T1.FinType = T2.FinType 
            INNER JOIN WorkFlowDetails T3   ON T1.WorkFlowType = T3.WorkFlowType AND T3.WorkFlowActive = 1
            INNER JOin BMTProduct T5 ON T2.FinCategory = T5.ProductCode
            LEFT JOIN Promotions T6 ON T6.PromotionCode= T1.Fintype
		</createView>
	</changeSet>

	<changeSet id="111" author="Saikiran.V">
		<createView viewName="RELATIONSHIPOFFICERS_VIEW"
			replaceIfExists="true">
			SELECT T1.ROFFICERCODE,
				  T1.ROFFICERDESC,
				  T1.ROFFICERDEPTCODE,
				  T2.DEPTDESC AS LOVDESCROFFICERDEPTCODENAME,
				  T1.ROFFICERISACTIVE,
				  T1.VERSION,
				  T1.LASTMNTBY,
				  T1.LASTMNTON,
				  T1.RECORDSTATUS,
				  T1.ROLECODE,
				  T1.NEXTROLECODE,
				  T1.TASKID,
				  T1.NEXTTASKID,
				  T1.RECORDTYPE,
				  T1.WORKFLOWID,
				  T1.GENDESIGNATION,
				  T3.DESGDESC AS GENDESGDESC,
				  T1.GRADE,
				  T1.MOBILENO,
				  T1.DATEOFJOIN
				FROM RELATIONSHIPOFFICERS_TEMP T1
				LEFT JOIN BMTDEPARTMENTS T2 ON T1.ROFFICERDEPTCODE = T2.DEPTCODE
				LEFT JOIN BMTDESIGNATIONS T3 ON T1.GENDESIGNATION = T3.DESGCODE
				UNION ALL
				SELECT T1.ROFFICERCODE,
				  T1.ROFFICERDESC,
				  T1.ROFFICERDEPTCODE,
				  T2.DEPTDESC AS LOVDESCROFFICERDEPTCODENAME,
				  T1.ROFFICERISACTIVE,
				  T1.VERSION,
				  T1.LASTMNTBY,
				  T1.LASTMNTON,
				  T1.RECORDSTATUS,
				  T1.ROLECODE,
				  T1.NEXTROLECODE,
				  T1.TASKID,
				  T1.NEXTTASKID,
				  T1.RECORDTYPE,
				  T1.WORKFLOWID,
				  T1.GENDESIGNATION,
				  T3.DESGDESC GENDESGDESC,
				  T1.GRADE,
				  T1.MOBILENO,
				  T1.DATEOFJOIN
				FROM RELATIONSHIPOFFICERS T1
				LEFT JOIN BMTDEPARTMENTS T2 ON T1.ROFFICERDEPTCODE = T2.DEPTCODE
				LEFT JOIN BMTDESIGNATIONS T3 ON T1.GENDESIGNATION = T3.DESGCODE
				WHERE NOT (EXISTS (SELECT 1 FROM RELATIONSHIPOFFICERS_TEMP
				WHERE RELATIONSHIPOFFICERS_TEMP.ROFFICERCODE = T1.ROFFICERCODE))
		</createView>
	</changeSet>

	<changeSet id="112" author="Saikiran.V">
		<createView viewName="RELATIONSHIPOFFICERS_AVIEW"
			replaceIfExists="true">
			SELECT T1.ROFFICERCODE,
				  T1.ROFFICERDESC,
				  T1.ROFFICERDEPTCODE,
				  T2.DEPTDESC AS LOVDESCROFFICERDEPTCODENAME,
				  T1.ROFFICERISACTIVE,
				  T1.VERSION,
				  T1.LASTMNTBY,
				  T1.LASTMNTON,
				  T1.RECORDSTATUS,
				  T1.ROLECODE,
				  T1.NEXTROLECODE,
				  T1.TASKID,
				  T1.NEXTTASKID,
				  T1.RECORDTYPE,
				  T1.WORKFLOWID,
				  T1.GENDESIGNATION,
				  T3.DESGDESC GENDESGDESC,
				  T1.GRADE,
				  T1.MOBILENO,
				  T1.DATEOFJOIN
				FROM RELATIONSHIPOFFICERS T1
				LEFT JOIN BMTDEPARTMENTS T2 ON T1.ROFFICERDEPTCODE = T2.DEPTCODE
				LEFT JOIN BMTDESIGNATIONS T3 ON T1.GENDESIGNATION = T3.DESGCODE
		</createView>
	</changeSet>

	<changeSet id="113_pre" author="murthy.y" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'relationshipofficers_temp');
					select deps_save_and_drop_dependencies ('plf', 'relationshipofficers');
			]]>
		</sql>
	</changeSet>

	<changeSet id="113_pre" author="murthy.y" dbms="oracle">
		<sql>
			<![CDATA[
				drop INDEX IX_RLTNSHPOFCRS_ROFCCOD;
				drop INDEX	IX_T_RLTNSHPOFCRS_ROFCCOD;			
			]]>
		</sql>
	</changeSet>

	<changeSet id="113" author="Varaprasad.K" dbms="postgresql,oracle">
		<modifyDataType tableName="RelationshipOfficers_Temp"
			columnName="rOfficerCode" newDataType="VARCHAR(10)" />
		<modifyDataType tableName="RelationshipOfficers"
			columnName="rOfficerCode" newDataType="VARCHAR(10)" />
	</changeSet>

	<changeSet id="113" author="Varaprasad.K" dbms="mssql">
		<sql>
			<![CDATA[
				alter table RelationshipOfficers alter column rOfficerCode VARCHAR(10) not null;
				alter table RelationshipOfficers_Temp alter column rOfficerCode VARCHAR(10) not null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="113_post" author="murthy.y" dbms="oracle">
		<sql>
			<![CDATA[
				CREATE INDEX IX_RLTNSHPOFCRS_ROFCCOD ON RELATIONSHIPOFFICERS (NLSSORT(ROFFICERCODE,'nls_sort=''BINARY_CI'''));
				CREATE INDEX IX_T_RLTNSHPOFCRS_ROFCCOD ON RELATIONSHIPOFFICERS_TEMP (NLSSORT(ROFFICERCODE,'nls_sort=''BINARY_CI'''));
			]]>
		</sql>
	</changeSet>

	<changeSet id="113_post" author="murthy.y" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'relationshipofficers_temp');
					select deps_restore_dependencies ('plf', 'relationshipofficers');
			]]>
		</sql>
	</changeSet>

	<changeSet id="114" author="vijaya.a">
		<createView viewName="RECEIPT_REALIZATION_VIEW"
			replaceIfExists="true">
			SELECT t4.custcif,
			    t1.reference,
			    t3.fintype,
			    t1.receiptid,
			    t1.receiptdate,
			    t1.receiptamount,
			    t2.depositdate,
			    t2.bankcode AS depositbank,
			        CASE
			            WHEN t1.receiptpurpose = 'EarlyPayment' THEN 'Partial Payment'
			            ELSE t1.receiptpurpose
			        END AS receiptpurpose,
			    t1.receiptmode,
			    t1.bouncedate AS canceldate,
			    t2.valuedate,
			    t2.payagainstid,
			    t1.bouncedate,
			    t1.realizationdate,
			    t1.cancelreason,
			    t3.closingstatus,
			    t3.finbranch,
			    t3.fincurrassetvalue,
			    t3.productcategory,
			    t6.partnerbankcode,
			    t2.transactionref,
			    t2.fundingac,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t5.roledesc AS lovdescrequeststage,
			    t2.paymenttype,
			    t1.receiptmodestatus,
			    t1.actfinreceipt,
			    t2.favournumber
			   FROM finreceiptheader_temp t1
			     LEFT JOIN finreceiptdetail_temp t2 ON t1.receiptid = t2.receiptid
			     LEFT JOIN financemain t3 ON t1.reference = t3.finreference
			     LEFT JOIN customers t4 ON t3.custid = t4.custid
			     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
			     LEFT JOIN partnerbanks t6 ON t6.partnerbankid = t2.fundingac
			UNION ALL
			 SELECT t4.custcif,
			    t1.reference,
			    t3.fintype,
			    t1.receiptid,
			    t1.receiptdate,
			    t1.receiptamount,
			    t2.depositdate,
			    t2.bankcode AS depositbank,
			        CASE
			            WHEN t1.receiptpurpose = 'EarlyPayment' THEN 'Partial Payment'
			            ELSE t1.receiptpurpose
			        END AS receiptpurpose,
			    t1.receiptmode,
			    t1.bouncedate AS canceldate,
			    t2.valuedate,
			    t2.payagainstid,
			    t1.bouncedate,
			    t1.realizationdate,
			    t1.cancelreason,
			    t3.closingstatus,
			    t3.finbranch,
			    t3.fincurrassetvalue,
			    t3.productcategory,
			    t6.partnerbankcode,
			    t2.transactionref,
			    t2.fundingac,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t5.roledesc AS lovdescrequeststage,
			    t2.paymenttype,
			    t1.receiptmodestatus,
			    t1.actfinreceipt,
			    t2.favournumber
			   FROM finreceiptheader t1
			     LEFT JOIN finreceiptdetail t2 ON t1.receiptid = t2.receiptid
			     LEFT JOIN financemain t3 ON t1.reference = t3.finreference
			     LEFT JOIN customers t4 ON t3.custid = t4.custid
			     LEFT JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
			     LEFT JOIN partnerbanks t6 ON t6.partnerbankid = t2.fundingac
			  WHERE NOT (EXISTS ( SELECT 1
			           FROM finreceiptheader_temp
			          WHERE finreceiptheader_temp.receiptid = t1.receiptid))
		</createView>
	</changeSet>

	<changeSet id="115" author="vijaya.a">
		<createView viewName="RECEIPTDETAILS_TVIEW"
			replaceIfExists="true">
			SELECT t4.custcif,
			    t1.reference,
			    t3.fintype,
			    t1.receiptid,
			    t1.receiptdate,
			    t1.receiptamount,
			    t2.depositdate,
			    t2.bankcode AS depositbank,
			        CASE
			            WHEN t1.receiptpurpose = 'EarlyPayment' THEN 'Partial Payment'
			            ELSE t1.receiptpurpose
			        END AS receiptpurpose,
			    t1.receiptmode,
			    t1.bouncedate AS canceldate,
			    t2.valuedate,
			    t2.payagainstid,
			    t1.bouncedate,
			    t1.realizationdate,
			    t1.cancelreason,
			    t3.closingstatus,
			    t3.finbranch,
			    t3.fincurrassetvalue,
			    t3.productcategory,
			    t6.partnerbankcode,
			    t2.transactionref,
			    t2.fundingac,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t5.roledesc AS lovdescrequeststage,
			    t2.paymenttype,
			    t1.receiptmodestatus,
			    t1.actfinreceipt,
			    t2.favourNumber
			   FROM finreceiptheader_temp t1
			     LEFT JOIN finreceiptdetail_temp t2 ON t1.receiptid = t2.receiptid
			     LEFT JOIN financemain t3 ON t1.reference = t3.finreference
			     LEFT JOIN customers t4 ON t3.custid = t4.custid
			     JOIN secroles t5 ON t1.nextrolecode = t5.rolecd
			     LEFT JOIN partnerbanks t6 ON t6.partnerbankid = t2.fundingac
		</createView>
	</changeSet>

	<changeSet id="116.0" author="meena.a">
		<sql>
			<![CDATA[
				delete from SMTPARAMETERS where sysparmcode='ALLOW_INCLUDE_FROMDATE_ADD_RATE_CHANGE';
			   	INSERT INTO SMTPARAMETERS VALUES ('ALLOW_INCLUDE_FROMDATE_ADD_RATE_CHANGE','Add rate change allow after from date','String',1,'N',1,0,null,null,'Allow Base Rate Interest Review FrqCode Value Req',3,1000,current_Timestamp,'Approved',null,null,null,null,null,0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="117" author="Varaprasad.K">
		<addColumn tableName="FINANCEMAIN">
			<column name="AppliedLoanAmt" type="DECIMAL(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="118" author="Varaprasad.K">
		<addColumn tableName="FINANCEMAIN_TEMP">
			<column name="AppliedLoanAmt" type="DECIMAL(18,0)" />
		</addColumn>
	</changeSet>
	<changeSet id="119" author="Varaprasad.K">
		<addColumn tableName="WIFFINANCEMAIN">
			<column name="AppliedLoanAmt" type="DECIMAL(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="120" author="Varaprasad.K">
		<addColumn tableName="WIFFINANCEMAIN_TEMP">
			<column name="AppliedLoanAmt" type="DECIMAL(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="121" author="Varaprasad.K">
		<sql>
			<![CDATA[
				UPDATE FINANCEMAIN      Set AppliedLoanAmt = 0;
				UPDATE FINANCEMAIN_Temp Set AppliedLoanAmt = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="122" author="Varaprasad.K" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FINANCEMAIN      ADD CONSTRAINT DF_FINANCEMAIN_APPLIEDLOANAMT      DEFAULT 0 FOR AppliedLoanAmt;
				ALTER TABLE FINANCEMAIN_TEMP ADD CONSTRAINT DF_FINANCEMAIN_TEMP_APPLIEDLOANAMT DEFAULT 0 FOR AppliedLoanAmt;
			]]>
		</sql>
	</changeSet>

	<changeSet id="123" author="Varaprasad.K" dbms="postgresql, oracle">
		<addDefaultValue columnName="AppliedLoanAmt"
			tableName="FINANCEMAIN" defaultValue="0" />
		<addDefaultValue columnName="AppliedLoanAmt"
			tableName="FINANCEMAIN_Temp" defaultValue="0" />
	</changeSet>

	<changeSet id="124" author="Varaprasad.K">
		<addColumn tableName="FINANCEMAIN_PA">
			<column name="AppliedLoanAmt" type="DECIMAL(18,0)" />
		</addColumn>
	</changeSet>

	<changeSet id="125" author="Varaprasad.K">
		<sql>
			<![CDATA[
				UPDATE FINANCEMAIN_PA Set AppliedLoanAmt = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="126" author="Varaprasad.K" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FINANCEMAIN_PA ADD CONSTRAINT DF_FINANCEMAIN_PA_AppliedLoanAmt DEFAULT 0 FOR AppliedLoanAmt;
			]]>
		</sql>
	</changeSet>

	<changeSet id="127" author="Varaprasad.K" dbms="postgresql, oracle">
		<addDefaultValue columnName="AppliedLoanAmt"
			tableName="FINANCEMAIN_PA" defaultValue="0" />
	</changeSet>

	<changeSet id="128" author="Varaprasdd.K">
		<sql>
			<![CDATA[
				UPDATE WIFFINANCEMAIN Set AppliedLoanAmt = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="129" author="Varaprasdd.K" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE WIFFINANCEMAIN ADD CONSTRAINT DF_WIFFINANCEMAIN_APPLIEDLOANAMT DEFAULT 0 FOR AppliedLoanAmt;
				
			]]>
		</sql>
	</changeSet>

	<changeSet id="130" author="Varaprasdd.K" dbms="postgresql, oracle">
		<addDefaultValue columnName="AppliedLoanAmt"
			tableName="WIFFINANCEMAIN" defaultValue="0" />
		<addDefaultValue columnName="AppliedLoanAmt"
			tableName="WIFFINANCEMAIN_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="131_pre" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'financemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="131" author="Varaprasad.K">
		<createView viewName="FINANCEMAIN_VIEW" replaceIfExists="true">
			SELECT t1.finreference,
			t1.investmentref,
			t1.numberofterms,
			t1.grcperiodenddate,
			t1.allowgrcperiod,
			t1.gracebaserate,
			t1.gracespecialrate,
			t1.grcpftrate,
			t1.grcpftfrq,
			t1.nextgrcpftdate,
			t1.allowgrcpftrvw,
			t1.grcpftrvwfrq,
			t1.nextgrcpftrvwdate,
			t1.allowgrccpz,
			t1.grccpzfrq,
			t1.nextgrccpzdate,
			t1.repaybaserate,
			t1.repayspecialrate,
			t1.repayprofitrate,
			t1.repayfrq,
			t1.nextrepaydate,
			t1.repaypftfrq,
			t1.nextrepaypftdate,
			t1.allowrepayrvw,
			t1.repayrvwfrq,
			t1.nextrepayrvwdate,
			t1.allowrepaycpz,
			t1.repaycpzfrq,
			t1.nextrepaycpzdate,
			t1.maturitydate,
			t1.cpzatgraceend,
			t1.downpayment,
			t1.graceflatamount,
			t1.reqrepayamount,
			t1.totalprofit,
			t1.totalcpz,
			t1.totalgrosspft,
			t1.totalgrossgrcpft,
			t1.totalgracepft,
			t1.totalgracecpz,
			t1.grcratebasis,
			t1.repayratebasis,
			t1.fintype,
			t1.finremarks,
			t1.finccy,
			t1.schedulemethod,
			t1.profitdaysbasis,
			t1.reqmaturity,
			t1.calterms,
			t1.calmaturity,
			t1.firstrepay,
			t1.lastrepay,
			t1.finstartdate,
			t1.finamount,
			t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
			t1.finrepaymentamount,
			t1.custid,
			t1.defferments,
			t1.plandefercount,
			t1.finbranch,
			t1.finsourceid,
			t1.alloweddefrpychange,
			t1.availeddefrpychange,
			t1.alloweddeffrqchange,
			t1.availeddeffrqchange,
			t1.recaltype,
			t1.finassetvalue,
			t1.disbaccountid,
			t1.repayaccountid,
			t1.finisactive,
			t1.limitvalid,
			t1.overridelimit,
			t1.securitydeposit,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t7.fintypedesc AS lovdescfintypename,
			t7.finmaxamount AS lovdescfinmaxamt,
			t7.finminamount AS lovdescfinminamount,
			t1.mindownpayperc,
			t7.finisalwdifferment AS lovdescfinalwdeferment,
			t7.finisdwpayrequired AS lovdescdwnpayreq,
			t7.finmaxdifferment AS lovdescfinmaxdifferment,
			t12.branchdesc AS lovdescfinbranchname,
			t12.branchprovince AS finbranchprovincecode,
			t1.lastrepaydate,
			t1.lastrepaypftdate,
			t1.lastrepayrvwdate,
			t1.lastrepaycpzdate,
			t1.allowgrcrepay,
			t1.grcschdmthd,
			t1.grcmargin,
			t1.repaymargin,
			t1.fincurrassetvalue,
			t1.fincommitmentref,
			t1.finlimitref,
			t1.depreciationfrq,
			t1.fincontractdate,
			t1.nextdepdate,
			t1.lastdepdate,
			t1.finaccount,
			t1.fincustpftaccount,
			t17.acrtilllbd AS lovdescaccruedtilllbd,
			t7.finrvwrateapplfor,
			t1.totalrepayamt,
			t1.closingstatus,
			t1.finapproveddate,
			t1.feechargeamt,
			t1.blacklisted,
			t1.finrepaypftonfrq,
			t1.anualizedpercrate,
			t1.effectiverateofreturn,
			t1.migratedfinance,
			t1.schedulemaintained,
			t1.scheduleregenerated,
			t1.finpurpose,
			t39.loanpurposedesc AS lovdescfinpurposename,
			t1.finstatus,
			t1.finstsreason,
			t1.initiateuser,
			t1.bankname,
			t1.iban,
			t1.accounttype,
			t1.ddareferenceno,
			t7.finscheduleon AS lovdescfinscheduleon,
			t1.custdsr,
			t1.jointaccount,
			t1.jointcustid,
			t1.downpaybank,
			t1.downpaysupl,
			t1.downpayaccount,
			t1.securitycollateral,
			t1.approved,
			t1.discrepancy,
			t1.limitapproved,
			t1.graceterms,
			t7.findivision AS lovdescfindivision,
			t1.rcdmaintainsts,
			t1.finrepaymethod,
			t1.grcprofitdaysbasis,
			t1.stepfinance,
			t1.steptype,
			t1.steppolicy,
			t1.alwmanualsteps,
			t1.noofsteps,
			t1.linkedfinref,
			t1.nextuserid,
			t1.priority,
			t24.policydesc AS lovdescsteppolicyname,
			t1.grcminrate,
			t1.grcmaxrate,
			t1.rpyminrate,
			t1.rpymaxrate,
			t1.deviationapproval,
			t1.manualschedule,
			t1.takeoverfinance,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.supplementrent,
			t1.increasedcost,
			t1.creditinsamt,
			t1.rolloverfrq,
			t1.nextrolloverdate,
			t27.custstsdescription,
			t1.shariastatus,
			t1.initiatedate,
			t1.finpreapprovedref,
			t1.mmaid,
			t1.accountsofficer,
			t1.feeaccountid,
			t1.fincancelac,
			t28.dealername AS lovdescaccountsofficer,
			t28.dealercity AS lovdescsourcecity,
			t1.dsacode,
			t30.rofficerdesc AS dsacodedesc,
			t1.tdsapplicable,
			t1.mandateid,
			t1.droplinefrq,
			t1.firstdroplinedate,
			t1.pftservicingodlimit,
			t1.insuranceamt,
			t1.deductinsdisb,
			t1.alwbpi,
			t1.bpitreatment,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.calroundingmode,
			t1.alwmultidisb,
			t1.applicationno,
			t1.referralid,
			t33.rofficerdesc AS referraliddesc,
			t1.dmacode,
			t34.rofficerdesc AS dmacodedesc,
			t1.salesdepartment,
			t35.gendeptdesc AS salesdepartmentdesc,
			t1.quickdisb,
			t1.wifreference,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.availedunplanemi,
			t1.availedreageh,
			t1.bpiamount,
			t1.deductfeedisb,
			t1.rvwrateapplfor,
			t1.schcalonrvw,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.promotioncode,
			t1.restructureloan,
			t1.oldfinreference,
			t1.reagebucket,
			t1.fincategory,
			t1.productcategory,
			t1.roundingtarget,
			t36.entitycode AS lovdescentitycode,
			t1.eligibilitymethod,
			t38.fieldcodevalue AS loveligibilitymethod,
			t38.valuedesc AS lovdesceligibilitymethod,
			t1.employeename,
			t37.rofficerdesc AS employeenamedesc,
			t1.samplingrequired,
			t1.legalrequired,
			t1.grcmaxamount,
			t1.connector,
			t40.dealername AS connectorcode,
			t40.dealercity AS connectordesc,
			t1.advanceemi,
			t1.advemiterms,
			t1.bpipftdaysbasis,
			t1.fixedratetenor,
			t1.fixedtenorrate,
			t12.branchtel AS finbranchcontact,
			t1.processattributes,
			t1.businessvertical,
			bv.code AS businessverticalcode,
			bv.description AS businessverticaldesc,
			t1.grcadvtype,
			t1.grcadvterms,
			t1.advtype,
			t1.advterms,
			t1.advstage,
			t1.tdspercentage,
			t1.tdsstartdate,
			t1.tdsenddate,
			t1.tdslimitamt,
			t1.vanreq,
			t1.vancode,
			t1.allowdrawingpower,
			t1.allowrevolving,
			t1.sanbsdschdle,
			t1.promotionseqid,
			t1.svamount,
			t1.cbamount,
			t1.appliedLoanAmt
		   FROM financemain_temp t1
			 JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
			 LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
			 LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
			 LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
			 LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
			 LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
			 LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
			 LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
			 LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
			 LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
			 LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
			 LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
			 LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
			 LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
			 LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
			 LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
		UNION ALL
		 SELECT t1.finreference,
			t1.investmentref,
			t1.numberofterms,
			t1.grcperiodenddate,
			t1.allowgrcperiod,
			t1.gracebaserate,
			t1.gracespecialrate,
			t1.grcpftrate,
			t1.grcpftfrq,
			t1.nextgrcpftdate,
			t1.allowgrcpftrvw,
			t1.grcpftrvwfrq,
			t1.nextgrcpftrvwdate,
			t1.allowgrccpz,
			t1.grccpzfrq,
			t1.nextgrccpzdate,
			t1.repaybaserate,
			t1.repayspecialrate,
			t1.repayprofitrate,
			t1.repayfrq,
			t1.nextrepaydate,
			t1.repaypftfrq,
			t1.nextrepaypftdate,
			t1.allowrepayrvw,
			t1.repayrvwfrq,
			t1.nextrepayrvwdate,
			t1.allowrepaycpz,
			t1.repaycpzfrq,
			t1.nextrepaycpzdate,
			t1.maturitydate,
			t1.cpzatgraceend,
			t1.downpayment,
			t1.graceflatamount,
			t1.reqrepayamount,
			t1.totalprofit,
			t1.totalcpz,
			t1.totalgrosspft,
			t1.totalgrossgrcpft,
			t1.totalgracepft,
			t1.totalgracecpz,
			t1.grcratebasis,
			t1.repayratebasis,
			t1.fintype,
			t1.finremarks,
			t1.finccy,
			t1.schedulemethod,
			t1.profitdaysbasis,
			t1.reqmaturity,
			t1.calterms,
			t1.calmaturity,
			t1.firstrepay,
			t1.lastrepay,
			t1.finstartdate,
			t1.finamount,
			t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
			t1.finrepaymentamount,
			t1.custid,
			t1.defferments,
			t1.plandefercount,
			t1.finbranch,
			t1.finsourceid,
			t1.alloweddefrpychange,
			t1.availeddefrpychange,
			t1.alloweddeffrqchange,
			t1.availeddeffrqchange,
			t1.recaltype,
			t1.finassetvalue,
			t1.disbaccountid,
			t1.repayaccountid,
			t1.finisactive,
			t1.limitvalid,
			t1.overridelimit,
			t1.securitydeposit,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t7.fintypedesc AS lovdescfintypename,
			t7.finmaxamount AS lovdescfinmaxamt,
			t7.finminamount AS lovdescfinminamount,
			t1.mindownpayperc,
			t7.finisalwdifferment AS lovdescfinalwdeferment,
			t7.finisdwpayrequired AS lovdescdwnpayreq,
			t7.finmaxdifferment AS lovdescfinmaxdifferment,
			t12.branchdesc AS lovdescfinbranchname,
			t12.branchprovince AS finbranchprovincecode,
			t1.lastrepaydate,
			t1.lastrepaypftdate,
			t1.lastrepayrvwdate,
			t1.lastrepaycpzdate,
			t1.allowgrcrepay,
			t1.grcschdmthd,
			t1.grcmargin,
			t1.repaymargin,
			t1.fincurrassetvalue,
			t1.fincommitmentref,
			t1.finlimitref,
			t1.depreciationfrq,
			t1.fincontractdate,
			t1.nextdepdate,
			t1.lastdepdate,
			t1.finaccount,
			t1.fincustpftaccount,
			t17.acrtilllbd AS lovdescaccruedtilllbd,
			t7.finrvwrateapplfor,
			t1.totalrepayamt,
			t1.closingstatus,
			t1.finapproveddate,
			t1.feechargeamt,
			t1.blacklisted,
			t1.finrepaypftonfrq,
			t1.anualizedpercrate,
			t1.effectiverateofreturn,
			t1.migratedfinance,
			t1.schedulemaintained,
			t1.scheduleregenerated,
			t1.finpurpose,
			t39.loanpurposedesc AS lovdescfinpurposename,
			t1.finstatus,
			t1.finstsreason,
			t1.initiateuser,
			t1.bankname,
			t1.iban,
			t1.accounttype,
			t1.ddareferenceno,
			t7.finscheduleon AS lovdescfinscheduleon,
			t1.custdsr,
			t1.jointaccount,
			t1.jointcustid,
			t1.downpaybank,
			t1.downpaysupl,
			t1.downpayaccount,
			t1.securitycollateral,
			t1.approved,
			t1.discrepancy,
			t1.limitapproved,
			t1.graceterms,
			t7.findivision AS lovdescfindivision,
			t1.rcdmaintainsts,
			t1.finrepaymethod,
			t1.grcprofitdaysbasis,
			t1.stepfinance,
			t1.steptype,
			t1.steppolicy,
			t1.alwmanualsteps,
			t1.noofsteps,
			t1.linkedfinref,
			t1.nextuserid,
			t1.priority,
			t24.policydesc AS lovdescsteppolicyname,
			t1.grcminrate,
			t1.grcmaxrate,
			t1.rpyminrate,
			t1.rpymaxrate,
			t1.deviationapproval,
			t1.manualschedule,
			t1.takeoverfinance,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.supplementrent,
			t1.increasedcost,
			t1.creditinsamt,
			t1.rolloverfrq,
			t1.nextrolloverdate,
			t27.custstsdescription,
			t1.shariastatus,
			t1.initiatedate,
			t1.finpreapprovedref,
			t1.mmaid,
			t1.accountsofficer,
			t1.feeaccountid,
			t1.fincancelac,
			t28.dealername AS lovdescaccountsofficer,
			t28.dealercity AS lovdescsourcecity,
			t1.dsacode,
			t30.rofficerdesc AS dsacodedesc,
			t1.tdsapplicable,
			t1.mandateid,
			t1.droplinefrq,
			t1.firstdroplinedate,
			t1.pftservicingodlimit,
			t1.insuranceamt,
			t1.deductinsdisb,
			t1.alwbpi,
			t1.bpitreatment,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.calroundingmode,
			t1.alwmultidisb,
			t1.applicationno,
			t1.referralid,
			t33.rofficerdesc AS referraliddesc,
			t1.dmacode,
			t34.rofficerdesc AS dmacodedesc,
			t1.salesdepartment,
			t35.gendeptdesc AS salesdepartmentdesc,
			t1.quickdisb,
			t1.wifreference,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.availedunplanemi,
			t1.availedreageh,
			t1.bpiamount,
			t1.deductfeedisb,
			t1.rvwrateapplfor,
			t1.schcalonrvw,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.promotioncode,
			t1.restructureloan,
			t1.oldfinreference,
			t1.reagebucket,
			t1.fincategory,
			t1.productcategory,
			t1.roundingtarget,
			t36.entitycode AS lovdescentitycode,
			t1.eligibilitymethod,
			t38.fieldcodevalue AS loveligibilitymethod,
			t38.valuedesc AS lovdesceligibilitymethod,
			t1.employeename,
			t37.rofficerdesc AS employeenamedesc,
			t1.samplingrequired,
			t1.legalrequired,
			t1.grcmaxamount,
			t1.connector,
			t40.dealername AS connectorcode,
			t40.dealercity AS connectordesc,
			t1.advanceemi,
			t1.advemiterms,
			t1.bpipftdaysbasis,
			t1.fixedratetenor,
			t1.fixedtenorrate,
			t12.branchtel AS finbranchcontact,
			t1.processattributes,
			t1.businessvertical,
			bv.code AS businessverticalcode,
			bv.description AS businessverticaldesc,
			t1.grcadvtype,
			t1.grcadvterms,
			t1.advtype,
			t1.advterms,
			t1.advstage,
			t1.tdspercentage,
			t1.tdsstartdate,
			t1.tdsenddate,
			t1.tdslimitamt,
			t1.vanreq,
			t1.vancode,
			t1.allowdrawingpower,
			t1.allowrevolving,
			t1.sanbsdschdle,
			t1.promotionseqid,
			t1.svamount,
			t1.cbamount,
			t1.appliedLoanAmt
		   FROM financemain t1
			 JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
			 LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
			 LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
			 LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
			 LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
			 LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
			 LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
			 LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
			 LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
			 LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
			 LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
			 LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
			 LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
			 LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
			 LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
			 LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
  WHERE NOT (EXISTS ( SELECT 1
           FROM financemain_temp
          WHERE financemain_temp.finreference = t1.finreference))

	</createView>
	</changeSet>

	<changeSet id="131_post" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="132_pre" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="132" author="Varaprasad.K">
		<createView viewName="FINANCEMAIN_TVIEW" replaceIfExists="true">
			SELECT t1.finreference,
    t1.investmentref,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgrossgrcpft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t1.recaltype,
    t1.finassetvalue,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.finisactive,
    t1.limitvalid,
    t1.overridelimit,
    t1.securitydeposit,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t7.fintypedesc AS lovdescfintypename,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t1.mindownpayperc,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t12.branchdesc AS lovdescfinbranchname,
    t12.branchprovince AS finbranchprovincecode,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.grcmargin,
    t1.repaymargin,
    t1.fincurrassetvalue,
    t1.fincommitmentref,
    t1.finlimitref,
    t1.depreciationfrq,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t17.acrtilllbd AS lovdescaccruedtilllbd,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.feechargeamt,
    t1.blacklisted,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.migratedfinance,
    t1.schedulemaintained,
    t1.scheduleregenerated,
    t1.finpurpose,
    t39.loanpurposedesc AS lovdescfinpurposename,
    t1.finstatus,
    t1.finstsreason,
    t1.initiateuser,
    t1.bankname,
    t1.iban,
    t1.accounttype,
    t1.ddareferenceno,
    t7.finscheduleon AS lovdescfinscheduleon,
    t1.custdsr,
    t1.jointaccount,
    t1.jointcustid,
    t1.downpaybank,
    t1.downpaysupl,
    t1.downpayaccount,
    t1.securitycollateral,
    t1.approved,
    t1.discrepancy,
    t1.limitapproved,
    t1.graceterms,
    t7.findivision AS lovdescfindivision,
    t1.rcdmaintainsts,
    t1.finrepaymethod,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t1.nextuserid,
    t1.priority,
    t24.policydesc AS lovdescsteppolicyname,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.deviationapproval,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.creditinsamt,
    t1.rolloverfrq,
    t1.nextrolloverdate,
    t27.custstsdescription,
    t1.shariastatus,
    t1.initiatedate,
    t1.finpreapprovedref,
    t1.mmaid,
    t1.accountsofficer,
    t1.feeaccountid,
    t1.fincancelac,
    t28.dealername AS lovdescaccountsofficer,
    t28.dealercity AS lovdescsourcecity,
    t1.dsacode,
    t30.rofficerdesc AS dsacodedesc,
    t1.tdsapplicable,
    t1.mandateid,
    t1.droplinefrq,
    t1.firstdroplinedate,
    t1.pftservicingodlimit,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.applicationno,
    t1.referralid,
    t33.rofficerdesc AS referraliddesc,
    t1.dmacode,
    t34.rofficerdesc AS dmacodedesc,
    t1.salesdepartment,
    t35.gendeptdesc AS salesdepartmentdesc,
    t1.quickdisb,
    t1.wifreference,
    t1.unplanemihlockperiod,
    t1.unplanemicpz,
    t1.reagecpz,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.promotioncode,
    t1.restructureloan,
    t1.oldfinreference,
    t1.reagebucket,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t36.entitycode AS lovdescentitycode,
    t1.eligibilitymethod,
    t38.fieldcodevalue AS loveligibilitymethod,
    t38.valuedesc AS lovdesceligibilitymethod,
    t1.employeename,
    t37.rofficerdesc AS employeenamedesc,
    t1.samplingrequired,
    t1.legalrequired,
    t1.grcmaxamount,
    t1.connector,
    t40.dealername AS connectorcode,
    t40.dealercity AS connectordesc,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedratetenor,
    t1.fixedtenorrate,
    t12.branchtel AS finbranchcontact,
    t1.processattributes,
    t1.businessvertical,
    bv.code AS businessverticalcode,
    bv.description AS businessverticaldesc,
    t1.grcadvtype,
    t1.grcadvterms,
    t1.advtype,
    t1.advterms,
    t1.advstage,
    t1.tdspercentage,
    t1.tdsstartdate,
    t1.tdsenddate,
    t1.tdslimitamt,
    t1.vanreq,
    t1.vancode,
    t1.allowdrawingpower,
    t1.allowrevolving,
    t1.sanbsdschdle,
    t1.promotionseqid,
    t1.svamount,
    t1.cbamount,
	t1.appliedLoanAmt
   FROM financemain_temp t1
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
     LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
     LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
     LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
     LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
     LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
     LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
     LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
     LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
		</createView>
	</changeSet>

	<changeSet id="132_post" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="133_pre" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="133" author="Varaprasad.K">
		<createView viewName="FINANCEMAIN_AVIEW" replaceIfExists="true">
			SELECT t1.finreference,
    t1.investmentref,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgrossgrcpft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t1.recaltype,
    t1.finassetvalue,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.finisactive,
    t1.limitvalid,
    t1.overridelimit,
    t1.securitydeposit,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t7.fintypedesc AS lovdescfintypename,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t1.mindownpayperc,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t12.branchdesc AS lovdescfinbranchname,
    t12.branchprovince AS finbranchprovincecode,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.grcmargin,
    t1.repaymargin,
    t1.fincurrassetvalue,
    t1.fincommitmentref,
    t1.finlimitref,
    t1.depreciationfrq,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t17.acrtilllbd AS lovdescaccruedtilllbd,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.feechargeamt,
    t1.blacklisted,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.migratedfinance,
    t1.schedulemaintained,
    t1.scheduleregenerated,
    t1.finpurpose,
    t39.loanpurposedesc AS lovdescfinpurposename,
    t1.finstatus,
    t1.finstsreason,
    t1.initiateuser,
    t1.bankname,
    t1.iban,
    t1.accounttype,
    t1.ddareferenceno,
    t7.finscheduleon AS lovdescfinscheduleon,
    t1.custdsr,
    t1.jointaccount,
    t1.jointcustid,
    t1.downpaybank,
    t1.downpaysupl,
    t1.downpayaccount,
    t1.securitycollateral,
    t1.approved,
    t1.discrepancy,
    t1.limitapproved,
    t1.graceterms,
    t7.findivision AS lovdescfindivision,
    t1.rcdmaintainsts,
    t1.finrepaymethod,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t1.nextuserid,
    t1.priority,
    t24.policydesc AS lovdescsteppolicyname,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.deviationapproval,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.creditinsamt,
    t1.rolloverfrq,
    t1.nextrolloverdate,
    t27.custstsdescription,
    t1.shariastatus,
    t1.initiatedate,
    t1.finpreapprovedref,
    t1.mmaid,
    t1.accountsofficer,
    t1.feeaccountid,
    t1.fincancelac,
    t28.dealername AS lovdescaccountsofficer,
    t28.dealercity AS lovdescsourcecity,
    t1.dsacode,
    t30.rofficerdesc AS dsacodedesc,
    t1.tdsapplicable,
    t1.mandateid,
    t1.droplinefrq,
    t1.firstdroplinedate,
    t1.pftservicingodlimit,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.applicationno,
    t1.referralid,
    t33.rofficerdesc AS referraliddesc,
    t1.dmacode,
    t34.rofficerdesc AS dmacodedesc,
    t1.salesdepartment,
    t35.gendeptdesc AS salesdepartmentdesc,
    t1.quickdisb,
    t1.wifreference,
    t1.unplanemihlockperiod,
    t1.unplanemicpz,
    t1.reagecpz,
    t1.maxunplannedemi,
    t1.maxreageholidays,
    t1.availedunplanemi,
    t1.availedreageh,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.promotioncode,
    t1.restructureloan,
    t1.oldfinreference,
    t1.reagebucket,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t36.entitycode AS lovdescentitycode,
    t1.eligibilitymethod,
    t38.fieldcodevalue AS loveligibilitymethod,
    t38.valuedesc AS lovdesceligibilitymethod,
    t1.employeename,
    t37.rofficerdesc AS employeenamedesc,
    t1.samplingrequired,
    t1.legalrequired,
    t1.grcmaxamount,
    t1.connector,
    t40.dealername AS connectorcode,
    t40.dealercity AS connectordesc,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedratetenor,
    t1.fixedtenorrate,
    t12.branchtel AS finbranchcontact,
    t1.processattributes,
    t1.businessvertical,
    bv.code AS businessverticalcode,
    bv.description AS businessverticaldesc,
    t1.grcadvtype,
    t1.grcadvterms,
    t1.advtype,
    t1.advterms,
    t1.advstage,
    t1.tdspercentage,
    t1.tdsstartdate,
    t1.tdsenddate,
    t1.tdslimitamt,
    t1.vanreq,
    t1.vancode,
    t1.allowdrawingpower,
    t1.allowrevolving,
    t1.sanbsdschdle,
    t1.promotionseqid,
    t1.svamount,
    t1.cbamount,
	t1.appliedLoanAmt
   FROM financemain t1
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
     LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
     LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
     LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
     LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
     LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
     LEFT JOIN rmtgendepartments t35 ON t1.salesdepartment = t35.gendepartment
     LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
     LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
     LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
		</createView>
	</changeSet>

	<changeSet id="133_post" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="134_pre" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'wiffinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="134" author="Varaprasad.K">
		<createView viewName="wiffinancemain_view" replaceIfExists="true">
			SELECT t1.finreference,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finisactive,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t15.custcif AS lovdesccustcif,
    t7.fintypedesc AS lovdescfintypename,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t1.mindownpayperc,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t1.recaltype,
    t1.finassetvalue,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.repaymargin,
    t1.grcmargin,
    t1.depreciationfrq,
    t1.fincommitmentref,
    t1.fincurrassetvalue,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.downpaybank,
    t1.downpaysupl,
    t7.findivision AS lovdescfindivisionname,
    t1.graceterms,
    t14.facilitytype,
    t15.custshrtname AS lovdesccustshrtname,
    t16.branchdesc AS lovdescfinbranchname,
    t1.totalgrossgrcpft,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t7.product AS lovdescfinproduct,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.feeaccountid,
    t1.tdsapplicable,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.feechargeamt,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t1.grcmaxamount,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedtenorrate,
    t1.fixedratetenor,
    t1.grcadvtype,
    t1.grcadvterms,
    t1.advtype,
    t1.advterms,
    t1.advstage,
    t1.allowdrawingpower,
    t1.allowrevolving,
    t1.appliedLoanAmt
   FROM wiffinancemain_temp t1
     LEFT JOIN wifindicativetermdetail_temp t14 ON t14.finreference = t1.finreference
     LEFT JOIN customers t15 ON t15.custid = t1.custid
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t16 ON t1.finbranch = t16.branchcode
UNION ALL
 SELECT t1.finreference,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finisactive,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t15.custcif AS lovdesccustcif,
    t7.fintypedesc AS lovdescfintypename,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t1.mindownpayperc,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t1.recaltype,
    t1.finassetvalue,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.repaymargin,
    t1.grcmargin,
    t1.depreciationfrq,
    t1.fincommitmentref,
    t1.fincurrassetvalue,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.downpaybank,
    t1.downpaysupl,
    t7.findivision AS lovdescfindivisionname,
    t1.graceterms,
    t14.facilitytype,
    t15.custshrtname AS lovdesccustshrtname,
    t16.branchdesc AS lovdescfinbranchname,
    t1.totalgrossgrcpft,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t7.product AS lovdescfinproduct,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.feeaccountid,
    t1.tdsapplicable,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.feechargeamt,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.fincategory,
    t1.productcategory,
    t1.roundingtarget,
    t1.grcmaxamount,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis,
    t1.fixedtenorrate,
    t1.fixedratetenor,
    t1.grcadvtype,
    t1.grcadvterms,
    t1.advtype,
    t1.advterms,
    t1.advstage,
    t1.allowdrawingpower,
    t1.allowrevolving,
    t1.appliedLoanAmt
   FROM wiffinancemain t1
     LEFT JOIN wifindicativetermdetail_temp t14 ON t14.finreference = t1.finreference
     LEFT JOIN customers t15 ON t15.custid = t1.custid
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t16 ON t1.finbranch = t16.branchcode
  WHERE NOT (EXISTS ( SELECT 1
           FROM wiffinancemain_temp
          WHERE wiffinancemain_temp.finreference = t1.finreference))
		</createView>
	</changeSet>

	<changeSet id="134_post" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'wiffinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="135_pre" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'wiffinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="135.1" author="Varaprasad.K">
		<createView viewName="wiffinancemain_aview"
			replaceIfExists="true">
			SELECT t1.finreference,
    t1.numberofterms,
    t1.grcperiodenddate,
    t1.allowgrcperiod,
    t1.gracebaserate,
    t1.gracespecialrate,
    t1.grcpftrate,
    t1.grcpftfrq,
    t1.nextgrcpftdate,
    t1.allowgrcpftrvw,
    t1.grcpftrvwfrq,
    t1.nextgrcpftrvwdate,
    t1.allowgrccpz,
    t1.grccpzfrq,
    t1.nextgrccpzdate,
    t1.repaybaserate,
    t1.repayspecialrate,
    t1.repayprofitrate,
    t1.repayfrq,
    t1.nextrepaydate,
    t1.repaypftfrq,
    t1.nextrepaypftdate,
    t1.allowrepayrvw,
    t1.repayrvwfrq,
    t1.nextrepayrvwdate,
    t1.allowrepaycpz,
    t1.repaycpzfrq,
    t1.nextrepaycpzdate,
    t1.maturitydate,
    t1.cpzatgraceend,
    t1.downpayment,
    t1.graceflatamount,
    t1.reqrepayamount,
    t1.totalprofit,
    t1.totalcpz,
    t1.totalgrosspft,
    t1.totalgracepft,
    t1.totalgracecpz,
    t1.grcratebasis,
    t1.repayratebasis,
    t1.fintype,
    t1.finremarks,
    t1.finccy,
    t1.schedulemethod,
    t1.profitdaysbasis,
    t1.reqmaturity,
    t1.calterms,
    t1.calmaturity,
    t1.firstrepay,
    t1.lastrepay,
    t1.finstartdate,
    t1.finamount,
    t1.finrepaymentamount,
    t1.custid,
    t1.defferments,
    t1.plandefercount,
    t1.finisactive,
    t1.version,
    t1.lastmntby,
    t1.lastmnton,
    t1.recordstatus,
    t1.rolecode,
    t1.nextrolecode,
    t1.taskid,
    t1.nexttaskid,
    t1.recordtype,
    t1.workflowid,
    t15.custcif AS lovdesccustcif,
    t7.fintypedesc AS lovdescfintypename,
    t1.finbranch,
    t1.finsourceid,
    t1.alloweddefrpychange,
    t1.availeddefrpychange,
    t1.alloweddeffrqchange,
    t1.availeddeffrqchange,
    t7.finmaxamount AS lovdescfinmaxamt,
    t7.finminamount AS lovdescfinminamount,
    t7.finisalwdifferment AS lovdescfinalwdeferment,
    t1.mindownpayperc,
    t7.finisdwpayrequired AS lovdescdwnpayreq,
    t1.recaltype,
    t1.finassetvalue,
    t7.finmaxdifferment AS lovdescfinmaxdifferment,
    t1.lastrepaydate,
    t1.lastrepaypftdate,
    t1.lastrepayrvwdate,
    t1.lastrepaycpzdate,
    t1.disbaccountid,
    t1.repayaccountid,
    t1.allowgrcrepay,
    t1.grcschdmthd,
    t1.repaymargin,
    t1.grcmargin,
    t1.depreciationfrq,
    t1.fincommitmentref,
    t1.fincurrassetvalue,
    t1.fincontractdate,
    t1.nextdepdate,
    t1.lastdepdate,
    t1.finaccount,
    t1.fincustpftaccount,
    t7.finrvwrateapplfor,
    t1.totalrepayamt,
    t1.closingstatus,
    t1.finapproveddate,
    t1.finrepaypftonfrq,
    t1.anualizedpercrate,
    t1.effectiverateofreturn,
    t1.downpaybank,
    t1.downpaysupl,
    t7.findivision AS lovdescfindivisionname,
    t1.graceterms,
    t14.facilitytype,
    t15.custshrtname AS lovdesccustshrtname,
    t16.branchdesc AS lovdescfinbranchname,
    t1.totalgrossgrcpft,
    t1.grcprofitdaysbasis,
    t1.stepfinance,
    t1.steptype,
    t1.steppolicy,
    t1.alwmanualsteps,
    t1.noofsteps,
    t1.linkedfinref,
    t7.product AS lovdescfinproduct,
    t1.grcminrate,
    t1.grcmaxrate,
    t1.rpyminrate,
    t1.rpymaxrate,
    t1.manualschedule,
    t1.takeoverfinance,
    t1.grcadvbaserate,
    t1.grcadvmargin,
    t1.grcadvpftrate,
    t1.rpyadvbaserate,
    t1.rpyadvmargin,
    t1.rpyadvpftrate,
    t1.supplementrent,
    t1.increasedcost,
    t1.feeaccountid,
    t1.tdsapplicable,
    t1.insuranceamt,
    t1.deductinsdisb,
    t1.alwbpi,
    t1.bpitreatment,
    t1.planemihalw,
    t1.planemihmethod,
    t1.planemihmaxperyear,
    t1.planemihmax,
    t1.planemihlockperiod,
    t1.planemicpz,
    t1.calroundingmode,
    t1.alwmultidisb,
    t1.bpiamount,
    t1.deductfeedisb,
    t1.feechargeamt,
    t1.rvwrateapplfor,
    t1.schcalonrvw,
    t1.pastduepftcalmthd,
    t1.pastduepftmargin,
    t1.droppingmethod,
    t1.ratechganyday,
    t1.roundingtarget,
    t1.grcmaxamount,
    t1.advanceemi,
    t1.advemiterms,
    t1.bpipftdaysbasis AS bpiratebasis,
    t1.grcadvtype,
    t1.grcadvterms,
    t1.advtype,
    t1.advterms,
    t1.advstage,
    t1.allowdrawingpower,
    t1.allowrevolving,
    t1.appliedLoanAmt
   FROM wiffinancemain t1
     LEFT JOIN wifindicativetermdetail_temp t14 ON t14.finreference = t1.finreference
     LEFT JOIN customers t15 ON t15.custid = t1.custid
     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
     LEFT JOIN rmtbranches t16 ON t1.finbranch = t16.branchcode
		</createView>
	</changeSet>

	<changeSet id="135_post" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'wiffinancemain_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="136" author="Varaprasad.K">
		<sql>
            <![CDATA[
                    Delete from secrights where rightname='FinanceMainDialog_AppliedLoanAmt';
                    insert into secrights values ((select max(rightid)+1 from secrights), 3, 'FinanceMainDialog_AppliedLoanAmt','FinanceMainDialog', 1, 1000, current_timestamp, 'Approved',' ',' ',' ',' ',' ',0);
                   
            ]]>
		</sql>
	</changeSet>

	<changeSet id="137" author="satyanarayana.g">
		<createView viewName="RECEIPTDETAILS_VIEW" replaceIfExists="true">
			SELECT T4.CUSTCIF,
					T1.REFERENCE,
					T3.FINTYPE,
					T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTAMOUNT,
					T2.DEPOSITDATE,
					T2.BANKCODE DEPOSITBANK ,
					(
					CASE
					WHEN T1.RECEIPTPURPOSE IN ('EarlyPayment')
					THEN 'Partial Payment'
					ELSE T1.RECEIPTPURPOSE
					END) RECEIPTPURPOSE ,
					T1.RECEIPTMODE,
					T1.BOUNCEDATE CANCELDATE,
					T2.VALUEDATE,
					T2.PAYAGAINSTID,
					T1.BOUNCEDATE,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T3.CLOSINGSTATUS,
					T3.FINBRANCH,
					T3.FINCURRASSETVALUE,
					T3.PRODUCTCATEGORY,
					T6.PARTNERBANKCODE,
					T2.TRANSACTIONREF,
					T2.FUNDINGAC,
					T1.VERSION ,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T5.ROLEDESC LOVDESCREQUESTSTAGE,
					T2.PAYMENTTYPE,
					T1.RECEIPTMODESTATUS,
					T1.ACTFINRECEIPT,
					T2.FAVOURNUMBER
					FROM FINRECEIPTHEADER_TEMP T1
					LEFT JOIN FINRECEIPTDETAIL_TEMP T2 ON T1.RECEIPTID = T2.RECEIPTID
					LEFT JOIN FINANCEMAIN T3 ON T1.REFERENCE = T3.FINREFERENCE
					LEFT JOIN CUSTOMERS T4 ON T3.CUSTID = T4.CUSTID
					INNER JOIN SECROLES T5 ON T1.NEXTROLECODE = T5.ROLECD
					LEFT JOIN PARTNERBANKS T6 ON T6.PARTNERBANKID = T2.FUNDINGAC
					UNION ALL
					SELECT T4.CUSTCIF,
					T1.REFERENCE,
					T3.FINTYPE,
					T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTAMOUNT,
					T2.DEPOSITDATE,
					T2.BANKCODE DEPOSITBANK ,
					(
					CASE
					WHEN T1.RECEIPTPURPOSE IN ('EarlyPayment')
					THEN 'Partial Payment'
					ELSE T1.RECEIPTPURPOSE
					END) RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.BOUNCEDATE CANCELDATE,
					T2.VALUEDATE,
					T2.PAYAGAINSTID,
					T1.BOUNCEDATE,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T3.CLOSINGSTATUS,
					T3.FINBRANCH,
					T3.FINCURRASSETVALUE,
					T3.PRODUCTCATEGORY,
					T6.PARTNERBANKCODE,
					T2.TRANSACTIONREF,
					T2.FUNDINGAC,
					T1.VERSION ,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T5.ROLEDESC LOVDESCREQUESTSTAGE,
					T2.PAYMENTTYPE,
					T1.RECEIPTMODESTATUS,
					T1.ACTFINRECEIPT,
					T2.FAVOURNUMBER
					FROM FINRECEIPTHEADER T1
					LEFT JOIN FINRECEIPTDETAIL T2 ON T1.RECEIPTID = T2.RECEIPTID
					LEFT JOIN FINANCEMAIN T3 ON T1.REFERENCE = T3.FINREFERENCE
					LEFT JOIN CUSTOMERS T4 ON T3.CUSTID = T4.CUSTID
					LEFT JOIN SECROLES T5 ON T1.NEXTROLECODE = T5.ROLECD
					LEFT JOIN PARTNERBANKS T6 ON T6.PARTNERBANKID = T2.FUNDINGAC
					WHERE NOT EXISTS
					(SELECT 1 FROM FINRECEIPTHEADER_TEMP WHERE RECEIPTID = T1.RECEIPTID
					)
		</createView>
	</changeSet>

	<changeSet id="138" author="satyanarayana.g">
		<addColumn tableName="RMTFinanceTypes">
			<column name="FinIsRateRvwAtGrcEnd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="139" author="satyanarayana.g">
		<addColumn tableName="RMTFinanceTypes_temp">
			<column name="FinIsRateRvwAtGrcEnd" type="boolean" />
		</addColumn>
	</changeSet>
	<changeSet id="140" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE RMTFinanceTypes Set FinIsRateRvwAtGrcEnd = 0;
				UPDATE RMTFinanceTypes_Temp Set FinIsRateRvwAtGrcEnd = 0;
			]]>
		</sql>
	</changeSet>

	<changeSet id="141" author="satyanarayana.g" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE RMTFINANCETYPES ADD CONSTRAINT DF_RMTFINANCETYPES_FINRTRVGRSE DEFAULT 0 FOR FINISRATERVWATGRCEND;
				ALTER TABLE RMTFINANCETYPES_TEMP ADD CONSTRAINT DF_RMTFINANCETYPES_TEMP_FINRTRVGRSE DEFAULT 0 FOR FINISRATERVWATGRCEND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="142" author="satyanarayana.g" dbms="postgresql, oracle">
		<addDefaultValue columnName="FinIsRateRvwAtGrcEnd"
			tableName="RMTFinanceTypes" defaultValue="0" />
		<addDefaultValue columnName="FinIsRateRvwAtGrcEnd"
			tableName="RMTFinanceTypes_Temp" defaultValue="0" />
	</changeSet>

	<changeSet id="143_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="143" author="satyanarayana.g">
		<createView viewName="RMTFINANCETYPES_AVIEW"
			replaceIfExists="true">
			SELECT T1.FINTYPE,
					  T1.FINCATEGORY,
					  T1.FINTYPEDESC,
					  T1.FINCCY,
					  T1.FINDAYSCALTYPE,
					  T1.FINACTYPE,
					  T1.FINCONTINGENTACTYPE,
					  T1.FINISGENREF,
					  T1.FINMAXAMOUNT,
					  T1.FINMINAMOUNT,
					  T1.FINISOPENNEWFINAC,
					  T1.FINDFTSTMTFRQ,
					  T1.FINISALWMD,
					  T1.FINSCHDMTHD,
					  T1.FINISALWGRACE,
					  T1.FINHISTRETENSION,
					  T1.EQUALREPAYMENT,
					  T1.FINRATETYPE,
					  T1.FINBASERATE,
					  T1.FINSPLRATE,
					  T1.FININTRATE,
					  T1.FINMINRATE,
					  T1.FINMAXRATE,
					  T1.FINDFTINTFRQ,
					  T1.FINISINTCPZ,
					  T1.FINCPZFRQ,
					  T1.FINISRVWALW,
					  T1.FINRVWFRQ,
					  T1.FINGRCRATETYPE,
					  T1.FINGRCBASERATE,
					  T1.FINGRCSPLRATE,
					  T1.FINGRCINTRATE,
					  T1.FINGRCMINRATE,
					  T1.FINGRCMAXRATE,
					  T1.FINGRCDFTINTFRQ,
					  T1.FINGRCISINTCPZ,
					  T1.FINGRCCPZFRQ,
					  T1.FINGRCISRVWALW,
					  T1.FINGRCRVWFRQ,
					  T1.FINMINTERM,
					  T1.FINMAXTERM,
					  T1.FINDFTTERMS,
					  T1.FINRPYFRQ,
					  T1.FINREPAYMETHOD,
					  T1.FINISALWPARTIALRPY,
					  T1.FINISALWDIFFERMENT,
					  T1.FINMAXDIFFERMENT,
					  T1.FINISALWEARLYRPY,
					  T1.FINISALWEARLYSETTLE,
					  T1.FINODRPYTRIES,
					  T1.FINEARLYPAYRULE,
					  T1.FINEARLYSETTLERULE,
					  T1.FINDEPOSITRESTRICTEDTO,
					  T1.FINAEBUYORINCEPTION,
					  T1.FINAESELLORMATURITY,
					  T1.FINISACTIVE,
					  T1.VERSION,
					  T1.LASTMNTBY,
					  T1.LASTMNTON,
					  T1.RECORDSTATUS,
					  T1.ROLECODE,
					  T1.NEXTROLECODE,
					  T1.TASKID,
					  T1.NEXTTASKID,
					  T1.RECORDTYPE,
					  T1.WORKFLOWID,
					  T1.STEPFINANCE,
					  T1.STEPPINGMANDATORY,
					  T1.ALWMANUALSTEPS,
					  T1.ALWDSTEPPOLICIES,
					  T1.DFTSTEPPOLICY,
					  T4.ACTYPEDESC  LOVDESCFINCONTINGENTACTYPENAME,
					  T5.ACTYPEDESC  LOVDESCFINACTYPENAME,
					  T1.FINISDWPAYREQUIRED,
					  T1.FINRVWRATEAPPLFOR,
					  T1.FINALWRATECHANGEANYDATE,
					  T1.FINISINTCPZATGRCEND,
					  T1.FINELGRULECODE,
					  T1.LIMITELGRULECODE,
					  T1.FINSCHCALCODEONRVW,
					  T1.ALWPLANDEFERMENT,
					  T1.PLANDEFERCOUNT,
					  T1.FINASSETTYPE,
					  T1.PFTPAYACTYPE,
					  T1.FINISOPENPFTPAYACC,
					  T31.ACTYPEDESC  LOVDESCPFTPAYACTYPENAME,
					  T1.FINISALWGRCREPAY,
					  T1.FINGRCSCHDMTHD,
					  T1.FINGRCMARGIN,
					  T1.FINMARGIN,
					  T1.FINSCHEDULEON,
					  T1.FINGRCSCHEDULEON,
					  T1.FINCOMMITMENTREQ,
					  T1.FINCOLLATERALREQ,
					  T1.FINDEPRECIATIONREQ,
					  T1.FINDEPRECIATIONFRQ,
					  T1.FINBANKCONTINGENTACTYPE,
					  T1.FINPROVISIONACTYPE,
					  T38.ACTYPEDESC  LOVDESCFINBANKCONTACTYPENAME,
					  T39.ACTYPEDESC  LOVDESCFINPROVISIONACTYPENAME,
					  T1.ALLOWRIAINVESTMENT,
					  T1.OVERRIDELIMIT,
					  T1.LIMITREQUIRED,
					  T1.FINCOMMITMENTOVRRIDE,
					  T1.FINCOLLATERALOVRRIDE,
					  T1.FINPFTUNCHANGED,
					  T1.APPLYODPENALTY,
					  T1.ODINCGRCDAYS,
					  T1.ODCHARGETYPE,
					  T1.ODGRACEDAYS,
					  T1.ODCHARGECALON,
					  T1.ODCHARGEAMTORPERC,
					  T1.ODALLOWWAIVER,
					  T1.ODMAXWAIVERPERC,
					  T1.FINDIVISION,
					  T48.DIVISIONCODEDESC  LOVDESCFINDIVISIONNAME,
					  T48.ENTITYCODE   LOVDESCENTITYCODE,
					  T1.FINSUSPACTYPE,
					  T49.ACTYPEDESC  LOVDESCFINSUSPACTYPENAME,
					  T1.PRODUCT,
					  T1.STARTDATE,
					  T1.ENDDATE,
					  T1.ALLOWDOWNPAYPGM,
					  T1.REMARKS,
					  T1.ALWEARLYPAYMETHODS,
					  T1.PASTDUEPFTCALMTHD,
					  T1.PASTDUEPFTMARGIN,
					  T1.ALWADVANCERENT,
					  T1.GRCADVBASERATE,
					  T1.GRCADVMARGIN,
					  T1.GRCADVPFTRATE,
					  T1.RPYADVBASERATE,
					  T1.RPYADVMARGIN,
					  T1.RPYADVPFTRATE,
					  T1.ROLLOVERFINANCE,
					  T1.ROLLOVERFRQ,
					  T1.DOWNPAYRULE,
					  T59.RULECODE    DOWNPAYRULECODE,
					  T59.RULECODEDESC  DOWNPAYRULEDESC,
					  T1.FINSUSPTRIGGER,
					  T1.FINSUSPREMARKS,
					  T1.ALWMULTIPARTYDISB,
					  T1.COLLATERALTYPE,
					  T1.TDSAPPLICABLE,
					  T1.MANUALSCHEDULE,
					  T1.APPLYGRCPRICING,
					  T1.GRCPRICINGMETHOD,
					  T1.APPLYRPYPRICING,
					  T1.RPYPRICINGMETHOD,
					  T1.RPYHIERARCHY,
					  T67.RULECODE  GRCPRICINGMETHODDESC,
					  T68.RULECODE  RPYPRICINGMETHODDESC,
					  T1.DROPLINEOD,
					  T1.DROPPINGMETHOD,
					  T1.RATECHGANYDAY,
					  T1.FINREPAYPFTONFRQ,
					  T1.ALWBPI,
					  T1.BPITREATMENT,
					  T1.PFTDUESCHON,
					  T1.PLANEMIHALW,
					  T1.PLANEMIHMETHOD,
					  T1.PLANEMIHMAXPERYEAR,
					  T1.PLANEMIHMAX,
					  T1.PLANEMIHLOCKPERIOD,
					  T1.PLANEMICPZ,
					  T1.UNPLANEMIHLOCKPERIOD,
					  T1.UNPLANEMICPZ,
					  T1.REAGECPZ,
					  T1.FDDLOCKPERIOD,
					  T1.ALWDRPYMETHODS,
					  T1.MAXUNPLANNEDEMI,
					  T1.MAXREAGEHOLIDAYS,
					  T1.ROUNDINGMODE,
					  T1.ROUNDINGTARGET,
					  T1.FREQUENCYDAYS,
					  T1.QUICKDISB,
					  T1.ALWREAGE,
					  T1.ALWUNPLANEMIHOLIDAY,
					  T1.ALWMAXDISBCHECKREQ,
					  T1.FINTYPEDESC LOVDESCPROMOFINTYPEDESC,
					  T1.PROFITCENTERID,
					  T69.PROFITCENTERCODE,
					  T69.PROFITCENTERDESC,
					  T1.PRODUCTCATEGORY,
					  T2.PRODUCTDESC  FINCATEGORYDESC,
					  T1.DEVELOPERFINANCE,
					  T1.COSTOFFUNDS,
					  T1.CHEQUECAPTUREREQ,
					  T1.FINLTVCHECK,
					  T1.PARTIALLYSECURED,
					  T1.ALWADVEMI,
					  T1.ADVEMIMINTERMS,
					  T1.ADVEMIMAXTERMS,
					  T1.ADVEMIDFTTERMS,
					  T1.ADVEMISCHDMTHD,
					  T1.BPIPFTDAYSBASIS,
					  T1.ELIGIBILITYMETHODS,
					  T1.ALWHYBRIDRATE,
					  T1.FIXEDRATETENOR,
					  T1.ODMINCAPAMOUNT,
					  T1.ODRULECODE,
					  T1.ALWZEROINTACC,
					  T1.AUTOREJECTIONDAYS,
					  T1.TAXNOMAND,
					  T1.PUTCALLREQUIRED,
					  T1.GRCADVINTERSETREQ,
					  T1.GRCADVTYPE,
					  T1.GRCADVMINTERMS,
					  T1.GRCADVMAXTERMS,
					  T1.GRCADVDEFAULTTERMS,
					  T1.ADVINTERSETREQ,
					  T1.ADVTYPE,
					  T1.ADVMINTERMS,
					  T1.ADVMAXTERMS,
					  T1.ADVDEFAULTTERMS,
					  T1.ADVSTAGE,
					  T1.DSFREQ,
					  T1.CASHCOLLATERALREQ,
					  T1.TDSALLOWTOMODIFY,
					  T1.TDSAPPLICABLETO,
					  T1.ALWVAN,
					  T1.VANALLOCATIONMETHOD,
					  T1.ALLOWDRAWINGPOWER,
					  T1.ALLOWREVOLVING,
					  T1.ALWSANCTIONAMT,
					  T1.ALWSANCTIONAMTOVERRIDE,
					  T1.SANBSDSCHDLE,
					  T1.FINISRATERVWATGRCEND
					FROM RMTFINANCETYPES T1
					LEFT JOIN BMTPRODUCT T2 ON T1.FINCATEGORY = T2.PRODUCTCODE
					LEFT JOIN RMTACCOUNTTYPES T4 ON T1.FINCONTINGENTACTYPE = T4.ACTYPE
					LEFT JOIN RMTACCOUNTTYPES T38 ON T1.FINBANKCONTINGENTACTYPE = T38.ACTYPE
					LEFT JOIN RMTACCOUNTTYPES T39 ON T1.FINPROVISIONACTYPE = T39.ACTYPE
					LEFT JOIN RMTACCOUNTTYPES T5 ON T1.FINACTYPE = T5.ACTYPE
					LEFT JOIN RMTACCOUNTTYPES T31 ON T1.PFTPAYACTYPE = T31.ACTYPE
					LEFT JOIN SMTDIVISIONDETAIL T48 ON T1.FINDIVISION = T48.DIVISIONCODE
					LEFT JOIN RMTACCOUNTTYPES T49 ON T1.FINSUSPACTYPE = T49.ACTYPE
					LEFT JOIN RULES T59 ON T1.DOWNPAYRULE = T59.RULEID
					LEFT JOIN RULES T67 ON T1.GRCPRICINGMETHOD = T67.RULEID
					LEFT JOIN RULES T68 ON T1.RPYPRICINGMETHOD = T68.RULEID
					LEFT JOIN PROFITCENTERS T69 ON T69.PROFITCENTERID = T1.PROFITCENTERID
	</createView>
	</changeSet>

	<changeSet id="143_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="144_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_orgview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="144" author="satyanarayana.g">
		<createView viewName="RMTFINANCETYPES_ORGVIEW "
			replaceIfExists="true">	 
			SELECT T1.FINTYPE,
				  T1.FINCATEGORY,
				  T1.FINTYPEDESC,
				  T1.FINCCY,
				  T1.FINDAYSCALTYPE,
				  T1.FINACTYPE,
				  T1.FINCONTINGENTACTYPE,
				  T1.FINISGENREF,
				  T1.FINMAXAMOUNT,
				  T1.FINMINAMOUNT,
				  T1.FINISOPENNEWFINAC,
				  T1.FINISALWMD,
				  T1.FINSCHDMTHD,
				  T1.FINISALWGRACE,
				  T1.EQUALREPAYMENT,
				  T1.FINRATETYPE,
				  T1.FINBASERATE,
				  T1.FINSPLRATE,
				  T1.FININTRATE,
				  T1.FINMINRATE,
				  T1.FINMAXRATE,
				  T1.FINDFTINTFRQ,
				  T1.FINISINTCPZ,
				  T1.FINCPZFRQ,
				  T1.FINISRVWALW,
				  T1.FINRVWFRQ,
				  T1.FINGRCRATETYPE,
				  T1.FINGRCBASERATE,
				  T1.FINGRCSPLRATE,
				  T1.FINGRCINTRATE,
				  T1.FINGRCMINRATE,
				  T1.FINGRCMAXRATE,
				  T1.FINGRCDFTINTFRQ,
				  T1.FINGRCISINTCPZ,
				  T1.FINGRCCPZFRQ,
				  T1.FINGRCISRVWALW,
				  T1.FINGRCRVWFRQ,
				  T1.FINMINTERM,
				  T1.FINMAXTERM,
				  T1.FINDFTTERMS,
				  T1.FINRPYFRQ,
				  T1.FINREPAYMETHOD,
				  T1.FINISALWDIFFERMENT,
				  T1.FINMAXDIFFERMENT,
				  T1.FINISACTIVE,
				  T1.STEPFINANCE,
				  T1.STEPPINGMANDATORY,
				  T1.ALWMANUALSTEPS,
				  T1.ALWDSTEPPOLICIES,
				  T1.DFTSTEPPOLICY,
				  T1.FINISDWPAYREQUIRED,
				  T1.FINRVWRATEAPPLFOR,
				  T1.FINALWRATECHANGEANYDATE,
				  T1.FINISINTCPZATGRCEND,
				  T1.FINSCHCALCODEONRVW,
				  T1.ALWPLANDEFERMENT,
				  T1.PLANDEFERCOUNT,
				  T1.PFTPAYACTYPE,
				  T1.FINISOPENPFTPAYACC,
				  T1.FINISALWGRCREPAY,
				  T1.FINGRCSCHDMTHD,
				  T1.FINGRCMARGIN,
				  T1.FINMARGIN,
				  T1.FINCOMMITMENTREQ,
				  T1.FINCOLLATERALREQ,
				  T1.FINDEPRECIATIONREQ,
				  T1.FINDEPRECIATIONFRQ,
				  T1.FINBANKCONTINGENTACTYPE,
				  T1.FINPROVISIONACTYPE,
				  T1.ALLOWRIAINVESTMENT,
				  T1.OVERRIDELIMIT,
				  T1.LIMITREQUIRED,
				  T1.FINCOMMITMENTOVRRIDE,
				  T1.FINCOLLATERALOVRRIDE,
				  T1.FINREPAYPFTONFRQ,
				  T1.FINPFTUNCHANGED,
				  T1.APPLYODPENALTY,
				  T1.ODINCGRCDAYS,
				  T1.ODCHARGETYPE,
				  T1.ODGRACEDAYS,
				  T1.ODCHARGECALON,
				  T1.ODCHARGEAMTORPERC,
				  T1.ODALLOWWAIVER,
				  T1.ODMAXWAIVERPERC,
				  T1.FINDIVISION,
				  T3.DIVISIONCODEDESC  LOVDESCFINDIVISIONNAME,
				  T1.FINSUSPACTYPE,
				  T1.PRODUCT,
				  T1.STARTDATE,
				  T1.ENDDATE,
				  T1.ALLOWDOWNPAYPGM,
				  T1.FINTYPEDESC  LOVDESCPROMOFINTYPEDESC,
				  T1.REMARKS,
				  T4.POLICYDESC  LOVDESCDFTSTEPPOLICYNAME,
				  T1.PASTDUEPFTCALMTHD,
				  T1.PASTDUEPFTMARGIN,
				  T1.ALWADVANCERENT,
				  T1.GRCADVBASERATE,
				  T1.GRCADVMARGIN,
				  T1.GRCADVPFTRATE,
				  T1.RPYADVBASERATE,
				  T1.RPYADVMARGIN,
				  T1.RPYADVPFTRATE,
				  T1.ROLLOVERFINANCE,
				  T1.ROLLOVERFRQ,
				  T1.DOWNPAYRULE,
				  T1.ALWMULTIPARTYDISB,
				  T1.COLLATERALTYPE,
				  T1.TDSAPPLICABLE,
				  T5.RULECODE  DOWNPAYRULECODE,
				  T5.RULECODEDESC  DOWNPAYRULEDESC,
				  T1.APPLYGRCPRICING,
				  T1.APPLYRPYPRICING,
				  T6.RULECODE  GRCPRICINGMETHODDESC,
				  T7.RULECODE  RPYPRICINGMETHODDESC,
				  T1.DROPLINEOD,
				  T1.DROPPINGMETHOD,
				  T1.RATECHGANYDAY,
				  T4.STEPTYPE  DFTSTEPPOLICYTYPE,
				  T1.MANUALSCHEDULE,
				  T1.ALWBPI,
				  T1.BPITREATMENT,
				  T1.PFTDUESCHON,
				  T1.PLANEMIHALW,
				  T1.PLANEMIHMETHOD,
				  T1.PLANEMIHMAXPERYEAR,
				  T1.PLANEMIHMAX,
				  T1.PLANEMIHLOCKPERIOD,
				  T1.PLANEMICPZ,
				  T1.UNPLANEMIHLOCKPERIOD,
				  T1.UNPLANEMICPZ,
				  T1.REAGECPZ,
				  T1.FDDLOCKPERIOD,
				  T1.ALWDRPYMETHODS,
				  T1.MAXUNPLANNEDEMI,
				  T1.MAXREAGEHOLIDAYS,
				  T1.ROUNDINGMODE,
				  T1.ROUNDINGTARGET,
				  T1.FREQUENCYDAYS,
				  T1.QUICKDISB,
				  T1.ALWREAGE,
				  T1.ALWUNPLANEMIHOLIDAY,
				  T1.ALWMAXDISBCHECKREQ,
				  T1.PRODUCTCATEGORY,
				  T1.RPYHIERARCHY,
				  T1.DEVELOPERFINANCE,
				  T3.ENTITYCODE  LOVDESCENTITYCODE,
				  T8.ENTITYDESC  LOVDESCENTITYDESC,
				  T1.COSTOFFUNDS,
				  T1.CHEQUECAPTUREREQ,
				  T1.FINLTVCHECK,
				  T1.PARTIALLYSECURED,
				  T1.ALWADVEMI,
				  T1.ADVEMIMINTERMS,
				  T1.ADVEMIMAXTERMS,
				  T1.ADVEMIDFTTERMS,
				  T1.ADVEMISCHDMTHD,
				  T1.BPIPFTDAYSBASIS,
				  T1.ELIGIBILITYMETHODS,
				  T1.ALWHYBRIDRATE,
				  T1.FIXEDRATETENOR,
				  T1.ODMINCAPAMOUNT,
				  T1.ODRULECODE,
				  T1.ALWZEROINTACC,
				  T1.FINISALWPARTIALRPY,
				  T1.AUTOREJECTIONDAYS,
				  T1.TAXNOMAND,
				  T1.PUTCALLREQUIRED,
				  T1.GRCADVINTERSETREQ,
				  T1.GRCADVTYPE,
				  T1.GRCADVMINTERMS,
				  T1.GRCADVMAXTERMS,
				  T1.GRCADVDEFAULTTERMS,
				  T1.ADVINTERSETREQ,
				  T1.ADVTYPE,
				  T1.ADVMINTERMS,
				  T1.ADVMAXTERMS,
				  T1.ADVDEFAULTTERMS,
				  T1.ADVSTAGE,
				  T1.DSFREQ,
				  T1.CASHCOLLATERALREQ,
				  T1.ALWEARLYPAYMETHODS,
				  T1.TDSALLOWTOMODIFY,
				  T1.TDSAPPLICABLETO,
				  T1.ALWVAN,
				  T1.VANALLOCATIONMETHOD,
				  T1.ALLOWDRAWINGPOWER,
				  T1.ALLOWREVOLVING,
				  T1.ALWSANCTIONAMT,
				  T1.ALWSANCTIONAMTOVERRIDE,
				  T1.SANBSDSCHDLE,
				  T1.FINISRATERVWATGRCEND
				FROM RMTFINANCETYPES T1
				JOIN SMTDIVISIONDETAIL T3 ON T1.FINDIVISION = T3.DIVISIONCODE
				LEFT JOIN STEPPOLICYHEADER T4 ON T1.DFTSTEPPOLICY = T4.POLICYCODE
				LEFT JOIN RULES T5 ON T1.DOWNPAYRULE = T5.RULEID
				LEFT JOIN RULES T6 ON T1.GRCPRICINGMETHOD = T6.RULEID
				LEFT JOIN RULES T7 ON T1.RPYPRICINGMETHOD = T7.RULEID
				LEFT JOIN ENTITY T8 ON T3.ENTITYCODE = T8.ENTITYCODE 
		</createView>
	</changeSet>

	<changeSet id="144_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_orgview');
					
			]]>
		</sql>
	</changeSet>

	<changeSet id="145_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="145" author="satyanarayana.g">
		<createView viewName="RMTFINANCETYPES_VIEW "
			replaceIfExists="true">	 	 
			SELECT T1.FINTYPE,
				    T1.FINCATEGORY,
				    T1.FINTYPEDESC,
				    T1.FINCCY,
				    T1.FINDAYSCALTYPE,
				    T1.FINACTYPE,
				    T1.FINCONTINGENTACTYPE,
				    T1.FINISGENREF,
				    T1.FINMAXAMOUNT,
				    T1.FINMINAMOUNT,
				    T1.FINISOPENNEWFINAC,
				    T1.FINDFTSTMTFRQ,
				    T1.FINISALWMD,
				    T1.FINSCHDMTHD,
				    T1.FINISALWGRACE,
				    T1.FINHISTRETENSION,
				    T1.EQUALREPAYMENT,
				    T1.FINRATETYPE,
				    T1.FINBASERATE,
				    T1.FINSPLRATE,
				    T1.FININTRATE,
				    T1.FINMINRATE,
				    T1.FINMAXRATE,
				    T1.FINDFTINTFRQ,
				    T1.FINISINTCPZ,
				    T1.FINCPZFRQ,
				    T1.FINISRVWALW,
				    T1.FINRVWFRQ,
				    T1.FINGRCRATETYPE,
				    T1.FINGRCBASERATE,
				    T1.FINGRCSPLRATE,
				    T1.FINGRCINTRATE,
				    T1.FINGRCMINRATE,
				    T1.FINGRCMAXRATE,
				    T1.FINGRCDFTINTFRQ,
				    T1.FINGRCISINTCPZ,
				    T1.FINGRCCPZFRQ,
				    T1.FINGRCISRVWALW,
				    T1.FINGRCRVWFRQ,
				    T1.FINMINTERM,
				    T1.FINMAXTERM,
				    T1.FINDFTTERMS,
				    T1.FINRPYFRQ,
				    T1.FINREPAYMETHOD,
				    T1.FINISALWPARTIALRPY,
				    T1.FINISALWDIFFERMENT,
				    T1.FINMAXDIFFERMENT,
				    T1.FINISALWEARLYRPY,
				    T1.FINISALWEARLYSETTLE,
				    T1.FINODRPYTRIES,
				    T1.FINEARLYPAYRULE,
				    T1.FINEARLYSETTLERULE,
				    T1.FINDEPOSITRESTRICTEDTO,
				    T1.FINAEBUYORINCEPTION,
				    T1.FINAESELLORMATURITY,
				    T1.FINISACTIVE,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T1.STEPFINANCE,
				    T1.STEPPINGMANDATORY,
				    T1.ALWMANUALSTEPS,
				    T1.ALWDSTEPPOLICIES,
				    T1.DFTSTEPPOLICY,
				    T4.ACTYPEDESC  LOVDESCFINCONTINGENTACTYPENAME,
				    T5.ACTYPEDESC  LOVDESCFINACTYPENAME,
				    T1.FINISDWPAYREQUIRED,
				    T1.FINRVWRATEAPPLFOR,
				    T1.FINALWRATECHANGEANYDATE,
				    T1.FINISINTCPZATGRCEND,
				    T1.FINELGRULECODE,
				    T1.LIMITELGRULECODE,
				    T1.FINSCHCALCODEONRVW,
				    T1.ALWPLANDEFERMENT,
				    T1.PLANDEFERCOUNT,
				    T1.FINASSETTYPE,
				    T1.PFTPAYACTYPE,
				    T1.FINISOPENPFTPAYACC,
				    T31.ACTYPEDESC  LOVDESCPFTPAYACTYPENAME,
				    T1.FINISALWGRCREPAY,
				    T1.FINGRCSCHDMTHD,
				    T1.FINGRCMARGIN,
				    T1.FINMARGIN,
				    T1.FINSCHEDULEON,
				    T1.FINGRCSCHEDULEON,
				    T1.FINCOMMITMENTREQ,
				    T1.FINCOLLATERALREQ,
				    T1.FINDEPRECIATIONREQ,
				    T1.FINDEPRECIATIONFRQ,
				    T1.FINBANKCONTINGENTACTYPE,
				    T1.FINPROVISIONACTYPE,
				    T38.ACTYPEDESC  LOVDESCFINBANKCONTACTYPENAME,
				    T39.ACTYPEDESC  LOVDESCFINPROVISIONACTYPENAME,
				    T1.ALLOWRIAINVESTMENT,
				    T1.OVERRIDELIMIT,
				    T1.LIMITREQUIRED,
				    T1.FINCOMMITMENTOVRRIDE,
				    T1.FINCOLLATERALOVRRIDE,
				    T1.FINPFTUNCHANGED,
				    T1.APPLYODPENALTY,
				    T1.ODINCGRCDAYS,
				    T1.ODCHARGETYPE,
				    T1.ODGRACEDAYS,
				    T1.ODCHARGECALON,
				    T1.ODCHARGEAMTORPERC,
				    T1.ODALLOWWAIVER,
				    T1.ODMAXWAIVERPERC,
				    T1.FINDIVISION,
				    T48.DIVISIONCODEDESC  LOVDESCFINDIVISIONNAME,
				    T48.ENTITYCODE  LOVDESCENTITYCODE,
				    T1.FINSUSPACTYPE,
				    T49.ACTYPEDESC  LOVDESCFINSUSPACTYPENAME,
				    T1.PRODUCT,
				    T1.STARTDATE,
				    T1.ENDDATE,
				    T1.ALLOWDOWNPAYPGM,
				    T1.FINTYPEDESC  LOVDESCPROMOFINTYPEDESC,
				    T1.REMARKS,
				    T1.ALWEARLYPAYMETHODS,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.ALWADVANCERENT,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.ROLLOVERFINANCE,
				    T1.ROLLOVERFRQ,
				    T1.DOWNPAYRULE,
				    T59.RULECODE  DOWNPAYRULECODE,
				    T59.RULECODEDESC  DOWNPAYRULEDESC,
				    T1.FINSUSPTRIGGER,
				    T1.FINSUSPREMARKS,
				    T1.ALWMULTIPARTYDISB,
				    T1.COLLATERALTYPE,
				    T1.TDSAPPLICABLE,
				    T1.MANUALSCHEDULE,
				    T1.APPLYGRCPRICING,
				    T1.GRCPRICINGMETHOD,
				    T1.APPLYRPYPRICING,
				    T1.RPYPRICINGMETHOD,
				    T1.RPYHIERARCHY,
				    T67.RULECODE  GRCPRICINGMETHODDESC,
				    T68.RULECODE  RPYPRICINGMETHODDESC,
				    T1.DROPLINEOD,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.FINREPAYPFTONFRQ,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PFTDUESCHON,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.FDDLOCKPERIOD,
				    T1.ALWDRPYMETHODS,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.ROUNDINGMODE,
				    T1.ROUNDINGTARGET,
				    T1.FREQUENCYDAYS,
				    T1.QUICKDISB,
				    T1.ALWMAXDISBCHECKREQ,
				    T1.ALWREAGE,
				    T1.ALWUNPLANEMIHOLIDAY,
				    T1.PROFITCENTERID,
				    T69.PROFITCENTERCODE,
				    T69.PROFITCENTERDESC,
				    T1.PRODUCTCATEGORY,
				    T2.PRODUCTDESC AS FINCATEGORYDESC,
				    T1.DEVELOPERFINANCE,
				    T1.COSTOFFUNDS,
				    T1.CHEQUECAPTUREREQ,
				    T1.FINLTVCHECK,
				    T1.PARTIALLYSECURED,
				    T1.ALWADVEMI,
				    T1.ADVEMIMINTERMS,
				    T1.ADVEMIMAXTERMS,
				    T1.ADVEMIDFTTERMS,
				    T1.ADVEMISCHDMTHD,
				    T1.BPIPFTDAYSBASIS,
				    T1.ELIGIBILITYMETHODS,
				    T1.ALWHYBRIDRATE,
				    T1.FIXEDRATETENOR,
				    T1.ODMINCAPAMOUNT,
				    T1.ODRULECODE,
				    T1.ALWZEROINTACC,
				    T1.AUTOREJECTIONDAYS,
				    T1.TAXNOMAND,
				    T1.PUTCALLREQUIRED,
				    T1.GRCADVINTERSETREQ,
				    T1.GRCADVTYPE,
				    T1.GRCADVMINTERMS,
				    T1.GRCADVMAXTERMS,
				    T1.GRCADVDEFAULTTERMS,
				    T1.ADVINTERSETREQ,
				    T1.ADVTYPE,
				    T1.ADVMINTERMS,
				    T1.ADVMAXTERMS,
				    T1.ADVDEFAULTTERMS,
				    T1.ADVSTAGE,
				    T1.DSFREQ,
				    T1.CASHCOLLATERALREQ,
				    T1.TDSALLOWTOMODIFY,
				    T1.TDSAPPLICABLETO,
				    T1.ALWVAN,
				    T1.VANALLOCATIONMETHOD,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.ALWSANCTIONAMT,
				    T1.ALWSANCTIONAMTOVERRIDE,
				    T1.SANBSDSCHDLE,
				    T1.FINISRATERVWATGRCEND
				   FROM RMTFINANCETYPES_TEMP T1
				     LEFT JOIN BMTPRODUCT T2 ON T1.FINCATEGORY = T2.PRODUCTCODE
				     LEFT JOIN RMTACCOUNTTYPES T4 ON T1.FINCONTINGENTACTYPE = T4.ACTYPE
				     LEFT JOIN RMTACCOUNTTYPES T38 ON T1.FINBANKCONTINGENTACTYPE = T38.ACTYPE
				     LEFT JOIN RMTACCOUNTTYPES T39 ON T1.FINPROVISIONACTYPE = T39.ACTYPE
				     LEFT JOIN RMTACCOUNTTYPES T5 ON T1.FINACTYPE = T5.ACTYPE
				     LEFT JOIN RMTACCOUNTTYPES T31 ON T1.PFTPAYACTYPE = T31.ACTYPE
				     LEFT JOIN SMTDIVISIONDETAIL T48 ON T1.FINDIVISION = T48.DIVISIONCODE
				     LEFT JOIN RMTACCOUNTTYPES T49 ON T1.FINSUSPACTYPE = T49.ACTYPE
				     LEFT JOIN RULES T59 ON T1.DOWNPAYRULE = T59.RULEID
				     LEFT JOIN RULES T67 ON T1.GRCPRICINGMETHOD = T67.RULEID
				     LEFT JOIN RULES T68 ON T1.RPYPRICINGMETHOD = T68.RULEID
				     LEFT JOIN PROFITCENTERS T69 ON T69.PROFITCENTERID = T1.PROFITCENTERID
				UNION ALL
				 SELECT T1.FINTYPE,
				    T1.FINCATEGORY,
				    T1.FINTYPEDESC,
				    T1.FINCCY,
				    T1.FINDAYSCALTYPE,
				    T1.FINACTYPE,
				    T1.FINCONTINGENTACTYPE,
				    T1.FINISGENREF,
				    T1.FINMAXAMOUNT,
				    T1.FINMINAMOUNT,
				    T1.FINISOPENNEWFINAC,
				    T1.FINDFTSTMTFRQ,
				    T1.FINISALWMD,
				    T1.FINSCHDMTHD,
				    T1.FINISALWGRACE,
				    T1.FINHISTRETENSION,
				    T1.EQUALREPAYMENT,
				    T1.FINRATETYPE,
				    T1.FINBASERATE,
				    T1.FINSPLRATE,
				    T1.FININTRATE,
				    T1.FINMINRATE,
				    T1.FINMAXRATE,
				    T1.FINDFTINTFRQ,
				    T1.FINISINTCPZ,
				    T1.FINCPZFRQ,
				    T1.FINISRVWALW,
				    T1.FINRVWFRQ,
				    T1.FINGRCRATETYPE,
				    T1.FINGRCBASERATE,
				    T1.FINGRCSPLRATE,
				    T1.FINGRCINTRATE,
				    T1.FINGRCMINRATE,
				    T1.FINGRCMAXRATE,
				    T1.FINGRCDFTINTFRQ,
				    T1.FINGRCISINTCPZ,
				    T1.FINGRCCPZFRQ,
				    T1.FINGRCISRVWALW,
				    T1.FINGRCRVWFRQ,
				    T1.FINMINTERM,
				    T1.FINMAXTERM,
				    T1.FINDFTTERMS,
				    T1.FINRPYFRQ,
				    T1.FINREPAYMETHOD,
				    T1.FINISALWPARTIALRPY,
				    T1.FINISALWDIFFERMENT,
				    T1.FINMAXDIFFERMENT,
				    T1.FINISALWEARLYRPY,
				    T1.FINISALWEARLYSETTLE,
				    T1.FINODRPYTRIES,
				    T1.FINEARLYPAYRULE,
				    T1.FINEARLYSETTLERULE,
				    T1.FINDEPOSITRESTRICTEDTO,
				    T1.FINAEBUYORINCEPTION,
				    T1.FINAESELLORMATURITY,
				    T1.FINISACTIVE,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T1.STEPFINANCE,
				    T1.STEPPINGMANDATORY,
				    T1.ALWMANUALSTEPS,
				    T1.ALWDSTEPPOLICIES,
				    T1.DFTSTEPPOLICY,
				    T4.ACTYPEDESC  LOVDESCFINCONTINGENTACTYPENAME,
				    T5.ACTYPEDESC  LOVDESCFINACTYPENAME,
				    T1.FINISDWPAYREQUIRED,
				    T1.FINRVWRATEAPPLFOR,
				    T1.FINALWRATECHANGEANYDATE,
				    T1.FINISINTCPZATGRCEND,
				    T1.FINELGRULECODE,
				    T1.LIMITELGRULECODE,
				    T1.FINSCHCALCODEONRVW,
				    T1.ALWPLANDEFERMENT,
				    T1.PLANDEFERCOUNT,
				    T1.FINASSETTYPE,
				    T1.PFTPAYACTYPE,
				    T1.FINISOPENPFTPAYACC,
				    T31.ACTYPEDESC  LOVDESCPFTPAYACTYPENAME,
				    T1.FINISALWGRCREPAY,
				    T1.FINGRCSCHDMTHD,
				    T1.FINGRCMARGIN,
				    T1.FINMARGIN,
				    T1.FINSCHEDULEON,
				    T1.FINGRCSCHEDULEON,
				    T1.FINCOMMITMENTREQ,
				    T1.FINCOLLATERALREQ,
				    T1.FINDEPRECIATIONREQ,
				    T1.FINDEPRECIATIONFRQ,
				    T1.FINBANKCONTINGENTACTYPE,
				    T1.FINPROVISIONACTYPE,
				    T38.ACTYPEDESC  LOVDESCFINBANKCONTACTYPENAME,
				    T39.ACTYPEDESC  LOVDESCFINPROVISIONACTYPENAME,
				    T1.ALLOWRIAINVESTMENT,
				    T1.OVERRIDELIMIT,
				    T1.LIMITREQUIRED,
				    T1.FINCOMMITMENTOVRRIDE,
				    T1.FINCOLLATERALOVRRIDE,
				    T1.FINPFTUNCHANGED,
				    T1.APPLYODPENALTY,
				    T1.ODINCGRCDAYS,
				    T1.ODCHARGETYPE,
				    T1.ODGRACEDAYS,
				    T1.ODCHARGECALON,
				    T1.ODCHARGEAMTORPERC,
				    T1.ODALLOWWAIVER,
				    T1.ODMAXWAIVERPERC,
				    T1.FINDIVISION,
				    T48.DIVISIONCODEDESC  LOVDESCFINDIVISIONNAME,
				    T48.ENTITYCODE  LOVDESCENTITYCODE,
				    T1.FINSUSPACTYPE,
				    T49.ACTYPEDESC  LOVDESCFINSUSPACTYPENAME,
				    T1.PRODUCT,
				    T1.STARTDATE,
				    T1.ENDDATE,
				    T1.ALLOWDOWNPAYPGM,
				    T1.FINTYPEDESC  LOVDESCPROMOFINTYPEDESC,
				    T1.REMARKS,
				    T1.ALWEARLYPAYMETHODS,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.ALWADVANCERENT,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.ROLLOVERFINANCE,
				    T1.ROLLOVERFRQ,
				    T1.DOWNPAYRULE,
				    T59.RULECODE  DOWNPAYRULECODE,
				    T59.RULECODEDESC  DOWNPAYRULEDESC,
				    T1.FINSUSPTRIGGER,
				    T1.FINSUSPREMARKS,
				    T1.ALWMULTIPARTYDISB,
				    T1.COLLATERALTYPE,
				    T1.TDSAPPLICABLE,
				    T1.MANUALSCHEDULE,
				    T1.APPLYGRCPRICING,
				    T1.GRCPRICINGMETHOD,
				    T1.APPLYRPYPRICING,
				    T1.RPYPRICINGMETHOD,
				    T1.RPYHIERARCHY,
				    T67.RULECODE  GRCPRICINGMETHODDESC,
				    T68.RULECODE  RPYPRICINGMETHODDESC,
				    T1.DROPLINEOD,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.FINREPAYPFTONFRQ,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PFTDUESCHON,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.FDDLOCKPERIOD,
				    T1.ALWDRPYMETHODS,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.ROUNDINGMODE,
				    T1.ROUNDINGTARGET,
				    T1.FREQUENCYDAYS,
				    T1.QUICKDISB,
				    T1.ALWMAXDISBCHECKREQ,
				    T1.ALWREAGE,
				    T1.ALWUNPLANEMIHOLIDAY,
				    T1.PROFITCENTERID,
				    T69.PROFITCENTERCODE,
				    T69.PROFITCENTERDESC,
				    T1.PRODUCTCATEGORY,
				    T2.PRODUCTDESC  FINCATEGORYDESC,
				    T1.DEVELOPERFINANCE,
				    T1.COSTOFFUNDS,
				    T1.CHEQUECAPTUREREQ,
				    T1.FINLTVCHECK,
				    T1.PARTIALLYSECURED,
				    T1.ALWADVEMI,
				    T1.ADVEMIMINTERMS,
				    T1.ADVEMIMAXTERMS,
				    T1.ADVEMIDFTTERMS,
				    T1.ADVEMISCHDMTHD,
				    T1.BPIPFTDAYSBASIS,
				    T1.ELIGIBILITYMETHODS,
				    T1.ALWHYBRIDRATE,
				    T1.FIXEDRATETENOR,
				    T1.ODMINCAPAMOUNT,
				    T1.ODRULECODE,
				    T1.ALWZEROINTACC,
				    T1.AUTOREJECTIONDAYS,
				    T1.TAXNOMAND,
				    T1.PUTCALLREQUIRED,
				    T1.GRCADVINTERSETREQ,
				    T1.GRCADVTYPE,
				    T1.GRCADVMINTERMS,
				    T1.GRCADVMAXTERMS,
				    T1.GRCADVDEFAULTTERMS,
				    T1.ADVINTERSETREQ,
				    T1.ADVTYPE,
				    T1.ADVMINTERMS,
				    T1.ADVMAXTERMS,
				    T1.ADVDEFAULTTERMS,
				    T1.ADVSTAGE,
				    T1.DSFREQ,
				    T1.CASHCOLLATERALREQ,
				    T1.TDSALLOWTOMODIFY,
				    T1.TDSAPPLICABLETO,
				    T1.ALWVAN,
				    T1.VANALLOCATIONMETHOD,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.ALWSANCTIONAMT,
				    T1.ALWSANCTIONAMTOVERRIDE,
				    T1.SANBSDSCHDLE,
				    T1.FINISRATERVWATGRCEND
				   FROM RMTFINANCETYPES T1
				     LEFT JOIN BMTPRODUCT T2 ON T1.FINCATEGORY = T2.PRODUCTCODE
				     LEFT JOIN RMTACCOUNTTYPES T4 ON T1.FINCONTINGENTACTYPE = T4.ACTYPE
				     LEFT JOIN RMTACCOUNTTYPES T38 ON T1.FINBANKCONTINGENTACTYPE = T38.ACTYPE
				     LEFT JOIN RMTACCOUNTTYPES T39 ON T1.FINPROVISIONACTYPE = T39.ACTYPE
				     LEFT JOIN RMTACCOUNTTYPES T5 ON T1.FINACTYPE = T5.ACTYPE
				     LEFT JOIN RMTACCOUNTTYPES T31 ON T1.PFTPAYACTYPE = T31.ACTYPE
				     LEFT JOIN SMTDIVISIONDETAIL T48 ON T1.FINDIVISION = T48.DIVISIONCODE
				     LEFT JOIN RMTACCOUNTTYPES T49 ON T1.FINSUSPACTYPE = T49.ACTYPE
				     LEFT JOIN RULES T59 ON T1.DOWNPAYRULE = T59.RULEID
				     LEFT JOIN RULES T67 ON T1.GRCPRICINGMETHOD = T67.RULEID
				     LEFT JOIN RULES T68 ON T1.RPYPRICINGMETHOD = T68.RULEID
				     LEFT JOIN PROFITCENTERS T69 ON T69.PROFITCENTERID = T1.PROFITCENTERID
				  WHERE NOT (EXISTS ( SELECT 1 AS EXPR1  FROM RMTFINANCETYPES_TEMP WHERE RMTFINANCETYPES_TEMP.FINTYPE = T1.FINTYPE))			  
		  </createView>
	</changeSet>

	<changeSet id="145_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="146" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE RMTFinanceTypes Set FinIsRateRvwAtGrcEnd = 1;
				UPDATE RMTFinanceTypes_Temp Set FinIsRateRvwAtGrcEnd = 1;
			]]>
		</sql>
	</changeSet>


	<changeSet id="146" author="Varaprasad.K">
		<addColumn tableName="REJECTFINANCEMAIN">
			<column name="SvAmount" type="Decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="147" author="Varaprasad.K">
		<addColumn tableName="REJECTFINANCEMAIN">
			<column name="CBAmount" type="Decimal(18,2)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="148" author="Varaprasad.K">
		<sql>
			<![CDATA[
				UPDATE REJECTFINANCEMAIN Set SvAmount = 0  where SvAmount is null;
				UPDATE REJECTFINANCEMAIN Set CBAmount = 0  where SvAmount is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="149_pre" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rejectfinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="149" author="Varaprasad.K">
		<createView viewName="REJECTFINANCEMAIN_VIEW"
			replaceIfExists="true">
			SELECT f.finreference,
			    t.fincategory AS lovdescproductcodename,
			    f.fintype,
			    f.finbranch,
			    f.finstartdate,
			    f.maturitydate,
			    f.numberofterms,
			    f.finccy,
			    f.finamount,
			    f.finamount - f.downpayment + f.feechargeamt + f.insuranceamt AS financingamount,
			    f.feechargeamt,
			    f.insuranceamt,
			    f.finamount - f.downpayment + f.feechargeamt + f.insuranceamt - f.finrepaymentamount AS curfinamount,
			    f.downpayment,
			    f.fincurrassetvalue,
			    f.finassetvalue,
			    f.allowdrawingpower,
			    f.promotionseqid,
			    f.sanbsdschdle,
			    c.custcif AS lovdesccustcif,
			    f.svAmount,
			    f.CBAmount
			   FROM rejectfinancemain f
			     LEFT JOIN customers c ON f.custid = c.custid
			     LEFT JOIN rmtfinancetypes t ON f.fintype = t.fintype
	</createView>
	</changeSet>

	<changeSet id="149_post" author="Varaprasad.K" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'rejectfinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="150" author="satyanarayana.g">
		<addColumn tableName="FINANCEMAIN">
			<column name="FinIsRateRvwAtGrcEnd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="151" author="satyanarayana.g">
		<addColumn tableName="FINANCEMAIN_TEMP">
			<column name="FinIsRateRvwAtGrcEnd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="152" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE FINANCEMAIN Set FinIsRateRvwAtGrcEnd = 0 where FinIsRateRvwAtGrcEnd is null;
				UPDATE FINANCEMAIN_Temp Set FinIsRateRvwAtGrcEnd = 0 where FinIsRateRvwAtGrcEnd is null;;
			]]>
		</sql>
	</changeSet>

	<changeSet id="153" author="satyanarayana.g" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FINANCEMAIN ADD CONSTRAINT DF_FINANCEMAIN_FINRTRVGRSE DEFAULT 0 FOR FinIsRateRvwAtGrcEnd;
				ALTER TABLE FINANCEMAIN_TEMP ADD CONSTRAINT DF_FINANCEMAIN_TEMP_FINRTRVGRSE DEFAULT 0 FOR FinIsRateRvwAtGrcEnd;
			]]>
		</sql>
	</changeSet>

	<changeSet id="154" author="satyanarayana.g" dbms="postgresql, oracle">
		<addDefaultValue columnName="AllowRevolving"
			tableName="FINANCEMAIN" defaultValue="0" />
		<addDefaultValue columnName="AllowRevolving"
			tableName="FINANCEMAIN_Temp" defaultValue="0" />
	</changeSet>

	<changeSet id="155" author="satyanarayana.g">
		<addColumn tableName="FINANCEMAIN_PA">
			<column name="FinIsRateRvwAtGrcEnd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="156" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE FINANCEMAIN_PA Set FinIsRateRvwAtGrcEnd = 0 where FinIsRateRvwAtGrcEnd is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="157" author="satyanarayana.g" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE FINANCEMAIN_PA ADD CONSTRAINT DF_FINANCEMAIN_PA_FINRTRVGRSE DEFAULT 0 FOR FINISRATERVWATGRCEND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="158" author="satyanarayana.g" dbms="postgresql, oracle">
		<addDefaultValue columnName="FinIsRateRvwAtGrcEnd"
			tableName="FINANCEMAIN_PA" defaultValue="0" />
	</changeSet>

	<changeSet id="159" author="satyanarayana.g">
		<addColumn tableName="REJECTFINANCEMAIN">
			<column name="FinIsRateRvwAtGrcEnd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="160" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE REJECTFINANCEMAIN Set FINISRATERVWATGRCEND = 0 where FinIsRateRvwAtGrcEnd is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="161" author="satyanarayana.g" dbms="mssql">
		<sql>
			<![CDATA[
				ALTER TABLE REJECTFINANCEMAIN ADD CONSTRAINT DF_REJECTFINANCEMAIN_FINRTRVGRSE DEFAULT 0 FOR FINISRATERVWATGRCEND;
			]]>
		</sql>
	</changeSet>

	<changeSet id="162" author="satyanarayana.g" dbms="postgresql, oracle">
		<addDefaultValue columnName="FinIsRateRvwAtGrcEnd"
			tableName="REJECTFINANCEMAIN" defaultValue="0" />
	</changeSet>

	<changeSet id="163_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="163" author="satyanarayana.g">
		<createView viewName="FINANCEMAIN_VIEW" replaceIfExists="true">
			SELECT T1.FINREFERENCE,
				    T1.INVESTMENTREF,
				    T1.NUMBEROFTERMS,
				    T1.GRCPERIODENDDATE,
				    T1.ALLOWGRCPERIOD,
				    T1.GRACEBASERATE,
				    T1.GRACESPECIALRATE,
				    T1.GRCPFTRATE,
				    T1.GRCPFTFRQ,
				    T1.NEXTGRCPFTDATE,
				    T1.ALLOWGRCPFTRVW,
				    T1.GRCPFTRVWFRQ,
				    T1.NEXTGRCPFTRVWDATE,
				    T1.ALLOWGRCCPZ,
				    T1.GRCCPZFRQ,
				    T1.NEXTGRCCPZDATE,
				    T1.REPAYBASERATE,
				    T1.REPAYSPECIALRATE,
				    T1.REPAYPROFITRATE,
				    T1.REPAYFRQ,
				    T1.NEXTREPAYDATE,
				    T1.REPAYPFTFRQ,
				    T1.NEXTREPAYPFTDATE,
				    T1.ALLOWREPAYRVW,
				    T1.REPAYRVWFRQ,
				    T1.NEXTREPAYRVWDATE,
				    T1.ALLOWREPAYCPZ,
				    T1.REPAYCPZFRQ,
				    T1.NEXTREPAYCPZDATE,
				    T1.MATURITYDATE,
				    T1.CPZATGRACEEND,
				    T1.DOWNPAYMENT,
				    T1.GRACEFLATAMOUNT,
				    T1.REQREPAYAMOUNT,
				    T1.TOTALPROFIT,
				    T1.TOTALCPZ,
				    T1.TOTALGROSSPFT,
				    T1.TOTALGROSSGRCPFT,
				    T1.TOTALGRACEPFT,
				    T1.TOTALGRACECPZ,
				    T1.GRCRATEBASIS,
				    T1.REPAYRATEBASIS,
				    T1.FINTYPE,
				    T1.FINREMARKS,
				    T1.FINCCY,
				    T1.SCHEDULEMETHOD,
				    T1.PROFITDAYSBASIS,
				    T1.REQMATURITY,
				    T1.CALTERMS,
				    T1.CALMATURITY,
				    T1.FIRSTREPAY,
				    T1.LASTREPAY,
				    T1.FINSTARTDATE,
				    T1.FINAMOUNT,
				    T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT  LOVDESCFINANCINGAMOUNT,
				    T1.FINREPAYMENTAMOUNT,
				    T1.CUSTID,
				    T1.DEFFERMENTS,
				    T1.PLANDEFERCOUNT,
				    T1.FINBRANCH,
				    T1.FINSOURCEID,
				    T1.ALLOWEDDEFRPYCHANGE,
				    T1.AVAILEDDEFRPYCHANGE,
				    T1.ALLOWEDDEFFRQCHANGE,
				    T1.AVAILEDDEFFRQCHANGE,
				    T1.RECALTYPE,
				    T1.FINASSETVALUE,
				    T1.DISBACCOUNTID,
				    T1.REPAYACCOUNTID,
				    T1.FINISACTIVE,
				    T1.LIMITVALID,
				    T1.OVERRIDELIMIT,
				    T1.SECURITYDEPOSIT,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T7.FINTYPEDESC  LOVDESCFINTYPENAME,
				    T7.FINMAXAMOUNT  LOVDESCFINMAXAMT,
				    T7.FINMINAMOUNT  LOVDESCFINMINAMOUNT,
				    T1.MINDOWNPAYPERC,
				    T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
				    T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
				    T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
				    T12.BRANCHDESC  LOVDESCFINBRANCHNAME,
				    T12.BRANCHPROVINCE  FINBRANCHPROVINCECODE,
				    T1.LASTREPAYDATE,
				    T1.LASTREPAYPFTDATE,
				    T1.LASTREPAYRVWDATE,
				    T1.LASTREPAYCPZDATE,
				    T1.ALLOWGRCREPAY,
				    T1.GRCSCHDMTHD,
				    T1.GRCMARGIN,
				    T1.REPAYMARGIN,
				    T1.FINCURRASSETVALUE,
				    T1.FINCOMMITMENTREF,
				    T1.FINLIMITREF,
				    T1.DEPRECIATIONFRQ,
				    T1.FINCONTRACTDATE,
				    T1.NEXTDEPDATE,
				    T1.LASTDEPDATE,
				    T1.FINACCOUNT,
				    T1.FINCUSTPFTACCOUNT,
				    T17.ACRTILLLBD  LOVDESCACCRUEDTILLLBD,
				    T7.FINRVWRATEAPPLFOR,
				    T1.TOTALREPAYAMT,
				    T1.CLOSINGSTATUS,
				    T1.FINAPPROVEDDATE,
				    T1.FEECHARGEAMT,
				    T1.BLACKLISTED,
				    T1.FINREPAYPFTONFRQ,
				    T1.ANUALIZEDPERCRATE,
				    T1.EFFECTIVERATEOFRETURN,
				    T1.MIGRATEDFINANCE,
				    T1.SCHEDULEMAINTAINED,
				    T1.SCHEDULEREGENERATED,
				    T1.FINPURPOSE,
				    T39.LOANPURPOSEDESC  LOVDESCFINPURPOSENAME,
				    T1.FINSTATUS,
				    T1.FINSTSREASON,
				    T1.INITIATEUSER,
				    T1.BANKNAME,
				    T1.IBAN,
				    T1.ACCOUNTTYPE,
				    T1.DDAREFERENCENO,
				    T7.FINSCHEDULEON  LOVDESCFINSCHEDULEON,
				    T1.CUSTDSR,
				    T1.JOINTACCOUNT,
				    T1.JOINTCUSTID,
				    T1.DOWNPAYBANK,
				    T1.DOWNPAYSUPL,
				    T1.DOWNPAYACCOUNT,
				    T1.SECURITYCOLLATERAL,
				    T1.APPROVED,
				    T1.DISCREPANCY,
				    T1.LIMITAPPROVED,
				    T1.GRACETERMS,
				    T7.FINDIVISION  LOVDESCFINDIVISION,
				    T1.RCDMAINTAINSTS,
				    T1.FINREPAYMETHOD,
				    T1.GRCPROFITDAYSBASIS,
				    T1.STEPFINANCE,
				    T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T1.NEXTUSERID,
				    T1.PRIORITY,
				    T24.POLICYDESC  LOVDESCSTEPPOLICYNAME,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.DEVIATIONAPPROVAL,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.CREDITINSAMT,
				    T1.ROLLOVERFRQ,
				    T1.NEXTROLLOVERDATE,
				    T27.CUSTSTSDESCRIPTION,
				    T1.SHARIASTATUS,
				    T1.INITIATEDATE,
				    T1.FINPREAPPROVEDREF,
				    T1.MMAID,
				    T1.ACCOUNTSOFFICER,
				    T1.FEEACCOUNTID,
				    T1.FINCANCELAC,
				    T28.DEALERNAME  LOVDESCACCOUNTSOFFICER,
				    T28.DEALERCITY  LOVDESCSOURCECITY,
				    T1.DSACODE,
				    T30.ROFFICERDESC  DSACODEDESC,
				    T1.TDSAPPLICABLE,
				    T1.MANDATEID,
				    T1.DROPLINEFRQ,
				    T1.FIRSTDROPLINEDATE,
				    T1.PFTSERVICINGODLIMIT,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.APPLICATIONNO,
				    T1.REFERRALID,
				    T33.ROFFICERDESC  REFERRALIDDESC,
				    T1.DMACODE,
				    T34.ROFFICERDESC  DMACODEDESC,
				    T1.SALESDEPARTMENT,
				    T35.DEPTDESC  SALESDEPARTMENTDESC,
				    T1.QUICKDISB,
				    T1.WIFREFERENCE,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.AVAILEDUNPLANEMI,
				    T1.AVAILEDREAGEH,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.PROMOTIONCODE,
				    T1.RESTRUCTURELOAN,
				    T1.OLDFINREFERENCE,
				    T1.REAGEBUCKET,
				    T1.FINCATEGORY,
				    T1.PRODUCTCATEGORY,
				    T1.ROUNDINGTARGET,
				    T36.ENTITYCODE  LOVDESCENTITYCODE,
				    T1.ELIGIBILITYMETHOD,
				    T38.FIELDCODEVALUE  LOVELIGIBILITYMETHOD,
				    T38.VALUEDESC  LOVDESCELIGIBILITYMETHOD,
				    T1.EMPLOYEENAME,
				    T37.ROFFICERDESC  EMPLOYEENAMEDESC,
				    T1.SAMPLINGREQUIRED,
				    T1.LEGALREQUIRED,
				    T1.GRCMAXAMOUNT,
				    T1.CONNECTOR,
				    T40.DEALERNAME  CONNECTORCODE,
				    T40.DEALERCITY  CONNECTORDESC,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS,
				    T1.FIXEDRATETENOR,
				    T1.FIXEDTENORRATE,
				    T12.BRANCHTEL  FINBRANCHCONTACT,
				    T1.PROCESSATTRIBUTES,
				    T1.BUSINESSVERTICAL,
				    BV.CODE  BUSINESSVERTICALCODE,
				    BV.DESCRIPTION  BUSINESSVERTICALDESC,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.TDSPERCENTAGE,
				    T1.TDSSTARTDATE,
				    T1.TDSENDDATE,
				    T1.TDSLIMITAMT,
				    T1.VANREQ,
				    T1.VANCODE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.SANBSDSCHDLE,
				    T1.PROMOTIONSEQID,
				    T1.SVAMOUNT,
				    T1.CBAMOUNT,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND
				   FROM FINANCEMAIN_TEMP T1
				     JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
				     LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH = T12.BRANCHCODE
				     LEFT JOIN FINPFTDETAILS T17 ON T17.FINREFERENCE = T1.FINREFERENCE
				     LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY = T24.POLICYCODE
				     LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS = T27.CUSTSTSCODE
				     LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				     LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE = T30.ROFFICERCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID = T33.ROFFICERCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE = T34.ROFFICERCODE
				     LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT = T35.DEPTCODE
				     LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION = T36.DIVISIONCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME = T37.ROFFICERCODE
				     LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE = 'ELGMETHOD'
				     LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE = T39.LOANPURPOSECODE
				     LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				     LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				UNION ALL
				 SELECT T1.FINREFERENCE,
				    T1.INVESTMENTREF,
				    T1.NUMBEROFTERMS,
				    T1.GRCPERIODENDDATE,
				    T1.ALLOWGRCPERIOD,
				    T1.GRACEBASERATE,
				    T1.GRACESPECIALRATE,
				    T1.GRCPFTRATE,
				    T1.GRCPFTFRQ,
				    T1.NEXTGRCPFTDATE,
				    T1.ALLOWGRCPFTRVW,
				    T1.GRCPFTRVWFRQ,
				    T1.NEXTGRCPFTRVWDATE,
				    T1.ALLOWGRCCPZ,
				    T1.GRCCPZFRQ,
				    T1.NEXTGRCCPZDATE,
				    T1.REPAYBASERATE,
				    T1.REPAYSPECIALRATE,
				    T1.REPAYPROFITRATE,
				    T1.REPAYFRQ,
				    T1.NEXTREPAYDATE,
				    T1.REPAYPFTFRQ,
				    T1.NEXTREPAYPFTDATE,
				    T1.ALLOWREPAYRVW,
				    T1.REPAYRVWFRQ,
				    T1.NEXTREPAYRVWDATE,
				    T1.ALLOWREPAYCPZ,
				    T1.REPAYCPZFRQ,
				    T1.NEXTREPAYCPZDATE,
				    T1.MATURITYDATE,
				    T1.CPZATGRACEEND,
				    T1.DOWNPAYMENT,
				    T1.GRACEFLATAMOUNT,
				    T1.REQREPAYAMOUNT,
				    T1.TOTALPROFIT,
				    T1.TOTALCPZ,
				    T1.TOTALGROSSPFT,
				    T1.TOTALGROSSGRCPFT,
				    T1.TOTALGRACEPFT,
				    T1.TOTALGRACECPZ,
				    T1.GRCRATEBASIS,
				    T1.REPAYRATEBASIS,
				    T1.FINTYPE,
				    T1.FINREMARKS,
				    T1.FINCCY,
				    T1.SCHEDULEMETHOD,
				    T1.PROFITDAYSBASIS,
				    T1.REQMATURITY,
				    T1.CALTERMS,
				    T1.CALMATURITY,
				    T1.FIRSTREPAY,
				    T1.LASTREPAY,
				    T1.FINSTARTDATE,
				    T1.FINAMOUNT,
				    T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT AS LOVDESCFINANCINGAMOUNT,
				    T1.FINREPAYMENTAMOUNT,
				    T1.CUSTID,
				    T1.DEFFERMENTS,
				    T1.PLANDEFERCOUNT,
				    T1.FINBRANCH,
				    T1.FINSOURCEID,
				    T1.ALLOWEDDEFRPYCHANGE,
				    T1.AVAILEDDEFRPYCHANGE,
				    T1.ALLOWEDDEFFRQCHANGE,
				    T1.AVAILEDDEFFRQCHANGE,
				    T1.RECALTYPE,
				    T1.FINASSETVALUE,
				    T1.DISBACCOUNTID,
				    T1.REPAYACCOUNTID,
				    T1.FINISACTIVE,
				    T1.LIMITVALID,
				    T1.OVERRIDELIMIT,
				    T1.SECURITYDEPOSIT,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T7.FINTYPEDESC  LOVDESCFINTYPENAME,
				    T7.FINMAXAMOUNT  LOVDESCFINMAXAMT,
				    T7.FINMINAMOUNT  LOVDESCFINMINAMOUNT,
				    T1.MINDOWNPAYPERC,
				    T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
				    T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
				    T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
				    T12.BRANCHDESC  LOVDESCFINBRANCHNAME,
				    T12.BRANCHPROVINCE  FINBRANCHPROVINCECODE,
				    T1.LASTREPAYDATE,
				    T1.LASTREPAYPFTDATE,
				    T1.LASTREPAYRVWDATE,
				    T1.LASTREPAYCPZDATE,
				    T1.ALLOWGRCREPAY,
				    T1.GRCSCHDMTHD,
				    T1.GRCMARGIN,
				    T1.REPAYMARGIN,
				    T1.FINCURRASSETVALUE,
				    T1.FINCOMMITMENTREF,
				    T1.FINLIMITREF,
				    T1.DEPRECIATIONFRQ,
				    T1.FINCONTRACTDATE,
				    T1.NEXTDEPDATE,
				    T1.LASTDEPDATE,
				    T1.FINACCOUNT,
				    T1.FINCUSTPFTACCOUNT,
				    T17.ACRTILLLBD  LOVDESCACCRUEDTILLLBD,
				    T7.FINRVWRATEAPPLFOR,
				    T1.TOTALREPAYAMT,
				    T1.CLOSINGSTATUS,
				    T1.FINAPPROVEDDATE,
				    T1.FEECHARGEAMT,
				    T1.BLACKLISTED,
				    T1.FINREPAYPFTONFRQ,
				    T1.ANUALIZEDPERCRATE,
				    T1.EFFECTIVERATEOFRETURN,
				    T1.MIGRATEDFINANCE,
				    T1.SCHEDULEMAINTAINED,
				    T1.SCHEDULEREGENERATED,
				    T1.FINPURPOSE,
				    T39.LOANPURPOSEDESC  LOVDESCFINPURPOSENAME,
				    T1.FINSTATUS,
				    T1.FINSTSREASON,
				    T1.INITIATEUSER,
				    T1.BANKNAME,
				    T1.IBAN,
				    T1.ACCOUNTTYPE,
				    T1.DDAREFERENCENO,
				    T7.FINSCHEDULEON  LOVDESCFINSCHEDULEON,
				    T1.CUSTDSR,
				    T1.JOINTACCOUNT,
				    T1.JOINTCUSTID,
				    T1.DOWNPAYBANK,
				    T1.DOWNPAYSUPL,
				    T1.DOWNPAYACCOUNT,
				    T1.SECURITYCOLLATERAL,
				    T1.APPROVED,
				    T1.DISCREPANCY,
				    T1.LIMITAPPROVED,
				    T1.GRACETERMS,
				    T7.FINDIVISION  LOVDESCFINDIVISION,
				    T1.RCDMAINTAINSTS,
				    T1.FINREPAYMETHOD,
				    T1.GRCPROFITDAYSBASIS,
				    T1.STEPFINANCE,
				    T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T1.NEXTUSERID,
				    T1.PRIORITY,
				    T24.POLICYDESC  LOVDESCSTEPPOLICYNAME,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.DEVIATIONAPPROVAL,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.CREDITINSAMT,
				    T1.ROLLOVERFRQ,
				    T1.NEXTROLLOVERDATE,
				    T27.CUSTSTSDESCRIPTION,
				    T1.SHARIASTATUS,
				    T1.INITIATEDATE,
				    T1.FINPREAPPROVEDREF,
				    T1.MMAID,
				    T1.ACCOUNTSOFFICER,
				    T1.FEEACCOUNTID,
				    T1.FINCANCELAC,
				    T28.DEALERNAME  LOVDESCACCOUNTSOFFICER,
				    T28.DEALERCITY  LOVDESCSOURCECITY,
				    T1.DSACODE,
				    T30.ROFFICERDESC  DSACODEDESC,
				    T1.TDSAPPLICABLE,
				    T1.MANDATEID,
				    T1.DROPLINEFRQ,
				    T1.FIRSTDROPLINEDATE,
				    T1.PFTSERVICINGODLIMIT,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.APPLICATIONNO,
				    T1.REFERRALID,
				    T33.ROFFICERDESC  REFERRALIDDESC,
				    T1.DMACODE,
				    T34.ROFFICERDESC  DMACODEDESC,
				    T1.SALESDEPARTMENT,
				    T35.DEPTDESC  SALESDEPARTMENTDESC,
				    T1.QUICKDISB,
				    T1.WIFREFERENCE,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.AVAILEDUNPLANEMI,
				    T1.AVAILEDREAGEH,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.PROMOTIONCODE,
				    T1.RESTRUCTURELOAN,
				    T1.OLDFINREFERENCE,
				    T1.REAGEBUCKET,
				    T1.FINCATEGORY,
				    T1.PRODUCTCATEGORY,
				    T1.ROUNDINGTARGET,
				    T36.ENTITYCODE  LOVDESCENTITYCODE,
				    T1.ELIGIBILITYMETHOD,
				    T38.FIELDCODEVALUE  LOVELIGIBILITYMETHOD,
				    T38.VALUEDESC  LOVDESCELIGIBILITYMETHOD,
				    T1.EMPLOYEENAME,
				    T37.ROFFICERDESC  EMPLOYEENAMEDESC,
				    T1.SAMPLINGREQUIRED,
				    T1.LEGALREQUIRED,
				    T1.GRCMAXAMOUNT,
				    T1.CONNECTOR,
				    T40.DEALERNAME  CONNECTORCODE,
				    T40.DEALERCITY  CONNECTORDESC,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS,
				    T1.FIXEDRATETENOR,
				    T1.FIXEDTENORRATE,
				    T12.BRANCHTEL  FINBRANCHCONTACT,
				    T1.PROCESSATTRIBUTES,
				    T1.BUSINESSVERTICAL,
				    BV.CODE  BUSINESSVERTICALCODE,
				    BV.DESCRIPTION  BUSINESSVERTICALDESC,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.TDSPERCENTAGE,
				    T1.TDSSTARTDATE,
				    T1.TDSENDDATE,
				    T1.TDSLIMITAMT,
				    T1.VANREQ,
				    T1.VANCODE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.SANBSDSCHDLE,
				    T1.PROMOTIONSEQID,
				    T1.SVAMOUNT,
				    T1.CBAMOUNT,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND
				   FROM FINANCEMAIN T1
				     JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
				     LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH = T12.BRANCHCODE
				     LEFT JOIN FINPFTDETAILS T17 ON T17.FINREFERENCE = T1.FINREFERENCE
				     LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY = T24.POLICYCODE
				     LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS = T27.CUSTSTSCODE
				     LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				     LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE = T30.ROFFICERCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID = T33.ROFFICERCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE = T34.ROFFICERCODE
				     LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT = T35.DEPTCODE
				     LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION = T36.DIVISIONCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME = T37.ROFFICERCODE
				     LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE = 'ELGMETHOD'
				     LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE = T39.LOANPURPOSECODE
				     LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				     LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				  WHERE NOT (EXISTS ( SELECT 1  FROM FINANCEMAIN_TEMP
				  WHERE FINANCEMAIN_TEMP.FINREFERENCE = T1.FINREFERENCE))
		</createView>
	</changeSet>

	<changeSet id="163_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="164_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="164" author="satyanarayana.g">
		<createView viewName="FINANCEMAIN_TVIEW" replaceIfExists="true">
			SELECT T1.FINREFERENCE,
				    T1.INVESTMENTREF,
				    T1.NUMBEROFTERMS,
				    T1.GRCPERIODENDDATE,
				    T1.ALLOWGRCPERIOD,
				    T1.GRACEBASERATE,
				    T1.GRACESPECIALRATE,
				    T1.GRCPFTRATE,
				    T1.GRCPFTFRQ,
				    T1.NEXTGRCPFTDATE,
				    T1.ALLOWGRCPFTRVW,
				    T1.GRCPFTRVWFRQ,
				    T1.NEXTGRCPFTRVWDATE,
				    T1.ALLOWGRCCPZ,
				    T1.GRCCPZFRQ,
				    T1.NEXTGRCCPZDATE,
				    T1.REPAYBASERATE,
				    T1.REPAYSPECIALRATE,
				    T1.REPAYPROFITRATE,
				    T1.REPAYFRQ,
				    T1.NEXTREPAYDATE,
				    T1.REPAYPFTFRQ,
				    T1.NEXTREPAYPFTDATE,
				    T1.ALLOWREPAYRVW,
				    T1.REPAYRVWFRQ,
				    T1.NEXTREPAYRVWDATE,
				    T1.ALLOWREPAYCPZ,
				    T1.REPAYCPZFRQ,
				    T1.NEXTREPAYCPZDATE,
				    T1.MATURITYDATE,
				    T1.CPZATGRACEEND,
				    T1.DOWNPAYMENT,
				    T1.GRACEFLATAMOUNT,
				    T1.REQREPAYAMOUNT,
				    T1.TOTALPROFIT,
				    T1.TOTALCPZ,
				    T1.TOTALGROSSPFT,
				    T1.TOTALGROSSGRCPFT,
				    T1.TOTALGRACEPFT,
				    T1.TOTALGRACECPZ,
				    T1.GRCRATEBASIS,
				    T1.REPAYRATEBASIS,
				    T1.FINTYPE,
				    T1.FINREMARKS,
				    T1.FINCCY,
				    T1.SCHEDULEMETHOD,
				    T1.PROFITDAYSBASIS,
				    T1.REQMATURITY,
				    T1.CALTERMS,
				    T1.CALMATURITY,
				    T1.FIRSTREPAY,
				    T1.LASTREPAY,
				    T1.FINSTARTDATE,
				    T1.FINAMOUNT,
				    T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT  LOVDESCFINANCINGAMOUNT,
				    T1.FINREPAYMENTAMOUNT,
				    T1.CUSTID,
				    T1.DEFFERMENTS,
				    T1.PLANDEFERCOUNT,
				    T1.FINBRANCH,
				    T1.FINSOURCEID,
				    T1.ALLOWEDDEFRPYCHANGE,
				    T1.AVAILEDDEFRPYCHANGE,
				    T1.ALLOWEDDEFFRQCHANGE,
				    T1.AVAILEDDEFFRQCHANGE,
				    T1.RECALTYPE,
				    T1.FINASSETVALUE,
				    T1.DISBACCOUNTID,
				    T1.REPAYACCOUNTID,
				    T1.FINISACTIVE,
				    T1.LIMITVALID,
				    T1.OVERRIDELIMIT,
				    T1.SECURITYDEPOSIT,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T7.FINTYPEDESC  LOVDESCFINTYPENAME,
				    T7.FINMAXAMOUNT  LOVDESCFINMAXAMT,
				    T7.FINMINAMOUNT  LOVDESCFINMINAMOUNT,
				    T1.MINDOWNPAYPERC,
				    T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
				    T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
				    T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
				    T12.BRANCHDESC  LOVDESCFINBRANCHNAME,
				    T12.BRANCHPROVINCE  FINBRANCHPROVINCECODE,
				    T1.LASTREPAYDATE,
				    T1.LASTREPAYPFTDATE,
				    T1.LASTREPAYRVWDATE,
				    T1.LASTREPAYCPZDATE,
				    T1.ALLOWGRCREPAY,
				    T1.GRCSCHDMTHD,
				    T1.GRCMARGIN,
				    T1.REPAYMARGIN,
				    T1.FINCURRASSETVALUE,
				    T1.FINCOMMITMENTREF,
				    T1.FINLIMITREF,
				    T1.DEPRECIATIONFRQ,
				    T1.FINCONTRACTDATE,
				    T1.NEXTDEPDATE,
				    T1.LASTDEPDATE,
				    T1.FINACCOUNT,
				    T1.FINCUSTPFTACCOUNT,
				    T17.ACRTILLLBD  LOVDESCACCRUEDTILLLBD,
				    T7.FINRVWRATEAPPLFOR,
				    T1.TOTALREPAYAMT,
				    T1.CLOSINGSTATUS,
				    T1.FINAPPROVEDDATE,
				    T1.FEECHARGEAMT,
				    T1.BLACKLISTED,
				    T1.FINREPAYPFTONFRQ,
				    T1.ANUALIZEDPERCRATE,
				    T1.EFFECTIVERATEOFRETURN,
				    T1.MIGRATEDFINANCE,
				    T1.SCHEDULEMAINTAINED,
				    T1.SCHEDULEREGENERATED,
				    T1.FINPURPOSE,
				    T39.LOANPURPOSEDESC  LOVDESCFINPURPOSENAME,
				    T1.FINSTATUS,
				    T1.FINSTSREASON,
				    T1.INITIATEUSER,
				    T1.BANKNAME,
				    T1.IBAN,
				    T1.ACCOUNTTYPE,
				    T1.DDAREFERENCENO,
				    T7.FINSCHEDULEON  LOVDESCFINSCHEDULEON,
				    T1.CUSTDSR,
				    T1.JOINTACCOUNT,
				    T1.JOINTCUSTID,
				    T1.DOWNPAYBANK,
				    T1.DOWNPAYSUPL,
				    T1.DOWNPAYACCOUNT,
				    T1.SECURITYCOLLATERAL,
				    T1.APPROVED,
				    T1.DISCREPANCY,
				    T1.LIMITAPPROVED,
				    T1.GRACETERMS,
				    T7.FINDIVISION  LOVDESCFINDIVISION,
				    T1.RCDMAINTAINSTS,
				    T1.FINREPAYMETHOD,
				    T1.GRCPROFITDAYSBASIS,
				    T1.STEPFINANCE,
				    T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T1.NEXTUSERID,
				    T1.PRIORITY,
				    T24.POLICYDESC  LOVDESCSTEPPOLICYNAME,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.DEVIATIONAPPROVAL,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.CREDITINSAMT,
				    T1.ROLLOVERFRQ,
				    T1.NEXTROLLOVERDATE,
				    T27.CUSTSTSDESCRIPTION,
				    T1.SHARIASTATUS,
				    T1.INITIATEDATE,
				    T1.FINPREAPPROVEDREF,
				    T1.MMAID,
				    T1.ACCOUNTSOFFICER,
				    T1.FEEACCOUNTID,
				    T1.FINCANCELAC,
				    T28.DEALERNAME  LOVDESCACCOUNTSOFFICER,
				    T28.DEALERCITY  LOVDESCSOURCECITY,
				    T1.DSACODE,
				    T30.ROFFICERDESC  DSACODEDESC,
				    T1.TDSAPPLICABLE,
				    T1.MANDATEID,
				    T1.DROPLINEFRQ,
				    T1.FIRSTDROPLINEDATE,
				    T1.PFTSERVICINGODLIMIT,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.APPLICATIONNO,
				    T1.REFERRALID,
				    T33.ROFFICERDESC  REFERRALIDDESC,
				    T1.DMACODE,
				    T34.ROFFICERDESC  DMACODEDESC,
				    T1.SALESDEPARTMENT,
				    T35.DEPTDESC  SALESDEPARTMENTDESC,
				    T1.QUICKDISB,
				    T1.WIFREFERENCE,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.AVAILEDUNPLANEMI,
				    T1.AVAILEDREAGEH,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.PROMOTIONCODE,
				    T1.RESTRUCTURELOAN,
				    T1.OLDFINREFERENCE,
				    T1.REAGEBUCKET,
				    T1.FINCATEGORY,
				    T1.PRODUCTCATEGORY,
				    T1.ROUNDINGTARGET,
				    T36.ENTITYCODE  LOVDESCENTITYCODE,
				    T1.ELIGIBILITYMETHOD,
				    T38.FIELDCODEVALUE  LOVELIGIBILITYMETHOD,
				    T38.VALUEDESC  LOVDESCELIGIBILITYMETHOD,
				    T1.EMPLOYEENAME,
				    T37.ROFFICERDESC  EMPLOYEENAMEDESC,
				    T1.SAMPLINGREQUIRED,
				    T1.LEGALREQUIRED,
				    T1.GRCMAXAMOUNT,
				    T1.CONNECTOR,
				    T40.DEALERNAME  CONNECTORCODE,
				    T40.DEALERCITY  CONNECTORDESC,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS,
				    T1.FIXEDRATETENOR,
				    T1.FIXEDTENORRATE,
				    T12.BRANCHTEL  FINBRANCHCONTACT,
				    T1.PROCESSATTRIBUTES,
				    T1.BUSINESSVERTICAL,
				    BV.CODE  BUSINESSVERTICALCODE,
				    BV.DESCRIPTION  BUSINESSVERTICALDESC,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.TDSPERCENTAGE,
				    T1.TDSSTARTDATE,
				    T1.TDSENDDATE,
				    T1.TDSLIMITAMT,
				    T1.VANREQ,
				    T1.VANCODE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.SANBSDSCHDLE,
				    T1.PROMOTIONSEQID,
				    T1.SVAMOUNT,
				    T1.CBAMOUNT,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND
				   FROM FINANCEMAIN_TEMP T1
				     JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
				     LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH = T12.BRANCHCODE
				     LEFT JOIN FINPFTDETAILS T17 ON T17.FINREFERENCE = T1.FINREFERENCE
				     LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY = T24.POLICYCODE
				     LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS = T27.CUSTSTSCODE
				     LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				     LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE = T30.ROFFICERCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID = T33.ROFFICERCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE = T34.ROFFICERCODE
				     LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT = T35.DEPTCODE
				     LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION = T36.DIVISIONCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME = T37.ROFFICERCODE
				     LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE = 'ELGMETHOD'
				     LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE = T39.LOANPURPOSECODE
				     LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				     LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
		</createView>
	</changeSet>

	<changeSet id="164_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="165_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financemain_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="165" author="satyanarayana.g">
		<createView viewName="FINANCEMAIN_AVIEW" replaceIfExists="true">
			SELECT T1.FINREFERENCE,
				    T1.INVESTMENTREF,
				    T1.NUMBEROFTERMS,
				    T1.GRCPERIODENDDATE,
				    T1.ALLOWGRCPERIOD,
				    T1.GRACEBASERATE,
				    T1.GRACESPECIALRATE,
				    T1.GRCPFTRATE,
				    T1.GRCPFTFRQ,
				    T1.NEXTGRCPFTDATE,
				    T1.ALLOWGRCPFTRVW,
				    T1.GRCPFTRVWFRQ,
				    T1.NEXTGRCPFTRVWDATE,
				    T1.ALLOWGRCCPZ,
				    T1.GRCCPZFRQ,
				    T1.NEXTGRCCPZDATE,
				    T1.REPAYBASERATE,
				    T1.REPAYSPECIALRATE,
				    T1.REPAYPROFITRATE,
				    T1.REPAYFRQ,
				    T1.NEXTREPAYDATE,
				    T1.REPAYPFTFRQ,
				    T1.NEXTREPAYPFTDATE,
				    T1.ALLOWREPAYRVW,
				    T1.REPAYRVWFRQ,
				    T1.NEXTREPAYRVWDATE,
				    T1.ALLOWREPAYCPZ,
				    T1.REPAYCPZFRQ,
				    T1.NEXTREPAYCPZDATE,
				    T1.MATURITYDATE,
				    T1.CPZATGRACEEND,
				    T1.DOWNPAYMENT,
				    T1.GRACEFLATAMOUNT,
				    T1.REQREPAYAMOUNT,
				    T1.TOTALPROFIT,
				    T1.TOTALCPZ,
				    T1.TOTALGROSSPFT,
				    T1.TOTALGROSSGRCPFT,
				    T1.TOTALGRACEPFT,
				    T1.TOTALGRACECPZ,
				    T1.GRCRATEBASIS,
				    T1.REPAYRATEBASIS,
				    T1.FINTYPE,
				    T1.FINREMARKS,
				    T1.FINCCY,
				    T1.SCHEDULEMETHOD,
				    T1.PROFITDAYSBASIS,
				    T1.REQMATURITY,
				    T1.CALTERMS,
				    T1.CALMATURITY,
				    T1.FIRSTREPAY,
				    T1.LASTREPAY,
				    T1.FINSTARTDATE,
				    T1.FINAMOUNT,
				    T1.FINAMOUNT + T1.FEECHARGEAMT - T1.DOWNPAYMENT AS LOVDESCFINANCINGAMOUNT,
				    T1.FINREPAYMENTAMOUNT,
				    T1.CUSTID,
				    T1.DEFFERMENTS,
				    T1.PLANDEFERCOUNT,
				    T1.FINBRANCH,
				    T1.FINSOURCEID,
				    T1.ALLOWEDDEFRPYCHANGE,
				    T1.AVAILEDDEFRPYCHANGE,
				    T1.ALLOWEDDEFFRQCHANGE,
				    T1.AVAILEDDEFFRQCHANGE,
				    T1.RECALTYPE,
				    T1.FINASSETVALUE,
				    T1.DISBACCOUNTID,
				    T1.REPAYACCOUNTID,
				    T1.FINISACTIVE,
				    T1.LIMITVALID,
				    T1.OVERRIDELIMIT,
				    T1.SECURITYDEPOSIT,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T7.FINTYPEDESC AS LOVDESCFINTYPENAME,
				    T7.FINMAXAMOUNT AS LOVDESCFINMAXAMT,
				    T7.FINMINAMOUNT AS LOVDESCFINMINAMOUNT,
				    T1.MINDOWNPAYPERC,
				    T7.FINISALWDIFFERMENT AS LOVDESCFINALWDEFERMENT,
				    T7.FINISDWPAYREQUIRED AS LOVDESCDWNPAYREQ,
				    T7.FINMAXDIFFERMENT AS LOVDESCFINMAXDIFFERMENT,
				    T12.BRANCHDESC AS LOVDESCFINBRANCHNAME,
				    T12.BRANCHPROVINCE AS FINBRANCHPROVINCECODE,
				    T1.LASTREPAYDATE,
				    T1.LASTREPAYPFTDATE,
				    T1.LASTREPAYRVWDATE,
				    T1.LASTREPAYCPZDATE,
				    T1.ALLOWGRCREPAY,
				    T1.GRCSCHDMTHD,
				    T1.GRCMARGIN,
				    T1.REPAYMARGIN,
				    T1.FINCURRASSETVALUE,
				    T1.FINCOMMITMENTREF,
				    T1.FINLIMITREF,
				    T1.DEPRECIATIONFRQ,
				    T1.FINCONTRACTDATE,
				    T1.NEXTDEPDATE,
				    T1.LASTDEPDATE,
				    T1.FINACCOUNT,
				    T1.FINCUSTPFTACCOUNT,
				    T17.ACRTILLLBD AS LOVDESCACCRUEDTILLLBD,
				    T7.FINRVWRATEAPPLFOR,
				    T1.TOTALREPAYAMT,
				    T1.CLOSINGSTATUS,
				    T1.FINAPPROVEDDATE,
				    T1.FEECHARGEAMT,
				    T1.BLACKLISTED,
				    T1.FINREPAYPFTONFRQ,
				    T1.ANUALIZEDPERCRATE,
				    T1.EFFECTIVERATEOFRETURN,
				    T1.MIGRATEDFINANCE,
				    T1.SCHEDULEMAINTAINED,
				    T1.SCHEDULEREGENERATED,
				    T1.FINPURPOSE,
				    T39.LOANPURPOSEDESC AS LOVDESCFINPURPOSENAME,
				    T1.FINSTATUS,
				    T1.FINSTSREASON,
				    T1.INITIATEUSER,
				    T1.BANKNAME,
				    T1.IBAN,
				    T1.ACCOUNTTYPE,
				    T1.DDAREFERENCENO,
				    T7.FINSCHEDULEON AS LOVDESCFINSCHEDULEON,
				    T1.CUSTDSR,
				    T1.JOINTACCOUNT,
				    T1.JOINTCUSTID,
				    T1.DOWNPAYBANK,
				    T1.DOWNPAYSUPL,
				    T1.DOWNPAYACCOUNT,
				    T1.SECURITYCOLLATERAL,
				    T1.APPROVED,
				    T1.DISCREPANCY,
				    T1.LIMITAPPROVED,
				    T1.GRACETERMS,
				    T7.FINDIVISION AS LOVDESCFINDIVISION,
				    T1.RCDMAINTAINSTS,
				    T1.FINREPAYMETHOD,
				    T1.GRCPROFITDAYSBASIS,
				    T1.STEPFINANCE,
				    T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T1.NEXTUSERID,
				    T1.PRIORITY,
				    T24.POLICYDESC AS LOVDESCSTEPPOLICYNAME,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.DEVIATIONAPPROVAL,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.CREDITINSAMT,
				    T1.ROLLOVERFRQ,
				    T1.NEXTROLLOVERDATE,
				    T27.CUSTSTSDESCRIPTION,
				    T1.SHARIASTATUS,
				    T1.INITIATEDATE,
				    T1.FINPREAPPROVEDREF,
				    T1.MMAID,
				    T1.ACCOUNTSOFFICER,
				    T1.FEEACCOUNTID,
				    T1.FINCANCELAC,
				    T28.DEALERNAME AS LOVDESCACCOUNTSOFFICER,
				    T28.DEALERCITY AS LOVDESCSOURCECITY,
				    T1.DSACODE,
				    T30.ROFFICERDESC AS DSACODEDESC,
				    T1.TDSAPPLICABLE,
				    T1.MANDATEID,
				    T1.DROPLINEFRQ,
				    T1.FIRSTDROPLINEDATE,
				    T1.PFTSERVICINGODLIMIT,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.APPLICATIONNO,
				    T1.REFERRALID,
				    T33.ROFFICERDESC AS REFERRALIDDESC,
				    T1.DMACODE,
				    T34.ROFFICERDESC AS DMACODEDESC,
				    T1.SALESDEPARTMENT,
				    T35.DEPTDESC AS SALESDEPARTMENTDESC,
				    T1.QUICKDISB,
				    T1.WIFREFERENCE,
				    T1.UNPLANEMIHLOCKPERIOD,
				    T1.UNPLANEMICPZ,
				    T1.REAGECPZ,
				    T1.MAXUNPLANNEDEMI,
				    T1.MAXREAGEHOLIDAYS,
				    T1.AVAILEDUNPLANEMI,
				    T1.AVAILEDREAGEH,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.PROMOTIONCODE,
				    T1.RESTRUCTURELOAN,
				    T1.OLDFINREFERENCE,
				    T1.REAGEBUCKET,
				    T1.FINCATEGORY,
				    T1.PRODUCTCATEGORY,
				    T1.ROUNDINGTARGET,
				    T36.ENTITYCODE AS LOVDESCENTITYCODE,
				    T1.ELIGIBILITYMETHOD,
				    T38.FIELDCODEVALUE AS LOVELIGIBILITYMETHOD,
				    T38.VALUEDESC AS LOVDESCELIGIBILITYMETHOD,
				    T1.EMPLOYEENAME,
				    T37.ROFFICERDESC AS EMPLOYEENAMEDESC,
				    T1.SAMPLINGREQUIRED,
				    T1.LEGALREQUIRED,
				    T1.GRCMAXAMOUNT,
				    T1.CONNECTOR,
				    T40.DEALERNAME AS CONNECTORCODE,
				    T40.DEALERCITY AS CONNECTORDESC,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS,
				    T1.FIXEDRATETENOR,
				    T1.FIXEDTENORRATE,
				    T12.BRANCHTEL AS FINBRANCHCONTACT,
				    T1.PROCESSATTRIBUTES,
				    T1.BUSINESSVERTICAL,
				    BV.CODE AS BUSINESSVERTICALCODE,
				    BV.DESCRIPTION AS BUSINESSVERTICALDESC,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.TDSPERCENTAGE,
				    T1.TDSSTARTDATE,
				    T1.TDSENDDATE,
				    T1.TDSLIMITAMT,
				    T1.VANREQ,
				    T1.VANCODE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.SANBSDSCHDLE,
				    T1.PROMOTIONSEQID,
				    T1.SVAMOUNT,
				    T1.CBAMOUNT,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND
				   FROM FINANCEMAIN T1
				     JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
				     LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH = T12.BRANCHCODE
				     LEFT JOIN FINPFTDETAILS T17 ON T17.FINREFERENCE = T1.FINREFERENCE
				     LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY = T24.POLICYCODE
				     LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS = T27.CUSTSTSCODE
				     LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				     LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE = T30.ROFFICERCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID = T33.ROFFICERCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE = T34.ROFFICERCODE
				     LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT = T35.DEPTCODE
				     LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION = T36.DIVISIONCODE
				     LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME = T37.ROFFICERCODE
				     LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE = 'ELGMETHOD'
				     LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE = T39.LOANPURPOSECODE
				     LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				     LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
		</createView>
	</changeSet>

	<changeSet id="165_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financemain_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="166_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'rejectfinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="166" author="satyanarayana.g">
		<createView viewName="REJECTFINANCEMAIN_VIEW"
			replaceIfExists="true">
			 SELECT F.FINREFERENCE,
				    T.FINCATEGORY AS LOVDESCPRODUCTCODENAME,
				    F.FINTYPE,
				    F.FINBRANCH,
				    F.FINSTARTDATE,
				    F.MATURITYDATE,
				    F.NUMBEROFTERMS,
				    F.FINCCY,
				    F.FINAMOUNT,
				    F.FINAMOUNT - F.DOWNPAYMENT + F.FEECHARGEAMT + F.INSURANCEAMT AS FINANCINGAMOUNT,
				    F.FEECHARGEAMT,
				    F.INSURANCEAMT,
				    F.FINAMOUNT - F.DOWNPAYMENT + F.FEECHARGEAMT + F.INSURANCEAMT - F.FINREPAYMENTAMOUNT AS CURFINAMOUNT,
				    F.DOWNPAYMENT,
				    F.FINCURRASSETVALUE,
				    F.FINASSETVALUE,
				    F.ALLOWDRAWINGPOWER,
				    F.PROMOTIONSEQID,
				    F.SANBSDSCHDLE,
				    C.CUSTCIF AS LOVDESCCUSTCIF,
				    F.SVAMOUNT,
				    F.CBAMOUNT,
				    F.FINISRATERVWATGRCEND
				   FROM REJECTFINANCEMAIN F
				     LEFT JOIN CUSTOMERS C ON F.CUSTID = C.CUSTID
				     LEFT JOIN RMTFINANCETYPES T ON F.FINTYPE = T.FINTYPE
		</createView>
	</changeSet>

	<changeSet id="166_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rejectfinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="167" author="satyanarayana.g">
		<addColumn tableName="WIFFINANCEMAIN">
			<column name="FinIsRateRvwAtGrcEnd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="168" author="satyanarayana.g">
		<addColumn tableName="WIFFINANCEMAIN_TEMP">
			<column name="FinIsRateRvwAtGrcEnd" type="boolean" />
		</addColumn>
	</changeSet>

	<changeSet id="169" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE WIFFINANCEMAIN Set FinIsRateRvwAtGrcEnd = 0  where FinIsRateRvwAtGrcEnd is null;
				UPDATE WIFFINANCEMAIN_TEMP Set FinIsRateRvwAtGrcEnd = 0 where FinIsRateRvwAtGrcEnd is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="170" author="satyanarayana.g" dbms="mssql">
		<sql>
			<![CDATA[	
				ALTER TABLE WIFFINANCEMAIN ADD CONSTRAINT DF_WIFFINANCEMAIN_FINRGR DEFAULT 0 FOR FinIsRateRvwAtGrcEnd;
				ALTER TABLE WIFFINANCEMAIN_TEMP ADD CONSTRAINT DF_WIFFINANCEMAIN_TEMP_FINRGR DEFAULT 0 FOR FinIsRateRvwAtGrcEnd;
			]]>
		</sql>
	</changeSet>

	<changeSet id="171" author="satyanarayana.g" dbms="postgresql, oracle">
		<addDefaultValue columnName="FinIsRateRvwAtGrcEnd"
			tableName="WIFFINANCEMAIN" defaultValue="0" />
		<addDefaultValue columnName="FinIsRateRvwAtGrcEnd"
			tableName="WIFFINANCEMAIN_TEMP" defaultValue="0" />
	</changeSet>

	<changeSet id="172_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'wiffinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="172" author="satyanarayana.g">
		<createView viewName="WIFFINANCEMAIN_VIEW" replaceIfExists="true">
			SELECT T1.FINREFERENCE,
				    T1.NUMBEROFTERMS,
				    T1.GRCPERIODENDDATE,
				    T1.ALLOWGRCPERIOD,
				    T1.GRACEBASERATE,
				    T1.GRACESPECIALRATE,
				    T1.GRCPFTRATE,
				    T1.GRCPFTFRQ,
				    T1.NEXTGRCPFTDATE,
				    T1.ALLOWGRCPFTRVW,
				    T1.GRCPFTRVWFRQ,
				    T1.NEXTGRCPFTRVWDATE,
				    T1.ALLOWGRCCPZ,
				    T1.GRCCPZFRQ,
				    T1.NEXTGRCCPZDATE,
				    T1.REPAYBASERATE,
				    T1.REPAYSPECIALRATE,
				    T1.REPAYPROFITRATE,
				    T1.REPAYFRQ,
				    T1.NEXTREPAYDATE,
				    T1.REPAYPFTFRQ,
				    T1.NEXTREPAYPFTDATE,
				    T1.ALLOWREPAYRVW,
				    T1.REPAYRVWFRQ,
				    T1.NEXTREPAYRVWDATE,
				    T1.ALLOWREPAYCPZ,
				    T1.REPAYCPZFRQ,
				    T1.NEXTREPAYCPZDATE,
				    T1.MATURITYDATE,
				    T1.CPZATGRACEEND,
				    T1.DOWNPAYMENT,
				    T1.GRACEFLATAMOUNT,
				    T1.REQREPAYAMOUNT,
				    T1.TOTALPROFIT,
				    T1.TOTALCPZ,
				    T1.TOTALGROSSPFT,
				    T1.TOTALGRACEPFT,
				    T1.TOTALGRACECPZ,
				    T1.GRCRATEBASIS,
				    T1.REPAYRATEBASIS,
				    T1.FINTYPE,
				    T1.FINREMARKS,
				    T1.FINCCY,
				    T1.SCHEDULEMETHOD,
				    T1.PROFITDAYSBASIS,
				    T1.REQMATURITY,
				    T1.CALTERMS,
				    T1.CALMATURITY,
				    T1.FIRSTREPAY,
				    T1.LASTREPAY,
				    T1.FINSTARTDATE,
				    T1.FINAMOUNT,
				    T1.FINREPAYMENTAMOUNT,
				    T1.CUSTID,
				    T1.DEFFERMENTS,
				    T1.PLANDEFERCOUNT,
				    T1.FINISACTIVE,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T15.CUSTCIF  LOVDESCCUSTCIF,
				    T7.FINTYPEDESC  LOVDESCFINTYPENAME,
				    T1.FINBRANCH,
				    T1.FINSOURCEID,
				    T1.ALLOWEDDEFRPYCHANGE,
				    T1.AVAILEDDEFRPYCHANGE,
				    T1.ALLOWEDDEFFRQCHANGE,
				    T1.AVAILEDDEFFRQCHANGE,
				    T7.FINMAXAMOUNT  LOVDESCFINMAXAMT,
				    T7.FINMINAMOUNT  LOVDESCFINMINAMOUNT,
				    T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
				    T1.MINDOWNPAYPERC,
				    T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
				    T1.RECALTYPE,
				    T1.FINASSETVALUE,
				    T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
				    T1.LASTREPAYDATE,
				    T1.LASTREPAYPFTDATE,
				    T1.LASTREPAYRVWDATE,
				    T1.LASTREPAYCPZDATE,
				    T1.DISBACCOUNTID,
				    T1.REPAYACCOUNTID,
				    T1.ALLOWGRCREPAY,
				    T1.GRCSCHDMTHD,
				    T1.REPAYMARGIN,
				    T1.GRCMARGIN,
				    T1.DEPRECIATIONFRQ,
				    T1.FINCOMMITMENTREF,
				    T1.FINCURRASSETVALUE,
				    T1.FINCONTRACTDATE,
				    T1.NEXTDEPDATE,
				    T1.LASTDEPDATE,
				    T1.FINACCOUNT,
				    T1.FINCUSTPFTACCOUNT,
				    T7.FINRVWRATEAPPLFOR,
				    T1.TOTALREPAYAMT,
				    T1.CLOSINGSTATUS,
				    T1.FINAPPROVEDDATE,
				    T1.FINREPAYPFTONFRQ,
				    T1.ANUALIZEDPERCRATE,
				    T1.EFFECTIVERATEOFRETURN,
				    T1.DOWNPAYBANK,
				    T1.DOWNPAYSUPL,
				    T7.FINDIVISION AS LOVDESCFINDIVISIONNAME,
				    T1.GRACETERMS,
				    T14.FACILITYTYPE,
				    T15.CUSTSHRTNAME AS LOVDESCCUSTSHRTNAME,
				    T16.BRANCHDESC AS LOVDESCFINBRANCHNAME,
				    T1.TOTALGROSSGRCPFT,
				    T1.GRCPROFITDAYSBASIS,
				    T1.STEPFINANCE,
				    T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T7.PRODUCT AS LOVDESCFINPRODUCT,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.FEEACCOUNTID,
				    T1.TDSAPPLICABLE,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.FEECHARGEAMT,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.FINCATEGORY,
				    T1.PRODUCTCATEGORY,
				    T1.ROUNDINGTARGET,
				    T1.GRCMAXAMOUNT,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS,
				    T1.FIXEDTENORRATE,
				    T1.FIXEDRATETENOR,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND
				   FROM WIFFINANCEMAIN_TEMP T1
				     LEFT JOIN WIFINDICATIVETERMDETAIL_TEMP T14 ON T14.FINREFERENCE = T1.FINREFERENCE
				     LEFT JOIN CUSTOMERS T15 ON T15.CUSTID = T1.CUSTID
				     JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
				     LEFT JOIN RMTBRANCHES T16 ON T1.FINBRANCH = T16.BRANCHCODE
				UNION ALL
				 SELECT T1.FINREFERENCE,
				    T1.NUMBEROFTERMS,
				    T1.GRCPERIODENDDATE,
				    T1.ALLOWGRCPERIOD,
				    T1.GRACEBASERATE,
				    T1.GRACESPECIALRATE,
				    T1.GRCPFTRATE,
				    T1.GRCPFTFRQ,
				    T1.NEXTGRCPFTDATE,
				    T1.ALLOWGRCPFTRVW,
				    T1.GRCPFTRVWFRQ,
				    T1.NEXTGRCPFTRVWDATE,
				    T1.ALLOWGRCCPZ,
				    T1.GRCCPZFRQ,
				    T1.NEXTGRCCPZDATE,
				    T1.REPAYBASERATE,
				    T1.REPAYSPECIALRATE,
				    T1.REPAYPROFITRATE,
				    T1.REPAYFRQ,
				    T1.NEXTREPAYDATE,
				    T1.REPAYPFTFRQ,
				    T1.NEXTREPAYPFTDATE,
				    T1.ALLOWREPAYRVW,
				    T1.REPAYRVWFRQ,
				    T1.NEXTREPAYRVWDATE,
				    T1.ALLOWREPAYCPZ,
				    T1.REPAYCPZFRQ,
				    T1.NEXTREPAYCPZDATE,
				    T1.MATURITYDATE,
				    T1.CPZATGRACEEND,
				    T1.DOWNPAYMENT,
				    T1.GRACEFLATAMOUNT,
				    T1.REQREPAYAMOUNT,
				    T1.TOTALPROFIT,
				    T1.TOTALCPZ,
				    T1.TOTALGROSSPFT,
				    T1.TOTALGRACEPFT,
				    T1.TOTALGRACECPZ,
				    T1.GRCRATEBASIS,
				    T1.REPAYRATEBASIS,
				    T1.FINTYPE,
				    T1.FINREMARKS,
				    T1.FINCCY,
				    T1.SCHEDULEMETHOD,
				    T1.PROFITDAYSBASIS,
				    T1.REQMATURITY,
				    T1.CALTERMS,
				    T1.CALMATURITY,
				    T1.FIRSTREPAY,
				    T1.LASTREPAY,
				    T1.FINSTARTDATE,
				    T1.FINAMOUNT,
				    T1.FINREPAYMENTAMOUNT,
				    T1.CUSTID,
				    T1.DEFFERMENTS,
				    T1.PLANDEFERCOUNT,
				    T1.FINISACTIVE,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T15.CUSTCIF  LOVDESCCUSTCIF,
				    T7.FINTYPEDESC  LOVDESCFINTYPENAME,
				    T1.FINBRANCH,
				    T1.FINSOURCEID,
				    T1.ALLOWEDDEFRPYCHANGE,
				    T1.AVAILEDDEFRPYCHANGE,
				    T1.ALLOWEDDEFFRQCHANGE,
				    T1.AVAILEDDEFFRQCHANGE,
				    T7.FINMAXAMOUNT  LOVDESCFINMAXAMT,
				    T7.FINMINAMOUNT  LOVDESCFINMINAMOUNT,
				    T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
				    T1.MINDOWNPAYPERC,
				    T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
				    T1.RECALTYPE,
				    T1.FINASSETVALUE,
				    T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
				    T1.LASTREPAYDATE,
				    T1.LASTREPAYPFTDATE,
				    T1.LASTREPAYRVWDATE,
				    T1.LASTREPAYCPZDATE,
				    T1.DISBACCOUNTID,
				    T1.REPAYACCOUNTID,
				    T1.ALLOWGRCREPAY,
				    T1.GRCSCHDMTHD,
				    T1.REPAYMARGIN,
				    T1.GRCMARGIN,
				    T1.DEPRECIATIONFRQ,
				    T1.FINCOMMITMENTREF,
				    T1.FINCURRASSETVALUE,
				    T1.FINCONTRACTDATE,
				    T1.NEXTDEPDATE,
				    T1.LASTDEPDATE,
				    T1.FINACCOUNT,
				    T1.FINCUSTPFTACCOUNT,
				    T7.FINRVWRATEAPPLFOR,
				    T1.TOTALREPAYAMT,
				    T1.CLOSINGSTATUS,
				    T1.FINAPPROVEDDATE,
				    T1.FINREPAYPFTONFRQ,
				    T1.ANUALIZEDPERCRATE,
				    T1.EFFECTIVERATEOFRETURN,
				    T1.DOWNPAYBANK,
				    T1.DOWNPAYSUPL,
				    T7.FINDIVISION AS LOVDESCFINDIVISIONNAME,
				    T1.GRACETERMS,
				    T14.FACILITYTYPE,
				    T15.CUSTSHRTNAME AS LOVDESCCUSTSHRTNAME,
				    T16.BRANCHDESC AS LOVDESCFINBRANCHNAME,
				    T1.TOTALGROSSGRCPFT,
				    T1.GRCPROFITDAYSBASIS,
				    T1.STEPFINANCE,
				    T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T7.PRODUCT AS LOVDESCFINPRODUCT,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.FEEACCOUNTID,
				    T1.TDSAPPLICABLE,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.FEECHARGEAMT,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.FINCATEGORY,
				    T1.PRODUCTCATEGORY,
				    T1.ROUNDINGTARGET,
				    T1.GRCMAXAMOUNT,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS,
				    T1.FIXEDTENORRATE,
				    T1.FIXEDRATETENOR,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND
				   FROM WIFFINANCEMAIN T1
				     LEFT JOIN WIFINDICATIVETERMDETAIL_TEMP T14 ON T14.FINREFERENCE = T1.FINREFERENCE
				     LEFT JOIN CUSTOMERS T15 ON T15.CUSTID = T1.CUSTID
				     JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
				     LEFT JOIN RMTBRANCHES T16 ON T1.FINBRANCH = T16.BRANCHCODE
				  WHERE NOT (EXISTS ( SELECT 1
				  FROM WIFFINANCEMAIN_TEMP
				  WHERE WIFFINANCEMAIN_TEMP.FINREFERENCE = T1.FINREFERENCE))
		</createView>
	</changeSet>

	<changeSet id="172_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'wiffinancemain_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="173_pre" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'wiffinancemain_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="173" author="satyanarayana.g">
		<createView viewName="WIFFINANCEMAIN_AVIEW"
			replaceIfExists="true">
			SELECT T1.FINREFERENCE,
				    T1.NUMBEROFTERMS,
				    T1.GRCPERIODENDDATE,
				    T1.ALLOWGRCPERIOD,
				    T1.GRACEBASERATE,
				    T1.GRACESPECIALRATE,
				    T1.GRCPFTRATE,
				    T1.GRCPFTFRQ,
				    T1.NEXTGRCPFTDATE,
				    T1.ALLOWGRCPFTRVW,
				    T1.GRCPFTRVWFRQ,
				    T1.NEXTGRCPFTRVWDATE,
				    T1.ALLOWGRCCPZ,
				    T1.GRCCPZFRQ,
				    T1.NEXTGRCCPZDATE,
				    T1.REPAYBASERATE,
				    T1.REPAYSPECIALRATE,
				    T1.REPAYPROFITRATE,
				    T1.REPAYFRQ,
				    T1.NEXTREPAYDATE,
				    T1.REPAYPFTFRQ,
				    T1.NEXTREPAYPFTDATE,
				    T1.ALLOWREPAYRVW,
				    T1.REPAYRVWFRQ,
				    T1.NEXTREPAYRVWDATE,
				    T1.ALLOWREPAYCPZ,
				    T1.REPAYCPZFRQ,
				    T1.NEXTREPAYCPZDATE,
				    T1.MATURITYDATE,
				    T1.CPZATGRACEEND,
				    T1.DOWNPAYMENT,
				    T1.GRACEFLATAMOUNT,
				    T1.REQREPAYAMOUNT,
				    T1.TOTALPROFIT,
				    T1.TOTALCPZ,
				    T1.TOTALGROSSPFT,
				    T1.TOTALGRACEPFT,
				    T1.TOTALGRACECPZ,
				    T1.GRCRATEBASIS,
				    T1.REPAYRATEBASIS,
				    T1.FINTYPE,
				    T1.FINREMARKS,
				    T1.FINCCY,
				    T1.SCHEDULEMETHOD,
				    T1.PROFITDAYSBASIS,
				    T1.REQMATURITY,
				    T1.CALTERMS,
				    T1.CALMATURITY,
				    T1.FIRSTREPAY,
				    T1.LASTREPAY,
				    T1.FINSTARTDATE,
				    T1.FINAMOUNT,
				    T1.FINREPAYMENTAMOUNT,
				    T1.CUSTID,
				    T1.DEFFERMENTS,
				    T1.PLANDEFERCOUNT,
				    T1.FINISACTIVE,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T15.CUSTCIF  LOVDESCCUSTCIF,
				    T7.FINTYPEDESC  LOVDESCFINTYPENAME,
				    T1.FINBRANCH,
				    T1.FINSOURCEID,
				    T1.ALLOWEDDEFRPYCHANGE,
				    T1.AVAILEDDEFRPYCHANGE,
				    T1.ALLOWEDDEFFRQCHANGE,
				    T1.AVAILEDDEFFRQCHANGE,
				    T7.FINMAXAMOUNT  LOVDESCFINMAXAMT,
				    T7.FINMINAMOUNT  LOVDESCFINMINAMOUNT,
				    T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
				    T1.MINDOWNPAYPERC,
				    T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
				    T1.RECALTYPE,
				    T1.FINASSETVALUE,
				    T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
				    T1.LASTREPAYDATE,
				    T1.LASTREPAYPFTDATE,
				    T1.LASTREPAYRVWDATE,
				    T1.LASTREPAYCPZDATE,
				    T1.DISBACCOUNTID,
				    T1.REPAYACCOUNTID,
				    T1.ALLOWGRCREPAY,
				    T1.GRCSCHDMTHD,
				    T1.REPAYMARGIN,
				    T1.GRCMARGIN,
				    T1.DEPRECIATIONFRQ,
				    T1.FINCOMMITMENTREF,
				    T1.FINCURRASSETVALUE,
				    T1.FINCONTRACTDATE,
				    T1.NEXTDEPDATE,
				    T1.LASTDEPDATE,
				    T1.FINACCOUNT,
				    T1.FINCUSTPFTACCOUNT,
				    T7.FINRVWRATEAPPLFOR,
				    T1.TOTALREPAYAMT,
				    T1.CLOSINGSTATUS,
				    T1.FINAPPROVEDDATE,
				    T1.FINREPAYPFTONFRQ,
				    T1.ANUALIZEDPERCRATE,
				    T1.EFFECTIVERATEOFRETURN,
				    T1.DOWNPAYBANK,
				    T1.DOWNPAYSUPL,
				    T7.FINDIVISION  LOVDESCFINDIVISIONNAME,
				    T1.GRACETERMS,
				    T14.FACILITYTYPE,
				    T15.CUSTSHRTNAME  LOVDESCCUSTSHRTNAME,
				    T16.BRANCHDESC  LOVDESCFINBRANCHNAME,
				    T1.TOTALGROSSGRCPFT,
				    T1.GRCPROFITDAYSBASIS,
				    T1.STEPFINANCE,
				    T1.STEPTYPE,
				    T1.STEPPOLICY,
				    T1.ALWMANUALSTEPS,
				    T1.NOOFSTEPS,
				    T1.LINKEDFINREF,
				    T7.PRODUCT  LOVDESCFINPRODUCT,
				    T1.GRCMINRATE,
				    T1.GRCMAXRATE,
				    T1.RPYMINRATE,
				    T1.RPYMAXRATE,
				    T1.MANUALSCHEDULE,
				    T1.TAKEOVERFINANCE,
				    T1.GRCADVBASERATE,
				    T1.GRCADVMARGIN,
				    T1.GRCADVPFTRATE,
				    T1.RPYADVBASERATE,
				    T1.RPYADVMARGIN,
				    T1.RPYADVPFTRATE,
				    T1.SUPPLEMENTRENT,
				    T1.INCREASEDCOST,
				    T1.FEEACCOUNTID,
				    T1.TDSAPPLICABLE,
				    T1.INSURANCEAMT,
				    T1.DEDUCTINSDISB,
				    T1.ALWBPI,
				    T1.BPITREATMENT,
				    T1.PLANEMIHALW,
				    T1.PLANEMIHMETHOD,
				    T1.PLANEMIHMAXPERYEAR,
				    T1.PLANEMIHMAX,
				    T1.PLANEMIHLOCKPERIOD,
				    T1.PLANEMICPZ,
				    T1.CALROUNDINGMODE,
				    T1.ALWMULTIDISB,
				    T1.BPIAMOUNT,
				    T1.DEDUCTFEEDISB,
				    T1.FEECHARGEAMT,
				    T1.RVWRATEAPPLFOR,
				    T1.SCHCALONRVW,
				    T1.PASTDUEPFTCALMTHD,
				    T1.PASTDUEPFTMARGIN,
				    T1.DROPPINGMETHOD,
				    T1.RATECHGANYDAY,
				    T1.ROUNDINGTARGET,
				    T1.GRCMAXAMOUNT,
				    T1.ADVANCEEMI,
				    T1.ADVEMITERMS,
				    T1.BPIPFTDAYSBASIS  BPIRATEBASIS,
				    T1.GRCADVTYPE,
				    T1.GRCADVTERMS,
				    T1.ADVTYPE,
				    T1.ADVTERMS,
				    T1.ADVSTAGE,
				    T1.ALLOWDRAWINGPOWER,
				    T1.ALLOWREVOLVING,
				    T1.APPLIEDLOANAMT,
				    T1.FINISRATERVWATGRCEND
				   FROM WIFFINANCEMAIN T1
				     LEFT JOIN WIFINDICATIVETERMDETAIL_TEMP T14 ON T14.FINREFERENCE = T1.FINREFERENCE
				     LEFT JOIN CUSTOMERS T15 ON T15.CUSTID = T1.CUSTID
				     JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
				     LEFT JOIN RMTBRANCHES T16 ON T1.FINBRANCH = T16.BRANCHCODE
		</createView>
	</changeSet>

	<changeSet id="173_post" author="satyanarayana.g" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'wiffinancemain_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="174" author="satyanarayana.g">
		<sql>
			<![CDATA[
				UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			 	UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS);
			 	 
			 	DELETE FROM SECGROUPRIGHTS Where GRPID = (SELECT GRPID FROM SECGROUPS WHERE GRPCODE='BFSD_ORIGINATION_MAKER') AND RIGHTID = (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='FinanceMainDialog_FinIsRateRvwAtGrcEnd');
			 	DELETE FROM SECRIGHTS Where RightName = 'FinanceMainDialog_FinIsRateRvwAtGrcEnd';
			 	 
				INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3,'FinanceMainDialog_FinIsRateRvwAtGrcEnd','FinanceMainDialog', 0, 1000,CURRENT_TIMESTAMP,'',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
 				INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS),(SELECT GRPID FROM SECGROUPS WHERE GRPCODE='BFSD_ORIGINATION_MAKER'),(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='FinanceMainDialog_FinIsRateRvwAtGrcEnd'), 1, 0, 1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0); 
			 
			    UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			    UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS);
			]]>
		</sql>
	</changeSet>


	<changeSet id="175" author="Saikiran.V">
		<sql>
			<![CDATA[
				Delete from SMTParameters where SysParmCode = 'ALLOW_EOD_SNAPSHOT';
				INSERT INTO SMTparameters  VALUES ('ALLOW_EOD_SNAPSHOT', 'Allow Eod SnapShot', 'String', '1', 'N', 1, 0, NULL, NULL, 'Allow Eod SnapShot.', 1, 1000, CURRENT_TIMESTAMP,'Approved', NULL, NULL, NULL, NULL, NULL, 0);
			]]>
		</sql>
	</changeSet>

	<changeSet id="176" author="Saikiran.V">
		<addColumn tableName="FINPFTDETAILS_SNAPSHOT">
			<column name="ACTUALODDAYS" type="int" />
		</addColumn>
	</changeSet>

	<changeSet id="177" author="Saikiran.V">
		<addColumn tableName="FINODDETAILS_SNAPSHOT">
			<column name="LpCpz" type="boolean" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="178" author="Saikiran.V">
		<addColumn tableName="FINODDETAILS_SNAPSHOT">
			<column name="LockODRecalCal" type="Boolean" defaultValue="0">
			</column>
		</addColumn>
	</changeSet>

	<changeSet id="179" author="Saikiran.V">
		<addColumn tableName="FINODDETAILS_SNAPSHOT">
			<column name="LpCpzAmount" type="decimal(18,0)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="180" author="Saikiran.V">
		<addColumn tableName="FINODDETAILS_SNAPSHOT">
			<column name="LpCurCpzBal" type="decimal(18,0)" defaultValue="0" />
		</addColumn>
	</changeSet>

	<changeSet id="181" author="murthy.y">
		<sql>
	    	<![CDATA[
	        	update FINODDETAILS_SNAPSHOT set LpCpz = 0 where LpCpz is null;
	        	update FINODDETAILS_SNAPSHOT set LockODRecalCal = 0 where LockODRecalCal is null;
			]]>
		</sql>
	</changeSet>

	<changeSet id="182" author="meena.a">
		<comment>extra fields added in Commitments</comment>
		<addColumn tableName="Commitments">
			<column name="BankingArrangement" type="char(1)" />
		</addColumn>
	</changeSet>

	<changeSet id="183" author="meena.a">
		<comment>extra fields added in Commitments</comment>
		<addColumn tableName="Commitments">
			<column name="LimitCondition" type="char(1)" />
		</addColumn>
	</changeSet>

	<changeSet id="184" author="meena.a">
		<comment>extra fields added in Commitments</comment>
		<addColumn tableName="Commitments">
			<column name="ExternalRef" type="varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="185" author="meena.a">
		<comment>extra fields added in Commitments</comment>
		<addColumn tableName="Commitments">
			<column name="ExternalRef1" type="varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="186" author="meena.a">
		<comment>extra fields added in Commitments</comment>
		<addColumn tableName="Commitments">
			<column name="Tenor" type="int" />
		</addColumn>
	</changeSet>

	<changeSet id="187" author="meena.a">
		<comment>extra fields added in Commitments_temp</comment>
		<addColumn tableName="Commitments_temp">
			<column name="BankingArrangement" type="char(1)" />
		</addColumn>
	</changeSet>

	<changeSet id="188" author="meena.a">
		<comment>extra fields added in Commitments_temp</comment>
		<addColumn tableName="Commitments_temp">
			<column name="LimitCondition" type="char(1)" />
		</addColumn>
	</changeSet>

	<changeSet id="189" author="meena.a">
		<comment>extra fields added in Commitments_temp</comment>
		<addColumn tableName="Commitments_temp">
			<column name="ExternalRef" type="varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="190" author="meena.a">
		<comment>extra fields added in Commitments</comment>
		<addColumn tableName="Commitments_temp">
			<column name="ExternalRef1" type="varchar(50)" />
		</addColumn>
	</changeSet>

	<changeSet id="191" author="meena.a">
		<comment>extra fields added in Commitments_temp</comment>
		<addColumn tableName="Commitments_temp">
			<column name="Tenor" type="int" />
		</addColumn>
	</changeSet>

	<changeSet id="192" author="meena.a">
		<createView viewName="COMMITMENTS_AVIEW" replaceIfExists="true">
		SELECT   t1.cmtreference,
			t1.custid,
			t2.custshrtname,
			t1.cmtbranch,
			t3.branchdesc,
			t1.openaccount,
			t1.cmtaccount,
			t1.cmtccy,
			t1.cmtpftratemin,
			t1.cmtpftratemax,
			t1.cmtamount,
			t1.cmtutilizedamount,
			t1.cmtavailable,
			t1.cmtpromiseddate,
			t1.cmtstartdate,
			t1.cmtexpdate,
			t1.cmtrvwdate,
			t1.cmttitle,
			t1.cmtnotes,
			t1.revolving,
			t1.sharedcmt,
			t1.multibranch,
			t1.facilityref,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.cmtstopraterange,
			t1.cmtactive,
			t1.nonperforming,
			t1.cmtcharges,
			t1.chargesaccount,
			t2.custcif,
			t6.fintypedesc AS facilityrefdesc,
			t1.cmtavailablemonths,
			t1.collateralrequired,
			t1.cmtenddate,
			t1.limitlineid,
			t4.CcyEditField,
			t1.BankingArrangement,
			t1.LimitCondition,
			t1.ExternalRef, 
			t1.ExternalRef1, 
			t1.Tenor
			from commitments t1
			JOIN customers t2 ON t1.custid = t2.custid
			JOIN rmtbranches t3 ON t1.cmtbranch = t3.branchcode
			JOIN RMTCurrencies t4 ON T1.CmtCcy = T4.CcyCode
			JOIN limitdetails t5 ON t1.limitlineid = t5.detailid
			LEFT JOIN rmtfinancetypes t6 ON t1.facilityref = t6.fintype
		</createView>
	</changeSet>


	<changeSet id="193" author="meena.a">
		<createView viewName="COMMITMENTS_VIEW" replaceIfExists="true">
						SELECT        T1.CmtReference, T1.custID, T2.CustShrtName, T1.CmtBranch, T3.BranchDesc, T1.OpenAccount, T1.CmtAccount, T1.CmtCcy,  T1.CmtPftRateMin, 
									  T1.CmtPftRateMax, T1.CmtAmount, T1.CmtUtilizedAmount, T1.CmtAvailable, T1.CmtPromisedDate, T1.CmtStartDate, T1.CmtExpDate, T1.CmtRvwDate, 
									  T1.CmtTitle, T1.CmtNotes, T1.Revolving, T1.SharedCmt, T1.MultiBranch, T1.FacilityRef, T1.Version, T1.LastMntBy, T1.LastMntOn,  
									  T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId, T1.CmtStopRateRange, T1.CmtActive, 
									  T1.NonPerforming,T1.CmtCharges, T1.ChargesAccount, T2.CustCIF, T6.FinTypeDesc FacilityRefDesc,
									  T1.CmtAvailableMonths, T1.CollateralRequired, T1.CmtEndDate, T1.LimitLineId, T1.BankingArrangement, T1.LimitCondition, T1.ExternalRef, T1.ExternalRef1,T1.Tenor
				        FROM          Commitments_Temp T1 INNER JOIN
									  Customers T2 ON T1.custID = T2.CustID INNER JOIN
									  RMTBranches T3 ON T1.CmtBranch = T3.BranchCode  INNER JOIN
									  LimitDetails T5 ON T1.LimitLineId = T5.DetailId LEFT OUTER JOIN
									  RMTFinanceTypes T6 ON T1.FacilityRef = T6.FinType
				   UNION ALL
				SELECT                T1.CmtReference, T1.custID, T2.CustShrtName, T1.CmtBranch, T3.BranchDesc, T1.OpenAccount, T1.CmtAccount, T1.CmtCcy,  T1.CmtPftRateMin, 
									  T1.CmtPftRateMax, T1.CmtAmount, T1.CmtUtilizedAmount, T1.CmtAvailable, T1.CmtPromisedDate, T1.CmtStartDate, T1.CmtExpDate, T1.CmtRvwDate, 
									  T1.CmtTitle, T1.CmtNotes,T1.Revolving, T1.SharedCmt, T1.MultiBranch, T1.FacilityRef, T1.Version, T1.LastMntBy, T1.LastMntOn,  
									  T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId, T1.CmtStopRateRange, 
									  T1.CmtActive, T1.NonPerforming, T1.CmtCharges, T1.ChargesAccount, T2.CustCIF, T6.FinTypeDesc FacilityRefDesc,
									  T1.CmtAvailableMonths, T1.CollateralRequired, T1.CmtEndDate, T1.LimitLineId ,T1.BankingArrangement, T1.LimitCondition, T1.ExternalRef, T1.ExternalRef,T1.Tenor
				FROM         		  Commitments T1 INNER JOIN
									  Customers T2 ON T1.custID = T2.CustID INNER JOIN
									  RMTBranches T3 ON T1.CmtBranch = T3.BranchCode INNER JOIN
									  LimitDetails T5 ON T1.LimitLineId = T5.DetailId LEFT OUTER JOIN
									  RMTFinanceTypes T6 ON T1.FacilityRef = T6.FinType
				WHERE     NOT EXISTS
										  (SELECT     1
											FROM          Commitments_TEMP
											WHERE      CmtReference = T1.CmtReference)

		</createView>
	</changeSet>


	<changeSet id="194" author="meena.a">
		<createView viewName="COMMITMENTS_TVIEW" replaceIfExists="true">
						SELECT     T1.CmtReference, T1.custID, T2.CustShrtName, T1.CmtBranch, T3.BranchDesc, T1.OpenAccount, T1.CmtAccount, T1.CmtCcy, T1.CmtPftRateMin, 
                      T1.CmtPftRateMax, T1.CmtAmount, T1.CmtUtilizedAmount, T1.CmtAvailable, T1.CmtPromisedDate, T1.CmtStartDate, T1.CmtExpDate, T1.CmtRvwDate, 
					  T1.CmtTitle, T1.CmtNotes, T1.Revolving, T1.SharedCmt, T1.MultiBranch, T1.FacilityRef, T1.Version, T1.LastMntBy, T1.LastMntOn, T1.RecordStatus, T1.RoleCode, T1.NextRoleCode, T1.TaskId, T1.NextTaskId, T1.RecordType, T1.WorkflowId, T1.CmtStopRateRange, T1.CmtActive, T1.NonPerforming, 
					  T1.CmtCharges, T1.ChargesAccount, T2.CustCIF, T6.FinTypeDesc FacilityRefDesc,
					  T1.CmtAvailableMonths, T1.CollateralRequired, T1.CmtEndDate, T1.LimitLineId, T1.BankingArrangement, T1.LimitCondition, T1.ExternalRef, T1.ExternalRef1,T1.Tenor

     FROM		      Commitments_Temp T1 INNER JOIN
                      Customers T2 ON T1.custID = T2.CustID INNER JOIN
                      RMTBranches T3 ON T1.CmtBranch = T3.BranchCode  INNER JOIN
					  LimitDetails T5 ON T1.LimitLineId = T5.DetailId LEFT OUTER JOIN
                      RMTFinanceTypes T6 ON T1.FacilityRef = T6.FinType
		</createView>
	</changeSet>

	<changeSet id="195" author="meena.a">
		<sql>
		   <![CDATA[
			 update SeqSecGroups set SeqNo = (select max(grpid)+1 from SECGROUPS);
			 update SeqSecRights set SeqNo = (select max(RightID)+1 from SECRIGHTS);
			 update SeqSecGroupRights set SeqNo = (select max(GRPRIGHTID)+1 from SECGROUPRIGHTS);
			 
			 INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3, 
             'CommitmentDialog_BankingArrangement','CommitmentDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);

             insert into SecGroupRights Values((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE='COMMITMENT_MAKER'), (select RightID from SecRights WHERE RightName='CommitmentDialog_BankingArrangement'),1,0,10000,current_timestamp,' ',' ',' ',' ',' ',' ',0 );
 
              INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3, 
             'CommitmentDialog_LimitCondition','CommitmentDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);

             insert into SecGroupRights Values((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE='COMMITMENT_MAKER'),
              (select RightID from SecRights WHERE RightName='CommitmentDialog_LimitCondition'),1,0,10000,current_timestamp,' ',' ',' ',' ',' ',' ',0 );
 
             INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3, 
             'CommitmentDialog_ExternalRef','CommitmentDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);

             insert into SecGroupRights Values((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE='COMMITMENT_MAKER'),
              (select RightID from SecRights WHERE RightName='CommitmentDialog_ExternalRef'),1,0,10000,current_timestamp,' ',' ',' ',' ',' ',' ',0 );
 
              INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3, 
             'CommitmentDialog_ExternalRef1','CommitmentDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);

             insert into SecGroupRights Values((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE='COMMITMENT_MAKER'),
              (select RightID from SecRights WHERE RightName='CommitmentDialog_ExternalRef1'),1,0,10000,current_timestamp,' ',' ',' ',' ',' ',' ',0 );
 
             INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),3, 
             'CommitmentDialog_Tenor','CommitmentDialog',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);

             insert into SecGroupRights Values((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE='COMMITMENT_MAKER'),
              (select RightID from SecRights WHERE RightName='CommitmentDialog_Tenor'),1,0,10000,current_timestamp,' ',' ',' ',' ',' ',' ',0 );
 
 			 update SeqSecGroups set SeqNo = (select max(grpid)+1 from SECGROUPS);
			 update SeqSecRights set SeqNo = (select max(RightID)+1 from SECRIGHTS);
			 update SeqSecGroupRights set SeqNo = (select max(GRPRIGHTID)+1 from SECGROUPRIGHTS);
		    ]]>
		</sql>
	</changeSet>
	
	<changeSet id="196" author="vijaya.a">
		<sql>
			<![CDATA[
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecRoles set SeqNo = (Select max(RoleId)  from SecRoles);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights);
				Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId) from SecRoleGroups);
				
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CD_LOANQUEUE_VIEW',			'Group for Covenant Types enquiry', 	1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CD_LOANQUEUE_MAKER',			'Group for Covenant Types maker', 		1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CD_LOANQUEUE_APPROVER',		'Group for Covenant Types approver', 	1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),0, 'menuItem_CD_LOANQUEUE','MENU',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CD_LOANQUEUE_VIEW'), (Select RightID from SecRights where RightName = 'menuItem_CD_LOANQUEUE'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CD_LOANQUEUE_MAKER'), (Select RightID from SecRights where RightName = 'menuItem_CD_LOANQUEUE'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CD_LOANQUEUE_APPROVER'), (Select RightID from SecRights where RightName = 'menuItem_CD_LOANQUEUE'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
				Insert into secRoleGroups Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='CD_LOANQUEUE_VIEW'),(select RoleID from secRoles where RoleCd='CD_LOANQUEUE_VIEW'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				Insert into secRoleGroups Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='CD_LOANQUEUE_MAKER'),(select RoleID from secRoles where RoleCd='CD_LOANQUEUE_MAKER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				Insert into secRoleGroups Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='CD_LOANQUEUE_APPROVER'),(select RoleID from secRoles where RoleCd='CD_LOANQUEUE_APPROVER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecRoles set SeqNo = (Select max(RoleId)  from SecRoles);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId)  from SecGroupRights);
				Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId)  from SecRoleGroups);
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="197" author="vijaya.a">
		<sql>
			<![CDATA[
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecRoles set SeqNo = (Select max(RoleId)  from SecRoles);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights);
				Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId) from SecRoleGroups);
				
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CD_SCHEME_VIEW',			'Group for Covenant Types enquiry', 	1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CD_SCHEME_MAKER',			'Group for Covenant Types maker', 		1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'CD_SCHEME_APPROVER',		'Group for Covenant Types approver', 	1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),0, 'menuItem_CD_SCHEME','MENU',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CD_SCHEME_VIEW'), (Select RightID from SecRights where RightName = 'menuItem_CD_SCHEME'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CD_SCHEME_MAKER'), (Select RightID from SecRights where RightName = 'menuItem_CD_SCHEME'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'CD_SCHEME_APPROVER'), (Select RightID from SecRights where RightName = 'menuItem_CD_SCHEME'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
				Insert into secRoleGroups Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='CD_SCHEME_VIEW'),(select RoleID from secRoles where RoleCd='CD_SCHEME_VIEW'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				Insert into secRoleGroups Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='CD_SCHEME_MAKER'),(select RoleID from secRoles where RoleCd='CD_SCHEME_MAKER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				Insert into secRoleGroups Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='CD_SCHEME_APPROVER'),(select RoleID from secRoles where RoleCd='CD_SCHEME_APPROVER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecRoles set SeqNo = (Select max(RoleId)  from SecRoles);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId)  from SecGroupRights);
				Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId)  from SecRoleGroups);
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="198" author="vijaya.a">
		<sql>
			<![CDATA[
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecRoles set SeqNo = (Select max(RoleId)  from SecRoles);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId) from SecGroupRights);
				Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId) from SecRoleGroups);
				
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'INDASREPORT_VIEW',			'Group for Covenant Types enquiry', 	1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'INDASREPORT_MAKER',			'Group for Covenant Types maker', 		1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				INSERT INTO SecGroups Values ((Select MAX(GrpID)+1 From SecGroups), 'INDASREPORT_APPROVER',		'Group for Covenant Types approver', 	1, 1000, CURRENT_TIMESTAMP, 'Approved', NULL, NULL, NULL, NULL,NULL, 0);
				
				INSERT INTO SecRights Values ((select max(RightId)+1 from SecRights),0, 'menu_Item_IndASReport','MENU',0,1000,current_timestamp,'Approved',NULL,NULL,NULL,NULL,NULL,0);
				
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'INDASREPORT_VIEW'), (Select RightID from SecRights where RightName = 'menu_Item_IndASReport'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'INDASREPORT_MAKER'), (Select RightID from SecRights where RightName = 'menu_Item_IndASReport'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO secGroupRights Values((Select max(GrpRightID) + 1 from SecGroupRights), (Select GrpID from SecGroups where GrpCode = 'INDASREPORT_APPROVER'), (Select RightID from SecRights where RightName = 'menu_Item_IndASReport'), 1, 1, 1000, current_timestamp, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
				Insert into secRoleGroups Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='INDASREPORT_VIEW'),(select RoleID from secRoles where RoleCd='INDASREPORT_VIEW'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				Insert into secRoleGroups Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='INDASREPORT_MAKER'),(select RoleID from secRoles where RoleCd='INDASREPORT_MAKER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				Insert into secRoleGroups Values ((select MAX(RoleGrpID)+1 From secRoleGroups),(select GrpID from SecGroups where grpCode='INDASREPORT_APPROVER'),(select RoleID from secRoles where RoleCd='INDASREPORT_APPROVER'), 0, 1000, current_timestamp, 'Approved', NULL, NULL, NULL, NULL, NULL, 0);
				
				Update SeqSecRights set SeqNo = (Select max(RightId) from SecRights);
				Update SeqSecGroups set SeqNo = (Select max(GrpId)  from SecGroups);
				Update SeqSecRoles set SeqNo = (Select max(RoleId)  from SecRoles);
				Update SeqSecGroupRights set SeqNo = (Select max(GrpRightId)  from SecGroupRights);
				Update SeqSecRoleGroups set SeqNo = (Select max(RoleGrpId)  from SecRoleGroups);
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="199" author="vijaya.a">
		<createView viewName="LIMITCUSTOMERS_VIEW" replaceIfExists="true">
			SELECT Distinct t1.custid, 
				t1.custcif, 
				t1.CustShrtName,
			    t1.CustCtgCode,
			    t1.CustFName,
			    t1.CustLName
			   FROM customers t1 
			   inner join LimitHeader t2 on t1.CustId != t2.customerId	
		</createView>
	</changeSet>
	
	<changeSet id="200" author="Varaprasad.K">
		<comment>New columns added for Raised user display in Deviations</comment>
		<addColumn tableName="FinanceDeviations">
			<column name="RaisedUser" type="varchar(50)" />
		</addColumn>
		<addColumn tableName="FinanceDeviations_Temp">
			<column name="RaisedUser" type="varchar(50)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="201.1" author="Varaprasad.K">
		<createView viewName="FinanceDeviations_view" replaceIfExists="true">
		   SELECT t1.deviationid,
				    t1.finreference,
				    t1.module,
				    t1.deviationcode,
				    t1.deviationtype,
				    t1.userrole,
				    t1.deviationvalue,
				    t1.delegationrole,
				    t1.approvalstatus,
				    t1.deviationdate,
				    t1.deviationuserid,
				    t1.delegateduserid,
				    t1.raisedUser
				   FROM financedeviations_temp t1
				UNION ALL
				 SELECT t1.deviationid,
				    t1.finreference,
				    t1.module,
				    t1.deviationcode,
				    t1.deviationtype,
				    t1.userrole,
				    t1.deviationvalue,
				    t1.delegationrole,
				    t1.approvalstatus,
				    t1.deviationdate,
				    t1.deviationuserid,
				    t1.delegateduserid,
				    t1.raisedUser
				   FROM financedeviations t1
				  WHERE NOT (EXISTS ( SELECT 1
				           FROM financedeviations_temp
				          WHERE financedeviations_temp.deviationid = t1.deviationid))
		</createView>
	</changeSet>
	
	<changeSet id="202" author="Varaprasad.K">
		<sql>
				<![CDATA[
				  	DELETE from SMTparameters WHERE SYSPARMCODE='MANUAL_DEVIATIONS_TRIGGERING_FOR_SAMEROLE';
					INSERT INTO SMTparameters  VALUES ('MANUAL_DEVIATIONS_TRIGGERING_FOR_SAMEROLE', 'To exclude manual deviations triggering for same role', 'String', '1', 'Y', 1, 0, NULL, NULL,'To exclude manual deviations triggering for same role', 1, 1000, CURRENT_TIMESTAMP,'Approved', '', '', '', '', '',0);
				]]>
		</sql>
	</changeSet>
	
	<changeSet id="203" author="Saikiran.V">
		<sql>
			<![CDATA[
			delete from TemplateFields where field='pc_interestInclAccrued';
			INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_interestInclAccrued', 'Interest Including Interest accrued till date', 'A', 'Putcall');

			delete from TemplateFields where field='pc_totPenal';
			INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_totPenal', 'Penal interest including accrued penal interest till (Date)', 'A', 'Putcall');
			
			delete from TemplateFields where field='pc_otherChargers';
			INSERT INTO TemplateFields(module, field, fielddesc, fieldformat, event) VALUES ('FIN', 'pc_otherChargers', 'Other Charges Receivable ', 'A', 'Putcall');
			]]>
		</sql>
	</changeSet>
</databaseChangeLog>