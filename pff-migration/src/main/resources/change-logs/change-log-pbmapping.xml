<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value="" dbms="oracle" />
	<property name="add.schema" value="" dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PLFAVANSEQC.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()" dbms="postgresql" />


	<changeSet id="pre_run_for_pgp" author="Adarsh" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>
	
			
	<changeSet id="ST#252" author="vijaya.a">
		<sql>
			<![CDATA[
				
				INSERT INTO SECGROUPS VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'FINTYPEPARTNERBANK_MAPPING_MAKER', 'Fin Type Parnerbank Mapping Maker Group', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPS VALUES ((SELECT MAX(GRPID)+1 FROM SECGROUPS), 'FINTYPEPARTNERBANK_MAPPING_APPROVER', 'Fin Type Parnerbank Mapping Approver Group', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
			
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 0, 'menu_Item_FinTypePartnerbankMapping', 'MENU', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_finType', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_Purpose', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_PaymentMode', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_PartnerBankID', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'FinTypePartnerBankMappingDialog_branch', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'button_FinTypePartnerBankMappingDialog_btnNew', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'button_FinTypePartnerBankMappingDialog_btnEdit', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'button_FinTypePartnerBankMappingDialog_btnDelete', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECRIGHTS VALUES ((SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 3, 'button_FinTypePartnerBankMappingDialog_btnSave', 'FinTypePartnerBankMappingDialog', 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
		
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_FinTypePartnerbankMapping'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_finType'), 1, 1, 1000, CURRENT_TIMESTAMP,NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_Purpose'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_PaymentMode'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_PartnerBankID'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'FinTypePartnerBankMappingDialog_branch'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnNew'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnEdit'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnDelete'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_MAKER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'menu_Item_FinTypePartnerbankMapping'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				INSERT INTO SECGROUPRIGHTS VALUES ((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID FROM SECGROUPS WHERE GRPCODE = 'FINTYPEPARTNERBANK_MAPPING_APPROVER'), (SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME = 'button_FinTypePartnerBankMappingDialog_btnSave'), 1, 1, 1000, CURRENT_TIMESTAMP, NULL, NULL, NULL, NULL, NULL, NULL, 0);
				
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="ST#252.1" author="vijaya.a">
		<addColumn tableName="FINTYPEPARTNERBANKS_Temp">
			<column name="BRANCHCODE" type="VARCHAR(12)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="ST#252.2" author="vijaya.a">
		<addColumn tableName="FINTYPEPARTNERBANKS">
			<column name="BRANCHCODE" type="VARCHAR(12)" />
		</addColumn>
	</changeSet>
	
	<changeSet id="ST#252.3" author="vijaya.a">
		<addColumn tableName="FINTYPEPARTNERBANKS_Temp">
			<column name="CLUSTERID" type="bigint" />
		</addColumn>
	</changeSet>
	
	<changeSet id="ST#252.3.1" author="vijaya.a">
		<addColumn tableName="FINTYPEPARTNERBANKS">
			<column name="CLUSTERID" type="bigint" />
		</addColumn>
	</changeSet>
	
	<changeSet id="ST#252.4_pre" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fintypepartnerbanks_view');
		 	]]>
		</sql>
	</changeSet>
	
	<changeSet id="ST#252.4" author="vijaya.a">
		<createView viewName="FINTYPEPARTNERBANKS_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT t1.id,
					t1.fintype,
					t5.fintypedesc,
					t1.purpose,
					t1.paymentmode,
					t1.partnerbankid,
					t1.version,
					t1.lastmntby,
					t1.lastmnton,
					t1.recordstatus,
					t1.rolecode,
					t1.nextrolecode,
					t1.taskid,
					t1.nexttaskid,
					t1.recordtype,
					t1.workflowid,
					t2.partnerbankcode,
					t2.partnerbankname,
					t1.vanApplicable,
					t1.branchcode,
					t3.branchdesc,
					t1.clusterId,
					t4.code clusterCode,
					t4.name,
					t4.clusterType
					FROM fintypepartnerbanks_temp t1
					LEFT JOIN partnerbanks t2 ON t1.partnerbankid = t2.partnerbankid
					LEFT JOIN rmtfinancetypes t5 ON t1.fintype = t5.fintype
					LEFT JOIN RMTBranches t3 ON t1.branchcode = t3.branchcode
					LEFT JOIN CLUSTERS t4 ON t1.clusterId = t4.Id
					UNION ALL
					SELECT t1.id,
					t1.fintype,
					t5.fintypedesc,
					t1.purpose,
					t1.paymentmode,
					t1.partnerbankid,
					t1.version,
					t1.lastmntby,
					t1.lastmnton,
					t1.recordstatus,
					t1.rolecode,
					t1.nextrolecode,
					t1.taskid,
					t1.nexttaskid,
					t1.recordtype,
					t1.workflowid,
					t2.partnerbankcode,
					t2.partnerbankname,
					t1.vanApplicable,
					t1.branchcode,
					t3.branchdesc,
					t1.clusterId,
					t4.code clusterCode,
					t4.name,
					t4.clusterType
					FROM fintypepartnerbanks t1
					LEFT JOIN rmtfinancetypes t5 ON t1.fintype = t5.fintype
					LEFT JOIN partnerbanks t2 ON t1.partnerbankid = t2.partnerbankid
					LEFT JOIN RMTBranches t3 ON t1.branchcode = t3.branchcode
					LEFT JOIN CLUSTERS t4 ON t1.clusterId = t4.Id
					WHERE NOT (EXISTS ( SELECT 1
					FROM fintypepartnerbanks_temp
					WHERE fintypepartnerbanks_temp.id = t1.id))
			]]>
		</createView>
	</changeSet>
	
	<changeSet id="ST#252.4_post" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fintypepartnerbanks_view');
			]]>
		</sql>
	</changeSet>
	
	<changeSet id="ST#252.5" author="vijaya.a" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fintypepartnerbanks_aview');
		 	]]>
		</sql>
	</changeSet>
	
	<changeSet id="ST#252.5" author="vijaya.a">
		<createView viewName="FINTYPEPARTNERBANKS_AVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT t1.id,
					t1.fintype,
					t3.fintypedesc,
					t1.purpose,
					t1.paymentmode,
					t1.partnerbankid,
					t1.version,
					t1.lastmntby,
					t1.lastmnton,
					t1.recordstatus,
					t1.rolecode,
					t1.nextrolecode,
					t1.taskid,
					t1.nexttaskid,
					t1.recordtype,
					t1.workflowid,
					t2.partnerbankcode,
					t2.partnerbankname,
					t2.active,
					t2.accountno,
					t2.actype AS accounttype,
					t4.entitycode,
					t1.vanApplicable,
					t1.branchcode,
					t5.branchdesc,
					t1.clusterId,
					t6.code clusterCode,
					t6.name,
					t6.clusterType
					FROM fintypepartnerbanks t1
					LEFT JOIN partnerbanks t2 ON t1.partnerbankid = t2.partnerbankid
					LEFT JOIN rmtfinancetypes t3 ON t1.fintype = t3.fintype
					LEFT JOIN smtdivisiondetail t4 ON t3.findivision = t4.divisioncode
					LEFT JOIN RMTBranches t5 ON t1.branchcode = t5.branchcode
					LEFT JOIN CLUSTERS t6 ON t1.clusterId = t6.Id
			]]>
		</createView>
	</changeSet>
	
	<changeSet id="ST#252.5_post" author="vijaya.a" dbms="postgress">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fintypepartnerbanks_aview');
			]]>
		</sql>
	</changeSet>
	
			
	<changeSet id="32.1.4_pre" author="vijaya.a" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_fcview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="32.1.4" author="vijaya.a">
		<createView viewName="FINRECEIPTHEADER_FCVIEW" replaceIfExists="true">
		<![CDATA[	
		   SELECT T1.RECEIPTID
					, T1.RECEIPTDATE
					, T1.RECEIPTTYPE
					, T1.RECAGAINST
					, T2.FINID
					, T1.REFERENCE
					, T1.RECEIPTPURPOSE
					, T1.RECEIPTMODE
					, T1.EXCESSADJUSTTO
					, T1.ALLOCATIONTYPE
					, T1.RECEIPTAMOUNT
					, T1.EFFECTSCHDMETHOD
					, T1.RECEIPTMODESTATUS
					, T1.SUBRECEIPTMODE
					, T1.RECEIPTCHANNEL
					, T1.RECEIVEDFROM
					, T1.PANNUMBER
					, T1.COLLECTIONAGENTID
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T2.FINTYPE
					, T2.FINBRANCH
					, T3.CUSTCIF
					, T3.CUSTSHRTNAME
					, T2.FINCCY
					, T1.REALIZATIONDATE
					, T1.CANCELREASON
					, T4.FINTYPEDESC
					, T6.BRANCHDESC FINBRANCHDESC
					, T5.CCYDESC FINCCYDESC
					, T7.REJECTDESC CANCELREASONDESC
					, COALESCE(T2.FINISACTIVE, 0) FINISACTIVE
					, T2.SCHEDULEMETHOD
					, T2.PROFITDAYSBASIS PFTDAYSBASIS
					, T1.WAVIEDAMT
					, COALESCE(T3.CUSTID, 0) CUSTID
					, T1.TOTFEEAMOUNT
					, T1.BOUNCEDATE
					, T1.REMARKS
					, T1.RCDMAINTAINSTS
					, T1.DEPOSITPROCESS
					, T1.DEPOSITBRANCH
					, T1.LPIAMOUNT
					, T1.LPPAMOUNT
					, T1.GSTLPIAMOUNT
					, T1.GSTLPPAMOUNT
					, T1.GDRAVAILABLE
					, T1.RELEASETYPE
					, T1.THIRDPARTYNAME
					, T1.THIRDPARTYMOBILENUM
					, T2.PRODUCTCATEGORY
					, T2.PROMOTIONCODE
					, T2.NEXTREPAYRVWDATE
					, T1.CASHIERBRANCH
					, T1.INITIATEDATE
					, T1.INSTRUCTIONUID
					, T1.FINDIVISION
					, T1.POSTBRANCH
					, T10.DIVISIONCODEDESC FINDIVISIONDESC
					, T11.BRANCHDESC POSTBRANCHDESC
					, T12.BRANCHDESC CASHIERBRANCHDESC
					, T10.ENTITYCODE
					, T9.CODE COLLECTIONAGENTCODE
					, T9.DESCRIPTION COLLECTIONAGENTDESC
					, T1.MODULE
					, T1.EXTREFERENCE
					, T13.CUSTCIF CUSTOMERCIF
					, T13.CUSTSHRTNAME CUSTOMERNAME
					, T1.ACTFINRECEIPT
					, T1.REASONCODE
					, T1.CANCELREMARKS
					, T1.REFWAIVERAMT
					, T1.SOURCE
					, T1.VALUEDATE
					, T1.TRANSACTIONREF
					, T1.DEPOSITDATE
					, T1.PARTNERBANKID
					, T1.PRVRECEIPTPURPOSE
					, T1.RECEIPTSOURCE
					, T1.RECAPPDATE
					, T1.RECEIVEDDATE
					, T1.KNOCKOFFTYPE
					, T1.SOURCEOFFUND
					, T1.TDSAMOUNT
					, T1.CLOSURETYPEID
	      			, T14.CODE CLOSURETYPECODE
	      			, T14.DESCRIPTION CLOSURETYPEDESC
	      			, T1.RECADJAMT
					, T16.CODE FCREASONCODE
                    , T16.DESCRIPTION FCREASONCODEDESC
					, T17.PARTNERBANKCODE
				FROM FINRECEIPTHEADER_TEMP T1
				LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN CLOSURE_TYPES	T14 ON T14.ID = T1.CLOSURETYPEID
				LEFT JOIN REASONS T16 ON T16.ID = T1.REASONCODE
				LEFT JOIN PARTNERBANKS T17 ON T17.PARTNERBANKID = T1.PARTNERBANKID
				UNION ALL
				SELECT T1.RECEIPTID
					, T1.RECEIPTDATE
					, T1.RECEIPTTYPE
					, T1.RECAGAINST
					, T2.FINID
					, T1.REFERENCE
					, T1.RECEIPTPURPOSE
					, T1.RECEIPTMODE
					, T1.EXCESSADJUSTTO
					, T1.ALLOCATIONTYPE
					, T1.RECEIPTAMOUNT
					, T1.EFFECTSCHDMETHOD
					, T1.RECEIPTMODESTATUS
					, T1.SUBRECEIPTMODE
					, T1.RECEIPTCHANNEL
					, T1.RECEIVEDFROM
					, T1.PANNUMBER
					, T1.COLLECTIONAGENTID
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T2.FINTYPE
					, T2.FINBRANCH
					, T3.CUSTCIF
					, T3.CUSTSHRTNAME
					, T2.FINCCY
					, T1.REALIZATIONDATE
					, T1.CANCELREASON
					, T4.FINTYPEDESC
					, T6.BRANCHDESC FINBRANCHDESC
					, T5.CCYDESC FINCCYDESC
					, T7.REJECTDESC CANCELREASONDESC
					, COALESCE(T2.FINISACTIVE, 0) FINISACTIVE
					, T2.SCHEDULEMETHOD
					, T2.PROFITDAYSBASIS PFTDAYSBASIS
					, T1.WAVIEDAMT
					, COALESCE(T3.CUSTID, 0) CUSTID
					, T1.TOTFEEAMOUNT
					, T1.BOUNCEDATE
					, T1.REMARKS
					, T1.RCDMAINTAINSTS
					, T1.DEPOSITPROCESS
					, T1.DEPOSITBRANCH
					, T1.LPIAMOUNT
					, T1.LPPAMOUNT
					, T1.GSTLPIAMOUNT
					, T1.GSTLPPAMOUNT
					, T1.GDRAVAILABLE
					, T1.RELEASETYPE
					, T1.THIRDPARTYNAME
					, T1.THIRDPARTYMOBILENUM
					, T2.PRODUCTCATEGORY
					, T2.PROMOTIONCODE
					, T2.NEXTREPAYRVWDATE
					, T1.CASHIERBRANCH
					, T1.INITIATEDATE
					, T1.INSTRUCTIONUID
					, T1.FINDIVISION
					, T1.POSTBRANCH
					, T10.DIVISIONCODEDESC FINDIVISIONDESC
					, T11.BRANCHDESC POSTBRANCHDESC
					, T12.BRANCHDESC CASHIERBRANCHDESC
					, T10.ENTITYCODE
					, T9.CODE COLLECTIONAGENTCODE
					, T9.DESCRIPTION COLLECTIONAGENTDESC
					, T1.MODULE
					, T1.EXTREFERENCE
					, T13.CUSTCIF CUSTOMERCIF
					, T13.CUSTSHRTNAME CUSTOMERNAME
					, T1.ACTFINRECEIPT
					, T1.REASONCODE
					, T1.CANCELREMARKS
					, T1.REFWAIVERAMT
					, T1.SOURCE
					, T1.VALUEDATE
					, T1.TRANSACTIONREF
					, T1.DEPOSITDATE
					, T1.PARTNERBANKID
					, T1.PRVRECEIPTPURPOSE
					, T1.RECEIPTSOURCE
					, T1.RECAPPDATE
					, T1.RECEIVEDDATE
					, T1.KNOCKOFFTYPE
					, T1.SOURCEOFFUND
					, T1.TDSAMOUNT
					, T1.CLOSURETYPEID
	      			, T14.CODE CLOSURETYPECODE
	      			, T14.DESCRIPTION CLOSURETYPEDESC
	      			, T1.RECADJAMT
					, T16.CODE FCREASONCODE
                    , T16.DESCRIPTION FCREASONCODEDESC
					, T17.PARTNERBANKCODE
				FROM FINRECEIPTHEADER T1
				LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN CLOSURE_TYPES	T14 ON T14.ID = T1.CLOSURETYPEID
				LEFT JOIN REASONS T16 ON T16.ID = T1.REASONCODE
				LEFT JOIN PARTNERBANKS T17 ON T17.PARTNERBANKID = T1.PARTNERBANKID
				WHERE NOT EXISTS ( SELECT 1 FROM FINRECEIPTHEADER_TEMP WHERE RECEIPTID = T1.RECEIPTID)
			]]>
	</createView>
	</changeSet>

	<changeSet id="32.1.4_post" author="vijaya.a" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'finreceiptheader_fcview');
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="32.1.5_pre" author="vijaya.a" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_fview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="32.1.5" author="vijaya.a">
		<createView viewName="FINRECEIPTHEADER_FVIEW" replaceIfExists="true">
		<![CDATA[	
		   SELECT T1.RECEIPTID
					, T1.RECEIPTDATE
					, T1.RECEIPTTYPE
					, T1.ACTFINRECEIPT
					, T1.RECAGAINST
					, T2.FINID
					, T1.REFERENCE
					, T1.RECEIPTPURPOSE
					, T1.RECEIPTMODE
					, T1.EXCESSADJUSTTO
					, T1.ALLOCATIONTYPE
					, T1.RECEIPTAMOUNT
					, T1.EFFECTSCHDMETHOD
					, T1.RECEIPTMODESTATUS
					, T1.SUBRECEIPTMODE
					, T1.RECEIPTCHANNEL
					, T1.RECEIVEDFROM
					, T1.PANNUMBER
					, T1.COLLECTIONAGENTID
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, COALESCE(T1.FINTYPE, T2.FINTYPE) FINTYPE
					, T2.FINBRANCH
					, T3.CUSTCIF
					, T3.CUSTSHRTNAME
					, COALESCE(T2.FINCCY, T15.FINCCY) FINCCY
					, T1.REALIZATIONDATE
					, T1.CANCELREASON
					, COALESCE(T4.FINTYPEDESC, T15.FINTYPEDESC) FINTYPEDESC
					, T6.BRANCHDESC FINBRANCHDESC
					, COALESCE(T5.CCYDESC, T14.CCYDESC) FINCCYDESC
					, T7.REJECTDESC CANCELREASONDESC
					, COALESCE(T2.FINISACTIVE, 0) FINISACTIVE
					, T2.SCHEDULEMETHOD
					, T2.PROFITDAYSBASIS PFTDAYSBASIS
					, T1.WAVIEDAMT
					, COALESCE(T3.CUSTID, T10.CUSTID, 0) CUSTID
					, T1.TOTFEEAMOUNT
					, T1.BOUNCEDATE
					, T1.REMARKS
					, T1.RCDMAINTAINSTS
					, T1.DEPOSITPROCESS
					, T1.DEPOSITBRANCH
					, T1.LPIAMOUNT
					, T1.LPPAMOUNT
					, T1.GSTLPIAMOUNT
					, T1.GSTLPPAMOUNT
					, T1.GDRAVAILABLE
					, T1.RELEASETYPE
					, T1.THIRDPARTYNAME
					, T1.THIRDPARTYMOBILENUM
					, T2.PRODUCTCATEGORY
					, T2.PROMOTIONCODE
					, T1.CASHIERBRANCH
					, T2.NEXTREPAYRVWDATE
					, T1.INITIATEDATE
					, T9.CODE COLLECTIONAGENTCODE
					, T9.DESCRIPTION COLLECTIONAGENTDESC
					, T1.MODULE
					, T1.INSTRUCTIONUID
					, T1.EXTREFERENCE
					, T10.CUSTCIF CUSTOMERCIF
					, T10.CUSTSHRTNAME CUSTOMERNAME
					, T1.FINDIVISION
					, T1.POSTBRANCH
					, T11.DIVISIONCODEDESC FINDIVISIONDESC
					, T12.BRANCHDESC POSTBRANCHDESC
					, T13.BRANCHDESC CASHIERBRANCHDESC
					, T11.ENTITYCODE
					, COALESCE(T3.CUSTBASECCY,T10.CUSTBASECCY)CUSTBASECCY
					, T1.REASONCODE
					, T1.CANCELREMARKS
					, T1.REFWAIVERAMT    
					, T1.SOURCE
					, T1.VALUEDATE 
					, T1.TRANSACTIONREF 
					, T1.DEPOSITDATE
					, T1.PARTNERBANKID
					, T1.PRVRECEIPTPURPOSE
					, T1.RECEIPTSOURCE
					, T1.RECAPPDATE
					, T1.RECEIVEDDATE
					, T1.KNOCKOFFTYPE
					, T2.TDSAPPLICABLE FINTDSAPPLICABLE
					, T1.SOURCEOFFUND
					, T1.TDSAMOUNT
					, T1.CLOSURETYPEID
	      		    , T16.CODE CLOSURETYPECODE
	      			, T16.DESCRIPTION CLOSURETYPEDESC
	      			, T1.RECADJAMT
					, T18.CODE FCREASONCODE
                    , T18.DESCRIPTION FCREASONCODEDESC
					, T19.PARTNERBANKCODE
				FROM FINRECEIPTHEADER_TEMP T1
				LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN Customers T10 ON CAST(T10.CustId AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN SMTDIVISIONDETAIL T11 ON T1.FINDIVISION = T11.DIVISIONCODE
				LEFT JOIN RMTBranches T12 ON T1.PostBranch = T12.BranchCode
				LEFT JOIN RMTBranches T13 ON T1.CASHIERBRANCH = T13.BranchCode
				LEFT JOIN RMTFINANCETYPES T15 ON T1.FINTYPE = T15.FINTYPE
				LEFT JOIN RMTCURRENCIES T14 ON T14.CCYCODE= T3.CUSTBASECCY
				LEFT JOIN CLOSURE_TYPES	T16 ON T16.ID = T1.CLOSURETYPEID
				LEFT JOIN REASONS T18 ON T18.ID = T1.REASONCODE
				LEFT JOIN PARTNERBANKS T19 ON T19.PARTNERBANKID = T1.PARTNERBANKID
			]]>
	</createView>
	</changeSet>

	<changeSet id="32.1.5_post" author="vijaya.a" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'finreceiptheader_fview');
		]]>
		</sql>
	</changeSet>
	
	<changeSet id="32.1.6_pre" author="vijaya.a" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_feview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="32.1.6" author="vijaya.a">
		<createView viewName="FINRECEIPTHEADER_FEVIEW" replaceIfExists="true">
		<![CDATA[	
		   SELECT T1.RECEIPTID
					, T1.RECEIPTDATE
					, T1.RECEIPTTYPE
					, T1.RECAGAINST
					, T2.FINID
					, T1.REFERENCE
					, T1.RECEIPTPURPOSE
					, T1.RECEIPTMODE
					, T1.EXCESSADJUSTTO
					, T1.ALLOCATIONTYPE
					, T1.RECEIPTAMOUNT
					, T1.EFFECTSCHDMETHOD
					, T1.RECEIPTMODESTATUS
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T2.FINTYPE
					, T2.FINBRANCH
					, T3.CUSTCIF
					, T3.CUSTSHRTNAME
					, T2.FINCCY
					, T1.REALIZATIONDATE
					, T1.CANCELREASON
					, T4.FINTYPEDESC
					, T6.BRANCHDESC FINBRANCHDESC
					, T5.CCYDESC FINCCYDESC
					, T7.REJECTDESC CANCELREASONDESC
					, COALESCE(T2.FINISACTIVE, 0) FINISACTIVE
					, T2.SCHEDULEMETHOD
					, T2.PROFITDAYSBASIS PFTDAYSBASIS
					, T1.WAVIEDAMT
					, COALESCE(T3.CUSTID, 0) CUSTID
					, T1.TOTFEEAMOUNT
					, T1.BOUNCEDATE
					, T1.REMARKS
					, T1.RCDMAINTAINSTS
					, T1.DEPOSITPROCESS
					, T1.DEPOSITBRANCH
					, T1.LPIAMOUNT
					, T1.LPPAMOUNT
					, T1.GSTLPIAMOUNT
					, T1.GSTLPPAMOUNT
					, T1.GDRAVAILABLE
					, T1.RELEASETYPE
					, T1.THIRDPARTYNAME
					, T1.THIRDPARTYMOBILENUM
					, T2.PRODUCTCATEGORY
					, T2.PROMOTIONCODE
					, T2.NEXTREPAYRVWDATE
					, T1.CASHIERBRANCH
					, T1.INITIATEDATE
					, T4.FINDIVISION LOVDESCFINDIVISION
					, T2.BUSINESSVERTICAL
					, T1.FINDIVISION
					, T1.POSTBRANCH
					, T10.DIVISIONCODEDESC FINDIVISIONDESC
					, T11.BRANCHDESC POSTBRANCHDESC
					, T12.BRANCHDESC CASHIERBRANCHDESC
					, T10.ENTITYCODE
					, T9.CODE COLLECTIONAGENTCODE
					, T9.DESCRIPTION COLLECTIONAGENTDESC
					, T1.INSTRUCTIONUID
					, T1.MODULE
					, T1.EXTREFERENCE
					, T1.COLLECTIONAGENTID
					, T1.PANNUMBER
					, T1.RECEIVEDFROM
					, T1.RECEIPTCHANNEL
					, T1.SUBRECEIPTMODE
					, T13.CUSTCIF CUSTOMERCIF
					, T13.CUSTSHRTNAME CUSTOMERNAME
					, T1.ACTFINRECEIPT
					, T1.REASONCODE
					, T1.CANCELREMARKS
					, T1.REFWAIVERAMT        
					, T1.SOURCE             
					, T1.VALUEDATE           
					, T1.TRANSACTIONREF      
					, T1.DEPOSITDATE         
					, T1.PARTNERBANKID       
					, T1.PRVRECEIPTPURPOSE   
					, T1.RECEIPTSOURCE       
					, T1.RECAPPDATE          
					, T1.RECEIVEDDATE
					, T1.KNOCKOFFTYPE
					, T1.SOURCEOFFUND
					, T1.TDSAMOUNT
					, T1.CLOSURETYPEID
	      			, T14.CODE CLOSURETYPECODE
	      			, T14.DESCRIPTION CLOSURETYPEDESC
	      			, T1.RECADJAMT
					, T16.CODE FCREASONCODE
                    , T16.DESCRIPTION FCREASONCODEDESC
					, T17.PARTNERBANKCODE
				FROM FINRECEIPTHEADER_TEMP T1
				LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN CLOSURE_TYPES	T14 ON T14.ID = T1.CLOSURETYPEID
				LEFT JOIN REASONS T16 ON T16.ID = T1.REASONCODE
				LEFT JOIN PARTNERBANKS T17 ON T17.PARTNERBANKID = T1.PARTNERBANKID
				UNION ALL
				SELECT T1.RECEIPTID
					, T1.RECEIPTDATE
					, T1.RECEIPTTYPE
					, T1.RECAGAINST
					, T2.FINID
					, T1.REFERENCE
					, T1.RECEIPTPURPOSE
					, T1.RECEIPTMODE
					, T1.EXCESSADJUSTTO
					, T1.ALLOCATIONTYPE
					, T1.RECEIPTAMOUNT
					, T1.EFFECTSCHDMETHOD
					, T1.RECEIPTMODESTATUS
					, T1.VERSION
					, T1.LASTMNTBY
					, T1.LASTMNTON
					, T1.RECORDSTATUS
					, T1.ROLECODE
					, T1.NEXTROLECODE
					, T1.TASKID
					, T1.NEXTTASKID
					, T1.RECORDTYPE
					, T1.WORKFLOWID
					, T2.FINTYPE
					, T2.FINBRANCH
					, T3.CUSTCIF
					, T3.CUSTSHRTNAME
					, T2.FINCCY
					, T1.REALIZATIONDATE
					, T1.CANCELREASON
					, T4.FINTYPEDESC
					, T6.BRANCHDESC FINBRANCHDESC
					, T5.CCYDESC FINCCYDESC
					, T7.REJECTDESC CANCELREASONDESC
					, COALESCE(T2.FINISACTIVE, 0) FINISACTIVE
					, T2.SCHEDULEMETHOD
					, T2.PROFITDAYSBASIS PFTDAYSBASIS
					, T1.WAVIEDAMT
					, COALESCE(T3.CUSTID, 0) CUSTID
					, T1.TOTFEEAMOUNT
					, T1.BOUNCEDATE
					, T1.REMARKS
					, T1.RCDMAINTAINSTS
					, T1.DEPOSITPROCESS
					, T1.DEPOSITBRANCH
					, T1.LPIAMOUNT
					, T1.LPPAMOUNT
					, T1.GSTLPIAMOUNT
					, T1.GSTLPPAMOUNT
					, T1.GDRAVAILABLE
					, T1.RELEASETYPE
					, T1.THIRDPARTYNAME
					, T1.THIRDPARTYMOBILENUM
					, T2.PRODUCTCATEGORY
					, T2.PROMOTIONCODE
					, T2.NEXTREPAYRVWDATE
					, T1.CASHIERBRANCH
					, T1.INITIATEDATE
					, T4.FINDIVISION LOVDESCFINDIVISION
					, T2.BUSINESSVERTICAL
					, T1.FINDIVISION
					, T1.POSTBRANCH
					, T10.DIVISIONCODEDESC FINDIVISIONDESC
					, T11.BRANCHDESC POSTBRANCHDESC
					, T12.BRANCHDESC CASHIERBRANCHDESC
					, T10.ENTITYCODE
					, T9.CODE COLLECTIONAGENTCODE
					, T9.DESCRIPTION COLLECTIONAGENTDESC
					, T1.INSTRUCTIONUID
					, T1.MODULE
					, T1.EXTREFERENCE
					, T1.COLLECTIONAGENTID
					, T1.PANNUMBER
					, T1.RECEIVEDFROM
					, T1.RECEIPTCHANNEL
					, T1.SUBRECEIPTMODE
					, T13.CUSTCIF CUSTOMERCIF
					, T13.CUSTSHRTNAME CUSTOMERNAME
					, T1.ACTFINRECEIPT
					, T1.REASONCODE
					, T1.CANCELREMARKS
					, T1.REFWAIVERAMT        
					, T1.SOURCE             
					, T1.VALUEDATE           
					, T1.TRANSACTIONREF      
					, T1.DEPOSITDATE         
					, T1.PARTNERBANKID       
					, T1.PRVRECEIPTPURPOSE   
					, T1.RECEIPTSOURCE       
					, T1.RECAPPDATE          
					, T1.RECEIVEDDATE
					, T1.KNOCKOFFTYPE
					, T1.SOURCEOFFUND
					, T1.TDSAMOUNT
					, T1.CLOSURETYPEID
	      			, T14.CODE CLOSURETYPECODE
	      			, T14.DESCRIPTION CLOSURETYPEDESC
	      			, T1.RECADJAMT
					, T16.CODE FCREASONCODE
                    , T16.DESCRIPTION FCREASONCODEDESC
					, T17.PARTNERBANKCODE
				FROM FINRECEIPTHEADER T1
				LEFT JOIN (
				SELECT FINID
					, FINREFERENCE
					, FINBRANCH
					, FINTYPE
					, FINCCY
					, SCHEDULEMETHOD
					, PROFITDAYSBASIS
					, FINISACTIVE
					, CUSTID
					, PRODUCTCATEGORY
					, PROMOTIONCODE
					, NEXTREPAYRVWDATE
					, BUSINESSVERTICAL
				FROM FINANCEMAIN_TEMP
				UNION
				SELECT FINID
					, FINREFERENCE
					, FINBRANCH
					, FINTYPE
					, FINCCY
					, SCHEDULEMETHOD
					, PROFITDAYSBASIS
					, FINISACTIVE
					, CUSTID
					, PRODUCTCATEGORY
					, PROMOTIONCODE
					, NEXTREPAYRVWDATE
					, BUSINESSVERTICAL
				FROM FINANCEMAIN ) T2 ON T1.FINID = T2.FINID
				LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
				LEFT JOIN CLOSURE_TYPES	T14 ON T14.ID = T1.CLOSURETYPEID
				LEFT JOIN REASONS T16 ON T16.ID = T1.REASONCODE
				LEFT JOIN PARTNERBANKS T17 ON T17.PARTNERBANKID = T1.PARTNERBANKID
				WHERE NOT EXISTS ( SELECT 1 FROM FINRECEIPTHEADER_TEMP
					WHERE RECEIPTID = T1.RECEIPTID )
			]]>
	</createView>
	</changeSet>

	<changeSet id="32.1.6_post" author="vijaya.a" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_restore_dependencies ('plf', 'finreceiptheader_feview');
		]]>
		</sql>
	</changeSet>
	
</databaseChangeLog>