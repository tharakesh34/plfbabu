<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="add.schema" value=" " dbms="postgresql" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="satish" runAlways="true" dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>


	<changeSet id="01_pre" author="Satish.k" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="01" author="Satish.k">
		<createView viewName="RMTFINANCETYPES_AVIEW" replaceIfExists="true">
				<![CDATA[
						SELECT t1.fintype,
						t1.fincategory,
						t1.fintypedesc,
						t1.finccy,
						t1.findayscaltype,
						t1.finactype,
						t1.fincontingentactype,
						t1.finisgenref,
						t1.finmaxamount,
						t1.finminamount,
						t1.finisopennewfinac,
						t1.findftstmtfrq,
						t1.finisalwmd,
						t1.finschdmthd,
						t1.finisalwgrace,
						t1.finhistretension,
						t1.equalrepayment,
						t1.finratetype,
						t1.finbaserate,
						t1.finsplrate,
						t1.finintrate,
						t1.finminrate,
						t1.finmaxrate,
						t1.findftintfrq,
						t1.finisintcpz,
						t1.fincpzfrq,
						t1.finisrvwalw,
						t1.finrvwfrq,
						t1.fingrcratetype,
						t1.fingrcbaserate,
						t1.fingrcsplrate,
						t1.fingrcintrate,
						t1.fingrcminrate,
						t1.fingrcmaxrate,
						t1.fingrcdftintfrq,
						t1.fingrcisintcpz,
						t1.fingrccpzfrq,
						t1.fingrcisrvwalw,
						t1.fingrcrvwfrq,
						t1.finminterm,
						t1.finmaxterm,
						t1.findftterms,
						t1.finrpyfrq,
						t1.finrepaymethod,
						t1.finisalwpartialrpy,
						t1.finisalwdifferment,
						t1.finmaxdifferment,
						t1.finisalwearlyrpy,
						t1.finisalwearlysettle,
						t1.finodrpytries,
						t1.finearlypayrule,
						t1.finearlysettlerule,
						t1.findepositrestrictedto,
						t1.finaebuyorinception,
						t1.finaesellormaturity,
						t1.finisactive,
						t1.version,
						t1.lastmntby,
						t1.lastmnton,
						t1.recordstatus,
						t1.rolecode,
						t1.nextrolecode,
						t1.taskid,
						t1.nexttaskid,
						t1.recordtype,
						t1.workflowid,
						t1.stepfinance,
						t1.steppingmandatory,
						t1.alwmanualsteps,
						t1.alwdsteppolicies,
						t1.dftsteppolicy,
						t4.actypedesc AS lovdescfincontingentactypename,
						t5.actypedesc AS lovdescfinactypename,
						t1.finisdwpayrequired,
						t1.finrvwrateapplfor,
						t1.finalwratechangeanydate,
						t1.finisintcpzatgrcend,
						t1.finelgrulecode,
						t1.limitelgrulecode,
						t1.finschcalcodeonrvw,
						t1.alwplandeferment,
						t1.plandefercount,
						t1.finassettype,
						t1.pftpayactype,
						t1.finisopenpftpayacc,
						t31.actypedesc AS lovdescpftpayactypename,
						t1.finisalwgrcrepay,
						t1.fingrcschdmthd,
						t1.fingrcmargin,
						t1.finmargin,
						t1.finscheduleon,
						t1.fingrcscheduleon,
						t1.fincommitmentreq,
						t1.fincollateralreq,
						t1.findepreciationreq,
						t1.findepreciationfrq,
						t1.finbankcontingentactype,
						t1.finprovisionactype,
						t38.actypedesc AS lovdescfinbankcontactypename,
						t39.actypedesc AS lovdescfinprovisionactypename,
						t1.allowriainvestment,
						t1.overridelimit,
						t1.limitrequired,
						t1.fincommitmentovrride,
						t1.fincollateralovrride,
						t1.finpftunchanged,
						t1.applyodpenalty,
						t1.odincgrcdays,
						t1.odchargetype,
						t1.odgracedays,
						t1.odchargecalon,
						t1.odchargeamtorperc,
						t1.odallowwaiver,
						t1.odmaxwaiverperc,
						t1.findivision,
						t48.divisioncodedesc AS lovdescfindivisionname,
						t48.entitycode AS lovdescentitycode,
						t1.finsuspactype,
						t49.actypedesc AS lovdescfinsuspactypename,
						t1.product,
						t1.startdate,
						t1.enddate,
						t1.allowdownpaypgm,
						t1.remarks,
						t1.alwearlypaymethods,
						t1.pastduepftcalmthd,
						t1.pastduepftmargin,
						t1.alwadvancerent,
						t1.grcadvbaserate,
						t1.grcadvmargin,
						t1.grcadvpftrate,
						t1.rpyadvbaserate,
						t1.rpyadvmargin,
						t1.rpyadvpftrate,
						t1.rolloverfinance,
						t1.rolloverfrq,
						t1.downpayrule,
						t59.rulecode AS downpayrulecode,
						t59.rulecodedesc AS downpayruledesc,
						t1.finsusptrigger,
						t1.finsuspremarks,
						t1.alwmultipartydisb,
						t1.collateraltype,
						t1.tdsapplicable,
						t1.manualschedule,
						t1.applygrcpricing,
						t1.grcpricingmethod,
						t1.applyrpypricing,
						t1.rpypricingmethod,
						t1.rpyhierarchy,
						t67.rulecode AS grcpricingmethoddesc,
						t68.rulecode AS rpypricingmethoddesc,
						t1.droplineod,
						t1.droppingmethod,
						t1.ratechganyday,
						t1.finrepaypftonfrq,
						t1.alwbpi,
						t1.bpitreatment,
						t1.pftdueschon,
						t1.planemihalw,
						t1.planemihmethod,
						t1.planemihmaxperyear,
						t1.planemihmax,
						t1.planemihlockperiod,
						t1.planemicpz,
						t1.unplanemihlockperiod,
						t1.unplanemicpz,
						t1.reagecpz,
						t1.fddlockperiod,
						t1.alwdrpymethods,
						t1.maxunplannedemi,
						t1.maxreageholidays,
						t1.roundingmode,
						t1.roundingtarget,
						t1.frequencydays,
						t1.quickdisb,
						t1.alwreage,
						t1.alwunplanemiholiday,
						t1.alwmaxdisbcheckreq,
						t1.fintypedesc AS lovdescpromofintypedesc,
						t1.profitcenterid,
						t69.profitcentercode,
						t69.profitcenterdesc,
						t1.productcategory,
						t2.productdesc AS fincategorydesc,
						t1.developerfinance,
						t1.costoffunds,
						t1.chequecapturereq,
						t1.finltvcheck,
						t1.partiallysecured,
						t1.alwadvemi,
						t1.advemiminterms,
						t1.advemimaxterms,
						t1.advemidftterms,
						t1.advemischdmthd,
						t1.bpipftdaysbasis,
						t1.eligibilitymethods,
						t1.alwhybridrate,
						t1.fixedratetenor,
						t1.odmincapamount,
						t1.odrulecode,
						t1.alwzerointacc,
						t1.autorejectiondays,
						t1.taxnomand,
						t1.putcallrequired,
						t1.grcadvintersetreq,
						t1.grcadvtype,
						t1.grcadvminterms,
						t1.grcadvmaxterms,
						t1.grcadvdefaultterms,
						t1.advintersetreq,
						t1.advtype,
						t1.advminterms,
						t1.advmaxterms,
						t1.advdefaultterms,
						t1.advstage,
						t1.dsfreq,
						t1.cashcollateralreq,
						t1.tdsallowtomodify,
						t1.tdsapplicableto,
						t1.alwvan,
						t1.vanallocationmethod,
						t1.allowdrawingpower,
						t1.allowrevolving,
						t1.alwsanctionamt,
						t1.alwsanctionamtoverride,
						t1.sanbsdschdle,
						t1.finisratervwatgrcend,
						t1.schdonpmtcal,
						t1.autoapprove,
						t1.ocrrequired,
						t1.allowedocrs,
						t1.defaultocr,
						t1.allowedloanpurposes,
						t1.specificloanpurposes,
						t1.grcadjreq,
						t1.grcperiodaftrfulldisb,
						t1.autoincrgrcenddate,
						t1.grcautoincrmonths,
						t1.maxautoincrallowed,
						t1.thrldtomaintaingrcprd,
						t1.alwloansplit,
						t1.splitloantype,
						t1.instbasedschd,
						t1.alwplannedemiingrc
					FROM rmtfinancetypes t1
						LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
						LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
						LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
						LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
						LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
						LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
						LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
						LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
						LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
						LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
						LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
						LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid

					]]>	

		  </createView>
	</changeSet>

	<changeSet id="01_post" author="satish.k" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_aview');	
			]]>
		</sql>
	</changeSet>


	<changeSet id="02_pre" author="satish.k" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="02" author="satish.k">
		<createView viewName="rmtfinancetypes_view" replaceIfExists="true">
			<![CDATA[ 
			
					SELECT t1.fintype,
							t1.fincategory,
							t1.fintypedesc,
							t1.finccy,
							t1.findayscaltype,
							t1.finactype,
							t1.fincontingentactype,
							t1.finisgenref,
							t1.finmaxamount,
							t1.finminamount,
							t1.finisopennewfinac,
							t1.findftstmtfrq,
							t1.finisalwmd,
							t1.finschdmthd,
							t1.finisalwgrace,
							t1.finhistretension,
							t1.equalrepayment,
							t1.finratetype,
							t1.finbaserate,
							t1.finsplrate,
							t1.finintrate,
							t1.finminrate,
							t1.finmaxrate,
							t1.findftintfrq,
							t1.finisintcpz,
							t1.fincpzfrq,
							t1.finisrvwalw,
							t1.finrvwfrq,
							t1.fingrcratetype,
							t1.fingrcbaserate,
							t1.fingrcsplrate,
							t1.fingrcintrate,
							t1.fingrcminrate,
							t1.fingrcmaxrate,
							t1.fingrcdftintfrq,
							t1.fingrcisintcpz,
							t1.fingrccpzfrq,
							t1.fingrcisrvwalw,
							t1.fingrcrvwfrq,
							t1.finminterm,
							t1.finmaxterm,
							t1.findftterms,
							t1.finrpyfrq,
							t1.finrepaymethod,
							t1.finisalwpartialrpy,
							t1.finisalwdifferment,
							t1.finmaxdifferment,
							t1.finisalwearlyrpy,
							t1.finisalwearlysettle,
							t1.finodrpytries,
							t1.finearlypayrule,
							t1.finearlysettlerule,
							t1.findepositrestrictedto,
							t1.finaebuyorinception,
							t1.finaesellormaturity,
							t1.finisactive,
							t1.version,
							t1.lastmntby,
							t1.lastmnton,
							t1.recordstatus,
							t1.rolecode,
							t1.nextrolecode,
							t1.taskid,
							t1.nexttaskid,
							t1.recordtype,
							t1.workflowid,
							t1.stepfinance,
							t1.steppingmandatory,
							t1.alwmanualsteps,
							t1.alwdsteppolicies,
							t1.dftsteppolicy,
							t4.actypedesc AS lovdescfincontingentactypename,
							t5.actypedesc AS lovdescfinactypename,
							t1.finisdwpayrequired,
							t1.finrvwrateapplfor,
							t1.finalwratechangeanydate,
							t1.finisintcpzatgrcend,
							t1.finelgrulecode,
							t1.limitelgrulecode,
							t1.finschcalcodeonrvw,
							t1.alwplandeferment,
							t1.plandefercount,
							t1.finassettype,
							t1.pftpayactype,
							t1.finisopenpftpayacc,
							t31.actypedesc AS lovdescpftpayactypename,
							t1.finisalwgrcrepay,
							t1.fingrcschdmthd,
							t1.fingrcmargin,
							t1.finmargin,
							t1.finscheduleon,
							t1.fingrcscheduleon,
							t1.fincommitmentreq,
							t1.fincollateralreq,
							t1.findepreciationreq,
							t1.findepreciationfrq,
							t1.finbankcontingentactype,
							t1.finprovisionactype,
							t38.actypedesc AS lovdescfinbankcontactypename,
							t39.actypedesc AS lovdescfinprovisionactypename,
							t1.allowriainvestment,
							t1.overridelimit,
							t1.limitrequired,
							t1.fincommitmentovrride,
							t1.fincollateralovrride,
							t1.finpftunchanged,
							t1.applyodpenalty,
							t1.odincgrcdays,
							t1.odchargetype,
							t1.odgracedays,
							t1.odchargecalon,
							t1.odchargeamtorperc,
							t1.odallowwaiver,
							t1.odmaxwaiverperc,
							t1.findivision,
							t48.divisioncodedesc AS lovdescfindivisionname,
							t48.entitycode AS lovdescentitycode,
							t1.finsuspactype,
							t49.actypedesc AS lovdescfinsuspactypename,
							t1.product,
							t1.startdate,
							t1.enddate,
							t1.allowdownpaypgm,
							t1.fintypedesc AS lovdescpromofintypedesc,
							t1.remarks,
							t1.alwearlypaymethods,
							t1.pastduepftcalmthd,
							t1.pastduepftmargin,
							t1.alwadvancerent,
							t1.grcadvbaserate,
							t1.grcadvmargin,
							t1.grcadvpftrate,
							t1.rpyadvbaserate,
							t1.rpyadvmargin,
							t1.rpyadvpftrate,
							t1.rolloverfinance,
							t1.rolloverfrq,
							t1.downpayrule,
							t59.rulecode AS downpayrulecode,
							t59.rulecodedesc AS downpayruledesc,
							t1.finsusptrigger,
							t1.finsuspremarks,
							t1.alwmultipartydisb,
							t1.collateraltype,
							t1.tdsapplicable,
							t1.manualschedule,
							t1.applygrcpricing,
							t1.grcpricingmethod,
							t1.applyrpypricing,
							t1.rpypricingmethod,
							t1.rpyhierarchy,
							t67.rulecode AS grcpricingmethoddesc,
							t68.rulecode AS rpypricingmethoddesc,
							t1.droplineod,
							t1.droppingmethod,
							t1.ratechganyday,
							t1.finrepaypftonfrq,
							t1.alwbpi,
							t1.bpitreatment,
							t1.pftdueschon,
							t1.planemihalw,
							t1.planemihmethod,
							t1.planemihmaxperyear,
							t1.planemihmax,
							t1.planemihlockperiod,
							t1.planemicpz,
							t1.unplanemihlockperiod,
							t1.unplanemicpz,
							t1.reagecpz,
							t1.fddlockperiod,
							t1.alwdrpymethods,
							t1.maxunplannedemi,
							t1.maxreageholidays,
							t1.roundingmode,
							t1.roundingtarget,
							t1.frequencydays,
							t1.quickdisb,
							t1.alwmaxdisbcheckreq,
							t1.alwreage,
							t1.alwunplanemiholiday,
							t1.profitcenterid,
							t69.profitcentercode,
							t69.profitcenterdesc,
							t1.productcategory,
							t2.productdesc AS fincategorydesc,
							t1.developerfinance,
							t1.costoffunds,
							t1.chequecapturereq,
							t1.finltvcheck,
							t1.partiallysecured,
							t1.alwadvemi,
							t1.advemiminterms,
							t1.advemimaxterms,
							t1.advemidftterms,
							t1.advemischdmthd,
							t1.bpipftdaysbasis,
							t1.eligibilitymethods,
							t1.alwhybridrate,
							t1.fixedratetenor,
							t1.odmincapamount,
							t1.odrulecode,
							t1.alwzerointacc,
							t1.autorejectiondays,
							t1.taxnomand,
							t1.putcallrequired,
							t1.grcadvintersetreq,
							t1.grcadvtype,
							t1.grcadvminterms,
							t1.grcadvmaxterms,
							t1.grcadvdefaultterms,
							t1.advintersetreq,
							t1.advtype,
							t1.advminterms,
							t1.advmaxterms,
							t1.advdefaultterms,
							t1.advstage,
							t1.dsfreq,
							t1.cashcollateralreq,
							t1.tdsallowtomodify,
							t1.tdsapplicableto,
							t1.alwvan,
							t1.vanallocationmethod,
							t1.allowdrawingpower,
							t1.allowrevolving,
							t1.alwsanctionamt,
							t1.alwsanctionamtoverride,
							t1.sanbsdschdle,
							t1.finisratervwatgrcend,
							t1.schdonpmtcal,
							t1.autoapprove,
							t1.ocrrequired,
							t1.allowedocrs,
							t1.defaultocr,
							t1.allowedloanpurposes,
							t1.specificloanpurposes,
							t1.grcadjreq,
							t1.grcperiodaftrfulldisb,
							t1.autoincrgrcenddate,
							t1.grcautoincrmonths,
							t1.maxautoincrallowed,
							t1.thrldtomaintaingrcprd,
							t1.alwloansplit,
							t1.splitloantype,
							t1.instbasedschd,
							t1.alwplannedemiingrc
						FROM rmtfinancetypes_temp t1
							LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
							LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
							LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
							LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
							LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
							LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
							LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
							LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
							LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
							LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
							LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
							LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
						UNION ALL
						SELECT t1.fintype,
							t1.fincategory,
							t1.fintypedesc,
							t1.finccy,
							t1.findayscaltype,
							t1.finactype,
							t1.fincontingentactype,
							t1.finisgenref,
							t1.finmaxamount,
							t1.finminamount,
							t1.finisopennewfinac,
							t1.findftstmtfrq,
							t1.finisalwmd,
							t1.finschdmthd,
							t1.finisalwgrace,
							t1.finhistretension,
							t1.equalrepayment,
							t1.finratetype,
							t1.finbaserate,
							t1.finsplrate,
							t1.finintrate,
							t1.finminrate,
							t1.finmaxrate,
							t1.findftintfrq,
							t1.finisintcpz,
							t1.fincpzfrq,
							t1.finisrvwalw,
							t1.finrvwfrq,
							t1.fingrcratetype,
							t1.fingrcbaserate,
							t1.fingrcsplrate,
							t1.fingrcintrate,
							t1.fingrcminrate,
							t1.fingrcmaxrate,
							t1.fingrcdftintfrq,
							t1.fingrcisintcpz,
							t1.fingrccpzfrq,
							t1.fingrcisrvwalw,
							t1.fingrcrvwfrq,
							t1.finminterm,
							t1.finmaxterm,
							t1.findftterms,
							t1.finrpyfrq,
							t1.finrepaymethod,
							t1.finisalwpartialrpy,
							t1.finisalwdifferment,
							t1.finmaxdifferment,
							t1.finisalwearlyrpy,
							t1.finisalwearlysettle,
							t1.finodrpytries,
							t1.finearlypayrule,
							t1.finearlysettlerule,
							t1.findepositrestrictedto,
							t1.finaebuyorinception,
							t1.finaesellormaturity,
							t1.finisactive,
							t1.version,
							t1.lastmntby,
							t1.lastmnton,
							t1.recordstatus,
							t1.rolecode,
							t1.nextrolecode,
							t1.taskid,
							t1.nexttaskid,
							t1.recordtype,
							t1.workflowid,
							t1.stepfinance,
							t1.steppingmandatory,
							t1.alwmanualsteps,
							t1.alwdsteppolicies,
							t1.dftsteppolicy,
							t4.actypedesc AS lovdescfincontingentactypename,
							t5.actypedesc AS lovdescfinactypename,
							t1.finisdwpayrequired,
							t1.finrvwrateapplfor,
							t1.finalwratechangeanydate,
							t1.finisintcpzatgrcend,
							t1.finelgrulecode,
							t1.limitelgrulecode,
							t1.finschcalcodeonrvw,
							t1.alwplandeferment,
							t1.plandefercount,
							t1.finassettype,
							t1.pftpayactype,
							t1.finisopenpftpayacc,
							t31.actypedesc AS lovdescpftpayactypename,
							t1.finisalwgrcrepay,
							t1.fingrcschdmthd,
							t1.fingrcmargin,
							t1.finmargin,
							t1.finscheduleon,
							t1.fingrcscheduleon,
							t1.fincommitmentreq,
							t1.fincollateralreq,
							t1.findepreciationreq,
							t1.findepreciationfrq,
							t1.finbankcontingentactype,
							t1.finprovisionactype,
							t38.actypedesc AS lovdescfinbankcontactypename,
							t39.actypedesc AS lovdescfinprovisionactypename,
							t1.allowriainvestment,
							t1.overridelimit,
							t1.limitrequired,
							t1.fincommitmentovrride,
							t1.fincollateralovrride,
							t1.finpftunchanged,
							t1.applyodpenalty,
							t1.odincgrcdays,
							t1.odchargetype,
							t1.odgracedays,
							t1.odchargecalon,
							t1.odchargeamtorperc,
							t1.odallowwaiver,
							t1.odmaxwaiverperc,
							t1.findivision,
							t48.divisioncodedesc AS lovdescfindivisionname,
							t48.entitycode AS lovdescentitycode,
							t1.finsuspactype,
							t49.actypedesc AS lovdescfinsuspactypename,
							t1.product,
							t1.startdate,
							t1.enddate,
							t1.allowdownpaypgm,
							t1.fintypedesc AS lovdescpromofintypedesc,
							t1.remarks,
							t1.alwearlypaymethods,
							t1.pastduepftcalmthd,
							t1.pastduepftmargin,
							t1.alwadvancerent,
							t1.grcadvbaserate,
							t1.grcadvmargin,
							t1.grcadvpftrate,
							t1.rpyadvbaserate,
							t1.rpyadvmargin,
							t1.rpyadvpftrate,
							t1.rolloverfinance,
							t1.rolloverfrq,
							t1.downpayrule,
							t59.rulecode AS downpayrulecode,
							t59.rulecodedesc AS downpayruledesc,
							t1.finsusptrigger,
							t1.finsuspremarks,
							t1.alwmultipartydisb,
							t1.collateraltype,
							t1.tdsapplicable,
							t1.manualschedule,
							t1.applygrcpricing,
							t1.grcpricingmethod,
							t1.applyrpypricing,
							t1.rpypricingmethod,
							t1.rpyhierarchy,
							t67.rulecode AS grcpricingmethoddesc,
							t68.rulecode AS rpypricingmethoddesc,
							t1.droplineod,
							t1.droppingmethod,
							t1.ratechganyday,
							t1.finrepaypftonfrq,
							t1.alwbpi,
							t1.bpitreatment,
							t1.pftdueschon,
							t1.planemihalw,
							t1.planemihmethod,
							t1.planemihmaxperyear,
							t1.planemihmax,
							t1.planemihlockperiod,
							t1.planemicpz,
							t1.unplanemihlockperiod,
							t1.unplanemicpz,
							t1.reagecpz,
							t1.fddlockperiod,
							t1.alwdrpymethods,
							t1.maxunplannedemi,
							t1.maxreageholidays,
							t1.roundingmode,
							t1.roundingtarget,
							t1.frequencydays,
							t1.quickdisb,
							t1.alwmaxdisbcheckreq,
							t1.alwreage,
							t1.alwunplanemiholiday,
							t1.profitcenterid,
							t69.profitcentercode,
							t69.profitcenterdesc,
							t1.productcategory,
							t2.productdesc AS fincategorydesc,
							t1.developerfinance,
							t1.costoffunds,
							t1.chequecapturereq,
							t1.finltvcheck,
							t1.partiallysecured,
							t1.alwadvemi,
							t1.advemiminterms,
							t1.advemimaxterms,
							t1.advemidftterms,
							t1.advemischdmthd,
							t1.bpipftdaysbasis,
							t1.eligibilitymethods,
							t1.alwhybridrate,
							t1.fixedratetenor,
							t1.odmincapamount,
							t1.odrulecode,
							t1.alwzerointacc,
							t1.autorejectiondays,
							t1.taxnomand,
							t1.putcallrequired,
							t1.grcadvintersetreq,
							t1.grcadvtype,
							t1.grcadvminterms,
							t1.grcadvmaxterms,
							t1.grcadvdefaultterms,
							t1.advintersetreq,
							t1.advtype,
							t1.advminterms,
							t1.advmaxterms,
							t1.advdefaultterms,
							t1.advstage,
							t1.dsfreq,
							t1.cashcollateralreq,
							t1.tdsallowtomodify,
							t1.tdsapplicableto,
							t1.alwvan,
							t1.vanallocationmethod,
							t1.allowdrawingpower,
							t1.allowrevolving,
							t1.alwsanctionamt,
							t1.alwsanctionamtoverride,
							t1.sanbsdschdle,
							t1.finisratervwatgrcend,
							t1.schdonpmtcal,
							t1.autoapprove,
							t1.ocrrequired,
							t1.allowedocrs,
							t1.defaultocr,
							t1.allowedloanpurposes,
							t1.specificloanpurposes,
							t1.grcadjreq,
							t1.grcperiodaftrfulldisb,
							t1.autoincrgrcenddate,
							t1.grcautoincrmonths,
							t1.maxautoincrallowed,
							t1.thrldtomaintaingrcprd,
							t1.alwloansplit,
							t1.splitloantype,
							t1.instbasedschd,
							t1.alwplannedemiingrc
						FROM rmtfinancetypes t1
							LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
							LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
							LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
							LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
							LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
							LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
							LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
							LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
							LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
							LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
							LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
							LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
						WHERE NOT (EXISTS ( SELECT 1 AS expr1
								FROM rmtfinancetypes_temp
						WHERE rmtfinancetypes_temp.fintype = t1.fintype))
					]]>
		</createView>
	</changeSet>

	<changeSet id="02_post" author="satish.k" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_view');
			]]>
		</sql>
	</changeSet>


	<changeSet id="03_pre" author="satish.k" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_orgview'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="03" author="satish.k">
		<createView viewName="rmtfinancetypes_orgview" replaceIfExists="true">
		<![CDATA[
					 SELECT t1.fintype,
							t1.fincategory,
							t1.fintypedesc,
							t1.finccy,
							t1.findayscaltype,
							t1.finactype,
							t1.fincontingentactype,
							t1.finisgenref,
							t1.finmaxamount,
							t1.finminamount,
							t1.finisopennewfinac,
							t1.finisalwmd,
							t1.finschdmthd,
							t1.finisalwgrace,
							t1.equalrepayment,
							t1.finratetype,
							t1.finbaserate,
							t1.finsplrate,
							t1.finintrate,
							t1.finminrate,
							t1.finmaxrate,
							t1.findftintfrq,
							t1.finisintcpz,
							t1.fincpzfrq,
							t1.finisrvwalw,
							t1.finrvwfrq,
							t1.fingrcratetype,
							t1.fingrcbaserate,
							t1.fingrcsplrate,
							t1.fingrcintrate,
							t1.fingrcminrate,
							t1.fingrcmaxrate,
							t1.fingrcdftintfrq,
							t1.fingrcisintcpz,
							t1.fingrccpzfrq,
							t1.fingrcisrvwalw,
							t1.fingrcrvwfrq,
							t1.finminterm,
							t1.finmaxterm,
							t1.findftterms,
							t1.finrpyfrq,
							t1.finrepaymethod,
							t1.finisalwdifferment,
							t1.finmaxdifferment,
							t1.finisactive,
							t1.stepfinance,
							t1.steppingmandatory,
							t1.alwmanualsteps,
							t1.alwdsteppolicies,
							t1.dftsteppolicy,
							t1.finisdwpayrequired,
							t1.finrvwrateapplfor,
							t1.finalwratechangeanydate,
							t1.finisintcpzatgrcend,
							t1.finschcalcodeonrvw,
							t1.alwplandeferment,
							t1.plandefercount,
							t1.pftpayactype,
							t1.finisopenpftpayacc,
							t1.finisalwgrcrepay,
							t1.fingrcschdmthd,
							t1.fingrcmargin,
							t1.finmargin,
							t1.fincommitmentreq,
							t1.fincollateralreq,
							t1.findepreciationreq,
							t1.findepreciationfrq,
							t1.finbankcontingentactype,
							t1.finprovisionactype,
							t1.allowriainvestment,
							t1.overridelimit,
							t1.limitrequired,
							t1.fincommitmentovrride,
							t1.fincollateralovrride,
							t1.finrepaypftonfrq,
							t1.finpftunchanged,
							t1.applyodpenalty,
							t1.odincgrcdays,
							t1.odchargetype,
							t1.odgracedays,
							t1.odchargecalon,
							t1.odchargeamtorperc,
							t1.odallowwaiver,
							t1.odmaxwaiverperc,
							t1.findivision,
							t3.divisioncodedesc AS lovdescfindivisionname,
							t1.finsuspactype,
							t1.product,
							t1.startdate,
							t1.enddate,
							t1.allowdownpaypgm,
							t1.fintypedesc AS lovdescpromofintypedesc,
							t1.remarks,
							t4.policydesc AS lovdescdftsteppolicyname,
							t1.pastduepftcalmthd,
							t1.pastduepftmargin,
							t1.alwadvancerent,
							t1.grcadvbaserate,
							t1.grcadvmargin,
							t1.grcadvpftrate,
							t1.rpyadvbaserate,
							t1.rpyadvmargin,
							t1.rpyadvpftrate,
							t1.rolloverfinance,
							t1.rolloverfrq,
							t1.downpayrule,
							t1.alwmultipartydisb,
							t1.collateraltype,
							t1.tdsapplicable,
							t5.rulecode AS downpayrulecode,
							t5.rulecodedesc AS downpayruledesc,
							t1.applygrcpricing,
							t1.applyrpypricing,
							t6.rulecode AS grcpricingmethoddesc,
							t7.rulecode AS rpypricingmethoddesc,
							t1.droplineod,
							t1.droppingmethod,
							t1.ratechganyday,
							t4.steptype AS dftsteppolicytype,
							t1.manualschedule,
							t1.alwbpi,
							t1.bpitreatment,
							t1.pftdueschon,
							t1.planemihalw,
							t1.planemihmethod,
							t1.planemihmaxperyear,
							t1.planemihmax,
							t1.planemihlockperiod,
							t1.planemicpz,
							t1.unplanemihlockperiod,
							t1.unplanemicpz,
							t1.reagecpz,
							t1.fddlockperiod,
							t1.alwdrpymethods,
							t1.maxunplannedemi,
							t1.maxreageholidays,
							t1.roundingmode,
							t1.roundingtarget,
							t1.frequencydays,
							t1.quickdisb,
							t1.alwreage,
							t1.alwunplanemiholiday,
							t1.alwmaxdisbcheckreq,
							t1.productcategory,
							t1.rpyhierarchy,
							t1.developerfinance,
							t3.entitycode AS lovdescentitycode,
							t8.entitydesc AS lovdescentitydesc,
							t1.costoffunds,
							t1.chequecapturereq,
							t1.finltvcheck,
							t1.partiallysecured,
							t1.alwadvemi,
							t1.advemiminterms,
							t1.advemimaxterms,
							t1.advemidftterms,
							t1.advemischdmthd,
							t1.bpipftdaysbasis,
							t1.eligibilitymethods,
							t1.alwhybridrate,
							t1.fixedratetenor,
							t1.odmincapamount,
							t1.odrulecode,
							t1.alwzerointacc,
							t1.finisalwpartialrpy,
							t1.autorejectiondays,
							t1.taxnomand,
							t1.putcallrequired,
							t1.grcadvintersetreq,
							t1.grcadvtype,
							t1.grcadvminterms,
							t1.grcadvmaxterms,
							t1.grcadvdefaultterms,
							t1.advintersetreq,
							t1.advtype,
							t1.advminterms,
							t1.advmaxterms,
							t1.advdefaultterms,
							t1.advstage,
							t1.dsfreq,
							t1.cashcollateralreq,
							t1.alwearlypaymethods,
							t1.tdsallowtomodify,
							t1.tdsapplicableto,
							t1.alwvan,
							t1.vanallocationmethod,
							t1.allowdrawingpower,
							t1.allowrevolving,
							t1.alwsanctionamt,
							t1.alwsanctionamtoverride,
							t1.sanbsdschdle,
							t1.finisratervwatgrcend,
							t1.schdonpmtcal,
							t1.autoapprove,
							t1.ocrrequired,
							t1.allowedocrs,
							t1.defaultocr,
							t1.allowedloanpurposes,
							t1.specificloanpurposes,
							t1.grcadjreq,
							t1.grcperiodaftrfulldisb,
							t1.autoincrgrcenddate,
							t1.grcautoincrmonths,
							t1.maxautoincrallowed,
							t1.thrldtomaintaingrcprd,
							t1.alwloansplit,
							t1.splitloantype,
							t1.instbasedschd,
							t1.alwplannedemiingrc
						FROM rmtfinancetypes t1
							JOIN smtdivisiondetail t3 ON t1.findivision = t3.divisioncode
							LEFT JOIN steppolicyheader t4 ON t1.dftsteppolicy = t4.policycode
							LEFT JOIN rules t5 ON t1.downpayrule = t5.ruleid
							LEFT JOIN rules t6 ON t1.grcpricingmethod = t6.ruleid
							LEFT JOIN rules t7 ON t1.rpypricingmethod = t7.ruleid
							LEFT JOIN entity t8 ON t3.entitycode = t8.entitycode

						]]>
		</createView>
	</changeSet>

	<changeSet id="03_post" author="satish.k" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_orgview');	
			]]>
		</sql>
	</changeSet>


	<changeSet id="04_pre" author="satish.k" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_aview'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="04" author="satish.k">
		<createView viewName="financemain_aview" replaceIfExists="true">
			<![CDATA[	
						SELECT t1.finreference,
							t1.investmentref,
							t1.numberofterms,
							t1.grcperiodenddate,
							t1.allowgrcperiod,
							t1.gracebaserate,
							t1.gracespecialrate,
							t1.grcpftrate,
							t1.grcpftfrq,
							t1.nextgrcpftdate,
							t1.allowgrcpftrvw,
							t1.grcpftrvwfrq,
							t1.nextgrcpftrvwdate,
							t1.allowgrccpz,
							t1.grccpzfrq,
							t1.nextgrccpzdate,
							t1.repaybaserate,
							t1.repayspecialrate,
							t1.repayprofitrate,
							t1.repayfrq,
							t1.nextrepaydate,
							t1.repaypftfrq,
							t1.nextrepaypftdate,
							t1.allowrepayrvw,
							t1.repayrvwfrq,
							t1.nextrepayrvwdate,
							t1.allowrepaycpz,
							t1.repaycpzfrq,
							t1.nextrepaycpzdate,
							t1.maturitydate,
							t1.cpzatgraceend,
							t1.downpayment,
							t1.graceflatamount,
							t1.reqrepayamount,
							t1.totalprofit,
							t1.totalcpz,
							t1.totalgrosspft,
							t1.totalgrossgrcpft,
							t1.totalgracepft,
							t1.totalgracecpz,
							t1.grcratebasis,
							t1.repayratebasis,
							t1.fintype,
							t1.finremarks,
							t1.finccy,
							t1.schedulemethod,
							t1.profitdaysbasis,
							t1.reqmaturity,
							t1.calterms,
							t1.calmaturity,
							t1.firstrepay,
							t1.lastrepay,
							t1.finstartdate,
							t1.finamount,
							t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
							t1.finrepaymentamount,
							t1.custid,
							t1.defferments,
							t1.plandefercount,
							t1.finbranch,
							t1.finsourceid,
							t1.alloweddefrpychange,
							t1.availeddefrpychange,
							t1.alloweddeffrqchange,
							t1.availeddeffrqchange,
							t1.recaltype,
							t1.finassetvalue,
							t1.disbaccountid,
							t1.repayaccountid,
							t1.finisactive,
							t1.limitvalid,
							t1.overridelimit,
							t1.securitydeposit,
							t1.version,
							t1.lastmntby,
							t1.lastmnton,
							t1.recordstatus,
							t1.rolecode,
							t1.nextrolecode,
							t1.taskid,
							t1.nexttaskid,
							t1.recordtype,
							t1.workflowid,
							t7.fintypedesc AS lovdescfintypename,
							t7.finmaxamount AS lovdescfinmaxamt,
							t7.finminamount AS lovdescfinminamount,
							t1.mindownpayperc,
							t7.finisalwdifferment AS lovdescfinalwdeferment,
							t7.finisdwpayrequired AS lovdescdwnpayreq,
							t7.finmaxdifferment AS lovdescfinmaxdifferment,
							t12.branchdesc AS lovdescfinbranchname,
							t12.branchprovince AS finbranchprovincecode,
							t1.lastrepaydate,
							t1.lastrepaypftdate,
							t1.lastrepayrvwdate,
							t1.lastrepaycpzdate,
							t1.allowgrcrepay,
							t1.grcschdmthd,
							t1.grcmargin,
							t1.repaymargin,
							t1.fincurrassetvalue,
							t1.fincommitmentref,
							t1.finlimitref,
							t1.depreciationfrq,
							t1.fincontractdate,
							t1.nextdepdate,
							t1.lastdepdate,
							t1.finaccount,
							t1.fincustpftaccount,
							t17.acrtilllbd AS lovdescaccruedtilllbd,
							t7.finrvwrateapplfor,
							t1.totalrepayamt,
							t1.closingstatus,
							t1.finapproveddate,
							t1.feechargeamt,
							t1.blacklisted,
							t1.finrepaypftonfrq,
							t1.anualizedpercrate,
							t1.effectiverateofreturn,
							t1.migratedfinance,
							t1.schedulemaintained,
							t1.scheduleregenerated,
							t1.finpurpose,
							t39.loanpurposedesc AS lovdescfinpurposename,
							t1.finstatus,
							t1.finstsreason,
							t1.initiateuser,
							t1.bankname,
							t1.iban,
							t1.accounttype,
							t1.ddareferenceno,
							t7.finscheduleon AS lovdescfinscheduleon,
							t1.custdsr,
							t1.jointaccount,
							t1.jointcustid,
							t1.downpaybank,
							t1.downpaysupl,
							t1.downpayaccount,
							t1.securitycollateral,
							t1.approved,
							t1.discrepancy,
							t1.limitapproved,
							t1.graceterms,
							t7.findivision AS lovdescfindivision,
							t1.rcdmaintainsts,
							t1.finrepaymethod,
							t1.grcprofitdaysbasis,
							t1.stepfinance,
							t1.steptype,
							t1.steppolicy,
							t1.alwmanualsteps,
							t1.noofsteps,
							t1.linkedfinref,
							t1.nextuserid,
							t1.priority,
							t24.policydesc AS lovdescsteppolicyname,
							t1.grcminrate,
							t1.grcmaxrate,
							t1.rpyminrate,
							t1.rpymaxrate,
							t1.deviationapproval,
							t1.manualschedule,
							t1.takeoverfinance,
							t1.grcadvbaserate,
							t1.grcadvmargin,
							t1.grcadvpftrate,
							t1.rpyadvbaserate,
							t1.rpyadvmargin,
							t1.rpyadvpftrate,
							t1.supplementrent,
							t1.increasedcost,
							t1.creditinsamt,
							t1.rolloverfrq,
							t1.nextrolloverdate,
							t27.custstsdescription,
							t1.shariastatus,
							t1.initiatedate,
							t1.finpreapprovedref,
							t1.mmaid,
							t1.accountsofficer,
							t1.feeaccountid,
							t1.fincancelac,
							t28.dealername AS lovdescaccountsofficer,
							t28.dealercity AS lovdescsourcecity,
							t1.dsacode,
							t30.rofficerdesc AS dsacodedesc,
							t1.tdsapplicable,
							t1.mandateid,
							t1.droplinefrq,
							t1.firstdroplinedate,
							t1.pftservicingodlimit,
							t1.insuranceamt,
							t1.deductinsdisb,
							t1.alwbpi,
							t1.bpitreatment,
							t1.planemihalw,
							t1.planemihmethod,
							t1.planemihmaxperyear,
							t1.planemihmax,
							t1.planemihlockperiod,
							t1.planemicpz,
							t1.calroundingmode,
							t1.alwmultidisb,
							t1.applicationno,
							t1.referralid,
							t33.rofficerdesc AS referraliddesc,
							t1.dmacode,
							t34.rofficerdesc AS dmacodedesc,
							t1.salesdepartment,
							t35.deptdesc AS salesdepartmentdesc,
							t1.quickdisb,
							t1.wifreference,
							t1.unplanemihlockperiod,
							t1.unplanemicpz,
							t1.reagecpz,
							t1.maxunplannedemi,
							t1.maxreageholidays,
							t1.availedunplanemi,
							t1.availedreageh,
							t1.bpiamount,
							t1.deductfeedisb,
							t1.rvwrateapplfor,
							t1.schcalonrvw,
							t1.pastduepftcalmthd,
							t1.pastduepftmargin,
							t1.droppingmethod,
							t1.ratechganyday,
							t1.promotioncode,
							t1.restructureloan,
							t1.oldfinreference,
							t1.reagebucket,
							t1.fincategory,
							t1.productcategory,
							t1.roundingtarget,
							t36.entitycode AS lovdescentitycode,
							t1.eligibilitymethod,
							t38.fieldcodevalue AS loveligibilitymethod,
							t38.valuedesc AS lovdesceligibilitymethod,
							t1.employeename,
							t37.rofficerdesc AS employeenamedesc,
							t1.samplingrequired,
							t1.legalrequired,
							t1.grcmaxamount,
							t1.connector,
							t40.dealername AS connectorcode,
							t40.dealercity AS connectordesc,
							t1.advanceemi,
							t1.advemiterms,
							t1.bpipftdaysbasis,
							t1.fixedratetenor,
							t1.fixedtenorrate,
							t12.branchtel AS finbranchcontact,
							t1.processattributes,
							t1.businessvertical,
							bv.code AS businessverticalcode,
							bv.description AS businessverticaldesc,
							t1.grcadvtype,
							t1.grcadvterms,
							t1.advtype,
							t1.advterms,
							t1.advstage,
							t1.tdspercentage,
							t1.tdsstartdate,
							t1.tdsenddate,
							t1.tdslimitamt,
							t1.vanreq,
							t1.vancode,
							t1.allowdrawingpower,
							t1.allowrevolving,
							t1.sanbsdschdle,
							t1.promotionseqid,
							t1.svamount,
							t1.cbamount,
							t1.appliedloanamt,
							t1.finisratervwatgrcend,
							t1.reqloanamt,
							t1.reqloantenor,
							t1.finocrrequired,
							t1.offerproduct,
							t1.offeramount,
							t1.custsegmentation,
							t1.baseproduct,
							t1.processtype,
							t1.bureautimeseries,
							t1.campaignname,
							t1.existinglanrefno,
							t1.leadsource,
							t1.posource,
							t1.rsa,
							t1.verification,
							t1.sourcingbranch,
							t1.sourchannelcategory,
							t1.asmname,
							t13.branchdesc AS lovdescsourcingbranch,
							t1.endgrcperiodaftrfulldisb,
							t1.autoincgrcenddate,
							t1.alwgrcadj,
							t1.pmay,
							t1.offerid,
							t1.alwloansplit,
							t1.parentref,
							t1.loansplitted,
							t1.instbasedschd,
							t1.planemihalwingrace
						FROM financemain t1
							JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
							LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
							LEFT JOIN rmtbranches t13 ON t1.sourcingbranch = t13.branchcode
							LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
							LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
							LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
							LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
							LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
							LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
							LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
							LEFT JOIN bmtdepartments t35 ON t1.salesdepartment = t35.deptcode
							LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
							LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
							LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
							LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
							LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
							LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
		
						]]>
		</createView>
	</changeSet>

	<changeSet id="04_post" author="satish.k" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_aview');	
			]]>
		</sql>
	</changeSet>


	<changeSet id="05_pre" author="satish.k" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_tview'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="05" author="satish.k">
		<createView viewName="financemain_tview" replaceIfExists="true">
		<![CDATA[	SELECT t1.finreference,
								t1.investmentref,
								t1.numberofterms,
								t1.grcperiodenddate,
								t1.allowgrcperiod,
								t1.gracebaserate,
								t1.gracespecialrate,
								t1.grcpftrate,
								t1.grcpftfrq,
								t1.nextgrcpftdate,
								t1.allowgrcpftrvw,
								t1.grcpftrvwfrq,
								t1.nextgrcpftrvwdate,
								t1.allowgrccpz,
								t1.grccpzfrq,
								t1.nextgrccpzdate,
								t1.repaybaserate,
								t1.repayspecialrate,
								t1.repayprofitrate,
								t1.repayfrq,
								t1.nextrepaydate,
								t1.repaypftfrq,
								t1.nextrepaypftdate,
								t1.allowrepayrvw,
								t1.repayrvwfrq,
								t1.nextrepayrvwdate,
								t1.allowrepaycpz,
								t1.repaycpzfrq,
								t1.nextrepaycpzdate,
								t1.maturitydate,
								t1.cpzatgraceend,
								t1.downpayment,
								t1.graceflatamount,
								t1.reqrepayamount,
								t1.totalprofit,
								t1.totalcpz,
								t1.totalgrosspft,
								t1.totalgrossgrcpft,
								t1.totalgracepft,
								t1.totalgracecpz,
								t1.grcratebasis,
								t1.repayratebasis,
								t1.fintype,
								t1.finremarks,
								t1.finccy,
								t1.schedulemethod,
								t1.profitdaysbasis,
								t1.reqmaturity,
								t1.calterms,
								t1.calmaturity,
								t1.firstrepay,
								t1.lastrepay,
								t1.finstartdate,
								t1.finamount,
								t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
								t1.finrepaymentamount,
								t1.custid,
								t1.defferments,
								t1.plandefercount,
								t1.finbranch,
								t1.finsourceid,
								t1.alloweddefrpychange,
								t1.availeddefrpychange,
								t1.alloweddeffrqchange,
								t1.availeddeffrqchange,
								t1.recaltype,
								t1.finassetvalue,
								t1.disbaccountid,
								t1.repayaccountid,
								t1.finisactive,
								t1.limitvalid,
								t1.overridelimit,
								t1.securitydeposit,
								t1.version,
								t1.lastmntby,
								t1.lastmnton,
								t1.recordstatus,
								t1.rolecode,
								t1.nextrolecode,
								t1.taskid,
								t1.nexttaskid,
								t1.recordtype,
								t1.workflowid,
								t7.fintypedesc AS lovdescfintypename,
								t7.finmaxamount AS lovdescfinmaxamt,
								t7.finminamount AS lovdescfinminamount,
								t1.mindownpayperc,
								t7.finisalwdifferment AS lovdescfinalwdeferment,
								t7.finisdwpayrequired AS lovdescdwnpayreq,
								t7.finmaxdifferment AS lovdescfinmaxdifferment,
								t12.branchdesc AS lovdescfinbranchname,
								t12.branchprovince AS finbranchprovincecode,
								t1.lastrepaydate,
								t1.lastrepaypftdate,
								t1.lastrepayrvwdate,
								t1.lastrepaycpzdate,
								t1.allowgrcrepay,
								t1.grcschdmthd,
								t1.grcmargin,
								t1.repaymargin,
								t1.fincurrassetvalue,
								t1.fincommitmentref,
								t1.finlimitref,
								t1.depreciationfrq,
								t1.fincontractdate,
								t1.nextdepdate,
								t1.lastdepdate,
								t1.finaccount,
								t1.fincustpftaccount,
								t17.acrtilllbd AS lovdescaccruedtilllbd,
								t7.finrvwrateapplfor,
								t1.totalrepayamt,
								t1.closingstatus,
								t1.finapproveddate,
								t1.feechargeamt,
								t1.blacklisted,
								t1.finrepaypftonfrq,
								t1.anualizedpercrate,
								t1.effectiverateofreturn,
								t1.migratedfinance,
								t1.schedulemaintained,
								t1.scheduleregenerated,
								t1.finpurpose,
								t39.loanpurposedesc AS lovdescfinpurposename,
								t1.finstatus,
								t1.finstsreason,
								t1.initiateuser,
								t1.bankname,
								t1.iban,
								t1.accounttype,
								t1.ddareferenceno,
								t7.finscheduleon AS lovdescfinscheduleon,
								t1.custdsr,
								t1.jointaccount,
								t1.jointcustid,
								t1.downpaybank,
								t1.downpaysupl,
								t1.downpayaccount,
								t1.securitycollateral,
								t1.approved,
								t1.discrepancy,
								t1.limitapproved,
								t1.graceterms,
								t7.findivision AS lovdescfindivision,
								t1.rcdmaintainsts,
								t1.finrepaymethod,
								t1.grcprofitdaysbasis,
								t1.stepfinance,
								t1.steptype,
								t1.steppolicy,
								t1.alwmanualsteps,
								t1.noofsteps,
								t1.linkedfinref,
								t1.nextuserid,
								t1.priority,
								t24.policydesc AS lovdescsteppolicyname,
								t1.grcminrate,
								t1.grcmaxrate,
								t1.rpyminrate,
								t1.rpymaxrate,
								t1.deviationapproval,
								t1.manualschedule,
								t1.takeoverfinance,
								t1.grcadvbaserate,
								t1.grcadvmargin,
								t1.grcadvpftrate,
								t1.rpyadvbaserate,
								t1.rpyadvmargin,
								t1.rpyadvpftrate,
								t1.supplementrent,
								t1.increasedcost,
								t1.creditinsamt,
								t1.rolloverfrq,
								t1.nextrolloverdate,
								t27.custstsdescription,
								t1.shariastatus,
								t1.initiatedate,
								t1.finpreapprovedref,
								t1.mmaid,
								t1.accountsofficer,
								t1.feeaccountid,
								t1.fincancelac,
								t28.dealername AS lovdescaccountsofficer,
								t28.dealercity AS lovdescsourcecity,
								t1.dsacode,
								t30.rofficerdesc AS dsacodedesc,
								t1.tdsapplicable,
								t1.mandateid,
								t1.droplinefrq,
								t1.firstdroplinedate,
								t1.pftservicingodlimit,
								t1.insuranceamt,
								t1.deductinsdisb,
								t1.alwbpi,
								t1.bpitreatment,
								t1.planemihalw,
								t1.planemihmethod,
								t1.planemihmaxperyear,
								t1.planemihmax,
								t1.planemihlockperiod,
								t1.planemicpz,
								t1.calroundingmode,
								t1.alwmultidisb,
								t1.applicationno,
								t1.referralid,
								t33.rofficerdesc AS referraliddesc,
								t1.dmacode,
								t34.rofficerdesc AS dmacodedesc,
								t1.salesdepartment,
								t35.deptdesc AS salesdepartmentdesc,
								t1.quickdisb,
								t1.wifreference,
								t1.unplanemihlockperiod,
								t1.unplanemicpz,
								t1.reagecpz,
								t1.maxunplannedemi,
								t1.maxreageholidays,
								t1.availedunplanemi,
								t1.availedreageh,
								t1.bpiamount,
								t1.deductfeedisb,
								t1.rvwrateapplfor,
								t1.schcalonrvw,
								t1.pastduepftcalmthd,
								t1.pastduepftmargin,
								t1.droppingmethod,
								t1.ratechganyday,
								t1.promotioncode,
								t1.restructureloan,
								t1.oldfinreference,
								t1.reagebucket,
								t1.fincategory,
								t1.productcategory,
								t1.roundingtarget,
								t36.entitycode AS lovdescentitycode,
								t1.eligibilitymethod,
								t38.fieldcodevalue AS loveligibilitymethod,
								t38.valuedesc AS lovdesceligibilitymethod,
								t1.employeename,
								t37.rofficerdesc AS employeenamedesc,
								t1.samplingrequired,
								t1.legalrequired,
								t1.grcmaxamount,
								t1.connector,
								t40.dealername AS connectorcode,
								t40.dealercity AS connectordesc,
								t1.advanceemi,
								t1.advemiterms,
								t1.bpipftdaysbasis,
								t1.fixedratetenor,
								t1.fixedtenorrate,
								t12.branchtel AS finbranchcontact,
								t1.processattributes,
								t1.businessvertical,
								bv.code AS businessverticalcode,
								bv.description AS businessverticaldesc,
								t1.grcadvtype,
								t1.grcadvterms,
								t1.advtype,
								t1.advterms,
								t1.advstage,
								t1.tdspercentage,
								t1.tdsstartdate,
								t1.tdsenddate,
								t1.tdslimitamt,
								t1.vanreq,
								t1.vancode,
								t1.allowdrawingpower,
								t1.allowrevolving,
								t1.sanbsdschdle,
								t1.promotionseqid,
								t1.svamount,
								t1.cbamount,
								t1.appliedloanamt,
								t1.finisratervwatgrcend,
								t1.reqloanamt,
								t1.reqloantenor,
								t1.finocrrequired,
								t1.offerproduct,
								t1.offeramount,
								t1.custsegmentation,
								t1.baseproduct,
								t1.processtype,
								t1.bureautimeseries,
								t1.campaignname,
								t1.existinglanrefno,
								t1.leadsource,
								t1.posource,
								t1.rsa,
								t1.verification,
								t1.sourcingbranch,
								t1.sourchannelcategory,
								t1.asmname,
								t13.branchdesc AS lovdescsourcingbranch,
								t1.offerid,
								t1.endgrcperiodaftrfulldisb,
								t1.autoincgrcenddate,
								t1.alwgrcadj,
								t1.pmay,
								t1.alwloansplit,
								t1.parentref,
								t1.loansplitted,
								t1.instbasedschd,
								t1.planemihalwingrace
							FROM financemain_temp t1
								JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
								LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
								LEFT JOIN rmtbranches t13 ON t1.sourcingbranch = t13.branchcode
								LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
								LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
								LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
								LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
								LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
								LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
								LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
								LEFT JOIN bmtdepartments t35 ON t1.salesdepartment = t35.deptcode
								LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
								LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
								LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
								LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
								LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
								LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
						]]>
		</createView>
	</changeSet>

	<changeSet id="05_post" author="satish.k" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_tview');	
			]]>
		</sql>
	</changeSet>


	<changeSet id="06_pre" author="satish.k" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_lview'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="06" author="satish.k">
		<createView viewName="FinanceMain_LView" replaceIfExists="true">
			<![CDATA[
			 SELECT t1.finreference,
							t1.investmentref,
							t1.fintype,
							t1.finccy,
							t1.finamount,
							t1.downpayment,
							t1.feechargeamt,
							t1.schedulemethod,
							t1.numberofterms,
							t1.recordstatus,
							t1.recordtype,
							t1.rolecode,
							t1.nextrolecode,
							t1.finbranch,
							t1.fincontractdate,
							t1.linkedfinref,
							t1.nextuserid,
							t1.priority,
							t1.workflowid,
							t1.taskid,
							t1.nexttaskid,
							t1.finpreapprovedref,
							t1.rcdmaintainsts,
							t1.insuranceamt,
							t1.fincurrassetvalue,
							t1.calterms,
							t1.deviationapproval,
							t1.finpurpose,
							t1.initiatedate,
							t1.finassetvalue,
							t2.custcif AS lovdesccustcif,
							t2.custshrtname AS lovdesccustshrtname,
							t2.custpassportno AS lovdesccustpassportno,
							t2.custdob AS lovdesccustdob,
							t2.custcrcpr AS lovdesccustcrcpr,
							t2.phonenumber,
							t3.fincategory AS lovdescproductcodename,
							t3.findivision AS lovdescfindivision,
							t3.product AS lovdescfinproduct,
							t3.fintypedesc AS lovdescfintypename,
							COALESCE(t4.roledesc, ${add.schema}fn_get_roledesc(t1.nextrolecode)) AS lovdescrequeststage,
							t1.samplingrequired,
							t1.advanceemi,
							t1.advemiterms,
							t1.bpipftdaysbasis,
							t1.graceterms,
							t1.productcategory,
							t1.reqloanamt,
							t1.reqloantenor,
							t1.finocrrequired,
							t1.offerproduct,
							t1.offeramount,
							t1.custsegmentation,
							t1.baseproduct,
							t1.processtype,
							t1.bureautimeseries,
							t1.campaignname,
							t1.existinglanrefno,
							t1.leadsource,
							t1.posource,
							t1.rsa,
							t1.verification,
							t1.sourcingbranch,
							t1.sourchannelcategory,
							t1.asmname,
							t1.offerid,
							t1.applicationno,
							t1.lastmnton,
							t1.custid,
							t1.instbasedschd,
							t1.version
						FROM financemain_temp t1
							JOIN customers t2 ON t1.custid = t2.custid
							JOIN rmtfinancetypes t3 ON t3.fintype = t1.fintype
							LEFT JOIN secroles t4 ON t1.nextrolecode = t4.rolecd
			
			
			]]>
		</createView>
	</changeSet>

	<changeSet id="06_post" author="satish.k" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_lview');	
			]]>
		</sql>
	</changeSet>


	<!-- differencial views as parth of core >> HL -->

	<changeSet id="ST#1211.1_pre" author="Gopal.p" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies('plf','int_disbursement_request_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.1" author="Gopal.p">
		<createView viewName="INT_DISBURSEMENT_REQUEST_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT FA.PAYMENTID,
				FA.FINREFERENCE,
				'D' CHANNEL,
				0 PROVIDERID,
				CASE
				WHEN FA.PAYMENTTYPE = 'NEFT'
				THEN 'N'
				WHEN FA.PAYMENTTYPE = 'RTGS'
				THEN 'R'
				WHEN
				FA.PAYMENTTYPE = 'DD'
				THEN 'D'
				WHEN FA.PAYMENTTYPE = 'CHEQUE'
				THEN 'C'
				ELSE FA.PAYMENTTYPE
				END DISBURSEMENT_TYPE,
				FA.AMTTOBERELEASED,
				FA.DISBDATE,
				FA.LLDATE,
				FA.PAYABLELOC,
				FA.PRINTINGLOC,
				FA.LLREFERENCENO CHEQUE_NUMBER,
				CU.CUSTCIF,
				CU.CUSTSHRTNAME,
				'' CUSTOMER_MOBILE,
				CE.CUSTEMAIL CUSTOMER_EMAIL,
				CS.CPPROVINCENAME CUSTOMER_STATE,
				CC.PCCITYNAME CUSTOMER_CITY,
				'' CUSTOMER_ADDRESS1,
				'' CUSTOMER_ADDRESS2,
				'' CUSTOMER_ADDRESS3,
				'' CUSTOMER_ADDRESS4,
				'' CUSTOMER_ADDRESS5,
				BD.BANKNAME,
				BB.BRANCHCODE,
				BB.BRANCHDESC,
				PBD.CPPROVINCENAME BENFICIARY_BRANCH_STATE,
				PBD.PCCITYNAME BENFICIARY_BRANCH_CITY,
				BB.MICR MICR_CODE,
				BB.IFSC IFSC_CODE,
				FA.BENEFICIARYACCNO,
				CASE
				WHEN FA.PAYMENTTYPE = 'CHEQUE'
				OR FA.PAYMENTTYPE = 'DD'
				THEN
				FA.LIABILITYHOLDNAME
				ELSE FA.BENEFICIARYNAME
				END BENEFICIARYNAME,
				(FA.PHONECOUNTRYCODE ${call.concatenate} FA.PHONEAREACODE) ${call.concatenate} FA.PHONENUMBER BENEFICIARY_MOBILE,
				BCE.CUSTEMAIL BENFICIRY_EMAIL,
				BRS.CPPROVINCENAME BENFICIARY_STATE,
				BRC.PCCITYNAME BENFICIARY_CITY,
				BRCA.CustAddrHNbr ${call.concatenate}','${call.concatenate} BRCA.CustAddrStreet ${call.concatenate}','${call.concatenate} BRC.PCCITYNAME ${call.concatenate}','${call.concatenate} BRS.CPPROVINCENAME  BENFICIARY_ADDRESS1,
				'' BENFICIARY_ADDRESS2,
				'' BENFICIARY_ADDRESS3,
				'' BENFICIARY_ADDRESS4,
				'' BENFICIARY_ADDRESS5,
				'' PAYMENT_DETAIL1,
				'' PAYMENT_DETAIL2,
				'' PAYMENT_DETAIL3,
				'' PAYMENT_DETAIL4,
				'' PAYMENT_DETAIL5,
				'' PAYMENT_DETAIL6,
				'' PAYMENT_DETAIL7,
				FA.STATUS,
				FA.DESCRIPTION REMARKS,
				FA.PAYMENTTYPE,
				FM.FINTYPE,
				PB.PARTNERBANKID
				PARTNERBANK_ID,
				PB.PARTNERBANKCODE PARTNERBANK_CODE,
				FA.INPUTDATE,
				PB.ALWFILEDOWNLOAD,
				PB.FILENAME,
				FM.FINISACTIVE,
				SMD.ENTITYCODE,
				FA.HOLDDISBURSEMENT HOLDDISBURSEMENT,
				PB.ACCOUNTNO PARTNERBANK_ACCOUNT
				FROM FINADVANCEPAYMENTS FA
				JOIN
				(SELECT FINANCEMAIN_TEMP.CUSTID,
				FINANCEMAIN_TEMP.FINREFERENCE,
				FINANCEMAIN_TEMP.FINTYPE,
				FINANCEMAIN_TEMP.FINISACTIVE
				FROM FINANCEMAIN_TEMP
				UNION ALL
				SELECT T2.CUSTID,
				T2.FINREFERENCE,
				T2.FINTYPE,
				T2.FINISACTIVE
				FROM FINANCEMAIN T2
				WHERE NOT (EXISTS
				( SELECT 1 FROM
				FINANCEMAIN_TEMP T3 WHERE T3.FINREFERENCE = T2.FINREFERENCE))) FM
				ON FM.FINREFERENCE = FA.FINREFERENCE
				JOIN CUSTOMERS CU ON CU.CUSTID = FM.CUSTID	
				JOIN RMTCURRENCIES CCY ON CCY.CCYCODE	= FA.DISBCCY
				JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = FA.PARTNERBANKID
				LEFT JOIN CUSTOMEREMAILS CE	ON CE.CUSTID = CU.CUSTID AND CE.CUSTEMAILPRIORITY = 5
				LEFT JOIN CUSTOMERADDRESSES CA ON CA.CUSTID = CE.CUSTID	AND CA.CUSTADDRPRIORITY = 5
				LEFT JOIN RMTPROVINCEVSCITY CC ON CC.PCCITY = CA.CUSTADDRCITY
				LEFT JOIN RMTCOUNTRYVSPROVINCE CS ON CS.CPPROVINCE = CC.PCPROVINCE
				LEFT JOIN BANKBRANCHES BB ON BB.BANKBRANCHID = FA.BANKBRANCHID
				LEFT JOIN BMTBANKDETAIL BD ON BD.BANKCODE =	BB.BANKCODE
				LEFT JOIN ( SELECT PB_1.PARTNERBANKID,	
				PBD_1.BANKNAME,
				PBB.BRANCHDESC,
				PBBRC.PCCITYNAME,
				PBBRS.CPPROVINCENAME FROM PARTNERBANKS PB_1
				JOIN BANKBRANCHES PBB ON PBB.BRANCHCODE = PB_1.BANKBRANCHCODE AND PBB.BANKCODE = PB_1.BANKCODE
				JOIN BMTBANKDETAIL PBD_1 ON PBD_1.BANKCODE = PBB.BANKCODE
				LEFT JOIN RMTPROVINCEVSCITY PBBRC ON PBBRC.PCCITY = PBB.CITY
				LEFT JOIN RMTCOUNTRYVSPROVINCE PBBRS ON PBBRS.CPPROVINCE = PBBRC.PCPROVINCE
				) PBD ON PBD.PARTNERBANKID = PB.PARTNERBANKID
				LEFT JOIN BENEFICIARY BR ON BR.BANKBRANCHID = FA.BANKBRANCHID AND
				BR.ACCNUMBER = FA.BENEFICIARYACCNO AND BR.CUSTID = FM.CUSTID
				LEFT JOIN CUSTOMERS BC ON BC.CUSTID = BR.CUSTID
				LEFT JOIN CUSTOMEREMAILS BCE ON BCE.CUSTID = CU.CUSTID
				AND BCE.CUSTEMAILPRIORITY = 5
				LEFT JOIN CUSTOMERADDRESSES	BRCA ON	BRCA.CUSTID = BR.CUSTID
				AND BRCA.CUSTADDRPRIORITY = 5
				LEFT JOIN RMTPROVINCEVSCITY BRC	ON BRC.PCCITY =	BRCA.CUSTADDRCITY
				LEFT JOIN RMTCOUNTRYVSPROVINCE BRS ON BRS.CPPROVINCE = BRC.PCPROVINCE
				LEFT JOIN RMTFINANCETYPES RFT ON FM.FINTYPE = RFT.FINTYPE
				LEFT JOIN SMTDIVISIONDETAIL SMD	ON RFT.FINDIVISION = SMD.DIVISIONCODE
				WHERE FA.STATUS = 'APPROVED' AND NOT (FA.PAYMENTID IN ( 
				SELECT DISBURSEMENT_REQUESTS.DISBURSEMENT_ID FROM DISBURSEMENT_REQUESTS))
				AND NOT	(FA.PAYMENTID IN ( SELECT FINADVANCEPAYMENTS_TEMP.PAYMENTID FROM FINADVANCEPAYMENTS_TEMP))
				UNION ALL
				SELECT
				PI.PAYMENTINSTRUCTIONID PAYMENTID,
				PH.FINREFERENCE,
				PH.PAYMENTTYPE CHANNEL,
				0 PROVIDERID,
				CASE
				WHEN PI.PAYMENTTYPE =
				'NEFT'
				THEN 'N'
				WHEN PI.PAYMENTTYPE = 'RTGS'
				THEN 'R'
				WHEN PI.PAYMENTTYPE = 'DD'
				THEN 'D'
				WHEN PI.PAYMENTTYPE = 'CHEQUE'
				THEN 'C'
				ELSE PI.PAYMENTTYPE
				END DISBURSEMENT_TYPE,
				PI.PAYMENTAMOUNT  AMTTOBERELEASED,
				PI.POSTDATE
				DISBDATE,
				PI.POSTDATE LLDATE,
				PI.PAYABLELOC,
				PI.PRINTINGLOC,
				PI.FAVOURNUMBER CHEQUE_NUMBER,
				CU.CUSTCIF,
				CU.CUSTSHRTNAME,
				'' CUSTOMER_MOBILE,
				CE.CUSTEMAIL
				CUSTOMER_EMAIL,
				CS.CPPROVINCENAME CUSTOMER_STATE,
				CC.PCCITYNAME CUSTOMER_CITY,
				'' CUSTOMER_ADDRESS1,
				'' CUSTOMER_ADDRESS2,
				'' CUSTOMER_ADDRESS3,
				'' CUSTOMER_ADDRESS4,
				'' CUSTOMER_ADDRESS5,
				BD.BANKNAME,
				BB.BRANCHCODE,
				BB.BRANCHDESC,
				BBRS.CPPROVINCENAME BENFICIARY_BRANCH_STATE,
				BBRC.PCCITYNAME BENFICIARY_BRANCH_CITY,
				BB.MICR MICR_CODE,
				BB.IFSC IFSC_CODE,
				PI.ACCOUNTNO BENEFICIARYACCNO,
				CASE
				WHEN PI.PAYMENTTYPE = 'CHEQUE'
				OR PI.PAYMENTTYPE = 'DD'
				THEN
				PI.FAVOURNAME
				ELSE PI.ACCTHOLDERNAME
				END BENEFICIARYNAME,
				PI.PHONECOUNTRYCODE ${call.concatenate} PI.PHONENUMBER BENEFICIARY_MOBILE,
				BCE.CUSTEMAIL BENFICIRY_EMAIL,
				BRS.CPPROVINCENAME BENFICIARY_STATE,
				BRC.PCCITYNAME BENFICIARY_CITY,
				'' BENFICIARY_ADDRESS1,
				'' BENFICIARY_ADDRESS2,
				'' BENFICIARY_ADDRESS3,
				'' BENFICIARY_ADDRESS4,
				'' BENFICIARY_ADDRESS5,
				'' PAYMENT_DETAIL1,
				'' PAYMENT_DETAIL2,
				'' PAYMENT_DETAIL3,
				'' PAYMENT_DETAIL4,
				'' PAYMENT_DETAIL5,
				'' PAYMENT_DETAIL6,
				'' PAYMENT_DETAIL7,
				PI.STATUS,
				PI.REMARKS,
				PI.PAYMENTTYPE,
				FM.FINTYPE,
				PB.PARTNERBANKID PARTNERBANK_ID,
				PB.PARTNERBANKCODE
				PARTNERBANK_CODE,
				PI.POSTDATE INPUTDATE,
				PB.ALWFILEDOWNLOAD,
				PB.FILENAME,
				FM.FINISACTIVE,
				SMD.ENTITYCODE,
				0 HOLDDISBURSEMENT,
				PB.ACCOUNTNO PARTNERBANK_ACCOUNTNO
				FROM PAYMENTINSTRUCTIONS PI
				JOIN PAYMENTHEADER PH ON PH.PAYMENTID = PI.PAYMENTID
				JOIN (SELECT
				FINANCEMAIN.CUSTID,
				FINANCEMAIN.FINREFERENCE,
				FINANCEMAIN.FINTYPE,
				FINANCEMAIN.FINISACTIVE
				FROM FINANCEMAIN
				UNION ALL
				SELECT T2.CUSTID,
				T2.FINREFERENCE,
				T2.FINTYPE,
				T2.FINISACTIVE
				FROM FINANCEMAIN_TEMP T2
				WHERE NOT (EXISTS
				( SELECT 1 FROM
				FINANCEMAIN_TEMP T3 WHERE T3.FINREFERENCE = T2.FINREFERENCE))) FM ON FM.FINREFERENCE = PH.FINREFERENCE
				JOIN CUSTOMERS CU ON CU.CUSTID = FM.CUSTID
				JOIN RMTCURRENCIES CCY ON CCY.CCYCODE = PI.PAYMENTCCY
				JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = PI.PARTNERBANKID
				LEFT JOIN CUSTOMEREMAILS CE ON CE.CUSTID = CU.CUSTID AND CE.CUSTEMAILPRIORITY = 5
				LEFT JOIN CUSTOMERADDRESSES CA ON CA.CUSTID = CE.CUSTID AND CA.CUSTADDRPRIORITY = 5
				LEFT JOIN RMTPROVINCEVSCITY CC ON CC.PCCITY = CA.CUSTADDRCITY
				LEFT JOIN RMTCOUNTRYVSPROVINCE CS ON CS.CPPROVINCE = CC.PCPROVINCE
				LEFT JOIN CUSTOMERPHONENUMBERS CM ON CM.PHONECUSTID = CU.CUSTID
				AND CM.PHONETYPECODE = 'MOBILE1' AND CM.PHONETYPEPRIORITY = 5
				LEFT JOIN BANKBRANCHES BB ON BB.BANKBRANCHID = PI.BANKBRANCHID
				LEFT JOIN BMTBANKDETAIL BD ON BD.BANKCODE = BB.BANKCODE
				LEFT JOIN RMTPROVINCEVSCITY	BBRC ON BBRC.PCCITY = BB.CITY
				LEFT JOIN RMTCOUNTRYVSPROVINCE BBRS	ON BBRS.CPPROVINCE = BBRC.PCPROVINCE
				LEFT JOIN BENEFICIARY BR ON BR.BANKBRANCHID = PI.BANKBRANCHID
				AND BR.ACCNUMBER = PI.ACCOUNTNO	AND BR.CUSTID = FM.CUSTID
				LEFT JOIN CUSTOMERS BC ON BC.CUSTID = BR.CUSTID
				LEFT JOIN CUSTOMEREMAILS BCE ON	BCE.CUSTID = CU.CUSTID AND BCE.CUSTEMAILPRIORITY = 5
				LEFT JOIN CUSTOMERADDRESSES BRCA ON BRCA.CUSTID = BR.CUSTID	AND	BRCA.CUSTADDRPRIORITY = 5
				LEFT JOIN RMTPROVINCEVSCITY BRC	ON BRC.PCCITY = BRCA.CUSTADDRCITY
				LEFT JOIN RMTCOUNTRYVSPROVINCE BRS ON BRS.CPPROVINCE = BRC.PCPROVINCE
				LEFT JOIN RMTFINANCETYPES RFT ON FM.FINTYPE = RFT.FINTYPE
				LEFT JOIN SMTDIVISIONDETAIL SMD	ON RFT.FINDIVISION = SMD.DIVISIONCODE
				WHERE PI.STATUS = 'APPROVED'
				AND NOT
				(PI.PAYMENTINSTRUCTIONID IN
				( SELECT DISBURSEMENT_REQUESTS.DISBURSEMENT_ID FROM
				DISBURSEMENT_REQUESTS
				))
				UNION ALL
				SELECT PI.ID PAYMENTID,
				VR.PRIMARYLINKREF FINREFERENCE,
				'I' CHANNEL,
				PI.PROVIDERID,
				CASE
				WHEN
				PI.PAYMENTTYPE = 'NEFT'
				THEN 'N'
				WHEN PI.PAYMENTTYPE = 'RTGS'
				THEN 'R'
				WHEN PI.PAYMENTTYPE = 'DD'
				THEN 'D'
				WHEN
				PI.PAYMENTTYPE = 'CHEQUE'
				THEN 'C'
				ELSE PI.PAYMENTTYPE
				END DISBURSEMENT_TYPE,
				PI.PAYMENTAMOUNT  AMTTOBERELEASED,
				PI.PAYMENTDATE DISBDATE,
				PI.PAYMENTDATE LLDATE,
				'' PAYABLELOC,
				'' PRINTINGLOC,
				'' as CHEQUE_NUMBER,
				'' CUSTCIF,
				'' CUSTSHRTNAME,
				'' CUSTOMER_MOBILE,
				'' CUSTOMER_EMAIL,
				'' CUSTOMER_STATE,
				'' CUSTOMER_CITY,
				'' CUSTOMER_ADDRESS1,
				'' CUSTOMER_ADDRESS2,
				'' CUSTOMER_ADDRESS3,
				'' CUSTOMER_ADDRESS4,
				'' CUSTOMER_ADDRESS5,
				BD.BANKNAME,
				BB.BRANCHCODE,
				BB.BRANCHDESC,
				BBRS.CPPROVINCENAME BENFICIARY_BRANCH_STATE,
				BBRC.PCCITYNAME BENFICIARY_BRANCH_CITY,
				BB.MICR MICR_CODE,
				BB.IFSC IFSC_CODE,
				VPA.ACCOUNTNUMBER BENEFICIARYACCNO,
				AVD.DEALERNAME BENEFICIARYNAME,
				AVD.DEALERTELEPHONE
				BENEFICIARY_MOBILE,
				AVD.EMAIL BENFICIRY_EMAIL,
				BRS.CPPROVINCENAME BENFICIARY_STATE,
				BRC.PCCITYNAME BENFICIARY_CITY,
				AVD.DEALERADDRESS1 BENFICIARY_ADDRESS1,
				AVD.DEALERADDRESS2 BENFICIARY_ADDRESS2,
				AVD.DEALERADDRESS3 BENFICIARY_ADDRESS3,
				'' BENFICIARY_ADDRESS4,
				'' BENFICIARY_ADDRESS5,
				'' PAYMENT_DETAIL1,
				'' PAYMENT_DETAIL2,
				'' PAYMENT_DETAIL3,
				'' PAYMENT_DETAIL4,
				'' PAYMENT_DETAIL5,
				'' PAYMENT_DETAIL6,
				'' PAYMENT_DETAIL7,
				PI.STATUS,
				PI.REMARKS,
				PI.PAYMENTTYPE,
				'' FINTYPE,
				PB.PARTNERBANKID PARTNERBANK_ID,
				PB.PARTNERBANKCODE PARTNERBANK_CODE,
				PI.PAYMENTDATE INPUTDATE,
				PB.ALWFILEDOWNLOAD,
				PB.FILENAME,
				1 FINISACTIVE,
				PI.ENTITYCODE,
				0 HOLDDISBURSEMENT,
				PB.ACCOUNTNO PARTNERBANK_ACCOUNT
				FROM INSURANCEPAYMENTINSTRUCTIONS PI
				JOIN RMTCURRENCIES CCY ON CCY.CCYCODE = PI.PAYMENTCCY
				JOIN PARTNERBANKS PB ON	PB.PARTNERBANKID = PI.PARTNERBANKID
				JOIN VASPROVIDERACCDETAIL VPA ON VPA.PROVIDERID = PI.PROVIDERID
				JOIN AMTVEHICLEDEALER AVD ON AVD.DEALERID = VPA.PROVIDERID
				JOIN VASRECORDING VR ON VR.PAYMENTINSID = PI.ID
				LEFT JOIN BANKBRANCHES BB ON BB.BANKBRANCHID = VPA.BANKBRANCHID
				LEFT JOIN BMTBANKDETAIL BD ON BD.BANKCODE = BB.BANKCODE
				LEFT JOIN RMTPROVINCEVSCITY BBRC ON BBRC.PCCITY	= BB.CITY
				LEFT JOIN RMTCOUNTRYVSPROVINCE BBRS	ON BBRS.CPPROVINCE = BBRC.PCPROVINCE
				LEFT JOIN RMTPROVINCEVSCITY BRC	ON BRC.PCCITY =	AVD.DEALERCITY
				LEFT JOIN RMTCOUNTRYVSPROVINCE BRS ON BRS.CPPROVINCE = BRC.PCPROVINCE
				WHERE PI.STATUS = 'APPROVED' AND PI.PAYMENTAMOUNT > 0
				AND NOT (PI.ID IN( SELECT DISBURSEMENT_REQUESTS.DISBURSEMENT_ID FROM DISBURSEMENT_REQUESTS))
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.1_post" author="Gopal.p" dbms="postgresql">
		<sql>
			select deps_restore_dependencies('plf','int_disbursement_request_view');
		</sql>
	</changeSet>

	<changeSet id="ST#1211.2_pre" author="Gopal.p" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies('plf','customerbankinfo_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.2" author="Gopal.p">
		<createView viewName="customerbankinfo_aview" replaceIfExists="true">
			<![CDATA[
				SELECT T1.BANKID,
				  T1.CUSTID,
				  T1.BANKNAME,
				  T1.ACCOUNTNUMBER,
				  T1.ACCOUNTTYPE,
				  T1.SALARYACCOUNT,
				  T1.VERSION,
				  T1.LASTMNTBY,
				  T1.LASTMNTON,
				  T1.RECORDSTATUS,
				  T1.ROLECODE,
				  T1.NEXTROLECODE,
				  T1.TASKID,
				  T1.NEXTTASKID,
				  T1.RECORDTYPE,
				  T1.WORKFLOWID,
				  T3.BANKNAME LOVDESCBANKNAME,
				  T4.VALUEDESC LOVDESCACCOUNTTYPE,
				  T1.CREDITTRANNO,
				  T1.CREDITTRANAMT,
				  T1.CREDITTRANAVG,
				  T1.DEBITTRANNO,
				  T1.DEBITTRANAMT,
				  T1.CASHDEPOSITNO,
				  T1.CASHDEPOSITAMT,
				  T1.CASHWITHDRAWALNO,
				  T1.CASHWITHDRAWALAMT,
				  T1.CHQDEPOSITNO,
				  T1.CHQDEPOSITAMT,
				  T1.CHQISSUENO,
				  T1.CHQISSUEAMT,
				  T1.INWARDCHQBOUNCENO,
				  T1.OUTWARDCHQBOUNCENO,
				  T1.EODBALMIN,
				  T1.EODBALMAX,
				  T1.EODBALAVG,
				  T1.BANKBRANCH,
				  T1.FROMDATE,
				  T1.TODATE,
				  T1.REPAYMENTFROM,
				  T1.NOOFMONTHSBANKING,
				  T1.LWOWRATIO,
				  T1.CCLIMIT,
				  T1.TYPEOFBANKS,
				  T1.ACCOUNTOPENINGDATE,
				  T1.ADDTOBENFICIARY,
				  T1.BANKBRANCHID,
				  T5.IFSC,
				  T5.CITY,
				  T1.ACCOUNTHOLDERNAME,
				  T1.PHONENUMBER,
				  T5.MICR,
				  T5.BRANCHCODE
				FROM CUSTOMERBANKINFO T1
				INNER JOIN BMTBANKDETAIL T3 ON T3.BANKCODE = T1.BANKNAME
				INNER JOIN RMTLOVFIELDDETAIL T4 ON T4.FIELDCODEVALUE = T1.ACCOUNTTYPE AND T4.FIELDCODE  = 'ACC_TYPE'
				LEFT JOIN BANKBRANCHES T5 ON T1.BANKBRANCHID = T5.BANKBRANCHID
			]]>
		</createView>
	</changeSet>


	<changeSet id="ST#1211.2_post" author="Gopal.p" dbms="postgresql">
		<sql>
			select deps_restore_dependencies('plf','customerbankinfo_aview');
		</sql>
	</changeSet>

	<changeSet id="ST#1211.3_pre" author="Gopal.p" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies('plf','customerbankinfo_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.3" author="Gopal.p">
		<createView viewName="customerbankinfo_view" replaceIfExists="true">
			<![CDATA[
				SELECT T1.BANKID,
					T1.CUSTID,
					T1.BANKNAME,
					T1.ACCOUNTNUMBER,
					T1.ACCOUNTTYPE,
					T1.SALARYACCOUNT,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T3.BANKNAME LOVDESCBANKNAME,
					T4.VALUEDESC LOVDESCACCOUNTTYPE,
					T1.CREDITTRANNO,
					T1.CREDITTRANAMT,
					T1.CREDITTRANAVG,
					T1.DEBITTRANNO,
					T1.DEBITTRANAMT,
					T1.CASHDEPOSITNO,
					T1.CASHDEPOSITAMT,
					T1.CASHWITHDRAWALNO,
					T1.CASHWITHDRAWALAMT,
					T1.CHQDEPOSITNO,
					T1.CHQDEPOSITAMT,
					T1.CHQISSUENO,
					T1.CHQISSUEAMT,
					T1.INWARDCHQBOUNCENO,
					T1.OUTWARDCHQBOUNCENO,
					T1.EODBALMIN,
					T1.EODBALMAX,
					T1.EODBALAVG,
					T1.BANKBRANCH,
					T1.FROMDATE,
					T1.TODATE,
					T1.REPAYMENTFROM,
					T1.NOOFMONTHSBANKING,
					T1.LWOWRATIO,
					T1.CCLIMIT,
					T1.TYPEOFBANKS,
					T1.ACCOUNTOPENINGDATE,
					T1.ADDTOBENFICIARY,
					T1.BANKBRANCHID,
					T5.IFSC,
					T1.ACCOUNTHOLDERNAME,
					T1.PHONENUMBER,
					T5.CITY,
					T5.MICR,
					T5.BRANCHCODE
				FROM CUSTOMERBANKINFO_TEMP T1
				INNER JOIN BMTBANKDETAIL T3 ON T3.BANKCODE = T1.BANKNAME
				INNER JOIN RMTLOVFIELDDETAIL T4 ON T4.FIELDCODEVALUE = T1.ACCOUNTTYPE AND T4.FIELDCODE ='ACC_TYPE'
				LEFT JOIN BANKBRANCHES T5 ON T1.BANKBRANCHID = T5.BANKBRANCHID
				UNION ALL
				SELECT T1.BANKID,
					T1.CUSTID,
					T1.BANKNAME,
					T1.ACCOUNTNUMBER,
					T1.ACCOUNTTYPE,
					T1.SALARYACCOUNT,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T3.BANKNAME LOVDESCBANKNAME,
					T4.VALUEDESC LOVDESCACCOUNTTYPE,
					T1.CREDITTRANNO,
					T1.CREDITTRANAMT,
					T1.CREDITTRANAVG,
					T1.DEBITTRANNO,
					T1.DEBITTRANAMT,
					T1.CASHDEPOSITNO,
					T1.CASHDEPOSITAMT,
					T1.CASHWITHDRAWALNO,
					T1.CASHWITHDRAWALAMT,
					T1.CHQDEPOSITNO,
					T1.CHQDEPOSITAMT,
					T1.CHQISSUENO,
					T1.CHQISSUEAMT,
					T1.INWARDCHQBOUNCENO,
					T1.OUTWARDCHQBOUNCENO,
					T1.EODBALMIN,
					T1.EODBALMAX,
					T1.EODBALAVG,
					T1.BANKBRANCH,
					T1.FROMDATE,
					T1.TODATE,
					T1.REPAYMENTFROM,
					T1.NOOFMONTHSBANKING,
					T1.LWOWRATIO,
					T1.CCLIMIT,
					T1.TYPEOFBANKS,
					T1.ACCOUNTOPENINGDATE,
					T1.ADDTOBENFICIARY,
					T1.BANKBRANCHID,
					T5.IFSC,
					T1.ACCOUNTHOLDERNAME,
					T1.PHONENUMBER,
					T5.CITY,
					T5.MICR,
					T5.BRANCHCODE
				FROM CUSTOMERBANKINFO T1
				INNER JOIN BMTBANKDETAIL T3 ON T3.BANKCODE = T1.BANKNAME
				INNER JOIN RMTLOVFIELDDETAIL T4 ON T4.FIELDCODEVALUE = T1.ACCOUNTTYPE AND T4.FIELDCODE ='ACC_TYPE'
				LEFT JOIN BANKBRANCHES T5 ON T1.BANKBRANCHID = T5.BANKBRANCHID
				WHERE NOT (EXISTS  (SELECT 1
				FROM CUSTOMERBANKINFO_TEMP
				WHERE CUSTOMERBANKINFO_TEMP.BANKID = T1.BANKID))
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.3_post" author="Gopal.p" dbms="postgresql">
		<sql>
			select deps_restore_dependencies('plf','customerbankinfo_view');
		</sql>
	</changeSet>

	<changeSet id="ST#1211.4_pre" author="Gopal.p" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies('plf','int_mandate_request_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.4" author="Gopal.p">
		<createView viewName="INT_MANDATE_REQUEST_VIEW" replaceIfExists="true">
  		 <![CDATA[
  		    SELECT  M.MANDATEID,
					BD.BANKSHORTCODE BANKCODE,
					BD.BANKNAME,
					case when LB.BRANCHCODE IS NULL THEN CB.BRANCHCODE ELSE LB.BRANCHCODE END BRANCHCODE,
					case when LB.BRANCHDESC IS NULL THEN CB.BRANCHDESC ELSE LB.BRANCHDESC END BRANCHDESC,
					CUST.CUSTCIF,
					CUST.CUSTSHRTNAME,
					CUST.CustCoreBank,
					FT.FINTYPEDESC FINTYPE ,
					FIN.FINREFERENCE ,
					COALESCE((SELECT SUM(TotalAmount) from (Select
					MAX(FSD.REPAYAMOUNT+FSD.FEESCHD) TotalAmount
					FROM FINSCHEDULEDETAILS FSD
					INNER JOIN FINANCEMAIN FM ON FM.FINREFERENCE=FSD.FINREFERENCE AND FM.CUSTID = M.CUSTID
					GROUP BY FM.FINREFERENCE)T)/CCYMINORCCYUNITS, 0) CUST_EMI,
					COALESCE((SELECT SUM(TotalAmount) from (Select MAX(FSD.REPAYAMOUNT+FSD.FEESCHD) TotalAmount FROM FINSCHEDULEDETAILS FSD 
								WHERE (REPAYONSCHDATE = 1 OR PFTONSCHDATE = 1) AND FINREFERENCE IN (SELECT FINREFERENCE FROM FINANCEMAIN WHERE MANDATEID =
					            M.MANDATEID) GROUP BY FINREFERENCE)T)/CCYMINORCCYUNITS, 0) EMI,
					CASE M.OPENMANDATE WHEN 1 THEN 'New Open ECS' ELSE 'No Open ECS' END OPENMANDATE,
					M.ACCNUMBER,
					CASE WHEN M.ACCTYPE = '10' then 'Savings Account' WHEN M.ACCTYPE = '11' then 'Current Account' WHEN M.ACCTYPE = '11' then 'Cash Credit Account' ELSE M.ACCTYPE END ACCTYPE,
					M.ACCHOLDERNAME,
					BB.MICR,
					BB.IFSC,
					BB.ADDOFBRANCH,
					(select MIN(FIRSTREPAYDATE) from FINPFTDETAILS where FINREFERENCE IN (SELECT FINREFERENCE FROM FINANCEMAIN WHERE MANDATEID=M.MANDATEID)) FIRSTDUEDATE,
					(select MAX(SCHDATE) from FINSCHEDULEDETAILS where (REPAYONSCHDATE = 1 OR PFTONSCHDATE = 1) and FINREFERENCE IN (SELECT FINREFERENCE FROM FINANCEMAIN WHERE MANDATEID=M.MANDATEID)) EMIENDDATE,
					COALESCE (M.MAXLIMIT, 0) MAXLIMIT,
					COALESCE((SELECT SUM(MANDATEDEBITAMOUNT) from (Select MAX(REPAYAMOUNT+FEESCHD) MANDATEDEBITAMOUNT FROM FINSCHEDULEDETAILS WHERE (REPAYONSCHDATE = 1 OR PFTONSCHDATE = 1) AND FINREFERENCE IN (SELECT FINREFERENCE FROM FINANCEMAIN WHERE MANDATEID=M.MANDATEID) GROUP BY FINREFERENCE)T), 0)/CCYMINORCCYUNITS DEBITAMOUNT,
					FIN.NumberOfTerms,
					M.periodicity,
					M.STARTDATE,
					M.EXPIRYDATE,
					FIN.APPLICATIONNO,
					M.MANDATETYPE,
					M.STATUS,
					M.INPUTDATE,
					M.RECORDSTATUS,
					M.RECORDTYPE,
					M.MANDATECCY,
					COALESCE (CCY.CCYMINORCCYUNITS, 100) CCYMINORCCYUNITS,
					M.EntityCode,
					CP.PHONENUMBER,
					CE.CUSTEMAIL,
					PB.PARTNERBANKNAME,
					M.LASTMNTON,
					BB.BranchDesc BANK_BRANCH_NAME,
					PB.BRANCHIFSCCODE,
					PB.UTILITYCODE
					FROM MANDATES M
				INNER JOIN BANKBRANCHES BB ON BB.BANKBRANCHID = M.BANKBRANCHID
				INNER JOIN BMTBANKDETAIL BD ON BD.BANKCODE=BB.BANKCODE
				INNER JOIN CUSTOMERS CUST ON CUST.CUSTID = M.CUSTID
				INNER JOIN RMTBRANCHES CB ON CB.BRANCHCODE = CUST.CUSTDFTBRANCH
				LEFT JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = M.PARTNERBANKID
				LEFT JOIN CUSTOMEREMAILS CE ON CE.CUSTID = CUST.CUSTID AND CE.CUSTEMAILPRIORITY = 5
				LEFT JOIN CUSTOMERPHONENUMBERS CP ON CP.PHONECUSTID = CUST.CUSTID AND CP.PHONETYPEPRIORITY = 5
				LEFT OUTER JOIN RMTCURRENCIES CCY ON CCY.CCYCODE = M.MANDATECCY
				LEFT OUTER JOIN FINANCEMAIN FIN ON M.ORGREFERENCE=FIN.FINREFERENCE
				LEFT JOIN RMTBRANCHES LB ON LB.BRANCHCODE = FIN.FINBRANCH
				LEFT OUTER JOIN RMTFINANCETYPES FT ON FIN.FINTYPE=FT.FINTYPE
				WHERE M.STATUS = 'NEW' AND M.MANDATEID NOT IN (select MANDATEID FROM MANDATE_REQUESTS where (status = 'AC' OR status ='NEW'))
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.4_post" author="Gopal.p" dbms="postgresql">
		<sql>
			select deps_restore_dependencies('plf','int_mandate_request_view');
		</sql>
	</changeSet>

	<changeSet id="ST#1211.5_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.5" author="Gopal.p">
		<createView viewName="financemain_view" replaceIfExists="true">
		<![CDATA[	 
			SELECT t1.finreference,
				    t1.investmentref,
				    t1.numberofterms,
				    t1.grcperiodenddate,
				    t1.allowgrcperiod,
				    t1.gracebaserate,
				    t1.gracespecialrate,
				    t1.grcpftrate,
				    t1.grcpftfrq,
				    t1.nextgrcpftdate,
				    t1.allowgrcpftrvw,
				    t1.grcpftrvwfrq,
				    t1.nextgrcpftrvwdate,
				    t1.allowgrccpz,
				    t1.grccpzfrq,
				    t1.nextgrccpzdate,
				    t1.repaybaserate,
				    t1.repayspecialrate,
				    t1.repayprofitrate,
				    t1.repayfrq,
				    t1.nextrepaydate,
				    t1.repaypftfrq,
				    t1.nextrepaypftdate,
				    t1.allowrepayrvw,
				    t1.repayrvwfrq,
				    t1.nextrepayrvwdate,
				    t1.allowrepaycpz,
				    t1.repaycpzfrq,
				    t1.nextrepaycpzdate,
				    t1.maturitydate,
				    t1.cpzatgraceend,
				    t1.downpayment,
				    t1.graceflatamount,
				    t1.reqrepayamount,
				    t1.totalprofit,
				    t1.totalcpz,
				    t1.totalgrosspft,
				    t1.totalgrossgrcpft,
				    t1.totalgracepft,
				    t1.totalgracecpz,
				    t1.grcratebasis,
				    t1.repayratebasis,
				    t1.fintype,
				    t1.finremarks,
				    t1.finccy,
				    t1.schedulemethod,
				    t1.profitdaysbasis,
				    t1.reqmaturity,
				    t1.calterms,
				    t1.calmaturity,
				    t1.firstrepay,
				    t1.lastrepay,
				    t1.finstartdate,
				    t1.finamount,
				    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
				    t1.finrepaymentamount,
				    t1.custid,
				    t1.defferments,
				    t1.plandefercount,
				    t1.finbranch,
				    t1.finsourceid,
				    t1.alloweddefrpychange,
				    t1.availeddefrpychange,
				    t1.alloweddeffrqchange,
				    t1.availeddeffrqchange,
				    t1.recaltype,
				    t1.finassetvalue,
				    t1.disbaccountid,
				    t1.repayaccountid,
				    t1.finisactive,
				    t1.limitvalid,
				    t1.overridelimit,
				    t1.securitydeposit,
				    t1.version,
				    t1.lastmntby,
				    t1.lastmnton,
				    t1.recordstatus,
				    t1.rolecode,
				    t1.nextrolecode,
				    t1.taskid,
				    t1.nexttaskid,
				    t1.recordtype,
				    t1.workflowid,
				    t7.fintypedesc AS lovdescfintypename,
				    t7.finmaxamount AS lovdescfinmaxamt,
				    t7.finminamount AS lovdescfinminamount,
				    t1.mindownpayperc,
				    t7.finisalwdifferment AS lovdescfinalwdeferment,
				    t7.finisdwpayrequired AS lovdescdwnpayreq,
				    t7.finmaxdifferment AS lovdescfinmaxdifferment,
				    t12.branchdesc AS lovdescfinbranchname,
				    t12.branchprovince AS finbranchprovincecode,
				    t1.lastrepaydate,
				    t1.lastrepaypftdate,
				    t1.lastrepayrvwdate,
				    t1.lastrepaycpzdate,
				    t1.allowgrcrepay,
				    t1.grcschdmthd,
				    t1.grcmargin,
				    t1.repaymargin,
				    t1.fincurrassetvalue,
				    t1.fincommitmentref,
				    t1.finlimitref,
				    t1.depreciationfrq,
				    t1.fincontractdate,
				    t1.nextdepdate,
				    t1.lastdepdate,
				    t1.finaccount,
				    t1.fincustpftaccount,
				    t17.acrtilllbd AS lovdescaccruedtilllbd,
				    t7.finrvwrateapplfor,
				    t1.totalrepayamt,
				    t1.closingstatus,
				    t1.finapproveddate,
				    t1.feechargeamt,
				    t1.blacklisted,
				    t1.finrepaypftonfrq,
				    t1.anualizedpercrate,
				    t1.effectiverateofreturn,
				    t1.migratedfinance,
				    t1.schedulemaintained,
				    t1.scheduleregenerated,
				    t1.finpurpose,
				    t39.loanpurposedesc AS lovdescfinpurposename,
				    t1.finstatus,
				    t1.finstsreason,
				    t1.initiateuser,
				    t1.bankname,
				    t1.iban,
				    t1.accounttype,
				    t1.ddareferenceno,
				    t7.finscheduleon AS lovdescfinscheduleon,
				    t1.custdsr,
				    t1.jointaccount,
				    t1.jointcustid,
				    t1.downpaybank,
				    t1.downpaysupl,
				    t1.downpayaccount,
				    t1.securitycollateral,
				    t1.approved,
				    t1.discrepancy,
				    t1.limitapproved,
				    t1.graceterms,
				    t7.findivision AS lovdescfindivision,
				    t1.rcdmaintainsts,
				    t1.finrepaymethod,
				    t1.grcprofitdaysbasis,
				    t1.stepfinance,
				    t1.steptype,
				    t1.steppolicy,
				    t1.alwmanualsteps,
				    t1.noofsteps,
				    t1.linkedfinref,
				    t1.nextuserid,
				    t1.priority,
				    t24.policydesc AS lovdescsteppolicyname,
				    t1.grcminrate,
				    t1.grcmaxrate,
				    t1.rpyminrate,
				    t1.rpymaxrate,
				    t1.deviationapproval,
				    t1.manualschedule,
				    t1.takeoverfinance,
				    t1.grcadvbaserate,
				    t1.grcadvmargin,
				    t1.grcadvpftrate,
				    t1.rpyadvbaserate,
				    t1.rpyadvmargin,
				    t1.rpyadvpftrate,
				    t1.supplementrent,
				    t1.increasedcost,
				    t1.creditinsamt,
				    t1.rolloverfrq,
				    t1.nextrolloverdate,
				    t27.custstsdescription,
				    t1.shariastatus,
				    t1.initiatedate,
				    t1.finpreapprovedref,
				    t1.mmaid,
				    t1.accountsofficer,
				    t1.feeaccountid,
				    t1.fincancelac,
				    t28.dealername AS lovdescaccountsofficer,
				    t28.dealercity AS lovdescsourcecity,
				    t1.dsacode,
				    t30.rofficerdesc AS dsacodedesc,
				    t1.tdsapplicable,
				    t1.mandateid,
				    t1.droplinefrq,
				    t1.firstdroplinedate,
				    t1.pftservicingodlimit,
				    t1.insuranceamt,
				    t1.deductinsdisb,
				    t1.alwbpi,
				    t1.bpitreatment,
				    t1.planemihalw,
				    t1.planemihmethod,
				    t1.planemihmaxperyear,
				    t1.planemihmax,
				    t1.planemihlockperiod,
				    t1.planemicpz,
				    t1.calroundingmode,
				    t1.alwmultidisb,
				    t1.applicationno,
				    t1.referralid,
				    t33.rofficerdesc AS referraliddesc,
				    t1.dmacode,
				    t34.rofficerdesc AS dmacodedesc,
				    t1.salesdepartment,
				    t35.deptdesc AS salesdepartmentdesc,
				    t1.quickdisb,
				    t1.wifreference,
				    t1.unplanemihlockperiod,
				    t1.unplanemicpz,
				    t1.reagecpz,
				    t1.maxunplannedemi,
				    t1.maxreageholidays,
				    t1.availedunplanemi,
				    t1.availedreageh,
				    t1.bpiamount,
				    t1.deductfeedisb,
				    t1.rvwrateapplfor,
				    t1.schcalonrvw,
				    t1.pastduepftcalmthd,
				    t1.pastduepftmargin,
				    t1.droppingmethod,
				    t1.ratechganyday,
				    t1.promotioncode,
				    t1.restructureloan,
				    t1.oldfinreference,
				    t1.reagebucket,
				    t1.fincategory,
				    t1.productcategory,
				    t1.roundingtarget,
				    t36.entitycode AS lovdescentitycode,
				    t1.eligibilitymethod,
				    t38.fieldcodevalue AS loveligibilitymethod,
				    t38.valuedesc AS lovdesceligibilitymethod,
				    t1.employeename,
				    t37.rofficerdesc AS employeenamedesc,
				    t1.samplingrequired,
				    t1.legalrequired,
				    t1.grcmaxamount,
				    t1.connector,
				    t40.dealername AS connectorcode,
				    t40.dealercity AS connectordesc,
				    t1.advanceemi,
				    t1.advemiterms,
				    t1.bpipftdaysbasis,
				    t1.fixedratetenor,
				    t1.fixedtenorrate,
				    t12.branchtel AS finbranchcontact,
				    t1.processattributes,
				    t1.businessvertical,
				    bv.code AS businessverticalcode,
				    bv.description AS businessverticaldesc,
				    t1.grcadvtype,
				    t1.grcadvterms,
				    t1.advtype,
				    t1.advterms,
				    t1.advstage,
				    t1.tdspercentage,
				    t1.tdsstartdate,
				    t1.tdsenddate,
				    t1.tdslimitamt,
				    t1.vanreq,
				    t1.vancode,
				    t1.allowdrawingpower,
				    t1.allowrevolving,
				    t1.sanbsdschdle,
				    t1.promotionseqid,
				    t1.svamount,
				    t1.cbamount,
				    t1.appliedloanamt,
				    t1.finisratervwatgrcend,
				    t1.reqloanamt,
					t1.reqloantenor,
					t1.finocrrequired,
					t1.offerproduct,
					t1.offeramount,
					t1.custsegmentation,
					t1.baseproduct,
					t1.processtype,
					t1.bureautimeseries,
					t1.campaignname,
					t1.existinglanrefno,
					t1.leadsource,
					t1.posource,
					t1.rsa,
					t1.verification,
					t1.sourcingbranch,
					t1.sourchannelcategory,
					t1.asmname,
					t13.branchdesc AS lovdescsourcingbranch,
					t1.OfferId,
					t1.EndGrcPeriodAftrFullDisb,
					t1.AutoIncGrcEndDate,
					t1.AlwGrcAdj,
					t1.pMay,
					t1.alwLoanSplit,
					t1.ParentRef,
					t1.loanSplitted,
					t1.instbasedschd,
					t1.planEMIHAlwInGrace
				   FROM financemain_temp t1
				     JOIN rmtfinancetypes t7 ON t1.fintype  = t7.fintype 
				     LEFT JOIN rmtbranches t12 ON t1.finbranch  = t12.branchcode
				     LEFT JOIN rmtbranches t13 ON t1.sourcingbranch = t13.branchcode					  
				     LEFT JOIN finpftdetails t17 ON t17.finreference  = t1.finreference 
				     LEFT JOIN steppolicyheader t24 ON t1.steppolicy  = t24.policycode 
				     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus  = t27.custstscode 
				     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
				     LEFT JOIN relationshipofficers t30 ON t1.dsacode  = t30.rofficercode 
				     LEFT JOIN relationshipofficers t33 ON t1.referralid  = t33.rofficercode 
				     LEFT JOIN relationshipofficers t34 ON t1.dmacode  = t34.rofficercode 
				     LEFT JOIN bmtdepartments t35 ON t1.salesdepartment  = t35.deptcode 
				     LEFT JOIN smtdivisiondetail t36 ON t7.findivision  = t36.divisioncode 
				     LEFT JOIN relationshipofficers t37 ON t1.employeename  = t37.rofficercode 
				     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode  = 'ELGMETHOD' 
				     LEFT JOIN loanpurposes t39 ON t1.finpurpose  = t39.loanpurposecode 
				     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
				     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
				UNION ALL
				 SELECT t1.finreference,
				    t1.investmentref,
				    t1.numberofterms,
				    t1.grcperiodenddate,
				    t1.allowgrcperiod,
				    t1.gracebaserate,
				    t1.gracespecialrate,
				    t1.grcpftrate,
				    t1.grcpftfrq,
				    t1.nextgrcpftdate,
				    t1.allowgrcpftrvw,
				    t1.grcpftrvwfrq,
				    t1.nextgrcpftrvwdate,
				    t1.allowgrccpz,
				    t1.grccpzfrq,
				    t1.nextgrccpzdate,
				    t1.repaybaserate,
				    t1.repayspecialrate,
				    t1.repayprofitrate,
				    t1.repayfrq,
				    t1.nextrepaydate,
				    t1.repaypftfrq,
				    t1.nextrepaypftdate,
				    t1.allowrepayrvw,
				    t1.repayrvwfrq,
				    t1.nextrepayrvwdate,
				    t1.allowrepaycpz,
				    t1.repaycpzfrq,
				    t1.nextrepaycpzdate,
				    t1.maturitydate,
				    t1.cpzatgraceend,
				    t1.downpayment,
				    t1.graceflatamount,
				    t1.reqrepayamount,
				    t1.totalprofit,
				    t1.totalcpz,
				    t1.totalgrosspft,
				    t1.totalgrossgrcpft,
				    t1.totalgracepft,
				    t1.totalgracecpz,
				    t1.grcratebasis,
				    t1.repayratebasis,
				    t1.fintype,
				    t1.finremarks,
				    t1.finccy,
				    t1.schedulemethod,
				    t1.profitdaysbasis,
				    t1.reqmaturity,
				    t1.calterms,
				    t1.calmaturity,
				    t1.firstrepay,
				    t1.lastrepay,
				    t1.finstartdate,
				    t1.finamount,
				    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
				    t1.finrepaymentamount,
				    t1.custid,
				    t1.defferments,
				    t1.plandefercount,
				    t1.finbranch,
				    t1.finsourceid,
				    t1.alloweddefrpychange,
				    t1.availeddefrpychange,
				    t1.alloweddeffrqchange,
				    t1.availeddeffrqchange,
				    t1.recaltype,
				    t1.finassetvalue,
				    t1.disbaccountid,
				    t1.repayaccountid,
				    t1.finisactive,
				    t1.limitvalid,
				    t1.overridelimit,
				    t1.securitydeposit,
				    t1.version,
				    t1.lastmntby,
				    t1.lastmnton,
				    t1.recordstatus,
				    t1.rolecode,
				    t1.nextrolecode,
				    t1.taskid,
				    t1.nexttaskid,
				    t1.recordtype,
				    t1.workflowid,
				    t7.fintypedesc AS lovdescfintypename,
				    t7.finmaxamount AS lovdescfinmaxamt,
				    t7.finminamount AS lovdescfinminamount,
				    t1.mindownpayperc,
				    t7.finisalwdifferment AS lovdescfinalwdeferment,
				    t7.finisdwpayrequired AS lovdescdwnpayreq,
				    t7.finmaxdifferment AS lovdescfinmaxdifferment,
				    t12.branchdesc AS lovdescfinbranchname,
				    t12.branchprovince AS finbranchprovincecode,
				    t1.lastrepaydate,
				    t1.lastrepaypftdate,
				    t1.lastrepayrvwdate,
				    t1.lastrepaycpzdate,
				    t1.allowgrcrepay,
				    t1.grcschdmthd,
				    t1.grcmargin,
				    t1.repaymargin,
				    t1.fincurrassetvalue,
				    t1.fincommitmentref,
				    t1.finlimitref,
				    t1.depreciationfrq,
				    t1.fincontractdate,
				    t1.nextdepdate,
				    t1.lastdepdate,
				    t1.finaccount,
				    t1.fincustpftaccount,
				    t17.acrtilllbd AS lovdescaccruedtilllbd,
				    t7.finrvwrateapplfor,
				    t1.totalrepayamt,
				    t1.closingstatus,
				    t1.finapproveddate,
				    t1.feechargeamt,
				    t1.blacklisted,
				    t1.finrepaypftonfrq,
				    t1.anualizedpercrate,
				    t1.effectiverateofreturn,
				    t1.migratedfinance,
				    t1.schedulemaintained,
				    t1.scheduleregenerated,
				    t1.finpurpose,
				    t39.loanpurposedesc AS lovdescfinpurposename,
				    t1.finstatus,
				    t1.finstsreason,
				    t1.initiateuser,
				    t1.bankname,
				    t1.iban,
				    t1.accounttype,
				    t1.ddareferenceno,
				    t7.finscheduleon AS lovdescfinscheduleon,
				    t1.custdsr,
				    t1.jointaccount,
				    t1.jointcustid,
				    t1.downpaybank,
				    t1.downpaysupl,
				    t1.downpayaccount,
				    t1.securitycollateral,
				    t1.approved,
				    t1.discrepancy,
				    t1.limitapproved,
				    t1.graceterms,
				    t7.findivision AS lovdescfindivision,
				    t1.rcdmaintainsts,
				    t1.finrepaymethod,
				    t1.grcprofitdaysbasis,
				    t1.stepfinance,
				    t1.steptype,
				    t1.steppolicy,
				    t1.alwmanualsteps,
				    t1.noofsteps,
				    t1.linkedfinref,
				    t1.nextuserid,
				    t1.priority,
				    t24.policydesc AS lovdescsteppolicyname,
				    t1.grcminrate,
				    t1.grcmaxrate,
				    t1.rpyminrate,
				    t1.rpymaxrate,
				    t1.deviationapproval,
				    t1.manualschedule,
				    t1.takeoverfinance,
				    t1.grcadvbaserate,
				    t1.grcadvmargin,
				    t1.grcadvpftrate,
				    t1.rpyadvbaserate,
				    t1.rpyadvmargin,
				    t1.rpyadvpftrate,
				    t1.supplementrent,
				    t1.increasedcost,
				    t1.creditinsamt,
				    t1.rolloverfrq,
				    t1.nextrolloverdate,
				    t27.custstsdescription,
				    t1.shariastatus,
				    t1.initiatedate,
				    t1.finpreapprovedref,
				    t1.mmaid,
				    t1.accountsofficer,
				    t1.feeaccountid,
				    t1.fincancelac,
				    t28.dealername AS lovdescaccountsofficer,
				    t28.dealercity AS lovdescsourcecity,
				    t1.dsacode,
				    t30.rofficerdesc AS dsacodedesc,
				    t1.tdsapplicable,
				    t1.mandateid,
				    t1.droplinefrq,
				    t1.firstdroplinedate,
				    t1.pftservicingodlimit,
				    t1.insuranceamt,
				    t1.deductinsdisb,
				    t1.alwbpi,
				    t1.bpitreatment,
				    t1.planemihalw,
				    t1.planemihmethod,
				    t1.planemihmaxperyear,
				    t1.planemihmax,
				    t1.planemihlockperiod,
				    t1.planemicpz,
				    t1.calroundingmode,
				    t1.alwmultidisb,
				    t1.applicationno,
				    t1.referralid,
				    t33.rofficerdesc AS referraliddesc,
				    t1.dmacode,
				    t34.rofficerdesc AS dmacodedesc,
				    t1.salesdepartment,
				    t35.deptdesc AS salesdepartmentdesc,
				    t1.quickdisb,
				    t1.wifreference,
				    t1.unplanemihlockperiod,
				    t1.unplanemicpz,
				    t1.reagecpz,
				    t1.maxunplannedemi,
				    t1.maxreageholidays,
				    t1.availedunplanemi,
				    t1.availedreageh,
				    t1.bpiamount,
				    t1.deductfeedisb,
				    t1.rvwrateapplfor,
				    t1.schcalonrvw,
				    t1.pastduepftcalmthd,
				    t1.pastduepftmargin,
				    t1.droppingmethod,
				    t1.ratechganyday,
				    t1.promotioncode,
				    t1.restructureloan,
				    t1.oldfinreference,
				    t1.reagebucket,
				    t1.fincategory,
				    t1.productcategory,
				    t1.roundingtarget,
				    t36.entitycode AS lovdescentitycode,
				    t1.eligibilitymethod,
				    t38.fieldcodevalue AS loveligibilitymethod,
				    t38.valuedesc AS lovdesceligibilitymethod,
				    t1.employeename,
				    t37.rofficerdesc AS employeenamedesc,
				    t1.samplingrequired,
				    t1.legalrequired,
				    t1.grcmaxamount,
				    t1.connector,
				    t40.dealername AS connectorcode,
				    t40.dealercity AS connectordesc,
				    t1.advanceemi,
				    t1.advemiterms,
				    t1.bpipftdaysbasis,
				    t1.fixedratetenor,
				    t1.fixedtenorrate,
				    t12.branchtel AS finbranchcontact,
				    t1.processattributes,
				    t1.businessvertical,
				    bv.code AS businessverticalcode,
				    bv.description AS businessverticaldesc,
				    t1.grcadvtype,
				    t1.grcadvterms,
				    t1.advtype,
				    t1.advterms,
				    t1.advstage,
				    t1.tdspercentage,
				    t1.tdsstartdate,
				    t1.tdsenddate,
				    t1.tdslimitamt,
				    t1.vanreq,
				    t1.vancode,
				    t1.allowdrawingpower,
				    t1.allowrevolving,
				    t1.sanbsdschdle,
				    t1.promotionseqid,
				    t1.svamount,
				    t1.cbamount,
				    t1.appliedloanamt,
				    t1.finisratervwatgrcend,
				    t1.reqloanamt,
					t1.reqloantenor,
					t1.finocrrequired,
					t1.offerproduct,
					t1.offeramount,
					t1.custsegmentation,
					t1.baseproduct,
					t1.processtype,
					t1.bureautimeseries,
					t1.campaignname,
					t1.existinglanrefno,
					t1.leadsource,
					t1.posource,
					t1.rsa,
					t1.verification,
					t1.sourcingbranch,
					t1.sourchannelcategory,
					t1.asmname,
					t13.branchdesc AS lovdescsourcingbranch,
					t1.OfferId,
					t1.EndGrcPeriodAftrFullDisb,
					t1.AutoIncGrcEndDate,
					t1.AlwGrcAdj,
					t1.pMay,
					t1.alwLoanSplit,
					t1.ParentRef,
					t1.loanSplitted,
					t1.instbasedschd,
					t1.planEMIHAlwInGrace
				   FROM financemain t1
				     JOIN rmtfinancetypes t7 ON t1.fintype  = t7.fintype 
				     LEFT JOIN rmtbranches t12 ON t1.finbranch  = t12.branchcode 
				     LEFT JOIN rmtbranches t13 ON t1.sourcingbranch = t13.branchcode
				     LEFT JOIN finpftdetails t17 ON t17.finreference  = t1.finreference 
				     LEFT JOIN steppolicyheader t24 ON t1.steppolicy  = t24.policycode 
				     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus  = t27.custstscode 
				     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
				     LEFT JOIN relationshipofficers t30 ON t1.dsacode  = t30.rofficercode 
				     LEFT JOIN relationshipofficers t33 ON t1.referralid  = t33.rofficercode 
				     LEFT JOIN relationshipofficers t34 ON t1.dmacode  = t34.rofficercode 
				     LEFT JOIN bmtdepartments t35 ON t1.salesdepartment  = t35.deptcode 
				     LEFT JOIN smtdivisiondetail t36 ON t7.findivision  = t36.divisioncode 
				     LEFT JOIN relationshipofficers t37 ON t1.employeename  = t37.rofficercode 
				     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode  = 'ELGMETHOD' 
				     LEFT JOIN loanpurposes t39 ON t1.finpurpose  = t39.loanpurposecode 
				     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
				     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
				     WHERE NOT (EXISTS ( SELECT 1
				           FROM financemain_temp
				          WHERE financemain_temp.finreference  = t1.finreference ))
		  	]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.5_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.6_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_aview'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.6" author="Gopal.p">
		<createView viewName="financemain_aview" replaceIfExists="true">
		<![CDATA[	 
			 SELECT t1.finreference,
			    t1.investmentref,
			    t1.numberofterms,
			    t1.grcperiodenddate,
			    t1.allowgrcperiod,
			    t1.gracebaserate,
			    t1.gracespecialrate,
			    t1.grcpftrate,
			    t1.grcpftfrq,
			    t1.nextgrcpftdate,
			    t1.allowgrcpftrvw,
			    t1.grcpftrvwfrq,
			    t1.nextgrcpftrvwdate,
			    t1.allowgrccpz,
			    t1.grccpzfrq,
			    t1.nextgrccpzdate,
			    t1.repaybaserate,
			    t1.repayspecialrate,
			    t1.repayprofitrate,
			    t1.repayfrq,
			    t1.nextrepaydate,
			    t1.repaypftfrq,
			    t1.nextrepaypftdate,
			    t1.allowrepayrvw,
			    t1.repayrvwfrq,
			    t1.nextrepayrvwdate,
			    t1.allowrepaycpz,
			    t1.repaycpzfrq,
			    t1.nextrepaycpzdate,
			    t1.maturitydate,
			    t1.cpzatgraceend,
			    t1.downpayment,
			    t1.graceflatamount,
			    t1.reqrepayamount,
			    t1.totalprofit,
			    t1.totalcpz,
			    t1.totalgrosspft,
			    t1.totalgrossgrcpft,
			    t1.totalgracepft,
			    t1.totalgracecpz,
			    t1.grcratebasis,
			    t1.repayratebasis,
			    t1.fintype,
			    t1.finremarks,
			    t1.finccy,
			    t1.schedulemethod,
			    t1.profitdaysbasis,
			    t1.reqmaturity,
			    t1.calterms,
			    t1.calmaturity,
			    t1.firstrepay,
			    t1.lastrepay,
			    t1.finstartdate,
			    t1.finamount,
			    t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
			    t1.finrepaymentamount,
			    t1.custid,
			    t1.defferments,
			    t1.plandefercount,
			    t1.finbranch,
			    t1.finsourceid,
			    t1.alloweddefrpychange,
			    t1.availeddefrpychange,
			    t1.alloweddeffrqchange,
			    t1.availeddeffrqchange,
			    t1.recaltype,
			    t1.finassetvalue,
			    t1.disbaccountid,
			    t1.repayaccountid,
			    t1.finisactive,
			    t1.limitvalid,
			    t1.overridelimit,
			    t1.securitydeposit,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t7.fintypedesc AS lovdescfintypename,
			    t7.finmaxamount AS lovdescfinmaxamt,
			    t7.finminamount AS lovdescfinminamount,
			    t1.mindownpayperc,
			    t7.finisalwdifferment AS lovdescfinalwdeferment,
			    t7.finisdwpayrequired AS lovdescdwnpayreq,
			    t7.finmaxdifferment AS lovdescfinmaxdifferment,
			    t12.branchdesc AS lovdescfinbranchname,
			    t12.branchprovince AS finbranchprovincecode,
			    t1.lastrepaydate,
			    t1.lastrepaypftdate,
			    t1.lastrepayrvwdate,
			    t1.lastrepaycpzdate,
			    t1.allowgrcrepay,
			    t1.grcschdmthd,
			    t1.grcmargin,
			    t1.repaymargin,
			    t1.fincurrassetvalue,
			    t1.fincommitmentref,
			    t1.finlimitref,
			    t1.depreciationfrq,
			    t1.fincontractdate,
			    t1.nextdepdate,
			    t1.lastdepdate,
			    t1.finaccount,
			    t1.fincustpftaccount,
			    t17.acrtilllbd AS lovdescaccruedtilllbd,
			    t7.finrvwrateapplfor,
			    t1.totalrepayamt,
			    t1.closingstatus,
			    t1.finapproveddate,
			    t1.feechargeamt,
			    t1.blacklisted,
			    t1.finrepaypftonfrq,
			    t1.anualizedpercrate,
			    t1.effectiverateofreturn,
			    t1.migratedfinance,
			    t1.schedulemaintained,
			    t1.scheduleregenerated,
			    t1.finpurpose,
			    t39.loanpurposedesc AS lovdescfinpurposename,
			    t1.finstatus,
			    t1.finstsreason,
			    t1.initiateuser,
			    t1.bankname,
			    t1.iban,
			    t1.accounttype,
			    t1.ddareferenceno,
			    t7.finscheduleon AS lovdescfinscheduleon,
			    t1.custdsr,
			    t1.jointaccount,
			    t1.jointcustid,
			    t1.downpaybank,
			    t1.downpaysupl,
			    t1.downpayaccount,
			    t1.securitycollateral,
			    t1.approved,
			    t1.discrepancy,
			    t1.limitapproved,
			    t1.graceterms,
			    t7.findivision AS lovdescfindivision,
			    t1.rcdmaintainsts,
			    t1.finrepaymethod,
			    t1.grcprofitdaysbasis,
			    t1.stepfinance,
			    t1.steptype,
			    t1.steppolicy,
			    t1.alwmanualsteps,
			    t1.noofsteps,
			    t1.linkedfinref,
			    t1.nextuserid,
			    t1.priority,
			    t24.policydesc AS lovdescsteppolicyname,
			    t1.grcminrate,
			    t1.grcmaxrate,
			    t1.rpyminrate,
			    t1.rpymaxrate,
			    t1.deviationapproval,
			    t1.manualschedule,
			    t1.takeoverfinance,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.supplementrent,
			    t1.increasedcost,
			    t1.creditinsamt,
			    t1.rolloverfrq,
			    t1.nextrolloverdate,
			    t27.custstsdescription,
			    t1.shariastatus,
			    t1.initiatedate,
			    t1.finpreapprovedref,
			    t1.mmaid,
			    t1.accountsofficer,
			    t1.feeaccountid,
			    t1.fincancelac,
			    t28.dealername AS lovdescaccountsofficer,
			    t28.dealercity AS lovdescsourcecity,
			    t1.dsacode,
			    t30.rofficerdesc AS dsacodedesc,
			    t1.tdsapplicable,
			    t1.mandateid,
			    t1.droplinefrq,
			    t1.firstdroplinedate,
			    t1.pftservicingodlimit,
			    t1.insuranceamt,
			    t1.deductinsdisb,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.calroundingmode,
			    t1.alwmultidisb,
			    t1.applicationno,
			    t1.referralid,
			    t33.rofficerdesc AS referraliddesc,
			    t1.dmacode,
			    t34.rofficerdesc AS dmacodedesc,
			    t1.salesdepartment,
			    t35.deptdesc AS salesdepartmentdesc,
			    t1.quickdisb,
			    t1.wifreference,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.availedunplanemi,
			    t1.availedreageh,
			    t1.bpiamount,
			    t1.deductfeedisb,
			    t1.rvwrateapplfor,
			    t1.schcalonrvw,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t1.promotioncode,
			    t1.restructureloan,
			    t1.oldfinreference,
			    t1.reagebucket,
			    t1.fincategory,
			    t1.productcategory,
			    t1.roundingtarget,
			    t36.entitycode AS lovdescentitycode,
			    t1.eligibilitymethod,
			    t38.fieldcodevalue AS loveligibilitymethod,
			    t38.valuedesc AS lovdesceligibilitymethod,
			    t1.employeename,
			    t37.rofficerdesc AS employeenamedesc,
			    t1.samplingrequired,
			    t1.legalrequired,
			    t1.grcmaxamount,
			    t1.connector,
			    t40.dealername AS connectorcode,
			    t40.dealercity AS connectordesc,
			    t1.advanceemi,
			    t1.advemiterms,
			    t1.bpipftdaysbasis,
			    t1.fixedratetenor,
			    t1.fixedtenorrate,
			    t12.branchtel AS finbranchcontact,
			    t1.processattributes,
			    t1.businessvertical,
			    bv.code AS businessverticalcode,
			    bv.description AS businessverticaldesc,
			    t1.grcadvtype,
			    t1.grcadvterms,
			    t1.advtype,
			    t1.advterms,
			    t1.advstage,
			    t1.tdspercentage,
			    t1.tdsstartdate,
			    t1.tdsenddate,
			    t1.tdslimitamt,
			    t1.vanreq,
			    t1.vancode,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.sanbsdschdle,
			    t1.promotionseqid,
			    t1.svamount,
			    t1.cbamount,
			    t1.appliedloanamt,
			    t1.finisratervwatgrcend,
			    t1.reqloanamt,
				t1.reqloantenor,
				t1.finocrrequired,
				t1.offerproduct,
				t1.offeramount,
				t1.custsegmentation,
				t1.baseproduct,
				t1.processtype,
				t1.bureautimeseries,
				t1.campaignname,
				t1.existinglanrefno,
				t1.leadsource,
				t1.posource,
				t1.rsa,
				t1.verification,
				t1.sourcingbranch,
				t1.sourchannelcategory,
				t1.asmname,
				t13.branchdesc AS lovdescsourcingbranch,
				t1.endgrcperiodaftrfulldisb,
				t1.autoincgrcenddate,
				t1.alwgrcadj,
				t1.pmay,
				t1.offerid,
				t1.alwloansplit,
				t1.parentref,
				t1.loansplitted,
				t1.instbasedschd,
				t1.planEMIHAlwInGrace
			   FROM financemain t1
			     JOIN rmtfinancetypes t7 ON t1.fintype = t7.fintype
			     LEFT JOIN rmtbranches t12 ON t1.finbranch = t12.branchcode
			     LEFT JOIN rmtbranches t13 ON t1.sourcingbranch = t13.branchcode
			     LEFT JOIN finpftdetails t17 ON t17.finreference = t1.finreference
			     LEFT JOIN steppolicyheader t24 ON t1.steppolicy = t24.policycode
			     LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus = t27.custstscode
			     LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
			     LEFT JOIN relationshipofficers t30 ON t1.dsacode = t30.rofficercode
			     LEFT JOIN relationshipofficers t33 ON t1.referralid = t33.rofficercode
			     LEFT JOIN relationshipofficers t34 ON t1.dmacode = t34.rofficercode
			     LEFT JOIN bmtdepartments t35 ON t1.salesdepartment = t35.deptcode
			     LEFT JOIN smtdivisiondetail t36 ON t7.findivision = t36.divisioncode
			     LEFT JOIN relationshipofficers t37 ON t1.employeename = t37.rofficercode
			     LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode = 'ELGMETHOD'
			     LEFT JOIN loanpurposes t39 ON t1.finpurpose = t39.loanpurposecode
			     LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
			     LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
		  	]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.6_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.7_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_tview'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.7" author="Gopal.p">
		<createView viewName="financemain_tview" replaceIfExists="true">
		<![CDATA[	 
			 SELECT t1.finreference,
					t1.investmentref,
					t1.numberofterms,
					t1.grcperiodenddate,
					t1.allowgrcperiod,
					t1.gracebaserate,
					t1.gracespecialrate,
					t1.grcpftrate,
					t1.grcpftfrq,
					t1.nextgrcpftdate,
					t1.allowgrcpftrvw,
					t1.grcpftrvwfrq,
					t1.nextgrcpftrvwdate,
					t1.allowgrccpz,
					t1.grccpzfrq,
					t1.nextgrccpzdate,
					t1.repaybaserate,
					t1.repayspecialrate,
					t1.repayprofitrate,
					t1.repayfrq,
					t1.nextrepaydate,
					t1.repaypftfrq,
					t1.nextrepaypftdate,
					t1.allowrepayrvw,
					t1.repayrvwfrq,
					t1.nextrepayrvwdate,
					t1.allowrepaycpz,
					t1.repaycpzfrq,
					t1.nextrepaycpzdate,
					t1.maturitydate,
					t1.cpzatgraceend,
					t1.downpayment,
					t1.graceflatamount,
					t1.reqrepayamount,
					t1.totalprofit,
					t1.totalcpz,
					t1.totalgrosspft,
					t1.totalgrossgrcpft,
					t1.totalgracepft,
					t1.totalgracecpz,
					t1.grcratebasis,
					t1.repayratebasis,
					t1.fintype,
					t1.finremarks,
					t1.finccy,
					t1.schedulemethod,
					t1.profitdaysbasis,
					t1.reqmaturity,
					t1.calterms,
					t1.calmaturity,
					t1.firstrepay,
					t1.lastrepay,
					t1.finstartdate,
					t1.finamount,
					t1.finamount + t1.feechargeamt - t1.downpayment AS lovdescfinancingamount,
					t1.finrepaymentamount,
					t1.custid,
					t1.defferments,
					t1.plandefercount,
					t1.finbranch,
					t1.finsourceid,
					t1.alloweddefrpychange,
					t1.availeddefrpychange,
					t1.alloweddeffrqchange,
					t1.availeddeffrqchange,
					t1.recaltype,
					t1.finassetvalue,
					t1.disbaccountid,
					t1.repayaccountid,
					t1.finisactive,
					t1.limitvalid,
					t1.overridelimit,
					t1.securitydeposit,
					t1.version,
					t1.lastmntby,
					t1.lastmnton,
					t1.recordstatus,
					t1.rolecode,
					t1.nextrolecode,
					t1.taskid,
					t1.nexttaskid,
					t1.recordtype,
					t1.workflowid,
					t7.fintypedesc AS lovdescfintypename,
					t7.finmaxamount AS lovdescfinmaxamt,
					t7.finminamount AS lovdescfinminamount,
					t1.mindownpayperc,
					t7.finisalwdifferment AS lovdescfinalwdeferment,
					t7.finisdwpayrequired AS lovdescdwnpayreq,
					t7.finmaxdifferment AS lovdescfinmaxdifferment,
					t12.branchdesc AS lovdescfinbranchname,
					t12.branchprovince AS finbranchprovincecode,
					t1.lastrepaydate,
					t1.lastrepaypftdate,
					t1.lastrepayrvwdate,
					t1.lastrepaycpzdate,
					t1.allowgrcrepay,
					t1.grcschdmthd,
					t1.grcmargin,
					t1.repaymargin,
					t1.fincurrassetvalue,
					t1.fincommitmentref,
					t1.finlimitref,
					t1.depreciationfrq,
					t1.fincontractdate,
					t1.nextdepdate,
					t1.lastdepdate,
					t1.finaccount,
					t1.fincustpftaccount,
					t17.acrtilllbd AS lovdescaccruedtilllbd,
					t7.finrvwrateapplfor,
					t1.totalrepayamt,
					t1.closingstatus,
					t1.finapproveddate,
					t1.feechargeamt,
					t1.blacklisted,
					t1.finrepaypftonfrq,
					t1.anualizedpercrate,
					t1.effectiverateofreturn,
					t1.migratedfinance,
					t1.schedulemaintained,
					t1.scheduleregenerated,
					t1.finpurpose,
					t39.loanpurposedesc AS lovdescfinpurposename,
					t1.finstatus,
					t1.finstsreason,
					t1.initiateuser,
					t1.bankname,
					t1.iban,
					t1.accounttype,
					t1.ddareferenceno,
					t7.finscheduleon AS lovdescfinscheduleon,
					t1.custdsr,
					t1.jointaccount,
					t1.jointcustid,
					t1.downpaybank,
					t1.downpaysupl,
					t1.downpayaccount,
					t1.securitycollateral,
					t1.approved,
					t1.discrepancy,
					t1.limitapproved,
					t1.graceterms,
					t7.findivision AS lovdescfindivision,
					t1.rcdmaintainsts,
					t1.finrepaymethod,
					t1.grcprofitdaysbasis,
					t1.stepfinance,
					t1.steptype,
					t1.steppolicy,
					t1.alwmanualsteps,
					t1.noofsteps,
					t1.linkedfinref,
					t1.nextuserid,
					t1.priority,
					t24.policydesc AS lovdescsteppolicyname,
					t1.grcminrate,
					t1.grcmaxrate,
					t1.rpyminrate,
					t1.rpymaxrate,
					t1.deviationapproval,
					t1.manualschedule,
					t1.takeoverfinance,
					t1.grcadvbaserate,
					t1.grcadvmargin,
					t1.grcadvpftrate,
					t1.rpyadvbaserate,
					t1.rpyadvmargin,
					t1.rpyadvpftrate,
					t1.supplementrent,
					t1.increasedcost,
					t1.creditinsamt,
					t1.rolloverfrq,
					t1.nextrolloverdate,
					t27.custstsdescription,
					t1.shariastatus,
					t1.initiatedate,
					t1.finpreapprovedref,
					t1.mmaid,
					t1.accountsofficer,
					t1.feeaccountid,
					t1.fincancelac,
					t28.dealername AS lovdescaccountsofficer,
					t28.dealercity AS lovdescsourcecity,
					t1.dsacode,
					t30.rofficerdesc AS dsacodedesc,
					t1.tdsapplicable,
					t1.mandateid,
					t1.droplinefrq,
					t1.firstdroplinedate,
					t1.pftservicingodlimit,
					t1.insuranceamt,
					t1.deductinsdisb,
					t1.alwbpi,
					t1.bpitreatment,
					t1.planemihalw,
					t1.planemihmethod,
					t1.planemihmaxperyear,
					t1.planemihmax,
					t1.planemihlockperiod,
					t1.planemicpz,
					t1.calroundingmode,
					t1.alwmultidisb,
					t1.applicationno,
					t1.referralid,
					t33.rofficerdesc AS referraliddesc,
					t1.dmacode,
					t34.rofficerdesc AS dmacodedesc,
					t1.salesdepartment,
					t35.deptdesc AS salesdepartmentdesc,
					t1.quickdisb,
					t1.wifreference,
					t1.unplanemihlockperiod,
					t1.unplanemicpz,
					t1.reagecpz,
					t1.maxunplannedemi,
					t1.maxreageholidays,
					t1.availedunplanemi,
					t1.availedreageh,
					t1.bpiamount,
					t1.deductfeedisb,
					t1.rvwrateapplfor,
					t1.schcalonrvw,
					t1.pastduepftcalmthd,
					t1.pastduepftmargin,
					t1.droppingmethod,
					t1.ratechganyday,
					t1.promotioncode,
					t1.restructureloan,
					t1.oldfinreference,
					t1.reagebucket,
					t1.fincategory,
					t1.productcategory,
					t1.roundingtarget,
					t36.entitycode AS lovdescentitycode,
					t1.eligibilitymethod,
					t38.fieldcodevalue AS loveligibilitymethod,
					t38.valuedesc AS lovdesceligibilitymethod,
					t1.employeename,
					t37.rofficerdesc AS employeenamedesc,
					t1.samplingrequired,
					t1.legalrequired,
					t1.grcmaxamount,
					t1.connector,
					t40.dealername AS connectorcode,
					t40.dealercity AS connectordesc,
					t1.advanceemi,
					t1.advemiterms,
					t1.bpipftdaysbasis,
					t1.fixedratetenor,
					t1.fixedtenorrate,
					t12.branchtel AS finbranchcontact,
					t1.processattributes,
					t1.businessvertical,
					bv.code AS businessverticalcode,
					bv.description AS businessverticaldesc,
					t1.grcadvtype,
					t1.grcadvterms,
					t1.advtype,
					t1.advterms,
					t1.advstage,
					t1.tdspercentage,
					t1.tdsstartdate,
					t1.tdsenddate,
					t1.tdslimitamt,
					t1.vanreq,
					t1.vancode,
					t1.allowdrawingpower,
					t1.allowrevolving,
					t1.sanbsdschdle,
					t1.promotionseqid,
					t1.svamount,
					t1.cbamount,
					t1.appliedloanamt,
					t1.finisratervwatgrcend,
					t1.reqloanamt,
					t1.reqloantenor,
					t1.finocrrequired,
					t1.offerproduct,
					t1.offeramount,
					t1.custsegmentation,
					t1.baseproduct,
					t1.processtype,
					t1.bureautimeseries,
					t1.campaignname,
					t1.existinglanrefno,
					t1.leadsource,
					t1.posource,
					t1.rsa,
					t1.verification,
					t1.sourcingbranch,
					t1.sourchannelcategory,
					t1.asmname,
					t13.branchdesc AS lovdescsourcingbranch,
					t1.offerid,
					t1.endgrcperiodaftrfulldisb,
					t1.autoincgrcenddate,
					t1.alwgrcadj,
					t1.pmay,
					t1.alwloansplit,
					t1.parentref,
					t1.loansplitted,
					t1.instbasedschd,
					t1.planEMIHAlwInGrace
				   FROM financemain_temp t1
					 JOIN rmtfinancetypes t7 ON t1.fintype  = t7.fintype 
					 LEFT JOIN rmtbranches t12 ON t1.finbranch  = t12.branchcode 
					 LEFT JOIN rmtbranches t13 ON t1.sourcingbranch = t13.branchcode
					 LEFT JOIN finpftdetails t17 ON t17.finreference  = t1.finreference 
					 LEFT JOIN steppolicyheader t24 ON t1.steppolicy  = t24.policycode 
					 LEFT JOIN bmtcuststatuscodes t27 ON t1.finstatus  = t27.custstscode 
					 LEFT JOIN amtvehicledealer t28 ON t1.accountsofficer = t28.dealerid
					 LEFT JOIN relationshipofficers t30 ON t1.dsacode  = t30.rofficercode 
					 LEFT JOIN relationshipofficers t33 ON t1.referralid  = t33.rofficercode 
					 LEFT JOIN relationshipofficers t34 ON t1.dmacode  = t34.rofficercode 
					 LEFT JOIN bmtdepartments t35 ON t1.salesdepartment  = t35.deptcode 
					 LEFT JOIN smtdivisiondetail t36 ON t7.findivision  = t36.divisioncode 
					 LEFT JOIN relationshipofficers t37 ON t1.employeename  = t37.rofficercode 
					 LEFT JOIN rmtlovfielddetail t38 ON t1.eligibilitymethod = t38.fieldcodeid AND t38.fieldcode  = 'ELGMETHOD' 
					 LEFT JOIN loanpurposes t39 ON t1.finpurpose  = t39.loanpurposecode 
					 LEFT JOIN amtvehicledealer t40 ON t1.connector = t40.dealerid
					 LEFT JOIN business_vertical bv ON bv.id = t1.businessvertical
		  	]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.7_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_tview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.8_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_lview'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.8" author="Gopal.p">
		<createView viewName="FinanceMain_LView" replaceIfExists="true">
			<![CDATA[
		 		SELECT T1.FINREFERENCE,
					T1.INVESTMENTREF,
					T1.FINTYPE,
					T1.FINCCY,
					T1.FINAMOUNT,
					T1.DOWNPAYMENT,
					T1.FEECHARGEAMT,
					T1.SCHEDULEMETHOD,
					T1.NUMBEROFTERMS,
					T1.RECORDSTATUS,
					T1.RECORDTYPE,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.FINBRANCH,
					T1.FINCONTRACTDATE,
					T1.LINKEDFINREF,
					T1.NEXTUSERID,
					T1.PRIORITY,
					T1.WORKFLOWID,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.FINPREAPPROVEDREF,
					T1.RCDMAINTAINSTS,
					T1.INSURANCEAMT,
					T1.FINCURRASSETVALUE,
					T1.CALTERMS,
					T1.DEVIATIONAPPROVAL,
					T1.FINPURPOSE,
					T1.INITIATEDATE,
					T1.FINASSETVALUE,
					T2.CUSTCIF LOVDESCCUSTCIF,
					T2.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
					T2.CUSTPASSPORTNO LOVDESCCUSTPASSPORTNO,
					T2.CUSTDOB LOVDESCCUSTDOB,
					T2.CUSTCRCPR LOVDESCCUSTCRCPR,
					T2.PHONENUMBER,
					T3.FINCATEGORY LOVDESCPRODUCTCODENAME,
					T3.FINDIVISION LOVDESCFINDIVISION,
					T3.PRODUCT LOVDESCFINPRODUCT,
					T3.FINTYPEDESC LOVDESCFINTYPENAME,
					COALESCE(T4.ROLEDESC, ${add.schema}FN_GET_ROLEDESC(T1.NEXTROLECODE)) LOVDESCREQUESTSTAGE,
					T1.SAMPLINGREQUIRED,
					T1.ADVANCEEMI,
					T1.ADVEMITERMS,
					T1.BPIPFTDAYSBASIS,
					T1.GRACETERMS,
					T1.PRODUCTCATEGORY,
					T1.REQLOANAMT,
					T1.REQLOANTENOR,
					T1.FINOCRREQUIRED,
					T1.OFFERPRODUCT,
					T1.OFFERAMOUNT,
					T1.CUSTSEGMENTATION,
					T1.BASEPRODUCT,
					T1.PROCESSTYPE,
					T1.BUREAUTIMESERIES,
					T1.CAMPAIGNNAME,
					T1.EXISTINGLANREFNO,
					T1.LEADSOURCE,
					T1.POSOURCE,
					T1.RSA,
					T1.VERIFICATION,
					T1.SOURCINGBRANCH,
					T1.SOURCHANNELCATEGORY,
					T1.ASMNAME,
					T1.OFFERID,
					T1.APPLICATIONNO,
					T1.LASTMNTON,
					T2.CUSTID,
					T1.INSTBASEDSCHD,
					T1.VERSION
					FROM FINANCEMAIN_TEMP T1
					INNER JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
					INNER JOIN RMTFINANCETYPES T3 ON T3.FINTYPE = T1.FINTYPE
					LEFT JOIN SECROLES T4 ON T1.NEXTROLECODE= T4.ROLECD
				  ]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.8_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_lview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.9_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemaintenance_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.9" author="Gopal.p">
		<createView replaceIfExists="true" viewName="FINANCEMAINTENANCE_VIEW">
				<![CDATA[
					 SELECT T1.FINREFERENCE,
						T1.FINBRANCH,
						T1.FINTYPE,
						T1.FINCCY,
						T1.SCHEDULEMETHOD,
						T1.PROFITDAYSBASIS,
						T1.FINSTARTDATE,
						T1.NUMBEROFTERMS,
						T1.CUSTID,
						T1.FINAMOUNT,
						T1.MATURITYDATE,
						T1.FINREPAYMENTAMOUNT,
						T1.FINISACTIVE,
						T1.BLACKLISTED,
						T1.FEECHARGEAMT,
						T1.INSURANCEAMT,
						T1.GRACETERMS,
						T1.ALLOWGRCPERIOD,
						T1.GRCPERIODENDDATE,
						T1.ALWMULTIDISB,
						T1.DEFFERMENTS,
						T1.NEXTROLECODE,
						T1.RECORDSTATUS,
						T1.RECORDTYPE,
						T1.ALLOWGRCPFTRVW,
						T1.ALLOWREPAYRVW,
						T1.LASTREPAYDATE,
						T1.LASTREPAYPFTDATE,
						T1.ALLOWEDDEFRPYCHANGE,
						T1.AVAILEDDEFRPYCHANGE,
						T1.RCDMAINTAINSTS,
						T1.MIGRATEDFINANCE,
						T1.CLOSINGSTATUS,
						T1.REPAYRATEBASIS,
						T1.MANUALSCHEDULE,
						T1.FINCURRASSETVALUE,
						T1.TAKEOVERFINANCE,
						T1.NEXTROLLOVERDATE,
						T1.AVAILEDUNPLANEMI,
						T1.AVAILEDREAGEH,
						T1.MAXUNPLANNEDEMI,
						T1.MAXREAGEHOLIDAYS,
						T1.DOWNPAYMENT,
						T1.PLANEMIHALW,
						T1.CALTERMS,
						T1.RATECHGANYDAY,
						T1.FINASSETVALUE,
						T2.CUSTCIF LOVDESCCUSTCIF,
						T2.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
						T3.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
						T3.FINDIVISION LOVDESCFINDIVISION,
						T3.FINCATEGORY LOVDESCPRODUCTCODENAME,
						T4.PRODUCTCATEGORY,
						COALESCE(T5.ROLEDESC,  ${ADD.SCHEMA}FN_GET_ROLEDESC(T1.NEXTROLECODE)) LOVDESCREQUESTSTAGE,
						COALESCE(T9.NOINST, 0) NOINST,
						T1.SAMPLINGREQUIRED,
						T1.ADVEMITERMS,
						T1.SANBSDSCHDLE,
						T1.PROMOTIONSEQID,
						T1.SVAMOUNT,
						T1.CBAMOUNT,
						T1.REPAYPFTFRQ,
						T1.VERSION
						FROM FINANCEMAIN_TEMP T1
						JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
						JOIN RMTFINANCETYPES T3 ON T1.FINTYPE = T3.FINTYPE
						LEFT JOIN SECROLES T5 ON T1.NEXTROLECODE = T5.ROLECD
						JOIN BMTPRODUCT T4 ON T3.FINCATEGORY = T4.PRODUCTCODE
						LEFT JOIN FINPFTDETAILS T9 ON T1.FINREFERENCE = T9.FINREFERENCE
						UNION ALL
						SELECT T1.FINREFERENCE,
						T1.FINBRANCH,
						T1.FINTYPE,
						T1.FINCCY,
						T1.SCHEDULEMETHOD,
						T1.PROFITDAYSBASIS,
						T1.FINSTARTDATE,
						T1.NUMBEROFTERMS,
						T1.CUSTID,
						T1.FINAMOUNT,
						T1.MATURITYDATE,
						T1.FINREPAYMENTAMOUNT,
						T1.FINISACTIVE,
						T1.BLACKLISTED,
						T1.FEECHARGEAMT,
						T1.INSURANCEAMT,
						T1.GRACETERMS,
						T1.ALLOWGRCPERIOD,
						T1.GRCPERIODENDDATE,
						T1.ALWMULTIDISB,
						T1.DEFFERMENTS,
						T1.NEXTROLECODE,
						T1.RECORDSTATUS,
						T1.RECORDTYPE,
						T1.ALLOWGRCPFTRVW,
						T1.ALLOWREPAYRVW,
						T1.LASTREPAYDATE,
						T1.LASTREPAYPFTDATE,
						T1.ALLOWEDDEFRPYCHANGE,
						T1.AVAILEDDEFRPYCHANGE,
						T1.RCDMAINTAINSTS,
						T1.MIGRATEDFINANCE,
						T1.CLOSINGSTATUS,
						T1.REPAYRATEBASIS,
						T1.MANUALSCHEDULE,
						T1.FINCURRASSETVALUE,
						T1.TAKEOVERFINANCE,
						T1.NEXTROLLOVERDATE,
						T1.AVAILEDUNPLANEMI,
						T1.AVAILEDREAGEH,
						T1.MAXUNPLANNEDEMI,
						T1.MAXREAGEHOLIDAYS,
						T1.DOWNPAYMENT,
						T1.PLANEMIHALW,
						T1.CALTERMS,
						T1.RATECHGANYDAY,
						T1.FINASSETVALUE,
						T2.CUSTCIF LOVDESCCUSTCIF,
						T2.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
						T3.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
						T3.FINDIVISION LOVDESCFINDIVISION,
						T3.FINCATEGORY LOVDESCPRODUCTCODENAME,
						T4.PRODUCTCATEGORY,
						COALESCE(T5.ROLEDESC,  ${ADD.SCHEMA}FN_GET_ROLEDESC(T1.NEXTROLECODE)) LOVDESCREQUESTSTAGE,
						COALESCE(T9.NOINST, 0) NOINST,
						T1.SAMPLINGREQUIRED,
						T1.ADVEMITERMS,
						T1.SANBSDSCHDLE,
						T1.PROMOTIONSEQID,
						T1.SVAMOUNT,
						T1.CBAMOUNT,
						T1.REPAYPFTFRQ,
						T1.VERSION
						FROM FINANCEMAIN T1
						JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
						JOIN RMTFINANCETYPES T3 ON T1.FINTYPE = T3.FINTYPE
						LEFT JOIN SECROLES T5 ON T1.NEXTROLECODE = T5.ROLECD
						JOIN BMTPRODUCT T4 ON T3.FINCATEGORY = T4.PRODUCTCODE
						LEFT JOIN FINPFTDETAILS T9 ON T1.FINREFERENCE = T9.FINREFERENCE
						WHERE NOT (EXISTS ( SELECT 1 EXPR1
						FROM FINANCEMAIN_TEMP
						WHERE FINANCEMAIN_TEMP.FINREFERENCE = T1.FINREFERENCE))
				  ]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.9_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemaintenance_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.10_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'financemain_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.10" author="Gopal.p">
		<createView viewName="financemain_view" replaceIfExists="true">
		<![CDATA[	 
			 SELECT T1.FINREFERENCE,
				T1.INVESTMENTREF,
				T1.NUMBEROFTERMS,
				T1.GRCPERIODENDDATE,
				T1.ALLOWGRCPERIOD,
				T1.GRACEBASERATE,
				T1.GRACESPECIALRATE,
				T1.GRCPFTRATE,
				T1.GRCPFTFRQ,
				T1.NEXTGRCPFTDATE,
				T1.ALLOWGRCPFTRVW,
				T1.GRCPFTRVWFRQ,
				T1.NEXTGRCPFTRVWDATE,
				T1.ALLOWGRCCPZ,
				T1.GRCCPZFRQ,
				T1.NEXTGRCCPZDATE,
				T1.REPAYBASERATE,
				T1.REPAYSPECIALRATE,
				T1.REPAYPROFITRATE,
				T1.REPAYFRQ,
				T1.NEXTREPAYDATE,
				T1.REPAYPFTFRQ,
				T1.NEXTREPAYPFTDATE,
				T1.ALLOWREPAYRVW,
				T1.REPAYRVWFRQ,
				T1.NEXTREPAYRVWDATE,
				T1.ALLOWREPAYCPZ,
				T1.REPAYCPZFRQ,
				T1.NEXTREPAYCPZDATE,
				T1.MATURITYDATE,
				T1.CPZATGRACEEND,
				T1.DOWNPAYMENT,
				T1.GRACEFLATAMOUNT,
				T1.REQREPAYAMOUNT,
				T1.TOTALPROFIT,
				T1.TOTALCPZ,
				T1.TOTALGROSSPFT,
				T1.TOTALGROSSGRCPFT,
				T1.TOTALGRACEPFT,
				T1.TOTALGRACECPZ,
				T1.GRCRATEBASIS,
				T1.REPAYRATEBASIS,
				T1.FINTYPE,
				T1.FINREMARKS,
				T1.FINCCY,
				T1.SCHEDULEMETHOD,
				T1.PROFITDAYSBASIS,
				T1.REQMATURITY,
				T1.CALTERMS,
				T1.CALMATURITY,
				T1.FIRSTREPAY,
				T1.LASTREPAY,
				T1.FINSTARTDATE,
				T1.FINAMOUNT,
				((T1.FINAMOUNT + T1.FEECHARGEAMT) - T1.DOWNPAYMENT) LOVDESCFINANCINGAMOUNT,
				T1.FINREPAYMENTAMOUNT,
				T1.CUSTID,
				T1.DEFFERMENTS,
				T1.PLANDEFERCOUNT,
				T1.FINBRANCH,
				T1.FINSOURCEID,
				T1.ALLOWEDDEFRPYCHANGE,
				T1.AVAILEDDEFRPYCHANGE,
				T1.ALLOWEDDEFFRQCHANGE,
				T1.AVAILEDDEFFRQCHANGE,
				T1.RECALTYPE,
				T1.FINASSETVALUE,
				T1.DISBACCOUNTID,
				T1.REPAYACCOUNTID,
				T1.FINISACTIVE,
				T1.LIMITVALID,
				T1.OVERRIDELIMIT,
				T1.SECURITYDEPOSIT,
				T1.VERSION,
				T1.LASTMNTBY,
				T1.LASTMNTON,
				T1.RECORDSTATUS,
				T1.ROLECODE,
				T1.NEXTROLECODE,
				T1.TASKID,
				T1.NEXTTASKID,
				T1.RECORDTYPE,
				T1.WORKFLOWID,
				T7.FINTYPEDESC  LOVDESCFINTYPENAME,
				T7.FINMAXAMOUNT  LOVDESCFINMAXAMT,
				T7.FINMINAMOUNT  LOVDESCFINMINAMOUNT,
				T1.MINDOWNPAYPERC,
				T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
				T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
				T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
				T12.BRANCHDESC  LOVDESCFINBRANCHNAME,
				T12.BRANCHPROVINCE  FINBRANCHPROVINCECODE,
				T1.LASTREPAYDATE,
				T1.LASTREPAYPFTDATE,
				T1.LASTREPAYRVWDATE,
				T1.LASTREPAYCPZDATE,
				T1.ALLOWGRCREPAY,
				T1.GRCSCHDMTHD,
				T1.GRCMARGIN,
				T1.REPAYMARGIN,
				T1.FINCURRASSETVALUE,
				T1.FINCOMMITMENTREF,
				T1.FINLIMITREF,
				T1.DEPRECIATIONFRQ,
				T1.FINCONTRACTDATE,
				T1.NEXTDEPDATE,
				T1.LASTDEPDATE,
				T1.FINACCOUNT,
				T1.FINCUSTPFTACCOUNT,
				T17.ACRTILLLBD  LOVDESCACCRUEDTILLLBD,
				T7.FINRVWRATEAPPLFOR,
				T1.TOTALREPAYAMT,
				T1.CLOSINGSTATUS,
				T1.FINAPPROVEDDATE,
				T1.FEECHARGEAMT,
				T1.BLACKLISTED,
				T1.FINREPAYPFTONFRQ,
				T1.ANUALIZEDPERCRATE,
				T1.EFFECTIVERATEOFRETURN,
				T1.MIGRATEDFINANCE,
				T1.SCHEDULEMAINTAINED,
				T1.SCHEDULEREGENERATED,
				T1.FINPURPOSE,
				T39.LOANPURPOSEDESC  LOVDESCFINPURPOSENAME,
				T1.FINSTATUS,
				T1.FINSTSREASON,
				T1.INITIATEUSER,
				T1.BANKNAME,
				T1.IBAN,
				T1.ACCOUNTTYPE,
				T1.DDAREFERENCENO,
				T7.FINSCHEDULEON  LOVDESCFINSCHEDULEON,
				T1.CUSTDSR,
				T1.JOINTACCOUNT,
				T1.JOINTCUSTID,
				T1.DOWNPAYBANK,
				T1.DOWNPAYSUPL,
				T1.DOWNPAYACCOUNT,
				T1.SECURITYCOLLATERAL,
				T1.APPROVED,
				T1.DISCREPANCY,
				T1.LIMITAPPROVED,
				T1.GRACETERMS,
				T7.FINDIVISION  LOVDESCFINDIVISION,
				T1.RCDMAINTAINSTS,
				T1.FINREPAYMETHOD,
				T1.GRCPROFITDAYSBASIS,
				T1.STEPFINANCE,
				T1.STEPTYPE,
				T1.STEPPOLICY,
				T1.ALWMANUALSTEPS,
				T1.NOOFSTEPS,
				T1.LINKEDFINREF,
				T1.NEXTUSERID,
				T1.PRIORITY,
				T24.POLICYDESC  LOVDESCSTEPPOLICYNAME,
				T1.GRCMINRATE,
				T1.GRCMAXRATE,
				T1.RPYMINRATE,
				T1.RPYMAXRATE,
				T1.DEVIATIONAPPROVAL,
				T1.MANUALSCHEDULE,
				T1.TAKEOVERFINANCE,
				T1.GRCADVBASERATE,
				T1.GRCADVMARGIN,
				T1.GRCADVPFTRATE,
				T1.RPYADVBASERATE,
				T1.RPYADVMARGIN,
				T1.RPYADVPFTRATE,
				T1.SUPPLEMENTRENT,
				T1.INCREASEDCOST,
				T1.CREDITINSAMT,
				T1.ROLLOVERFRQ,
				T1.NEXTROLLOVERDATE,
				T27.CUSTSTSDESCRIPTION,
				T1.SHARIASTATUS,
				T1.INITIATEDATE,
				T1.FINPREAPPROVEDREF,
				T1.MMAID,
				T1.ACCOUNTSOFFICER,
				T1.FEEACCOUNTID,
				T1.FINCANCELAC,
				T28.DEALERNAME  LOVDESCACCOUNTSOFFICER,
				T28.DEALERCITY  LOVDESCSOURCECITY,
				T1.DSACODE,
				T30.ROFFICERDESC  DSACODEDESC,
				T1.TDSAPPLICABLE,
				T1.MANDATEID,
				T1.DROPLINEFRQ,
				T1.FIRSTDROPLINEDATE,
				T1.PFTSERVICINGODLIMIT,
				T1.INSURANCEAMT,
				T1.DEDUCTINSDISB,
				T1.ALWBPI,
				T1.BPITREATMENT,
				T1.PLANEMIHALW,
				T1.PLANEMIHMETHOD,
				T1.PLANEMIHMAXPERYEAR,
				T1.PLANEMIHMAX,
				T1.PLANEMIHLOCKPERIOD,
				T1.PLANEMICPZ,
				T1.CALROUNDINGMODE,
				T1.ALWMULTIDISB,
				T1.APPLICATIONNO,
				T1.REFERRALID,
				T33.ROFFICERDESC  REFERRALIDDESC,
				T1.DMACODE,
				T34.ROFFICERDESC  DMACODEDESC,
				T1.SALESDEPARTMENT,
				T35.DEPTDESC  SALESDEPARTMENTDESC,
				T1.QUICKDISB,
				T1.WIFREFERENCE,
				T1.UNPLANEMIHLOCKPERIOD,
				T1.UNPLANEMICPZ,
				T1.REAGECPZ,
				T1.MAXUNPLANNEDEMI,
				T1.MAXREAGEHOLIDAYS,
				T1.AVAILEDUNPLANEMI,
				T1.AVAILEDREAGEH,
				T1.BPIAMOUNT,
				T1.DEDUCTFEEDISB,
				T1.RVWRATEAPPLFOR,
				T1.SCHCALONRVW,
				T1.PASTDUEPFTCALMTHD,
				T1.PASTDUEPFTMARGIN,
				T1.DROPPINGMETHOD,
				T1.RATECHGANYDAY,
				T1.PROMOTIONCODE,
				T1.RESTRUCTURELOAN,
				T1.OLDFINREFERENCE,
				T1.REAGEBUCKET,
				T1.FINCATEGORY,
				T1.PRODUCTCATEGORY,
				T1.ROUNDINGTARGET,
				T36.ENTITYCODE  LOVDESCENTITYCODE,
				T1.ELIGIBILITYMETHOD,
				T38.FIELDCODEVALUE  LOVELIGIBILITYMETHOD,
				T38.VALUEDESC  LOVDESCELIGIBILITYMETHOD,
				T1.EMPLOYEENAME,
				T37.ROFFICERDESC  EMPLOYEENAMEDESC,
				T1.SAMPLINGREQUIRED,
				T1.LEGALREQUIRED,
				T1.GRCMAXAMOUNT,
				T1.CONNECTOR,
				T40.DEALERNAME  CONNECTORCODE,
				T40.DEALERCITY  CONNECTORDESC,
				T1.ADVANCEEMI,
				T1.ADVEMITERMS,
				T1.BPIPFTDAYSBASIS,
				T1.FIXEDRATETENOR,
				T1.FIXEDTENORRATE,
				T12.BRANCHTEL  FINBRANCHCONTACT,
				T1.PROCESSATTRIBUTES,
				T1.BUSINESSVERTICAL,
				BV.CODE  BUSINESSVERTICALCODE,
				BV.DESCRIPTION  BUSINESSVERTICALDESC,
				T1.GRCADVTYPE,
				T1.GRCADVTERMS,
				T1.ADVTYPE,
				T1.ADVTERMS,
				T1.ADVSTAGE,
				T1.TDSPERCENTAGE,
				T1.TDSSTARTDATE,
				T1.TDSENDDATE,
				T1.TDSLIMITAMT,
				T1.VANREQ,
				T1.VANCODE,
				T1.ALLOWDRAWINGPOWER,
				T1.ALLOWREVOLVING,
				T1.SANBSDSCHDLE,
				T1.PROMOTIONSEQID,
				T1.SVAMOUNT,
				T1.CBAMOUNT,
				T1.APPLIEDLOANAMT,
				T1.FINISRATERVWATGRCEND,
				T1.REQLOANAMT,
				T1.REQLOANTENOR,
				T1.FINOCRREQUIRED,
				T1.OFFERPRODUCT,
				T1.OFFERAMOUNT,
				T1.CUSTSEGMENTATION,
				T1.BASEPRODUCT,
				T1.PROCESSTYPE,
				T1.BUREAUTIMESERIES,
				T1.CAMPAIGNNAME,
				T1.EXISTINGLANREFNO,
				T1.LEADSOURCE,
				T1.POSOURCE,
				T1.RSA,
				T1.VERIFICATION,
				T1.SOURCINGBRANCH,
				T1.SOURCHANNELCATEGORY,
				T1.ASMNAME,
				T13.BRANCHDESC AS LOVDESCSOURCINGBRANCH,
				T1.OFFERID,
				T1.ALWGRCADJ,
				T1.ENDGRCPERIODAFTRFULLDISB,
				T1.AUTOINCGRCENDDATE,
				T1.PMAY,
				T1.ALWLOANSPLIT,
				T1.PARENTREF,
				T1.LOANSPLITTED,
				T1.PLANEMIHALWINGRACE
				FROM FINANCEMAIN_TEMP T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH = T12.BRANCHCODE
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINREFERENCE = T1.FINREFERENCE
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY = T24.POLICYCODE
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS = T27.CUSTSTSCODE
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE = T30.ROFFICERCODE
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID = T33.ROFFICERCODE
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE = T34.ROFFICERCODE
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT = T35.DEPTCODE
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION = T36.DIVISIONCODE
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME = T37.ROFFICERCODE
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE = 'ELGMETHOD'
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE = T39.LOANPURPOSECODE
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				UNION ALL
				SELECT T1.FINREFERENCE,
				T1.INVESTMENTREF,
				T1.NUMBEROFTERMS,
				T1.GRCPERIODENDDATE,
				T1.ALLOWGRCPERIOD,
				T1.GRACEBASERATE,
				T1.GRACESPECIALRATE,
				T1.GRCPFTRATE,
				T1.GRCPFTFRQ,
				T1.NEXTGRCPFTDATE,
				T1.ALLOWGRCPFTRVW,
				T1.GRCPFTRVWFRQ,
				T1.NEXTGRCPFTRVWDATE,
				T1.ALLOWGRCCPZ,
				T1.GRCCPZFRQ,
				T1.NEXTGRCCPZDATE,
				T1.REPAYBASERATE,
				T1.REPAYSPECIALRATE,
				T1.REPAYPROFITRATE,
				T1.REPAYFRQ,
				T1.NEXTREPAYDATE,
				T1.REPAYPFTFRQ,
				T1.NEXTREPAYPFTDATE,
				T1.ALLOWREPAYRVW,
				T1.REPAYRVWFRQ,
				T1.NEXTREPAYRVWDATE,
				T1.ALLOWREPAYCPZ,
				T1.REPAYCPZFRQ,
				T1.NEXTREPAYCPZDATE,
				T1.MATURITYDATE,
				T1.CPZATGRACEEND,
				T1.DOWNPAYMENT,
				T1.GRACEFLATAMOUNT,
				T1.REQREPAYAMOUNT,
				T1.TOTALPROFIT,
				T1.TOTALCPZ,
				T1.TOTALGROSSPFT,
				T1.TOTALGROSSGRCPFT,
				T1.TOTALGRACEPFT,
				T1.TOTALGRACECPZ,
				T1.GRCRATEBASIS,
				T1.REPAYRATEBASIS,
				T1.FINTYPE,
				T1.FINREMARKS,
				T1.FINCCY,
				T1.SCHEDULEMETHOD,
				T1.PROFITDAYSBASIS,
				T1.REQMATURITY,
				T1.CALTERMS,
				T1.CALMATURITY,
				T1.FIRSTREPAY,
				T1.LASTREPAY,
				T1.FINSTARTDATE,
				T1.FINAMOUNT,
				((T1.FINAMOUNT + T1.FEECHARGEAMT) - T1.DOWNPAYMENT) LOVDESCFINANCINGAMOUNT,
				T1.FINREPAYMENTAMOUNT,
				T1.CUSTID,
				T1.DEFFERMENTS,
				T1.PLANDEFERCOUNT,
				T1.FINBRANCH,
				T1.FINSOURCEID,
				T1.ALLOWEDDEFRPYCHANGE,
				T1.AVAILEDDEFRPYCHANGE,
				T1.ALLOWEDDEFFRQCHANGE,
				T1.AVAILEDDEFFRQCHANGE,
				T1.RECALTYPE,
				T1.FINASSETVALUE,
				T1.DISBACCOUNTID,
				T1.REPAYACCOUNTID,
				T1.FINISACTIVE,
				T1.LIMITVALID,
				T1.OVERRIDELIMIT,
				T1.SECURITYDEPOSIT,
				T1.VERSION,
				T1.LASTMNTBY,
				T1.LASTMNTON,
				T1.RECORDSTATUS,
				T1.ROLECODE,
				T1.NEXTROLECODE,
				T1.TASKID,
				T1.NEXTTASKID,
				T1.RECORDTYPE,
				T1.WORKFLOWID,
				T7.FINTYPEDESC  LOVDESCFINTYPENAME,
				T7.FINMAXAMOUNT  LOVDESCFINMAXAMT,
				T7.FINMINAMOUNT  LOVDESCFINMINAMOUNT,
				T1.MINDOWNPAYPERC,
				T7.FINISALWDIFFERMENT  LOVDESCFINALWDEFERMENT,
				T7.FINISDWPAYREQUIRED  LOVDESCDWNPAYREQ,
				T7.FINMAXDIFFERMENT  LOVDESCFINMAXDIFFERMENT,
				T12.BRANCHDESC  LOVDESCFINBRANCHNAME,
				T12.BRANCHPROVINCE  FINBRANCHPROVINCECODE,
				T1.LASTREPAYDATE,
				T1.LASTREPAYPFTDATE,
				T1.LASTREPAYRVWDATE,
				T1.LASTREPAYCPZDATE,
				T1.ALLOWGRCREPAY,
				T1.GRCSCHDMTHD,
				T1.GRCMARGIN,
				T1.REPAYMARGIN,
				T1.FINCURRASSETVALUE,
				T1.FINCOMMITMENTREF,
				T1.FINLIMITREF,
				T1.DEPRECIATIONFRQ,
				T1.FINCONTRACTDATE,
				T1.NEXTDEPDATE,
				T1.LASTDEPDATE,
				T1.FINACCOUNT,
				T1.FINCUSTPFTACCOUNT,
				T17.ACRTILLLBD  LOVDESCACCRUEDTILLLBD,
				T7.FINRVWRATEAPPLFOR,
				T1.TOTALREPAYAMT,
				T1.CLOSINGSTATUS,
				T1.FINAPPROVEDDATE,
				T1.FEECHARGEAMT,
				T1.BLACKLISTED,
				T1.FINREPAYPFTONFRQ,
				T1.ANUALIZEDPERCRATE,
				T1.EFFECTIVERATEOFRETURN,
				T1.MIGRATEDFINANCE,
				T1.SCHEDULEMAINTAINED,
				T1.SCHEDULEREGENERATED,
				T1.FINPURPOSE,
				T39.LOANPURPOSEDESC  LOVDESCFINPURPOSENAME,
				T1.FINSTATUS,
				T1.FINSTSREASON,
				T1.INITIATEUSER,
				T1.BANKNAME,
				T1.IBAN,
				T1.ACCOUNTTYPE,
				T1.DDAREFERENCENO,
				T7.FINSCHEDULEON  LOVDESCFINSCHEDULEON,
				T1.CUSTDSR,
				T1.JOINTACCOUNT,
				T1.JOINTCUSTID,
				T1.DOWNPAYBANK,
				T1.DOWNPAYSUPL,
				T1.DOWNPAYACCOUNT,
				T1.SECURITYCOLLATERAL,
				T1.APPROVED,
				T1.DISCREPANCY,
				T1.LIMITAPPROVED,
				T1.GRACETERMS,
				T7.FINDIVISION  LOVDESCFINDIVISION,
				T1.RCDMAINTAINSTS,
				T1.FINREPAYMETHOD,
				T1.GRCPROFITDAYSBASIS,
				T1.STEPFINANCE,
				T1.STEPTYPE,
				T1.STEPPOLICY,
				T1.ALWMANUALSTEPS,
				T1.NOOFSTEPS,
				T1.LINKEDFINREF,
				T1.NEXTUSERID,
				T1.PRIORITY,
				T24.POLICYDESC  LOVDESCSTEPPOLICYNAME,
				T1.GRCMINRATE,
				T1.GRCMAXRATE,
				T1.RPYMINRATE,
				T1.RPYMAXRATE,
				T1.DEVIATIONAPPROVAL,
				T1.MANUALSCHEDULE,
				T1.TAKEOVERFINANCE,
				T1.GRCADVBASERATE,
				T1.GRCADVMARGIN,
				T1.GRCADVPFTRATE,
				T1.RPYADVBASERATE,
				T1.RPYADVMARGIN,
				T1.RPYADVPFTRATE,
				T1.SUPPLEMENTRENT,
				T1.INCREASEDCOST,
				T1.CREDITINSAMT,
				T1.ROLLOVERFRQ,
				T1.NEXTROLLOVERDATE,
				T27.CUSTSTSDESCRIPTION,
				T1.SHARIASTATUS,
				T1.INITIATEDATE,
				T1.FINPREAPPROVEDREF,
				T1.MMAID,
				T1.ACCOUNTSOFFICER,
				T1.FEEACCOUNTID,
				T1.FINCANCELAC,
				T28.DEALERNAME  LOVDESCACCOUNTSOFFICER,
				T28.DEALERCITY  LOVDESCSOURCECITY,
				T1.DSACODE,
				T30.ROFFICERDESC  DSACODEDESC,
				T1.TDSAPPLICABLE,
				T1.MANDATEID,
				T1.DROPLINEFRQ,
				T1.FIRSTDROPLINEDATE,
				T1.PFTSERVICINGODLIMIT,
				T1.INSURANCEAMT,
				T1.DEDUCTINSDISB,
				T1.ALWBPI,
				T1.BPITREATMENT,
				T1.PLANEMIHALW,
				T1.PLANEMIHMETHOD,
				T1.PLANEMIHMAXPERYEAR,
				T1.PLANEMIHMAX,
				T1.PLANEMIHLOCKPERIOD,
				T1.PLANEMICPZ,
				T1.CALROUNDINGMODE,
				T1.ALWMULTIDISB,
				T1.APPLICATIONNO,
				T1.REFERRALID,
				T33.ROFFICERDESC  REFERRALIDDESC,
				T1.DMACODE,
				T34.ROFFICERDESC  DMACODEDESC,
				T1.SALESDEPARTMENT,
				T35.DEPTDESC  SALESDEPARTMENTDESC,
				T1.QUICKDISB,
				T1.WIFREFERENCE,
				T1.UNPLANEMIHLOCKPERIOD,
				T1.UNPLANEMICPZ,
				T1.REAGECPZ,
				T1.MAXUNPLANNEDEMI,
				T1.MAXREAGEHOLIDAYS,
				T1.AVAILEDUNPLANEMI,
				T1.AVAILEDREAGEH,
				T1.BPIAMOUNT,
				T1.DEDUCTFEEDISB,
				T1.RVWRATEAPPLFOR,
				T1.SCHCALONRVW,
				T1.PASTDUEPFTCALMTHD,
				T1.PASTDUEPFTMARGIN,
				T1.DROPPINGMETHOD,
				T1.RATECHGANYDAY,
				T1.PROMOTIONCODE,
				T1.RESTRUCTURELOAN,
				T1.OLDFINREFERENCE,
				T1.REAGEBUCKET,
				T1.FINCATEGORY,
				T1.PRODUCTCATEGORY,
				T1.ROUNDINGTARGET,
				T36.ENTITYCODE  LOVDESCENTITYCODE,
				T1.ELIGIBILITYMETHOD,
				T38.FIELDCODEVALUE  LOVELIGIBILITYMETHOD,
				T38.VALUEDESC  LOVDESCELIGIBILITYMETHOD,
				T1.EMPLOYEENAME,
				T37.ROFFICERDESC  EMPLOYEENAMEDESC,
				T1.SAMPLINGREQUIRED,
				T1.LEGALREQUIRED,
				T1.GRCMAXAMOUNT,
				T1.CONNECTOR,
				T40.DEALERNAME  CONNECTORCODE,
				T40.DEALERCITY  CONNECTORDESC,
				T1.ADVANCEEMI,
				T1.ADVEMITERMS,
				T1.BPIPFTDAYSBASIS,
				T1.FIXEDRATETENOR,
				T1.FIXEDTENORRATE,
				T12.BRANCHTEL  FINBRANCHCONTACT,
				T1.PROCESSATTRIBUTES,
				T1.BUSINESSVERTICAL,
				BV.CODE  BUSINESSVERTICALCODE,
				BV.DESCRIPTION  BUSINESSVERTICALDESC,
				T1.GRCADVTYPE,
				T1.GRCADVTERMS,
				T1.ADVTYPE,
				T1.ADVTERMS,
				T1.ADVSTAGE,
				T1.TDSPERCENTAGE,
				T1.TDSSTARTDATE,
				T1.TDSENDDATE,
				T1.TDSLIMITAMT,
				T1.VANREQ,
				T1.VANCODE,
				T1.ALLOWDRAWINGPOWER,
				T1.ALLOWREVOLVING,
				T1.SANBSDSCHDLE,
				T1.PROMOTIONSEQID,
				T1.SVAMOUNT,
				T1.CBAMOUNT,
				T1.APPLIEDLOANAMT,
				T1.FINISRATERVWATGRCEND,
				T1.REQLOANAMT,
				T1.REQLOANTENOR,
				T1.FINOCRREQUIRED,
				T1.OFFERPRODUCT,
				T1.OFFERAMOUNT,
				T1.CUSTSEGMENTATION,
				T1.BASEPRODUCT,
				T1.PROCESSTYPE,
				T1.BUREAUTIMESERIES,
				T1.CAMPAIGNNAME,
				T1.EXISTINGLANREFNO,
				T1.LEADSOURCE,
				T1.POSOURCE,
				T1.RSA,
				T1.VERIFICATION,
				T1.SOURCINGBRANCH,
				T1.SOURCHANNELCATEGORY,
				T1.ASMNAME,
				T13.BRANCHDESC AS LOVDESCSOURCINGBRANCH,
				T1.OFFERID,
				T1.ALWGRCADJ,
				T1.ENDGRCPERIODAFTRFULLDISB,
				T1.AUTOINCGRCENDDATE,
				T1.PMAY,
				T1.ALWLOANSPLIT,
				T1.PARENTREF,
				T1.LOANSPLITTED,
				T1.PLANEMIHALWINGRACE
				FROM FINANCEMAIN T1
				JOIN RMTFINANCETYPES T7 ON T1.FINTYPE = T7.FINTYPE
				LEFT JOIN RMTBRANCHES T12 ON T1.FINBRANCH = T12.BRANCHCODE
				LEFT JOIN RMTBRANCHES T13 ON T1.SOURCINGBRANCH = T13.BRANCHCODE
				LEFT JOIN FINPFTDETAILS T17 ON T17.FINREFERENCE = T1.FINREFERENCE
				LEFT JOIN STEPPOLICYHEADER T24 ON T1.STEPPOLICY = T24.POLICYCODE
				LEFT JOIN BMTCUSTSTATUSCODES T27 ON T1.FINSTATUS = T27.CUSTSTSCODE
				LEFT JOIN AMTVEHICLEDEALER T28 ON T1.ACCOUNTSOFFICER = T28.DEALERID
				LEFT JOIN RELATIONSHIPOFFICERS T30 ON T1.DSACODE = T30.ROFFICERCODE
				LEFT JOIN RELATIONSHIPOFFICERS T33 ON T1.REFERRALID = T33.ROFFICERCODE
				LEFT JOIN RELATIONSHIPOFFICERS T34 ON T1.DMACODE = T34.ROFFICERCODE
				LEFT JOIN BMTDEPARTMENTS T35 ON T1.SALESDEPARTMENT = T35.DEPTCODE
				LEFT JOIN SMTDIVISIONDETAIL T36 ON T7.FINDIVISION = T36.DIVISIONCODE
				LEFT JOIN RELATIONSHIPOFFICERS T37 ON T1.EMPLOYEENAME = T37.ROFFICERCODE
				LEFT JOIN RMTLOVFIELDDETAIL T38 ON T1.ELIGIBILITYMETHOD = T38.FIELDCODEID AND T38.FIELDCODE = 'ELGMETHOD'
				LEFT JOIN LOANPURPOSES T39 ON T1.FINPURPOSE = T39.LOANPURPOSECODE
				LEFT JOIN AMTVEHICLEDEALER T40 ON T1.CONNECTOR = T40.DEALERID
				LEFT JOIN BUSINESS_VERTICAL BV ON BV.ID = T1.BUSINESSVERTICAL
				WHERE NOT EXISTS (SELECT 1
				FROM FINANCEMAIN_TEMP
				WHERE FINANCEMAIN_TEMP.FINREFERENCE = T1.FINREFERENCE)
		  	]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.10_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'financemain_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.11_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
			<![CDATA[ 
				select deps_save_and_drop_dependencies ('plf', 'verification_tv_view'); 
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.11" author="Gopal.p">
		<createView viewName="VERIFICATION_TV_VIEW" replaceIfExists="true">
			<![CDATA[	 
				SELECT tv.verificationid,
				    tv.agentcode,
				    tv.agentname,
				    tv.type,
				    tv.verifieddate,
				    tv.status,
				    cs.collateraltype,
				    cs.collateralccy,
				    cs.collateralloc,
				    tv.reason,
				    tv.valuationamount,
				    r1.code AS reasoncode,
				    r1.description AS reasondesc,
				    tv.summaryremarks,
				    tv.sourceformname,
				    tv.verificationformname,
				    tv.documentname,
				    tv.documentref,
				    tv.version,
				    tv.lastmntby,
				    tv.lastmnton,
				    tv.recordstatus,
				    tv.rolecode,
				    tv.nextrolecode,
				    tv.taskid,
				    tv.nexttaskid,
				    tv.recordtype,
				    tv.workflowid,
				    tv.observationremarks,
				    c.custcif AS cif,
				    v.keyreference,
				    v.createdon,
				    v.agency,
				    a.dealername AS agencyname,
				    a.dealercity AS agencycity,
				    v.custid,
				    c.custshrtname AS custname,
				    v.verificationcategory,
				    cs.collateralref,
				    cpnh.phonenumber AS contactnumber1,
				    cpnl.phonenumber AS contactnumber2,
				    tv.valasperpe,
				    tv.finalvalamt,
				    tv.decisiononval,
				    tv.finalvalremarks,
				    fm.productcategory,
				    fm.fintype AS loantype,
				    fm.lovdescfintypename AS lovdescloantypename,
				    fm.sourcingbranch,
				    fm.lovdescsourcingbranch
				   FROM verification_tv_temp tv
				    JOIN verifications v ON v.id = tv.verificationid
				    JOIN ( SELECT collateralsetup_temp.collateraltype,
				            collateralsetup_temp.collateralccy,
				            collateralsetup_temp.collateralloc,
				            collateralsetup_temp.collateralref
				        FROM collateralsetup_temp
				    UNION
				         SELECT csp.collateraltype,
				            csp.collateralccy,
				            csp.collateralloc,
				            csp.collateralref
				           FROM collateralsetup csp
				        WHERE NOT (EXISTS ( SELECT 1
				                   FROM collateralsetup_temp
				                  WHERE collateralsetup_temp.collateralref = csp.collateralref))) cs ON cs.collateralref = v.referencefor
				    JOIN collateralstructure cst ON cst.collateraltype = cs.collateraltype
				    LEFT JOIN amtvehicledealer a ON a.dealerid = v.agency
				    LEFT JOIN customers c ON c.custid = v.custid
				    LEFT JOIN customerphonenumbers cpnh ON cpnh.phonecustid = c.custid AND cpnh.phonetypepriority = 5
				    LEFT JOIN customerphonenumbers cpnl ON cpnl.phonecustid = c.custid AND cpnl.phonetypepriority = 4
				    LEFT JOIN reasons r1 ON r1.id = tv.reason
				    JOIN financemain_view fm ON fm.finreference = v.keyreference
				UNION ALL
				    SELECT tv.verificationid,
						tv.agentcode,
						tv.agentname,
						tv.type,
						tv.verifieddate,
						tv.status,
						cs.collateraltype,
						cs.collateralccy,
						cs.collateralloc,
						tv.reason,
						tv.valuationamount,
						r1.code AS reasoncode,
						r1.description AS reasondesc,
						tv.summaryremarks,
						tv.sourceformname,
						tv.verificationformname,
						tv.documentname,
						tv.documentref,
						tv.version,
						tv.lastmntby,
						tv.lastmnton,
						tv.recordstatus,
						tv.rolecode,
						tv.nextrolecode,
						tv.taskid,
						tv.nexttaskid,
						tv.recordtype,
						tv.workflowid,
						tv.observationremarks,
						c.custcif AS cif,
						v.keyreference,
						v.createdon,
						v.agency,
						a.dealername AS agencyname,
						a.dealercity AS agencycity,
						v.custid,
						c.custshrtname AS custname,
						v.verificationcategory,
						cs.collateralref,
						cpnh.phonenumber AS contactnumber1,
						cpnl.phonenumber AS contactnumber2,
						tv.valasperpe,
						tv.finalvalamt,
						tv.decisiononval,
						tv.finalvalremarks,
						fm.productcategory,
						fm.fintype AS loantype,
						fm.lovdescfintypename AS lovdescloantypename,
						fm.sourcingbranch,
						fm.lovdescsourcingbranch
				   FROM verification_tv tv
				     JOIN verifications v ON v.id = tv.verificationid
				     JOIN ( SELECT collateralsetup_temp.collateraltype,
				            collateralsetup_temp.collateralccy,
				            collateralsetup_temp.collateralloc,
				            collateralsetup_temp.collateralref
				           FROM collateralsetup_temp
				    UNION
				      SELECT csp.collateraltype,
				            csp.collateralccy,
				            csp.collateralloc,
				            csp.collateralref
				      FROM collateralsetup csp
				      WHERE NOT (EXISTS ( SELECT 1
				                   FROM collateralsetup_temp
				                  WHERE collateralsetup_temp.collateralref = csp.collateralref))) cs ON cs.collateralref = v.referencefor
				     JOIN collateralstructure cst ON cst.collateraltype = cs.collateraltype
				     LEFT JOIN amtvehicledealer a ON a.dealerid = v.agency
				     LEFT JOIN customers c ON c.custid = v.custid
				     LEFT JOIN customerphonenumbers cpnh ON cpnh.phonecustid = c.custid AND cpnh.phonetypepriority = 5
				     LEFT JOIN customerphonenumbers cpnl ON cpnl.phonecustid = c.custid AND cpnl.phonetypepriority = 4
				     LEFT JOIN reasons r1 ON r1.id = tv.reason
				     JOIN financemain_view fm ON fm.finreference = v.keyreference
				  WHERE NOT (EXISTS ( SELECT 1
				           FROM verification_tv_temp
				          WHERE verification_tv_temp.verificationid = tv.verificationid));
		  		]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.11_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'verification_tv_view');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.12_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'INT_MANDATE_REQUEST_VIEW'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.12" author="Gopal.p">
		<createView viewName="INT_MANDATE_REQUEST_VIEW" replaceIfExists="true">
			<![CDATA[
					SELECT M.MANDATEID,
					M.DOCUMENTNAME,
					BD.BANKSHORTCODE BANKCODE,
					BD.BANKNAME,
					case when LB.BRANCHCODE IS NULL THEN CB.BRANCHCODE ELSE LB.BRANCHCODE END BRANCHCODE,
					case when LB.BRANCHDESC IS NULL THEN CB.BRANCHDESC ELSE LB.BRANCHDESC END BRANCHDESC,
					CUST.CUSTCIF,
					CUST.CUSTSHRTNAME,
					CUST.CustCoreBank,
					FT.FINTYPEDESC FINTYPE,
					FIN.FINREFERENCE,
					COALESCE((SELECT SUM(TotalAmount) 
					FROM (Select MAX(FSD.REPAYAMOUNT+FSD.FEESCHD) TotalAmount
					FROM FINSCHEDULEDETAILS FSD
					INNER JOIN FINANCEMAIN FM ON FM.FINREFERENCE
					=FSD.FINREFERENCE AND FM.CUSTID = M.CUSTID
					GROUP BY FM.FINREFERENCE)T)/CCYMINORCCYUNITS, 0) CUST_EMI,
					COALESCE((SELECT SUM(TotalAmount) 
					FROM (Select MAX(FSD.REPAYAMOUNT+FSD.FEESCHD) TotalAmount 
					FROM FINSCHEDULEDETAILS FSD WHERE
					(REPAYONSCHDATE = 1 OR PFTONSCHDATE = 1) AND FINREFERENCE IN (SELECT FINREFERENCE FROM FINANCEMAIN WHERE MANDATEID =
					M.MANDATEID) GROUP BY FINREFERENCE)T)/CCYMINORCCYUNITS, 0) EMI,
					CASE M.OPENMANDATE WHEN 1 THEN 'New Open ECS' ELSE 'No
					Open ECS' END OPENMANDATE,
					M.ACCNUMBER,
					CASE WHEN M.ACCTYPE = '10' then 'Savings Account' WHEN M.ACCTYPE = '11' then
					'Current Account' WHEN M.ACCTYPE = '11' then
					'Cash Credit Account' ELSE M.ACCTYPE END ACCTYPE,
					M.ACCHOLDERNAME,
					BB.MICR,
					BB.IFSC,
					BB.ADDOFBRANCH,
					(select MIN(FIRSTREPAYDATE) from FINPFTDETAILS where FINREFERENCE IN (SELECT
					FINREFERENCE FROM FINANCEMAIN WHERE
					MANDATEID=M.MANDATEID)) FIRSTDUEDATE,
					(select MAX(SCHDATE) from FINSCHEDULEDETAILS
					where (REPAYONSCHDATE = 1 OR PFTONSCHDATE = 1) and FINREFERENCE IN (SELECT
					FINREFERENCE FROM FINANCEMAIN WHERE
					MANDATEID=M.MANDATEID)) EMIENDDATE,
					COALESCE (M.MAXLIMIT/CCYMINORCCYUNITS, 0) MAXLIMIT,
					COALESCE((SELECT SUM(MANDATEDEBITAMOUNT) from (Select MAX(REPAYAMOUNT+FEESCHD) 
					MANDATEDEBITAMOUNT FROM FINSCHEDULEDETAILS WHERE
					(REPAYONSCHDATE = 1 OR PFTONSCHDATE = 1) AND FINREFERENCE IN (SELECT FINREFERENCE FROM FINANCEMAIN WHERE
					MANDATEID=M.MANDATEID) GROUP BY FINREFERENCE)T), 0)/CCYMINORCCYUNITS DEBITAMOUNT,
					FIN.NumberOfTerms,
					M.periodicity,
					M.STARTDATE,
					M.EXPIRYDATE,
					FIN.APPLICATIONNO,
					M.MANDATETYPE,
					M.STATUS,
					M.INPUTDATE,
					M.RECORDSTATUS,
					M.RECORDTYPE,
					M.MANDATECCY,
					COALESCE (CCY.CCYMINORCCYUNITS, 100) CCYMINORCCYUNITS,
					M.EntityCode,
					CP.PHONENUMBER,
					CE.CUSTEMAIL,
					PB.PARTNERBANKNAME,
					M.LASTMNTON,
					BB.BranchDesc BANK_BRANCH_NAME
					FROM MANDATES M
					INNER JOIN BANKBRANCHES BB ON BB.BANKBRANCHID = M.BANKBRANCHID
					INNER JOIN BMTBANKDETAIL BD ON BD.BANKCODE = BB.BANKCODE
					INNER JOIN CUSTOMERS CUST ON CUST.CUSTID = M.CUSTID
					INNER JOIN RMTBRANCHES CB ON CB.BRANCHCODE = CUST.CUSTDFTBRANCH
					LEFT JOIN PARTNERBANKS PB ON PB.PARTNERBANKID = M.PARTNERBANKID
					LEFT JOIN CUSTOMEREMAILS CE ON CE.CUSTID = CUST.CUSTID AND CE.CUSTEMAILPRIORITY = 5
					LEFT JOIN CUSTOMERPHONENUMBERS CP ON CP.PHONECUSTID = CUST.CUSTID AND CP.PHONETYPEPRIORITY = 5
					LEFT OUTER JOIN RMTCURRENCIES CCY ON CCY.CCYCODE = M.MANDATECCY
					LEFT OUTER JOIN FINANCEMAIN FIN ON M.ORGREFERENCE = FIN.FINREFERENCE
					LEFT JOIN RMTBRANCHES LB ON LB.BRANCHCODE = FIN.FINBRANCH
					LEFT OUTER JOIN RMTFINANCETYPES FT ON FIN.FINTYPE = FT.FINTYPE
					WHERE M.STATUS = 'NEW' AND M.MANDATEID NOT IN (select MANDATEID FROM MANDATE_REQUESTS where (status = 'AC' OR status = 'NEW'))
				]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.12_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'INT_MANDATE_REQUEST_VIEW');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.13_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'FinanceMain_LView'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.13" author="Gopal.p">
		<createView viewName="FinanceMain_LView" replaceIfExists="true">
			<![CDATA[
		 		SELECT T1.FINREFERENCE,
					T1.INVESTMENTREF,
					T1.FINTYPE,
					T1.FINCCY,
					T1.FINAMOUNT,
					T1.DOWNPAYMENT,
					T1.FEECHARGEAMT,
					T1.SCHEDULEMETHOD,
					T1.NUMBEROFTERMS,
					T1.RECORDSTATUS,
					T1.RECORDTYPE,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.FINBRANCH,
					T1.FINCONTRACTDATE,
					T1.LINKEDFINREF,
					T1.NEXTUSERID,
					T1.PRIORITY,
					T1.WORKFLOWID,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.FINPREAPPROVEDREF,
					T1.RCDMAINTAINSTS,
					T1.INSURANCEAMT,
					T1.FINCURRASSETVALUE,
					T1.CALTERMS,
					T1.DEVIATIONAPPROVAL,
					T1.FINPURPOSE,
					T1.INITIATEDATE,
					T1.FINASSETVALUE,
					T2.CUSTCIF LOVDESCCUSTCIF,
					T2.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
					T2.CUSTPASSPORTNO LOVDESCCUSTPASSPORTNO,
					T2.CUSTDOB LOVDESCCUSTDOB,
					T2.CUSTCRCPR LOVDESCCUSTCRCPR,
					T2.PHONENUMBER,
					T3.FINCATEGORY LOVDESCPRODUCTCODENAME,
					T3.FINDIVISION LOVDESCFINDIVISION,
					T3.PRODUCT LOVDESCFINPRODUCT,
					T3.FINTYPEDESC LOVDESCFINTYPENAME,
					COALESCE(T4.ROLEDESC, ${add.schema}FN_GET_ROLEDESC(T1.NEXTROLECODE)) LOVDESCREQUESTSTAGE,
					T1.SAMPLINGREQUIRED,
					T1.ADVANCEEMI,
					T1.ADVEMITERMS,
					T1.BPIPFTDAYSBASIS,
					T1.GRACETERMS,
					T1.PRODUCTCATEGORY,
					T1.REQLOANAMT,
					T1.REQLOANTENOR,
					T1.FINOCRREQUIRED,
					T1.OFFERPRODUCT,
					T1.OFFERAMOUNT,
					T1.CUSTSEGMENTATION,
					T1.BASEPRODUCT,
					T1.PROCESSTYPE,
					T1.BUREAUTIMESERIES,
					T1.CAMPAIGNNAME,
					T1.EXISTINGLANREFNO,
					T1.LEADSOURCE,
					T1.POSOURCE,
					T1.RSA,
					T1.VERIFICATION,
					T1.SOURCINGBRANCH,
					T1.SOURCHANNELCATEGORY,
					T1.ASMNAME,
					T1.OFFERID,
					T1.APPLICATIONNO,
					T1.LASTMNTON,
					T1.VERSION
					FROM FINANCEMAIN_TEMP T1
					INNER JOIN CUSTOMERS T2 ON T1.CUSTID = T2.CUSTID
					INNER JOIN RMTFINANCETYPES T3 ON T3.FINTYPE = T1.FINTYPE
					LEFT JOIN SECROLES T4 ON T1.NEXTROLECODE= T4.ROLECD
				  ]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.13_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'FinanceMain_LView');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.14_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'manualadvise_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.14" author="Gopal.p">
		<createView viewName="ManualAdvise_AView" replaceIfExists="true">
			<![CDATA[
				 SELECT T1.ADVISEID,
						T1.ADVISETYPE,
						T1.FINREFERENCE,
						T1.FEETYPEID,
						T1.SEQUENCE,
						T1.ADVISEAMOUNT,
						T1.PAIDAMOUNT,
						T1.WAIVEDAMOUNT,
						T1.REMARKS,
						T1.VALUEDATE,
						T1.POSTDATE,
						T1.VERSION,
						T1.LASTMNTBY,
						T1.LASTMNTON,
						T1.RECORDSTATUS,
						T1.ROLECODE,
						T1.NEXTROLECODE,
						T1.TASKID,
						T1.NEXTTASKID,
						T1.RECORDTYPE,
						T1.WORKFLOWID,
						T2.FEETYPEDESC,
						T2.FEETYPECODE,
						T1.BOUNCEID,
						T1.RECEIPTID,
						T3.BOUNCECODE,
						T1.RESERVEDAMT,
						T1.BALANCEAMT,
						T3.REASON AS BOUNCECODEDESC,
						COALESCE(T2.TAXAPPLICABLE, 0) AS TAXAPPLICABLE,
						COALESCE(T2.TDSREQ, 0) AS TDSREQ,
						T2.TAXCOMPONENT,
						T1.PAIDCGST,
						T1.PAIDSGST,
						T1.PAIDIGST,
						T1.PAIDUGST,
						T1.WAIVEDCGST,
						T1.WAIVEDSGST,
						T1.WAIVEDUGST,
						T1.WAIVEDIGST,
						T1.WAIVEDCESS,
						T1.PAIDCESS,
						T1.FINSOURCE,
						T1.DUECREATION,
						T1.LINKEDTRANID,
						T1.TDSPAID,
						T1.HOLDDUE
					 FROM MANUALADVISE T1
					 LEFT JOIN FEETYPES T2 ON T1.FEETYPEID = T2.FEETYPEID
					 LEFT JOIN BOUNCEREASONS T3 ON T1.BOUNCEID = T3.BOUNCEID
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.14_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'manualadvise_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.15_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_fdview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.15" author="Gopal.p">
		<comment>Added PAYMENTTYPE switch case for cash</comment>
		<createView viewName="FINRECEIPTHEADER_FDVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					CASE
					WHEN T1.RECAGAINST = 'C'
					THEN T10.CUSTCIF
					ELSE T1.REFERENCE
					END REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.SUBRECEIPTMODE,
					T1.RECEIPTCHANNEL,
					T1.RECEIVEDFROM,
					T1.PANNUMBER,
					T1.COLLECTIONAGENTID,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					(CASE
					WHEN T8.PAYMENTTYPE IN ('CHEQUE', 'DD') THEN T8.FAVOURNUMBER
					WHEN T8.PAYMENTTYPE IN ('CASH') THEN T8.PAYMENTREF
					ELSE T8.TRANSACTIONREF
					END) TRANSACTIONREF,
					T1.CASHIERBRANCH,
					T2.NEXTREPAYRVWDATE,
					T1.INITIATEDATE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.MODULE,
					T1.EXTREFERENCE,
					T10.CUSTCIF CUSTOMERCIF,
					T10.CUSTSHRTNAME CUSTOMERNAME,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T11.DIVISIONCODEDESC FINDIVISIONDESC,
					T12.BRANCHDESC POSTBRANCHDESC,
					T13.BRANCHDESC CASHIERBRANCHDESC,
					T11.ENTITYCODE,
					T1.INSTRUCTIONUID,
					T1.ACTFINRECEIPT,
					T1.CANCELREMARKS,
					T1.KNOCKOFFTYPE
					FROM FINRECEIPTHEADER_TEMP T1
					LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.REFERENCE = T2.FINREFERENCE
					LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
					LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
					LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
					LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
					LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
					LEFT JOIN FINRECEIPTDETAIL_TEMP T8 ON T1.RECEIPTID    = T8.RECEIPTID AND T1.RECEIPTMODE = T8.PAYMENTTYPE
					LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
					LEFT JOIN CUSTOMERS T10 ON CAST(T10.CUSTID AS VARCHAR(20)) = T1.REFERENCE
					LEFT JOIN SMTDIVISIONDETAIL T11 ON T1.FINDIVISION = T11.DIVISIONCODE
					LEFT JOIN RMTBRANCHES T12 ON T1.POSTBRANCH = T12.BRANCHCODE
					LEFT JOIN RMTBRANCHES T13 ON T1.CASHIERBRANCH = T13.BRANCHCODE
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.15_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finreceiptheader_fdview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.16_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_fedview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.16" author="Gopal.p">
		<createView viewName="FINRECEIPTHEADER_FEDVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					(
					CASE
					WHEN T1.RECAGAINST ='C'
					THEN T13.CUSTCIF
					ELSE T1.REFERENCE
					END) REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.SUBRECEIPTMODE,
					T1.RECEIPTCHANNEL,
					T1.RECEIVEDFROM,
					T1.PANNUMBER,
					T1.COLLECTIONAGENTID,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					(CASE
					WHEN T8.PAYMENTTYPE IN ('CHEQUE', 'DD') THEN T8.FAVOURNUMBER
					WHEN T8.PAYMENTTYPE IN ('CASH') THEN T8.PAYMENTREF
					ELSE T8.TRANSACTIONREF
					END) TRANSACTIONREF,
					T2.NEXTREPAYRVWDATE,
					T1.CASHIERBRANCH,
					T1.INITIATEDATE,
					T1.INSTRUCTIONUID,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T10.DIVISIONCODEDESC FINDIVISIONDESC,
					T11.BRANCHDESC POSTBRANCHDESC,
					T12.BRANCHDESC CASHIERBRANCHDESC,
					T10.ENTITYCODE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.MODULE,
					T1.EXTREFERENCE,
					T13.CUSTCIF CUSTOMERCIF,
					T13.CUSTSHRTNAME CUSTOMERNAME,
					T1.CANCELREMARKS,
					T1.KNOCKOFFTYPE
					FROM FINRECEIPTHEADER_TEMP T1
					LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.REFERENCE = T2.FINREFERENCE
					LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
					LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
					LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
					LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
					LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
					LEFT JOIN FINRECEIPTDETAIL T8 ON T1.RECEIPTID = T8.RECEIPTID AND T1.RECEIPTMODE = T8.PAYMENTTYPE
					LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
					LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
					LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
					LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
					LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
					UNION ALL
					SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					(
					CASE
					WHEN T1.RECAGAINST ='C'
					THEN T13.CUSTCIF
					ELSE T1.REFERENCE
					END) REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.SUBRECEIPTMODE,
					T1.RECEIPTCHANNEL,
					T1.RECEIVEDFROM,
					T1.PANNUMBER,
					T1.COLLECTIONAGENTID,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					(CASE
					WHEN T8.PAYMENTTYPE IN ('CHEQUE', 'DD') THEN T8.FAVOURNUMBER
					WHEN T8.PAYMENTTYPE IN ('CASH') THEN T8.PAYMENTREF
					ELSE T8.TRANSACTIONREF
					END) TRANSACTIONREF,
					T2.NEXTREPAYRVWDATE,
					T1.CASHIERBRANCH,
					T1.INITIATEDATE,
					T1.INSTRUCTIONUID,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T10.DIVISIONCODEDESC FINDIVISIONDESC,
					T11.BRANCHDESC POSTBRANCHDESC,
					T12.BRANCHDESC CASHIERBRANCHDESC,
					T10.ENTITYCODE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.MODULE,
					T1.EXTREFERENCE,
					T13.CUSTCIF CUSTOMERCIF,
					T13.CUSTSHRTNAME CUSTOMERNAME,
					T1.CANCELREMARKS,
					T1.KNOCKOFFTYPE
					FROM FINRECEIPTHEADER T1
					LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.REFERENCE = T2.FINREFERENCE
					LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
					LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
					LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
					LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
					LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
					LEFT JOIN FINRECEIPTDETAIL T8 ON T1.RECEIPTID = T8.RECEIPTID AND T1.RECEIPTMODE = T8.PAYMENTTYPE
					LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
					LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
					LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
					LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
					LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
					WHERE NOT EXISTS
					( SELECT 1 FROM FINRECEIPTHEADER_TEMP WHERE RECEIPTID = T1.RECEIPTID
					)
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.16_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finreceiptheader_fedview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.17_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_feview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.17" author="Gopal.p">
		<createView viewName="FINRECEIPTHEADER_FEVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					T1.REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					T2.NEXTREPAYRVWDATE,
					(CASE
					WHEN T8.PAYMENTTYPE IN ('CHEQUE', 'DD') THEN T8.FAVOURNUMBER
					WHEN T8.PAYMENTTYPE IN ('CASH') THEN T8.PAYMENTREF
					ELSE T8.TRANSACTIONREF
					END) TRANSACTIONREF,
					T1.CASHIERBRANCH,
					T1.INITIATEDATE,
					T4.FINDIVISION LOVDESCFINDIVISION,
					T2.BUSINESSVERTICAL,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T10.DIVISIONCODEDESC FINDIVISIONDESC,
					T11.BRANCHDESC POSTBRANCHDESC,
					T12.BRANCHDESC CASHIERBRANCHDESC,
					T10.ENTITYCODE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.INSTRUCTIONUID,
					T1.MODULE,
					T1.EXTREFERENCE,
					T1.COLLECTIONAGENTID,
					T1.PANNUMBER,
					T1.RECEIVEDFROM,
					T1.RECEIPTCHANNEL,
					T1.SUBRECEIPTMODE,
					T13.CUSTCIF CUSTOMERCIF,
					T13.CUSTSHRTNAME CUSTOMERNAME,
					T1.ACTFINRECEIPT,
					T1.REASONCODE,
					T1.CANCELREMARKS,
					T1.KNOCKOFFTYPE
					FROM FINRECEIPTHEADER_TEMP T1
					LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.REFERENCE = T2.FINREFERENCE
					LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
					LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
					LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
					LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
					LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
					LEFT JOIN FINRECEIPTDETAIL T8 ON T1.RECEIPTID = T8.RECEIPTID AND T1.RECEIPTMODE = T8.PAYMENTTYPE
					LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
					LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
					LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
					LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
					LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
					UNION ALL
					SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					T1.REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.RECEIPTMODESTATUS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
					T2.SCHEDULEMETHOD,
					T2.PROFITDAYSBASIS PFTDAYSBASIS,
					T1.WAVIEDAMT,
					COALESCE(T3.CUSTID, 0) CUSTID,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					T2.NEXTREPAYRVWDATE,
					(CASE
					WHEN T8.PAYMENTTYPE IN ('CHEQUE', 'DD') THEN T8.FAVOURNUMBER
					WHEN T8.PAYMENTTYPE IN ('CASH') THEN T8.PAYMENTREF
					ELSE T8.TRANSACTIONREF
					END) TRANSACTIONREF,
					T1.CASHIERBRANCH,
					T1.INITIATEDATE,
					T4.FINDIVISION LOVDESCFINDIVISION,
					T2.BUSINESSVERTICAL,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T10.DIVISIONCODEDESC FINDIVISIONDESC,
					T11.BRANCHDESC POSTBRANCHDESC,
					T12.BRANCHDESC CASHIERBRANCHDESC,
					T10.ENTITYCODE,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.INSTRUCTIONUID,
					T1.MODULE,
					T1.EXTREFERENCE,
					T1.COLLECTIONAGENTID,
					T1.PANNUMBER,
					T1.RECEIVEDFROM,
					T1.RECEIPTCHANNEL,
					T1.SUBRECEIPTMODE,
					T13.CUSTCIF CUSTOMERCIF,
					T13.CUSTSHRTNAME CUSTOMERNAME,
					T1.ACTFINRECEIPT,
					T1.REASONCODE,
					T1.CANCELREMARKS,
					T1.KNOCKOFFTYPE
					FROM FINRECEIPTHEADER T1
					LEFT JOIN
					(SELECT FINREFERENCE,
					FINBRANCH,
					FINTYPE,
					FINCCY,
					SCHEDULEMETHOD,
					PROFITDAYSBASIS,
					FINISACTIVE,
					CUSTID,
					PRODUCTCATEGORY,
					PROMOTIONCODE,
					NEXTREPAYRVWDATE,
					BUSINESSVERTICAL
					FROM FINANCEMAIN_TEMP
					UNION
					SELECT FINREFERENCE,
					FINBRANCH,
					FINTYPE,
					FINCCY,
					SCHEDULEMETHOD,
					PROFITDAYSBASIS,
					FINISACTIVE,
					CUSTID,
					PRODUCTCATEGORY,
					PROMOTIONCODE,
					NEXTREPAYRVWDATE,
					BUSINESSVERTICAL
					FROM FINANCEMAIN
					) T2 ON T1.REFERENCE = T2.FINREFERENCE
					LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
					LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
					LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
					LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
					LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
					LEFT JOIN FINRECEIPTDETAIL T8 ON T1.RECEIPTID = T8.RECEIPTID AND T1.RECEIPTMODE = T8.PAYMENTTYPE
					LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
					LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
					LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
					LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
					LEFT JOIN CUSTOMERS T13 ON CAST(T13.CUSTID AS VARCHAR(20)) = T1.REFERENCE
					WHERE NOT EXISTS
					( SELECT 1 FROM FINRECEIPTHEADER_TEMP WHERE RECEIPTID = T1.RECEIPTID
					)
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.17_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finreceiptheader_feview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.18_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_fview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.18" author="Gopal.p">
		<createView viewName="FINRECEIPTHEADER_FVIEW" replaceIfExists="true">
			<![CDATA[
				   SELECT T1.RECEIPTID,
						  T1.RECEIPTDATE,
						  T1.RECEIPTTYPE,
						  t1.actfinreceipt,
						  T1.RECAGAINST,
						  T1.REFERENCE,
						  T1.RECEIPTPURPOSE,
						  T1.RECEIPTMODE,
						  T1.EXCESSADJUSTTO,
						  T1.ALLOCATIONTYPE,
						  T1.RECEIPTAMOUNT,
						  T1.EFFECTSCHDMETHOD,
						  T1.RECEIPTMODESTATUS,
						  T1.SUBRECEIPTMODE,
						  T1.RECEIPTCHANNEL,
						  T1.RECEIVEDFROM,
						  T1.PANNUMBER,
						  T1.COLLECTIONAGENTID,
						  T1.VERSION,
						  T1.LASTMNTBY,
						  T1.LASTMNTON,
						  T1.RECORDSTATUS,
						  T1.ROLECODE,
						  T1.NEXTROLECODE,
						  T1.TASKID,
						  T1.NEXTTASKID,
						  T1.RECORDTYPE,
						  T1.WORKFLOWID,
						  T2.FINTYPE,
						  T2.FINBRANCH,
						  T3.CUSTCIF,
						  T3.CUSTSHRTNAME,
						  T2.FINCCY,
						  T1.REALIZATIONDATE,
						  T1.CANCELREASON,
						  T4.FINTYPEDESC,
						  T6.BRANCHDESC FINBRANCHDESC,
						  T5.CCYDESC FINCCYDESC,
						  T7.REJECTDESC CANCELREASONDESC,
						  COALESCE(T2.FINISACTIVE, 0) FINISACTIVE,
						  T2.SCHEDULEMETHOD,
						  T2.PROFITDAYSBASIS PFTDAYSBASIS,
						  T1.WAVIEDAMT,
						  COALESCE(T3.CUSTID, 0) CUSTID,
						  T1.TOTFEEAMOUNT,
						  T1.BOUNCEDATE,
						  T1.REMARKS,
						  T1.RCDMAINTAINSTS,
						  T1.DEPOSITPROCESS,
						  T1.DEPOSITBRANCH,
						  T1.LPIAMOUNT,
						  T1.LPPAMOUNT,
						  T1.GSTLPIAMOUNT,
						  T1.GSTLPPAMOUNT,
						  T1.GDRAVAILABLE,
						  T1.RELEASETYPE,
						  T1.THIRDPARTYNAME,
						  T1.THIRDPARTYMOBILENUM,
						  T2.PRODUCTCATEGORY,
						  T2.PROMOTIONCODE,
						 (CASE
						WHEN T8.PAYMENTTYPE IN ('CHEQUE', 'DD') THEN T8.FAVOURNUMBER
						WHEN T8.PAYMENTTYPE IN ('CASH') THEN T8.PAYMENTREF
						ELSE T8.TRANSACTIONREF
						END) TRANSACTIONREF,
						  T1.CASHIERBRANCH,
						  T2.NEXTREPAYRVWDATE,
						  T1.INITIATEDATE,
						  T9.CODE COLLECTIONAGENTCODE,
						  T9.DESCRIPTION COLLECTIONAGENTDESC,
						  T1.MODULE,
						  T1.INSTRUCTIONUID,
						  T1.EXTREFERENCE,
						  T10.CUSTCIF CustomerCif,
						  T10.CustShrtName CustomerName,
						  T1.FINDIVISION,
						  T1.PostBranch,
						  T11.DIVISIONCODEDesc FinDivisionDesc,
						  T12.BRANCHDESC PostBranchDesc,
						  T13.BRANCHDESC CashierBranchDesc,
						  T11.EntityCode,
						  T3.CustBaseCcy,
						  T1.REASONCODE,
						  T1.CANCELREMARKS,
						  T1.KNOCKOFFTYPE
						FROM FINRECEIPTHEADER_TEMP T1
						LEFT JOIN FINANCEMAIN_TEMP T2 ON T1.REFERENCE = T2.FINREFERENCE
						LEFT JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
						LEFT JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
						LEFT JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
						LEFT JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
						LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
						LEFT JOIN FINRECEIPTDETAIL T8 ON T1.RECEIPTID = T8.RECEIPTID AND T1.RECEIPTMODE = T8.PAYMENTTYPE 
						LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
						LEFT JOIN Customers T10 ON CAST(T10.CustId AS VARCHAR(20)) = T1.REFERENCE
						LEFT JOIN SMTDIVISIONDETAIL T11 ON T1.FINDIVISION = T11.DIVISIONCODE
						LEFT JOIN RMTBranches T12 ON T1.PostBranch = T12.BranchCode
						LEFT JOIN RMTBranches T13 ON T1.CASHIERBRANCH = T13.BranchCode
						LEFT JOIN RMTCURRENCIES T14 ON T14.CCYCODE= T3.CustBaseCcy
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.18_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finreceiptheader_fview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.19_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.19" author="Gopal.p">
		<createView viewName="FINRECEIPTHEADER_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.RECEIPTID,
					T1.RECEIPTDATE,
					T1.RECEIPTTYPE,
					T1.RECAGAINST,
					T1.REFERENCE,
					T1.RECEIPTPURPOSE,
					T1.RECEIPTMODE,
					T1.EXCESSADJUSTTO,
					T1.ALLOCATIONTYPE,
					T1.RECEIPTAMOUNT,
					T1.EFFECTSCHDMETHOD,
					T1.EXTREFERENCE,
					T1.MODULE,
					T1.RECEIPTMODESTATUS,
					T1.SUBRECEIPTMODE,
					T1.RECEIPTCHANNEL,
					T1.RECEIVEDFROM,
					T1.PANNUMBER,
					T1.COLLECTIONAGENTID,
					T9.CODE COLLECTIONAGENTCODE,
					T9.DESCRIPTION COLLECTIONAGENTDESC,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T2.FINTYPE,
					T2.FINBRANCH,
					T3.CUSTCIF,
					T3.CUSTSHRTNAME,
					T2.FINCCY,
					T1.REALIZATIONDATE,
					T1.CANCELREASON,
					T4.FINTYPEDESC,
					T6.BRANCHDESC FINBRANCHDESC,
					T5.CCYDESC FINCCYDESC,
					T7.REJECTDESC CANCELREASONDESC,
					T2.FINISACTIVE,
					T1.WAVIEDAMT,
					T1.TOTFEEAMOUNT,
					T1.BOUNCEDATE,
					T1.REMARKS,
					T1.RCDMAINTAINSTS,
					T1.GDRAVAILABLE,
					T1.RELEASETYPE,
					T1.THIRDPARTYNAME,
					T1.THIRDPARTYMOBILENUM,
					T1.DEPOSITPROCESS,
					T1.DEPOSITBRANCH,
					T1.LPIAMOUNT,
					T1.LPPAMOUNT,
					T1.GSTLPIAMOUNT,
					T1.GSTLPPAMOUNT,
					(CASE
					WHEN T8.PAYMENTTYPE IN ('CHEQUE', 'DD') THEN T8.FAVOURNUMBER
					WHEN T8.PAYMENTTYPE IN ('CASH') THEN T8.PAYMENTREF
					ELSE T8.TRANSACTIONREF
					END) TRANSACTIONREF,
					T2.PRODUCTCATEGORY,
					T2.PROMOTIONCODE,
					T2.NEXTREPAYRVWDATE,
					T1.CASHIERBRANCH,
					T1.INITIATEDATE,
					T1.INSTRUCTIONUID,
					T1.FINDIVISION,
					T1.POSTBRANCH,
					T10.DIVISIONCODEDESC FINDIVISIONDESC,
					T11.BRANCHDESC POSTBRANCHDESC,
					T12.BRANCHDESC CASHIERBRANCHDESC,
					T10.ENTITYCODE,
					T1.ACTFINRECEIPT,
					T1.CANCELREMARKS,
					T1.KNOCKOFFTYPE
					FROM FINRECEIPTHEADER_TEMP T1
					INNER JOIN FINANCEMAIN T2 ON T1.REFERENCE = T2.FINREFERENCE
					INNER JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
					INNER JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
					INNER JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
					INNER JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
					LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
					LEFT JOIN FINRECEIPTDETAIL T8 ON T1.RECEIPTID = T8.RECEIPTID
					AND T1.RECEIPTMODE = T8.PAYMENTTYPE
					LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
					LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
					LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
					LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.19_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finreceiptheader_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.20_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'finreceiptheader_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.20" author="Gopal.p">
		<createView viewName="FINRECEIPTHEADER_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.RECEIPTID,
				    T1.RECEIPTDATE,
				    T1.RECEIPTTYPE,
				    T1.RECAGAINST,
				    T1.REFERENCE,
				    T1.RECEIPTPURPOSE,
				    T1.RECEIPTMODE,
				    T1.EXCESSADJUSTTO,
				    T1.ALLOCATIONTYPE,
				    T1.RECEIPTAMOUNT,
				    T1.EFFECTSCHDMETHOD,
				    T1.EXTREFERENCE,
				    T1.MODULE,
				    T1.RECEIPTMODESTATUS,
				    T1.SUBRECEIPTMODE,
				    T1.RECEIPTCHANNEL,
				    T1.RECEIVEDFROM,
				    T1.PANNUMBER,
				    T1.COLLECTIONAGENTID,
				    T9.CODE COLLECTIONAGENTCODE,
				    T9.DESCRIPTION COLLECTIONAGENTDESC,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T2.FINTYPE,
				    T2.FINBRANCH,
				    T3.CUSTCIF,
				    T3.CUSTSHRTNAME,
				    T2.FINCCY,
				    T1.REALIZATIONDATE,
				    T1.CANCELREASON,
				    T4.FINTYPEDESC,
				    T6.BRANCHDESC FINBRANCHDESC,
				    T5.CCYDESC FINCCYDESC,
				    T7.REJECTDESC CANCELREASONDESC,
				    T2.FINISACTIVE,
				    T1.WAVIEDAMT,
				    T1.TOTFEEAMOUNT,
				    T1.BOUNCEDATE,
				    T1.REMARKS,
				    T1.RCDMAINTAINSTS,
				    T1.GDRAVAILABLE,
				    T1.RELEASETYPE,
				    T1.THIRDPARTYNAME,
				    T1.THIRDPARTYMOBILENUM,
				    T1.DEPOSITPROCESS,
				    T1.DEPOSITBRANCH,
				    T1.LPIAMOUNT,
				    T1.LPPAMOUNT,
				    T1.GSTLPIAMOUNT,
				    T1.GSTLPPAMOUNT,
				    (CASE
					WHEN T8.PAYMENTTYPE IN ('CHEQUE', 'DD') THEN T8.FAVOURNUMBER
					WHEN T8.PAYMENTTYPE IN ('CASH') THEN T8.PAYMENTREF
					ELSE T8.TRANSACTIONREF
					END) TRANSACTIONREF,
				    T2.PRODUCTCATEGORY,
				    T2.PROMOTIONCODE,
				    T2.NEXTREPAYRVWDATE,
				    T1.CASHIERBRANCH,
				    T1.INITIATEDATE,
				    T1.INSTRUCTIONUID,
				    T1.FINDIVISION,
				    T1.POSTBRANCH,
				    T10.DIVISIONCODEDESC FINDIVISIONDESC,
				    T11.BRANCHDESC POSTBRANCHDESC,
				    T12.BRANCHDESC CASHIERBRANCHDESC,
				    T10.ENTITYCODE,
				    T1.ACTFINRECEIPT,
					T1.REASONCODE,
					T1.CANCELREMARKS,
					T1.KNOCKOFFTYPE
				   FROM FINRECEIPTHEADER_TEMP T1
				     JOIN FINANCEMAIN T2 ON T1.REFERENCE = T2.FINREFERENCE
				     JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				     JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				     JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				     JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				     LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				     LEFT JOIN FINRECEIPTDETAIL T8 ON T1.RECEIPTID = T8.RECEIPTID AND T1.RECEIPTMODE = T8.PAYMENTTYPE
				     LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				     LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				     LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				     LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				UNION ALL
				 SELECT T1.RECEIPTID,
				    T1.RECEIPTDATE,
				    T1.RECEIPTTYPE,
				    T1.RECAGAINST,
				    T1.REFERENCE,
				    T1.RECEIPTPURPOSE,
				    T1.RECEIPTMODE,
				    T1.EXCESSADJUSTTO,
				    T1.ALLOCATIONTYPE,
				    T1.RECEIPTAMOUNT,
				    T1.EFFECTSCHDMETHOD,
				    T1.EXTREFERENCE,
				    T1.MODULE,
				    T1.RECEIPTMODESTATUS,
				    T1.SUBRECEIPTMODE,
				    T1.RECEIPTCHANNEL,
				    T1.RECEIVEDFROM,
				    T1.PANNUMBER,
				    T1.COLLECTIONAGENTID,
				    T9.CODE COLLECTIONAGENTCODE,
				    T9.DESCRIPTION COLLECTIONAGENTDESC,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T2.FINTYPE,
				    T2.FINBRANCH,
				    T3.CUSTCIF,
				    T3.CUSTSHRTNAME,
				    T2.FINCCY,
				    T1.REALIZATIONDATE,
				    T1.CANCELREASON,
				    T4.FINTYPEDESC,
				    T6.BRANCHDESC FINBRANCHDESC,
				    T5.CCYDESC FINCCYDESC,
				    T7.REJECTDESC CANCELREASONDESC,
				    T2.FINISACTIVE,
				    T1.WAVIEDAMT,
				    T1.TOTFEEAMOUNT,
				    T1.BOUNCEDATE,
				    T1.REMARKS,
				    T1.RCDMAINTAINSTS,
				    T1.GDRAVAILABLE,
				    T1.RELEASETYPE,
				    T1.THIRDPARTYNAME,
				    T1.THIRDPARTYMOBILENUM,
				    T1.DEPOSITPROCESS,
				    T1.DEPOSITBRANCH,
				    T1.LPIAMOUNT,
				    T1.LPPAMOUNT,
				    T1.GSTLPIAMOUNT,
				    T1.GSTLPPAMOUNT,
				    (CASE
					WHEN T8.PAYMENTTYPE IN ('CHEQUE', 'DD') THEN T8.FAVOURNUMBER
					WHEN T8.PAYMENTTYPE IN ('CASH') THEN T8.PAYMENTREF
					ELSE T8.TRANSACTIONREF
					END) TRANSACTIONREF,
				    T2.PRODUCTCATEGORY,
				    T2.PROMOTIONCODE,
				    T2.NEXTREPAYRVWDATE,
				    T1.CASHIERBRANCH,
				    T1.INITIATEDATE,
				    T1.INSTRUCTIONUID,
				    T1.FINDIVISION,
				    T1.POSTBRANCH,
				    T10.DIVISIONCODEDESC FINDIVISIONDESC,
				    T11.BRANCHDESC POSTBRANCHDESC,
				    T12.BRANCHDESC CASHIERBRANCHDESC,
				    T10.ENTITYCODE,
				    T1.ACTFINRECEIPT,
					T1.REASONCODE,
					T1.CANCELREMARKS,
					T1.KNOCKOFFTYPE
				   FROM FINRECEIPTHEADER T1
				     JOIN FINANCEMAIN T2 ON T1.REFERENCE = T2.FINREFERENCE
				     JOIN CUSTOMERS T3 ON T2.CUSTID = T3.CUSTID
				     JOIN RMTFINANCETYPES T4 ON T2.FINTYPE = T4.FINTYPE
				     JOIN RMTCURRENCIES T5 ON T2.FINCCY = T5.CCYCODE
				     JOIN RMTBRANCHES T6 ON T2.FINBRANCH = T6.BRANCHCODE
				     LEFT JOIN BMTREJECTCODES T7 ON T1.CANCELREASON = T7.REJECTCODE
				     LEFT JOIN FINRECEIPTDETAIL T8 ON T1.RECEIPTID = T8.RECEIPTID AND T1.RECEIPTMODE = T8.PAYMENTTYPE
				     LEFT JOIN COLLECTIONAGENCIES T9 ON T1.COLLECTIONAGENTID = T9.ID
				     LEFT JOIN SMTDIVISIONDETAIL T10 ON T1.FINDIVISION = T10.DIVISIONCODE
				     LEFT JOIN RMTBRANCHES T11 ON T1.POSTBRANCH = T11.BRANCHCODE
				     LEFT JOIN RMTBRANCHES T12 ON T1.CASHIERBRANCH = T12.BRANCHCODE
				  WHERE NOT (EXISTS ( SELECT 1
				           FROM FINRECEIPTHEADER_TEMP
				          WHERE FINRECEIPTHEADER_TEMP.RECEIPTID = T1.RECEIPTID))
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.20_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'finreceiptheader_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.21_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'bankinfodetail_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.21" author="Gopal.p">
		<createView viewName="Bankinfodetail_Aview" replaceIfExists="true">
			<![CDATA[
				   SELECT t1.bankid,
					t1.monthyear,
					t1.balance,
					t1.debitno,
					t1.debitamt,
					t1.creditno,
					t1.creditamt,
					t1.bouncein,
					t1.bounceout,
					t1.closingbal,
					t1.sanctionlimit,
					t1.avgutilization,
					t1.peakutilizationlevel,
					t1.odcclimit,
					t1.settlementNo,
					t1.settlementCredits,
					t1.version,
					t1.lastmntby,
					t1.lastmnton,
					t1.recordstatus,
					t1.rolecode,
					t1.nextrolecode,
					t1.taskid,
					t1.nexttaskid,
					t1.recordtype,
					t1.workflowid,
					t1.interest,
					t1.trf,
					t1.totalemi,
					t1.totalsalary,
					t1.emibounceno
					FROM bankinfodetail t1
				  ]]>
		</createView>
	</changeSet>
	<changeSet id="ST#1211.21_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'bankinfodetail_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.22_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'bankinfodetail_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.22" author="Gopal.p">
		<createView viewName="Bankinfodetail_view" replaceIfExists="true">
			<![CDATA[
				SELECT t1.bankid,
				    t1.monthyear,
				    t1.balance,
				    t1.debitno,
				    t1.debitamt,
				    t1.creditno,
				    t1.creditamt,
				    t1.bouncein,
				    t1.bounceout,
				    t1.closingbal,
				    t1.sanctionlimit,
				    t1.avgutilization,
					t1.peakUtilizationLevel,
					t1.settlementNo,
					t1.settlementCredits,
				    t1.odcclimit,
				    t1.version,
				    t1.lastmntby,
				    t1.lastmnton,
				    t1.recordstatus,
				    t1.rolecode,
				    t1.nextrolecode,
				    t1.taskid,
				    t1.nexttaskid,
				    t1.recordtype,
				    t1.workflowid,
					t1.interest,
					t1.trf,
					t1.totalemi,
					t1.totalsalary,
					t1.emibounceno
				   FROM bankinfodetail_temp t1
				UNION ALL
				 SELECT t1.bankid,
				    t1.monthyear,
				    t1.balance,
				    t1.debitno,
				    t1.debitamt,
				    t1.creditno,
				    t1.creditamt,
				    t1.bouncein,
				    t1.bounceout,
				    t1.closingbal,
				    t1.sanctionlimit,
				    t1.avgutilization,
					t1.peakUtilizationLevel,
					t1.settlementNo,
					t1.settlementCredits,
				    t1.odcclimit,
				    t1.version,
				    t1.lastmntby,
				    t1.lastmnton,
				    t1.recordstatus,
				    t1.rolecode,
				    t1.nextrolecode,
				    t1.taskid,
				    t1.nexttaskid,
				    t1.recordtype,
				    t1.workflowid,
					t1.interest,
					t1.trf,
					t1.totalemi,
					t1.totalsalary,
					t1.emibounceno
				   FROM bankinfodetail t1
				  WHERE (NOT (EXISTS ( SELECT 1 AS expr1
				           FROM bankinfodetail_temp
				          WHERE ((bankinfodetail_temp.bankid = t1.bankid) AND (bankinfodetail_temp.monthyear = t1.monthyear)))))
				   ]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.22_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'bankinfodetail_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.23_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'external_liabilities_pd_view');
			]]>
		</sql>
	</changeSet>
	<changeSet id="ST#1211.23" author="Varaprasad">
		<createView viewName="external_liabilities_pd_view" replaceIfExists="true">
				<![CDATA[
				SELECT  t1.id,
					    t1.liabilityid,
					    t1.emitype,
					    t1.emiClearance,
					    t1.version,
					    t1.lastmntby,
					    t1.lastmnton,
					    t1.recordstatus,
					    t1.rolecode,
					    t1.nextrolecode,
					    t1.taskid,
					    t1.nexttaskid,
					    t1.recordtype,
					    t1.workflowid,
					    t1.emiclearedday
					   FROM external_liabilities_pd_temp t1
					UNION ALL
					 SELECT t1.id,
					    t1.liabilityid,
					    t1.emitype,
					    t1.emiClearance,
					    t1.version,
					    t1.lastmntby,
					    t1.lastmnton,
					    t1.recordstatus,
					    t1.rolecode,
					    t1.nextrolecode,
					    t1.taskid,
					    t1.nexttaskid,
					    t1.recordtype,
					    t1.workflowid,
					    t1.emiclearedday
					   FROM external_liabilities_pd t1
					  WHERE (NOT (EXISTS ( SELECT 1
					           FROM external_liabilities_pd_temp
					          WHERE (external_liabilities_pd_temp.liabilityid = t1.liabilityid))))
					  ]]>
			</createView>
	</changeSet>

	<changeSet id="ST#1211.23_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'external_liabilities_pd_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.24_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_view'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.24" author="Gopal.p">
		<createView viewName="rmtfinancetypes_view" replaceIfExists="true">
			<![CDATA[ 
				 SELECT t1.fintype,
					t1.fincategory,
					t1.fintypedesc,
					t1.finccy,
					t1.findayscaltype,
					t1.finactype,
					t1.fincontingentactype,
					t1.finisgenref,
					t1.finmaxamount,
					t1.finminamount,
					t1.finisopennewfinac,
					t1.findftstmtfrq,
					t1.finisalwmd,
					t1.finschdmthd,
					t1.finisalwgrace,
					t1.finhistretension,
					t1.equalrepayment,
					t1.finratetype,
					t1.finbaserate,
					t1.finsplrate,
					t1.finintrate,
					t1.finminrate,
					t1.finmaxrate,
					t1.findftintfrq,
					t1.finisintcpz,
					t1.fincpzfrq,
					t1.finisrvwalw,
					t1.finrvwfrq,
					t1.fingrcratetype,
					t1.fingrcbaserate,
					t1.fingrcsplrate,
					t1.fingrcintrate,
					t1.fingrcminrate,
					t1.fingrcmaxrate,
					t1.fingrcdftintfrq,
					t1.fingrcisintcpz,
					t1.fingrccpzfrq,
					t1.fingrcisrvwalw,
					t1.fingrcrvwfrq,
					t1.finminterm,
					t1.finmaxterm,
					t1.findftterms,
					t1.finrpyfrq,
					t1.finrepaymethod,
					t1.finisalwpartialrpy,
					t1.finisalwdifferment,
					t1.finmaxdifferment,
					t1.finisalwearlyrpy,
					t1.finisalwearlysettle,
					t1.finodrpytries,
					t1.finearlypayrule,
					t1.finearlysettlerule,
					t1.findepositrestrictedto,
					t1.finaebuyorinception,
					t1.finaesellormaturity,
					t1.finisactive,
					t1.version,
					t1.lastmntby,
					t1.lastmnton,
					t1.recordstatus,
					t1.rolecode,
					t1.nextrolecode,
					t1.taskid,
					t1.nexttaskid,
					t1.recordtype,
					t1.workflowid,
					t1.stepfinance,
					t1.steppingmandatory,
					t1.alwmanualsteps,
					t1.alwdsteppolicies,
					t1.dftsteppolicy,
					t4.actypedesc AS lovdescfincontingentactypename,
					t5.actypedesc AS lovdescfinactypename,
					t1.finisdwpayrequired,
					t1.finrvwrateapplfor,
					t1.finalwratechangeanydate,
					t1.finisintcpzatgrcend,
					t1.finelgrulecode,
					t1.limitelgrulecode,
					t1.finschcalcodeonrvw,
					t1.alwplandeferment,
					t1.plandefercount,
					t1.finassettype,
					t1.pftpayactype,
					t1.finisopenpftpayacc,
					t31.actypedesc AS lovdescpftpayactypename,
					t1.finisalwgrcrepay,
					t1.fingrcschdmthd,
					t1.fingrcmargin,
					t1.finmargin,
					t1.finscheduleon,
					t1.fingrcscheduleon,
					t1.fincommitmentreq,
					t1.fincollateralreq,
					t1.findepreciationreq,
					t1.findepreciationfrq,
					t1.finbankcontingentactype,
					t1.finprovisionactype,
					t38.actypedesc AS lovdescfinbankcontactypename,
					t39.actypedesc AS lovdescfinprovisionactypename,
					t1.allowriainvestment,
					t1.overridelimit,
					t1.limitrequired,
					t1.fincommitmentovrride,
					t1.fincollateralovrride,
					t1.finpftunchanged,
					t1.applyodpenalty,
					t1.odincgrcdays,
					t1.odchargetype,
					t1.odgracedays,
					t1.odchargecalon,
					t1.odchargeamtorperc,
					t1.odallowwaiver,
					t1.odmaxwaiverperc,
					t1.findivision,
					t48.divisioncodedesc AS lovdescfindivisionname,
					t48.entitycode AS lovdescentitycode,
					t1.finsuspactype,
					t49.actypedesc AS lovdescfinsuspactypename,
					t1.product,
					t1.startdate,
					t1.enddate,
					t1.allowdownpaypgm,
					t1.fintypedesc AS lovdescpromofintypedesc,
					t1.remarks,
					t1.alwearlypaymethods,
					t1.pastduepftcalmthd,
					t1.pastduepftmargin,
					t1.alwadvancerent,
					t1.grcadvbaserate,
					t1.grcadvmargin,
					t1.grcadvpftrate,
					t1.rpyadvbaserate,
					t1.rpyadvmargin,
					t1.rpyadvpftrate,
					t1.rolloverfinance,
					t1.rolloverfrq,
					t1.downpayrule,
					t59.rulecode AS downpayrulecode,
					t59.rulecodedesc AS downpayruledesc,
					t1.finsusptrigger,
					t1.finsuspremarks,
					t1.alwmultipartydisb,
					t1.collateraltype,
					t1.tdsapplicable,
					t1.manualschedule,
					t1.applygrcpricing,
					t1.grcpricingmethod,
					t1.applyrpypricing,
					t1.rpypricingmethod,
					t1.rpyhierarchy,
					t67.rulecode AS grcpricingmethoddesc,
					t68.rulecode AS rpypricingmethoddesc,
					t1.droplineod,
					t1.droppingmethod,
					t1.ratechganyday,
					t1.finrepaypftonfrq,
					t1.alwbpi,
					t1.bpitreatment,
					t1.pftdueschon,
					t1.planemihalw,
					t1.planemihmethod,
					t1.planemihmaxperyear,
					t1.planemihmax,
					t1.planemihlockperiod,
					t1.planemicpz,
					t1.unplanemihlockperiod,
					t1.unplanemicpz,
					t1.reagecpz,
					t1.fddlockperiod,
					t1.alwdrpymethods,
					t1.maxunplannedemi,
					t1.maxreageholidays,
					t1.roundingmode,
					t1.roundingtarget,
					t1.frequencydays,
					t1.quickdisb,
					t1.alwmaxdisbcheckreq,
					t1.alwreage,
					t1.alwunplanemiholiday,
					t1.profitcenterid,
					t69.profitcentercode,
					t69.profitcenterdesc,
					t1.productcategory,
					t2.productdesc AS fincategorydesc,
					t1.developerfinance,
					t1.costoffunds,
					t1.chequecapturereq,
					t1.finltvcheck,
					t1.partiallysecured,
					t1.alwadvemi,
					t1.advemiminterms,
					t1.advemimaxterms,
					t1.advemidftterms,
					t1.advemischdmthd,
					t1.bpipftdaysbasis,
					t1.eligibilitymethods,
					t1.alwhybridrate,
					t1.fixedratetenor,
					t1.odmincapamount,
					t1.odrulecode,
					t1.alwzerointacc,
					t1.autorejectiondays,
					t1.taxnomand,
					t1.putcallrequired,
					t1.grcadvintersetreq,
					t1.grcadvtype,
					t1.grcadvminterms,
					t1.grcadvmaxterms,
					t1.grcadvdefaultterms,
					t1.advintersetreq,
					t1.advtype,
					t1.advminterms,
					t1.advmaxterms,
					t1.advdefaultterms,
					t1.advstage,
					t1.dsfreq,
					t1.cashcollateralreq,
					t1.tdsallowtomodify,
					t1.tdsapplicableto,
					t1.alwvan,
					t1.vanallocationmethod,
					t1.allowdrawingpower,
					t1.allowrevolving,
					t1.alwsanctionamt,
					t1.alwsanctionamtoverride,
					t1.sanbsdschdle,
					t1.finisratervwatgrcend,
					t1.schdonpmtcal,
					t1.autoapprove,
					t1.AlwPlannedEmiInGrc,
					t1.ocrrequired,
					t1.allowedocrs,
					t1.defaultocr,
					t1.allowedloanpurposes,
					t1.specificloanpurposes,
					t1.grcadjreq,
					t1.grcperiodaftrfulldisb,
					t1.autoincrgrcenddate,
					t1.grcautoincrmonths,
					t1.maxautoincrallowed,
					t1.thrldtomaintaingrcprd,
					t1.alwloansplit,
					t1.splitloantype,
					t1.instbasedschd
				FROM rmtfinancetypes_temp t1
				LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
				LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
				LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
				LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
				LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
				LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
				LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
				LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
				LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
				LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
				LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
				LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
				UNION ALL
				  SELECT t1.fintype,
					t1.fincategory,
					t1.fintypedesc,
					t1.finccy,
					t1.findayscaltype,
					t1.finactype,
					t1.fincontingentactype,
					t1.finisgenref,
					t1.finmaxamount,
					t1.finminamount,
					t1.finisopennewfinac,
					t1.findftstmtfrq,
					t1.finisalwmd,
					t1.finschdmthd,
					t1.finisalwgrace,
					t1.finhistretension,
					t1.equalrepayment,
					t1.finratetype,
					t1.finbaserate,
					t1.finsplrate,
					t1.finintrate,
					t1.finminrate,
					t1.finmaxrate,
					t1.findftintfrq,
					t1.finisintcpz,
					t1.fincpzfrq,
					t1.finisrvwalw,
					t1.finrvwfrq,
					t1.fingrcratetype,
					t1.fingrcbaserate,
					t1.fingrcsplrate,
					t1.fingrcintrate,
					t1.fingrcminrate,
					t1.fingrcmaxrate,
					t1.fingrcdftintfrq,
					t1.fingrcisintcpz,
					t1.fingrccpzfrq,
					t1.fingrcisrvwalw,
					t1.fingrcrvwfrq,
					t1.finminterm,
					t1.finmaxterm,
					t1.findftterms,
					t1.finrpyfrq,
					t1.finrepaymethod,
					t1.finisalwpartialrpy,
					t1.finisalwdifferment,
					t1.finmaxdifferment,
					t1.finisalwearlyrpy,
					t1.finisalwearlysettle,
					t1.finodrpytries,
					t1.finearlypayrule,
					t1.finearlysettlerule,
					t1.findepositrestrictedto,
					t1.finaebuyorinception,
					t1.finaesellormaturity,
					t1.finisactive,
					t1.version,
					t1.lastmntby,
					t1.lastmnton,
					t1.recordstatus,
					t1.rolecode,
					t1.nextrolecode,
					t1.taskid,
					t1.nexttaskid,
					t1.recordtype,
					t1.workflowid,
					t1.stepfinance,
					t1.steppingmandatory,
					t1.alwmanualsteps,
					t1.alwdsteppolicies,
					t1.dftsteppolicy,
					t4.actypedesc AS lovdescfincontingentactypename,
					t5.actypedesc AS lovdescfinactypename,
					t1.finisdwpayrequired,
					t1.finrvwrateapplfor,
					t1.finalwratechangeanydate,
					t1.finisintcpzatgrcend,
					t1.finelgrulecode,
					t1.limitelgrulecode,
					t1.finschcalcodeonrvw,
					t1.alwplandeferment,
					t1.plandefercount,
					t1.finassettype,
					t1.pftpayactype,
					t1.finisopenpftpayacc,
					t31.actypedesc AS lovdescpftpayactypename,
					t1.finisalwgrcrepay,
					t1.fingrcschdmthd,
					t1.fingrcmargin,
					t1.finmargin,
					t1.finscheduleon,
					t1.fingrcscheduleon,
					t1.fincommitmentreq,
					t1.fincollateralreq,
					t1.findepreciationreq,
					t1.findepreciationfrq,
					t1.finbankcontingentactype,
					t1.finprovisionactype,
					t38.actypedesc AS lovdescfinbankcontactypename,
					t39.actypedesc AS lovdescfinprovisionactypename,
					t1.allowriainvestment,
					t1.overridelimit,
					t1.limitrequired,
					t1.fincommitmentovrride,
					t1.fincollateralovrride,
					t1.finpftunchanged,
					t1.applyodpenalty,
					t1.odincgrcdays,
					t1.odchargetype,
					t1.odgracedays,
					t1.odchargecalon,
					t1.odchargeamtorperc,
					t1.odallowwaiver,
					t1.odmaxwaiverperc,
					t1.findivision,
					t48.divisioncodedesc AS lovdescfindivisionname,
					t48.entitycode AS lovdescentitycode,
					t1.finsuspactype,
					t49.actypedesc AS lovdescfinsuspactypename,
					t1.product,
					t1.startdate,
					t1.enddate,
					t1.allowdownpaypgm,
					t1.fintypedesc AS lovdescpromofintypedesc,
					t1.remarks,
					t1.alwearlypaymethods,
					t1.pastduepftcalmthd,
					t1.pastduepftmargin,
					t1.alwadvancerent,
					t1.grcadvbaserate,
					t1.grcadvmargin,
					t1.grcadvpftrate,
					t1.rpyadvbaserate,
					t1.rpyadvmargin,
					t1.rpyadvpftrate,
					t1.rolloverfinance,
					t1.rolloverfrq,
					t1.downpayrule,
					t59.rulecode AS downpayrulecode,
					t59.rulecodedesc AS downpayruledesc,
					t1.finsusptrigger,
					t1.finsuspremarks,
					t1.alwmultipartydisb,
					t1.collateraltype,
					t1.tdsapplicable,
					t1.manualschedule,
					t1.applygrcpricing,
					t1.grcpricingmethod,
					t1.applyrpypricing,
					t1.rpypricingmethod,
					t1.rpyhierarchy,
					t67.rulecode AS grcpricingmethoddesc,
					t68.rulecode AS rpypricingmethoddesc,
					t1.droplineod,
					t1.droppingmethod,
					t1.ratechganyday,
					t1.finrepaypftonfrq,
					t1.alwbpi,
					t1.bpitreatment,
					t1.pftdueschon,
					t1.planemihalw,
					t1.planemihmethod,
					t1.planemihmaxperyear,
					t1.planemihmax,
					t1.planemihlockperiod,
					t1.planemicpz,
					t1.unplanemihlockperiod,
					t1.unplanemicpz,
					t1.reagecpz,
					t1.fddlockperiod,
					t1.alwdrpymethods,
					t1.maxunplannedemi,
					t1.maxreageholidays,
					t1.roundingmode,
					t1.roundingtarget,
					t1.frequencydays,
					t1.quickdisb,
					t1.alwmaxdisbcheckreq,
					t1.alwreage,
					t1.alwunplanemiholiday,
					t1.profitcenterid,
					t69.profitcentercode,
					t69.profitcenterdesc,
					t1.productcategory,
					t2.productdesc AS fincategorydesc,
					t1.developerfinance,
					t1.costoffunds,
					t1.chequecapturereq,
					t1.finltvcheck,
					t1.partiallysecured,
					t1.alwadvemi,
					t1.advemiminterms,
					t1.advemimaxterms,
					t1.advemidftterms,
					t1.advemischdmthd,
					t1.bpipftdaysbasis,
					t1.eligibilitymethods,
					t1.alwhybridrate,
					t1.fixedratetenor,
					t1.odmincapamount,
					t1.odrulecode,
					t1.alwzerointacc,
					t1.autorejectiondays,
					t1.taxnomand,
					t1.putcallrequired,
					t1.grcadvintersetreq,
					t1.grcadvtype,
					t1.grcadvminterms,
					t1.grcadvmaxterms,
					t1.grcadvdefaultterms,
					t1.advintersetreq,
					t1.advtype,
					t1.advminterms,
					t1.advmaxterms,
					t1.advdefaultterms,
					t1.advstage,
					t1.dsfreq,
					t1.cashcollateralreq,
					t1.tdsallowtomodify,
					t1.tdsapplicableto,
					t1.alwvan,
					t1.vanallocationmethod,
					t1.allowdrawingpower,
					t1.allowrevolving,
					t1.alwsanctionamt,
					t1.alwsanctionamtoverride,
					t1.sanbsdschdle,
					t1.finisratervwatgrcend,
					t1.schdonpmtcal,
					t1.autoapprove,
					t1.AlwPlannedEmiInGrc,
					t1.ocrrequired,
					t1.allowedocrs,
					t1.defaultocr,
					t1.allowedloanpurposes,
					t1.specificloanpurposes,
					t1.grcadjreq,
					t1.grcperiodaftrfulldisb,
					t1.autoincrgrcenddate,
					t1.grcautoincrmonths,
					t1.maxautoincrallowed,
					t1.thrldtomaintaingrcprd,
					t1.alwloansplit,
					t1.splitloantype,
					t1.instbasedschd
				FROM rmtfinancetypes t1
				LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
				LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
				LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
				LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
				LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
				LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
				LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
				LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
				LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
				LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
				LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
				LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
				WHERE NOT (EXISTS ( SELECT 1 AS expr1
				 FROM rmtfinancetypes_temp
				  WHERE rmtfinancetypes_temp.fintype = t1.fintype))
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.24_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.25_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_aview'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.25" author="Gopal.p">
		<createView viewName="rmtfinancetypes_aview" replaceIfExists="true">
		<![CDATA[ 
			SELECT t1.fintype,
			t1.fincategory,
			t1.fintypedesc,
			t1.finccy,
			t1.findayscaltype,
			t1.finactype,
			t1.fincontingentactype,
			t1.finisgenref,
			t1.finmaxamount,
			t1.finminamount,
			t1.finisopennewfinac,
			t1.findftstmtfrq,
			t1.finisalwmd,
			t1.finschdmthd,
			t1.finisalwgrace,
			t1.finhistretension,
			t1.equalrepayment,
			t1.finratetype,
			t1.finbaserate,
			t1.finsplrate,
			t1.finintrate,
			t1.finminrate,
			t1.finmaxrate,
			t1.findftintfrq,
			t1.finisintcpz,
			t1.fincpzfrq,
			t1.finisrvwalw,
			t1.finrvwfrq,
			t1.fingrcratetype,
			t1.fingrcbaserate,
			t1.fingrcsplrate,
			t1.fingrcintrate,
			t1.fingrcminrate,
			t1.fingrcmaxrate,
			t1.fingrcdftintfrq,
			t1.fingrcisintcpz,
			t1.fingrccpzfrq,
			t1.fingrcisrvwalw,
			t1.fingrcrvwfrq,
			t1.finminterm,
			t1.finmaxterm,
			t1.findftterms,
			t1.finrpyfrq,
			t1.finrepaymethod,
			t1.finisalwpartialrpy,
			t1.finisalwdifferment,
			t1.finmaxdifferment,
			t1.finisalwearlyrpy,
			t1.finisalwearlysettle,
			t1.finodrpytries,
			t1.finearlypayrule,
			t1.finearlysettlerule,
			t1.findepositrestrictedto,
			t1.finaebuyorinception,
			t1.finaesellormaturity,
			t1.finisactive,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.stepfinance,
			t1.steppingmandatory,
			t1.alwmanualsteps,
			t1.alwdsteppolicies,
			t1.dftsteppolicy,
			t4.actypedesc AS lovdescfincontingentactypename,
			t5.actypedesc AS lovdescfinactypename,
			t1.finisdwpayrequired,
			t1.finrvwrateapplfor,
			t1.finalwratechangeanydate,
			t1.finisintcpzatgrcend,
			t1.finelgrulecode,
			t1.limitelgrulecode,
			t1.finschcalcodeonrvw,
			t1.alwplandeferment,
			t1.plandefercount,
			t1.finassettype,
			t1.pftpayactype,
			t1.finisopenpftpayacc,
			t31.actypedesc AS lovdescpftpayactypename,
			t1.finisalwgrcrepay,
			t1.fingrcschdmthd,
			t1.fingrcmargin,
			t1.finmargin,
			t1.finscheduleon,
			t1.fingrcscheduleon,
			t1.fincommitmentreq,
			t1.fincollateralreq,
			t1.findepreciationreq,
			t1.findepreciationfrq,
			t1.finbankcontingentactype,
			t1.finprovisionactype,
			t38.actypedesc AS lovdescfinbankcontactypename,
			t39.actypedesc AS lovdescfinprovisionactypename,
			t1.allowriainvestment,
			t1.overridelimit,
			t1.limitrequired,
			t1.fincommitmentovrride,
			t1.fincollateralovrride,
			t1.finpftunchanged,
			t1.applyodpenalty,
			t1.odincgrcdays,
			t1.odchargetype,
			t1.odgracedays,
			t1.odchargecalon,
			t1.odchargeamtorperc,
			t1.odallowwaiver,
			t1.odmaxwaiverperc,
			t1.findivision,
			t48.divisioncodedesc AS lovdescfindivisionname,
			t48.entitycode AS lovdescentitycode,
			t1.finsuspactype,
			t49.actypedesc AS lovdescfinsuspactypename,
			t1.product,
			t1.startdate,
			t1.enddate,
			t1.allowdownpaypgm,
			t1.remarks,
			t1.alwearlypaymethods,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.alwadvancerent,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.rolloverfinance,
			t1.rolloverfrq,
			t1.downpayrule,
			t59.rulecode AS downpayrulecode,
			t59.rulecodedesc AS downpayruledesc,
			t1.finsusptrigger,
			t1.finsuspremarks,
			t1.alwmultipartydisb,
			t1.collateraltype,
			t1.tdsapplicable,
			t1.manualschedule,
			t1.applygrcpricing,
			t1.grcpricingmethod,
			t1.applyrpypricing,
			t1.rpypricingmethod,
			t1.rpyhierarchy,
			t67.rulecode AS grcpricingmethoddesc,
			t68.rulecode AS rpypricingmethoddesc,
			t1.droplineod,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.finrepaypftonfrq,
			t1.alwbpi,
			t1.bpitreatment,
			t1.pftdueschon,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.fddlockperiod,
			t1.alwdrpymethods,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.roundingmode,
			t1.roundingtarget,
			t1.frequencydays,
			t1.quickdisb,
			t1.alwreage,
			t1.alwunplanemiholiday,
			t1.alwmaxdisbcheckreq,
			t1.fintypedesc AS lovdescpromofintypedesc,
			t1.profitcenterid,
			t69.profitcentercode,
			t69.profitcenterdesc,
			t1.productcategory,
			t2.productdesc AS fincategorydesc,
			t1.developerfinance,
			t1.costoffunds,
			t1.chequecapturereq,
			t1.finltvcheck,
			t1.partiallysecured,
			t1.alwadvemi,
			t1.advemiminterms,
			t1.advemimaxterms,
			t1.advemidftterms,
			t1.advemischdmthd,
			t1.bpipftdaysbasis,
			t1.eligibilitymethods,
			t1.alwhybridrate,
			t1.fixedratetenor,
			t1.odmincapamount,
			t1.odrulecode,
			t1.alwzerointacc,
			t1.autorejectiondays,
			t1.taxnomand,
			t1.putcallrequired,
			t1.grcadvintersetreq,
			t1.grcadvtype,
			t1.grcadvminterms,
			t1.grcadvmaxterms,
			t1.grcadvdefaultterms,
			t1.advintersetreq,
			t1.advtype,
			t1.advminterms,
			t1.advmaxterms,
			t1.advdefaultterms,
			t1.advstage,
			t1.dsfreq,
			t1.cashcollateralreq,
			t1.tdsallowtomodify,
			t1.tdsapplicableto,
			t1.alwvan,
			t1.vanallocationmethod,
			t1.allowdrawingpower,
			t1.allowrevolving,
			t1.alwsanctionamt,
			t1.alwsanctionamtoverride,
			t1.sanbsdschdle,
			t1.finisratervwatgrcend,
			t1.schdonpmtcal,
			t1.autoapprove,
			t1.AlwPlannedEmiInGrc,
			t1.ocrrequired,
			t1.allowedocrs,
			t1.defaultocr,
			t1.allowedloanpurposes,
			t1.specificloanpurposes,
			t1.grcadjreq,
			t1.grcperiodaftrfulldisb,
			t1.autoincrgrcenddate,
			t1.grcautoincrmonths,
			t1.maxautoincrallowed,
			t1.thrldtomaintaingrcprd,
			t1.alwloansplit,
			t1.splitloantype,
			t1.instbasedschd
		   FROM rmtfinancetypes t1
			 LEFT JOIN bmtproduct t2 ON t1.fincategory = t2.productcode
			 LEFT JOIN rmtaccounttypes t4 ON t1.fincontingentactype = t4.actype
			 LEFT JOIN rmtaccounttypes t38 ON t1.finbankcontingentactype = t38.actype
			 LEFT JOIN rmtaccounttypes t39 ON t1.finprovisionactype = t39.actype
			 LEFT JOIN rmtaccounttypes t5 ON t1.finactype = t5.actype
			 LEFT JOIN rmtaccounttypes t31 ON t1.pftpayactype = t31.actype
			 LEFT JOIN smtdivisiondetail t48 ON t1.findivision = t48.divisioncode
			 LEFT JOIN rmtaccounttypes t49 ON t1.finsuspactype = t49.actype
			 LEFT JOIN rules t59 ON t1.downpayrule = t59.ruleid
			 LEFT JOIN rules t67 ON t1.grcpricingmethod = t67.ruleid
			 LEFT JOIN rules t68 ON t1.rpypricingmethod = t68.ruleid
			 LEFT JOIN profitcenters t69 ON t69.profitcenterid = t1.profitcenterid
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.25_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_aview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.26_pre" author="Gopal.p" dbms="postgresql">
		<sql> 
		<![CDATA[ 
			select deps_save_and_drop_dependencies ('plf', 'rmtfinancetypes_orgview'); 
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.26" author="Gopal.p">
		<createView viewName="rmtfinancetypes_orgview" replaceIfExists="true">
		<![CDATA[ 
			 SELECT t1.fintype,
			    t1.fincategory,
			    t1.fintypedesc,
			    t1.finccy,
			    t1.findayscaltype,
			    t1.finactype,
			    t1.fincontingentactype,
			    t1.finisgenref,
			    t1.finmaxamount,
			    t1.finminamount,
			    t1.finisopennewfinac,
			    t1.finisalwmd,
			    t1.finschdmthd,
			    t1.finisalwgrace,
			    t1.equalrepayment,
			    t1.finratetype,
			    t1.finbaserate,
			    t1.finsplrate,
			    t1.finintrate,
			    t1.finminrate,
			    t1.finmaxrate,
			    t1.findftintfrq,
			    t1.finisintcpz,
			    t1.fincpzfrq,
			    t1.finisrvwalw,
			    t1.finrvwfrq,
			    t1.fingrcratetype,
			    t1.fingrcbaserate,
			    t1.fingrcsplrate,
			    t1.fingrcintrate,
			    t1.fingrcminrate,
			    t1.fingrcmaxrate,
			    t1.fingrcdftintfrq,
			    t1.fingrcisintcpz,
			    t1.fingrccpzfrq,
			    t1.fingrcisrvwalw,
			    t1.fingrcrvwfrq,
			    t1.finminterm,
			    t1.finmaxterm,
			    t1.findftterms,
			    t1.finrpyfrq,
			    t1.finrepaymethod,
			    t1.finisalwdifferment,
			    t1.finmaxdifferment,
			    t1.finisactive,
			    t1.stepfinance,
			    t1.steppingmandatory,
			    t1.alwmanualsteps,
			    t1.alwdsteppolicies,
			    t1.dftsteppolicy,
			    t1.finisdwpayrequired,
			    t1.finrvwrateapplfor,
			    t1.finalwratechangeanydate,
			    t1.finisintcpzatgrcend,
			    t1.finschcalcodeonrvw,
			    t1.alwplandeferment,
			    t1.plandefercount,
			    t1.pftpayactype,
			    t1.finisopenpftpayacc,
			    t1.finisalwgrcrepay,
			    t1.fingrcschdmthd,
			    t1.fingrcmargin,
			    t1.finmargin,
			    t1.fincommitmentreq,
			    t1.fincollateralreq,
			    t1.findepreciationreq,
			    t1.findepreciationfrq,
			    t1.finbankcontingentactype,
			    t1.finprovisionactype,
			    t1.allowriainvestment,
			    t1.overridelimit,
			    t1.limitrequired,
			    t1.fincommitmentovrride,
			    t1.fincollateralovrride,
			    t1.finrepaypftonfrq,
			    t1.finpftunchanged,
			    t1.applyodpenalty,
			    t1.odincgrcdays,
			    t1.odchargetype,
			    t1.odgracedays,
			    t1.odchargecalon,
			    t1.odchargeamtorperc,
			    t1.odallowwaiver,
			    t1.odmaxwaiverperc,
			    t1.findivision,
			    t3.divisioncodedesc AS lovdescfindivisionname,
			    t1.finsuspactype,
			    t1.product,
			    t1.startdate,
			    t1.enddate,
			    t1.allowdownpaypgm,
			    t1.fintypedesc AS lovdescpromofintypedesc,
			    t1.remarks,
			    t4.policydesc AS lovdescdftsteppolicyname,
			    t1.pastduepftcalmthd,
			    t1.pastduepftmargin,
			    t1.alwadvancerent,
			    t1.grcadvbaserate,
			    t1.grcadvmargin,
			    t1.grcadvpftrate,
			    t1.rpyadvbaserate,
			    t1.rpyadvmargin,
			    t1.rpyadvpftrate,
			    t1.rolloverfinance,
			    t1.rolloverfrq,
			    t1.downpayrule,
			    t1.alwmultipartydisb,
			    t1.collateraltype,
			    t1.tdsapplicable,
			    t5.rulecode AS downpayrulecode,
			    t5.rulecodedesc AS downpayruledesc,
			    t1.applygrcpricing,
			    t1.applyrpypricing,
			    t6.rulecode AS grcpricingmethoddesc,
			    t7.rulecode AS rpypricingmethoddesc,
			    t1.droplineod,
			    t1.droppingmethod,
			    t1.ratechganyday,
			    t4.steptype AS dftsteppolicytype,
			    t1.manualschedule,
			    t1.alwbpi,
			    t1.bpitreatment,
			    t1.pftdueschon,
			    t1.planemihalw,
			    t1.planemihmethod,
			    t1.planemihmaxperyear,
			    t1.planemihmax,
			    t1.planemihlockperiod,
			    t1.planemicpz,
			    t1.unplanemihlockperiod,
			    t1.unplanemicpz,
			    t1.reagecpz,
			    t1.fddlockperiod,
			    t1.alwdrpymethods,
			    t1.maxunplannedemi,
			    t1.maxreageholidays,
			    t1.roundingmode,
			    t1.roundingtarget,
			    t1.frequencydays,
			    t1.quickdisb,
			    t1.alwreage,
			    t1.alwunplanemiholiday,
			    t1.alwmaxdisbcheckreq,
			    t1.productcategory,
			    t1.rpyhierarchy,
			    t1.developerfinance,
			    t3.entitycode AS lovdescentitycode,
			    t8.entitydesc AS lovdescentitydesc,
			    t1.costoffunds,
			    t1.chequecapturereq,
			    t1.finltvcheck,
			    t1.partiallysecured,
			    t1.alwadvemi,
			    t1.advemiminterms,
			    t1.advemimaxterms,
			    t1.advemidftterms,
			    t1.advemischdmthd,
			    t1.bpipftdaysbasis,
			    t1.eligibilitymethods,
			    t1.alwhybridrate,
			    t1.fixedratetenor,
			    t1.odmincapamount,
			    t1.odrulecode,
			    t1.alwzerointacc,
			    t1.finisalwpartialrpy,
			    t1.autorejectiondays,
			    t1.taxnomand,
			    t1.putcallrequired,
			    t1.grcadvintersetreq,
			    t1.grcadvtype,
			    t1.grcadvminterms,
			    t1.grcadvmaxterms,
			    t1.grcadvdefaultterms,
			    t1.advintersetreq,
			    t1.advtype,
			    t1.advminterms,
			    t1.advmaxterms,
			    t1.advdefaultterms,
			    t1.advstage,
			    t1.dsfreq,
			    t1.cashcollateralreq,
			    t1.alwearlypaymethods,
			    t1.tdsallowtomodify,
			    t1.tdsapplicableto,
			    t1.alwvan,
			    t1.vanallocationmethod,
			    t1.allowdrawingpower,
			    t1.allowrevolving,
			    t1.alwsanctionamt,
			    t1.alwsanctionamtoverride,
			    t1.sanbsdschdle,
			    t1.finisratervwatgrcend,
			    t1.schdonpmtcal,
			    t1.autoapprove,
			    t1.ocrrequired,
				t1.allowedocrs,
				t1.defaultocr,
				t1.allowedloanpurposes,
				t1.specificloanpurposes,
				t1.grcadjreq,
				t1.grcperiodaftrfulldisb,
				t1.autoincrgrcenddate,
				t1.grcautoincrmonths,
				t1.maxautoincrallowed,
				t1.thrldtomaintaingrcprd,
				t1.alwloansplit,
				t1.splitloantype,
				t1.instbasedschd,
			    t1.alwplannedemiingrc
			    FROM rmtfinancetypes t1
			    JOIN smtdivisiondetail t3 ON t1.findivision = t3.divisioncode
			    LEFT JOIN steppolicyheader t4 ON t1.dftsteppolicy = t4.policycode
			    LEFT JOIN rules t5 ON t1.downpayrule = t5.ruleid
			    LEFT JOIN rules t6 ON t1.grcpricingmethod = t6.ruleid
			    LEFT JOIN rules t7 ON t1.rpypricingmethod = t7.ruleid
			    LEFT JOIN entity t8 ON t3.entitycode = t8.entitycode
				]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.26_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
					select deps_restore_dependencies ('plf', 'rmtfinancetypes_orgview');	
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.27_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'financeenquiry_view');
		 	]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.27" author="Gopal.p">
		<createView viewName="FINANCEENQUIRY_VIEW" replaceIfExists="true">
		  <![CDATA[
				SELECT T1.FINREFERENCE,
					  T1.FINBRANCH,
					  T1.FINTYPE,
					  T1.FINCCY,
					  T1.SCHEDULEMETHOD,
					  T1.PROFITDAYSBASIS,
					  T1.FINSTARTDATE,
					  T1.CALTERMS NUMBEROFTERMS,
					  T1.CUSTID,
					  T1.FINAMOUNT,
					  T1.GRCPERIODENDDATE,
					  T1.MATURITYDATE,
					  T1.FINREPAYMENTAMOUNT,
					  T1.FINISACTIVE,
					  T1.ALLOWGRCPERIOD,
					  T1.DOWNPAYMENT,
					  T1.MIGRATEDFINANCE,
					  T1.LASTREPAYDATE,
					  T1.LASTREPAYPFTDATE,
					  T1.FINCURRASSETVALUE,
					  T1.BLACKLISTED,
					  T1.FEECHARGEAMT,
					  T1.CLOSINGSTATUS,
					  T1.GRACETERMS,
					  T1.ALWMULTIDISB,
					  T1.DEFFERMENTS,
					  T1.FINSTATUS ,
					  T1.MANDATEID,
					  T1.FINREPAYMETHOD,
					  T1.FINASSETVALUE,
					  T1.INSURANCEAMT,
					  T1.SANBSDSCHDLE,
					  T1.PROMOTIONSEQID,
					  T1.SVAMOUNT,
					  T1.CBAMOUNT,
					  (T1.FINCURRASSETVALUE+ T1.FEECHARGEAMT+T1.INSURANCEAMT) FINANCINGAMOUNT,
					  (T1.FINCURRASSETVALUE- T1.FINREPAYMENTAMOUNT+ T1.FEECHARGEAMT+T1.INSURANCEAMT) CURFINAMOUNT,
					  T2.FINTYPEDESC LOVDESCFINTYPENAME,
					  T2.FINSCHEDULEON LOVDESCFINSCHEDULEON,
					  T2.FINDIVISION LOVDESCFINDIVISION,
					  T2.FINCATEGORY LOVDESCPRODUCTCODENAME,
					  T2.FINISALWDIFFERMENT LOVDESCFINALWDEFERMENT,
					  T3.CUSTCIF LOVDESCCUSTCIF,
					  T3.CUSTSHRTNAME LOVDESCCUSTSHRTNAME,
					  T4.BRANCHDESC LOVDESCFINBRANCHNAME,
					  T5.CUSTTYPECTG,
					  COALESCE(T9.NOINST,0) NOINST,
					  T1.FINOCRREQUIRED,
					  T1.ALWGRCADJ,
					  T1.ENDGRCPERIODAFTRFULLDISB,
					  T1.AUTOINCGRCENDDATE,
					  T1.RECORDSTATUS,
					  T1.TOTALCPZ
					  FROM FINANCEMAIN T1
				INNER JOIN RMTFINANCETYPES T2 ON T1.FINTYPE = T2.FINTYPE
				INNER JOIN CUSTOMERS T3 ON T1.CUSTID = T3.CUSTID
				INNER JOIN RMTBRANCHES T4 ON T1.FINBRANCH = T4.BRANCHCODE
				INNER JOIN RMTCUSTTYPES T5 ON T3.CUSTTYPECODE = T5.CUSTTYPECODE
				LEFT JOIN FINPFTDETAILS T9 ON T1.FINREFERENCE = T9.FINREFERENCE
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.27_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'financeenquiry_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.28_pre" author="Gopal.p" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies('plf','customers_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.28" author="Gopal.p">
		<createView viewName="customers_view" replaceIfExists="true">
		<![CDATA[
			 SELECT t1.custid,
			    t1.custcif,
			    t1.custcorebank,
			    t1.custctgcode,
			    t1.custtypecode,
			    t1.custsalutationcode,
			    t1.custfname,
			    t1.custmname,
			    t1.custlname,
			    t1.custshrtname,
			    t1.custfnamelcllng,
			    t1.custmnamelcllng,
			    t1.custlnamelcllng,
			    t1.custshrtnamelcllng,
			    t1.custdftbranch,
			    t1.custgendercode,
			    t1.custdob,
			    t1.custpob,
			    t1.custcob,
			    t1.custpassportno,
			    t1.custmothermaiden,
			    t1.custisminor,
			    t1.custreferedby,
			    t1.custdsa,
			    t1.custdsadept,
			    t1.custro1,
			    t1.custro2,
			    t1.custgroupid,
			    t1.custsts,
			    t1.custstschgdate,
			    t1.custgroupsts,
			    t1.custisblocked,
			    t1.custisactive,
			    t1.custisclosed,
			    t1.custinactivereason,
			    t1.custisdecease,
			    t1.custisdormant,
			    t1.custisdelinquent,
			    t1.custistradefincust,
			    t1.custtradelicencenum,
			    t1.custtradelicenceexpiry,
			    t1.custpassportexpiry,
			    t1.custvisanum,
			    t1.custvisaexpiry,
			    t1.custisstaff,
			    t1.custstaffid,
			    t1.custindustry,
			    t1.custsector,
			    t1.custsubsector,
			    t1.custprofession,
			    t1.custtotalincome,
			    t1.custmaritalsts,
			    t1.custempsts,
			    t1.custsegment,
			    t1.custsubsegment,
			    t1.custisblacklisted,
			    t1.custblrsncode,
			    t1.custisrejected,
			    t1.custrejectedrsn,
			    t1.custbaseccy,
			    t1.custlng,
			    t1.custparentcountry,
			    t1.custresdcountry,
			    t1.custriskcountry,
			    t1.custnationality,
			    t1.custclosedon,
			    t1.custstmtfrq,
			    t1.custisstmtcombined,
			    t1.custstmtlastdate,
			    t1.custstmtnextdate,
			    t1.custstmtdispatchmode,
			    t1.custfirstbusinessdate,
			    t1.custaddlvar81,
			    t1.custaddlvar82,
			    t1.custaddlvar83,
			    t1.custaddlvar84,
			    t1.custaddlvar85,
			    t1.custaddlvar86,
			    t1.custaddlvar87,
			    t1.custaddlvar88,
			    t1.custaddlvar89,
			    t1.custaddldate1,
			    t1.custaddldate2,
			    t1.custaddldate3,
			    t1.custaddldate4,
			    t1.custaddldate5,
			    t1.custaddlvar1,
			    t1.custaddlvar2,
			    t1.custaddlvar3,
			    t1.custaddlvar4,
			    t1.custaddlvar5,
			    t1.custaddlvar6,
			    t1.custaddlvar7,
			    t1.custaddlvar8,
			    t1.custaddlvar9,
			    t1.custaddlvar10,
			    t1.custaddlvar11,
			    t1.custaddldec1,
			    t1.custaddldec2,
			    t1.custaddldec3,
			    t1.custaddldec4,
			    t1.custaddldec5,
			    t1.custaddlint1,
			    t1.custaddlint2,
			    t1.custaddlint3,
			    t1.custaddlint4,
			    t1.custaddlint5,
			    t1.custsourceid,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.custtypedesc lovdesccusttypecodename,
			    t3.maritalstsdesc lovdesccustmaritalstsname,
			    t4.empstsdesc lovdesccustempstsname,
			    t6.custstsdescription lovdesccuststsname,
			    t7.industrydesc lovdesccustindustryname,
			    t8.sectordesc lovdesccustsectorname,
			    t9.subsectordesc lovdesccustsubsectorname,
			    t10.professiondesc lovdesccustprofessionname,
			    t11.countrydesc lovdesccustcobname,
			    t20.segmentdesc lovdesccustsegmentname,
			    t12.nationalitydesc lovdesccustnationalityname,
			    t13.genderdesc lovdesccustgendercodename,
			    t14.deptdesc lovdesccustdsadeptname,
			    t15.dealername lovdesccustro1name,
			    t15.dealercity lovdesccustro1city,
			    t16.grpstsdescription lovdesccustgroupstsname,
			    t17.branchdesc lovdesccustdftbranchname,
			    t17.bankrefno branchrefno,
			    t17.branchswiftbrncde custswiftbrncode,
			    t18.custctgdesc lovdesccustctgcodename,
			    t2.custtypectg lovdesccustctgtype,
			    t19.saluationdesc lovdesccustsalutationcodename,
			    t21.countrydesc lovdesccustparentcountryname,
			    t22.countrydesc lovdesccustresdcountryname,
			    t23.countrydesc lovdesccustriskcountryname,
			    t24.rofficerdesc lovdesccustro2name,
			    t25.blrsndesc lovdesccustblrsncodename,
			    t26.rejectdesc lovdesccustrejectedrsnname,
			    t27.custgrpdesc lovdesccustgroupidname,
			    t28.subsegmentdesc lovdesccustsubsegmentname,
			    t29.lngdesc lovdesccustlngname,
			    t30.dispatchmodedesc lovdescdispatchmodedescname,
			    t1.dedupfound,
			    t1.skipdedup,
			    t1.custtotalexpense,
			    t1.custblacklistdate,
			    t1.noofdependents,
			    t1.custcrcpr,
			    t1.jointcust,
			    t1.jointcustname,
			    t1.jointcustdob,
			    t27.custgrpcode lovdesccustgroupcode,
			    t1.custrelation,
			    t1.contactpersonname,
			    t1.phonenumber,
			    t1.emailid,
			    t1.salariedcustomer,
			    t31.targetdesc lovdesctargetname,
			    t1.custsuspsts,
			    t1.custsuspdate,
			    t1.custsusptrigger,
			    t1.subcategory,
			    t1.casteid,
			    t1.religionid,
			    t32.castecode,
			    t32.castedesc,
			    t33.religioncode,
			    t33.religiondesc,
			    COALESCE(t34.roledesc, ${add.schema}fn_get_roledesc(t1.nextrolecode)) lovdescrequeststage,
			    t1.margindeviation,
			    t1.applicationno,
			    t17.branchprovince,
			    t1.dnd,
			    t1.ResidentialStatus,
			    t1.othercaste,
				t1.otherreligion,
				t1.natureofbusiness,
				t1.entitytype,
				t1.custresidentialsts,
				t1.qualification,
				t1.custflag,
				t1.vip,
				t35.description lovdescqualification
			   FROM customers_temp t1
			     LEFT JOIN rmtcusttypes t2 ON t1.custtypecode = t2.custtypecode
			     LEFT JOIN bmtmaritalstatuscodes t3 ON t1.custmaritalsts = t3.maritalstscode
			     LEFT JOIN bmtempstscodes t4 ON t1.custempsts = t4.empstscode
			     LEFT JOIN bmtcuststatuscodes t6 ON t1.custsts = t6.custstscode
			     LEFT JOIN bmtindustries t7 ON t1.custindustry = t7.industrycode
			     LEFT JOIN bmtsectors t8 ON t1.custsector = t8.sectorcode
			     LEFT JOIN bmtsubsectors t9 ON t1.custsector = t9.sectorcode AND t1.custsubsector = t9.subsectorcode
			     LEFT JOIN bmtprofessions t10 ON t1.custprofession = t10.professioncode
			     LEFT JOIN bmtcountries t11 ON t1.custcob = t11.countrycode
			     LEFT JOIN bmtnationalitycodes t12 ON t1.custnationality = t12.nationalitycode
			     LEFT JOIN bmtgenders t13 ON t1.custgendercode = t13.gendercode
			     LEFT JOIN bmtdepartments t14 ON t1.custdsadept = t14.deptcode
			     LEFT JOIN amtvehicledealer t15 ON t1.custro1 = t15.dealerid
			     LEFT JOIN bmtgrpstatuscodes t16 ON t1.custgroupsts = t16.grpstscode
			     LEFT JOIN rmtbranches t17 ON t1.custdftbranch = t17.branchcode
			     LEFT JOIN bmtcustcategories t18 ON t1.custctgcode = t18.custctgcode
			     LEFT JOIN bmtsalutations t19 ON t1.custsalutationcode = t19.salutationcode
			     LEFT JOIN bmtsegments t20 ON t1.custsegment = t20.segmentcode
			     LEFT JOIN bmtcountries t21 ON t1.custparentcountry = t21.countrycode
			     LEFT JOIN bmtcountries t22 ON t1.custresdcountry = t22.countrycode
			     LEFT JOIN bmtcountries t23 ON t1.custriskcountry = t23.countrycode
			     LEFT JOIN relationshipofficers t24 ON t1.custro2 = t24.rofficercode
			     LEFT JOIN bmtblacklistrsncodes t25 ON t1.custblrsncode = t25.blrsncode
			     LEFT JOIN bmtrejectcodes t26 ON t1.custrejectedrsn = t26.rejectcode
			     LEFT JOIN customergroups t27 ON t1.custgroupid = t27.custgrpid
			     LEFT JOIN bmtsubsegments t28 ON t1.custsubsegment = t28.subsegmentcode
			     LEFT JOIN bmtlanguage t29 ON t1.custlng = t29.lngcode
			     LEFT JOIN bmtdispatchmodes t30 ON t1.custstmtdispatchmode = t30.dispatchmodecode
			     LEFT JOIN targetdetails t31 ON t1.custaddlvar82 = t31.targetcode
			     LEFT JOIN secroles t34 ON t1.nextrolecode = t34.rolecd
			     LEFT JOIN caste t32 ON t1.casteid = t32.casteid
			     LEFT JOIN religion t33 ON t1.religionid = t33.religionid
			     LEFT JOIN qualification t35 ON t1.qualification= t35.code
			UNION ALL
				 SELECT t1.custid,
				    t1.custcif,
				    t1.custcorebank,
				    t1.custctgcode,
				    t1.custtypecode,
				    t1.custsalutationcode,
				    t1.custfname,
				    t1.custmname,
				    t1.custlname,
				    t1.custshrtname,
				    t1.custfnamelcllng,
				    t1.custmnamelcllng,
				    t1.custlnamelcllng,
				    t1.custshrtnamelcllng,
				    t1.custdftbranch,
				    t1.custgendercode,
				    t1.custdob,
				    t1.custpob,
				    t1.custcob,
				    t1.custpassportno,
				    t1.custmothermaiden,
				    t1.custisminor,
				    t1.custreferedby,
				    t1.custdsa,
				    t1.custdsadept,
				    t1.custro1,
				    t1.custro2,
				    t1.custgroupid,
				    t1.custsts,
				    t1.custstschgdate,
				    t1.custgroupsts,
				    t1.custisblocked,
				    t1.custisactive,
				    t1.custisclosed,
				    t1.custinactivereason,
				    t1.custisdecease,
				    t1.custisdormant,
				    t1.custisdelinquent,
				    t1.custistradefincust,
				    t1.custtradelicencenum,
				    t1.custtradelicenceexpiry,
				    t1.custpassportexpiry,
				    t1.custvisanum,
				    t1.custvisaexpiry,
				    t1.custisstaff,
				    t1.custstaffid,
				    t1.custindustry,
				    t1.custsector,
				    t1.custsubsector,
				    t1.custprofession,
				    t1.custtotalincome,
				    t1.custmaritalsts,
				    t1.custempsts,
				    t1.custsegment,
				    t1.custsubsegment,
				    t1.custisblacklisted,
				    t1.custblrsncode,
				    t1.custisrejected,
				    t1.custrejectedrsn,
				    t1.custbaseccy,
				    t1.custlng,
				    t1.custparentcountry,
				    t1.custresdcountry,
				    t1.custriskcountry,
				    t1.custnationality,
				    t1.custclosedon,
				    t1.custstmtfrq,
				    t1.custisstmtcombined,
				    t1.custstmtlastdate,
				    t1.custstmtnextdate,
				    t1.custstmtdispatchmode,
				    t1.custfirstbusinessdate,
				    t1.custaddlvar81,
				    t1.custaddlvar82,
				    t1.custaddlvar83,
				    t1.custaddlvar84,
				    t1.custaddlvar85,
				    t1.custaddlvar86,
				    t1.custaddlvar87,
				    t1.custaddlvar88,
				    t1.custaddlvar89,
				    t1.custaddldate1,
				    t1.custaddldate2,
				    t1.custaddldate3,
				    t1.custaddldate4,
				    t1.custaddldate5,
				    t1.custaddlvar1,
				    t1.custaddlvar2,
				    t1.custaddlvar3,
				    t1.custaddlvar4,
				    t1.custaddlvar5,
				    t1.custaddlvar6,
				    t1.custaddlvar7,
				    t1.custaddlvar8,
				    t1.custaddlvar9,
				    t1.custaddlvar10,
				    t1.custaddlvar11,
				    t1.custaddldec1,
				    t1.custaddldec2,
				    t1.custaddldec3,
				    t1.custaddldec4,
				    t1.custaddldec5,
				    t1.custaddlint1,
				    t1.custaddlint2,
				    t1.custaddlint3,
				    t1.custaddlint4,
				    t1.custaddlint5,
				    t1.custsourceid,
				    t1.version,
				    t1.lastmntby,
				    t1.lastmnton,
				    t1.recordstatus,
				    t1.rolecode,
				    t1.nextrolecode,
				    t1.taskid,
				    t1.nexttaskid,
				    t1.recordtype,
				    t1.workflowid,
				    t2.custtypedesc lovdesccusttypecodename,
				    t3.maritalstsdesc lovdesccustmaritalstsname,
				    t4.empstsdesc lovdesccustempstsname,
				    t6.custstsdescription lovdesccuststsname,
				    t7.industrydesc lovdesccustindustryname,
				    t8.sectordesc lovdesccustsectorname,
				    t9.subsectordesc lovdesccustsubsectorname,
				    t10.professiondesc lovdesccustprofessionname,
				    t11.countrydesc lovdesccustcobname,
				    t20.segmentdesc lovdesccustsegmentname,
				    t12.nationalitydesc lovdesccustnationalityname,
				    t13.genderdesc lovdesccustgendercodename,
				    t14.deptdesc lovdesccustdsadeptname,
				    t15.dealername lovdesccustro1name,
				    t15.dealercity lovdesccustro1city,
				    t16.grpstsdescription lovdesccustgroupstsname,
				    t17.branchdesc lovdesccustdftbranchname,
				    t17.bankrefno branchrefno,
				    t17.branchswiftbrncde custswiftbrncode,
				    t18.custctgdesc lovdesccustctgcodename,
				    t2.custtypectg lovdesccustctgtype,
				    t19.saluationdesc lovdesccustsalutationcodename,
				    t21.countrydesc lovdesccustparentcountryname,
				    t22.countrydesc lovdesccustresdcountryname,
				    t23.countrydesc lovdesccustriskcountryname,
				    t24.rofficerdesc lovdesccustro2name,
				    t25.blrsndesc lovdesccustblrsncodename,
				    t26.rejectdesc lovdesccustrejectedrsnname,
				    t27.custgrpdesc lovdesccustgroupidname,
				    t28.subsegmentdesc lovdesccustsubsegmentname,
				    t29.lngdesc lovdesccustlngname,
				    t30.dispatchmodedesc lovdescdispatchmodedescname,
				    t1.dedupfound,
				    t1.skipdedup,
				    t1.custtotalexpense,
				    t1.custblacklistdate,
				    t1.noofdependents,
				    t1.custcrcpr,
				    t1.jointcust,
				    t1.jointcustname,
				    t1.jointcustdob,
				    t27.custgrpcode lovdesccustgroupcode,
				    t1.custrelation,
				    t1.contactpersonname,
				    t1.phonenumber,
				    t1.emailid,
				    t1.salariedcustomer,
				    t31.targetdesc lovdesctargetname,
				    t1.custsuspsts,
				    t1.custsuspdate,
				    t1.custsusptrigger,
				    t1.subcategory,
				    t1.casteid,
				    t1.religionid,
				    t32.castecode,
				    t32.castedesc,
				    t33.religioncode,
				    t33.religiondesc,
				    COALESCE(t34.roledesc, ${add.schema}fn_get_roledesc(t1.nextrolecode)) lovdescrequeststage,
				    t1.margindeviation,
				    t1.applicationno,
				    t17.branchprovince,
				    t1.dnd,
				    t1.ResidentialStatus,
				    t1.othercaste,
					t1.otherreligion,
					t1.natureofbusiness,
					t1.entitytype,
					t1.custresidentialsts,
					t1.qualification,
					t1.custflag,
					t1.vip,
					t35.description lovdescqualification
				   FROM customers t1
				     LEFT JOIN rmtcusttypes t2 ON t1.custtypecode = t2.custtypecode
				     LEFT JOIN bmtmaritalstatuscodes t3 ON t1.custmaritalsts = t3.maritalstscode
				     LEFT JOIN bmtempstscodes t4 ON t1.custempsts = t4.empstscode
				     LEFT JOIN bmtcuststatuscodes t6 ON t1.custsts = t6.custstscode
				     LEFT JOIN bmtindustries t7 ON t1.custindustry = t7.industrycode
				     LEFT JOIN bmtsectors t8 ON t1.custsector = t8.sectorcode
				     LEFT JOIN bmtsubsectors t9 ON t1.custsector = t9.sectorcode AND t1.custsubsector = t9.subsectorcode
				     LEFT JOIN bmtprofessions t10 ON t1.custprofession = t10.professioncode
				     LEFT JOIN bmtcountries t11 ON t1.custcob = t11.countrycode
				     LEFT JOIN bmtnationalitycodes t12 ON t1.custnationality = t12.nationalitycode
				     LEFT JOIN bmtgenders t13 ON t1.custgendercode = t13.gendercode
				     LEFT JOIN bmtdepartments t14 ON t1.custdsadept = t14.deptcode
				     LEFT JOIN amtvehicledealer t15 ON t1.custro1 = t15.dealerid
				     LEFT JOIN bmtgrpstatuscodes t16 ON t1.custgroupsts = t16.grpstscode
				     LEFT JOIN rmtbranches t17 ON t1.custdftbranch = t17.branchcode
				     LEFT JOIN bmtcustcategories t18 ON t1.custctgcode = t18.custctgcode
				     LEFT JOIN bmtsalutations t19 ON t1.custsalutationcode = t19.salutationcode
				     LEFT JOIN bmtsegments t20 ON t1.custsegment = t20.segmentcode
				     LEFT JOIN bmtcountries t21 ON t1.custparentcountry = t21.countrycode
				     LEFT JOIN bmtcountries t22 ON t1.custresdcountry = t22.countrycode
				     LEFT JOIN bmtcountries t23 ON t1.custriskcountry = t23.countrycode
				     LEFT JOIN relationshipofficers t24 ON t1.custro2 = t24.rofficercode
				     LEFT JOIN bmtblacklistrsncodes t25 ON t1.custblrsncode = t25.blrsncode
				     LEFT JOIN bmtrejectcodes t26 ON t1.custrejectedrsn = t26.rejectcode
				     LEFT JOIN customergroups t27 ON t1.custgroupid = t27.custgrpid
				     LEFT JOIN bmtsubsegments t28 ON t1.custsubsegment = t28.subsegmentcode
				     LEFT JOIN bmtlanguage t29 ON t1.custlng = t29.lngcode
				     LEFT JOIN bmtdispatchmodes t30 ON t1.custstmtdispatchmode = t30.dispatchmodecode
				     LEFT JOIN targetdetails t31 ON t1.custaddlvar82 = t31.targetcode
				     LEFT JOIN secroles t34 ON t1.nextrolecode = t34.rolecd
				     LEFT JOIN caste t32 ON t1.casteid = t32.casteid
				     LEFT JOIN religion t33 ON t1.religionid = t33.religionid
				     LEFT JOIN qualification t35 ON t1.qualification= t35.code
				  WHERE NOT (EXISTS ( SELECT 1 AS expr1
				           FROM customers_temp
				          WHERE customers_temp.custid = t1.custid))
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.28_post" author="Gopal.p" dbms="postgresql">
		<sql>
			select deps_restore_dependencies('plf','customers_view');
		</sql>
	</changeSet>

	<changeSet id="ST#1211.29_pre" author="Gopal.p" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies('plf','customers_tview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.29" author="Gopal.p">
		<createView viewName="customers_tview" replaceIfExists="true">
			<![CDATA[
			SELECT t1.custid,
			    t1.custcif,
			    t1.custcorebank,
			    t1.custctgcode,
			    t1.custtypecode,
			    t1.custsalutationcode,
			    t1.custfname,
			    t1.custmname,
			    t1.custlname,
			    t1.custshrtname,
			    t1.custfnamelcllng,
			    t1.custmnamelcllng,
			    t1.custlnamelcllng,
			    t1.custshrtnamelcllng,
			    t1.custdftbranch,
			    t1.custgendercode,
			    t1.custdob,
			    t1.custpob,
			    t1.custcob,
			    t1.custpassportno,
			    t1.custmothermaiden,
			    t1.custisminor,
			    t1.custreferedby,
			    t1.custdsa,
			    t1.custdsadept,
			    t1.custro1,
			    t1.custro2,
			    t1.custgroupid,
			    t1.custsts,
			    t1.custstschgdate,
			    t1.custgroupsts,
			    t1.custisblocked,
			    t1.custisactive,
			    t1.custisclosed,
			    t1.custinactivereason,
			    t1.custisdecease,
			    t1.custisdormant,
			    t1.custisdelinquent,
			    t1.custistradefincust,
			    t1.custtradelicencenum,
			    t1.custtradelicenceexpiry,
			    t1.custpassportexpiry,
			    t1.custvisanum,
			    t1.custvisaexpiry,
			    t1.custisstaff,
			    t1.custstaffid,
			    t1.custindustry,
			    t1.custsector,
			    t1.custsubsector,
			    t1.custprofession,
			    t1.custtotalincome,
			    t1.custmaritalsts,
			    t1.custempsts,
			    t1.custsegment,
			    t1.custsubsegment,
			    t1.custisblacklisted,
			    t1.custblrsncode,
			    t1.custisrejected,
			    t1.custrejectedrsn,
			    t1.custbaseccy,
			    t1.custlng,
			    t1.custparentcountry,
			    t1.custresdcountry,
			    t1.custriskcountry,
			    t1.custnationality,
			    t1.custclosedon,
			    t1.custstmtfrq,
			    t1.custisstmtcombined,
			    t1.custstmtlastdate,
			    t1.custstmtnextdate,
			    t1.custstmtdispatchmode,
			    t1.custfirstbusinessdate,
			    t1.custaddlvar81,
			    t1.custaddlvar82,
			    t1.custaddlvar83,
			    t1.custaddlvar84,
			    t1.custaddlvar85,
			    t1.custaddlvar86,
			    t1.custaddlvar87,
			    t1.custaddlvar88,
			    t1.custaddlvar89,
			    t1.custaddldate1,
			    t1.custaddldate2,
			    t1.custaddldate3,
			    t1.custaddldate4,
			    t1.custaddldate5,
			    t1.custaddlvar1,
			    t1.custaddlvar2,
			    t1.custaddlvar3,
			    t1.custaddlvar4,
			    t1.custaddlvar5,
			    t1.custaddlvar6,
			    t1.custaddlvar7,
			    t1.custaddlvar8,
			    t1.custaddlvar9,
			    t1.custaddlvar10,
			    t1.custaddlvar11,
			    t1.custaddldec1,
			    t1.custaddldec2,
			    t1.custaddldec3,
			    t1.custaddldec4,
			    t1.custaddldec5,
			    t1.custaddlint1,
			    t1.custaddlint2,
			    t1.custaddlint3,
			    t1.custaddlint4,
			    t1.custaddlint5,
			    t1.custsourceid,
			    t1.version,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.custtypedesc lovdesccusttypecodename,
			    t3.maritalstsdesc lovdesccustmaritalstsname,
			    t4.empstsdesc lovdesccustempstsname,
			    t6.custstsdescription lovdesccuststsname,
			    t7.industrydesc lovdesccustindustryname,
			    t8.sectordesc lovdesccustsectorname,
			    t9.subsectordesc lovdesccustsubsectorname,
			    t10.professiondesc lovdesccustprofessionname,
			    t11.countrydesc lovdesccustcobname,
			    t20.segmentdesc lovdesccustsegmentname,
			    t12.nationalitydesc lovdesccustnationalityname,
			    t13.genderdesc lovdesccustgendercodename,
			    t14.deptdesc lovdesccustdsadeptname,
			    t15.dealername lovdesccustro1name,
			    t15.dealercity lovdesccustro1city,
			    t16.grpstsdescription lovdesccustgroupstsname,
			    t17.branchdesc lovdesccustdftbranchname,
			    t17.bankrefno branchrefno,
			    t17.branchswiftbrncde custswiftbrncode,
			    t18.custctgdesc lovdesccustctgcodename,
			    t2.custtypectg lovdesccustctgtype,
			    t19.saluationdesc lovdesccustsalutationcodename,
			    t21.countrydesc lovdesccustparentcountryname,
			    t22.countrydesc lovdesccustresdcountryname,
			    t23.countrydesc lovdesccustriskcountryname,
			    t24.rofficerdesc lovdesccustro2name,
			    t25.blrsndesc lovdesccustblrsncodename,
			    t26.rejectdesc lovdesccustrejectedrsnname,
			    t27.custgrpdesc lovdesccustgroupidname,
			    t28.subsegmentdesc lovdesccustsubsegmentname,
			    t29.lngdesc lovdesccustlngname,
			    t30.dispatchmodedesc lovdescdispatchmodedescname,
			    t1.dedupfound,
			    t1.skipdedup,
			    t1.custtotalexpense,
			    t1.custblacklistdate,
			    t1.noofdependents,
			    t1.custcrcpr,
			    t1.jointcust,
			    t1.jointcustname,
			    t1.jointcustdob,
			    t27.custgrpcode lovdesccustgroupcode,
			    t1.contactpersonname,
			    t1.phonenumber,
			    t1.emailid,
			    t1.salariedcustomer,
			    t31.targetdesc lovdesctargetname,
			    t1.custrelation,
			    t1.custsuspsts,
			    t1.custsuspdate,
			    t1.custsusptrigger,
			    t1.subcategory,
			    t1.casteid,
			    t1.religionid,
			    t32.castecode,
			    t32.castedesc,
			    t33.religioncode,
			    t33.religiondesc,
			    COALESCE(t34.roledesc, ${add.schema}fn_get_roledesc(t1.nextrolecode)) lovdescrequeststage,
			    t1.margindeviation,
			    t1.applicationno,
			    t17.branchprovince,
			    t1.dnd,
			    t1.ResidentialStatus,
			    t1.othercaste,
				t1.otherreligion,
				t1.natureofbusiness,
				t1.entitytype,
				t1.custresidentialsts,
				t1.qualification,
				t1.custflag,
				t1.vip,
				t37.description AS lovdescqualification
			   FROM customers_temp t1
			     LEFT JOIN rmtcusttypes t2 ON t1.custtypecode = t2.custtypecode
			     LEFT JOIN bmtmaritalstatuscodes t3 ON t1.custmaritalsts = t3.maritalstscode
			     LEFT JOIN bmtempstscodes t4 ON t1.custempsts = t4.empstscode
			     LEFT JOIN bmtcuststatuscodes t6 ON t1.custsts = t6.custstscode
			     LEFT JOIN bmtindustries t7 ON t1.custindustry = t7.industrycode
			     LEFT JOIN bmtsectors t8 ON t1.custsector = t8.sectorcode
			     LEFT JOIN bmtsubsectors t9 ON t1.custsector = t9.sectorcode AND t1.custsubsector = t9.subsectorcode
			     LEFT JOIN bmtprofessions t10 ON t1.custprofession = t10.professioncode
			     LEFT JOIN bmtcountries t11 ON t1.custcob = t11.countrycode
			     LEFT JOIN bmtnationalitycodes t12 ON t1.custnationality = t12.nationalitycode
			     LEFT JOIN bmtgenders t13 ON t1.custgendercode = t13.gendercode
			     LEFT JOIN bmtdepartments t14 ON t1.custdsadept = t14.deptcode
			     LEFT JOIN amtvehicledealer t15 ON t1.custro1 = t15.dealerid
			     LEFT JOIN bmtgrpstatuscodes t16 ON t1.custgroupsts = t16.grpstscode
			     LEFT JOIN rmtbranches t17 ON t1.custdftbranch = t17.branchcode
			     LEFT JOIN bmtcustcategories t18 ON t1.custctgcode = t18.custctgcode
			     LEFT JOIN bmtsalutations t19 ON t1.custsalutationcode = t19.salutationcode
			     LEFT JOIN bmtsegments t20 ON t1.custsegment = t20.segmentcode
			     LEFT JOIN bmtcountries t21 ON t1.custparentcountry = t21.countrycode
			     LEFT JOIN bmtcountries t22 ON t1.custresdcountry = t22.countrycode
			     LEFT JOIN bmtcountries t23 ON t1.custriskcountry = t23.countrycode
			     LEFT JOIN relationshipofficers t24 ON t1.custro2 = t24.rofficercode
			     LEFT JOIN bmtblacklistrsncodes t25 ON t1.custblrsncode = t25.blrsncode
			     LEFT JOIN bmtrejectcodes t26 ON t1.custrejectedrsn = t26.rejectcode
			     LEFT JOIN customergroups t27 ON t1.custgroupid = t27.custgrpid
			     LEFT JOIN bmtsubsegments t28 ON t1.custsubsegment = t28.subsegmentcode
			     LEFT JOIN bmtlanguage t29 ON t1.custlng = t29.lngcode
			     LEFT JOIN bmtdispatchmodes t30 ON t1.custstmtdispatchmode = t30.dispatchmodecode
			     LEFT JOIN targetdetails t31 ON t1.custaddlvar82 = t31.targetcode
			     LEFT JOIN caste t32 ON t1.casteid = t32.casteid
			     LEFT JOIN religion t33 ON t1.religionid = t33.religionid
			     LEFT JOIN secroles t34 ON t1.nextrolecode = t34.rolecd
			     LEFT JOIN qualification t37 ON t1.qualification = t37.code
			     ]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.29_post" author="Gopal.p" dbms="postgresql">
		<sql>
			select deps_restore_dependencies('plf','customers_tview');
		</sql>
	</changeSet>

	<changeSet id="ST#1211.30_pre" author="Gopal.p" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies('plf','customers_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.30" author="Gopal.p">
		<createView viewName="customers_aview" replaceIfExists="true">
			<![CDATA[
			SELECT t1.custid,
			    t1.custcif,
			    t1.custcorebank,
			    t1.custctgcode,
			    t1.custtypecode,
			    t1.custsalutationcode,
			    t1.custfname,
			    t1.custmname,
			    t1.custlname,
			    t1.custshrtname,
			    t1.custfnamelcllng,
			    t1.custmnamelcllng,
			    t1.custlnamelcllng,
			    t1.custshrtnamelcllng,
			    t1.custdftbranch,
			    t1.custgendercode,
			    t1.custdob,
			    t1.custpob,
			    t1.custcob,
			    t1.custpassportno,
			    t1.custmothermaiden,
			    t1.custisminor,
			    t1.custreferedby,
			    t1.custdsa,
			    t1.custdsadept,
			    t1.custro1,
			    t1.custro2,
			    t1.custgroupid,
			    t1.custsts,
			    t1.custstschgdate,
			    t1.custgroupsts,
			    t1.custisblocked,
			    t1.custisactive,
			    t1.custisclosed,
			    t1.custinactivereason,
			    t1.custisdecease,
			    t1.custisdormant,
			    t1.custisdelinquent,
			    t1.custistradefincust,
			    t1.custtradelicencenum,
			    t1.custtradelicenceexpiry,
			    t1.custpassportexpiry,
			    t1.custvisanum,
			    t1.custvisaexpiry,
			    t1.custisstaff,
			    t1.custstaffid,
			    t1.custindustry,
			    t1.custsector,
			    t1.custsubsector,
			    t1.custprofession,
			    t1.custtotalincome,
			    t1.custmaritalsts,
			    t1.custempsts,
			    t1.custsegment,
			    t1.custsubsegment,
			    t1.custisblacklisted,
			    t1.custblrsncode,
			    t1.custisrejected,
			    t1.custrejectedrsn,
			    t1.custbaseccy,
			    t1.custlng,
			    t1.custparentcountry,
			    t1.custresdcountry,
			    t1.custriskcountry,
			    t1.custnationality,
			    t1.custclosedon,
			    t1.custstmtfrq,
			    t1.custisstmtcombined,
			    t1.custstmtlastdate,
			    t1.custstmtnextdate,
			    t1.custstmtdispatchmode,
			    t1.custfirstbusinessdate,
			    t1.custaddlvar81,
			    t1.custaddlvar82,
			    t1.custaddlvar83,
			    t1.custaddlvar84,
			    t1.custaddlvar85,
			    t1.custaddlvar86,
			    t1.custaddlvar87,
			    t1.custaddlvar88,
			    t1.custaddlvar89,
			    t1.custaddldate1,
			    t1.custaddldate2,
			    t1.custaddldate3,
			    t1.custaddldate4,
			    t1.custaddldate5,
			    t1.custaddlvar1,
			    t1.custaddlvar2,
			    t1.custaddlvar3,
			    t1.custaddlvar4,
			    t1.custaddlvar5,
			    t1.custaddlvar6,
			    t1.custaddlvar7,
			    t1.custaddlvar8,
			    t1.custaddlvar9,
			    t1.custaddlvar10,
			    t1.custaddlvar11,
			    t1.custaddldec1,
			    t1.custaddldec2,
			    t1.custaddldec3,
			    t1.custaddldec4,
			    t1.custaddldec5,
			    t1.custaddlint1,
			    t1.custaddlint2,
			    t1.custaddlint3,
			    t1.custaddlint4,
			    t1.custaddlint5,
			    t1.version,
			    t1.custsourceid,
			    t1.lastmntby,
			    t1.lastmnton,
			    t1.recordstatus,
			    t1.rolecode,
			    t1.nextrolecode,
			    t1.taskid,
			    t1.nexttaskid,
			    t1.recordtype,
			    t1.workflowid,
			    t2.custtypedesc lovdesccusttypecodename,
			    t3.maritalstsdesc lovdesccustmaritalstsname,
			    t4.empstsdesc lovdesccustempstsname,
			    t6.custstsdescription lovdesccuststsname,
			    t7.industrydesc lovdesccustindustryname,
			    t8.sectordesc lovdesccustsectorname,
			    t9.subsectordesc lovdesccustsubsectorname,
			    t10.professiondesc lovdesccustprofessionname,
			    t11.countrydesc lovdesccustcobname,
			    t20.segmentdesc lovdesccustsegmentname,
			    t12.nationalitydesc lovdesccustnationalityname,
			    t13.genderdesc lovdesccustgendercodename,
			    t14.deptdesc lovdesccustdsadeptname,
			    t15.dealername lovdesccustro1name,
			    t15.dealercity lovdesccustro1city,
			    t16.grpstsdescription lovdesccustgroupstsname,
			    t17.branchdesc lovdesccustdftbranchname,
			    t17.bankrefno branchrefno,
			    t17.branchswiftbrncde custswiftbrncode,
			    t18.custctgdesc lovdesccustctgcodename,
			    t2.custtypectg lovdesccustctgtype,
			    t19.saluationdesc lovdesccustsalutationcodename,
			    t21.countrydesc lovdesccustparentcountryname,
			    t22.countrydesc lovdesccustresdcountryname,
			    t23.countrydesc lovdesccustriskcountryname,
			    t24.rofficerdesc lovdesccustro2name,
			    t25.blrsndesc lovdesccustblrsncodename,
			    t26.rejectdesc lovdesccustrejectedrsnname,
			    t27.custgrpdesc lovdesccustgroupidname,
			    t28.subsegmentdesc lovdesccustsubsegmentname,
			    t29.lngdesc lovdesccustlngname,
			    t30.dispatchmodedesc lovdescdispatchmodedescname,
			    t1.dedupfound,
			    t1.skipdedup,
			    t1.custtotalexpense,
			    t1.custblacklistdate,
			    t1.noofdependents,
			    t1.custcrcpr,
			    t1.jointcust,
			    t1.jointcustname,
			    t1.jointcustdob,
			    t27.custgrpcode lovdesccustgroupcode,
			    t1.custrelation,
			    t1.contactpersonname,
			    t1.phonenumber,
			    t1.emailid,
			    t1.salariedcustomer,
			    t31.targetdesc lovdesctargetname,
			    t1.custsuspsts,
			    t1.custsuspdate,
			    t1.custsusptrigger,
			    t1.subcategory,
			    t1.casteid,
			    t1.religionid,
			    t32.castecode,
			    t32.castedesc,
			    t33.religioncode,
			    t33.religiondesc,
			    COALESCE(t34.roledesc, ${add.schema}fn_get_roledesc(t1.nextrolecode)) lovdescrequeststage,
			    t1.margindeviation,
			    t1.applicationno,
			    t17.branchprovince,
			    t1.dnd,
			    t1.ResidentialStatus,
			    t35.phoneareacode,
				t35.phonecountrycode,
				t1.othercaste,
				t1.otherreligion,
				t1.natureofbusiness,
				t1.entitytype,
				t1.custresidentialsts,
				t1.qualification,
				t1.custflag,
				t1.vip,
				t37.description AS lovdescqualification
			   FROM customers t1
			     LEFT JOIN rmtcusttypes t2 ON t1.custtypecode = t2.custtypecode
			     LEFT JOIN bmtmaritalstatuscodes t3 ON t1.custmaritalsts = t3.maritalstscode
			     LEFT JOIN bmtempstscodes t4 ON t1.custempsts = t4.empstscode
			     LEFT JOIN bmtcuststatuscodes t6 ON t1.custsts = t6.custstscode
			     LEFT JOIN bmtindustries t7 ON t1.custindustry = t7.industrycode
			     LEFT JOIN bmtsectors t8 ON t1.custsector = t8.sectorcode
			     LEFT JOIN bmtsubsectors t9 ON t1.custsector = t9.sectorcode AND t1.custsubsector = t9.subsectorcode
			     LEFT JOIN bmtprofessions t10 ON t1.custprofession = t10.professioncode
			     LEFT JOIN bmtcountries t11 ON t1.custcob = t11.countrycode
			     LEFT JOIN bmtnationalitycodes t12 ON t1.custnationality = t12.nationalitycode
			     LEFT JOIN bmtgenders t13 ON t1.custgendercode = t13.gendercode
			     LEFT JOIN bmtdepartments t14 ON t1.custdsadept = t14.deptcode
			     LEFT JOIN amtvehicledealer t15 ON t1.custro1 = t15.dealerid
			     LEFT JOIN bmtgrpstatuscodes t16 ON t1.custgroupsts = t16.grpstscode
			     LEFT JOIN rmtbranches t17 ON t1.custdftbranch = t17.branchcode
			     LEFT JOIN bmtcustcategories t18 ON t1.custctgcode = t18.custctgcode
			     LEFT JOIN bmtsalutations t19 ON t1.custsalutationcode = t19.salutationcode
			     LEFT JOIN bmtsegments t20 ON t1.custsegment = t20.segmentcode
			     LEFT JOIN bmtcountries t21 ON t1.custparentcountry = t21.countrycode
			     LEFT JOIN bmtcountries t22 ON t1.custresdcountry = t22.countrycode
			     LEFT JOIN bmtcountries t23 ON t1.custriskcountry = t23.countrycode
			     LEFT JOIN relationshipofficers t24 ON t1.custro2 = t24.rofficercode
			     LEFT JOIN bmtblacklistrsncodes t25 ON t1.custblrsncode = t25.blrsncode
			     LEFT JOIN bmtrejectcodes t26 ON t1.custrejectedrsn = t26.rejectcode
			     LEFT JOIN customergroups t27 ON t1.custgroupid = t27.custgrpid
			     LEFT JOIN bmtsubsegments t28 ON t1.custsubsegment = t28.subsegmentcode
			     LEFT JOIN bmtlanguage t29 ON t1.custlng = t29.lngcode
			     LEFT JOIN bmtdispatchmodes t30 ON t1.custstmtdispatchmode = t30.dispatchmodecode
			     LEFT JOIN targetdetails t31 ON t1.custaddlvar82 = t31.targetcode
			     LEFT JOIN caste t32 ON t1.casteid = t32.casteid
			     LEFT JOIN religion t33 ON t1.religionid = t33.religionid
			     LEFT JOIN secroles t34 ON t1.nextrolecode = t34.rolecd
			 	LEFT JOIN customerphonenumbers t35 ON t1.custid = t35.phonecustid AND t35.phonetypepriority = 5
				LEFT JOIN customeremails t36 ON t1.custid = t36.custid AND t36.custemailtypecode = 'OFFICE'
				LEFT JOIN qualification t37 ON t1.qualification = t37.code 
			 			]]>
		</createView>
	</changeSet>


	<changeSet id="ST#1211.30_post" author="Gopal.p" dbms="postgresql">
		<sql>
			select deps_restore_dependencies('plf','customers_aview');
		</sql>
	</changeSet>

	<changeSet id="ST#1211.31_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'buildercompany_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.31" author="Gopal.p">
		<createView viewName="BUILDERCOMPANY_AVIEW" replaceIfExists="true">
			<![CDATA[
				 SELECT T1.ID,
				    T1.NAME,
				    T1.SEGMENTATION,
				    T1.GROUPID,
				    T2.VALUEDESC SEGMENTATIONNAME,
				    T2.FIELDCODE,
				    T3.NAME GROUPIDNAME,
				    T1.APFTYPE,
				    T1.PEDEVID,
				    T1.ENTITYTYPE,
				    T1.EMAILID,
				    T1.CITYTYPE,
				    T1.ADDRESS1,
				    T1.ADDRESS2,
				    T1.ADDRESS3,
				    T1.CITY,
				    T1.CODE,
				    T1.DEVAVAILABLITY,
				    T1.MAGNITUDE,
				    T1.ABSAVAILABLITY,
				    T1.TOTALPROJ,
				    T1.APPROVED,
				    T1.REMARKS,
				    T1.PANDETAILS,
				    T1.BENFNAME,
				    T1.ACCOUNTNO,
				    T7.BANKCODE,
				    T9.BANKNAME,
				    T1.BANKBRANCHID,
				    T7.IFSC,
				    T1.LIMITONAMT,
				    T1.LIMITONUNITS,
				    T1.CURRENTEXPUNI,
				    T1.CURRENTEXPAMT,
				    T1.DATEOFINCOP,
				    T1.NOOFPROJ,
				    T1.ASSHLPLAYERS,
				    T1.ONGOINGPROJ,
				    T1.EXPINBUSINESS,
				    T1.RECOMMENDATION,
				    T1.MAGINTUDEINLACS,
				    T1.NOOFPROJCONS,
				    T1.VERSION,
				    T1.LASTMNTBY,
				    T1.LASTMNTON,
				    T1.RECORDSTATUS,
				    T1.ROLECODE,
				    T1.NEXTROLECODE,
				    T1.TASKID,
				    T1.NEXTTASKID,
				    T1.RECORDTYPE,
				    T1.WORKFLOWID,
				    T4.CUSTSHRTNAME LOVDESCCIFNAME,
				    T4.CUSTCIF,
				    T1.CUSTID,
				    T5.PCCITYNAME CITYNAME,
				    T6.PINCODE CODENAME,
				    T6.AREANAME,
				    T7.BRANCHDESC BRANDESC,
				    T8.CUSTTYPECTG ENTYDESC,
				    T1.ACTIVE,
					T1.PINCODEID,
					T1.STATE
				   	FROM BUILDERCOMPANY T1
				     JOIN RMTLOVFIELDDETAIL T2 ON T1.SEGMENTATION = T2.FIELDCODEVALUE AND T2.FIELDCODE = 'SEGMENT'
				     LEFT JOIN BUILDERGROUP T3 ON T1.GROUPID = T3.ID
				     LEFT JOIN CUSTOMERS T4 ON T1.CUSTID = T4.CUSTID
				     LEFT JOIN RMTPROVINCEVSCITY T5 ON T1.CITY = T5.PCCITY
				     LEFT JOIN PINCODES T6 ON T1.PINCODEID = T6.PINCODEID
				     LEFT JOIN BANKBRANCHES T7 ON T1.BANKBRANCHID = T7.BANKBRANCHID
				     LEFT JOIN RMTCUSTTYPES T8 ON T1.ENTITYTYPE = T8.CUSTTYPECODE
				     LEFT JOIN BMTBANKDETAIL T9 ON T9.BANKCODE = T7.BANKCODE;
			]]>
	   </createView>
	</changeSet>

	<changeSet id="ST#1211.31_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'buildercompany_aview');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.32_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'buildercompany_tview');
			]]>
		</sql>
	</changeSet>
	<changeSet id="ST#1211.32" author="Gopal.p">
		<createView viewName="BUILDERCOMPANY_TVIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID,
					T1.NAME,
					T1.SEGMENTATION,
					T1.GROUPID,
					T2.VALUEDESC SEGMENTATIONNAME,
					T2.FIELDCODE,
					T3.NAME GROUPIDNAME,
					T1.APFTYPE,
					T1.PEDEVID,
					T1.ENTITYTYPE,
					T1.EMAILID,
					T1.CITYTYPE,
					T1.ADDRESS1,
					T1.ADDRESS2,
					T1.ADDRESS3,
					T1.CITY,
					T1.CODE,
					T1.DEVAVAILABLITY,
					T1.MAGNITUDE,
					T1.ABSAVAILABLITY,
					T1.TOTALPROJ,
					T1.APPROVED,
					T1.REMARKS,
					T1.PANDETAILS,
					T1.BENFNAME,
					T1.ACCOUNTNO,
					T7.BANKCODE,
					T9.BANKNAME,
					T1.BANKBRANCHID,
					T7.IFSC,
					T1.LIMITONAMT,
					T1.LIMITONUNITS,
					T1.CURRENTEXPUNI,
					T1.CURRENTEXPAMT,
					T1.DATEOFINCOP,
					T1.NOOFPROJ,
					T1.ASSHLPLAYERS,
					T1.ONGOINGPROJ,
					T1.EXPINBUSINESS,
					T1.RECOMMENDATION,
					T1.MAGINTUDEINLACS,
					T1.NOOFPROJCONS,
					T1.VERSION,
					T1.LASTMNTBY,
					T1.LASTMNTON,
					T1.RECORDSTATUS,
					T1.ROLECODE,
					T1.NEXTROLECODE,
					T1.TASKID,
					T1.NEXTTASKID,
					T1.RECORDTYPE,
					T1.WORKFLOWID,
					T4.CUSTSHRTNAME LOVDESCCIFNAME,
					T4.CUSTCIF,
					T4.CUSTID,
					T5.PCCITYNAME CITYNAME,
					T6.PINCODE CODENAME,
					T6.AREANAME,
					T7.BRANCHDESC BRANDESC,
					T8.CUSTTYPECTG ENTYDESC,
					T1.PINCODEID,
					T1.STATE
				   FROM BUILDERCOMPANY_TEMP T1
					 JOIN RMTLOVFIELDDETAIL T2 ON T1.SEGMENTATION = T2.FIELDCODEVALUE AND T2.FIELDCODE = 'SEGMENT'
					 LEFT JOIN BUILDERGROUP T3 ON T1.GROUPID = T3.ID
					 LEFT JOIN CUSTOMERS T4 ON T1.CUSTID = T4.CUSTID
					 LEFT JOIN RMTPROVINCEVSCITY T5 ON T1.CITY = T5.PCCITY
					 LEFT JOIN PINCODES T6 ON T1.PINCODEID = T6.PINCODEID
					 LEFT JOIN BANKBRANCHES T7 ON T1.BANKBRANCHID = T7.BANKBRANCHID
					 LEFT JOIN RMTCUSTTYPES T8 ON T1.ENTITYTYPE = T8.CUSTTYPECODE
					 LEFT JOIN BMTBANKDETAIL T9 ON T9.BANKCODE = T7.BANKCODE;
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.32_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'buildercompany_tview');
			]]>
		</sql>
	</changeSet>


	<changeSet id="ST#1211.33_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'buildercompany_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.33" author="Gopal.p">
		<createView viewName="BUILDERCOMPANY_VIEW" replaceIfExists="true">
			<![CDATA[
				SELECT T1.ID,
				T1.NAME,
				T1.SEGMENTATION,
				T1.GROUPID,
				T2.VALUEDESC SEGMENTATIONNAME,
				T2.FIELDCODE,
				T3.NAME GROUPIDNAME,
				T1.APFTYPE,
				T1.PEDEVID,
				T1.ENTITYTYPE,
				T1.EMAILID,
				T1.CITYTYPE,
				T1.ADDRESS1,
				T1.ADDRESS2,
				T1.ADDRESS3,
				T1.CITY,
				T1.CODE,
				T1.DEVAVAILABLITY,
				T1.MAGNITUDE,
				T1.ABSAVAILABLITY,
				T1.TOTALPROJ,
				T1.APPROVED,
				T1.REMARKS,
				T1.PANDETAILS,
				T1.BENFNAME,
				T1.ACCOUNTNO,
				T7.BANKCODE,
				T9.BANKNAME,
				T1.BANKBRANCHID,
				T7.IFSC,
				T1.LIMITONAMT,
				T1.LIMITONUNITS,
				T1.CURRENTEXPUNI,
				T1.CURRENTEXPAMT,
				T1.DATEOFINCOP,
				T1.NOOFPROJ,
				T1.ASSHLPLAYERS,
				T1.ONGOINGPROJ,
				T1.EXPINBUSINESS,
				T1.RECOMMENDATION,
				T1.MAGINTUDEINLACS,
				T1.NOOFPROJCONS,
				T1.VERSION,
				T1.LASTMNTBY,
				T1.LASTMNTON,
				T1.RECORDSTATUS,
				T1.ROLECODE,
				T1.NEXTROLECODE,
				T1.TASKID,
				T1.NEXTTASKID,
				T1.RECORDTYPE,
				T1.WORKFLOWID,
				T5.PCCITYNAME CITYNAME,
				T6.PINCODE CODENAME,
				T6.AREANAME,
				T7.BRANCHDESC BRANDESC,
				T8.CUSTTYPECTG ENTYDESC,
				T1.ACTIVE,
				T10.CUSTSHRTNAME LOVDESCCIFNAME,
				T10.CUSTCIF,
				T1.CUSTID,
				T1.PINCODEID,
				T1.STATE
			   FROM BUILDERCOMPANY_TEMP T1
			   JOIN RMTLOVFIELDDETAIL T2 ON T1.SEGMENTATION = T2.FIELDCODEVALUE AND T2.FIELDCODE = 'SEGMENT'
			   LEFT JOIN BUILDERGROUP T3 ON T1.GROUPID = T3.ID
			   LEFT JOIN RMTPROVINCEVSCITY T5 ON T1.CITY = T5.PCCITY
			   LEFT JOIN PINCODES T6 ON T1.PINCODEID = T6.PINCODEID
			   LEFT JOIN BANKBRANCHES T7 ON T1.BANKBRANCHID = T7.BANKBRANCHID
			   LEFT JOIN RMTCUSTTYPES T8 ON T1.ENTITYTYPE = T8.CUSTTYPECODE
			   LEFT JOIN BMTBANKDETAIL T9 ON T9.BANKCODE = T7.BANKCODE
			   LEFT JOIN CUSTOMERS T10 ON T1.CUSTID = T10.CUSTID
			 UNION ALL
			SELECT T1.ID,
				T1.NAME,
				T1.SEGMENTATION,
				T1.GROUPID,
				T2.VALUEDESC SEGMENTATIONNAME,
				T2.FIELDCODE,
				T3.NAME GROUPIDNAME,
				T1.APFTYPE,
				T1.PEDEVID,
				T1.ENTITYTYPE,
				T1.EMAILID,
				T1.CITYTYPE,
				T1.ADDRESS1,
				T1.ADDRESS2,
				T1.ADDRESS3,
				T1.CITY,
				T1.CODE,
				T1.DEVAVAILABLITY,
				T1.MAGNITUDE,
				T1.ABSAVAILABLITY,
				T1.TOTALPROJ,
				T1.APPROVED,
				T1.REMARKS,
				T1.PANDETAILS,
				T1.BENFNAME,
				T1.ACCOUNTNO,
				T7.BANKCODE,
				T9.BANKNAME,
				T1.BANKBRANCHID,
				T7.IFSC,
				T1.LIMITONAMT,
				T1.LIMITONUNITS,
				T1.CURRENTEXPUNI,
				T1.CURRENTEXPAMT,
				T1.DATEOFINCOP,
				T1.NOOFPROJ,
				T1.ASSHLPLAYERS,
				T1.ONGOINGPROJ,
				T1.EXPINBUSINESS,
				T1.RECOMMENDATION,
				T1.MAGINTUDEINLACS,
				T1.NOOFPROJCONS,
				T1.VERSION,
				T1.LASTMNTBY,
				T1.LASTMNTON,
				T1.RECORDSTATUS,
				T1.ROLECODE,
				T1.NEXTROLECODE,
				T1.TASKID,
				T1.NEXTTASKID,
				T1.RECORDTYPE,
				T1.WORKFLOWID,
				T5.PCCITYNAME CITYNAME,
				T6.PINCODE CODENAME,
				T6.AREANAME,
				T7.BRANCHDESC BRANDESC,
				T8.CUSTTYPECTG ENTYDESC,
				T1.ACTIVE,
				T10.CUSTSHRTNAME LOVDESCCIFNAME,
				T10.CUSTCIF,
				T1.CUSTID,
				T1.PINCODEID,
				T1.STATE
			   FROM BUILDERCOMPANY T1
			   JOIN RMTLOVFIELDDETAIL T2 ON T1.SEGMENTATION = T2.FIELDCODEVALUE AND T2.FIELDCODE = 'SEGMENT'
			   LEFT JOIN BUILDERGROUP T3 ON T1.GROUPID = T3.ID
			   LEFT JOIN RMTPROVINCEVSCITY T5 ON T1.CITY = T5.PCCITY
			   LEFT JOIN PINCODES T6 ON T1.PINCODEID = T6.PINCODEID
			   LEFT JOIN BANKBRANCHES T7 ON T1.BANKBRANCHID = T7.BANKBRANCHID
			   LEFT JOIN RMTCUSTTYPES T8 ON T1.ENTITYTYPE = T8.CUSTTYPECODE
			   LEFT JOIN BMTBANKDETAIL T9 ON T9.BANKCODE = T7.BANKCODE
			   LEFT JOIN CUSTOMERS T10 ON T1.CUSTID = T10.CUSTID
			   WHERE NOT (EXISTS ( SELECT 1 FROM BUILDERCOMPANY_TEMP  WHERE BUILDERCOMPANY_TEMP.ID = T1.ID));
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.33_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'buildercompany_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.34_pre" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_save_and_drop_dependencies ('plf', 'fintypefees_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.34" author="Gopal.p">
		<createView viewName="fintypefees_view" replaceIfExists="true">
		<![CDATA[
		SELECT t1.fintype,
   	  		 t1.originationfee,
       		 t1.finevent,
       		 t1.feetypeid,
       		 t1.feeorder,
       		 t1.feeschedulemethod,
       		 t1.calculationtype,
       		 t1.rulecode,
       		 t1.amount,
       		 t1.percentage,
       		 t1.calculateon,
       		 t1.alwdeviation,
       		 t1.maxwaiverperc,
       		 t1.alwmodifyfee,
       		 t1.alwmodifyfeeschdmthd,
             t1.active,
             t1.version,
       		 t1.lastmntby,
       		 t1.lastmnton,
	         t1.recordstatus,
       		 t1.rolecode,
	         t1.nextrolecode,
	         t1.taskid,
	         t1.nexttaskid,
		     t1.recordtype,
		     t1.workflowid,
		     t1.moduleid,
		     t1.alwpreincomization,
		     t2.feetypecode,
		     t2.feetypedesc,
		     t2.taxapplicable,
		     t2.taxcomponent,
		     t3.rulecodedesc AS ruledesc,
		     t1.referenceid,
			 t1.perctype,
			 t1.percrule,
			 t1.finTypeFeeId,
			 t2.tdsReq
	    FROM fintypefees_temp t1
	    JOIN feetypes t2 ON t1.feetypeid = t2.feetypeid
	    LEFT JOIN rules t3 ON t1.rulecode = t3.rulecode AND t3.rulemodule = 'FEES' AND t1.finevent = t3.ruleevent
		UNION ALL
		SELECT t1.fintype,
			t1.originationfee,
			t1.finevent,
			t1.feetypeid,
			t1.feeorder,
			t1.feeschedulemethod,
			t1.calculationtype,
			t1.rulecode,
			t1.amount,
			t1.percentage,
			t1.calculateon,
			t1.alwdeviation,
			t1.maxwaiverperc,
			t1.alwmodifyfee,
			t1.alwmodifyfeeschdmthd,
			t1.active,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.moduleid,
			t1.alwpreincomization,
			t2.feetypecode,
			t2.feetypedesc,
			t2.taxapplicable,
			t2.taxcomponent,
			t3.rulecodedesc AS ruledesc,
			t1.referenceid,
			t1.perctype,
			t1.percrule, 
			t1.finTypeFeeId,
			t2.tdsReq
	    FROM fintypefees t1
	    JOIN feetypes t2 ON t1.feetypeid = t2.feetypeid
	    LEFT JOIN rules t3 ON t1.rulecode = t3.rulecode AND t3.rulemodule = 'FEES' AND t1.finevent = t3.ruleevent
	    WHERE NOT (EXISTS ( SELECT 1 FROM fintypefees_temp f
	    WHERE f.fintype = t1.fintype AND f.finevent = t1.finevent 
		AND f.feetypeid = t1.feetypeid AND f.originationfee = t1.originationfee))
			]]>
		</createView>
	</changeSet>

	<changeSet id="ST#1211.34_post" author="Gopal.p" dbms="postgresql">
		<sql>
			<![CDATA[
				select deps_restore_dependencies ('plf', 'fintypefees_view');
			]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.35_pre" author="Gopal.p" dbms="postgresql">
		<sql>
		<![CDATA[
			select deps_save_and_drop_dependencies ('plf', 'fintypefees_aview');
		]]>
		</sql>
	</changeSet>

	<changeSet id="ST#1211.35" author="Gopal.p">
	   <createView viewName="fintypefees_aview" replaceIfExists="true">
	    <![CDATA[			
	     SELECT t1.fintype,
			t1.originationfee,
			t1.finevent,
			t1.feetypeid,
			t1.feeorder,
			t1.feeschedulemethod,
			t1.calculationtype,
			t1.rulecode,
			t1.amount,
			t1.percentage,
			t1.calculateon,
			t1.alwdeviation,
			t1.maxwaiverperc,
			t1.alwmodifyfee,
			t1.alwmodifyfeeschdmthd,
			t1.active,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t1.moduleid,
			t1.alwpreincomization,
			t2.feetypecode,
			t2.feetypedesc,
			t2.taxapplicable,
			t2.taxcomponent,
			t3.rulecodedesc AS ruledesc,
			t1.referenceid,
			t1.perctype,
			t1.percrule, 
			t1.finTypeFeeId,
			t2.tdsReq
		  FROM fintypefees t1
		  JOIN feetypes t2 ON t1.feetypeid = t2.feetypeid
		  LEFT JOIN rules t3 ON t1.rulecode = t3.rulecode AND t3.rulemodule = 'FEES' AND t1.finevent = t3.ruleevent
		]]>
	  </createView>
	</changeSet>

	<changeSet id="ST#1211.35_post" author="Gopal.p" dbms="postgresql">
		<sql>
		  <![CDATA[
		    	select deps_restore_dependencies ('plf', 'fintypefees_aview');
		 ]]>
		</sql>
	</changeSet>

	<!-- Please add all the change sets above ST#1211 story only -->

</databaseChangeLog>