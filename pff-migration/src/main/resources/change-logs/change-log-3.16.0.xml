<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />
	
	 <changeSet id="01" author="Madhubabu">
	    <sql>
	        delete from smtparameters where sysparmcode in('GCD_CUSTOMER_DRIVER','GCD_CUSTOMER_URL','GCD_CUSTOMER_USERNAME','GCD_CUSTOMER_PWD');
		</sql>
</changeSet>
 <changeSet id="02" author="Madhubabu">
	    <sql>
delete from REPORTFILTERFIELDS where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DailyPastdue') and fieldid='3';
delete from REPORTFILTERFIELDS where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DailyPastduebyCustomer') and fieldid='3';

Insert into REPORTFILTERFIELDS 
values ((select reportid from reportconfiguration where menuitemcode='menu_Item_DailyPastdue'),3,'CustCIF','LOVSEARCH','Customer Number','CustCIF',null,'Customer','getCustCIF','getCustShrtName',1,0,0,0,3,0,' ',' ',' ',' ',250,0,'=',1,1000,'Approved',null,null,null,null,null,0,current_timestamp);

Insert into REPORTFILTERFIELDS 
values ((select reportid from reportconfiguration where menuitemcode='menu_Item_DailyPastduebyCustomer'),3,'CustCIF','LOVSEARCH','Customer Number','CustCIF',null,'Customer','getCustCIF','getCustShrtName',1,0,0,0,3,0,' ',' ',' ',' ',250,0,'=',1,1000,'Approved',null,null,null,null,null,0,current_timestamp);
	  </sql>
	  </changeSet>
 <changeSet id="03" author="Siva">
	    <sql>
	  		UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS); 
	    
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='FIN_CHANGEGESTATION_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='FinanceMainDialog_nextGrcPftDate'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='FIN_CHANGEGESTATION_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='FinanceMainDialog_nextGrcPftRvwDate'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='FIN_CHANGEGESTATION_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='FinanceMainDialog_nextGrcCpzDate'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);

			UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS); 
	
	  </sql>
	  </changeSet>
	   <changeSet id="04" author="pruthvi">
	    <sql>
	  update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_Postings';

update reportfilterfields set Fielddbname='B.BranchCode' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Postings') and fieldid=1;

update reportfilterfields set Fielddbname='P.Account' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Postings') and fieldid=3;

update reportfilterfields set Fielddbname='F.FinType' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Postings') and fieldid=5;

update reportfilterfields set Fielddbname='P.FinEvent' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Postings') and fieldid=6;

update reportfilterfields set Fielddbname='P.PostStatus' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Postings') and fieldid=7;

update reportfilterfields set Fielddbname='P.FinReference' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Postings') and fieldid=8;

update reportfilterfields set Fielddbname='F.FinIsActive' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Postings') and fieldid=9;

update reportfilterfields set Fielddbname='T2.FinDivision' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Postings') and fieldid=10;

update reportfilterfields set Fielddbname='P.PostDate' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Postings') and fieldid=11;
</sql>
	  </changeSet>
	  <changeSet id="05" author="pruthvi">
	    <sql>
	  update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_Install_Due_Today';

update reportfilterfields set Fielddbname='FinBranch' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Install_Due_Today') and fieldid=1;

update reportfilterfields set Fielddbname='FM.FinType' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Install_Due_Today') and fieldid=2;

update reportfilterfields set Fielddbname='FS.FinReference' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Install_Due_Today') and fieldid=3;

update reportfilterfields set Fielddbname='FM.FinIsActive' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Install_Due_Today') and fieldid=5;
</sql>
	  </changeSet>
	   <changeSet id="06" author="pruthvi">
	    <sql>
	  update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_Finances_Opened_Today';

update reportfilterfields set Fielddbname='A.FinBranch' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Finances_Opened_Today') and fieldid=1;

update reportfilterfields set Fielddbname='A.FinType' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Finances_Opened_Today') and fieldid=2;

update reportfilterfields set Fielddbname='A.FinStartDate' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Finances_Opened_Today') and fieldid=3;

update reportfilterfields set Fielddbname='T1.FinDivision' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Finances_Opened_Today') and fieldid=4;

update reportfilterfields set Fielddbname='C.CustCIF' where reportid in
(select reportid from reportconfiguration where menuitemcode='menu_Item_Finances_Opened_Today') and fieldid=5;
</sql>
	  </changeSet>
	  <changeSet id="07" author="pruthvi">
	    <sql>
update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_RateReviewDue';

update reportfilterfields set FieldDbname='T1.FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_RateReviewDue') and fieldid=1;

update reportfilterfields set FieldDbname='CurODDays'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_RateReviewDue') and fieldid=2;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_RateReviewDue') and fieldid=3;
</sql>
	  </changeSet>
	  	  <changeSet id="08" author="pruthvi">
	    <sql>
update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_RepaymentsToBeDoneToday';

update reportfilterfields set FieldDbname='T1.FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_RepaymentsToBeDoneToday') and fieldid=1;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_RepaymentsToBeDoneToday') and fieldid=3;
</sql>
	  </changeSet>
	  	  	  <changeSet id="09" author="pruthvi">
	    <sql>
update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_RepaymentsProcessedToday';

update reportfilterfields set FieldDbname='T1.FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_RepaymentsProcessedToday') and fieldid=1;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_RepaymentsProcessedToday') and fieldid=3;
</sql>
	  </changeSet>
	   	  <changeSet id="10" author="pruthvi">
	    <sql> 
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_DetailListofFINandINV';

update reportfilterfields set FieldDbname='T3.FinDivision'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DetailListofFINandINV') and fieldid=9;

update reportfilterfields set FieldDbname='T1.FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DetailListofFINandINV') and fieldid=1;

update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DetailListofFINandINV') and fieldid=3;

update reportfilterfields set FieldDbname='T1.FinStartDate'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DetailListofFINandINV') and fieldid=5;

update reportfilterfields set FieldDbname='T1.MaturityDate'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DetailListofFINandINV') and fieldid=6;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DetailListofFINandINV') and fieldid=8;
	    </sql>
	  </changeSet>
	   <changeSet id="11" author="pruthvi">
	    <sql> 
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_FinByMaturity';


update reportfilterfields set FieldDbname='T2.FinDivision'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinByMaturity') and fieldid=9;

update reportfilterfields set FieldDbname='T1.FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinByMaturity') and fieldid=1;

update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinByMaturity') and fieldid=3;

update reportfilterfields set FieldDbname='T1.FinStartDate'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinByMaturity') and fieldid=5;

update reportfilterfields set FieldDbname='T1.MaturityDate'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinByMaturity') and fieldid=6;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinByMaturity') and fieldid=8;
	    </sql>
	  </changeSet>
	   <changeSet id="12" author="pruthvi">
	    <sql> 
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_Presentment';

update reportfilterfields set FieldDbname='PRD.FinReference'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_Presentment') and fieldid=1;

update reportfilterfields set FieldDbname='PRD.status'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_Presentment') and fieldid=2;
	    </sql>
	  </changeSet>
	   <changeSet id="13" author="pruthvi">
	    <sql> 
	    update reportfilterfields set FieldDbname='t.fintype'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PendingFinances') and fieldid=1;
	    
	    </sql>
	  </changeSet>
	   <changeSet id="14" author="pruthvi">
	    <sql> 
	    update reportfilterfields set FieldDbname='T5.rulecode'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_CLLIMITMIS') and fieldid=2;

update reportfilterfields set FieldDbname='T7.Branchcode'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_CLLIMITMIS') and fieldid=3;
	    </sql>
	  </changeSet>
	   <changeSet id="15" author="pruthvi">
	    <sql> 
	    update reportfilterfields set FieldDbname='T4.custid'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TERMLOANTRACKER') and fieldid=1;

update reportfilterfields set FieldDbname='T1.fintype'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TERMLOANTRACKER') and fieldid=2;

update reportfilterfields set FieldDbname='T1.FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TERMLOANTRACKER') and fieldid=3;
	    </sql>
	  </changeSet>
	   <changeSet id="16" author="pruthvi">
	    <sql> 
	    update reportfilterfields set FieldDbname='fpd.fintype'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DAILYDISBURSALREPORT') and fieldid=1;

update reportfilterfields set FieldDbname='fpd.FinReference'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DAILYDISBURSALREPORT') and fieldid=2;

update reportfilterfields set FieldDbname='fdd.DisbDate'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DAILYDISBURSALREPORT') and fieldid=3;
	    </sql>
	  </changeSet>
	   <changeSet id="17" author="pruthvi">
	    <sql> 
	    update reportfilterfields set FieldDbname='P.finreference'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_LoanwiseVoucherDetail') and fieldid=2;

update reportfilterfields set FieldDbname='FM.FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_LoanwiseVoucherDetail') and fieldid=3;

update reportfilterfields set FieldDbname='FM.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_LoanwiseVoucherDetail') and fieldid=4;

update reportfilterfields set FieldDbname='Fm.fintype'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_LoanwiseVoucherDetail') and fieldid=5;
	    </sql>
	  </changeSet>
	    <changeSet id="18" author="pruthvi">
	    <sql> 
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_PresentationDetails';

update reportfilterfields set FieldDbname='P.Finreference'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PresentationDetails') and fieldid=1;
	      </sql>
	  </changeSet>
	   <changeSet id="19" author="pruthvi">
	    <sql> 
	    update reportfilterfields set FieldDbname='finprov.FINBRANCH'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_NPAReport') and fieldid=1;

update reportfilterfields set FieldDbname='product.PRODUCTDESC'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_NPAReport') and fieldid=2;

update reportfilterfields set FieldDbname='finprov.FINREFERENCE'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_NPAReport') and fieldid=3;
	      </sql>
	  </changeSet>
	   <changeSet id="20" author="pruthvi">
	    <sql> 
	    update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DailyPastdue') and fieldid=2;

update reportfilterfields set FieldDbname='T1.CustCIF'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DailyPastdue') and fieldid=3;
	      </sql>
	  </changeSet>
	   <changeSet id="21" author="pruthvi">
	    <sql> 
	    update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DailyPastduebyCustomer') and fieldid=2;

update reportfilterfields set FieldDbname='T1.CustCIF'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DailyPastduebyCustomer') and fieldid=3;
	      </sql>
	  </changeSet>
	   <changeSet id="22" author="pruthvi">
	    <sql> 
	   update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_BriefDealInformation';

update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_BriefDealInformation') and fieldid=3;

update reportfilterfields set FieldDbname='T1.CustCIF'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_BriefDealInformation') and fieldid=4;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_BriefDealInformation') and fieldid=7; 
	      </sql>
	  </changeSet>
	  <changeSet id="23" author="Irfan">
	  	<sql>
	  		UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS); 
			
			INSERT INTO SECRIGHTS SELECT (SELECT MAX(RIGHTID)+1 FROM SECRIGHTS), 2, 'button_FinCovenantTypeList_btnSave','FinCovenantTypeList',0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0 FROM SEQSECRIGHTS WHERE 0=0; 
			
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='CL_ORIGINATION_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_FinCovenantTypeList_btnSave'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			
			INSERT INTO SECGROUPRIGHTS VALUES((SELECT MAX(GRPRIGHTID)+1 FROM SECGROUPRIGHTS), (SELECT GRPID  FROM SECGROUPS WHERE GRPCODE='FinCovenantType_MAKER') ,(SELECT RIGHTID FROM SECRIGHTS WHERE RIGHTNAME='button_FinCovenantTypeList_btnSave'), 1, 0,1000,CURRENT_TIMESTAMP,' ',' ',' ',' ',' ',' ',0);
			
			UPDATE SEQSECRIGHTS SET SEQNO= (SELECT MAX(RIGHTID) FROM SECRIGHTS);
			UPDATE SEQSECGROUPRIGHTS SET SEQNO = (SELECT MAX(GRPRIGHTID) FROM SECGROUPRIGHTS); 
	  	</sql>
	  
	  </changeSet>
	  
	   <changeSet id="24" author="pruthvi">
	    <sql>
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_FinanceBasicInformation';

update reportfilterfields set FieldDbname='FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinanceBasicInformation') and fieldid=1;

update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinanceBasicInformation') and fieldid=3;

update reportfilterfields set FieldDbname='T1.CustCIF'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinanceBasicInformation') and fieldid=4;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_FinanceBasicInformation') and fieldid=8;
	    </sql>
	  </changeSet>
	  <changeSet id="25" author="pruthvi">
	    <sql>
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_DealDetail';

update reportfilterfields set FieldDbname='FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DealDetail') and fieldid=1;

update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DealDetail') and fieldid=3;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_DealDetail') and fieldid=5;
	    </sql>
	  </changeSet>
	  <changeSet id="26" author="pruthvi">
	    <sql>
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_PayoffDeals';

update reportfilterfields set FieldDbname='T1.Finreference'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PayoffDeals') and fieldid=2;
	    </sql>
	  </changeSet>
	   <changeSet id="27" author="pruthvi">
	    <sql>
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_OBUAccrual';

update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_OBUAccrual') and fieldid=3;

update reportfilterfields set FieldDbname='T3.CustCIF'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_OBUAccrual') and fieldid=4;

update reportfilterfields set FieldDbname='T1.FinisActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_OBUAccrual') and fieldid=7;
	    </sql>
	  </changeSet>
	  
	   <changeSet id="28" author="pruthvi">
	    <sql>
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_TrialBalancesByDealTypeandCurrency';

update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TrialBalancesByDealTypeandCurrency') and fieldid=2;

update reportfilterfields set FieldDbname='T2.CustCIF'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TrialBalancesByDealTypeandCurrency') and fieldid=3;

update reportfilterfields set FieldDbname='T1.FinCcy'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TrialBalancesByDealTypeandCurrency') and fieldid=4;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TrialBalancesByDealTypeandCurrency') and fieldid=6;
	    </sql>
	  </changeSet>
	  
	   <changeSet id="29" author="pruthvi">
	    <sql>
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_TrialBalancesByCountry';

update reportfilterfields set FieldDbname='T1.FinBranch'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TrialBalancesByCountry') and fieldid=1;

update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TrialBalancesByCountry') and fieldid=3;

update reportfilterfields set FieldDbname='T3.CustCIF'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TrialBalancesByCountry') and fieldid=4;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_TrialBalancesByCountry') and fieldid=7;
	    </sql>
	  </changeSet>
	  
	   <changeSet id="30" author="pruthvi">
	    <sql>
	    update reportconfiguration set wherecondition=0 where menuitemcode='menu_Item_ClientLendingStatusByMaturity';

update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_ClientLendingStatusByMaturity') and fieldid=3;

update reportfilterfields set FieldDbname='T3.CustCIF'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_ClientLendingStatusByMaturity') and fieldid=4;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_ClientLendingStatusByMaturity') and fieldid=7;
	    </sql>
	  </changeSet>
	     <changeSet id="31" author="pruthvi">
	    <sql>
	    update reportfilterfields set FieldDbname='T1.FinType'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PastDue') and fieldid=3;

update reportfilterfields set FieldDbname='T3.CustCIF'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PastDue') and fieldid=4;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PastDue') and fieldid=7;
	    </sql>
	  </changeSet>
	  
	<changeSet author="Srikanth" id="32">
		<createTable tableName="APILOGDETAILS">
			<column name="Reference" type="int" />
			<column name="EndPoint" type="varchar(400)" />
			<column name="Method" type="varchar(10)" />
			<column name="Type" type="varchar(10)" />
			<column name="ServiceName" type="varchar(200)" />
			<column name="Authorization" type="varchar(100)" />
			<column name="ClientIP" type="varchar(50)" />
			<column name="ValueDate" type="datetime" />
			<column name="PayLoad" type="clob" />
			<column name="ResponseCode" type="varchar(10)" />
		</createTable>
	</changeSet>
	<changeSet id="04" author="murthy.y">
			<dropPrimaryKey tableName="FORECLOSURECHARGES" constraintName="PK_DM_FCC_AGGID"/>
	 </changeSet>   
	 <changeSet  id="33" author="Prasad">
	<createView viewName="DM_DISB_DETAILS_DAILY_VIEW" replaceIfExists="true">
		  <![CDATA[select  T2.FinApprovedDate AGREEMENTDATE,substr(T2.FinReference,7,length(T2.FinReference)) APPLID,T2.FinReference AGREEMENTNO,
          T3.DisbSeq DISBURSEMENTNO,T3.DisbDate DISBURSEMENTDATE,null PARENT_AGREEMENTNO,
          udf_convertcurrency(t2.FinAmount,T2.finccy,'INR')  AMTFIN,udf_convertcurrency((t2.FinAmount - t2.DownPayment + t2.FeeChargeAmt),T2.finccy,'INR')  NET_AMTFIN,
          udf_convertcurrency(T7.DisbAmount,T2.finccy,'INR')  DISBURSEDAMT,
          CASE When T2.FINASSETVALUE=T2.FINCURRASSETVALUE THEN 'Fully Disbursed' else 'Partially Disbursed' end DISB_STATUS,
          T1.FirstRepayDate FIRST_DUE_DATE,round(MONTHS_BETWEEN( T2.MaturityDate,T2.FinStartDate)) GROSS_TENURE,T1.NOINST NET_TENURE,
          T2.MaturityDate MATURITYDATE,T2.LastRepayDate EXPIRYDATE,null NO_OF_ADV_INSTL,
          null ADV_EMI_AMT,T2.FirstRepay EMI,T2.FinRepayMethod REPAYMENT_MODE,
          T2.FinType PRODUCTFLAG,P.PROMOTIONID PROMOTIONID,null ICICI_LOMBARD,
          null BAGIC,null BALIC_CHARGES,
          (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
          'N' PROCESSED_FLAG,
          (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
          null SEGMENTS,udf_convertcurrency(T9.TotalFEE,T2.finccy,'INR') FEE,null DEALER_SUBV,null MANU_SUBV_DED,null MANU_SUBV_NDED,
          udf_convertcurrency(T2.BPIAMOUNT,T2.finccy,'INR') PREEMI,
          null EXISTING_LANNO,null MORTGAGE_FEE,null COMMITMENT_FEE,udf_convertcurrency(T10.PROCES_FEE,T2.finccy,'INR')  PROCESSING_FEE,
          null PRE_EMI_RECEIVABLE,udf_convertcurrency(T2.INSURANCEAMT,T2.finccy,'INR') INSURANCE,
          T2.FinRepayMethod PAYMENTMODE,substr(T2.REPAYFRQ,1,1) FREQ,
          FA.LLREFERENCENO CHEQUENUM,substr(FA.BENEFICIARYACCNO,1,16)  CUST_ACCT_NO,T5.BankName BANKNAME,t6.micr MICRCODE,null BUSINESS_YEAR,
          null EMI_CHARGE,null PDC_CHARGE,CASE WHEN t2.EffectiveRateOfReturn>999 then 999 else t2.EffectiveRateOfReturn end IRR_PER,
          udf_convertcurrency(T9.TotalFEE,T2.finccy,'INR') FEE_WL,
          null ELC_CHARGE,null CREDIT_VIDYA_FEES,null BATCH_ID 
from FinanceMain T2 
Inner join FINPFTDETAILS T1 on T1.FinReference=T2.FinReference
Inner join FinDisbursementDetails T3 on T3.FinReference=T2.FinReference
Inner join rmtfinancetypes T4 on T4.FinType=T2.FinType
left join bankbranches T6 on T6.Branchcode=T2.finbranch 
LEFT JOIN BMTBANKDetail T5 on t5.bankcode=t6.bankcode
left join promotions P on P.PROMOTIONCODE = T2.PROMOTIONCODE
left join (Select Finreference,SUM(DisbAmount) DisbAmount
          from FinDisbursementDetails
          where DIsbDate<=(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')
          group by Finreference)T7 on t7.FinReference=T2.FinReference
left join (Select Finreference,SUM(BalanceAmt)BalanceAmt From FINEXCESSAMOUNT 
          where AMOUNTTYPE = 'A' group by Finreference)T8 on T8.FinReference=T2.FinReference
left join (select Finreference,sum(Actualamount-waivedamount)TotalFEE from FInFeeDetail
           group by Finreference)T9 on T9.FinReference=T2.FinReference
left join (select Finreference,sum(Actualamount-waivedamount)PROCES_FEE 
           from FInFeeDetail F 
           inner join Feetypes FT on F.Feetypeid = FT.Feetypeid
           where FT.Feetypecode='PROCFEE'
           group by Finreference)T10 on T10.FinReference=T2.FinReference
left join (Select FA.FinReference,FA.BENEFICIARYACCNO,FA.LLREFERENCENO from (
           Select FinReference,max(paymentSeq)MAXpaymentSeq from FinAdvancepayments
           group by FinReference)T inner join FinAdvancepayments FA on FA.FinReference=T.FinReference and FA.paymentSeq = T.MAXpaymentSeq)FA on FA.FinReference=T2.FinReference]]>
		</createView>
	</changeSet> 
<changeSet  id="34" author="Prasad">
	<createView viewName="DM_LOAN_DETAILS_DAILY_VIEW" replaceIfExists="true">
		  <![CDATA[select substr(T1.FinReference,7,length(T1.FinReference)) APPLID,t1.finreference AGREEMENTNO,t3.CustID CUSTOMERID,
  effectiveRateofReturn CUSTOMER_YIELD,
  Case when t1.finisactive =1 then 'Active' when t1.CLOSINGSTATUS='C' 
  then 'Cancelled' else 'Closed' end STATUS,T4.NPAbucketid NPA_STAGE,null LMS_BUCKET,
  null COLL_BUCKET,null INSURANCE_APPLIED_FLG,
  (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
  'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') PROCESS_DATE,
  'LMS-DII' SEGMENTS,T1.MaturityDate CLOSUREDATE,
  null TOPUP_AMT,(Select extract(year from (to_date(sysparmvalue, 'YYYY-MM-DD')))  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESS_YEAR,
  M.Mandateid PDCID,null PCFLAG,
  Case when T1.PRODUCTCATEGORY='ODFCLITY' then 'Y' else 'N' end OD_FLAG,
  T1.RepayMargin MARGIN,T1.REPAYSPECIALRATE SPECIALMARGIN,null FIXEDTENOR,
  Null CEEFFECTIVEDATE,T1.RepayProfitRate EFF_RATE,T2.CURREDUCINGRATE PLRRATE,null PARTY_CODE,
  coalesce(T3.custFname,'')||' '||coalesce(T3.custMname,'')||' '||coalesce(T3.CustLname,'') PARTY_NAME,
  NULL ZONE,NULL COLLECTION_CENTRE,null VIRTUAL_ACCOUNT_NUMBER,
  null INSTALLMENT_TYPE,null COMPANYTYPE,
  udf_convertcurrency(T1.TotalProfit,T2.finccy,'INR')  FIANANCE_CHARGES,T1.ApplicationNo FILENO,null NO_OF_PDCS,
  null LIFEINSURANCE,udf_convertcurrency(t6.RemainingFee,T2.finccy,'INR')  SHORTRECEIVED,t3.CustShrtName IN_FAVOUR_OFF,null MKTGID,  
  udf_convertcurrency(t7.BalanceAmt,T2.finccy,'INR')  PRE_EMI_INT_500071,null LOAN_PURPOSE_DTL,null LOAN_PURPOSE_DESC,
  udf_convertcurrency(t8.tot_fee,T2.finccy,'INR')  LOGIN_FEES,null VC_REFERRAL_CD,null  VC_REFERRAL_NAME,
  null PROC_FEES2,t1.FinRepayMethod  INSTRUMENT_TYPE,null LAN_BARCODE,T1.FinStartDate  INTSTART_DATE_REGULAR,
  udf_convertcurrency(t1.BPIAmount,T2.finccy,'INR')  BPI_RECEIVABLE,null BPI_PAYABLE,
  Case when M.openmandate=1 then 'Y' else 'N' end  OPEN_FACILITY_FLAG,null BATCH_ID 
  from FinanceMain T1
  Inner join finpftdetails T2 on t1.finreference=t2.finreference
  Inner join customers T3 on T3.Custid=t1.custid
  left join Finprovisions T4 on T4.finreference=t1.finreference
  left join Mandates M on M.OrgReference =t1.finreference and M.Mandateid = t1.Mandateid
  left join (Select t1.finreference , SUM(RemainingFee)RemainingFee From Finfeedetail T1
             WHERE FeeScheduleMethod = 'DISB'
             group by t1.finreference) T6 on T1.finreference=t6.finreference
  left join (Select t1.finreference , SUM(BalanceAmt)BalanceAmt From FinExcessAmount T1
             WHERE AmountType = 'A' 
             group by t1.finreference) T7 on T1.finreference=t7.finreference
  left join (Select t1.finreference , SUM(Actualamount-waivedamount)tot_fee From Finfeedetail T1
             group by t1.finreference) T8 on T1.finreference=t8.finreference]]>
		</createView>
	</changeSet> 
	<changeSet  id="35" author="Prasad">
	<createView viewName="DM_APPLICANT_DETAILS_VIEW" replaceIfExists="true">
		  <![CDATA[select distinct t1.custid CUSTOMERID,
 Case when fp.custid is not null then 'Applicant' when FJ.CustCIF is not null then 'Co Applicant' when FG.Guarantorcif is not null then 'Guaranteer' else 'Applicant' end CUST_TYPE,
  t1.CustCRCPR PANNO, CustAddrhnbr ADDRESS1,t2.CustFlatNBr ADDRESS2,CustAddrStreet ADDRESS3,CustAddrLine1 ADDRESS4,CustAddrCity CITY,CustAddrProvince STATE,CustAddrCountry COUNTRY,
  CustAddrZip ZIPCODE,CustAddrType ADDRESSTYPE,CustEmail EMAIL,T41.phonenumber PHONE1,T42.phonenumber PHONE2,
  T4.phonenumber MOBILE,T5.phonenumber FAX,Case when T1.CUSTCOREBANK is null then 'N' else 'Y' end EXISTING_CUST_FLAG,
  case when custctgcode='RETAIL' then 'I' else 'C' end INDIV_CORP_FLAG,
  round(MONTHS_BETWEEN( (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'),T1.CUSTDOB)/12) AGE,
  CustDOB DOB,custfname FNAME,custmname MNAME,custlname LNAME,genderdesc GENDER,CustMaritalSts MARITAL_STATUS,NoOfDependents NO_OF_DEPENDENT,
  round(MONTHS_BETWEEN( (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'),T7.CUSTEMPFROM)/12) YEARS_CURRENT_JOB,
  null YEARS_PREV_JOB,
  null QUALIFICATION,null RESIDENCETYPE,null YEARS_CURR_RESI,E.EMPName EMPLOYER_DESC,
  null COMPANY_TYPE,T1.CustIndustry INDUSTRYID,null NATURE_OF_BUSINESS,
  t7.custEMPType EMPLOYMENT_TYPE,t7.custEMPDesg EMPDESG,null OCCUPATION,
  udf_convertcurrency(t1.CustTotalIncome,'INR','INR')  ANNUAL_INCOME,null GUARDIAN,
  (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
  'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,null SEGMENTS,
  CustShrtName CUSTOMERNAME,null CONTACT_PERSON_NAME,null CONSTITUTION,BBD.BankName CUST_BANK_NAME,null CUST_BANK_BRANCH,
  null EMI_CARD_LIMIT,null EMI_CARD_ACCEPT_FLAG,null EMI_CARD_SWIPE_FLAG,null EMI_CARD_ELIG,null EMI_CARD_NO,null BANK_ECS_MANDATE,
  Case when M.custid is not null then 'Y' else 'N' end OPEN_ECS_AVLB,
  M.startdate OPEN_ECS_DATE,
  (Select extract(year from (to_date(sysparmvalue, 'YYYY-MM-DD')))  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESS_YEAR,
  custsalutationcode TITLE,CUSTEMPNAME COMP_NAME,
  CUSTEMPFROM  YEARS_CURR_JOB,
  null GRADE,null FAMILY_CODE,null MINOR,null GUARDIAN_NEW,
  CustCRCPR UCIN_NO,null PREFERRED_ELIGIBILITY,null PREFERRED_CARD_ACCEPTANCE,null PREFERRED_CARD_LIMIT,CustDftBranch CUST_BRANCHID,null BATCH_ID 
  from customers T1 
  left join CustomerAddresses t2 on t1.custid=t2.custid and CUSTADDRPRIORITY=5
  left join CustomerEMails T3 on T3.custid=T1.custid and CustemailPriority=5
  left join CustomerPhoneNumbers T41 on T41.phonecustid=T1.custid and t41.PHONETYPEPRIORITY=5
  left join CustomerPhoneNumbers T42 on T42.phonecustid=T1.custid and t42.PHONETYPEPRIORITY=4
  left join CustomerPhoneNumbers T4 on T4.phonecustid=T1.custid and T4.phonetypecode ='MOBILE'
  left join CustomerPhoneNumbers T5 on T5.phonecustid=T1.custid and T5.phonetypecode= 'FAX'
  left join BMTGenders T6 on t6.gendercode=t1.custgendercode
  left join CustomerEmpDetails t7 on t7.custid = t1.custid and CurrentEmployer=1
  left join (select distinct custid from finpftdetails) fp on fp.custid = t1.custid 
 left join (select distinct CustCIF from  FINJOINTACCOUNTDETAILS FJ) FJ on FJ.CustCIF = T1.CustCIF and FJ.CustCIF  is not null
 left join (Select distinct Guarantorcif from FINGUARANTORSDETAILS )FG on FG.Guarantorcif = T1.CustCIF and FG.Guarantorcif  is not null
 left join EMPLOYERDETAIL E on E.EmployerID = t7.CustEmpName
  left join (Select custid,max(startdate)startdate from Mandates M where openmandate=1  and Mandatetype='ECS' group by custid)M on M.custid = t1.custid
 left join (Select B.custid,B.bankbranchid from (
            Select custid,max(lastmnton)lastmnton 
            from BENEFICIARY 
            group by custid )T  inner join BENEFICIARY B on B.custid=T.custid and B.lastmnton=T.lastmnton) B on B.custid =t1.custid
  left join bankbranches BB on BB.bankbranchid = B.bankbranchid
  left join bmtbankdetail BBD on BBD.bankcode =BB.bankcode]]>
		</createView>
	</changeSet> 
	<changeSet  id="36" author="Prasad">
	<createView viewName="DM_APPLICATION_DETAILS_VIEW" replaceIfExists="true">
		  <![CDATA[select substr(T2.FinReference,7,length(T2.FinReference)) APPLID,null CRM_DEALID,null CRSCOREDATE,
         null CIBILSCORE,null APPSCORE,null BEHSCORE,null DEVIATION_TYPE,null DEVIATION_FLAG,
         null DEVIATION_CODE,null DEVIATION_NAME,null REQ_TENURE,null REQ_LOAN_AMT,
         null LOAN_LIMIT,udf_convertcurrency(T1.TOTALPRISCHD,T2.finccy,'INR')  APPROVE_LOAN_AMT,null LOAN_PURPOSE,
         t1.FinType LOAN_TYPE,Case when t1.closingstatus='C' then t2.LastMntOn else null end CANCELLATIONDATE,
         null CANCEL_REASON,substr(T2.REPAYFRQ,1,1) FREQUENCY,t1.FinApprovedDate LOAN_APPROVAL_DATE,
         t2.FINCONTRACTDATE AGREEMENTDATE,
         CASE WHEN T1.CURREDUCINGRATE>999 then 999 else T1.CURREDUCINGRATE end INTRATE,
         CASE WHEN t2.EffectiveRateOfReturn>999 then 999 else t2.EffectiveRateOfReturn end FLAT_RATE,
         CASE WHEN t2.EffectiveRateOfReturn>999 then 999 else t2.EffectiveRateOfReturn end IRR,
         null GROSS_LTV,null NET_LTV,null COF,
         null DEBT_BURDEN_RATIO,null FOIR_DB,null SCHEMEID,null SCHEMEDESC,null SCHEMEGROUPID,
         null SCHEME_GROUPG_DESC,null PRODUCT_CATEGORY,t1.FinCategory PROD_TYPE,
         null PROMOTIONID,null PROGRAMID,null SURROGATE_FLAG,null SOURCING_CHANNEL_TYPE,
         null SOURCING_CHANNEL_NAME,null REFERAL_GROUP,null REFERAL_NAME,
         null COUNTRYID,null COUNTRY,null REGIONID,null REGION,null STATEID,
         null STATE,null CITYID,null CITY,t1.finbranch BRANCHID,BranchDesc BRANCHDESC,
         null BROKER_NAME,null DME_NAME,null ASM_NAME,C.custro1 RSM_NAME,
         null CRDT_MGR_NAME,null ROID_NAME,
         null TLID_NAME,null BMID_NAME,null COID_NAME,null SUPPLIERID,
         null DLR_PARTICIPATION_RATE,null LOCAL_OUTSTATION_FLG,t1.custid CUSTOMERID,
        (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')BUSINESSDATE,
        'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
        t1.fintype PRODUCT,null SEGMENTS,null CRM_STATUS,T1.FinStartDate LOGINDATE,t1.FinApprovedDate APPR_REJ_DATE,
        Case when t1.closingstatus='C' then t2.LastMntOn else null end CANCEL_DATE,
        null FILE_STATUS,null FILE_HOLD_REASON,null QDPDONE,null ISHOLD,null BRANCH_INW_DATE,
        null BRANCH_HOLD_DATE,null CPU_INW_DATE,null CPU_HOLD_DATE,null SYSTEM_HOLD,null PSL_FLAG,
        null DOC_WAVE_FLAG,null CUSTOMER_SWIPE,null CUSTOMER_ACCEPTANCE,'PAN Card' KYC_DOC_TYPE,
        CD.CustDocTitle KYC_DOC_ID,null BUSINESS_IRR,null INSPECTORNAME,null REGNUMBER,
        null BUSINESS_YEAR,null DEALID,null PRETAXIRR,null ODM_FLAG,null DI_DATE,
        null LAA_QDP_FLAG,null PREFERRED_CARD_ACCEPTANCE,
        null ORIG_AMTFIN,null ELC_FLAG,null ELC_LIMIT,null QDP_DONE_DATE,
        null LAA_DECENTRALIZED_FLAG,null FCU_FLAG,
        null MKTGID,null DM_MPID,null SWIPE_CARD_CODE,null SOURCE_CARD_CODE,
        null DII_USER_ID,null QDP_CHEQUE_ISSUE,null INTEREST_TYPE,
        null DII_DONE_DATE,null FINISH_DATE,null BATCH_ID 
from finpftdetails T1
Inner join FinanceMain T2 on T1.finreference=T2.finreference
inner join RMTBranches T3 on T3.branchcode=t1.finbranch
inner join customers C on C.custid = T2.custid
left join (select distinct custid,CustDocTitle from CUSTOMERDOCUMENTS where custdoccategory='03') CD on CD.Custid = C.custid
where substr(T2.FinReference,7,length(T2.FinReference)) is not null]]>
		</createView>
	</changeSet> 
	<changeSet  id="37" author="Prasad">
	<createView viewName="DM_COAPPLICANT_DTLS_VIEW" replaceIfExists="true">
		  <![CDATA[select t1.custid CUSTOMERID,t.APPLICANT_TYPE APPLICANT_TYPE,t1.CustCRCPR PAN_NO,
NULL CUST_RELATION,t1.custctgcode CUST_TYPE,
Case when round(MONTHS_BETWEEN((Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'), T1.CUSTDOB)/12)<=99
then round(MONTHS_BETWEEN((Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'), T1.CUSTDOB)/12) else 99 end AGE,
CustDOB DOB,CustFName FNAME,CustMName MNAME,CustLName LNAME,
GenderCode GENDER,CustMaritalSts MARITAL_STATUS,NoOfDependents NO_OF_DEPENDENT,
round(MONTHS_BETWEEN( (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'),T7.CUSTEMPFROM)/12)  YRS_CURRENTJOB,
NULL PREVIOUS_JOB_YEAR,null QUALIFICATION,E.EMPName EMPLOYER_DESC,
null COMPANY_TYPE,t1.custindustry INDUSTRYID,t1.CustSector BUSINESS_NATURE,
null OCCUPATION_CODE,null GUARDIAN,'N' PROCESS_FLAG,
(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
custEMPType EMP_TYPE,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
udf_convertcurrency(CustTotalIncome,'INR','INR')  INCOME,APPLID APPLID,NULL BATCH_ID 
from customers T1 inner join 
(Select distinct 'Co Applicant' APPLICANT_TYPE,CUSTCIF,substr(FinReference,7,length(FinReference)) APPLID from FinJointAccountDetails union
Select distinct 'Guaranteer' APPLICANT_TYPE,Guarantorcif,substr(FinReference,7,length(FinReference)) APPLID from FinGuarantorsDetails) t on t.CUSTCIF =t1.CUSTCIF
Left join bmtgenders t2 on t2.gendercode=t1.custgendercode
left join RMTCustTypes T3 on T3.custtypecode=t1.custtypecode
left join CustomerEmpDetails t7 on t7.custid = t1.custid and CurrentEmployer=1
left join EMPLOYERDETAIL E on E.EmployerID = t7.CustEmpName]]>
		</createView>
	</changeSet> 
	<changeSet  id="38" author="Prasad">
	<createView viewName="DM_OPENECS_DETAILS_VIEW" replaceIfExists="true">
		  <![CDATA[select T1.custid CUSTOMERID,T1.Mandateid ECS_ID,T2.Bankcode BANK_ID,
         T3.bankname BANK_NAME,null BANKBRANCHID,null BANKID,
         substr(T2.Branchdesc,1,50) BANK_BRANCH_NAME,PCCITYNAME CITY,T1.ACCTYPE ACCTYPE,
         T1.ACCNUMBER ACCNO,T1.MaxLimit/100 MAXLIMIT,null BALLIMIT,
         null UTIL_LIMIT,null VALID_LIMIT,
         Case when T1.Mandatetype='ECS' then 'E' WHEN T1.Mandatetype='NACH' then 'Z' WHEN T1.Mandatetype='DDM' then 'A'  end REPAY_MODE,
         T2.MICR MICRCODE,T1.Active ACTIVE_FLAG,T2.CITY CITYID,null SEGMENTS,
(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')BUSINESSDATE,
(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,null BATCH_ID 
from Mandates T1
inner join BankBranches T2 on T2.BankBranchid=t1.BankBranchid 
inner join BMTBankDetail T3 on T3.Bankcode=t2.bankcode
left join RMTPROVINCEVSCITY T4 on T4.PCCITY = T2.CITY]]>
		</createView>
	</changeSet> 
	<changeSet  id="39" author="Prasad">
	<createView viewName="DM_IVR_GATEWAY_FLEXI_VIEW" replaceIfExists="true">
		  <![CDATA[select T1.Finreference AGREEMENTNO,
        udf_convertcurrency((T2.FinAssetvalue),T1.finccy,'INR') DROP_LINE_LIMIT,udf_convertcurrency((T2.FinAssetvalue-T2.fincurrassetvalue),T1.finccy,'INR') AMOUNT_DRAWN_LIMIT,
        T1.TOTALPRISCHD UTLIZED_BALANCE_LIMIT,udf_convertcurrency(T1.TOTALPRIPAID,T1.finccy,'INR') PRINCIPLE_AMOUNT_PAID,
        udf_convertcurrency((T1.TOTALPRIBAL),T1.finccy,'INR') BALANCE_PRINCIPAL_OUTSTANDING,
        (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
       (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,null BATCH_ID 
from finpftdetails T1
Inner join financemain T2 on T1.finreference=T2.finreference]]>
		</createView>
	</changeSet> 
	<changeSet  id="40" author="Prasad">
	<createView viewName="DM_WRITEOFF_DETAILS_VIEW" replaceIfExists="true">
		  <![CDATA[select substr(T2.FinReference,7,length(T2.FinReference)) APPLID,
         t2.finreference AGREEMENTNO,WriteoffDate CHARGEOFF_DT,null CHARGEOFF_FLG,
         t1.Remarks CHARGEOFF_REASON,null SETTLEMENT_LOSS,
         udf_convertcurrency((WriteoffPrincipal+WriteoffProfit),T2.finccy,'INR')  GROSS_WRITEOFF_AMT,
         udf_convertcurrency((WriteoffPrincipal+WriteoffProfit),T2.finccy,'INR')  NET_WRITEOFF_AMT,
           (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
         'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,null SEGMENTS,
          null RECEIPT_ON_CHARGEOFF,null BUSINESS_YEAR, null BATCH_ID 
  from FinWriteoffDetail T1
  inner join financemain t2 on t1.finreference=t2.finreference]]>
		</createView>
	</changeSet> 
	<changeSet  id="41" author="Prasad">
	<createView viewName="DM_LOAN_VOUCHER_DETAILS_VIEW" replaceIfExists="true">
		  <![CDATA[SELECT NULL MODULEID,substr(P.FinEvent,1,1) STAGEID,P.LinkedTranId || '-'||TransOrder LEA_VOUCHERID,NULL FA_VOUCHERID,
       substr(P.FinEvent,1,1) VOUCHERTYPE,P.postdate VOUCHERDATE,P.valuedate VALUEDATE,RB.BankRefNo BRANCHID,RB.branchcode BRANCH_CODE,
       RB.branchdesc BRANCHDESC,RCP.Businessarea BUSINESS_AREA,AM.Profitcenterid PROFIT_CENTRE,FM.fintype PRODUCT_FLAG,
       PM.PROMOTIONCODE SCHEMEID,PM.PROMOTIONDESC SCHEMEDESC,NULL ASSIGNMENT,SUBSTR(FM.FinReference,7,
       LENGTH(FM.FinReference)) AGREEMENTID,FM.Finreference AGREEMENTNO,FM.FINAPPROVEDDATE AGREEMENTDATE,
       FP.FIRSTDISBDATE DISBURSALDATE,FM.FinIsActive LOAN_STATUS,FPR.NPABUCKETID NPA_STAGEID,
       P.Account FINNONE_GLID,AT.ACTYPEDESC GROUPGLDESC,AM.HostAccount SAPGL_CODE,
       AM.CostCenterid COST_CENTRE,
       coalesce(Case when P.Drorcr='D' then P.postamount end,0) DRAMT,
       coalesce(Case when P.Drorcr='C' then P.postamount end,0) CRAMT,
       P.Drorcr DRCR_FLAG,P.PostAmount DRCR_AMT,P.TranDesc NARRATION,
       NULL CHEQUEID,
       (SELECT to_date(sysparmvalue, 'YYYY-MM-DD') sysparmvalue FROM smtparameters WHERE SYSPARMCODE='APP_DATE') BUSINESSDATE,
       (SELECT to_date(sysparmvalue, 'YYYY-MM-DD') sysparmvalue FROM smtparameters WHERE SYSPARMCODE='VALUE_DATE') PROCESSDATE,
       NULL SEGMENT,'N' PROCESSED_FLAG,null BATCH_ID
	   FROM Postings P 
       Inner join FINANCEMAIN FM on FM.finreference=P.finreference
       Inner join FinPftDetails FP on FM.finreference=FP.finreference
       Inner join rmtbranches RB on RB.Branchcode = FM.FInBranch
       Left Join RMTCOUNTRYVSPROVINCE RCP on RCP.CPPROVINCE = rb.BranchProvince
       INNER JOIN ACCOUNTMAPPING AM  ON AM.ACCOUNT = P.ACCOUNT
       INNER JOIN RMTACCOUNTTYPES AT   ON AT.ACTYPE = AM.ACCOUNTTYPE
       Left JOIN PROMOTIONS PM ON PM.PROMOTIONCODE = FM.PROMOTIONCODE
       Left JOIN FINPROVISIONS FPR ON FPR.finreference = FM.PROMOTIONCODE]]>
		</createView>
	</changeSet> 
	<changeSet  id="42" author="Prasad">
	<createView viewName="DM_LOANWISE_REPAYSCHEDULE_VIEW" replaceIfExists="true">
		  <![CDATA[select T1.FinReference AGREEMENTNO,
substr(T1.FinReference,7,length(T1.FinReference)) AGREEMENTID,
null PROPINSTLID,t2.InstNumber EMI_NO,t2.SchDate DUEDATE,
udf_convertcurrency(t2.BalanceForPftCal,T1.finccy,'INR')  OPENING_PRINCIPAL,
udf_convertcurrency(t2.RepayAmount,T1.finccy,'INR')  INSTALMENT_AMT,
udf_convertcurrency(t2.PrincipalSchd,T1.finccy,'INR')  PRINCIPAL_AMT,
udf_convertcurrency(t2.ProfitSchd,T1.finccy,'INR')  INTEREST_AMT,
udf_convertcurrency(t2.ClosingBalance,T1.finccy,'INR')  CLOSING_PRINCIPAL,t2.SchdMethod INSTAL_TYPE,
null TOTAL_AMOUNT_DUE,
udf_convertcurrency(t1.FinAssetvalue,T1.finccy,'INR') DROPLINE_LIMIT,
udf_convertcurrency((FinAssetvalue-fincurrassetvalue),T1.finccy,'INR') ACT_AVAILABLE_LIMIT,
udf_convertcurrency(FP.TOTALPRISCHD,T1.finccy,'INR') ACT_UTILISATION_LIMIT,case when BPIOrHoliday='H' then 'Y' else 'N' end EMI_HOLIDAY,
NULL BATCH_ID,
  (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')  BUSINESSDATE
from financemain t1
inner join FINPFTDETAILS FP on t1.finreference=FP.finreference
inner join FinScheduleDetails t2 on t1.finreference=t2.finreference]]>
		</createView>
	</changeSet> 	
	<changeSet  id="43" author="Prasad">
	<createView viewName="DM_RESCH_DETAILS_DAILY_VIEW" replaceIfExists="true">
		  <![CDATA[select substr(T2.FinReference,7,length(T2.FinReference)) APPLID,t2.finreference AGREEMENTNO,
         cASE WHEN FinAssetvalue - FinCurrAssetValue > 0 THEN 'Partially Disbursed' ELSE 'Fully Disbursed' END DISB_STATUS,
         T1.Noinst GROSS_TENURE, T1.Noinst NET_TENURE,t2.MaturityDate MATURITYDATE,t2.LastRepayDate EXPIRYDATE,
         udf_convertcurrency(T1.FirstRepayAmt,T2.finccy,'INR')  EMI,t2.FinRepayMethod REPAYMENT_MODE,T1.fintype PRODUCTFLAG,
         (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,'N' PROCESSED_FLAG,
         (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
         NULL SEGMENTS,substr(t2.REPAYFRQ,1,1) FREQ,
         Case when t1.finisactive =1 then 'Active' when t1.CLOSINGSTATUS='C' 
         then 'Cancelled' else 'Closed' end LOAN_STATUS,t1.MaturityDate CLOSUREDATE,
         t1.CUSTCIF CUST_ACCT_NO,
         T7.bankname BANKNAME,T6.micr MICRCODE,t6.Branchdesc CUST_BANK_BRANCH,
        T8.PCCITYNAME  CUST_BANK_CITY,null BUSINESS_YEAR,
        t3.Mandateid PDCID,null PCFLAG,null TIE_UP,
        CASE WHEN RepayMargin>999 then 999 else RepayMargin end MARGIN, 
        T2.REPAYSPECIALRATE SPECIALMARGIN,
        t2.NumberofTerms FIXEDTENOR,null CEEFFECTIVEDATE,
        CASE WHEN t2.EffectiveRateOfReturn>999 then 999 else t2.EffectiveRateOfReturn end  EFF_RATE,T1.Curreducingrate PLRRATE,
        null TIE_UP_WITH,case when t1.finisactive=0 then LATESTRPYDATE else null end DATE_OF_CLOSURE,null PDCMS_SEQ_GENERATED_DATE,
        null INSTRUMENT_DATA_ENTRY_DATE,T2.Finapproveddate PAYMENT_AUTHORIZATION_DATE, null BATCH_ID
			from finpftdetails T1
			inner join Financemain T2 on t1.finreference=t2.finreference
			INNER JOIN mandates t3 on t3.ORGReference = t2.finreference
			inner join BankBranches T6 on T6.BankBranchid=t3.BankBranchid 
			inner join BMTBankDetail T7 on T7.Bankcode=t6.bankcode
			left join RMTPROVINCEVSCITY T8 on T8.PCCITY = T6.CITY]]>
		</createView>
	</changeSet>   
	<changeSet  id="44" author="Prasad">
	<createView viewName="DM_BOUNCE_DETAILS_VIEW" replaceIfExists="true">
		  <![CDATA[Select substr(T1.FinReference,7,length(T1.FinReference)) APPLID,FavourNumber CHEQUEID,T1.FinReference AGREEMENTNO,
        T3.Postdate BOUNCE_DATE,T4.Reason BOUNCE_REASON,T3.ADVISEAMOUNT BOUNCE_AMT,
        (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
        'N' PROCESSED_FLAG,'' PROCESS_DATE,'' SEGMENTS,cast(null as numeric(16,2)) BUSINESS_YEAR,'' CHEQUEDATE, null BATCH_ID
		from finpftdetails T1 inner join 
   		FINRECEIPTHEADER T on t.Reference = T1.FinReference inner join 
    	FINRECEIPTDETAIL T2 on T.RECEIPTID =T2.RECEIPTID And T.ReceiptMode = T2.PaymentType  inner join
     	ManualAdvise T3 on T3.RECEIPTID = T.RECEIPTID inner join
     	Bouncereasons T4 on T4.Bounceid =T3.Bounceid
   		Where T.ReceiptModeStatus  IN ('B') and T3.Advisetype=1 and T3.Bounceid>0]]>
		</createView>
	</changeSet>   
	<changeSet  id="45" author="Prasad">
	<createView viewName="DM_PREPAYMENT_DETAILS_VIEW" replaceIfExists="true">
		  <![CDATA[select 
		substr(T2.FinReference,7,length(T2.FinReference))  APPLID,t1.finreference AGREEMENTNO,
		null PREPAYMENTID,
		null PREPAYMENT_RATE,null PREPAYMENT_TYPE,
		null PREPAYMENT_PENALTY_DUE,
		null PREPAYMENT_PENALTY_PAID,null PREPAYMENT_AMT,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,'N' PROCESSED_FLAG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		'' SEGMENTS,'' PREPAYMENT_DATE,
		cast(null as numeric(8,0)) BUSINESS_YEAR, null BATCH_ID 
		from Finpftdetails t1
		  inner join financemain t2 on t1.finreference=t2.finreference]]>
		</createView>
	</changeSet>
		<changeSet id="46" author="PRASAD">
			<dropPrimaryKey tableName="DM_PROPERTY_DTL" constraintName="PK_DM_PD_APPID"/>
	 </changeSet>
	 <changeSet id="33" author="Chaitanya.ch">
	<createView viewName="TAXDOWNLOADDETAIL_VIEW" replaceIfExists="true">
		SELECT T1.POSTDATE, T1.LINKEDTRANID, T1.OLDLINKEDTRANID, T1.TRANSORDER, T1.TRANORDERID, T1.FINEVENT, 
        T1.ACCOUNT, T1.FINREFERENCE, T1.USERBRANCH, T1.POSTSTATUS STATUS,
        T1.POSTAMOUNT, T1.ACCOUNTTYPE, 
        T2.FINTYPE, T2.FINBRANCH, T2.FINAPPROVEDDATE, T2.CUSTID CUSTID,
        T4.ENTITYCODE, 
        T5.CUSTSHRTNAME, T5.CUSTCIF, T5.CUSTCRCPR,
        T6.CUSTADDRHNBR, T6.CUSTFLATNBR, T6.CUSTADDRSTREET, T6.CUSTADDRLINE1,
        T6.CUSTADDRLINE2, T6.CUSTADDRCITY, T6.CUSTADDRPROVINCE, T6.CUSTADDRCOUNTRY, 
        T6.CUSTADDRZIP CUSTADDRZIP, T6.LASTMNTON CUSTADDRLASTMNTON, T6.CUSTPOBOX, 
        T7.TAXNUMBER CUSTOMERGSTIN, T7.ADDRLINE1 TAXADDRLINE1, T7.ADDRLINE2 TAXADDRLINE2,
        T7.ADDRLINE3 TAXADDRLINE3, T7.ADDRLINE4 TAXADDRLINE4, T7.COUNTRY TAXCOUNTRY, 
        T7.PROVINCE TAXPROVINCE, T7.CITY TAXCITY, T7.PINCODE TAXPINCODE, T7.LASTMNTON TAXLASTMNTON,
        T7.TAXEXEMPTED,
        T8.CUSTCIF TAXCUSTCIF, T8.CUSTSHRTNAME TAXCUSTSHRTNAME, T8.CUSTCRCPR TAXCUSTCRCPR, 
        T9.ACCADDLVAR1 HSNSACCODE, T9.ACCADDLVAR2 NATUREOFSERVICE, T9.ACCADDLCHAR1 REVERSECHARGEAPPLICABLE,
        T9.TAXAPPLICABLE, T9.EXTRACTIONTYPE, '' ORIGINALINVOICENO, T9.ACCADDLCHAR1, T10.CCYMINORCCYUNITS
        FROM POSTINGS_TAXDOWNLOAD T1 
        INNER JOIN FINANCEMAIN T2 ON T1.FINREFERENCE = T2.FINREFERENCE 
        INNER JOIN RMTFINANCETYPES T3 ON T2.FINTYPE = T3.FINTYPE 
        INNER JOIN SMTDIVISIONDETAIL T4 ON T3.FINDIVISION = T4.DIVISIONCODE
        INNER JOIN CUSTOMERS T5 ON T5.CUSTID = T2.CUSTID
        INNER JOIN CUSTOMERAddresses T6 ON T6.CUSTID = T2.CUSTID And CustAddrPriority = 5
        LEFT JOIN FINTAXDETAIL T7 ON T7.FINREFERENCE = T1.FINREFERENCE 
        LEFT JOIN CUSTOMERS T8 ON T8.CUSTID = T7.TAXCUSTID
        INNER JOIN RMTACCOUNTTYPES T9 ON T9.ACTYPE = T1.ACCOUNTTYPE 
        INNER JOIN RMTCURRENCIES T10 ON T10.CCYCODE = T1.ACCCY
	
	</createView>

</changeSet>
 <changeSet id="34" author="Pruthvi Raj">
 <sql>
 update reportfilterfields set FieldDbname='T.FinReference'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PastDue') and fieldid=5;

update reportfilterfields set FieldDbname='T6.FinDivision'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PastDue') and fieldid=7;

update reportfilterfields set FieldDbname='T1.FinIsActive'
where reportid in (select reportid from reportconfiguration where menuitemcode='menu_Item_PastDue') and fieldid=6;
 </sql>
 </changeSet>

<changeSet id="48" author="Prasad">
	<createView viewName="DM_DISB_DETAILS_DAILY_VIEW" replaceIfExists="true">
		<![CDATA[ select T2.FinApprovedDate AGREEMENTDATE,substr(T2.FinReference,9,length(T2.FinReference)) APPLID,T2.FinReference AGREEMENTNO,
		T3.DisbSeq DISBURSEMENTNO,T3.DisbDate DISBURSEMENTDATE,null PARENT_AGREEMENTNO,
		udf_convertcurrency(t2.FinAmount,T2.finccy,'INR')  AMTFIN,udf_convertcurrency((t2.FinAmount - t2.DownPayment + t2.FeeChargeAmt),T2.finccy,'INR')  NET_AMTFIN,
		udf_convertcurrency(T7.DisbAmount,T2.finccy,'INR')  DISBURSEDAMT,
		CASE When T2.FINASSETVALUE=T2.FINCURRASSETVALUE THEN 'Fully Disbursed' else 'Partially Disbursed' end DISB_STATUS,
		T1.FirstRepayDate FIRST_DUE_DATE,round(MONTHS_BETWEEN( T2.MaturityDate,T2.FinStartDate)) GROSS_TENURE,T1.NOINST NET_TENURE,
		T2.MaturityDate MATURITYDATE,T2.LastRepayDate EXPIRYDATE,null NO_OF_ADV_INSTL,
		null ADV_EMI_AMT,T2.FirstRepay EMI,T2.FinRepayMethod REPAYMENT_MODE,
		T2.FinType PRODUCTFLAG,P.PROMOTIONID PROMOTIONID,null ICICI_LOMBARD,
		null BAGIC,null BALIC_CHARGES,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		'N' PROCESSED_FLAG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		null SEGMENTS,udf_convertcurrency(T9.TotalFEE,T2.finccy,'INR') FEE,null DEALER_SUBV,null MANU_SUBV_DED,null MANU_SUBV_NDED,
		udf_convertcurrency(T2.BPIAMOUNT,T2.finccy,'INR') PREEMI,
		null EXISTING_LANNO,null MORTGAGE_FEE,null COMMITMENT_FEE,udf_convertcurrency(T10.PROCES_FEE,T2.finccy,'INR')  PROCESSING_FEE,
		null PRE_EMI_RECEIVABLE,udf_convertcurrency(T2.INSURANCEAMT,T2.finccy,'INR') INSURANCE,
		T2.FinRepayMethod PAYMENTMODE,substr(T2.REPAYFRQ,1,1) FREQ,
		FA.LLREFERENCENO CHEQUENUM,substr(FA.BENEFICIARYACCNO,1,16)  CUST_ACCT_NO,T5.BankName BANKNAME,t6.micr MICRCODE,null BUSINESS_YEAR,
		null EMI_CHARGE,null PDC_CHARGE,CASE WHEN t2.EffectiveRateOfReturn>999 then 999 else t2.EffectiveRateOfReturn end IRR_PER,
		udf_convertcurrency(T9.TotalFEE,T2.finccy,'INR') FEE_WL,
		null ELC_CHARGE,null CREDIT_VIDYA_FEES,null BATCH_ID 
		from FinanceMain T2 
		Inner join FINPFTDETAILS T1 on T1.FinReference=T2.FinReference
		Inner join FinDisbursementDetails T3 on T3.FinReference=T2.FinReference
		Inner join rmtfinancetypes T4 on T4.FinType=T2.FinType
		left join bankbranches T6 on T6.Branchcode=T2.finbranch 
		LEFT JOIN BMTBANKDetail T5 on t5.bankcode=t6.bankcode
		left join promotions P on P.PROMOTIONCODE = T2.PROMOTIONCODE
		left join (Select Finreference,SUM(DisbAmount) DisbAmount
		from FinDisbursementDetails
		where DIsbDate<=(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')
		group by Finreference)T7 on t7.FinReference=T2.FinReference
		left join (Select Finreference,SUM(BalanceAmt)BalanceAmt From FINEXCESSAMOUNT 
		where AMOUNTTYPE = 'A' group by Finreference)T8 on T8.FinReference=T2.FinReference
		left join (select Finreference,sum(Actualamount-waivedamount)TotalFEE from FInFeeDetail
		group by Finreference)T9 on T9.FinReference=T2.FinReference
		left join (select Finreference,sum(Actualamount-waivedamount)PROCES_FEE 
		from FInFeeDetail F 
		inner join Feetypes FT on F.Feetypeid = FT.Feetypeid
		where FT.Feetypecode='PROCFEE'
		group by Finreference)T10 on T10.FinReference=T2.FinReference
		left join (Select FA.FinReference,FA.BENEFICIARYACCNO,FA.LLREFERENCENO from (
		Select FinReference,max(paymentSeq) MAXpaymentSeq from FinAdvancepayments
		group by FinReference)T inner join FinAdvancepayments FA on FA.FinReference=T.FinReference and FA.paymentSeq = T.MAXpaymentSeq)FA on FA.FinReference=T2.FinReference]]>
 	</createView>
 </changeSet>
 
 <changeSet id="49" author="Prasad">
	<createView viewName="DM_LOAN_DETAILS_DAILY_VIEW" replaceIfExists="true">
		select substr(T1.FinReference,9,length(T1.FinReference)) APPLID,t1.finreference AGREEMENTNO,t3.CustID CUSTOMERID,
		effectiveRateofReturn CUSTOMER_YIELD,
		Case when t1.finisactive =1 then 'Active' when t1.CLOSINGSTATUS='C' 
		then 'Cancelled' else 'Closed' end STATUS,T4.NPAbucketid NPA_STAGE,null LMS_BUCKET,
		null COLL_BUCKET,null INSURANCE_APPLIED_FLG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') PROCESS_DATE,
		'LMS-DII' SEGMENTS,T1.MaturityDate CLOSUREDATE,
		null TOPUP_AMT,(Select extract(year from (to_date(sysparmvalue, 'YYYY-MM-DD')))sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESS_YEAR,
		M.Mandateid PDCID,null PCFLAG,
		Case when T1.PRODUCTCATEGORY='ODFCLITY' then 'Y' else 'N' end OD_FLAG,
		T1.RepayMargin MARGIN,T1.REPAYSPECIALRATE SPECIALMARGIN,null FIXEDTENOR,
		Null CEEFFECTIVEDATE,T1.RepayProfitRate EFF_RATE,T2.CURREDUCINGRATE PLRRATE,null PARTY_CODE,
		coalesce(T3.custFname,'')||' '||coalesce(T3.custMname,'')||' '||coalesce(T3.CustLname,'') PARTY_NAME,
		NULL ZONE,NULL COLLECTION_CENTRE,null VIRTUAL_ACCOUNT_NUMBER,
		null INSTALLMENT_TYPE,null COMPANYTYPE,
		udf_convertcurrency(T1.TotalProfit,T2.finccy,'INR')FIANANCE_CHARGES,T1.ApplicationNo FILENO,null NO_OF_PDCS,
		null LIFEINSURANCE,udf_convertcurrency(t6.RemainingFee,T2.finccy,'INR')SHORTRECEIVED,t3.CustShrtName IN_FAVOUR_OFF,null MKTGID,
		udf_convertcurrency(t7.BalanceAmt,T2.finccy,'INR')PRE_EMI_INT_500071,null LOAN_PURPOSE_DTL,null LOAN_PURPOSE_DESC,
		udf_convertcurrency(t8.tot_fee,T2.finccy,'INR')LOGIN_FEES,null VC_REFERRAL_CD,null VC_REFERRAL_NAME,
		null PROC_FEES2,t1.FinRepayMethod INSTRUMENT_TYPE,null LAN_BARCODE,T1.FinStartDate INTSTART_DATE_REGULAR,
		udf_convertcurrency(t1.BPIAmount,T2.finccy,'INR') BPI_RECEIVABLE,null BPI_PAYABLE,
		Case when M.openmandate=1 then 'Y' else 'N' end OPEN_FACILITY_FLAG,null BATCH_ID 
		from FinanceMain T1
		Inner join finpftdetails T2 on t1.finreference=t2.finreference
		Inner join customers T3 on T3.Custid=t1.custid
		left join Finprovisions T4 on T4.finreference=t1.finreference
		left join Mandates M on M.OrgReference =t1.finreference and M.Mandateid = t1.Mandateid
		left join (Select t1.finreference , SUM(RemainingFee)RemainingFee From Finfeedetail T1
		WHERE FeeScheduleMethod = 'DISB'
		group by t1.finreference) T6 on T1.finreference=t6.finreference
		left join (Select t1.finreference , SUM(BalanceAmt)BalanceAmt From FinExcessAmount T1
		WHERE AmountType = 'A' 
		group by t1.finreference) T7 on T1.finreference=t7.finreference
		left join (Select t1.finreference , SUM(Actualamount-waivedamount)tot_fee From Finfeedetail T1
		group by t1.finreference) T8 on T1.finreference=t8.finreference
 	</createView>
 </changeSet>
 
<changeSet id="50" author="Prasad">
	<createView viewName="DM_INSURANCE_DETAILS_VIEW" replaceIfExists="true">
		select substr(T1.FinReference,9,length(T1.FinReference)) APPLID,T1.finreference AGREEMENTNO,
		null ASSETID,null INSURANCE_TYPE,null INSUR_PREMIUM,null INSURANCE_RENEWAL_DATE,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue 
		from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD') sysparmvalue 
		from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		null SEGMENTS,null BUSINESS_YEAR,null POLICY_TENURE,null SUM_ASSURED,null NOMINEE_NAME,null GOOD_HEALTH,
		null CRITICAL_ILLNESS_FLAG,null RELATIONSHIP,null NOMINEE_ADDRESS,null NOMINEE_RELATION,null NOMINEE_DOB,null NOMINEE_AGE,
		null NOMINEE_CONTACTNO,null NOMINEE_NAME2,null NOMINEE_ADDRESS2,null NOMINEE_RELATION2,null NOMINEE_DOB2,null NOMINEE_AGE2,
		null NOMINEE_CONTACTNO2,null DFGH,null BATCH_ID 
		from financemain t1
	</createView>
 </changeSet>
 
<changeSet id="51" author="Prasad">
	<createView viewName="DM_PROPERTY_DTL_VIEW" replaceIfExists="true">
		select null PROPERTYID,t1.finreference APPLICATIONID,null ADDRESS1,
		null ADDRESS2,null ADDRESS3,null CITY,null STATE,t1.Fintype PRODUCTFLAG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		null  PROPERTY_TYPE,null  PROPERTY_DESC,
		null PROPERTY_VALUE,null  ZIPCODE,'N'  PROCESSFLAG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		null  BATCH_ID 
		from finpftdetails t1
	</createView>
 </changeSet>
 
 <changeSet id="52" author="Prasad">
	<createView viewName="DM_APPLICANT_DETAILS_VIEW" replaceIfExists="true">
		select distinct t1.custid CUSTOMERID,
		Case when fp.custid is not null then 'Applicant' when FJ.CustCIF is not null then 'Co Applicant' when FG.Guarantorcif is not null then 'Guaranteer' else 'Applicant' end CUST_TYPE,t1.CustCRCPR PANNO, CustAddrhnbr ADDRESS1,t2.CustFlatNBr ADDRESS2,CustAddrStreet ADDRESS3,CustAddrLine1 ADDRESS4,CustAddrCity CITY,CustAddrProvince STATE,CustAddrCountry COUNTRY,CustAddrZip ZIPCODE,CustAddrType ADDRESSTYPE,CustEmail EMAIL,T41.phonenumber PHONE1,T42.phonenumber PHONE2,T4.phonenumber MOBILE,T5.phonenumber FAX,Case when T1.CUSTCOREBANK is null then 'N' else 'Y' end EXISTING_CUST_FLAG,
		case when custctgcode='RETAIL' then 'I' else 'C' end INDIV_CORP_FLAG,round(MONTHS_BETWEEN( (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'),T1.CUSTDOB)/12) AGE,CustDOB DOB,custfname FNAME,custmname MNAME,custlname LNAME,genderdesc GENDER,CustMaritalSts MARITAL_STATUS,NoOfDependents NO_OF_DEPENDENT,round(MONTHS_BETWEEN( (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'),T7.CUSTEMPFROM)/12) YEARS_CURRENT_JOB,null YEARS_PREV_JOB,null QUALIFICATION,null RESIDENCETYPE,null YEARS_CURR_RESI,E.EMPName EMPLOYER_DESC,null COMPANY_TYPE,T1.CustIndustry INDUSTRYID,null NATURE_OF_BUSINESS,t7.custEMPType EMPLOYMENT_TYPE,t7.custEMPDesg EMPDESG,null OCCUPATION,udf_convertcurrency(t1.CustTotalIncome,'INR','INR')  ANNUAL_INCOME,null GUARDIAN,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,null SEGMENTS,CustShrtName CUSTOMERNAME,null CONTACT_PERSON_NAME,null CONSTITUTION,BBD.BankName CUST_BANK_NAME,null CUST_BANK_BRANCH,null EMI_CARD_LIMIT,null EMI_CARD_ACCEPT_FLAG,null EMI_CARD_SWIPE_FLAG,null EMI_CARD_ELIG,null EMI_CARD_NO,null BANK_ECS_MANDATE,Case when M.custid is not null then 'Y' else 'N' end OPEN_ECS_AVLB,M.startdate OPEN_ECS_DATE,(Select extract(year from (to_date(sysparmvalue, 'YYYY-MM-DD')))  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESS_YEAR,
		custsalutationcode TITLE,CUSTEMPNAME COMP_NAME,CUSTEMPFROM  YEARS_CURR_JOB,null GRADE,null FAMILY_CODE,null MINOR,null GUARDIAN_NEW,CustCRCPR UCIN_NO,null PREFERRED_ELIGIBILITY,null PREFERRED_CARD_ACCEPTANCE,null PREFERRED_CARD_LIMIT,CustDftBranch CUST_BRANCHID,null BATCH_ID 
		from customers T1 
		left join CustomerAddresses t2 on t1.custid=t2.custid and CUSTADDRPRIORITY=5
		left join CustomerEMails T3 on T3.custid=T1.custid and CustemailPriority=5
		left join CustomerPhoneNumbers T41 on T41.phonecustid=T1.custid and t41.PHONETYPEPRIORITY=5
		left join CustomerPhoneNumbers T42 on T42.phonecustid=T1.custid and t42.PHONETYPEPRIORITY=4
		left join CustomerPhoneNumbers T4 on T4.phonecustid=T1.custid and T4.phonetypecode ='MOBILE'
		left join CustomerPhoneNumbers T5 on T5.phonecustid=T1.custid and T5.phonetypecode= 'FAX'
		left join BMTGenders T6 on t6.gendercode=t1.custgendercode
		left join CustomerEmpDetails t7 on t7.custid = t1.custid and CurrentEmployer=1
		left join (select distinct custid from finpftdetails) fp on fp.custid = t1.custid 
		left join (select distinct CustCIF from  FINJOINTACCOUNTDETAILS FJ) FJ on FJ.CustCIF = T1.CustCIF and FJ.CustCIF  is not null
		left join (Select distinct Guarantorcif from FINGUARANTORSDETAILS )FG on FG.Guarantorcif = T1.CustCIF and FG.Guarantorcif  is not null
		left join EMPLOYERDETAIL E on E.EmployerID = t7.CustEmpName
		left join (Select custid,max(startdate)startdate from Mandates M where openmandate=1  and Mandatetype='ECS' group by custid)M on M.custid = t1.custid
		left join (Select B.custid,B.bankbranchid from (
		Select custid,max(lastmnton)lastmnton 
		from BENEFICIARY group by custid )T  inner join BENEFICIARY B on B.custid=T.custid and B.lastmnton=T.lastmnton) B on B.custid =t1.custid
		left join bankbranches BB on BB.bankbranchid = B.bankbranchid
		left join bmtbankdetail BBD on BBD.bankcode =BB.bankcode
	</createView>
 </changeSet>
 
<changeSet id="53" author="Prasad">
	<createView viewName="DM_APPLICATION_DETAILS_VIEW" replaceIfExists="true">
		select  substr(T2.FinReference,9,length(T2.FinReference)) APPLID,null CRM_DEALID,null CRSCOREDATE,
		null CIBILSCORE,null APPSCORE,null BEHSCORE,null DEVIATION_TYPE,null DEVIATION_FLAG,
		null DEVIATION_CODE,null DEVIATION_NAME,null REQ_TENURE,null REQ_LOAN_AMT,
		null LOAN_LIMIT,udf_convertcurrency(T1.TOTALPRISCHD,T2.finccy,'INR')  APPROVE_LOAN_AMT,null LOAN_PURPOSE,
		t1.FinType LOAN_TYPE,Case when t1.closingstatus='C' then t2.LastMntOn else null end CANCELLATIONDATE,
		null CANCEL_REASON,substr(T2.REPAYFRQ,1,1) FREQUENCY,t1.FinApprovedDate LOAN_APPROVAL_DATE,
		t2.FINCONTRACTDATE AGREEMENTDATE,
		CASE WHEN T1.CURREDUCINGRATE>999 then 999 else T1.CURREDUCINGRATE end INTRATE,
		CASE WHEN t2.EffectiveRateOfReturn>999 then 999 else t2.EffectiveRateOfReturn end FLAT_RATE,
		CASE WHEN t2.EffectiveRateOfReturn>999 then 999 else t2.EffectiveRateOfReturn end IRR,
		null GROSS_LTV,null NET_LTV,null COF,
		null DEBT_BURDEN_RATIO,null FOIR_DB,null SCHEMEID,null SCHEMEDESC,null SCHEMEGROUPID,
		null SCHEME_GROUPG_DESC,null PRODUCT_CATEGORY,t1.FinCategory PROD_TYPE,
		null PROMOTIONID,null PROGRAMID,null SURROGATE_FLAG,null SOURCING_CHANNEL_TYPE,
		null SOURCING_CHANNEL_NAME,null REFERAL_GROUP,null REFERAL_NAME,
		null COUNTRYID,null COUNTRY,null REGIONID,null REGION,null STATEID,
		null STATE,null CITYID,null CITY,t1.finbranch BRANCHID,BranchDesc BRANCHDESC,
		null BROKER_NAME,null DME_NAME,null ASM_NAME,C.custro1 RSM_NAME,
		null CRDT_MGR_NAME,null ROID_NAME,
		null TLID_NAME,null BMID_NAME,null COID_NAME,null SUPPLIERID,
		null DLR_PARTICIPATION_RATE,null LOCAL_OUTSTATION_FLG,t1.custid CUSTOMERID,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')BUSINESSDATE,
		'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		t1.fintype PRODUCT,null SEGMENTS,null CRM_STATUS,T1.FinStartDate LOGINDATE,t1.FinApprovedDate APPR_REJ_DATE,
		Case when t1.closingstatus='C' then t2.LastMntOn else null end CANCEL_DATE,
		null FILE_STATUS,null FILE_HOLD_REASON,null QDPDONE,null ISHOLD,null BRANCH_INW_DATE,
		null BRANCH_HOLD_DATE,null CPU_INW_DATE,null CPU_HOLD_DATE,null SYSTEM_HOLD,null PSL_FLAG,
		null DOC_WAVE_FLAG,null CUSTOMER_SWIPE,null CUSTOMER_ACCEPTANCE,'PAN Card' KYC_DOC_TYPE,
		CD.CustDocTitle KYC_DOC_ID,null BUSINESS_IRR,null INSPECTORNAME,null REGNUMBER,
		null BUSINESS_YEAR,null DEALID,null PRETAXIRR,null ODM_FLAG,null DI_DATE,
		null LAA_QDP_FLAG,null PREFERRED_CARD_ACCEPTANCE,
		null ORIG_AMTFIN,null ELC_FLAG,null ELC_LIMIT,null QDP_DONE_DATE,
		null LAA_DECENTRALIZED_FLAG,null FCU_FLAG,
		null MKTGID,null DM_MPID,null SWIPE_CARD_CODE,null SOURCE_CARD_CODE,
		null DII_USER_ID,null QDP_CHEQUE_ISSUE,null INTEREST_TYPE,
		null DII_DONE_DATE,null FINISH_DATE,null BATCH_ID 
		from finpftdetails T1
		Inner join FinanceMain T2 on T1.finreference=T2.finreference
		inner join RMTBranches T3 on T3.branchcode=t1.finbranch
		inner join customers C on C.custid = T2.custid
		left join (select distinct custid,CustDocTitle from CUSTOMERDOCUMENTS where custdoccategory='03') CD on CD.Custid = C.custid
		where substr(T2.FinReference,9,length(T2.FinReference)) is not null
	</createView>
 </changeSet>
 
<changeSet id="54" author="Prasad">
	<createView viewName="DM_ADDRESS_DETAILS_VIEW" replaceIfExists="true">
		select row_number() over(partition by t1.custid order by t1.custid) ADDRESSID,
		t1.custid CUSTOMERID,t1.CustAddrProvince STATEID,null REGIONID,t1.CustAddrCity CITY,
		T2.PHONENUMBER STDISD,t1.CustADDRPRIORITY MAILINGADDRESS,CustAddrHnbr ADDRESS1,
		CustAddrStreet ADDRESS2,CustAddrStreet ADDRESS3,
		CustAddrZip ZIPCODE,null COUNTRY,CustAddrType ADDRESSTYPE,
		null APPLICANT_TYPE,T3.phonenumber PHONE1,T4.phonenumber PHONE2,T5.phonenumber MOBILE,
		custemail EMAIL,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		'N' PROCESSFLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		null AREA,null LANDMARK,null BUSINESS_YEAR,null BATCH_ID 
		from CustomerAddresses T1
		Inner join Customers t2 on t1.custid=t2.custid 
		left join CustomerPhoneNumbers T3 on T3.phonecustid=T1.custid and T3.PHONETYPEPRIORITY=5
		left join CustomerPhoneNumbers T4 on T4.phonecustid=T1.custid and T4.PHONETYPEPRIORITY=4
		left join CustomerPhoneNumbers T5 on T5.phonecustid=T1.custid and T5.phonetypecode ='MOBILE'
		left join CustomerEMails T6 on T6.custid=T1.custid and CustemailPriority=5
	</createView>
 </changeSet>
 
 <changeSet id="55" author="Prasad">
	<createView viewName="DM_COAPPLICANT_DTLS_VIEW" replaceIfExists="true">
		<![CDATA[select t1.custid CUSTOMERID,t.APPLICANT_TYPE APPLICANT_TYPE,t1.CustCRCPR PAN_NO,
		NULL CUST_RELATION,t1.custctgcode CUST_TYPE,
		Case when round(MONTHS_BETWEEN((Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'), T1.CUSTDOB)/12)<=99
		then round(MONTHS_BETWEEN((Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'), T1.CUSTDOB)/12) else 99 end AGE,
		CustDOB DOB,CustFName FNAME,CustMName MNAME,CustLName LNAME,
		GenderCode GENDER,CustMaritalSts MARITAL_STATUS,NoOfDependents NO_OF_DEPENDENT,
		round(MONTHS_BETWEEN( (Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE'),T7.CUSTEMPFROM)/12)  YRS_CURRENTJOB,
		NULL PREVIOUS_JOB_YEAR,null QUALIFICATION,E.EMPName EMPLOYER_DESC,
		null COMPANY_TYPE,t1.custindustry INDUSTRYID,t1.CustSector BUSINESS_NATURE,
		null OCCUPATION_CODE,null GUARDIAN,'N' PROCESS_FLAG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		custEMPType EMP_TYPE,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		udf_convertcurrency(CustTotalIncome,'INR','INR')  INCOME,APPLID APPLID,NULL BATCH_ID 
		from customers T1 inner join 
		(Select distinct 'Co Applicant' APPLICANT_TYPE,CUSTCIF,substr(FinReference,9,length(FinReference)) APPLID from FinJointAccountDetails union
		Select distinct 'Guaranteer' APPLICANT_TYPE,Guarantorcif,substr(FinReference,9,length(FinReference)) APPLID from FinGuarantorsDetails) t on t.CUSTCIF =t1.CUSTCIF
		Left join bmtgenders t2 on t2.gendercode=t1.custgendercode
		left join RMTCustTypes T3 on T3.custtypecode=t1.custtypecode
		left join CustomerEmpDetails t7 on t7.custid = t1.custid and CurrentEmployer=1
		left join EMPLOYERDETAIL E on E.EmployerID = t7.CustEmpName]]>
	</createView>
 </changeSet>
 
  <changeSet id="56" author="Prasad">
	<createView viewName="DM_OPENECS_DETAILS_VIEW" replaceIfExists="true">
		select T1.custid CUSTOMERID,T1.Mandateid ECS_ID,T2.Bankcode BANK_ID,T3.bankname BANK_NAME,null BANKBRANCHID,null BANKID,
		substr(T2.Branchdesc,1,50) BANK_BRANCH_NAME,PCCITYNAME CITY,T1.ACCTYPE ACCTYPE,T1.ACCNUMBER ACCNO,T1.MaxLimit/100 MAXLIMIT,null BALLIMIT,
		null UTIL_LIMIT,null VALID_LIMIT,Case when T1.Mandatetype='ECS' then 'E' WHEN T1.Mandatetype='NACH' then 'Z' WHEN T1.Mandatetype='DDM' then 'A'  end REPAY_MODE,
		T2.MICR MICRCODE,T1.Active ACTIVE_FLAG,T2.CITY CITYID,null SEGMENTS,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')BUSINESSDATE,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,null BATCH_ID 
		from Mandates T1
		inner join BankBranches T2 on T2.BankBranchid=t1.BankBranchid 
		inner join BMTBankDetail T3 on T3.Bankcode=t2.bankcode
		left join RMTPROVINCEVSCITY T4 on T4.PCCITY = T2.CITY
	</createView>
 </changeSet>
 
<changeSet id="57" author="Prasad">
	<createView viewName="DM_SUBQ_DISB_DETAILS_VIEW" replaceIfExists="true">
		select T2.FinApprovedDate AGREEMENTDATE, substr(T2.FinReference,9,length(T2.FinReference)) APPLID,
		T2.FinReference AGREEMENTNO,T3.DisbSeq DISBURSEMENTNO,T3.DisbDate DISBURSEMENTDATE,null PARENT_AGREEMENTNO,
		udf_convertcurrency(T2.FinAmount,T2.finccy,'INR')  AMTFIN, Null NET_AMTFIN,udf_convertcurrency(T3.DisbAmount,T2.finccy,'INR') DISBURSEDAMT,
		T3.DisbisActive DISB_STATUS,T1.FirstRepayDate FIRST_DUE_DATE,NULL GROSS_TENURE,
		null NET_TENURE,t2.MaturityDate MATURITYDATE,t2.MaturityDate EXPIRYDATE,null NO_OF_ADV_INSTL,  
		NULL ADV_EMI_AMT,t2.FirstRepay EMI,t2.FinRepayMethod REPAYMENT_MODE,
		T2.FinType PRODUCTFLAG,NULL PROMOTIONID,null  ICICI_LOMBARD,null  BAGIC,null  BALIC_CHARGES,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,null SEGMENTS,
		null  FEE,null  DEALER_SUBV,null  MANU_SUBV_DED,null  MANU_SUBV_NDED,null  PREEMI,null EXISTING_LANNO,null MORTGAGE_FEE,null COMMITMENT_FEE,
		null PROCESSING_FEE,null PRE_EMI_RECEIVABLE,null INSURANCE,null PAYMENTMODE,substr(T2.REPAYFRQ,1,1) FREQ,null CHEQUENUM,null BATCH_ID 
		from  finpftdetails T1 Inner join Financemain T2 on T1.finreference=T2.finreference
    	Inner join FinDisbursementDetails T3 on T3.finreference=t1.finreference
	</createView>
 </changeSet>
 
<changeSet id="58" author="Prasad">
	<createView viewName="DM_IVR_GATEWAY_FLEXI_VIEW" replaceIfExists="true">
		select T1.Finreference AGREEMENTNO,udf_convertcurrency((T2.FinAssetvalue),T1.finccy,'INR') DROP_LINE_LIMIT, 
		udf_convertcurrency((T2.FinAssetvalue-T2.fincurrassetvalue),T1.finccy,'INR') AMOUNT_DRAWN_LIMIT,
		T1.TOTALPRISCHD UTLIZED_BALANCE_LIMIT,udf_convertcurrency(T1.TOTALPRIPAID,T1.finccy,'INR') PRINCIPLE_AMOUNT_PAID,
		udf_convertcurrency((T1.TOTALPRIBAL),T1.finccy,'INR') BALANCE_PRINCIPAL_OUTSTANDING,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,null BATCH_ID 
		from finpftdetails T1
		Inner join financemain T2 on T1.finreference=T2.finreference
	</createView>
 </changeSet>
 
<changeSet id="59" author="Prasad">
	<createView viewName="DM_BOUNCE_DETAILS_VIEW" replaceIfExists="true">
		Select substr(T1.FinReference,9,length(T1.FinReference)) APPLID,FavourNumber CHEQUEID,T1.FinReference AGREEMENTNO,
		T3.Postdate BOUNCE_DATE,T4.Reason BOUNCE_REASON,T3.ADVISEAMOUNT BOUNCE_AMT,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		'N' PROCESSED_FLAG,'' PROCESS_DATE,'' SEGMENTS,cast(null as numeric(16,2)) BUSINESS_YEAR,'' CHEQUEDATE, null BATCH_ID
		from finpftdetails T1 
		inner join FINRECEIPTHEADER T on t.Reference = T1.FinReference 
		inner join FINRECEIPTDETAIL T2 on T.RECEIPTID =T2.RECEIPTID And T.ReceiptMode = T2.PaymentType  
		inner join ManualAdvise T3 on T3.RECEIPTID = T.RECEIPTID 
		inner join Bouncereasons T4 on T4.Bounceid =T3.Bounceid
		Where T.ReceiptModeStatus  IN ('B') and T3.Advisetype=1 and T3.Bounceid>0
	</createView>
 </changeSet>
 
<changeSet id="60" author="Prasad">
	<createView viewName="DM_WRITEOFF_DETAILS_VIEW" replaceIfExists="true">
		select  substr(T2.FinReference,9,length(T2.FinReference)) APPLID,
		t2.finreference AGREEMENTNO,WriteoffDate CHARGEOFF_DT,null CHARGEOFF_FLG,
		t1.Remarks CHARGEOFF_REASON,null SETTLEMENT_LOSS,
		udf_convertcurrency((WriteoffPrincipal+WriteoffProfit),T2.finccy,'INR')  GROSS_WRITEOFF_AMT,
		udf_convertcurrency((WriteoffPrincipal+WriteoffProfit),T2.finccy,'INR')  NET_WRITEOFF_AMT,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		'N' PROCESSED_FLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,null SEGMENTS,
		null RECEIPT_ON_CHARGEOFF,null BUSINESS_YEAR, null BATCH_ID 
		from FinWriteoffDetail T1
		inner join financemain t2 on t1.finreference=t2.finreference
	</createView>
 </changeSet>
 
 <changeSet id="61" author="Prasad">
	<createView viewName="DM_RESCH_DETAILS_DAILY_VIEW" replaceIfExists="true">
		select  substr(T2.FinReference,9,length(T2.FinReference)) APPLID,t2.finreference AGREEMENTNO,
		cASE WHEN FinAssetvalue - FinCurrAssetValue > 0 THEN 'Partially Disbursed' ELSE 'Fully Disbursed' END DISB_STATUS,
		T1.Noinst GROSS_TENURE, T1.Noinst NET_TENURE,t2.MaturityDate MATURITYDATE,t2.LastRepayDate EXPIRYDATE,udf_convertcurrency(T1.FirstRepayAmt,T2.finccy,'INR') EMI, 
		t2.FinRepayMethod REPAYMENT_MODE,T1.fintype PRODUCTFLAG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,'N' PROCESSED_FLAG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		NULL SEGMENTS,substr(t2.REPAYFRQ,1,1) FREQ,
		Case when t1.finisactive =1 then 'Active' when t1.CLOSINGSTATUS='C' then 'Cancelled' else 'Closed' end LOAN_STATUS,t1.MaturityDate CLOSUREDATE,
		t1.CUSTCIF CUST_ACCT_NO,T7.bankname BANKNAME,T6.micr MICRCODE,t6.Branchdesc CUST_BANK_BRANCH,
		T8.PCCITYNAME  CUST_BANK_CITY,null BUSINESS_YEAR,t3.Mandateid PDCID,null PCFLAG,null TIE_UP,
		CASE WHEN RepayMargin>999 then 999 else RepayMargin end MARGIN,T2.REPAYSPECIALRATE SPECIALMARGIN,
		t2.NumberofTerms FIXEDTENOR,null CEEFFECTIVEDATE,CASE WHEN t2.EffectiveRateOfReturn>999 then 999 else t2.EffectiveRateOfReturn end  EFF_RATE,T1.Curreducingrate PLRRATE,
		null TIE_UP_WITH,case when t1.finisactive=0 then LATESTRPYDATE else null end DATE_OF_CLOSURE,null PDCMS_SEQ_GENERATED_DATE,
		null INSTRUMENT_DATA_ENTRY_DATE,T2.Finapproveddate PAYMENT_AUTHORIZATION_DATE, null BATCH_ID
		from finpftdetails T1
		inner join Financemain T2 on t1.finreference=t2.finreference
		INNER JOIN mandates t3 on t3.ORGReference = t2.finreference
		inner join BankBranches T6 on T6.BankBranchid=t3.BankBranchid 
		inner join BMTBankDetail T7 on T7.Bankcode=t6.bankcode
		left join RMTPROVINCEVSCITY T8 on T8.PCCITY = T6.CITY
	</createView>
 </changeSet>
 
<changeSet id="62" author="Prasad">
	<createView viewName="DM_PRESENTATION_DETAILS_VIEW" replaceIfExists="true">
		select t1.finreference AGREEMENTNO,udf_convertcurrency(FirstRepayAmt,T2.finccy,'INR')  EMI,udf_convertcurrency(FirstRepayAmt,T2.finccy,'INR')  REPAY_TYPE,null 
		DEPOSITED_DATE,null CREDIT_STATUS,null RETURN_CODE,null RETURN_REASON,null REMARKS,null SEGMENTS,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESSDATE,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		calTerms EMI_NO,t7.bankname CUSTOMER_BANK_NAME,null BOM_BOUNCE_BUCKET,t6.micr MICR_CODE,null STATUS_UPDT_DATE,t3.ACCNUMBER CUST_BANK_AC_NO,t6.Branchdesc CUSTOMER_BANK_BRANCH,
		null CHEQUESNO,null CHEQUEDATE,null FEMI_FLAG,null HOLD_IGNORE_CODE,null HOLD_IGNORE_REASON,null DEST_ACC_HOLDER,
		t3.Mandateid PDCID,  t6.bankcode BBRANCHID, null BATCH_ID 
		from Finpftdetails t1
		inner join financemain t2 on t1.finreference=t2.finreference
		INNER JOIN mandates t3 on t3.ORGReference = t2.finreference
		inner join BankBranches T6 on T6.BankBranchid=t3.BankBranchid 
		inner join BMTBankDetail T7 on T7.Bankcode=t6.bankcode
	</createView>
</changeSet>

<changeSet id="63" author="Prasad">
	<createView viewName="DM_LEA_DOC_DTLE_VIEW" replaceIfExists="true">
		select substr(T1.FinReference,9,length(T1.FinReference))  AGREEMENTID,null APPLICABLE,
		substr(T2.FinReference,9,length(T2.FinReference))  APPLID,null APPROVED_BY,null AUTHDATE,null AUTHID,null AWB_NO,null BRANCHSTATUS,
		cast(null as numeric(8,0)) CONSTITUTION,null COURIER_NAME,'N' CRITICAL,null CUSTOMER_TYPE,
		t1.custid  CUSTOMERID,null DATE_BRANCH_STATUS,null DATELASTUPDT,null DOC_CLASSFN,null DOC_RETRIEVAL_STATUS,
		cast(null as numeric(8,0)) DOCID,null DOCTYPE,null FILE_BARCODE,null MAKERDATE,null MAKERID,null MC_STATUS,null NEW_FLAG,null ORIGINALS,
		null PACKET_TRACKER_NO,null PROPERTY_ADDRESS,null PROPERTY_CODE,null REASON,null RECEIVED,null RECEIVEDDATE,null REJECTION_REASONS,
		null RELEASED_DATE,null RELEASED_REMARKS,null REMARKS,null STAGE,null TARGETDATE,null TITLE_DOCUMENT,
		cast(null as numeric(8,0)) TXNDOCID,null VALIDTILLDATE,null VAP_LOAN_FLAG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		'N' PROCESSFLAG,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESSDATE,null SEGMENT,
		null REVISED_TARGET_DATE,null BATCH_ID
		from Finpftdetails t1
		inner join financemain t2 on t1.finreference=t2.finreference
	</createView>
</changeSet>

<changeSet id="64" author="Prasad">
	<createView viewName="DM_PREPAYMENT_DETAILS_VIEW" replaceIfExists="true">
		select substr(T2.FinReference,9,length(T2.FinReference))  APPLID,t1.finreference AGREEMENTNO,null PREPAYMENTID,null PREPAYMENT_RATE,null PREPAYMENT_TYPE,
		null PREPAYMENT_PENALTY_DUE,null PREPAYMENT_PENALTY_PAID,null PREPAYMENT_AMT,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,'N' PROCESSED_FLAG,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,
		'' SEGMENTS,'' PREPAYMENT_DATE,cast(null as numeric(8,0)) BUSINESS_YEAR, null BATCH_ID 
		from Finpftdetails t1
		inner join financemain t2 on t1.finreference=t2.finreference
	</createView>
</changeSet>

<changeSet id="65" author="Prasad">
	<createView viewName="DM_HTS_UNADJUSTED_AMT_VIEW" replaceIfExists="true">
		select substr(T1.FinReference,9,length(T1.FinReference)) APPLID, udf_convertcurrency(BalanceAmt,T1.finccy,'INR')  UNADJUSTED_AMOUNT,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,null BATCH_ID 
		from financemain T1 
		inner join (Select FinReference,sum(BalanceAmt)BalanceAmt from FINEXCESSAMOUNT
		group by FinReference)t2 on t1.FinReference =t2.FinReference
	</createView>
</changeSet>

<changeSet id="66" author="Prasad">
	<createView viewName="DM_NOC_ELIGIBLE_LOANS_VIEW" replaceIfExists="true">
		select t1.Finreference AGREEMENTNO,t1.Finreference LOANACCTNUM,t1.fintype PRODUCTFLAG,CustEmail EMAIL,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')BUSINESSDATE,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE') PROCESS_DATE,'N' PROCESSED_FLAG ,null BATCH_ID
		from Finpftdetails t1
		left join CustomerEMails T3 on T3.custid=T1.custid and custEmailPriority=5
	</createView>
</changeSet>

<changeSet id="67" author="Prasad">
	<createView viewName="DM_SEND_SOA_EMAIL_VIEW" replaceIfExists="true">
		select T1.Finreference AGREEMENTNO,t1.custid CUSTOMERID,t4.CustEmail EMAILID,substr(T2.FinReference,9,length(T2.FinReference)) AGREEMENTID,
		substr(T2.FinReference,9,length(T2.FinReference))PROCESSID,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')  GENERATION_DATE,
		null PROCESSED,t1.fintype PRODUCTFLAG,null GROUPID,T5.ActiveCnt+T6.CloseCnt TOTAL_LAN,T6.CloseCnt TOTAL_CLOSED_LAN,T5.ActiveCnt TOTAL_ACTIVE_LAN,null SWIPE_FLAG,null 
		EMI_CARD_NO,T1.latestDisbDate DISBURSEMENT_DATE,null SUPPLIERID,null SUPPLIERDESC,udf_convertcurrency(TotalPriSchd,T2.finccy,'INR')  AMT_FIN,
		udf_convertcurrency(FirstRepayAmt,T2.finccy,'INR') EMI,NextRepayDate NEXT_EMI_DUE_DATE,null CHEQUE_BOUNCE_CHARGE, null BATCH_ID 
		from Finpftdetails t1
		inner join financemain t2 on t1.finreference=t2.finreference
		Inner join customers T3 on T3.custid=T1.custid
		left join CustomerEMails T4 on T4.custid=T3.custid and custEmailPriority=5
		Left join (Select CustID,COUNT(*)ActiveCnt from FinPftDetails
				where (FinIsActive=1) group by CustID)T5 ON T1.CustID =T5.CustID  
		Left join (Select CustID,COUNT(*)CloseCnt from FinPftDetails
				where (FinIsActive!=1)group by CustID)T6 ON T1.CustID =T6.CustID
	</createView>
</changeSet>

<changeSet id="68" author="Prasad">
	<createView viewName="DM_LOAN_VOUCHER_DETAILS_VIEW" replaceIfExists="true">
		SELECT NULL MODULEID,substr(P.FinEvent,1,1) STAGEID,P.LinkedTranId || '-'||TransOrder LEA_VOUCHERID,NULL FA_VOUCHERID,
		substr(P.FinEvent,1,1) VOUCHERTYPE,P.postdate VOUCHERDATE,P.valuedate VALUEDATE,RB.BankRefNo BRANCHID,RB.branchcode BRANCH_CODE,
		RB.branchdesc BRANCHDESC,RCP.Businessarea BUSINESS_AREA,AM.Profitcenterid PROFIT_CENTRE,FM.fintype PRODUCT_FLAG,
		PM.PROMOTIONCODE SCHEMEID,PM.PROMOTIONDESC SCHEMEDESC,NULL ASSIGNMENT,SUBSTR(FM.FinReference,7,
		LENGTH(FM.FinReference)) AGREEMENTID,FM.Finreference AGREEMENTNO,FM.FINAPPROVEDDATE AGREEMENTDATE,
		FP.FIRSTDISBDATE DISBURSALDATE,FM.FinIsActive LOAN_STATUS,FPR.NPABUCKETID NPA_STAGEID,
		P.Account FINNONE_GLID,AT.ACTYPEDESC GROUPGLDESC,AM.HostAccount SAPGL_CODE,
		AM.CostCenterid COST_CENTRE,
		coalesce(Case when P.Drorcr='D' then P.postamount end,0) DRAMT,
		coalesce(Case when P.Drorcr='C' then P.postamount end,0) CRAMT,
		P.Drorcr DRCR_FLAG,P.PostAmount DRCR_AMT,P.TranDesc NARRATION,
		NULL CHEQUEID,
		(SELECT to_date(sysparmvalue, 'YYYY-MM-DD') sysparmvalue FROM smtparameters WHERE SYSPARMCODE='APP_DATE') BUSINESSDATE,
		(SELECT to_date(sysparmvalue, 'YYYY-MM-DD') sysparmvalue FROM smtparameters WHERE SYSPARMCODE='VALUE_DATE') PROCESSDATE,
		NULL SEGMENT,'N' PROCESSED_FLAG,null BATCH_ID
		FROM Postings P 
		Inner join FINANCEMAIN FM on FM.finreference=P.finreference
		Inner join FinPftDetails FP on FM.finreference=FP.finreference
		Inner join rmtbranches RB on RB.Branchcode = FM.FInBranch
		Left Join RMTCOUNTRYVSPROVINCE RCP on RCP.CPPROVINCE = rb.BranchProvince
		INNER JOIN ACCOUNTMAPPING AM  ON AM.ACCOUNT = P.ACCOUNT
		INNER JOIN RMTACCOUNTTYPES AT   ON AT.ACTYPE = AM.ACCOUNTTYPE
		Left JOIN PROMOTIONS PM ON PM.PROMOTIONCODE = FM.PROMOTIONCODE
		Left JOIN FINPROVISIONS FPR ON FPR.finreference = FM.PROMOTIONCODE
	</createView>
</changeSet>

<changeSet id="69" author="Prasad">
	<createView viewName="DM_LOANWISE_CHARGE_DTLS_VIEW" replaceIfExists="true">
		select substr(T1.FinReference,9,length(T1.FinReference))  AGREEMENTID,null TXNADVICEID,null CHARGEID,null CHARGECODEID,null CHARGEDESC,null CHARGEAMT,null STATUS,
		null AMTINPROCESS,null TXNADJUSTEDAMT,null ADVICEAMT,'' ADVICEDATE,(Select to_date(sysparmvalue, 'YYYY-MM-DD') sysparmvalue 
		from smtparameters where SYSPARMCODE='APP_DATE') BUSINESSDATE,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='VALUE_DATE')  PROCESSDATE,'N' PROCESSED_FLAG,'' SEGMENT,null BATCH_ID
		from Finpftdetails t1
		inner join financemain t2 on t1.finreference=t2.finreference
	</createView>
</changeSet>

<changeSet id="70" author="Prasad">
	<createView viewName="DM_LOANWISE_REPAYSCHEDULE_VIEW" replaceIfExists="true">
		select T1.FinReference AGREEMENTNO,substr(T1.FinReference,9,length(T1.FinReference)) AGREEMENTID,
		null PROPINSTLID,t2.InstNumber EMI_NO,t2.SchDate DUEDATE,
		udf_convertcurrency(t2.BalanceForPftCal,T1.finccy,'INR')  OPENING_PRINCIPAL,
		udf_convertcurrency(t2.RepayAmount,T1.finccy,'INR')  INSTALMENT_AMT,
		udf_convertcurrency(t2.PrincipalSchd,T1.finccy,'INR')  PRINCIPAL_AMT,
		udf_convertcurrency(t2.ProfitSchd,T1.finccy,'INR')  INTEREST_AMT,
		udf_convertcurrency(t2.ClosingBalance,T1.finccy,'INR')  CLOSING_PRINCIPAL,t2.SchdMethod INSTAL_TYPE,
		null TOTAL_AMOUNT_DUE,
		udf_convertcurrency(t1.FinAssetvalue,T1.finccy,'INR') DROPLINE_LIMIT,
		udf_convertcurrency((FinAssetvalue-fincurrassetvalue),T1.finccy,'INR') ACT_AVAILABLE_LIMIT,
		udf_convertcurrency(FP.TOTALPRISCHD,T1.finccy,'INR') ACT_UTILISATION_LIMIT,case when BPIOrHoliday='H' then 'Y' else 'N' end EMI_HOLIDAY,
		NULL BATCH_ID,
		(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE')  BUSINESSDATE
		from financemain t1
		inner join FINPFTDETAILS FP on t1.finreference=FP.finreference
		inner join FinScheduleDetails t2 on t1.finreference=t2.finreference
	</createView>
</changeSet>

<changeSet id="71" author="Prasad">
	<createView viewName="FORECLOSURECHARGES_VIEW" replaceIfExists="true">
		select 
		substr(T1.FinReference,9,length(T1.FinReference)) AGREEMENTID,udf_convertcurrency(t3.PriAmount,T2.finccy,'INR')  BAL_PRINCIPAL,null RESEDUL_VALUE,null INSTALLMENTS,
		null ADVICES,null PENALTY,udf_convertcurrency(t4.PftAmount,T2.finccy,'INR')  INTREST_ON_TERMINATION,null FLOATINTREST_ON_TERMINATION,
		null OVER_DUES,null CURRENT_OVERDUES,null CURRENT_WAVEOFFAMT,null OVER_DISTANCE_CHARGES,
		null INTREST_ON_TERMINATION_PER_DAY,null INTREST_ACCRUALS,null EXCESS_AMOUNT,null EXCESS_REFUND,
		null ADVICE,null REBATE,null ADVINSTL,null EXCESSPRINPMNT,null SDAMT,
		null SDINT,null EXCESS_INTREST_RATE,null VAT_ON_FORECLOSURE,null UNDER_DISTANCE_CHARGES,
		null NET_PAYBALE,udf_convertcurrency(t5.TotalFeeAmount,T2.finccy,'INR')  WAIVEOFFAMOUNT,null ACTIVITY,null AUTHORIZEDON,null COMMITMENT_FEE,null ORIGINATION_FEE,
		null PRE_EMI,(Select to_date(sysparmvalue, 'YYYY-MM-DD')  sysparmvalue from smtparameters where SYSPARMCODE='APP_DATE') BUSINESS_DATE,
		null CHEQUEID,null STATUS,null INTEREST_WAIVE_OFF,null BALANCE_PRIN_WAIVE_OFF,
		udf_convertcurrency(t6.LPFTWaivedAmount,T2.finccy,'INR')  INSTALLMET_INT_WAIVE_OFF,udf_convertcurrency(t7.PFTWaivedAmount,T2.finccy,'INR')  WOFF_CURRMONTH_INT,udf_convertcurrency(t8.ODCWaivedAmount,T2.finccy,'INR')  WOFF_OVERDUE_CHARGE,null WOFF_CHQBOUNCE_CHARGES,
		null WOFF_OTHERS,null INSTALLMENT_PRIN_WAIVE_OFF,null WOFF_PARKING_CHARGES,null TOT_OTHER_REPO_CHARGES,
		null WOFF_OTHER_REPO_CHARGES,null TOT_REPOSESSION_CHARGES,null WOFF_REPOSESSION_CHARGES,null TOT_PARKING_CHARGES,null BATCH_ID
		from Finpftdetails t1
		inner join financemain t2 on t1.finreference=t2.finreference
		left join (select finreference,sum(PriAmount)PriAmount from FinRepayHeader where FinEvent = 'EarlySettlement' group by finreference) t3 on  t3.finreference=t2.finreference  
		left join (select finreference,sum(PftAmount)PftAmount from FinRepayHeader where FinEvent = 'EarlySettlement' group by finreference) t4 on  t4.finreference=t2.finreference  
		left join (select reference,receiptid,sum(TotFeeAmount)TotalFeeAmount from FinReceiptHeader where receiptpurpose = 'EarlySettlement' group by reference,receiptid) t5 on  t5.reference=t2.finreference  
		left join (select receiptid,sum(WaivedAmount)LPFTWaivedAmount from ReceiptAllocationDetail where allocationType = 'LPFT' group by receiptid) t6 on  t6.receiptid=t5.receiptid  
		left join (select receiptid,sum(WaivedAmount)PFTWaivedAmount from ReceiptAllocationDetail where allocationType = 'PFT' group by receiptid) t7 on  t7.receiptid=t5.receiptid  
		left join (select receiptid,sum(WaivedAmount)ODCWaivedAmount from ReceiptAllocationDetail where allocationType = 'ODC' group by receiptid) t8 on  t8.receiptid=t5.receiptid
	</createView>
</changeSet>	
</databaseChangeLog>