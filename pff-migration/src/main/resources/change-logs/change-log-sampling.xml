<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
	<property name="add.schema" value="dbo." dbms="mssql" />
	<property name="add.schema" value=" " dbms="oracle" />
	<property name="call.substr" value="substring" dbms="mssql" />
	<property name="call.substr" value="substr" dbms="oracle" />
	<property name="call.substr" value="substring" dbms="postgresql" />
	<property name="call.auditdb" value="PFFBFSQCAudit.." dbms="mssql" />
	<property name="call.auditdb" value=" " dbms="oracle" />
	<property name="call.concatenate" value="+" dbms="mssql" />
	<property name="call.concatenate" value="||" dbms="oracle" />
	<property name="call.concatenate" value="||" dbms="postgresql" />
	<property name="call.collength" value="LEN" dbms="mssql" />
	<property name="call.collength" value="LENGTH" dbms="oracle" />
	<property name="call.collength" value="LENGTH" dbms="postgresql" />
	<property name="call.date" value="getdate()" dbms="mssql" />
	<property name="call.date" value="sysdate" dbms="oracle" />
	<property name="call.date" value="now()::timestamp" dbms="postgresql" />

	<changeSet id="pre_run_for_pgp" author="murthy.y" runAlways="true"
		dbms="postgresql">
		<sql>
			Set search_path = plf,public,pg_catalog;
		</sql>
	</changeSet>
	<changeSet id="1" author="murthy.y">
		<sql>
			<![CDATA[
				delete from  LimitCodeDetail where LimitCode = 'SAMPINIT';
				delete from  LimitCodeDetail where LimitCode = 'SAMPAPPR';
		
				INSERT INTO limitcodedetail VALUES ((select max(limitid)+1 from limitcodedetail),'SAMPINIT','Sampling Initiation', 1);
				INSERT INTO limitcodedetail VALUES ((select max(limitid)+1 from limitcodedetail),'SAMPAPPR','Sampling Approval', 1);
				
				delete from reasons where reasontypeid IN (select id from reasontypes where code IN ('SAMPLINGRR')) and reasoncategoryId IN (select id from reasoncategory where code IN ('SAMPLINGRR'));
				delete from reasontypes where code IN ('SAMPLINGRR');
				delete from reasoncategory where code IN ('SAMPLINGRR');
				
				update seqreasontypes set seqno = (select coalesce(max(Id), 0) from reasontypes_view);
				update seqreasoncategory set seqno = (select coalesce(max(Id), 0) from reasoncategory_view);
				update seqreasons set seqno = (select coalesce(max(Id), 0) from reasons_view);
				
				insert into reasontypes values((select coalesce(max(Id), 0)+1 from reasontypes_view), 'SAMPLINGRR', 'Sampling resumit reason type.', 1, 1000, CURRENT_TIMESTAMP,'Approved', ' ', ' ', ' ', ' ', ' ', 0);
				update seqreasontypes set seqno = (select coalesce(max(Id), 0) from reasontypes_view);
				
				insert into reasoncategory values((select coalesce(max(Id), 0)+1 from reasoncategory_view), 'SAMPLINGRR', 'Sampling resumit reason category.', 1, 1000, CURRENT_TIMESTAMP,'Approved', ' ', ' ', ' ', ' ', ' ', 0);
				update seqreasoncategory set seqno = (select coalesce(max(Id), 0) from reasoncategory_view);
				
				delete from bmtdocumenttypes where categoryid=8;
				delete from DocumentCategory where id = 8;				
				Insert Into DocumentCategory values (8,'SAMPLING', 'Sampling Documents');
			]]>
		</sql>
	</changeSet>
	<changeSet id="2" author="murthy.y" dbms="postgresql">
		<createSequence sequenceName="SeqSampling" startValue="1"
			maxValue="9223372036854775807" incrementBy="1" />
	</changeSet>
	<changeSet id="2.1" author="murthy.y" dbms="oracle">
		<createSequence sequenceName="SeqSampling" startValue="1"
			maxValue="9223372036854775807" incrementBy="1" />
	</changeSet>
	<changeSet id="2.2" author="murthy.y" dbms="mssql">
		<createTable tableName="SeqSampling">
			<column name="SeqNo" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="Value" type="int">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="3.0" author="murthy.y" dbms="postgresql">
		<createSequence sequenceName="SeqCollateralLink"
			startValue="1" maxValue="9223372036854775807" incrementBy="1" />
	</changeSet>
	<changeSet id="3.1" author="murthy.y" dbms="oracle">
		<createSequence sequenceName="SeqCollateralLink"
			startValue="1" maxValue="9223372036854775807" incrementBy="1" />
	</changeSet>
	<changeSet id="3.2" author="murthy.y" dbms="mssql">
		<createTable tableName="SeqCollateralLink">
			<column name="SeqNo" type="bigint" autoIncrement="true">
				<constraints nullable="false" />
			</column>
			<column name="Value" type="int">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="4.0" author="murthy.y">
		<addColumn tableName="financemain">
			<column name="samplingRequired" type="smallint" defaultValue="0" />
		</addColumn>
		<addColumn tableName="financemain_temp">
			<column name="samplingRequired" type="smallint" defaultValue="0" />
		</addColumn>
	</changeSet>
	<changeSet id="5.0" author="murthy.y">
		<createTable tableName="sampling_temp">
			<column name="id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="keyReference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="createdBy" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="createdOn" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="tenure" type="int" />
			<column name="interestRate" type="number(13,9)" />
			<column name="foirEligibility" type="number(18,0)" />
			<column name="emi" type="number(18,0)" />
			<column name="loanEligibility" type="number(18,0)" />
			<column name="irrEligibility" type="number(18,0)" />
			<column name="totalIncome" type="number(18,0)" />
			<column name="totalLiability" type="number(18,0)" />
			<column name="remarks" type="varchar(500)" />
			<column name="samplingOn" type="datetime" />
			<column name="decision" type="int" />
			<column name="recommendedAmount" type="number(18,0)" />
			<column name="decisionOn" type="datetime" />
			<column name="reSubmitReason" type="bigint" />
			<column name="auxiliary1" type="varchar(50)" />
			<column name="auxiliary2" type="varchar(50)" />
			<column name="auxiliary3" type="varchar(50)" />
			<column name="auxiliary4" type="varchar(50)" />
			<column name="auxiliary5" type="varchar(50)" />

			<column name="version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="lastMntBy" type="bigint" />
			<column name="lastMntOn" type="datetime" />
			<column name="recordStatus" type="varchar(50)" />
			<column name="roleCode" type="varchar(100)" />
			<column name="nextRoleCode" type="varchar(200)" />
			<column name="taskId" type="varchar(50)" />
			<column name="nextTaskId" type="varchar(200)" />
			<column name="recordType" type="varchar(50)" />
			<column name="workflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="5.1" author="murthy.y">
		<createTable tableName="sampling">
			<column name="id" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="keyReference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="createdBy" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="createdOn" type="datetime">
				<constraints nullable="false" />
			</column>
			<column name="tenure" type="int" />
			<column name="interestRate" type="number(13,9)" />
			<column name="foirEligibility" type="number(18,0)" />
			<column name="emi" type="number(18,0)" />
			<column name="loanEligibility" type="number(18,0)" />
			<column name="irrEligibility" type="number(18,0)" />
			<column name="totalIncome" type="number(18,0)" />
			<column name="totalLiability" type="number(18,0)" />
			<column name="remarks" type="varchar(500)" />
			<column name="samplingOn" type="datetime" />
			<column name="decision" type="int" />
			<column name="recommendedAmount" type="number(18,0)" />
			<column name="decisionOn" type="datetime" />
			<column name="reSubmitReason" type="bigint" />
			<column name="auxiliary1" type="varchar(50)" />
			<column name="auxiliary2" type="varchar(50)" />
			<column name="auxiliary3" type="varchar(50)" />
			<column name="auxiliary4" type="varchar(50)" />
			<column name="auxiliary5" type="varchar(50)" />

			<column name="version" type="int">
				<constraints nullable="false" />
			</column>
			<column name="lastMntBy" type="bigint" />
			<column name="lastMntOn" type="datetime" />
			<column name="recordStatus" type="varchar(50)" />
			<column name="roleCode" type="varchar(100)" />
			<column name="nextRoleCode" type="varchar(200)" />
			<column name="taskId" type="varchar(50)" />
			<column name="nextTaskId" type="varchar(200)" />
			<column name="recordType" type="varchar(50)" />
			<column name="workflowId" type="bigint" />
		</createTable>
	</changeSet>
	<changeSet id="6.0" author="murthy.y">
		<createTable tableName="link_sampling_incomes">
			<column name="samplingId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="custId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="linkId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="6.1" author="murthy.y">
		<createTable tableName="link_sampling_incomes_snap">
			<column name="samplingId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="custId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="linkId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="7.0" author="murthy.y">
		<createTable tableName="link_sampling_liabilities">
			<column name="samplingId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="custId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="linkId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="7.1" author="murthy.y">
		<createTable tableName="link_sampling_liabilities_snap">
			<column name="samplingId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="custId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="linkId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="8.0" author="murthy.y">
		<createTable tableName="link_sampling_collaterals">
			<column name="samplingId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="collateralreference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="linkId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="8.1" author="murthy.y">
		<createTable tableName="link_sampling_collaterals_snap">
			<column name="samplingId" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="collateralreference" type="varchar(20)">
				<constraints nullable="false" />
			</column>
			<column name="linkId" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	<changeSet id="8.2" author="murthy.y">
		<createTable tableName="sampling_remarks">
			<column name="samplingId" type="bigint">
				<constraints nullable="false"/>
			</column>
			<column name="fieldName" type="varchar(60)">
				<constraints nullable="false"/>
			</column>
			<column name="remarks" type="varchar(500)"/>
		</createTable>
	</changeSet>
	<changeSet id="9.0" author="murthy.y">
		<addPrimaryKey tableName="sampling_temp" columnNames="id"
			constraintName="pk_sampling_temp_id" />
		<addPrimaryKey tableName="sampling" columnNames="id"
			constraintName="pk_sampling_id" />
		<addPrimaryKey tableName="link_sampling_incomes"
			columnNames="samplingid, custid" constraintName="pk_sampling_incomes" />
		<addPrimaryKey tableName="link_sampling_liabilities"
			columnNames="samplingid, custid" constraintName="pk_sampling_liabilities" />
		<addPrimaryKey tableName="link_sampling_collaterals"
			columnNames="samplingid, collateralreference" constraintName="pk_sampling_collaterals" />
		<addPrimaryKey tableName="link_sampling_incomes_snap"
			columnNames="samplingid, custid" constraintName="pk_sampling_incomes_snap" />
		<addPrimaryKey tableName="link_sampling_liabilities_snap"
			columnNames="samplingid, custid" constraintName="pk_sampling_liabilities_snap" />
		<addPrimaryKey tableName="link_sampling_collaterals_snap"
			columnNames="samplingid, collateralreference" constraintName="pk_sampling_collaterals_snap" />
		<addPrimaryKey tableName="sampling_remarks" columnNames="samplingId, fieldName"
			constraintName="pk_sampling_id_fn" />

		<addForeignKeyConstraint constraintName="fk_sampling_temp_rsreason"
			referencedTableName="Reasons" referencedColumnNames="id"
			baseTableName="sampling_temp" baseColumnNames="resubmitReason" />
		<addForeignKeyConstraint constraintName="fk_sampling_rsreason"
			referencedTableName="Reasons" referencedColumnNames="id"
			baseTableName="sampling" baseColumnNames="resubmitReason" />

		<addForeignKeyConstraint constraintName="fk_link_sampling_incomes_cid"
			referencedTableName="customers" baseColumnNames="custid"
			baseTableName="link_sampling_incomes" referencedColumnNames="custid" />
		<addForeignKeyConstraint constraintName="fk_link_liabilities_cid"
			referencedTableName="customers" baseColumnNames="custid"
			baseTableName="link_sampling_liabilities" referencedColumnNames="custid" />
		<addForeignKeyConstraint constraintName="fk_sampling_sid"
			referencedTableName="sampling" referencedColumnNames="id"
			baseTableName="sampling_remarks" baseColumnNames="samplingId" />

		<createIndex tableName="sampling_temp" indexName="ix_sampling_temp_keyReference">
			<column name="keyReference"></column>
		</createIndex>
		<createIndex tableName="sampling" indexName="ix_sampling_keyReference">
			<column name="keyReference"></column>
		</createIndex>
		<createIndex tableName="link_sampling_incomes" indexName="ix_link_sampling_incomes_lid">
			<column name="linkId" />
		</createIndex>
		<createIndex tableName="link_sampling_liabilities"
			indexName="ix_link_sampling_liabilit_lid">
			<column name="linkId" />
		</createIndex>
		<createIndex tableName="link_sampling_collaterals"
			indexName="ix_link_sampling_collatrl_lid">
			<column name="linkId" />
		</createIndex>
		<createIndex tableName="link_sampling_incomes_snap"
			indexName="ix_link_sampling_incm_snap_lid">
			<column name="linkId" />
		</createIndex>
		<createIndex tableName="link_sampling_liabilities_snap"
			indexName="ix_link_sampling_libt_snap_lid">
			<column name="linkId" />
		</createIndex>
		<createIndex tableName="link_sampling_collaterals_snap"
			indexName="ix_link_sampling_col_snap_lid">
			<column name="linkId" />
		</createIndex>
	</changeSet>
	<changeSet id="10.0" author="murthy.y">
		<createView viewName="financemain_view" replaceIfExists="true">
			SELECT t1.finreference,
			t1.investmentref,
			t1.numberofterms,
			t1.grcperiodenddate,
			t1.allowgrcperiod,
			t1.gracebaserate,
			t1.gracespecialrate,
			t1.grcpftrate,
			t1.grcpftfrq,
			t1.nextgrcpftdate,
			t1.allowgrcpftrvw,
			t1.grcpftrvwfrq,
			t1.nextgrcpftrvwdate,
			t1.allowgrccpz,
			t1.grccpzfrq,
			t1.nextgrccpzdate,
			t1.repaybaserate,
			t1.repayspecialrate,
			t1.repayprofitrate,
			t1.repayfrq,
			t1.nextrepaydate,
			t1.repaypftfrq,
			t1.nextrepaypftdate,
			t1.allowrepayrvw,
			t1.repayrvwfrq,
			t1.nextrepayrvwdate,
			t1.allowrepaycpz,
			t1.repaycpzfrq,
			t1.nextrepaycpzdate,
			t1.maturitydate,
			t1.cpzatgraceend,
			t1.downpayment,
			t1.graceflatamount,
			t1.reqrepayamount,
			t1.totalprofit,
			t1.totalcpz,
			t1.totalgrosspft,
			t1.totalgrossgrcpft,
			t1.totalgracepft,
			t1.totalgracecpz,
			t1.grcratebasis,
			t1.repayratebasis,
			t1.fintype,
			t1.finremarks,
			t1.finccy,
			t1.schedulemethod,
			t1.profitdaysbasis,
			t1.reqmaturity,
			t1.calterms,
			t1.calmaturity,
			t1.firstrepay,
			t1.lastrepay,
			t1.finstartdate,
			t1.finamount,
			((t1.finamount + t1.feechargeamt) - t1.downpayment) AS lovdescfinancingamount,
			t1.finrepaymentamount,
			t1.custid,
			t1.defferments,
			t1.plandefercount,
			t1.finbranch,
			t1.finsourceid,
			t1.alloweddefrpychange,
			t1.availeddefrpychange,
			t1.alloweddeffrqchange,
			t1.availeddeffrqchange,
			t1.recaltype,
			t1.finassetvalue,
			t1.disbaccountid,
			t1.repayaccountid,
			t1.finisactive,
			t1.limitvalid,
			t1.overridelimit,
			t1.securitydeposit,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t7.fintypedesc AS lovdescfintypename,
			t7.finmaxamount AS lovdescfinmaxamt,
			t7.finminamount AS lovdescfinminamount,
			t1.mindownpayperc,
			t7.finisalwdifferment AS lovdescfinalwdeferment,
			t7.finisdwpayrequired AS lovdescdwnpayreq,
			t7.finmaxdifferment AS lovdescfinmaxdifferment,
			t12.branchdesc AS lovdescfinbranchname,
			t1.lastrepaydate,
			t1.lastrepaypftdate,
			t1.lastrepayrvwdate,
			t1.lastrepaycpzdate,
			t1.allowgrcrepay,
			t1.grcschdmthd,
			t1.grcmargin,
			t1.repaymargin,
			t1.fincurrassetvalue,
			t1.fincommitmentref,
			t1.finlimitref,
			t1.depreciationfrq,
			t1.fincontractdate,
			t1.nextdepdate,
			t1.lastdepdate,
			t1.finaccount,
			t1.fincustpftaccount,
			t17.acrtilllbd AS lovdescaccruedtilllbd,
			t7.finrvwrateapplfor,
			t1.totalrepayamt,
			t1.closingstatus,
			t1.finapproveddate,
			t1.feechargeamt,
			t1.blacklisted,
			t1.finrepaypftonfrq,
			t1.anualizedpercrate,
			t1.effectiverateofreturn,
			t1.migratedfinance,
			t1.schedulemaintained,
			t1.scheduleregenerated,
			t1.finpurpose,
			t1.finstatus,
			t1.finstsreason,
			t1.initiateuser,
			t1.bankname,
			t1.iban,
			t1.accounttype,
			t1.ddareferenceno,
			t7.finscheduleon AS lovdescfinscheduleon,
			t1.custdsr,
			t1.jointaccount,
			t1.jointcustid,
			t1.downpaybank,
			t1.downpaysupl,
			t1.downpayaccount,
			t1.securitycollateral,
			t1.approved,
			t1.discrepancy,
			t1.limitapproved,
			t1.graceterms,
			t7.findivision AS lovdescfindivision,
			t1.rcdmaintainsts,
			t1.finrepaymethod,
			t1.grcprofitdaysbasis,
			t1.stepfinance,
			t1.steptype,
			t1.steppolicy,
			t1.alwmanualsteps,
			t1.noofsteps,
			t1.linkedfinref,
			t1.nextuserid,
			t1.priority,
			t24.policydesc AS lovdescsteppolicyname,
			t1.grcminrate,
			t1.grcmaxrate,
			t1.rpyminrate,
			t1.rpymaxrate,
			t1.deviationapproval,
			t1.manualschedule,
			t1.takeoverfinance,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.supplementrent,
			t1.increasedcost,
			t1.rolloverfrq,
			t1.nextrolloverdate,
			t27.custstsdescription,
			t1.shariastatus,
			t1.initiatedate,
			t1.finpreapprovedref,
			t1.mmaid,
			t1.accountsofficer,
			t1.feeaccountid,
			t1.fincancelac,
			t28.dealername AS lovdescaccountsofficer,
			t28.dealercity AS lovdescsourcecity,
			t1.dsacode,
			t30.rofficerdesc AS dsacodedesc,
			t1.tdsapplicable,
			t1.mandateid,
			t1.droplinefrq,
			t1.firstdroplinedate,
			t1.pftservicingodlimit,
			t1.insuranceamt,
			t1.deductinsdisb,
			t1.alwbpi,
			t1.bpitreatment,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.calroundingmode,
			t1.alwmultidisb,
			t1.applicationno,
			t1.referralid,
			t33.rofficerdesc AS referraliddesc,
			t1.dmacode,
			t34.rofficerdesc AS dmacodedesc,
			t1.salesdepartment,
			t35.gendeptdesc AS salesdepartmentdesc,
			t1.quickdisb,
			t1.wifreference,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.availedunplanemi,
			t1.availedreageh,
			t1.bpiamount,
			t1.deductfeedisb,
			t1.rvwrateapplfor,
			t1.schcalonrvw,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.promotioncode,
			t1.restructureloan,
			t1.oldfinreference,
			t1.reagebucket,
			t1.fincategory,
			t1.productcategory,
			t1.roundingtarget,
			t36.entitycode AS lovdescentitycode,
			t1.eligibilitymethod,
			t1.employeename,
			t37.rofficerdesc AS employeenamedesc,
			t1.Samplingrequired
			FROM ((((((((((((financemain_temp t1
			 JOIN rmtfinancetypes t7 ON ((t1.fintype = t7.fintype)))
			 LEFT JOIN rmtbranches t12 ON ((t1.finbranch = t12.branchcode)))
			 LEFT JOIN finpftdetails t17 ON ((t17.finreference = t1.finreference)))
			 LEFT JOIN steppolicyheader t24 ON ((t1.steppolicy = t24.policycode)))
			 LEFT JOIN bmtcuststatuscodes t27 ON ((t1.finstatus = t27.custstscode)))
			 LEFT JOIN amtvehicledealer t28 ON ((t1.accountsofficer = t28.dealerid)))
			 LEFT JOIN relationshipofficers t30 ON ((t1.dsacode = t30.rofficercode)))
			 LEFT JOIN relationshipofficers t33 ON ((t1.referralid = t33.rofficercode)))
			 LEFT JOIN relationshipofficers t34 ON ((t1.dmacode = t34.rofficercode)))
			 LEFT JOIN rmtgendepartments t35 ON ((t1.salesdepartment = t35.gendepartment)))
			 LEFT JOIN smtdivisiondetail t36 ON ((t7.findivision = t36.divisioncode)))
			 LEFT JOIN relationshipofficers t37 ON (((t1.employeename) = (t37.rofficercode))))
			UNION ALL
			 SELECT t1.finreference,
			t1.investmentref,
			t1.numberofterms,
			t1.grcperiodenddate,
			t1.allowgrcperiod,
			t1.gracebaserate,
			t1.gracespecialrate,
			t1.grcpftrate,
			t1.grcpftfrq,
			t1.nextgrcpftdate,
			t1.allowgrcpftrvw,
			t1.grcpftrvwfrq,
			t1.nextgrcpftrvwdate,
			t1.allowgrccpz,
			t1.grccpzfrq,
			t1.nextgrccpzdate,
			t1.repaybaserate,
			t1.repayspecialrate,
			t1.repayprofitrate,
			t1.repayfrq,
			t1.nextrepaydate,
			t1.repaypftfrq,
			t1.nextrepaypftdate,
			t1.allowrepayrvw,
			t1.repayrvwfrq,
			t1.nextrepayrvwdate,
			t1.allowrepaycpz,
			t1.repaycpzfrq,
			t1.nextrepaycpzdate,
			t1.maturitydate,
			t1.cpzatgraceend,
			t1.downpayment,
			t1.graceflatamount,
			t1.reqrepayamount,
			t1.totalprofit,
			t1.totalcpz,
			t1.totalgrosspft,
			t1.totalgrossgrcpft,
			t1.totalgracepft,
			t1.totalgracecpz,
			t1.grcratebasis,
			t1.repayratebasis,
			t1.fintype,
			t1.finremarks,
			t1.finccy,
			t1.schedulemethod,
			t1.profitdaysbasis,
			t1.reqmaturity,
			t1.calterms,
			t1.calmaturity,
			t1.firstrepay,
			t1.lastrepay,
			t1.finstartdate,
			t1.finamount,
			((t1.finamount + t1.feechargeamt) - t1.downpayment) AS lovdescfinancingamount,
			t1.finrepaymentamount,
			t1.custid,
			t1.defferments,
			t1.plandefercount,
			t1.finbranch,
			t1.finsourceid,
			t1.alloweddefrpychange,
			t1.availeddefrpychange,
			t1.alloweddeffrqchange,
			t1.availeddeffrqchange,
			t1.recaltype,
			t1.finassetvalue,
			t1.disbaccountid,
			t1.repayaccountid,
			t1.finisactive,
			t1.limitvalid,
			t1.overridelimit,
			t1.securitydeposit,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t7.fintypedesc AS lovdescfintypename,
			t7.finmaxamount AS lovdescfinmaxamt,
			t7.finminamount AS lovdescfinminamount,
			t1.mindownpayperc,
			t7.finisalwdifferment AS lovdescfinalwdeferment,
			t7.finisdwpayrequired AS lovdescdwnpayreq,
			t7.finmaxdifferment AS lovdescfinmaxdifferment,
			t12.branchdesc AS lovdescfinbranchname,
			t1.lastrepaydate,
			t1.lastrepaypftdate,
			t1.lastrepayrvwdate,
			t1.lastrepaycpzdate,
			t1.allowgrcrepay,
			t1.grcschdmthd,
			t1.grcmargin,
			t1.repaymargin,
			t1.fincurrassetvalue,
			t1.fincommitmentref,
			t1.finlimitref,
			t1.depreciationfrq,
			t1.fincontractdate,
			t1.nextdepdate,
			t1.lastdepdate,
			t1.finaccount,
			t1.fincustpftaccount,
			t17.acrtilllbd AS lovdescaccruedtilllbd,
			t7.finrvwrateapplfor,
			t1.totalrepayamt,
			t1.closingstatus,
			t1.finapproveddate,
			t1.feechargeamt,
			t1.blacklisted,
			t1.finrepaypftonfrq,
			t1.anualizedpercrate,
			t1.effectiverateofreturn,
			t1.migratedfinance,
			t1.schedulemaintained,
			t1.scheduleregenerated,
			t1.finpurpose,
			t1.finstatus,
			t1.finstsreason,
			t1.initiateuser,
			t1.bankname,
			t1.iban,
			t1.accounttype,
			t1.ddareferenceno,
			t7.finscheduleon AS lovdescfinscheduleon,
			t1.custdsr,
			t1.jointaccount,
			t1.jointcustid,
			t1.downpaybank,
			t1.downpaysupl,
			t1.downpayaccount,
			t1.securitycollateral,
			t1.approved,
			t1.discrepancy,
			t1.limitapproved,
			t1.graceterms,
			t7.findivision AS lovdescfindivision,
			t1.rcdmaintainsts,
			t1.finrepaymethod,
			t1.grcprofitdaysbasis,
			t1.stepfinance,
			t1.steptype,
			t1.steppolicy,
			t1.alwmanualsteps,
			t1.noofsteps,
			t1.linkedfinref,
			t1.nextuserid,
			t1.priority,
			t24.policydesc AS lovdescsteppolicyname,
			t1.grcminrate,
			t1.grcmaxrate,
			t1.rpyminrate,
			t1.rpymaxrate,
			t1.deviationapproval,
			t1.manualschedule,
			t1.takeoverfinance,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.supplementrent,
			t1.increasedcost,
			t1.rolloverfrq,
			t1.nextrolloverdate,
			t27.custstsdescription,
			t1.shariastatus,
			t1.initiatedate,
			t1.finpreapprovedref,
			t1.mmaid,
			t1.accountsofficer,
			t1.feeaccountid,
			t1.fincancelac,
			t28.dealername AS lovdescaccountsofficer,
			t28.dealercity AS lovdescsourcecity,
			t1.dsacode,
			t30.rofficerdesc AS dsacodedesc,
			t1.tdsapplicable,
			t1.mandateid,
			t1.droplinefrq,
			t1.firstdroplinedate,
			t1.pftservicingodlimit,
			t1.insuranceamt,
			t1.deductinsdisb,
			t1.alwbpi,
			t1.bpitreatment,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.calroundingmode,
			t1.alwmultidisb,
			t1.applicationno,
			t1.referralid,
			t33.rofficerdesc AS referraliddesc,
			t1.dmacode,
			t34.rofficerdesc AS dmacodedesc,
			t1.salesdepartment,
			t35.gendeptdesc AS salesdepartmentdesc,
			t1.quickdisb,
			t1.wifreference,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.availedunplanemi,
			t1.availedreageh,
			t1.bpiamount,
			t1.deductfeedisb,
			t1.rvwrateapplfor,
			t1.schcalonrvw,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.promotioncode,
			t1.restructureloan,
			t1.oldfinreference,
			t1.reagebucket,
			t1.fincategory,
			t1.productcategory,
			t1.roundingtarget,
			t36.entitycode AS lovdescentitycode,
			t1.eligibilitymethod,
			t1.employeename,
			t37.rofficerdesc AS employeenamedesc,
			t1.Samplingrequired
			FROM ((((((((((((financemain t1
			 JOIN rmtfinancetypes t7 ON ((t1.fintype = t7.fintype)))
			 LEFT JOIN rmtbranches t12 ON ((t1.finbranch = t12.branchcode)))
			 LEFT JOIN finpftdetails t17 ON ((t17.finreference = t1.finreference)))
			 LEFT JOIN steppolicyheader t24 ON ((t1.steppolicy = t24.policycode)))
			 LEFT JOIN bmtcuststatuscodes t27 ON ((t1.finstatus = t27.custstscode)))
			 LEFT JOIN amtvehicledealer t28 ON ((t1.accountsofficer = t28.dealerid)))
			 LEFT JOIN relationshipofficers t30 ON ((t1.dsacode = t30.rofficercode)))
			 LEFT JOIN relationshipofficers t33 ON ((t1.referralid = t33.rofficercode)))
			 LEFT JOIN relationshipofficers t34 ON ((t1.dmacode = t34.rofficercode)))
			 LEFT JOIN rmtgendepartments t35 ON ((t1.salesdepartment = t35.gendepartment)))
			 LEFT JOIN smtdivisiondetail t36 ON ((t7.findivision = t36.divisioncode)))
			 LEFT JOIN relationshipofficers t37 ON (((t1.employeename) = (t37.rofficercode))))
		  	WHERE (NOT (EXISTS ( SELECT 1 AS expr1
				   FROM financemain_temp
				  WHERE (financemain_temp.finreference = t1.finreference))))
		</createView>
		<createView viewName="financemain_tview" replaceIfExists="true">
			SELECT t1.finreference,
			t1.investmentref,
			t1.numberofterms,
			t1.grcperiodenddate,
			t1.allowgrcperiod,
			t1.gracebaserate,
			t1.gracespecialrate,
			t1.grcpftrate,
			t1.grcpftfrq,
			t1.nextgrcpftdate,
			t1.allowgrcpftrvw,
			t1.grcpftrvwfrq,
			t1.nextgrcpftrvwdate,
			t1.allowgrccpz,
			t1.grccpzfrq,
			t1.nextgrccpzdate,
			t1.repaybaserate,
			t1.repayspecialrate,
			t1.repayprofitrate,
			t1.repayfrq,
			t1.nextrepaydate,
			t1.repaypftfrq,
			t1.nextrepaypftdate,
			t1.allowrepayrvw,
			t1.repayrvwfrq,
			t1.nextrepayrvwdate,
			t1.allowrepaycpz,
			t1.repaycpzfrq,
			t1.nextrepaycpzdate,
			t1.maturitydate,
			t1.cpzatgraceend,
			t1.downpayment,
			t1.graceflatamount,
			t1.reqrepayamount,
			t1.totalprofit,
			t1.totalcpz,
			t1.totalgrosspft,
			t1.totalgrossgrcpft,
			t1.totalgracepft,
			t1.totalgracecpz,
			t1.grcratebasis,
			t1.repayratebasis,
			t1.fintype,
			t1.finremarks,
			t1.finccy,
			t1.schedulemethod,
			t1.profitdaysbasis,
			t1.reqmaturity,
			t1.calterms,
			t1.calmaturity,
			t1.firstrepay,
			t1.lastrepay,
			t1.finstartdate,
			t1.finamount,
			t1.finrepaymentamount,
			t1.custid,
			t1.defferments,
			t1.plandefercount,
			t1.finbranch,
			t1.finsourceid,
			t1.alloweddefrpychange,
			t1.availeddefrpychange,
			t1.alloweddeffrqchange,
			t1.availeddeffrqchange,
			t1.recaltype,
			t1.finassetvalue,
			t1.disbaccountid,
			t1.repayaccountid,
			t1.finisactive,
			t1.limitvalid,
			t1.overridelimit,
			t1.securitydeposit,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t2.fintypedesc AS lovdescfintypename,
			t2.finmaxamount AS lovdescfinmaxamt,
			t2.finminamount AS lovdescfinminamount,
			t1.mindownpayperc,
			t4.branchdesc AS lovdescfinbranchname,
			t1.lastrepaydate,
			t1.lastrepaypftdate,
			t1.lastrepayrvwdate,
			t1.lastrepaycpzdate,
			t1.allowgrcrepay,
			t1.grcschdmthd,
			t1.grcmargin,
			t1.repaymargin,
			t1.fincurrassetvalue,
			t1.fincommitmentref,
			t1.finlimitref,
			t1.depreciationfrq,
			t1.fincontractdate,
			t1.nextdepdate,
			t1.lastdepdate,
			t1.finaccount,
			t1.fincustpftaccount,
			t1.totalrepayamt,
			t1.finapproveddate,
			t1.feechargeamt,
			t1.blacklisted,
			t1.finrepaypftonfrq,
			t1.anualizedpercrate,
			t1.effectiverateofreturn,
			t1.migratedfinance,
			t1.schedulemaintained,
			t1.scheduleregenerated,
			t1.finpurpose,
			t1.finstatus,
			t1.finstsreason,
			t1.initiateuser,
			t1.bankname,
			t1.iban,
			t1.accounttype,
			t1.ddareferenceno,
			t1.custdsr,
			t1.jointaccount,
			t1.jointcustid,
			t1.downpaybank,
			t1.downpaysupl,
			t1.downpayaccount,
			t1.securitycollateral,
			t1.approved,
			t1.discrepancy,
			t1.limitapproved,
			t1.graceterms,
			t2.findivision AS lovdescfindivision,
			t1.rcdmaintainsts,
			t1.finrepaymethod,
			t1.grcprofitdaysbasis,
			t1.stepfinance,
			t1.steptype,
			t1.steppolicy,
			t1.alwmanualsteps,
			t1.noofsteps,
			t1.linkedfinref,
			t1.nextuserid,
			t1.priority,
			t5.policydesc AS lovdescsteppolicyname,
			t1.grcminrate,
			t1.grcmaxrate,
			t1.rpyminrate,
			t1.rpymaxrate,
			t1.deviationapproval,
			t1.manualschedule,
			t1.takeoverfinance,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.supplementrent,
			t1.increasedcost,
			t1.creditinsamt,
			t1.rolloverfrq,
			t1.nextrolloverdate,
			t1.shariastatus,
			t1.initiatedate,
			t1.finpreapprovedref,
			t1.mmaid,
			t1.accountsofficer,
			t1.feeaccountid,
			t1.fincancelac,
			t6.dealername AS lovdescaccountsofficer,
			t6.dealercity AS lovdescsourcecity,
			t1.dsacode,
			t7.rofficerdesc AS dsacodedesc,
			t1.tdsapplicable,
			t1.mandateid,
			t1.droplinefrq,
			t1.firstdroplinedate,
			t1.pftservicingodlimit,
			t1.insuranceamt,
			t1.deductinsdisb,
			t1.alwbpi,
			t1.bpitreatment,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.calroundingmode,
			t1.alwmultidisb,
			t1.applicationno,
			t1.referralid,
			t8.rofficerdesc AS referraliddesc,
			t1.dmacode,
			t9.rofficerdesc AS dmacodedesc,
			t1.salesdepartment,
			t10.gendeptdesc AS salesdepartmentdesc,
			t1.quickdisb,
			t1.wifreference,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.availedunplanemi,
			t1.availedreageh,
			t1.bpiamount,
			t1.deductfeedisb,
			t1.rvwrateapplfor,
			t1.schcalonrvw,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.promotioncode,
			t1.restructureloan,
			t1.oldfinreference,
			t1.reagebucket,
			t1.fincategory,
			t1.productcategory,
			t1.roundingtarget,
			t11.entitycode AS lovdescentitycode,
			t1.eligibilitymethod,
			t1.employeename,
			t12.rofficerdesc AS employeenamedesc,
			t1.Samplingrequired
			FROM ((((((((((financemain_temp t1
			 JOIN rmtfinancetypes t2 ON ((t1.fintype = t2.fintype)))
			 JOIN rmtbranches t4 ON ((t1.finbranch = t4.branchcode)))
			 LEFT JOIN steppolicyheader t5 ON ((t1.steppolicy = t5.policycode)))
			 LEFT JOIN amtvehicledealer t6 ON ((t1.accountsofficer = t6.dealerid)))
			 LEFT JOIN relationshipofficers t7 ON ((t1.dsacode = t7.rofficercode)))
			 LEFT JOIN relationshipofficers t8 ON ((t1.referralid = t8.rofficercode)))
			 LEFT JOIN relationshipofficers t9 ON ((t1.dmacode = t9.rofficercode)))
			 LEFT JOIN rmtgendepartments t10 ON ((t1.salesdepartment = t10.gendepartment)))
			 LEFT JOIN smtdivisiondetail t11 ON ((t2.findivision = t11.divisioncode)))
			 LEFT JOIN relationshipofficers t12 ON (((t1.employeename) = (t12.rofficercode))))
		</createView>
		<createView viewName="financemain_aview" replaceIfExists="true">
			SELECT t1.finreference,
			t1.numberofterms,
			t1.grcperiodenddate,
			t1.allowgrcperiod,
			t1.gracebaserate,
			t1.gracespecialrate,
			t1.grcpftrate,
			t1.grcpftfrq,
			t1.nextgrcpftdate,
			t1.allowgrcpftrvw,
			t1.grcpftrvwfrq,
			t1.nextgrcpftrvwdate,
			t1.allowgrccpz,
			t1.grccpzfrq,
			t1.nextgrccpzdate,
			t1.repaybaserate,
			t1.repayspecialrate,
			t1.repayprofitrate,
			t1.repayfrq,
			t1.nextrepaydate,
			t1.repaypftfrq,
			t1.nextrepaypftdate,
			t1.allowrepayrvw,
			t1.repayrvwfrq,
			t1.nextrepayrvwdate,
			t1.allowrepaycpz,
			t1.repaycpzfrq,
			t1.nextrepaycpzdate,
			t1.maturitydate,
			t1.cpzatgraceend,
			t1.downpayment,
			t1.graceflatamount,
			t1.reqrepayamount,
			t1.totalprofit,
			t1.totalcpz,
			t1.totalgrosspft,
			t1.totalgrossgrcpft,
			t1.totalgracepft,
			t1.totalgracecpz,
			t1.grcratebasis,
			t1.repayratebasis,
			t1.fintype,
			t1.finremarks,
			t1.finccy,
			t1.schedulemethod,
			t1.profitdaysbasis,
			t1.reqmaturity,
			t1.calterms,
			t1.calmaturity,
			t1.firstrepay,
			t1.lastrepay,
			t1.finstartdate,
			t1.finamount,
			((t1.finamount + t1.feechargeamt) - t1.downpayment) AS lovdescfinancingamount,
			t1.finrepaymentamount,
			t1.custid,
			t1.defferments,
			t1.plandefercount,
			t1.finbranch,
			t1.finsourceid,
			t1.alloweddefrpychange,
			t1.availeddefrpychange,
			t1.alloweddeffrqchange,
			t1.availeddeffrqchange,
			t1.recaltype,
			t1.finassetvalue,
			t1.disbaccountid,
			t1.repayaccountid,
			t1.finisactive,
			t1.limitvalid,
			t1.overridelimit,
			t1.securitydeposit,
			t1.version,
			t1.lastmntby,
			t1.lastmnton,
			t1.recordstatus,
			t1.rolecode,
			t1.nextrolecode,
			t1.taskid,
			t1.nexttaskid,
			t1.recordtype,
			t1.workflowid,
			t7.fintypedesc AS lovdescfintypename,
			t7.finmaxamount AS lovdescfinmaxamt,
			t7.finminamount AS lovdescfinminamount,
			t1.mindownpayperc,
			t7.finisalwdifferment AS lovdescfinalwdeferment,
			t7.finisdwpayrequired AS lovdescdwnpayreq,
			t7.finmaxdifferment AS lovdescfinmaxdifferment,
			t12.branchdesc AS lovdescfinbranchname,
			t1.lastrepaydate,
			t1.lastrepaypftdate,
			t1.lastrepayrvwdate,
			t1.lastrepaycpzdate,
			t1.allowgrcrepay,
			t1.grcschdmthd,
			t1.grcmargin,
			t1.repaymargin,
			t1.fincurrassetvalue,
			t1.fincommitmentref,
			t1.finlimitref,
			t1.depreciationfrq,
			t1.fincontractdate,
			t1.nextdepdate,
			t1.lastdepdate,
			t1.finaccount,
			t1.fincustpftaccount,
			t17.acrtilllbd AS lovdescaccruedtilllbd,
			t7.finrvwrateapplfor,
			t1.totalrepayamt,
			t1.closingstatus,
			t1.finapproveddate,
			t1.feechargeamt,
			t1.blacklisted,
			t1.finrepaypftonfrq,
			t1.anualizedpercrate,
			t1.effectiverateofreturn,
			t1.migratedfinance,
			t1.schedulemaintained,
			t1.scheduleregenerated,
			t1.finpurpose,
			t1.finstatus,
			t1.finstsreason,
			t1.initiateuser,
			t1.bankname,
			t1.iban,
			t1.accounttype,
			t1.ddareferenceno,
			t7.finscheduleon AS lovdescfinscheduleon,
			t1.custdsr,
			t1.jointaccount,
			t1.jointcustid,
			t1.downpaybank,
			t1.downpaysupl,
			t1.downpayaccount,
			t1.securitycollateral,
			t1.approved,
			t1.discrepancy,
			t1.limitapproved,
			t1.investmentref,
			t1.graceterms,
			t7.findivision AS lovdescfindivision,
			t1.rcdmaintainsts,
			t1.finrepaymethod,
			t1.grcprofitdaysbasis,
			t1.stepfinance,
			t1.steptype,
			t1.steppolicy,
			t1.alwmanualsteps,
			t1.noofsteps,
			t1.linkedfinref,
			t1.nextuserid,
			t1.priority,
			t24.policydesc AS lovdescsteppolicyname,
			t1.grcminrate,
			t1.grcmaxrate,
			t1.rpyminrate,
			t1.rpymaxrate,
			t1.deviationapproval,
			t1.manualschedule,
			t1.takeoverfinance,
			t1.grcadvbaserate,
			t1.grcadvmargin,
			t1.grcadvpftrate,
			t1.rpyadvbaserate,
			t1.rpyadvmargin,
			t1.rpyadvpftrate,
			t1.supplementrent,
			t1.increasedcost,
			t1.rolloverfrq,
			t1.nextrolloverdate,
			t27.custstsdescription,
			t1.shariastatus,
			t1.initiatedate,
			t1.finpreapprovedref,
			t1.mmaid,
			t1.accountsofficer,
			t1.feeaccountid,
			t1.fincancelac,
			t28.dealername AS lovdescaccountsofficer,
			t28.dealercity AS lovdescsourcecity,
			t29.agreename,
			t29.mmareference AS lovdescmmareference,
			t1.dsacode,
			t30.rofficerdesc AS dsacodedesc,
			t1.tdsapplicable,
			t1.mandateid,
			t1.droplinefrq,
			t1.firstdroplinedate,
			t1.pftservicingodlimit,
			t1.insuranceamt,
			t1.deductinsdisb,
			t1.alwbpi,
			t1.bpitreatment,
			t1.planemihalw,
			t1.planemihmethod,
			t1.planemihmaxperyear,
			t1.planemihmax,
			t1.planemihlockperiod,
			t1.planemicpz,
			t1.calroundingmode,
			t1.alwmultidisb,
			t1.applicationno,
			t1.referralid,
			t33.rofficerdesc AS referraliddesc,
			t1.dmacode,
			t34.rofficerdesc AS dmacodedesc,
			t1.salesdepartment,
			t35.gendeptdesc AS salesdepartmentdesc,
			t1.quickdisb,
			t1.wifreference,
			t1.unplanemihlockperiod,
			t1.unplanemicpz,
			t1.reagecpz,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.availedunplanemi,
			t1.availedreageh,
			t1.bpiamount,
			t1.deductfeedisb,
			t1.rvwrateapplfor,
			t1.schcalonrvw,
			t1.pastduepftcalmthd,
			t1.pastduepftmargin,
			t1.droppingmethod,
			t1.ratechganyday,
			t1.promotioncode,
			t1.restructureloan,
			t1.oldfinreference,
			t1.reagebucket,
			t1.fincategory,
			t1.productcategory,
			t1.roundingtarget,
			t36.entitycode AS lovdescentitycode,
			t1.eligibilitymethod,
			t1.employeename,
			t37.rofficerdesc AS employeenamedesc,
			t1.Samplingrequired
			FROM (((((((((((((financemain t1
			 JOIN rmtfinancetypes t7 ON ((t1.fintype = t7.fintype)))
			 LEFT JOIN rmtbranches t12 ON ((t1.finbranch = t12.branchcode)))
			 LEFT JOIN finpftdetails t17 ON ((t17.finreference = t1.finreference)))
			 LEFT JOIN steppolicyheader t24 ON ((t1.steppolicy = t24.policycode)))
			 LEFT JOIN bmtcuststatuscodes t27 ON ((t1.finstatus = t27.custstscode)))
			 LEFT JOIN amtvehicledealer t28 ON ((t1.accountsofficer = t28.dealerid)))
			 LEFT JOIN mmagreements t29 ON ((t1.mmaid = t29.mmaid)))
			 LEFT JOIN relationshipofficers t30 ON ((t1.dsacode = t30.rofficercode)))
			 LEFT JOIN relationshipofficers t33 ON ((t1.referralid = t33.rofficercode)))
			 LEFT JOIN relationshipofficers t34 ON ((t1.dmacode = t34.rofficercode)))
			 LEFT JOIN rmtgendepartments t35 ON ((t1.salesdepartment = t35.gendepartment)))
			 LEFT JOIN smtdivisiondetail t36 ON ((t7.findivision = t36.divisioncode)))
			 LEFT JOIN relationshipofficers t37 ON (((t1.employeename) = (t37.rofficercode))))
		</createView>
		<createView viewName="financemaintenance_view"
			replaceIfExists="true">
			SELECT t1.finreference,
			t1.finbranch,
			t1.fintype,
			t1.finccy,
			t1.schedulemethod,
			t1.profitdaysbasis,
			t1.finstartdate,
			t1.numberofterms,
			t1.custid,
			t1.finamount,
			t1.maturitydate,
			t1.finrepaymentamount,
			t1.finisactive,
			t1.blacklisted,
			t1.feechargeamt,
			t1.insuranceamt,
			t1.graceterms,
			t1.allowgrcperiod,
			t1.grcperiodenddate,
			t1.alwmultidisb,
			t1.defferments,
			t1.nextrolecode,
			t1.recordstatus,
			t1.recordtype,
			t1.allowgrcpftrvw,
			t1.allowrepayrvw,
			t1.lastrepaydate,
			t1.lastrepaypftdate,
			t1.alloweddefrpychange,
			t1.availeddefrpychange,
			t1.rcdmaintainsts,
			t1.migratedfinance,
			t1.closingstatus,
			t1.repayratebasis,
			t1.manualschedule,
			t1.fincurrassetvalue,
			t1.takeoverfinance,
			t1.nextrolloverdate,
			t1.availedunplanemi,
			t1.availedreageh,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.downpayment,
			t1.planemihalw,
			t1.calterms,
			t1.ratechganyday,
			t1.finassetvalue,
			t2.custcif AS lovdesccustcif,
			t3.finisalwdifferment AS lovdescfinalwdeferment,
			t3.findivision AS lovdescfindivision,
			t3.fincategory AS lovdescproductcodename,
			t4.productcategory,
			COALESCE((t5.roledesc), fn_get_roledesc((t1.nextrolecode))) AS lovdescrequeststage,
			COALESCE(t9.noinst, (0)) AS noinst,
			t1.Samplingrequired
			FROM (((((financemain_temp t1
			 JOIN customers t2 ON ((t1.custid = t2.custid)))
			 JOIN rmtfinancetypes t3 ON ((t1.fintype = t3.fintype)))
			 LEFT JOIN secroles t5 ON ((t1.nextrolecode = t5.rolecd)))
			 JOIN bmtproduct t4 ON ((t3.fincategory = t4.productcode)))
			 LEFT JOIN finpftdetails t9 ON ((t1.finreference = t9.finreference)))
			UNION ALL
		 	SELECT t1.finreference,
			t1.finbranch,
			t1.fintype,
			t1.finccy,
			t1.schedulemethod,
			t1.profitdaysbasis,
			t1.finstartdate,
			t1.numberofterms,
			t1.custid,
			t1.finamount,
			t1.maturitydate,
			t1.finrepaymentamount,
			t1.finisactive,
			t1.blacklisted,
			t1.feechargeamt,
			t1.insuranceamt,
			t1.graceterms,
			t1.allowgrcperiod,
			t1.grcperiodenddate,
			t1.alwmultidisb,
			t1.defferments,
			t1.nextrolecode,
			t1.recordstatus,
			t1.recordtype,
			t1.allowgrcpftrvw,
			t1.allowrepayrvw,
			t1.lastrepaydate,
			t1.lastrepaypftdate,
			t1.alloweddefrpychange,
			t1.availeddefrpychange,
			t1.rcdmaintainsts,
			t1.migratedfinance,
			t1.closingstatus,
			t1.repayratebasis,
			t1.manualschedule,
			t1.fincurrassetvalue,
			t1.takeoverfinance,
			t1.nextrolloverdate,
			t1.availedunplanemi,
			t1.availedreageh,
			t1.maxunplannedemi,
			t1.maxreageholidays,
			t1.downpayment,
			t1.planemihalw,
			t1.calterms,
			t1.ratechganyday,
			t1.finassetvalue,
			t2.custcif AS lovdesccustcif,
			t3.finisalwdifferment AS lovdescfinalwdeferment,
			t3.findivision AS lovdescfindivision,
			t3.fincategory AS lovdescproductcodename,
			t4.productcategory,
			COALESCE((t5.roledesc), fn_get_roledesc((t1.nextrolecode))) AS lovdescrequeststage,
			COALESCE(t9.noinst, (0)) AS noinst,
			t1.Samplingrequired
			FROM (((((financemain t1
			 JOIN customers t2 ON ((t1.custid = t2.custid)))
			 JOIN rmtfinancetypes t3 ON ((t1.fintype = t3.fintype)))
			 LEFT JOIN secroles t5 ON ((t1.nextrolecode = t5.rolecd)))
			 JOIN bmtproduct t4 ON ((t3.fincategory = t4.productcode)))
			 LEFT JOIN finpftdetails t9 ON ((t1.finreference = t9.finreference)))
		 	 WHERE (NOT (EXISTS ( SELECT 1 AS expr1
				   FROM financemain_temp
				  WHERE (financemain_temp.finreference = t1.finreference))))
		</createView>
		<createView viewName="financemaintenance_aview"
			replaceIfExists="true">
					SELECT t1.finreference,
					t1.finbranch,
					t1.fintype,
					t1.finccy,
					t1.schedulemethod,
					t1.profitdaysbasis,
					t1.finstartdate,
					t1.numberofterms,
					t1.custid,
					t1.finamount,
					t1.maturitydate,
					t1.finrepaymentamount,
					t1.finisactive,
					t1.blacklisted,
					t1.feechargeamt,
					t1.insuranceamt,
					t1.graceterms,
					t1.allowgrcperiod,
					t1.grcperiodenddate,
					t1.alwmultidisb,
					t1.defferments,
					t1.nextrolecode,
					t1.recordstatus,
					t1.recordtype,
					t1.allowgrcpftrvw,
					t1.allowrepayrvw,
					t1.lastrepaydate,
					t1.lastrepaypftdate,
					t1.alloweddefrpychange,
					t1.availeddefrpychange,
					t1.migratedfinance,
					t1.rcdmaintainsts,
					t1.closingstatus,
					t1.repayratebasis,
					t1.manualschedule,
					t1.takeoverfinance,
					t1.nextrolloverdate,
					t1.downpayment,
					t1.planemihalw,
					t1.fincurrassetvalue,
					t1.finassetvalue,
					t2.custcif AS lovdesccustcif,
					t3.fincategory AS lovdescproductcodename,
					t3.finisalwdifferment AS lovdescfinalwdeferment,
					t4.productcategory,
					t1.Samplingrequired
				FROM (((financemain t1
					 JOIN customers t2 ON ((t1.custid = t2.custid)))
					 JOIN rmtfinancetypes t3 ON ((t1.fintype = t3.fintype)))
					 JOIN bmtproduct t4 ON ((t3.fincategory = t4.productcode)))
		</createView>
		<createView viewName="financemain_lview" replaceIfExists="true">
			SELECT t1.finreference,
			t1.investmentref,
			t1.fintype,
			t1.finccy,
			t1.finamount,
			t1.downpayment,
			t1.feechargeamt,
			t1.schedulemethod,
			t1.numberofterms,
			t1.recordstatus,
			t1.recordtype,
			t1.rolecode,
			t1.nextrolecode,
			t1.finbranch,
			t1.fincontractdate,
			t1.linkedfinref,
			t1.nextuserid,
			t1.priority,
			t1.workflowid,
			t1.taskid,
			t1.nexttaskid,
			t1.finpreapprovedref,
			t1.rcdmaintainsts,
			t1.insuranceamt,
			t1.fincurrassetvalue,
			t1.calterms,
			t1.deviationapproval,
			t1.finpurpose,
			t1.initiatedate,
			t1.finassetvalue,
			t2.custcif AS lovdesccustcif,
			t2.custshrtname AS lovdesccustshrtname,
			t2.custpassportno AS lovdesccustpassportno,
			t2.custdob AS lovdesccustdob,
			t2.custcrcpr AS lovdesccustcrcpr,
			t2.phonenumber,
			t3.fincategory AS lovdescproductcodename,
			t3.findivision AS lovdescfindivision,
			t3.product AS lovdescfinproduct,
			t3.fintypedesc AS lovdescfintypename,
			COALESCE((t4.roledesc), fn_get_roledesc((t1.nextrolecode))) AS lovdescrequeststage,
			t1.Samplingrequired
			FROM (((financemain_temp t1
			 JOIN customers t2 ON ((t1.custid = t2.custid)))
			 JOIN rmtfinancetypes t3 ON ((t3.fintype = t1.fintype)))
			 LEFT JOIN secroles t4 ON ((t1.nextrolecode = t4.rolecd)))
		</createView>
		<createView viewName="financemainlimitcheck_tview" replaceIfExists="true">
			SELECT fm.finreference,
			fm.finbranch,
			fm.finsourceid,
			fm.fintype,
			fm.finccy,
			fm.numberofterms,
			fm.schedulemethod,
			fm.securitycollateral,
			fm.allowrepayrvw,
			fm.finpurpose,
			fm.finassetvalue,
			c.custid,
			c.custdftbranch,
			c.custctgcode,
			c.custtypecode,
			c.custgendercode,
			c.custisstaff,
			c.custindustry,
			c.custsector,
			c.custsubsector,
			c.custempsts,
			c.custmaritalsts,
			c.custsegment,
			c.custsubsegment,
			c.custparentcountry,
			c.custriskcountry,
			c.custnationality,
			c.custaddlvar2,
			ca.custaddrprovince,
			ft.fincategory,
			ft.findivision,
			date_part('month', age(fm.finstartdate, fm.maturitydate)) AS tenor,
			fm.Samplingrequired
			FROM (((financemain_temp fm
			 JOIN customers c ON ((c.custid = fm.custid)))
			 JOIN rmtfinancetypes ft ON (((ft.fintype) = (fm.fintype))))
			 LEFT JOIN customeraddresses ca ON (((ca.custid = c.custid) AND ((ca.custaddrtype) = 'PERM'))))
		</createView>
		<createView viewName="financemainlimitcheck_aview" replaceIfExists="true">
			SELECT fm.finreference,
			fm.finbranch,
			fm.finsourceid,
			fm.fintype,
			fm.finccy,
			fm.numberofterms,
			fm.schedulemethod,
			fm.securitycollateral,
			fm.allowrepayrvw,
			fm.finpurpose,
			fm.finassetvalue,
			c.custid,
			c.custdftbranch,
			c.custctgcode,
			c.custtypecode,
			c.custgendercode,
			c.custisstaff,
			c.custindustry,
			c.custsector,
			c.custsubsector,
			c.custempsts,
			c.custmaritalsts,
			c.custsegment,
			c.custsubsegment,
			c.custparentcountry,
			c.custriskcountry,
			c.custnationality,
			c.custaddlvar2,
			ca.custaddrprovince,
			ft.fincategory,
			ft.findivision,
			date_part('month', age(fm.finstartdate, fm.maturitydate)) AS tenor,
			fm.Samplingrequired
			FROM (((financemain fm
			 JOIN customers c ON ((c.custid = fm.custid)))
			 JOIN rmtfinancetypes ft ON (((ft.fintype) = (fm.fintype))))
			 LEFT JOIN customeraddresses ca ON (((ca.custid = c.custid) AND ((ca.custaddrtype) = 'PERM'))));
		</createView>
		<createView viewName="financemain_dview" replaceIfExists="true">
			SELECT t1.finreference,
			t1.investmentref,
			t1.fintype,
			t1.finccy,
			t1.finamount,
			t1.downpayment,
			t1.feechargeamt,
			t1.schedulemethod,
			t1.recordstatus,
			t1.recordtype,
			t1.rolecode,
			t1.nextrolecode,
			t1.finbranch,
			t1.finassetvalue,
			t2.custcif AS lovdesccustcif,
			t2.custshrtname AS lovdesccustshrtname,
			t2.custid,
			t2.custcif,
			t3.fincategory AS lovdescproductcodename,
			t3.findivision AS lovdescfindivision,
			t1.Samplingrequired
			FROM (((financemain_temp t1
			 JOIN customers t2 ON ((t1.custid = t2.custid)))
			 JOIN rmtfinancetypes t3 ON ((t3.fintype = t1.fintype)))
			 JOIN investmentfinheader t4 ON ((t4.investmentref = t1.investmentref)))
		</createView>
		<createView viewName="sampling_tview" replaceIfExists="true">
			select s.id, s.keyreference, s.createdby, s.createdon, s.tenure, s.interestRate, s.foirEligibility, s.emi, s.loanEligibility, s.irrEligibility, s.totalIncome, s.totalLiability,
			s.remarks, s.samplingon, s.decision, s.recommendedamount,
			s.decisionon, s.resubmitreason, r.code resubmitreasoncode, r.description resubmitreasondesc,
			ft.fintype, ft.fintypedesc, ft.finGrcRateType, fm.numberofterms, fm.repayspecialrate, fm.repayprofitrate, fm.finccy, ccy.ccyeditfield,
            lb.branchcode, lb.branchdesc,
			cu.custid, cu.custcif, cu.custshrtname, cu.custctgcode custcategory,           
			s.version, s.lastmntby, s.lastmnton, s.recordstatus, s.rolecode, s.nextrolecode, s.taskid, s.nexttaskid, s.recordtype, s.workflowid
			from sampling_temp s 
			inner join financemain_temp fm on fm.finreference = s.keyreference
            inner join rmtcurrencies ccy on ccy.ccycode = fm.finccy
			inner join customers cu on cu.custid = fm.custid
			inner join rmtfinancetypes ft on ft.fintype = fm.fintype
			left join rmtbranches lb on lb.branchcode = fm.finbranch
			left join reasons r on r.id = s.resubmitreason
		</createView>
		<createView viewName="sampling_view" replaceIfExists="true">
			select s.id, s.keyreference, s.createdby, s.createdon, s.tenure, s.interestRate, s.foirEligibility, s.emi, s.loanEligibility, s.irrEligibility, s.totalIncome, s.totalLiability,
			s.remarks, s.samplingon, s.decision, s.recommendedamount,
			s.decisionon, s.resubmitreason, r.code resubmitreasoncode, r.description resubmitreasondesc,
			ft.fintype, ft.fintypedesc, ft.finGrcRateType, fm.numberofterms, fm.repayspecialrate, fm.repayprofitrate, fm.finccy, ccy.ccyeditfield,
            lb.branchcode, lb.branchdesc,
			cu.custid, cu.custcif, cu.custshrtname, cu.custctgcode custcategory,           
			s.version, s.lastmntby, s.lastmnton, s.recordstatus, s.rolecode, s.nextrolecode, s.taskid, s.nexttaskid, s.recordtype, s.workflowid
			from sampling_temp s 
			inner join financemain_temp fm on fm.finreference = s.keyreference
            inner join rmtcurrencies ccy on ccy.ccycode = fm.finccy
			inner join customers cu on cu.custid = fm.custid
			inner join rmtfinancetypes ft on ft.fintype = fm.fintype
			left join rmtbranches lb on lb.branchcode = fm.finbranch
			left join reasons r on r.id = s.resubmitreason
			union all
			select s.id, s.keyreference, s.createdby, s.createdon, s.tenure, s.interestRate, s.foirEligibility, s.emi, s.loanEligibility, s.irrEligibility, s.totalIncome, s.totalLiability,
			s.remarks, s.samplingon, s.decision, s.recommendedamount,
			s.decisionon, s.resubmitreason, r.code resubmitreasoncode, r.description resubmitreasondesc,
			ft.fintype, ft.fintypedesc, ft.finGrcRateType, fm.numberofterms, fm.repayspecialrate, fm.repayprofitrate, fm.finccy, ccy.ccyeditfield,
            lb.branchcode, lb.branchdesc, 
			cu.custid, cu.custcif, cu.custshrtname, cu.custctgcode custcategory,
			s.version, s.lastmntby, s.lastmnton, s.recordstatus, s.rolecode, s.nextrolecode, s.taskid, s.nexttaskid, s.recordtype, s.workflowid
			from sampling s 
			inner join financemain_view fm on fm.finreference = s.keyreference
            inner join rmtcurrencies ccy on ccy.ccycode = fm.finccy
			inner join customers cu on cu.custid = fm.custid
			inner join rmtfinancetypes ft on ft.fintype = fm.fintype
			left join rmtbranches lb on lb.branchcode = fm.finbranch
			left join reasons r on r.id = s.resubmitreason
			where not exists (select 1 from sampling_temp where id = s.id);
		</createView>
		<createView viewName="sampling_aview" replaceIfExists="true">
			select s.id, s.keyreference, s.createdby, s.createdon, s.tenure, s.interestRate, s.foirEligibility, s.emi, s.loanEligibility, s.irrEligibility, s.totalIncome, s.totalLiability,
			s.remarks, s.samplingon, s.decision, s.recommendedamount,
			s.decisionon, s.resubmitreason,  r.code resubmitreasoncode, r.description resubmitreasondesc,
			ft.fintype, ft.fintypedesc, ft.finGrcRateType, fm.numberofterms, fm.repayspecialrate, fm.repayprofitrate, fm.finccy, ccy.ccyeditfield,
			fs.calculatedrate, lb.branchcode, lb.branchdesc, 
			cu.custid, cu.custcif, cu.custshrtname, cu.custctgcode custcategory,
			s.version, s.lastmntby, s.lastmnton, s.recordstatus, s.rolecode, s.nextrolecode, s.taskid, s.nexttaskid, s.recordtype, s.workflowid
			from sampling s 
			inner join financemain_view fm on fm.finreference = s.keyreference
			inner join rmtcurrencies ccy on ccy.ccycode = fm.finccy
			inner join finscheduledetails_view fs on fs.finreference = fm.finreference and fs.schdate = fm.finstartdate
			inner join customers cu on cu.custid = fm.custid
			inner join rmtfinancetypes ft on ft.fintype = fm.fintype
			left join rmtbranches lb on lb.branchcode = fm.finbranch
			left join reasons r on r.id = s.resubmitreason;
		</createView>
		<createView viewName="sampling_income_details_aview"
			replaceIfExists="true">
			 select id.*, cl.custid, cu.custcif, cu.custshrtname
			 from income_details_aview id 
			 inner join link_sampling_incomes cl on cl.linkid = id.linkid
			 inner join customers cu on cu.custid = cl.custid
		</createView>
		<createView viewName="sampling_income_details_view"
			replaceIfExists="true">
			 select id.*, cu.custid, cu.custcif, cu.custshrtname
			 from income_details_view id 
			 inner join link_sampling_incomes cl on cl.linkid = id.linkid
			 inner join customers cu on cu.custid = cl.custid
			 union all
			 select id.*, cu.custid, cu.custcif, cu.custshrtname
			 from income_details_aview id 
			 inner join link_sampling_incomes cl on cl.linkid = id.linkid
			 inner join customers cu on cu.custid = cl.custid
			 where (not exists (select 1 from income_details_view where linkid = id.linkid ));
		</createView>
		<createView viewName="sampling_liabilities_aview"
			replaceIfExists="true">
			 select el.*, cl.custid, cu.custcif, cu.custshrtname
			 from external_liabilities_aview el 
			 inner join link_sampling_liabilities cl on cl.linkid = el.linkid
			 inner join customers cu on cu.custid = cl.custid
		</createView>
		<createView viewName="sampling_liabilities_view"
			replaceIfExists="true">
			 select el.*, cu.custid, cu.custcif, cu.custshrtname
			 from external_liabilities_view el 
			 inner join link_sampling_liabilities cl on cl.linkid = el.linkid
			 inner join customers cu on cu.custid = cl.custid
			 union all
			 select el.*, cu.custid, cu.custcif, cu.custshrtname
			 from external_liabilities_aview el 
			 inner join link_sampling_liabilities cl on cl.linkid = el.linkid
			 inner join customers cu on cu.custid = cl.custid
			 where (not exists (select 1 from external_liabilities_view where linkid = el.linkid ));
		</createView>
	</changeSet>
	<changeSet id="11" author="murthy.y">
		<sql>delete from workflowdetails where WorkFlowType='SAMPLING';</sql>
		<insert tableName="WorkFlowDetails">
			<column name="WorkFlowId" valueComputed="(select max(Seqno) + 1 from SeqWorkFlowDetails)" />
			<column name="WorkFlowType">SAMPLING</column>
			<column name="WorkFlowSubType">Sampling Workflow</column>
			<column name="WorkFlowDesc">Sampling Workflow Workflow Process</column>
			<column name="JsonDesign" type="nclob"><![CDATA[NULL]]></column>
			<column name="SvgDesign" type="nclob"><![CDATA[NULL]]></column>
			<column name="WorkFlowXml" type="clob"><![CDATA[NULL]]></column>
			<column name="WorkFlowRoles">SAMPLING_MAKER;SAMPLING_APPROVER</column>
			<column name="FirstTaskOwner">SAMPLING_MAKER</column>
			<column name="WorkFlowActive">1</column>
			<column name="Version">0</column>
			<column name="LastMntBy">1000</column>
			<column name="LastMntOn" valueDate="current_timestamp" />
			<column name="RecordStatus">Null</column>
			<column name="RoleCode"></column>
			<column name="NextRoleCode"></column>
			<column name="TaskId"></column>
			<column name="NextTaskId"></column>
			<column name="RecordType">NULL</column>
		</insert>
		<update tableName="WORKFLOWDETAILS">
			<column name="JSONDESIGN" type="NCLOB"><![CDATA[{"resourceId":"824","properties":{"process_id":"SAMPLING","name":"Sampling Workflow","documentation":"Maker/Checker for Sampling Workflow","category":"","listenerclass":"","listenerentitytype":""},"stencil":{"id":"BPMNDiagram"},"childShapes":[{"resourceId":"startEvent1","properties":{"overrideid":"","name":"Start"},"stencil":{"id":"StartNoneEvent"},"childShapes":[],"outgoing":[{"resourceId":"sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06"}],"bounds":{"lowerRight":{"x":130,"y":193},"upperLeft":{"x":100,"y":163}},"dockers":[]},{"resourceId":"sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA","properties":{"overrideid":"","name":"Maker","usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"user","assignee":{"email":"SAMPLING_MAKER","firstName":"SAMPLING_MAKER","fullName":"SAMPLING_MAKER","id":"SAMPLING_MAKER","roledesc":"Sampling maker","$$hashKey":"object:2446"}}}},"additionalforms":"","formkeydefinition":"","prioritydefinition":"Role Queue","baseactor":"","duedatedefinition":"","multiinstance_type":"None","isforcompensation":"false"},"stencil":{"id":"UserTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79"}],"bounds":{"lowerRight":{"x":295,"y":218},"upperLeft":{"x":195,"y":138}},"dockers":[]},{"resourceId":"sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA"}],"bounds":{"lowerRight":{"x":194.234375,"y":178},"upperLeft":{"x":130.21875,"y":178}},"dockers":[{"x":15,"y":15},{"x":50,"y":40}],"target":{"resourceId":"sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA"}},{"resourceId":"sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D","properties":{"overrideid":"","name":"Approver","usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"user","assignee":{"email":"SAMPLING_APPROVER","firstName":"SAMPLING_APPROVER","fullName":"SAMPLING_APPROVER","id":"SAMPLING_APPROVER","roledesc":"Sampling Approver","$$hashKey":"object:3377"}}}},"additionalforms":"","formkeydefinition":"","prioritydefinition":"Role Queue","baseactor":"","duedatedefinition":"","multiinstance_type":"None","isforcompensation":"false"},"stencil":{"id":"UserTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB"}],"bounds":{"lowerRight":{"x":490,"y":218},"upperLeft":{"x":390,"y":138}},"dockers":[]},{"resourceId":"sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA"}],"bounds":{"lowerRight":{"x":539.7304773585561,"y":178.41381940812678},"upperLeft":{"x":490.8945226414439,"y":178.21118059187322}},"dockers":[{"x":50,"y":40},{"x":20.5,"y":20.5}],"target":{"resourceId":"sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA"}},{"resourceId":"sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA","properties":{"overrideid":"","name":"","sequencefloworder":""},"stencil":{"id":"ExclusiveGateway"},"childShapes":[],"outgoing":[{"resourceId":"sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D"},{"resourceId":"sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2"}],"bounds":{"lowerRight":{"x":580,"y":198},"upperLeft":{"x":540,"y":158}},"dockers":[]},{"resourceId":"sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F","properties":{"overrideid":"","name":"Complete Process","rerunnable":true,"servicetaskexpression":"doApprove","isforcompensation":"false","multiinstance_type":"None","prioritydefinition":"Role Queue","type":"http://b3mn.org/stencilset/bpmn2.0#UserTask","usertaskassignment":"","additionalforms":"","formkeydefinition":"","duedatedefinition":"","baseactor":""},"stencil":{"id":"approveTask"},"childShapes":[],"outgoing":[{"resourceId":"sid-D246DCFB-E559-4479-B8FF-E1315A86F091"}],"bounds":{"lowerRight":{"x":760,"y":218},"upperLeft":{"x":660,"y":138}},"dockers":[]},{"resourceId":"sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB","properties":{"overrideid":"","name":"Approved"},"stencil":{"id":"EndNoneEvent"},"childShapes":[],"outgoing":[],"bounds":{"lowerRight":{"x":853,"y":192},"upperLeft":{"x":825,"y":164}},"dockers":[]},{"resourceId":"sid-D246DCFB-E559-4479-B8FF-E1315A86F091","properties":{"overrideid":"","name":"","repruseaction":"false","conditionsequenceflow":"","defaultflow":"false","action":"","state":"","mandatenotes":"false","capturereasons":"false","typeofreason":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB"}],"bounds":{"lowerRight":{"x":824.8984375,"y":178},"upperLeft":{"x":760.3828125,"y":178}},"dockers":[{"x":50,"y":40},{"x":14,"y":14}],"target":{"resourceId":"sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB"}},{"resourceId":"sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2","properties":{"overrideid":"","name":"Resubmit","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus == 'Resubmitted'"}},"defaultflow":"false","action":"Resubmit","state":"Resubmitted","mandatenotes":true,"capturereasons":"false","typeofreason":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA"}],"bounds":{"lowerRight":{"x":560.5,"y":157.34375},"upperLeft":{"x":245,"y":71}},"dockers":[{"x":20.5,"y":20.5},{"x":560.5,"y":71},{"x":245,"y":71},{"x":50,"y":40}],"target":{"resourceId":"sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA"}},{"resourceId":"sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D","properties":{"overrideid":"","name":"Approve","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus == 'Approved'"}},"defaultflow":"false","action":"Approve","state":"Approved","mandatenotes":"false","capturereasons":"false","typeofreason":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F"}],"bounds":{"lowerRight":{"x":659.9453180927317,"y":178.43415553709943},"upperLeft":{"x":580.1874944072683,"y":178.16740696290057}},"dockers":[{"x":20.5,"y":20.5},{"x":50,"y":40}],"target":{"resourceId":"sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F"}},{"resourceId":"sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79","properties":{"overrideid":"","name":"Submit","repruseaction":true,"conditionsequenceflow":{"expression":{"type":"static","staticValue":"vo.recordStatus == 'Submitted'"}},"defaultflow":"false","action":"Submit","state":"Submitted","mandatenotes":"false","capturereasons":"false","typeofreason":""},"stencil":{"id":"SequenceFlow"},"childShapes":[],"outgoing":[{"resourceId":"sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D"}],"bounds":{"lowerRight":{"x":389.48828125,"y":178},"upperLeft":{"x":295.51171875,"y":178}},"dockers":[{"x":50,"y":40},{"x":50,"y":40}],"target":{"resourceId":"sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D"}}],"bounds":{"lowerRight":{"x":1200,"y":1050},"upperLeft":{"x":0,"y":0}},"stencilset":{"url":"stencilsets/bpmn2.0/bpmn2.0.json","namespace":"http://b3mn.org/stencilset/bpmn2.0#"},"ssextensions":[]}]]></column>
			<column name="WORKFLOWXML" type="CLOB"><![CDATA[
					<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://activiti.org/test">
				  	<process id="SAMPLING" name="Sampling Workflow" isExecutable="true">
				    <documentation>Maker/Checker for Sampling Workflow</documentation>
				    <startEvent id="startEvent1" name="Start"/>
				    <userTask id="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" name="Maker" activiti:actor="SAMPLING_MAKER" activiti:assignmentLevel="Role Queue"/>
				    <sequenceFlow id="sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06" sourceRef="startEvent1" targetRef="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" representsUserAction="false" mandateNotes="false" captureReasons="false"/>
				    <userTask id="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" name="Approver" activiti:actor="SAMPLING_APPROVER" activiti:assignmentLevel="Role Queue"/>
				    <sequenceFlow id="sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB" sourceRef="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" targetRef="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" representsUserAction="false" mandateNotes="false" captureReasons="false"/>
				    <exclusiveGateway id="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA"/>
				    <serviceTask id="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" name="Complete Process" activiti:operation="doApprove" activiti:rerunnable="true"/>
				    <endEvent id="sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB" name="Approved"/>
				    <sequenceFlow id="sid-D246DCFB-E559-4479-B8FF-E1315A86F091" sourceRef="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" targetRef="sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB" representsUserAction="false" mandateNotes="false" captureReasons="false"/>
				    <sequenceFlow id="sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2" name="Resubmit" sourceRef="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" targetRef="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" action="Resubmit" state="Resubmitted" representsUserAction="true" mandateNotes="true" captureReasons="false">
				      <conditionExpression xsi:type="tFormalExpression">vo.recordStatus == 'Resubmitted'></conditionExpression>
				    </sequenceFlow>
				    <sequenceFlow id="sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D" name="Approve" sourceRef="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" targetRef="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" action="Approve" state="Approved" representsUserAction="true" mandateNotes="false" captureReasons="false">
				      <conditionExpression xsi:type="tFormalExpression">vo.recordStatus == 'Approved'></conditionExpression>
				    </sequenceFlow>
				    <sequenceFlow id="sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79" name="Submit" sourceRef="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" targetRef="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" action="Submit" state="Submitted" representsUserAction="true" mandateNotes="false" captureReasons="false">
				      <conditionExpression xsi:type="tFormalExpression">vo.recordStatus == 'Submitted'></conditionExpression>
				    </sequenceFlow>
				  </process>
				  <bpmndi:BPMNDiagram id="BPMNDiagram_SAMPLING">
				    <bpmndi:BPMNPlane bpmnElement="SAMPLING" id="BPMNPlane_SAMPLING">
				      <bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1">
				        <omgdc:Bounds height="30.0" width="30.0" x="100.0" y="163.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" id="BPMNShape_sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA">
				        <omgdc:Bounds height="80.0" width="100.0" x="195.0" y="138.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" id="BPMNShape_sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D">
				        <omgdc:Bounds height="80.0" width="100.0" x="390.0" y="138.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" id="BPMNShape_sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA">
				        <omgdc:Bounds height="40.0" width="40.0" x="540.0" y="158.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" id="BPMNShape_sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F">
				        <omgdc:Bounds height="80.0" width="100.0" x="660.0" y="138.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB" id="BPMNShape_sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB">
				        <omgdc:Bounds height="28.0" width="28.0" x="825.0" y="164.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNEdge bpmnElement="sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06" id="BPMNEdge_sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06">
				        <omgdi:waypoint x="130.0" y="178.0"/>
				        <omgdi:waypoint x="195.0" y="178.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-D246DCFB-E559-4479-B8FF-E1315A86F091" id="BPMNEdge_sid-D246DCFB-E559-4479-B8FF-E1315A86F091">
				        <omgdi:waypoint x="760.0" y="178.0"/>
				        <omgdi:waypoint x="825.0" y="178.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D" id="BPMNEdge_sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D">
				        <omgdi:waypoint x="579.5637583892617" y="178.43624161073825"/>
				        <omgdi:waypoint x="660.0" y="178.16722408026754"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79" id="BPMNEdge_sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79">
				        <omgdi:waypoint x="295.0" y="178.0"/>
				        <omgdi:waypoint x="390.0" y="178.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2" id="BPMNEdge_sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2">
				        <omgdi:waypoint x="560.5" y="158.5"/>
				        <omgdi:waypoint x="560.5" y="71.0"/>
				        <omgdi:waypoint x="245.0" y="71.0"/>
				        <omgdi:waypoint x="245.0" y="138.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB" id="BPMNEdge_sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB">
				        <omgdi:waypoint x="490.0" y="178.20746887966806"/>
				        <omgdi:waypoint x="540.4166666666666" y="178.41666666666666"/>
				      </bpmndi:BPMNEdge>
				    </bpmndi:BPMNPlane>
				  </bpmndi:BPMNDiagram>
				</definitions>
			]]>
			</column>
			<where>workflowtype='SAMPLING' and workflowactive=1</where>
		</update>
	</changeSet>
	<changeSet id="12" author="murthy.y">
		<sql>
			<![CDATA[
				delete from Income_details_temp;
				insert into Income_details_temp
				select ROW_NUMBER() OVER (ORDER BY custid), custid, custincometype, incomeexpense, category, custincome, margin, null, null, null, null, null, version, lastmntby, lastmnton, recordStatus, roleCode, nextRoleCode, taskId, nextTaskId, recordType, workflowId from customerincomes_temp;
				
				delete from Income_details;
				insert into Income_details
				select ROW_NUMBER() OVER (ORDER BY custid), custid, custincometype, incomeexpense, category, custincome, margin, null, null, null, null, null, version, lastmntby, lastmnton, recordStatus, roleCode, nextRoleCode, taskId, nextTaskId, recordType, workflowId from customerincomes;
				
				update income_details_temp t
				set id =  m.id
				from income_details m
				where m.linkid = t.linkid and m.incometype = t.incometype and m.incomeexpense = t.incomeexpense and m.category = t.category;
				
				delete from link_cust_incomes;
				insert into link_cust_incomes select linkid, ROW_NUMBER() OVER (ORDER BY linkid) 
				from (select distinct linkid from  income_details_view) t;
				
				update income_details_temp t
				set linkid =  m.linkid
				from link_cust_incomes m
				where m.custid = t.linkid;
				
				update income_details t
				set linkid =  m.linkid
				from link_cust_incomes m
				where m.custid = t.linkid;
			]]>
		</sql>
	</changeSet>
	<changeSet id="12.1" author="murthy.y">
		<sql>
			<![CDATA[
				delete from external_liabilities_temp;
				update customerextliability_temp set roi = ROUND(roi, 5) ;
				Update customerextliability_temp set source=0 where source='';
				Update customerextliability_temp set checkedby=0 where checkedby='';
				insert into external_liabilities_temp
				select ROW_NUMBER() OVER (ORDER BY custid), custid, liabilityseq, fintype, findate, bankname, ROUND(roi, 5), tenure,
				originalamount, instalmentamount, outstandingbal, tenurebal, bounceno, pos, overdue, finstatus, emicnsdrforfoir, 
				cast(source as integer), cast(checkedby as integer) checkedby, securitydetail,enduseoffunds, repayfrom, 
				null, null, null, null, null, version, lastmntby, lastmnton, recordStatus, roleCode, nextRoleCode, taskId, nextTaskId, recordType, workflowId 
				from customerextliability_temp;
				
				delete from external_liabilities;
				update customerextliability set roi = ROUND(roi, 5) ;
				Update customerextliability set source=0 where source='';
				Update customerextliability set checkedby=0 where checkedby='';
				insert into external_liabilities
				select ROW_NUMBER() OVER (ORDER BY custid), custid, liabilityseq, fintype, findate, bankname, ROUND(roi, 5), tenure,
				originalamount, instalmentamount, outstandingbal, tenurebal, bounceno, pos, overdue, finstatus, emicnsdrforfoir, 
				cast(source as integer), cast(checkedby as integer) checkedby, securitydetail,enduseoffunds, repayfrom, 
				null, null, null, null, null, version, lastmntby, lastmnton, recordStatus, roleCode, nextRoleCode, taskId, nextTaskId, recordType, workflowId 
				from customerextliability;
								
				update external_liabilities_temp t
				set id =  m.id
				from external_liabilities m
				where m.linkid = t.linkid and m.seqno = t.seqno;
									
				delete from link_cust_liabilities;
				insert into link_cust_liabilities select linkid, ROW_NUMBER() OVER (ORDER BY linkid);
				from (select distinct linkid from  customer_ext_liabilities_view) t;
								
				update external_liabilities t
				set linkid =  m.linkid
				from link_cust_liabilities m
				where m.custid = t.linkid;
				
				update external_liabilities_temp t
				set linkid =  m.linkid
				from link_cust_liabilities m
				where m.custid = t.linkid;
			]]>
		</sql>
	</changeSet>
	<changeSet id="13.0" author="murthy.y">
		<sql>
			<![CDATA[
				ALTER SEQUENCE SeqIncomeDetails RESTART WITH select Max(id) from income_details_view;
				alter sequence SeqIncomeLink RESTART select Max(linkId) from income_details_view;
				
				ALTER SEQUENCE SeqExternalLiabilities RESTART WITH select Max(id) from external_liabilities_view;
				alter sequence SeqIncomeLink RESTART select Max(linkId) from external_liabilities_view;
			]]>
		</sql>
	</changeSet>
	<changeSet id="14" author="lakshmi.n">
		<update tableName="WORKFLOWDETAILS">
			<column name="WORKFLOWXML" type="CLOB"><![CDATA[
					<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://activiti.org/test">
				  	<process id="SAMPLING" name="Sampling Workflow" isExecutable="true">
				    <documentation>Maker/Checker for Sampling Workflow</documentation>
				    <startEvent id="startEvent1" name="Start"/>
				    <userTask id="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" name="Maker" activiti:actor="SAMPLING_MAKER" activiti:assignmentLevel="Role Queue"/>
				    <sequenceFlow id="sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06" sourceRef="startEvent1" targetRef="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" representsUserAction="false" mandateNotes="false" captureReasons="false"/>
				    <userTask id="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" name="Approver" activiti:actor="SAMPLING_APPROVER" activiti:assignmentLevel="Role Queue"/>
				    <sequenceFlow id="sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB" sourceRef="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" targetRef="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" representsUserAction="false" mandateNotes="false" captureReasons="false"/>
				    <exclusiveGateway id="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA"/>
				    <serviceTask id="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" name="Complete Process" activiti:operation="doApprove" activiti:rerunnable="true"/>
				    <endEvent id="sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB" name="Approved"/>
				    <sequenceFlow id="sid-D246DCFB-E559-4479-B8FF-E1315A86F091" sourceRef="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" targetRef="sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB" representsUserAction="false" mandateNotes="false" captureReasons="false"/>
				    <sequenceFlow id="sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2" name="Resubmit" sourceRef="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" targetRef="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" action="Resubmit" state="Resubmitted" representsUserAction="true" mandateNotes="true" captureReasons="false">
				      <conditionExpression xsi:type="tFormalExpression">vo.recordStatus == 'Resubmitted'</conditionExpression>
				    </sequenceFlow>
				    <sequenceFlow id="sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D" name="Approve" sourceRef="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" targetRef="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" action="Approve" state="Approved" representsUserAction="true" mandateNotes="false" captureReasons="false">
				      <conditionExpression xsi:type="tFormalExpression">vo.recordStatus == 'Approved'</conditionExpression>
				    </sequenceFlow>
				    <sequenceFlow id="sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79" name="Submit" sourceRef="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" targetRef="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" action="Submit" state="Submitted" representsUserAction="true" mandateNotes="false" captureReasons="false">
				      <conditionExpression xsi:type="tFormalExpression">vo.recordStatus == 'Submitted'</conditionExpression>
				    </sequenceFlow>
				  </process>
				  <bpmndi:BPMNDiagram id="BPMNDiagram_SAMPLING">
				    <bpmndi:BPMNPlane bpmnElement="SAMPLING" id="BPMNPlane_SAMPLING">
				      <bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1">
				        <omgdc:Bounds height="30.0" width="30.0" x="100.0" y="163.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" id="BPMNShape_sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA">
				        <omgdc:Bounds height="80.0" width="100.0" x="195.0" y="138.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" id="BPMNShape_sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D">
				        <omgdc:Bounds height="80.0" width="100.0" x="390.0" y="138.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" id="BPMNShape_sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA">
				        <omgdc:Bounds height="40.0" width="40.0" x="540.0" y="158.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" id="BPMNShape_sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F">
				        <omgdc:Bounds height="80.0" width="100.0" x="660.0" y="138.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB" id="BPMNShape_sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB">
				        <omgdc:Bounds height="28.0" width="28.0" x="825.0" y="164.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNEdge bpmnElement="sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06" id="BPMNEdge_sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06">
				        <omgdi:waypoint x="130.0" y="178.0"/>
				        <omgdi:waypoint x="195.0" y="178.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-D246DCFB-E559-4479-B8FF-E1315A86F091" id="BPMNEdge_sid-D246DCFB-E559-4479-B8FF-E1315A86F091">
				        <omgdi:waypoint x="760.0" y="178.0"/>
				        <omgdi:waypoint x="825.0" y="178.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D" id="BPMNEdge_sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D">
				        <omgdi:waypoint x="579.5637583892617" y="178.43624161073825"/>
				        <omgdi:waypoint x="660.0" y="178.16722408026754"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79" id="BPMNEdge_sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79">
				        <omgdi:waypoint x="295.0" y="178.0"/>
				        <omgdi:waypoint x="390.0" y="178.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2" id="BPMNEdge_sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2">
				        <omgdi:waypoint x="560.5" y="158.5"/>
				        <omgdi:waypoint x="560.5" y="71.0"/>
				        <omgdi:waypoint x="245.0" y="71.0"/>
				        <omgdi:waypoint x="245.0" y="138.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB" id="BPMNEdge_sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB">
				        <omgdi:waypoint x="490.0" y="178.20746887966806"/>
				        <omgdi:waypoint x="540.4166666666666" y="178.41666666666666"/>
				      </bpmndi:BPMNEdge>
				    </bpmndi:BPMNPlane>
				  </bpmndi:BPMNDiagram>
				</definitions>
			]]>
			</column>
			<where>workflowtype='SAMPLING' and workflowactive=1</where>
		</update>
	</changeSet>
	<changeSet id="14.1" author="lakshmi.n">
		<update tableName="WORKFLOWDETAILS">
			<column name="WORKFLOWXML" type="CLOB"><![CDATA[
					<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://activiti.org/test">
				  	<process id="SAMPLING" name="Sampling Workflow" isExecutable="true">
				    <documentation>Maker/Checker for Sampling Workflow</documentation>
				    <startEvent id="startEvent1" name="Start"/>
				    <userTask id="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" name="Maker" activiti:actor="SAMPLING_MAKER" activiti:assignmentLevel="Role Queue"/>
				    <sequenceFlow id="sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06" sourceRef="startEvent1" targetRef="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" representsUserAction="false" mandateNotes="false" captureReasons="false"/>
				    <userTask id="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" name="Approver" activiti:actor="SAMPLING_APPROVER" activiti:assignmentLevel="Role Queue"/>
				    <sequenceFlow id="sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB" sourceRef="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" targetRef="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" representsUserAction="false" mandateNotes="false" captureReasons="false"/>
				    <exclusiveGateway id="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA"/>
				    <serviceTask id="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" name="Complete Process" activiti:operation="doApprove" activiti:rerunnable="true"/>
				    <endEvent id="sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB" name="Approved"/>
				    <sequenceFlow id="sid-D246DCFB-E559-4479-B8FF-E1315A86F091" sourceRef="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" targetRef="sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB" representsUserAction="false" mandateNotes="false" captureReasons="false"/>
				    <sequenceFlow id="sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2" name="Resubmit" sourceRef="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" targetRef="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" action="Resubmit" state="Resubmitted" representsUserAction="true" mandateNotes="true" captureReasons="false">
				      <conditionExpression xsi:type="tFormalExpression"><vo.recordStatus == 'Resubmitted'></conditionExpression>
				    </sequenceFlow>
				    <sequenceFlow id="sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D" name="Approve" sourceRef="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" targetRef="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" action="Approve" state="Approved" representsUserAction="true" mandateNotes="false" captureReasons="false">
				      <conditionExpression xsi:type="tFormalExpression"><vo.recordStatus == 'Approved'></conditionExpression>
				    </sequenceFlow>
				    <sequenceFlow id="sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79" name="Submit" sourceRef="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" targetRef="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" action="Submit" state="Submitted" representsUserAction="true" mandateNotes="false" captureReasons="false">
				      <conditionExpression xsi:type="tFormalExpression"><vo.recordStatus == 'Submitted'></conditionExpression>
				    </sequenceFlow>
				  </process>
				  <bpmndi:BPMNDiagram id="BPMNDiagram_SAMPLING">
				    <bpmndi:BPMNPlane bpmnElement="SAMPLING" id="BPMNPlane_SAMPLING">
				      <bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1">
				        <omgdc:Bounds height="30.0" width="30.0" x="100.0" y="163.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA" id="BPMNShape_sid-842BAF5E-D6EC-4357-9B85-AFD8BA60C1CA">
				        <omgdc:Bounds height="80.0" width="100.0" x="195.0" y="138.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D" id="BPMNShape_sid-C34C75EB-8F24-48D1-A1AF-C3E33298F71D">
				        <omgdc:Bounds height="80.0" width="100.0" x="390.0" y="138.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA" id="BPMNShape_sid-1EFC0B49-B876-4618-A538-BBDB7A1D4EBA">
				        <omgdc:Bounds height="40.0" width="40.0" x="540.0" y="158.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F" id="BPMNShape_sid-2BA38EEB-9884-4B2E-9B9F-FBB7AFA27A3F">
				        <omgdc:Bounds height="80.0" width="100.0" x="660.0" y="138.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNShape bpmnElement="sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB" id="BPMNShape_sid-C9F1C5C3-FC6C-4B51-A1D8-40E3D0F409CB">
				        <omgdc:Bounds height="28.0" width="28.0" x="825.0" y="164.0"/>
				      </bpmndi:BPMNShape>
				      <bpmndi:BPMNEdge bpmnElement="sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06" id="BPMNEdge_sid-ADB1C9A5-5DDC-46C4-90CF-E42626B43E06">
				        <omgdi:waypoint x="130.0" y="178.0"/>
				        <omgdi:waypoint x="195.0" y="178.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-D246DCFB-E559-4479-B8FF-E1315A86F091" id="BPMNEdge_sid-D246DCFB-E559-4479-B8FF-E1315A86F091">
				        <omgdi:waypoint x="760.0" y="178.0"/>
				        <omgdi:waypoint x="825.0" y="178.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D" id="BPMNEdge_sid-4057BBEA-8EF3-4483-BD8F-D2B75F87C08D">
				        <omgdi:waypoint x="579.5637583892617" y="178.43624161073825"/>
				        <omgdi:waypoint x="660.0" y="178.16722408026754"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79" id="BPMNEdge_sid-88AA5153-7ECF-444E-9C6F-2FEC9F012B79">
				        <omgdi:waypoint x="295.0" y="178.0"/>
				        <omgdi:waypoint x="390.0" y="178.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2" id="BPMNEdge_sid-542D07C0-FECC-4AFD-B69E-555A8056AEC2">
				        <omgdi:waypoint x="560.5" y="158.5"/>
				        <omgdi:waypoint x="560.5" y="71.0"/>
				        <omgdi:waypoint x="245.0" y="71.0"/>
				        <omgdi:waypoint x="245.0" y="138.0"/>
				      </bpmndi:BPMNEdge>
				      <bpmndi:BPMNEdge bpmnElement="sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB" id="BPMNEdge_sid-E83FA66D-DCA0-46D0-A041-7DA14B0D93DB">
				        <omgdi:waypoint x="490.0" y="178.20746887966806"/>
				        <omgdi:waypoint x="540.4166666666666" y="178.41666666666666"/>
				      </bpmndi:BPMNEdge>
				    </bpmndi:BPMNPlane>
				  </bpmndi:BPMNDiagram>
				</definitions>
			]]>
			</column>
			<where>workflowtype='SAMPLING' and workflowactive=1</where>
		</update>
	</changeSet>
</databaseChangeLog>